---
layout: post
title: 미적분 - 다변수 함수
date: 2025-07-27 21:20:23 +0900
category: 미적분
---
# 다변수 함수 (Multivariable Functions)

## 개요

- **단변수**: \( f:\mathbb{R}\to\mathbb{R},\ f(x) \)
- **다변수**: \( f:\mathbb{R}^n\to\mathbb{R}^m,\ f(\mathbf{x}) \)
  - 스칼라장: \( m=1 \) (예: \( f(x,y)=x^2+y^2 \))
  - 벡터장: \( m\ge2 \) (예: \( \mathbf{F}(x,y,z)=(xy,\,y^2,\,e^z) \))

**예시**
- 온도장 \( T(x,y,z) \) (스칼라장)
- 유체 속도장 \( \mathbf{v}(x,y,z) \) (벡터장)

---

## 정의역과 공역

### 정의역 (Domain)

함수가 **의미있게 정의**되는 입력 집합.

- 예: \( f(x,y)=\ln(x^2+y^2) \Rightarrow x^2+y^2>0 \)
  정의역 \(=\mathbb{R}^2\setminus\{(0,0)\} \)

### 공역 (Codomain)

출력값이 속하는 집합(보통 \(\mathbb{R}^m\)).
실제 **치역(range)** 은 공역의 부분집합.

---

## 표기/시각화: 그래프와 등고선

- **그래프(2변수)**: 3D 곡면 \( z=f(x,y) \)
- **등고선(Level sets)**: \( f(x,y)=c \)를 만족하는 평면상의 곡선들
  → 지형의 동일 고도선처럼 **형태 파악**에 유용

> 팁: 최적화에서 **등고선 + 그래디언트**를 함께 그리면 직관이 생깁니다.

---

## 극한과 연속성

### 극한

다변수 극한 \( \lim_{(x,y)\to(a,b)} f(x,y) \) 이 **존재**하려면
**모든 경로로 접근**해도 같은 값을 가져야 합니다.

**경로 의존 반례**
$$
f(x,y)=\frac{2xy}{x^2+y^2},\quad (x,y)\ne(0,0).
$$
- 직선 \( y=mx \): \( f(x,mx)=\frac{2m}{1+m^2} \) (경로에 따라 달라짐)
→ \( (0,0) \)에서 극한 **불존재**

### 연속성

점 \((a,b)\)에서
1) 정의됨, 2) 극한 존재, 3) 극한 \(=\) 함수값
이면 연속.

> **꿀팁**: 원점 극한 판정 시 **극좌표** \( (x,y)=(r\cos\theta, r\sin\theta) \)로 바꾸면
\(r\to0\)에서의 행동을 보기 쉬움.

---

## 편미분 (Partial Derivatives)

하나의 변수만 변하게 하여 미분:
$$
f_x=\frac{\partial f}{\partial x},\quad f_y=\frac{\partial f}{\partial y},\ldots
$$

**예시**
$$
f(x,y)=x^2y+y^3\ \Rightarrow\ f_x=2xy,\ \ f_y=x^2+3y^2.
$$

> **존재 ≠ 연속/미분가능**: 편미분이 존재해도 전미분(진정한 선형근사)이 없을 수 있음. (7절 참조)

---

## 방향도함수 · 그래디언트

### 방향도함수

단위벡터 \(\mathbf{u}\) 방향의 변화율:
$$
D_{\mathbf{u}}f(\mathbf{x})=\nabla f(\mathbf{x})\cdot \mathbf{u}.
$$

### 그래디언트(Gradient)

가장 **가파른 증가 방향**:
$$
\nabla f(x,y)=\left(\frac{\partial f}{\partial x},\,\frac{\partial f}{\partial y}\right).
$$

> **성질**: 등고선 \(f(x,y)=c\)에서 \(\nabla f\)는 항상 **법선 방향**.

---

## · 야코비안(Jacobian) · 선형근사

### 전미분(Differentiability)

\( f:\mathbb{R}^n\to\mathbb{R}^m \)가 \(\mathbf{a}\)에서 **미분가능**이면
$$
f(\mathbf{a}+\mathbf{h})=f(\mathbf{a})+D f(\mathbf{a})\,\mathbf{h}+o(\|\mathbf{h}\|).
$$
여기서 \( Df(\mathbf{a}) \)는 **야코비안 행렬**.

### 야코비안(Jacobian)

\( f=(f_1,\dots,f_m) \)일 때
$$
J_f(\mathbf{a})=
\begin{bmatrix}
\frac{\partial f_1}{\partial x_1}&\cdots&\frac{\partial f_1}{\partial x_n}\\
\vdots&\ddots&\vdots\\
\frac{\partial f_m}{\partial x_1}&\cdots&\frac{\partial f_m}{\partial x_n}
\end{bmatrix}_{\mathbf{a}}.
$$

### 선형근사(접평면)

스칼라장 \(f(x,y)\)에서 \((a,b)\) 근방:
$$
f(x,y)\approx f(a,b)+f_x(a,b)(x-a)+f_y(a,b)(y-b).
$$

> **주의**: 편미분 존재·연속이면 전미분 존재(충분조건이지만 필요조건 아님).

---

## 체인룰(Chain Rule)

합성 \( F(\mathbf{x})=g(h(\mathbf{x})) \)에서
$$
J_F(\mathbf{x})=J_g(h(\mathbf{x}))\cdot J_h(\mathbf{x}).
$$

**예시**
\( u=x^2+y^2,\ v=xy \), \( g(u,v)=u^2+e^v \)
→ \( F(x,y)=g(u(x,y),v(x,y)) \)
편미분은 체인룰로 깔끔히 정리 가능.

---

## · 클라로(Clairaut) 정리

### 혼합편도함수의 교환

조건(이차 연속미분)이 충족되면
$$
f_{xy}=f_{yx}.
$$
(클라로 정리)

### 헤시안(Hessian, \(n=2\))

$$
H_f=
\begin{bmatrix}
f_{xx} & f_{xy}\\
f_{yx} & f_{yy}
\end{bmatrix}.
$$

---

## 다변수 테일러 전개 · 2차 근사

점 \(\mathbf{a}\) 근방
$$
f(\mathbf{x}) \approx f(\mathbf{a})
+\nabla f(\mathbf{a})\cdot(\mathbf{x}-\mathbf{a})
+\frac{1}{2}(\mathbf{x}-\mathbf{a})^\top H_f(\mathbf{a})\,(\mathbf{x}-\mathbf{a}).
$$

- 1차: 선형근사(접평면)
- 2차: 곡률(헤시안) 포함 → **뉴턴법** 등 최적화에 중요

---

## 극값(무제약)과 판별법

### 정지점

\(\nabla f=0\) 인 \(\mathbf{x}^\*\) 후보에서 헤시안으로 분류:
- \(H\succ 0\): **국소 최소**
- \(H\prec 0\): **국소 최대**
- 부호 섞임(행렬 부정부호): **안장점**

### 예제 — 분류

$$
f(x,y)=x^3-3xy^2.
$$
- \(\nabla f=(3x^2-3y^2,\,-6xy)=\mathbf{0}\Rightarrow (0,0)\)만 정지점
- 헤시안 \(H=\begin{bmatrix}6x&-6y\\-6y&-6x\end{bmatrix}\) → \((0,0)\)에서 \(H=\begin{bmatrix}0&0\\0&0\end{bmatrix}\)
  - 2차로는 판별 불가 → 주변 점 대입/곡선 제한으로 **안장점** 확인.

---

## 제약 극값 — 라그랑주 승수법

제약 \( g_i(\mathbf{x})=0 \) 하에서 \( f \) 극값:
$$
\nabla f=\sum_{i}\lambda_i\,\nabla g_i,\quad g_i(\mathbf{x})=0.
$$

**예제**
\( f(x,y)=xy,\ g(x,y)=x^2+y^2-1=0\) (단위원)
\(\nabla f=(y,x),\ \nabla g=(2x,2y)\)
\((y,x)=\lambda(2x,2y)\Rightarrow y=2\lambda x,\ x=2\lambda y\Rightarrow x=\pm y\)
- \( x=y=\pm\frac{1}{\sqrt2} \Rightarrow f=\frac12\) (최대)
- \( x=-y=\pm\frac{1}{\sqrt2} \Rightarrow f=-\frac12\) (최소)

---

## 다중적분과 야코비안(변수변환) 한눈개요

- **이중적분**: 영역 \(D\)에서 \( \iint_D f(x,y)\,dA \)
- **변수변환** \( (x,y)=\Phi(u,v) \):
$$
\iint_D f(x,y)\,dA=\iint_{D'} f(\Phi(u,v))\,\big|\det J_\Phi(u,v)\big|\,du\,dv.
$$
> \(|\det J_\Phi|\)는 **면적 스케일링**.

---

# 예제 + 풀이 + 코드

## 예제 1 — 극한 존재 판정(극좌표)

\( f(x,y)=\dfrac{x^2y}{x^2+y^2} \)의 \((0,0)\) 극한?

**극좌표** \( x=r\cos\theta,\ y=r\sin\theta \):
$$
f=\frac{r^2\cos^2\theta\cdot r\sin\theta}{r^2}=r\cos^2\theta\sin\theta.
$$
\( r\to0 \)이면 \( f\to0 \) (모든 \(\theta\) 동일) → **극한 0, 존재**.
(반면 예시 서두의 \(\frac{2xy}{x^2+y^2}\)는 경로에 따라 달라 불존재)

---

## 예제 2 — 접평면(선형근사)

\( f(x,y)=\sqrt{1+x^2+2y^2} \), 점 \( (a,b)=(0,0) \):
- \( f(0,0)=1 \)
- \( f_x=\dfrac{x}{\sqrt{1+x^2+2y^2}},\ f_y=\dfrac{2y}{\sqrt{1+x^2+2y^2}} \Rightarrow f_x(0,0)=0,\ f_y(0,0)=0 \)

**1차 근사(접평면)**: \( z\approx 1 \) (원점에서 수평)

**2차 근사** 위해 헤시안:
- \( f_{xx}(0,0)=1,\ f_{yy}(0,0)=2,\ f_{xy}(0,0)=0 \)
- \( f(x,y)\approx 1+\tfrac12[x\ y]\begin{bmatrix}1&0\\0&2\end{bmatrix}\begin{bmatrix}x\\y\end{bmatrix}
=1+\tfrac12(x^2+2y^2) \)

---

## 예제 3 — 방향도함수·그래디언트

\( f(x,y)=x^2+3y^2 \), \( \mathbf{u}=\frac{1}{\sqrt{5}}(1,2) \)에서 \( (1,1) \):
- \( \nabla f(1,1)=(2,6) \)
- \( D_{\mathbf{u}}f(1,1)=\nabla f\cdot \mathbf{u}=\frac{2+12}{\sqrt5}=\frac{14}{\sqrt5} \)

**가장 큰 증가율**은 \(\|\nabla f\|=\sqrt{2^2+6^2}=\sqrt{40}\), 방향은 \(\frac{\nabla f}{\|\nabla f\|}\).

---

## 예제 4 — 체인룰(합성)

\( u=x^2+y^2,\ v=xy,\ g(u,v)=u^2+e^v \Rightarrow F(x,y)=g(u(x,y),v(x,y)) \).

편미분:
- \( g_u=2u,\ g_v=e^v \)
- \( u_x=2x,\ u_y=2y,\ v_x=y,\ v_y=x \)

따라서
$$
F_x= g_u\cdot u_x + g_v\cdot v_x = 2u\cdot 2x + e^v\cdot y,
$$
$$
F_y= 2u\cdot 2y + e^v\cdot x.
$$

---

## 예제 5 — 무제약 극값 분류

\( f(x,y)=x^4+y^4-2x^2y^2 \).

- \(\nabla f=(4x^3-4xy^2,\ 4y^3-4x^2y)=4(x^3-xy^2,\ y^3-x^2y)\)
- 정지점: \(x(y^2-x^2)=0,\ y(x^2-y^2)=0\Rightarrow\)
  가능한 해: \((0,0),\ (\pm a,0),\ (0,\pm a),\) 그리고 \(x=\pm y\) 라인 교차점 등(자세한 분기)
- 헤시안 \(H=\begin{bmatrix}12x^2-4y^2 & -8xy\\ -8xy & 12y^2-4x^2\end{bmatrix}\)
  점별로 판정(예: 원점은 \(H=0\) → 고차 검토 필요, 실제로 안장)

> 대칭 다항식은 **좌표축/대각선 제한**으로 빠르게 분류 가능.

---

## 예제 6 — 제약 최적화(라그랑주)

위 12절 예제와 동일 → 최대/최소 각각 \(\pm \frac12\) (단위원 제약)

---

# Python 코드 스니펫 (SymPy/NumPy)

> **참고**: 아래 코드는 블로그/노트북에서 복사 실행 용. 시 بص

### SymPy: 그래디언트·헤시안·정지점 분류

```python
import sympy as sp

x, y = sp.symbols('x y', real=True)
f = x**3 - 3*x*y**2  # 예제 11.2

# Gradient and Hessian

grad = [sp.diff(f, v) for v in (x, y)]
H = sp.hessian(f, (x, y))
print("∇f =", grad)
sp.pprint(H)

# Critical points: solve ∇f=0

crit = sp.solve([sp.Eq(grad[0], 0), sp.Eq(grad[1], 0)], (x, y), dict=True)
print("Critical points:", crit)

# Classify by Hessian (when definite)

def classify_point(pt):
    H_pt = H.subs(pt)
    eigs = [ev for ev in H_pt.eigenvals().keys()]
    if all(ev > 0 for ev in eigs):
        return "local min"
    if all(ev < 0 for ev in eigs):
        return "local max"
    if any(ev > 0 for ev in eigs) and any(ev < 0 for ev in eigs):
        return "saddle"
    return "inconclusive (zero eigenvalue or symbolic)"

for pt in crit:
    print(pt, "->", classify_point(pt))
```

### SymPy: 체인룰 자동화

```python
x, y = sp.symbols('x y', real=True)
u = x**2 + y**2
v = x*y
g = u**2 + sp.exp(v)
Fx = sp.diff(g, x)  # 체인룰 자동 적용
Fy = sp.diff(g, y)
sp.pprint(Fx), sp.pprint(Fy)
```

### NumPy: 수치 방향도함수 근사

```python
import numpy as np

def f_numpy(xy):
    x, y = xy
    return x**2 + 3*y**2

def directional_derivative(f, x0, u, h=1e-6):
    u = np.array(u, dtype=float)
    u = u / np.linalg.norm(u)  # 단위벡터
    return (f(x0 + h*u) - f(x0 - h*u)) / (2*h)

x0 = np.array([1.0, 1.0])
u  = np.array([1.0, 2.0])
print("D_u f(1,1) ≈", directional_derivative(f_numpy, x0, u))
```

---

# 실전 체크리스트 · 함정 모음

- **극한/연속**
  - 경로의존성 주의(직선/곡선/극좌표로 반례 탐색).
- **편미분 vs 전미분**
  - 편미분 존재만으로 전미분 보장 X.
    편미분의 **연속성**이 있으면 전미분 존재(충분조건).
- **체인룰**
  - 벡터형으로 야코비안 행렬 곱으로 정리하면 실수 ↓.
- **극값 판별**
  - \(\nabla f=0\) 찾은 뒤 **헤시안 부호성**으로 분류.
    결정 불가 시 고차항/경로 제한으로 재검토.
- **라그랑주 승수**
  - \(\nabla f=\lambda \nabla g\) + 제약식.
  - 경계/교차 제약(여러 제약) 시 승수 여러 개.
- **수치 꿀팁**
  - 기울기/헤시안 수치 오차: 중심차분, 적절한 \(h\), 스케일링.

---

# 요약 치트시트

| 주제 | 핵심 공식/개념 |
|---|---|
| 극한/연속 | 경로무관 동일극한이어야 존재 |
| 편미분 | \(f_x, f_y, \dots\) |
| 방향도함수 | \(D_{\mathbf{u}}f=\nabla f\cdot \mathbf{u}\) |
| 그래디언트 | 가장 큰 증가 방향, 등고선 법선 |
| 전미분 | \(f(\mathbf{a+h})\simeq f(\mathbf{a})+J_f(\mathbf{a})\mathbf{h}\) |
| 야코비안 | \(J_f=[\partial f_i/\partial x_j]\) |
| 체인룰 | \(J_{g\circ h}=J_g(h)\,J_h\) |
| 헤시안 | \(H=[f_{x_ix_j}]\) |
| 2차 근사 | \(f\simeq f(a)+\nabla f^\top\Delta x+\tfrac12\Delta x^\top H\,\Delta x\) |
| 무제약 극값 | \(\nabla f=0\) 후 \(H\) 부호성 판정 |
| 제약 극값 | \(\nabla f=\sum\lambda_i\nabla g_i\) |

---

# 연습문제 (해설 요약)

1) \( f(x,y)=\dfrac{x^3y}{x^2+y^2} \) 의 원점 극한 판정
→ 극좌표로 \( r\cos^3\theta\sin\theta \to 0 \): **존재, 0**

2) 접평면: \( f(x,y)=e^{xy} \), 점 \((1,0)\)
- \( f=1,\ f_x=y e^{xy}=0,\ f_y= x e^{xy}=1 \)
→ \( z\approx 1 + 0\cdot(x-1) + 1\cdot(y-0) = 1 + y \)

3) 체인룰: \( F(x,y)=\ln(1+x^2y) \)
- \( F_x=\dfrac{2xy}{1+x^2y},\ F_y=\dfrac{x^2}{1+x^2y} \)

4) 무제약 극값: \( f(x,y)=x^2+xy+y^2 \)
- \(\nabla f=(2x+y,\ x+2y)=0 \Rightarrow (0,0)\)
- \(H=\begin{bmatrix}2&1\\1&2\end{bmatrix}\succ0\) → **전역 최소: (0,0)**

5) 라그랑주: \( f=x+2y,\ g=x^2+y^2-1=0 \)
- \(\nabla f=(1,2)=\lambda(2x,2y)\Rightarrow x=\frac{1}{2\lambda}, y=\frac{1}{\lambda}\)
- 제약: \( \frac{1}{4\lambda^2}+\frac{1}{\lambda^2}=1 \Rightarrow \lambda=\pm\frac{\sqrt{5}}{2} \)
- 두 해에서 \(f\) 평가 → 최대/최소 구분.

---

## 마무리

- **핵심 흐름**: 경로 독립 극한/연속 → 편미분·전미분(야코비안) → 체인룰 → 헤시안으로 곡률·극값 → 제약은 라그랑주.
- 실전(최적화·ML·시뮬레이션)에서는 **1·2차 근사**가 컴퓨팅 자원과 정확도의 핵심 균형점입니다.
