---
layout: post
title: 미적분 - 발산정리
date: 2025-08-25 23:20:23 +0900
category: 미적분
---
# 발산정리(가우스), 그린 정리

## 0. 표기와 기본 가정

- 벡터장: $$\mathbf{F}=(P,Q,R)$$, $$P,Q,R\in C^1$$(연속 미분 가능)  
- 발산: $$\nabla\cdot\mathbf{F}=\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}+\frac{\partial R}{\partial z}$$  
- 회전: $$\nabla\times\mathbf{F}=\left(\frac{\partial R}{\partial y}-\frac{\partial Q}{\partial z},\frac{\partial P}{\partial z}-\frac{\partial R}{\partial x},\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)$$  
- 면 요소/법선: $$d\mathbf{S}=\mathbf{n}\,dS$$(밖을 향한 단위 법선)  
- 선 요소: $$d\mathbf{r}=(dx,dy,dz)$$  
- 곡선의 양의(반시계) 방향, 표면의 **오른손 법칙**을 따르는 정방향을 항상 가정

---

## 1. 발산정리(가우스 정리)

### 1.1 정리(정확한 진술)
닫힌 유한 부피 $$V\subset\mathbb{R}^3$$와 그 경계 폐곡면 $$S=\partial V$$가 분할가능(piecewise smooth)하고, $$\mathbf{F}$$가 $$V$$의 근방에서 $$C^1$$이면
$$
\iiint_V (\nabla\cdot\mathbf{F})\,dV \;=\; \iint_{\partial V} \mathbf{F}\cdot\mathbf{n}\,dS.
$$

- 좌변: “부피 내부의 **총 발산**(생성/소멸의 총량)”  
- 우변: “경계 표면을 통한 **총 유량(flux)**(밖으로 나간 양)”

**물리 직관**: 내부에서 생성된 양이 경계를 통해 밖으로 빠져나간다.  
즉, “속의 총 발산 = 겉으로 나간 총량”.

### 1.2 증명 스케치(직육면체 → 일반영역)
1) 직육면체에서 각 방향에 대해 **일변수 미적분학의 기본정리**를 적용해 면 플럭스를 차분 형태로 합산하면  
$$\iiint_V \frac{\partial P}{\partial x}\,dV=\iint_{x=\text{right}}P\,dS-\iint_{x=\text{left}}P\,dS$$  
와 유사식이 $$y,z$$ 방향에도 성립. 세 방향을 합해 좌변이 $$\iiint_V (\nabla\cdot\mathbf{F})\,dV$$가 되고, 우변이 경계 전체 플럭스가 된다.  
2) 일반 영역은 **분할/근사/한계과정**(적분의 표준 구성 또는 파티션 오브 유니티)을 통해 귀결.

### 1.3 전형적 예제

#### 예제 A: 위치 벡터장과 단위구
$$
\mathbf{F}(x,y,z)=(x,y,z),\qquad V=\{x^2+y^2+z^2\le 1\}.
$$
- 발산: $$\nabla\cdot\mathbf{F}=1+1+1=3.$$
- 부피 적분: $$\iiint_V 3\,dV=3\cdot\frac{4}{3}\pi=4\pi.$$
- 표면 적분: 구면에서 $$\mathbf{n}=\mathbf{r}/\|\mathbf{r}\|=(x,y,z)$$, 반지름 1이므로 $$\mathbf{F}\cdot\mathbf{n}=1$$, 따라서  
  $$\iint_{\partial V}\mathbf{F}\cdot\mathbf{n}\,dS=\text{Area}(S^2)=4\pi.$$
두 값이 일치.

#### 예제 B: 육면체에서 빠른 검산
$$
\mathbf{F}=(x^2,\,y,\,z),\qquad V=[0,1]^3.
$$
- 발산: $$\nabla\cdot\mathbf{F}=2x+1+1=2x+2.$$
- 부피 적분:  
  $$\iiint_V(2x+2)\,dV=\int_0^1\!\!\int_0^1\!\!\int_0^1(2x+2)\,dx\,dy\,dz=\left[x^2+2x\right]_0^1=3.$$
- 표면 플럭스(6개 면 합):  
  - $$x=1$$면: $$\mathbf{n}=(1,0,0),\ \mathbf{F}\cdot\mathbf{n}=x^2=1,\ \iint=1\cdot 1=1.$$  
  - $$x=0$$면: $$\mathbf{n}=(-1,0,0),\ \mathbf{F}\cdot\mathbf{n}=0.$$  
  - $$y=1$$면: $$\mathbf{n}=(0,1,0),\ \mathbf{F}\cdot\mathbf{n}=y=1,\ \iint=1.$$  
  - $$y=0$$면: 0.  
  - $$z=1$$면: $$\mathbf{F}\cdot\mathbf{n}=z=1,\ \iint=1.$$  
  - $$z=0$$면: 0.  
  합계 3. 일치.

#### 예제 C: 발산이 0이면 플럭스는 0
$$
\mathbf{F}=(-y,\,x,\,0),\quad \nabla\cdot\mathbf{F}=0.
$$
특이점이 없고 닫힌 표면이면 어느 $$V$$에 대해서도  
$$\iiint_V 0\,dV=0=\iint_{\partial V}\mathbf{F}\cdot\mathbf{n}\,dS.$$

#### 예제 D: 특이점 처리(펑츄어드 도메인)
$$
\mathbf{F}(\mathbf{r})=\frac{\mathbf{r}}{\|\mathbf{r}\|^3}
$$
은 원점에서 정의되지 않는다. 원점이 내부에 있으면 발산정리 직접 적용 불가.  
처방: 원점 근방의 작은 구를 **제거**한 도메인에 정리를 적용한 뒤 반지름을 0으로 보내는 극한을 취한다(전기장/가우스 법칙과 동일 분석).

### 1.4 응용(요지)
- 전자기학 가우스 법칙:  
  $$\nabla\cdot \mathbf{E}=\frac{\rho}{\varepsilon_0}\ \Longleftrightarrow\ \iint_{\partial V}\mathbf{E}\cdot\mathbf{n}\,dS=\frac{1}{\varepsilon_0}\iiint_V \rho\,dV.$$
- 유체 연속방정식(질량보존):  
  $$\frac{\partial \rho}{\partial t}+\nabla\cdot(\rho\mathbf{u})=0.$$

---

## 2. 그린 정리(평면판, 회전/발산의 2D 버전)

### 2.1 순환형(회전과 연결)
평면 단순 폐곡선 $$C=\partial D$$(양의 방향=반시계), $$\mathbf{F}=(P,Q)$$, $$P,Q\in C^1$$이면
$$
\oint_C P\,dx+Q\,dy=\iint_D\left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA.
$$
- 좌변: 경계를 따라 **순환(circulation)**  
- 우변: 내부에서의 **회전(curl_z)** 누적

### 2.2 유량형(2D 발산과 연결)
같은 가정 하에
$$
\oint_C P\,dy - Q\,dx = \iint_D\left(\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}\right)dA
= \iint_D (\nabla\cdot\mathbf{F})\,dA.
$$
- 좌변: 경계에서의 **법선 유량**  
- 우변: 내부 **발산**의 면적 적분

> 스토크스 정리의 2차원 특수화로 볼 수 있다. 또한 발산정리의 2D 판본이 바로 유량형 그린 정리.

### 2.3 증명 스케치
사각형 영역에서 **적분 순서 교환**과 **기본정리**로 증명 → 분할/합으로 일반 단순영역에 확장. 곡선 경계는 사다리꼴/세로·가로 단조 영역으로 덮어 귀결.

### 2.4 전형적 예제

#### 예제 E: 원 위의 회전(초안 보강)
$$
\mathbf{F}(x,y)=(-y,\,x),\quad C:\ x^2+y^2=1 \text{(반시계)}.
$$
- 순환형 우변:  
  $$\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}=1-(-1)=2,$$
  $$\iint_D 2\,dA=2\cdot\pi.$$
- 좌변 직접계산도 $$2\pi$$로 일치.

#### 예제 F: 면적 공식(그린 정리의 고전 응용)
$$
P=-\frac{y}{2},\quad Q=\frac{x}{2}\ \Rightarrow\ \frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}=\frac{1}{2}-\left(-\frac{1}{2}\right)=1.
$$
따라서
$$
\text{Area}(D)=\iint_D 1\,dA=\oint_C \left(-\frac{y}{2}\right)dx+\left(\frac{x}{2}\right)dy
=\frac{1}{2}\oint_C x\,dy - y\,dx.
$$
다각형 경계에 적용하면 **신발끈 공식**을 얻는다.

#### 예제 G: 유량형으로 평면 발산 적분 검증
$$
\mathbf{F}(x,y)=(x^2,\,xy),\quad D=\{x^2+y^2\le 1\}.
$$
- 우변:  
  $$\nabla\cdot\mathbf{F}=2x+y,$$
  $$\iint_D(2x+y)\,dA=0$$ (대칭성으로 상쇄).
- 좌변: 원 경계에서 외법선 유량도 0. 일치.

### 2.5 다중 경계(구멍 있는 영역)의 방향
구멍이 있는 영역에서는 **바깥 경계는 반시계(+), 내부 구멍 경계는 시계(-)** 로 취급해야 정리가 성립한다.

---

## 3. 스토크스 정리와의 연결(큰그림 요약)

- 스토크스: 임의의 매끄러운 곡면 $$S$$와 경계 $$\partial S$$에 대해
  $$
  \oint_{\partial S}\mathbf{F}\cdot d\mathbf{r}=\iint_S (\nabla\times\mathbf{F})\cdot \mathbf{n}\,dS.
  $$
- 그린 정리: 스토크스를 **평면 곡면**으로 특수화.  
- 발산 정리: 스토크스에 외미분/호지 보조정리를 얹은 3D 전개로 해석 가능(미분형식 관점). 실무에선 “**3D: 발산↔유량**”, “**2D: 회전↔순환**”.

---

## 4. 경계 조건·특이점·함정 체크리스트

1) **정칙성**: $$P,Q,R\in C^1$$, 경계는 분할가능. 모서리/꼭짓점은 조심스럽게 면적/길이 무시 극한으로 처리.  
2) **특이점**: 벡터장 정의역의 구멍은 예외. 작은 이탈 구를 도려내고 극한을 취한다(예제 D).  
3) **방향/법선**: 바깥 법선, 반시계/오른손 규칙을 엄밀히 지킬 것.  
4) **수치 구현**: 메시/샘플링에 따른 오차. 그린 정리 면적 공식을 다각형 좌표 데이터 검산용으로 쓰면 유용.

---

## 5. 실습 코드 — 심볼릭/수치 검산

### 5.1 SymPy: 발산정리 검산(직육면체, 일반 벡터장)
```python
import sympy as sp

x, y, z = sp.symbols('x y z', real=True)
P = x**2
Q = y
R = z
divF = sp.diff(P, x) + sp.diff(Q, y) + sp.diff(R, z)  # 2x + 1 + 1
vol = sp.integrate(divF, (x,0,1), (y,0,1), (z,0,1))
print("∭_V div F dV =", sp.simplify(vol))  # 3

# 면 플럭스(6개 면) 합
# x=1 and x=0
flux_x1 = sp.integrate(P.subs(x,1), (y,0,1), (z,0,1))   # n=(1,0,0)
flux_x0 = sp.integrate((-P.subs(x,0)), (y,0,1), (z,0,1)) # n=(-1,0,0)
# y=1 and y=0
flux_y1 = sp.integrate(Q.subs(y,1), (x,0,1), (z,0,1))
flux_y0 = sp.integrate((-Q.subs(y,0)), (x,0,1), (z,0,1))
# z=1 and z=0
flux_z1 = sp.integrate(R.subs(z,1), (x,0,1), (y,0,1))
flux_z0 = sp.integrate((-R.subs(z,0)), (x,0,1), (y,0,1))

flux_total = sp.simplify(flux_x1 + flux_x0 + flux_y1 + flux_y0 + flux_z1 + flux_z0)
print("∬_∂V F·n dS =", flux_total)  # 3
```

### 5.2 SymPy: 그린 정리(면적 공식)로 다각형 면적
```python
import sympy as sp

# 단순 다각형 정점 리스트 (반시계)
poly = [(0,0), (2,0), (2,1), (1,2), (0,1)]
# Area = 1/2 ∮ (x dy - y dx)
area = 0
for (x1,y1),(x2,y2) in zip(poly, poly[1:]+poly[:1]):
    area += (x1*y2 - y1*x2)  # shoelace
area = abs(area)/2
print("Polygon area (shoelace/Green) =", area)
```

### 5.3 수치 샘플링: 구면 플럭스 근사(몬테카를로)
```python
import numpy as np

def sample_on_unit_sphere(N=200000, rng=np.random.default_rng(0)):
    # 균일 구면 샘플: 정규분포 -> 정규화
    v = rng.normal(size=(N,3))
    v /= np.linalg.norm(v, axis=1, keepdims=True)
    return v  # points on S^2

def flux_F_equals_r(N=200000):
    pts = sample_on_unit_sphere(N)
    # F = r, n = r (unit sphere), F·n = 1
    # ∮ F·n dS ≈ average(F·n) * area(S^2) = 1 * 4π
    return 4*np.pi

print("Flux over unit sphere (F=r):", flux_F_equals_r())
```

### 5.4 매개곡선 선적분 vs 면적적분(원)
```python
import numpy as np

def line_integral_circle(F, n_pts=100000):
    t = np.linspace(0, 2*np.pi, n_pts, endpoint=False)
    x = np.cos(t); y = np.sin(t)
    dx = -np.sin(t)*(2*np.pi/n_pts); dy =  np.cos(t)*(2*np.pi/n_pts)
    P, Q = F(x, y)
    return np.sum(P*dx + Q*dy)

def area_integral_disk(curl, n=2000):
    # 극좌표 적분
    r = np.linspace(0,1,n)
    th = np.linspace(0,2*np.pi,n,endpoint=False)
    dr = 1/(n-1); dth = 2*np.pi/n
    R, TH = np.meshgrid(r, th, indexing='ij')
    X = R*np.cos(TH); Y = R*np.sin(TH)
    val = curl(X, Y)
    return np.sum(val * R) * dr * dth  # ∫∫ curl_z dA = ∫∫ curl_z * r dr dθ

F = lambda x,y: (-y, x)
curl = lambda x,y: 2*np.ones_like(x)
print("Line integral ≈", line_integral_circle(F))
print("Area integral ≈", area_integral_disk(curl))
```

---

## 6. 연습문제(해설 방향 포함)

1) $$\mathbf{F}=(x+y,\,y+z,\,z+x),\quad V=[0,1]^3$$.  
   (a) 좌변 $$\iiint_V \nabla\cdot\mathbf{F}\,dV$$ 계산. (b) 6개 면 플럭스를 합산해 우변과 일치 확인.  
   해설 스케치: $$\nabla\cdot\mathbf{F}=1+1+1=3$$ → 부피적분=3. 면별 상수/선형 적분으로 동일 값.

2) $$\mathbf{F}=(P,Q)=(x^3,\ 3x^2y),\quad D=\{x^2+y^2\le 1\}$$.  
   순환형 그린 정리로 좌/우를 계산.  
   해설 스케치: $$\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}=6xy-0,$$ 원판에서 대칭성으로 0.

3) 다각형의 면적을 그린 정리 유량형으로 재도출.  
   힌트: $$P=-y/2,\ Q=x/2$$를 사용하라.

4) 특이장 $$\mathbf{F}=\frac{\mathbf{r}}{\|\mathbf{r}\|^3}$$에서 원점을 포괄하는 임의의 닫힌 매끄러운 표면에 대한 플럭스를 구하라.  
   해설 스케치: 작은 구로 원점을 제외한 뒤 극한. 모든 경우 플럭스는 $$4\pi$$(정규화 상수 여부에 따라 다를 수 있음).

---

## 7. 요약 표

| 주제 | 핵심 등식 | 의미 |
|---|---|---|
| 발산정리 | $$\displaystyle \iiint_V \nabla\cdot\mathbf{F}\,dV=\iint_{\partial V}\mathbf{F}\cdot\mathbf{n}\,dS$$ | 내부 생성(발산)의 총합 = 경계 유량 |
| 그린 정리(순환) | $$\displaystyle \oint_C P\,dx+Q\,dy=\iint_D\left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)dA$$ | 경계 순환 = 내부 회전 |
| 그린 정리(유량) | $$\displaystyle \oint_C P\,dy-Q\,dx=\iint_D(\nabla\cdot\mathbf{F})\,dA$$ | 경계 유량 = 내부 발산 |
| 방향 규약 | 바깥 법선, 반시계/오른손 | 부호 오류 방지의 핵심 |
| 특이점 | 구멍/불연속은 제외 후 극한 | 물리적 소스/싱귤러리티 처리 |

---

## 8. 결론

- **발산정리**는 3차원에서 “부피 발산 = 경계 유량”을 연결한다.  
- **그린 정리**는 2차원에서 “경계 순환/유량 = 내부 회전/발산”을 연결한다.  
- 두 정리는 **스토크스 정리**의 다른 얼굴이며, 전자기학·유체역학·수치해석 등에서 계산을 **경계 ↔ 내부**로 바꿔주는 강력한 도구다.  
- 실무에서는 **정칙성/방향/특이점**을 점검하고, 대칭성·그린 면적 공식·가우스 법칙 등의 **표준 트릭**으로 계산을 단순화하라.