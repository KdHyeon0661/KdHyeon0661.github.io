---
layout: post
title: 미적분 - 부분적분
date: 2025-07-11 21:20:23 +0900
category: 미적분
---
# 삼각함수의 적분(Trigonometric Integrals)

## 로드맵 개요

1. 기본 원리와 표준 미분/적분
2. **거듭제곱 & 곱**: \(\sin^m x \cos^n x\), \(\tan^m x \sec^n x\), \(\cot^m x \csc^n x\)
3. **곱-합/합-곱** 공식으로 각/주파수 혼합형 단순화
4. **감소식(리덕션 포뮬러)**: \(\int \sin^n x\,dx\), \(\int \cos^n x\,dx\), \(\int \sec^n x\,dx\), \(\int \csc^n x\,dx\)
5. **특수형**: \(\int \sec x\,dx\), \(\int \csc x\,dx\), \(\int \tan x\,dx\), \(\int \cot x\,dx\)
6. **삼각치환**(요약·연계): 루트형, 완전제곱 → 단순 삼각적분
7. **Weierstrass**(전탄젠트) 치환: \(\displaystyle t=\tan\frac{x}{2}\)로 유리함수화
8. **오일러 복소화**: \(e^{ix}\)로 곱적분, 직교성, 정적분 처리
9. **정적분 테크닉**: 주기성, 대칭성, 직교성(푸리에 계수), 파싱(Poisson)형
10. **난이도 상승형**: \(\sqrt{a+b\sin x}\), \(\frac{1}{a+b\cos x}\), 유리합성형
11. 표준 결과 모음(치트시트)
12. 실전 예제·풀이
13. SymPy 코드로 검증/수치 확인
14. 자주 하는 실수·체크리스트

---

## 기본: 미분/적분 원리 상기

표준 미분:
$$
(\sin x)'=\cos x,\quad
(\cos x)'=-\sin x,\quad
(\tan x)'=\sec^2 x,\quad
(\cot x)'=-\csc^2 x,
$$
$$
(\sec x)'=\sec x\tan x,\quad
(\csc x)'=-\csc x \cot x.
$$

즉시 적분:
$$
\int \cos x\,dx=\sin x+C,\qquad
\int \sin x\,dx=-\cos x+C,
$$
$$
\int \sec^2 x\,dx=\tan x+C,\qquad
\int \csc^2 x\,dx=-\cot x+C,
$$
$$
\int \sec x \tan x\,dx=\sec x+C,\qquad
\int \csc x \cot x\,dx=-\csc x+C.
$$

삼각 항등식(핵심):
$$
\sin^2 x + \cos^2 x=1,\qquad
1+\tan^2 x=\sec^2 x,\qquad
1+\cot^2 x=\csc^2 x.
$$
반각:
$$
\sin^2 x=\frac{1-\cos 2x}{2},\qquad
\cos^2 x=\frac{1+\cos 2x}{2}.
$$

---

## \(\sin^m x \cos^n x\) 형태 — **홀수/짝수 전략**

### 한쪽이 **홀수**일 때(예: \(m\) 홀수)

\(\sin\)이 홀수라 가정(\(m=2k+1\)):
$$
\int \sin^{2k+1} x \cos^n x\,dx
= \int (\sin^{2k} x)\sin x \cos^n x\,dx.
$$
여기서 \(\sin^{2k}x=(1-\cos^2 x)^k\)로 바꿔 **치환** \(u=\cos x,\ du=-\sin x\,dx\).

**예시**
$$
\int \sin^3 x \cos^4 x\,dx
= \int (1-\cos^2 x)\sin x \cos^4 x\,dx.
$$
\(u=\cos x\) → \(\int (1-u^2)u^4(-du)\) → 다항 적분.

동일하게 \(\cos\)이 홀수면 \(u=\sin x\)로 변환.

### 둘 다 **짝수**일 때

반각공식 사용:
$$
\sin^2 x=\frac{1-\cos 2x}{2},\quad
\cos^2 x=\frac{1+\cos 2x}{2}.
$$
예: \(\int \sin^2 x \cos^2 x\,dx\)
$$
=\int \frac{(1-\cos 2x)(1+\cos 2x)}{4}\,dx
=\int \frac{1-\cos^2 2x}{4}\,dx
=\frac{1}{4}\int \frac{1+\cos 4x}{2}\,dx.
$$

---

## \(\tan^m x \sec^n x\), \(\cot^m x \csc^n x\)

핵심 항등식:
$$
\sec^2 x=1+\tan^2 x,\qquad
\csc^2 x=1+\cot^2 x.
$$

### \(\tan^m x \sec^n x\)

- \(n\)이 **짝수**면 \(\sec^2 x\)를 남겨 \(u=\tan x\)로:
  $$
  \int \tan^m x \sec^n x\,dx
  = \int \tan^m x\,\sec^{n-2}x\,(\sec^2 x)\,dx,\quad u=\tan x.
  $$
- \(m\)이 **홀수**면 \(\tan x \sec x\)를 남겨 \(u=\sec x\):
  $$
  \int \tan^{m} x \sec^{n} x\,dx
  = \int \tan^{m-1} x \sec^{n-1} x\,(\sec x \tan x)\,dx,\quad u=\sec x.
  $$

**예시**
$$
\int \tan^3 x \sec^4 x\,dx
= \int \tan^3 x \sec^2 x \,\sec^2 x\,dx.
$$
\(u=\tan x\) → \(\int u^3(1+u^2)\,du\).

### \(\cot^m x \csc^n x\)

- \(n\) 짝수면 \(\csc^2 x\)를 남겨 \(u=\cot x\).
- \(m\) 홀수면 \(\csc x \cot x\)를 남겨 \(u=\csc x\).

**예시**
$$
\int \cot^3 x \csc^2 x\,dx \quad (u=\cot x).
$$

---

## 곱-합(또는 합-곱) 공식 — 주파수 혼합형 단순화

곱을 합으로:
$$
\sin A\sin B=\frac{1}{2}[\cos(A-B)-\cos(A+B)],
$$
$$
\cos A\cos B=\frac{1}{2}[\cos(A-B)+\cos(A+B)],
$$
$$
\sin A\cos B=\frac{1}{2}[\sin(A+B)+\sin(A-B)].
$$

### 예시 1) \(\displaystyle \int \sin 3x \sin 5x\,dx\)

$$
=\frac{1}{2}\int [\cos 2x - \cos 8x]\,dx
=\frac{1}{2}\Big(\tfrac{1}{2}\sin 2x - \tfrac{1}{8}\sin 8x\Big)+C.
$$

### 예시 2) \(\displaystyle \int \cos^2 x \cos 3x\,dx\)

반각으로 \(\cos^2 x=\frac{1+\cos 2x}{2}\) 후 곱-합 적용.

---

## 감소식(리덕션 포뮬러)

### \(\displaystyle \int \sin^n x\,dx\) ( \(n\ge 2\) )

부분적분(또는 항등식 조합)으로
$$
\int \sin^n x\,dx
= -\frac{1}{n}\sin^{n-1}x \cos x + \frac{n-1}{n}\int \sin^{n-2}x\,dx.
$$
동일하게
$$
\int \cos^n x\,dx
= \frac{1}{n}\cos^{n-1}x \sin x + \frac{n-1}{n}\int \cos^{n-2}x\,dx.
$$

**예시** \(n=4\):
$$
\int \sin^4 x\,dx
= \frac{3}{4}\int \sin^2 x\,dx - \frac{1}{4}\sin^3 x \cos x.
$$
\(\sin^2 x=\frac{1-\cos 2x}{2}\)로 마무리.

### \(\displaystyle \int \sec^n x\,dx\)

표준 감소식:
$$
\int \sec^n x\,dx
= \frac{\sec^{n-2}x \tan x}{n-1}
+ \frac{n-2}{n-1}\int \sec^{n-2}x\,dx,\qquad n\ge 2.
$$
유도는 부분적분과 \(\sec^2 x=1+\tan^2 x\) 활용.

동일하게 \(\csc^n x\)도 대칭적 감소식 성립.

---

## 특수형 표준 결과

- \(\displaystyle \int \tan x\,dx = -\ln|\cos x|+C=\ln|\sec x|+C.\)
- \(\displaystyle \int \cot x\,dx = \ln|\sin x|+C.\)
- \(\displaystyle \int \sec x\,dx = \ln|\sec x + \tan x|+C.\)
- \(\displaystyle \int \csc x\,dx = -\ln|\csc x + \cot x|+C = \ln|\tan \frac{x}{2}|+C.\)

**증명 스케치(예: \(\sec x\))**
\(\displaystyle \int \sec x\,dx\)에서 분자·분모에 \(\sec x+\tan x\)를 곱해
\(\displaystyle \int \frac{\sec^2 x + \sec x\tan x}{\sec x+\tan x}\,dx\) 후 \(u=\sec x+\tan x\).

---

## 삼각치환(요약·연계)

루트형(이차식의 제곱근)은 삼각치환으로 정리(본 주제는 별도 글에서 상세 정리됨):

- \(\sqrt{a^2-x^2}\Rightarrow x=a\sin\theta\)
- \(\sqrt{a^2+x^2}\Rightarrow x=a\tan\theta\)
- \(\sqrt{x^2-a^2}\Rightarrow x=a\sec\theta\)

**예시**
\(\displaystyle \int \frac{dx}{a^2+x^2}=\frac{1}{a}\arctan\frac{x}{a}+C\)
는 \(x=a\tan\theta\) 또는 표준 원시함수로 바로 처리.

---

## Weierstrass(전탄젠트) 치환 — **보편적 유리화**

치환
$$
t=\tan\frac{x}{2},\qquad
\sin x=\frac{2t}{1+t^2},\qquad
\cos x=\frac{1-t^2}{1+t^2},\qquad
dx=\frac{2\,dt}{1+t^2}.
$$
모든 \(\sin,\cos\) 유리식 적분을 **\(t\)에 대한 유리함수 적분**으로 환원한다.

**예시**
\(\displaystyle \int \frac{dx}{a+b\cos x}\):
\(\cos x\to \frac{1-t^2}{1+t^2}\), \(dx=\frac{2\,dt}{1+t^2}\),
분모는 2차식으로 떨어져 부분분수.

---

## 오일러 복소화 — 곱/직교성/정적분 강력 도구

$$
e^{ix}=\cos x+i\sin x,\quad
\cos x=\frac{e^{ix}+e^{-ix}}{2},\quad
\sin x=\frac{e^{ix}-e^{-ix}}{2i}.
$$
곱적분을 지수합으로 바꿔 **직교성**을 즉시 활용:
$$
\int_{0}^{2\pi} e^{imx}\,dx=
\begin{cases}
2\pi,& m=0\\
0,& m\neq 0
\end{cases}
\quad\Rightarrow\quad
\int_{0}^{2\pi}\cos(mx)\cos(nx)\,dx=\begin{cases}
\pi,& m=n\neq 0\\
0,& m\neq n
\end{cases}
$$
(사인/코사인 혼합형도 동일한 직교 성질 보유.)

---

## 정적분 테크닉 — 주기·대칭·직교성

1) **주기성**:
\(\displaystyle \int_{a}^{a+2\pi} f(x)\,dx = \int_{0}^{2\pi} f(x)\,dx\) (주기 \(2\pi\)).

2) **대칭성**:
\(\sin\)은 **홀함수**, \(\cos\)은 **짝함수**.
\(\displaystyle \int_{-A}^{A}\sin(\cdot)\,dx=0\), \(\displaystyle \int_{-A}^{A}\cos(\cdot)\,dx=2\int_0^{A}\cos(\cdot)\,dx\).

3) **직교성**(푸리에 계수 계산의 핵심):
\(\displaystyle \int_{-\pi}^{\pi}\cos(mx)\cos(nx)\,dx=\pi\delta_{mn}\) (단 \(m,n\neq 0\)).
사인-코사인 교차는 0.

**예시**
\(\displaystyle \int_0^{\pi}\sin(mx)\sin(nx)\,dx=\begin{cases}
0,& m\neq n\\
\frac{\pi}{2},& m=n\neq 0
\end{cases}\)

---

## 난이도 상승형

### \(\displaystyle \int \frac{dx}{a+b\cos x}\)

Weierstrass 치환 또는 표준 공식:
$$
\int \frac{dx}{a+b\cos x}
= \frac{2}{\sqrt{a^2-b^2}}
\arctan\!\Big(\sqrt{\frac{a-b}{a+b}}\tan\frac{x}{2}\Big)+C,\quad (|a|>|b|).
$$
증명: 전탄젠트 치환으로 2차식 적분 → 아크탄젠트.

### \(\displaystyle \int \sqrt{a+b\cos x}\,dx\)

반각 또는 복소화로 타원적분 형태가 나타날 수 있다.
특수한 \(a,b\) 조합에서는 삼각변환으로 초등함수화되기도 하나, 일반형은 **타원적분**.

### 주파수 혼합 유리식

\(\sin(nx),\cos(nx)\)의 혼합 유리식은 오일러 복소화로 분자/분모를 지수 다항식으로 만들고 부분분수 전개를 시도.

---

## 표준 결과 모음(치트시트)

- \(\displaystyle \int \sin^m x \cos^n x\,dx\):
  홀수전략(치환), 짝수전략(반각).
- \(\displaystyle \int \tan^m x \sec^n x\,dx\):
  \(n\) 짝수 → \(u=\tan x\); \(m\) 홀수 → \(u=\sec x\).
- \(\displaystyle \int \cot^m x \csc^n x\,dx\):
  \(n\) 짝수 → \(u=\cot x\); \(m\) 홀수 → \(u=\csc x\).
- \(\displaystyle \int \sec x\,dx = \ln|\sec x+\tan x|+C.\)
- \(\displaystyle \int \csc x\,dx = \ln|\tan \frac{x}{2}|+C.\)
- 감소식:
  $$
  \int \sin^n x\,dx=\frac{n-1}{n}\int \sin^{n-2}x\,dx - \frac{1}{n}\sin^{n-1}x\cos x,
  $$
  $$
  \int \cos^n x\,dx=\frac{n-1}{n}\int \cos^{n-2}x\,dx + \frac{1}{n}\cos^{n-1}x\sin x,
  $$
  $$
  \int \sec^n x\,dx=\frac{\sec^{n-2}x \tan x}{n-1}+\frac{n-2}{n-1}\int \sec^{n-2}x\,dx.
  $$

---

## 실전 예제 모음

### 예제 A: \(\displaystyle \int \sin^5 x \cos^2 x\,dx\)

\(\sin\) 홀수 → \(\sin x\) 하나 분리:
$$
\int \sin^5 x \cos^2 x\,dx
= \int (1-\cos^2 x)^2 \sin x \cos^2 x\,dx.
$$
\(u=\cos x\Rightarrow du=-\sin x\,dx\)
$$
= -\int (1-u^2)^2 u^2\,du
= -\int (u^2 - 2u^4 + u^6)\,du
= -\Big(\frac{u^3}{3}-\frac{2u^5}{5}+\frac{u^7}{7}\Big)+C.
$$
\(u=\cos x\) 역치환.

### 예제 B: \(\displaystyle \int \tan^3 x \sec^4 x\,dx\)

\(\sec^2\)를 남겨 \(u=\tan x\):
$$
\int \tan^3 x \sec^4 x\,dx
= \int \tan^3 x\sec^2 x\, \sec^2 x\,dx,\quad u=\tan x.
$$
\(\sec^2 x\,dx=du\), \(\sec^2 x=1+\tan^2 x=1+u^2\):
$$
\int u^3(1+u^2)\,du
= \int (u^3+u^5)\,du
= \frac{u^4}{4} + \frac{u^6}{6}+C.
$$

### 예제 C: \(\displaystyle \int \cos^2 x \cos 3x\,dx\)

\(\cos^2 x=\tfrac{1+\cos 2x}{2}\)로 확장:
$$
\int \frac{1+\cos 2x}{2}\cos 3x\,dx
= \frac{1}{2}\int \cos 3x\,dx + \frac{1}{2}\int \cos 2x \cos 3x\,dx.
$$
후자는 곱-합:
$$
\cos 2x \cos 3x=\frac{1}{2}[\cos x + \cos 5x].
$$

### 예제 D(정적분): \(\displaystyle \int_{0}^{2\pi}\cos(mx)\cos(nx)\,dx\)

직교성:
$$
=\begin{cases}
0,& m\neq n\\[4pt]
\pi,& m=n\neq 0\\[4pt]
2\pi,& m=n=0
\end{cases}
$$

### 예제 E: \(\displaystyle \int \frac{dx}{a+b\cos x}\) \((|a|>|b|)\)

전탄젠트:
$$
t=\tan\frac{x}{2},\quad \cos x=\frac{1-t^2}{1+t^2},\quad dx=\frac{2\,dt}{1+t^2}.
$$
분모:
$$
a+b\cos x = a + b\frac{1-t^2}{1+t^2} = \frac{(a+b)+(a-b)t^2}{1+t^2}.
$$
적분:
$$
\int \frac{dx}{a+b\cos x}
= \int \frac{2\,dt}{(a+b)+(a-b)t^2}
= \frac{2}{\sqrt{a^2-b^2}}\arctan\!\Big(\sqrt{\frac{a-b}{a+b}}\ t\Big)+C.
$$
\(t=\tan\frac{x}{2}\) 역치환.

### 예제 F: \(\displaystyle \int_{0}^{\pi} \frac{dx}{2+\cos x}\)

위 공식에 \(a=2,b=1\) 적용:
$$
\int_{0}^{\pi}\frac{dx}{2+\cos x}
= \frac{2}{\sqrt{3}}\Big[\arctan\!\Big(\frac{1}{\sqrt{3}}\tan\frac{x}{2}\Big)\Big]_{0}^{\pi}
= \frac{2}{\sqrt{3}}\left(\frac{\pi}{3}-0\right)=\frac{2\pi}{3\sqrt{3}}.
$$

### 예제 G(감소식): \(\displaystyle \int \sec^5 x\,dx\)

감소식으로
$$
\int \sec^5 x\,dx
= \frac{\sec^3 x \tan x}{4} + \frac{3}{4}\int \sec^3 x\,dx,
$$
그리고
$$
\int \sec^3 x\,dx = \frac{1}{2}\sec x \tan x + \frac{1}{2}\ln|\sec x + \tan x| + C.
$$

---

## SymPy로 검증/수치 확인 (코드)

```python
import sympy as sp

x, a, b, m, n = sp.symbols('x a b m n', real=True, positive=True, integer=True)
# 파워/곱 예제 검증

expr1 = sp.integrate(sp.sin(x)**3 * sp.cos(x)**4, x)
print("∫ sin^3 x cos^4 x dx =", sp.simplify(expr1.diff(x) - sp.sin(x)**3 * sp.cos(x)**4) == 0)

# tan^3 x sec^4 x

expr2 = sp.integrate(sp.tan(x)**3 * sp.sec(x)**4, x)
print("∫ tan^3 x sec^4 x dx derivative ok?", sp.simplify(expr2.diff(x) - sp.tan(x)**3 * sp.sec(x)**4) == 0)

# 1/(a+b cos x)

expr3 = sp.integrate(1/(a + b*sp.cos(x)), x)
print("∫ dx/(a+b cos x) =", expr3)

# sec^5 x 감소식 결과 검증

sec3 = sp.integrate(sp.sec(x)**3, x)
expr4 = (sp.sec(x)**3 * sp.tan(x))/4 + sp.Rational(3,4) * sec3
print("∫ sec^5 x expected form derivative ok?",
      sp.simplify(expr4.diff(x) - sp.sec(x)**5) == 0)

# 정적분 예제

val = sp.integrate(1/(2 + sp.cos(x)), (x, 0, sp.pi))
print("∫_0^π dx/(2+cos x) =", sp.simplify(val))

# 직교성 체크 (m≠n 예시)

mm, nn = 2, 3
orth = sp.integrate(sp.cos(mm*x)*sp.cos(nn*x), (x, 0, 2*sp.pi))
print("Orthogonality cos(mx)cos(nx), m!=n ->", sp.simplify(orth))
```

---

## 자주 하는 실수·체크리스트

- [ ] **홀/짝 전략**을 반대로 적용하지 않았는가?
  (\(\sin^m \cos^n\)에서 홀수인 쪽을 **치환**에 활용)
- [ ] \(\tan/\sec\), \(\cot/\csc\)의 **짝/홀** 규칙을 기억했는가?
- [ ] 감소식 사용 시 **경계항**(예: \(\sin^{n-1}x \cos x\)) 부호/계수 확인
- [ ] \(\int \sec x\,dx\)의 표준 트릭(곱셈 후 \(u=\sec x+\tan x\)) 기억
- [ ] 정적분에서 **주기성/대칭성/직교성**을 충분히 활용
- [ ] Weierstrass 치환의 \(dx=\frac{2\,dt}{1+t^2}\) 반영
- [ ] \(|a|>|b|\) 조건 등 **매개 조건** 확인(수렴/정의역)
- [ ] 복소화 시 **지수 지수승 부호**(±) 실수하지 않기

---

## 결론 및 학습 순서 제안

1) **기본 미분/적분, 항등식**(피타고라스·반각) →
2) **홀/짝 전략**으로 \(\sin^m \cos^n\), \(\tan^m \sec^n\), \(\cot^m \csc^n\) 자동화 →
3) **곱-합 공식**으로 주파수 혼합형 분해 →
4) **감소식**으로 거듭제곱 일반형 처리 →
5) **특수형**(\(\sec,\csc,\tan,\cot\)) 표준 트릭 숙지 →
6) **Weierstrass**로 유리화(막다른 길일 때 구원줄) →
7) **정적분**은 주기/대칭/직교성으로 과감히 단순화 →
8) **삼각치환**은 루트형/완전제곱에서 호출.
