---
layout: post
title: 미적분 - 지수적 성장과 감소
date: 2025-08-12 16:20:23 +0900
category: 미적분
---
# 지수적 성장과 감소 (Exponential Growth and Decay) — 개념, 해법, 모델링, 코드

본 글은 블로그용 심화 정리다. 미분방정식의 해석 해법에서 시작해 데이터로부터 매개변수를 추정하는 법, 반감기/배가시간, 복리·감쇠·붕괴·회로 모델, 수치해석, 검산 코드까지 한 번에 정리한다. 수학식은 모두 MathJax의 $$…$$ 표기를 사용한다. 코드는 ``` 블록을 사용한다.

---

## 1. 핵심 개념과 미분방정식

지수적 변화는 “양 자체에 비례하여 변화”함을 뜻한다. 연속시간 모델은 1차 미분방정식으로 쓴다.

$$
\frac{dy}{dt}=k\,y
$$

- $$y(t)$$: 시간 $$t$$ 에서의 양(인구, 질량, 농도, 전압 등)
- $$k$$: 비례 상수(성장률 혹은 감소율)
  - $$k>0$$: 지수적 성장
  - $$k<0$$: 지수적 감소

연속성·비례성 가정이 타당한 시간 스케일에서 모델이 잘 맞는다.

---

## 2. 해석 해법(분리형)과 초기값

분리형 미분방정식이므로 바로 적분 가능하다.

$$
\frac{dy}{y}=k\,dt
\quad\Rightarrow\quad
\int \frac{1}{y}\,dy=\int k\,dt
\quad\Rightarrow\quad
\ln|y|=kt+C
$$

지수화하면

$$
y(t)=C'\,e^{kt}
$$

초기 조건 $$y(0)=y_0$$ 를 대입하면

$$
y(t)=y_0\,e^{kt}.
$$

- 시간에 따른 상대변화율은 상수다: $$\frac{y'(t)}{y(t)}=k$$.  
- 로그를 취하면 직선이 된다: $$\ln y(t)=\ln y_0 + kt$$.

---

## 3. 이산모델과 연속모델의 연결

작은 시간 간격 $$\Delta t$$ 에 대해
$$
y(t+\Delta t)\approx y(t)+k\,y(t)\Delta t
\;=\;(1+k\Delta t)\,y(t).
$$

이를 $$n=\frac{t}{\Delta t}$$ 번 반복하면
$$
y(t)\approx (1+k\Delta t)^{t/\Delta t}\,y_0
\;\xrightarrow[\Delta t\to 0]{}\; y_0\,e^{kt}.
$$

퍼센트 변화율이 기간당 $$p$$ (예: 매년 5% 성장이면 $$p=0.05$$)일 때, 연속 등가 성장률은

$$
k=\ln(1+p).
$$

반대로, 연속률 $$k$$ 를 기간 퍼센트로 바꾸면

$$
p=e^{k}-1.
$$

---

## 4. 성장과 감소의 정량 지표

### 4.1 배가 시간(성장)

$$
y(t)=y_0\,e^{kt},\quad y(T_2)=2y_0
\;\Rightarrow\;
T_2=\frac{\ln 2}{k}.
$$

### 4.2 반감기(감소)

$$
y(t)=y_0\,e^{-k t},\quad y(T_{1/2})=\frac{y_0}{2}
\;\Rightarrow\;
T_{1/2}=\frac{\ln 2}{k}.
$$

배가 시간과 반감기 공식의 형태가 동일하다는 점에 주목하라. 부호만 다를 뿐, “배가/반감”이라는 목표 수준이 같은 로그 상수 $$\ln 2$$ 를 만든다.

### 4.3 일반적인 배수·분수 시간

목표가 $$\alpha\,y_0\ (\alpha>0)$$ 라면
$$
T(\alpha)=\frac{\ln \alpha}{k}.
$$

예) 세 배 시간: $$T(3)=\frac{\ln 3}{k}$$, 10%로 감소(90% 남김): $$T(0.9)=\frac{\ln 0.9}{k}<0$$ (감소 모델에서는 $$k<0$$ 를 사용).

---

## 5. 매개변수 추정(데이터로부터 k 구하기)

### 5.1 두 지점만 있을 때

시간 $$t_1<t_2$$, 관측 $$y_1,y_2>0$$ 이면

$$
k=\frac{\ln y_2-\ln y_1}{t_2-t_1},\qquad
y_0=y_1\,e^{-k t_1}.
$$

### 5.2 여러 점(최소제곱 선형회귀)

로그 선형화:
$$
\ln y_i = \beta_0 + \beta_1 t_i + \varepsilon_i, \quad \beta_1=k,\ \beta_0=\ln y_0.
$$

- 오차가 상대적(곱셈적)일 때 적절하다.
- 가중을 둘 때는 분산 구조를 고려한다(예: 측정 정밀도가 크면 더 큰 가중).

### 5.3 반감기/배가시간으로부터

- 반감기 주어짐: $$k=\frac{\ln 2}{T_{1/2}}$$ (감소 모델에서는 실제 식 $$y=y_0 e^{-kt}$$ 에서 $$k>0$$ 로 두고 지수에 음부호를 둔다.)
- 배가시간 주어짐: $$k=\frac{\ln 2}{T_2}$$.

---

## 6. 시간의존 성장률(비정상 계열)

성장률이 시간에 따라 변하면

$$
\frac{dy}{dt}=k(t)\,y,\qquad
y(t)=y_0\exp\left(\int_0^t k(s)\,ds\right).
$$

예) 계절변동 모델: $$k(t)=k_0+k_1\sin(\omega t)$$ 이면

$$
y(t)=y_0\exp\!\left(k_0 t - \frac{k_1}{\omega}\cos(\omega t)+\frac{k_1}{\omega}\right)
$$

(상수는 초기조건으로 흡수 가능). 누적 효과는 **적분된 성장률**로 결정됨을 알 수 있다.

---

## 7. 응용 모델

### 7.1 연속 복리

$$
A(t)=P\,e^{rt}.
$$

- 배가 시간: $$T_2=\frac{\ln 2}{r}$$.
- 연 5%로 10년:
  $$
  A(10)=P\,e^{0.05\times 10}=P\,e^{0.5}\approx 1.6487\,P.
  $$

복리 주기가 연 12회(월복리)인 이산 모델:
$$
A_m(t)=P\left(1+\frac{r}{m}\right)^{mt}\xrightarrow[m\to\infty]{}P e^{rt}.
$$

### 7.2 방사성 붕괴(감소)

$$
N(t)=N_0\,e^{-\lambda t},\quad T_{1/2}=\frac{\ln 2}{\lambda}.
$$

예) 탄소-14 반감기 약 5730년:
$$
\lambda=\frac{\ln 2}{5730}\approx 1.2097\times 10^{-4}\ \text{yr}^{-1}.
$$

### 7.3 1차 약동학(혈중 농도 감소)

$$
C(t)=C_0\,e^{-k t},\quad k=\frac{\ln 2}{t_{1/2}}.
$$

### 7.4 RC 회로 방전

콘덴서 전압:
$$
V(t)=V_0\,e^{-t/(RC)}.
$$

시간상수 $$\tau=RC$$: $$V(\tau)=V_0/e$$.

---

## 8. 근사와 부등식

- 작은 $$x$$ 에서
  $$
  e^x\approx 1+x+\frac{x^2}{2}.
  $$
- 볼록성으로부터
  $$
  e^x\ge 1+x\quad(\text{모든 }x).
  $$

지수모형을 선형 근사로 사용할 때는 시간·규모가 충분히 작아야 한다(잔차 항의 크기 검토).

---

## 9. 모델 적합 및 예측 파이프라인(코드 포함)

아래 코드는 합성 데이터로 성장률 $$k$$ 와 초기값 $$y_0$$ 를 추정하고, 배가시간·반감기·예측을 계산한다.

```python
# 지수적 성장/감소 파이프라인: 추정(k, y0), 지표, 예측
import numpy as np

# 1) 합성 데이터 생성(성장 예: k=0.12/yr, y0=100)
rng = np.random.default_rng(42)
t = np.linspace(0, 10, 21)     # 0~10년, 21점
y_true = 100*np.exp(0.12*t)
# 상대오차 3%의 로그정규 잡음
noise = rng.normal(0, 0.03, size=t.size)
y_obs  = y_true*np.exp(noise)

# 2) 로그 선형화 후 최소제곱
X = np.vstack([np.ones_like(t), t]).T  # [1, t]
beta_hat, *_ = np.linalg.lstsq(X, np.log(y_obs), rcond=None)
ln_y0_hat, k_hat = beta_hat
y0_hat = np.exp(ln_y0_hat)

# 3) 지표 계산
doubling_time = np.log(2)/k_hat if k_hat>0 else np.inf
half_life = np.log(2)/(-k_hat) if k_hat<0 else np.inf

# 4) 예측
t_pred = np.linspace(0, 12, 49)
y_pred = y0_hat*np.exp(k_hat*t_pred)

# 5) 요약 출력
print(f"추정 y0 ≈ {y0_hat:.3f} (실제 100)")
print(f"추정 k  ≈ {k_hat:.5f} /yr (실제 0.12)")
print(f"배가시간 ≈ {doubling_time:.3f} yr")
print(f"반감기   ≈ {half_life if np.isfinite(half_life) else '성장모델(해당없음)'}")
```

가중회귀(측정분산이 시간이 지날수록 커지는 경우)나 이상치 강건회귀는 데이터 특성에 맞게 한다.