---
layout: post
title: 미적분 - 역삼각함수
date: 2025-08-07 22:20:23 +0900
category: 미적분
---
# 역삼각함수 (Inverse Trigonometric Functions)

> **핵심 요약**
> - 역삼각함수는 삼각함수가 **일대일이 되도록 정의역을 제한**해 만든 역함수.
> - 대표 도함수:  
>   \(\arcsin' x=\frac{1}{\sqrt{1-x^2}},\ \arccos' x=-\frac{1}{\sqrt{1-x^2}},\ \arctan' x=\frac{1}{1+x^2}\)  
>   \(\arccot' x=-\frac{1}{1+x^2},\ \arcsec' x=\frac{1}{|x|\sqrt{x^2-1}},\ \arccsc' x=-\frac{1}{|x|\sqrt{x^2-1}}\).
> - 실전 포인트: **주값(principal value)**, **부호·분모 제약**, **atan2 사용**, **SSA 모호성** 등.

---

## 1) 왜 ‘정의역 제한’이 필요한가?

삼각함수는 주기적이라 그대로는 역이 존재하지 않는다.  
따라서 **단조**가 되도록 최소 구간을 정해 **주값(branch)**을 선택한다.

| 역함수 | 정의 (의미) | 정의역(입력) | 치역(출력, 주값 구간) | 단조성 |
|---|---|---|---|---|
| \(\arcsin x\) | \(y=\arcsin x \iff \sin y=x\) | \([-1,1]\) | \(\left[-\frac{\pi}{2},\frac{\pi}{2}\right]\) | 증가 |
| \(\arccos x\) | \(y=\arccos x \iff \cos y=x\) | \([-1,1]\) | \([0,\pi]\) | 감소 |
| \(\arctan x\) | \(y=\arctan x \iff \tan y=x\) | \(\mathbb{R}\) | \(\left(-\frac{\pi}{2},\frac{\pi}{2}\right)\) | 증가 |
| \(\arccot x\) | \(y=\arccot x \iff \cot y=x\) | \(\mathbb{R}\) | \((0,\pi)\) | 감소 |
| \(\arcsec x\) | \(y=\arcsec x \iff \sec y=x\) | \((-\infty,-1]\cup[1,\infty)\) | \([0,\pi]\setminus\{\tfrac{\pi}{2}\}\) | 증가(분할) |
| \(\arccsc x\) | \(y=\arccsc x \iff \csc y=x\) | \((-\infty,-1]\cup[1,\infty)\) | \(\left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right]\setminus\{0\}\) | 감소(분할) |

**그래프 관찰 포인트**
- 역함수는 원함수의 그래프를 **\(y=x\)에 대해 대칭** 이동한 것.
- \(\arctan\)은 수평 점근선 \(y=\pm\frac{\pi}{2}\)을 가짐.  
- \(\arccos\)는 \([0,\pi]\)에서 감소.

---

## 2) 도함수 공식과 **증명(음함수 미분)**

### 2.1 \(\arcsin x\)
\[
y=\arcsin x \iff \sin y=x
\]
양변을 \(x\)에 대해 미분:
\[
\cos y\cdot \frac{dy}{dx}=1
\quad\Rightarrow\quad
\frac{dy}{dx}=\frac{1}{\cos y}=\frac{1}{\sqrt{1-\sin^2 y}}=\frac{1}{\sqrt{1-x^2}}
\]
- 유효범위: \(|x|<1\). 경계 \(x=\pm1\)에서는 도함수가 발산.

### 2.2 \(\arccos x\)
\[
y=\arccos x \iff \cos y=x
\Rightarrow
-\sin y\cdot \frac{dy}{dx}=1
\Rightarrow
\frac{dy}{dx}=-\frac{1}{\sin y}=-\frac{1}{\sqrt{1-\cos^2 y}}=-\frac{1}{\sqrt{1-x^2}}.
\]

### 2.3 \(\arctan x\)
\[
y=\arctan x \iff \tan y=x
\Rightarrow
\sec^2 y\cdot \frac{dy}{dx}=1
\Rightarrow
\frac{dy}{dx}=\cos^2 y=\frac{1}{1+\tan^2 y}=\frac{1}{1+x^2}.
\]

### 2.4 \(\arccot x\)
\[
y=\arccot x \iff \cot y=x
\Rightarrow
(-\csc^2 y)\cdot \frac{dy}{dx}=1
\Rightarrow
\frac{dy}{dx}=-\frac{1}{1+x^2}.
\]

### 2.5 \(\arcsec x\), \(\arccsc x\)
\[
y=\arcsec x \iff \sec y=x,\quad \sec y\tan y\cdot \frac{dy}{dx}=1
\Rightarrow
\frac{dy}{dx}=\frac{1}{\sec y\tan y}.
\]
\(\sec y= x,\ \tan^2 y=\sec^2 y-1=x^2-1\). 부호 문제를 피하려고 표준형으로:
\[
\boxed{\ \frac{d}{dx}\arcsec x=\frac{1}{|x|\sqrt{x^2-1}}\ },\quad |x|>1.
\]
동일하게
\[
\boxed{\ \frac{d}{dx}\arccsc x=-\frac{1}{|x|\sqrt{x^2-1}}\ },\quad |x|>1.
\]

> **왜 \(|x|\)가 필요?**  
> \(\tan y=\pm\sqrt{x^2-1}\)에서 부호가 \(y\)의 사분면/주값에 의존한다. \(|x|\)를 넣으면 모든 주값에서 통일된 **올바른 부호**를 보장.

---

## 3) 대표 적분(역삼각함수 유도형)

다음은 자주 쓰이는 “표준형” 적분:

- \(\displaystyle \int \frac{1}{\sqrt{1-x^2}}\,dx = \arcsin x + C\)  
- \(\displaystyle \int \frac{1}{1+x^2}\,dx = \arctan x + C\)  
- \(\displaystyle \int \frac{1}{|x|\sqrt{x^2-1}}\,dx = \arcsec |x| + C\) (또는 \(\operatorname{arccosh}\) 형태와 등가)

### 예제 A — 체인룰 결합
\[
\frac{d}{dx}\big[\arcsin(2x)\big]
= \frac{1}{\sqrt{1-(2x)^2}}\cdot 2
= \frac{2}{\sqrt{1-4x^2}}.
\]

### 예제 B — 표준형 적분
\[
\int \frac{dx}{\sqrt{1-x^2}}
= \arcsin x + C,\qquad
\int \frac{dx}{1+x^2}
= \arctan x + C.
\]

---

## 4) 역삼각함수 **관계식·항등식**

- 상보관계:
  \[
  \arcsin x + \arccos x = \frac{\pi}{2},\quad
  \arctan x + \arccot x = \frac{\pi}{2}.
  \]
- 역함수 교환:
  \[
  \arcsec x=\arccos\!\left(\frac{1}{x}\right),\quad
  \arccsc x=\arcsin\!\left(\frac{1}{x}\right)\quad(|x|\ge1).
  \]
- \(\arctan\)의 합 공식(주값 주의):
  \[
  \arctan a + \arctan b =
  \begin{cases}
  \arctan\!\left(\dfrac{a+b}{1-ab}\right),&ab<1,\ \text{그리고 분모\(\neq0\)}\\[6pt]
  \arctan\!\left(\dfrac{a+b}{1-ab}\right)+\pi,& a,b>0,\ ab>1\\
  \arctan\!\left(\dfrac{a+b}{1-ab}\right)-\pi,& a,b<0,\ ab>1
  \end{cases}
  \]
  (실전에서는 **atan2**로 안전하게 처리하는 것이 좋다—아래 §8 참고)

---

## 5) 방정식 풀이에서의 ‘주값 vs 일반해’

예: \(\sin \theta=\frac{1}{2}\).

- **주값**: \(\theta_0=\arcsin\!\left(\frac{1}{2}\right)=\frac{\pi}{6}\).
- **일반해** (실수 전체에서의 해):  
  \[
  \theta=\frac{\pi}{6}+2k\pi\quad\text{또는}\quad \theta=\pi-\frac{\pi}{6}+2k\pi=\frac{5\pi}{6}+2k\pi,\quad k\in\mathbb{Z}.
  \]
> 해석: 역삼각함수는 **대표각(주값)** 하나만 내놓는다. **모든 해**를 원하면 주기성·사분면 규칙을 추가해야 한다.

---

## 6) 기하/공학 응용: 삼각측량 & 로봇/신호각

### 6.1 직각삼각형에서 각 구하기
- \(\theta=\arctan\!\left(\dfrac{\text{맞은변}}{\text{인접변}}\right)\) 대신 **\(\operatorname{atan2}(y,x)\)** 사용 권장:
  - \(\operatorname{atan2}(y,x)\)는 사분면 정보를 보존 → \((-π,π]\) 범위의 올바른 각.

### 6.2 사인 법칙의 SSA(두 변과 끼지 않은 각) 모호성
- \(a,b,\angle A\)가 주어지면 \(\sin B = \dfrac{b\sin A}{a}\).  
- \(\arcsin\)은 주값만 반환 → \(B\) 또는 \(\pi-B\) **두 해** 가능(기하적으로 두 삼각형).  
- 조건에 따라 **해가 없거나(높이가 더 큼)**, **두 해** 또는 **한 해**.

---

## 7) 해석학적 성질 (단조성·볼록성·급수)

- 단조:
  \(\arcsin,\arctan\)은 증가, \(\arccos\)은 감소.
- 2계 도함수(예: \(\arctan''x=-\dfrac{2x}{(1+x^2)^2}\))로 볼록/오목 판별 가능.
- 맥클로린 전개:
  \[
  \arctan x=\sum_{n=0}^{\infty}(-1)^n\frac{x^{2n+1}}{2n+1},\quad |x|\le1,\ x\neq\pm1\text{에서 조건부수렴}.
  \]
  \[
  \arcsin x=\sum_{n=0}^{\infty}\frac{(2n)!}{4^n(n!)^2}\frac{x^{2n+1}}{2n+1},\quad |x|\le1.
  \]
  수치 근사·오차 추정에 유용.

---

## 8) 수치 안정성 팁 (프로그래밍)

- **각도 계산은 \(\operatorname{atan2}(y,x)\)**:  
  \(\arctan(y/x)\)는 \(x\approx0\)에서 폭발적으로 불안정하고 사분면 판단을 잃는다.
- \(\arccos x\) 근처 \(x\approx\pm1\): \(\sqrt{1-x^2}\)가 **소수 정밀도 손실** 유발.  
  대안:  
  \[
  \arccos x = 2\arctan\!\left(\sqrt{\frac{1-x}{1+x}}\right)
  \]
  (수치적으로 더 안정적, \(x\)가 1에 가까울 때).
- \(\arcsin x\)도  
  \[
  \arcsin x = \operatorname{sgn}(x)\cdot 2\arctan\!\left(\frac{|x|}{1+\sqrt{1-x^2}}\right)
  \]
  로 안정화.
- 역삼각함수 미분/적분의 수치 검증에는 **중심차분 + 적분의 수치근사**(사다리꼴/심프슨) 활용.

---

## 9) 완전 예제 모음 (해설 포함)

### 예제 1 — 도함수/체인룰
\[
f(x)=\arctan(3x-1)\ \Rightarrow\ 
f'(x)=\frac{3}{1+(3x-1)^2}.
\]

### 예제 2 — 합성 적분
\[
\int \frac{2\,dx}{\sqrt{9-x^2}}
= 2\int \frac{dx}{\sqrt{(3)^2-x^2}}
= 2\arcsin\!\left(\frac{x}{3}\right)+C.
\]

### 예제 3 — 항등식 활용(상보관계)
\[
\arcsin\left(\frac{3}{5}\right)+\arccos\left(\frac{3}{5}\right)=\frac{\pi}{2}.
\]

### 예제 4 — \(\arctan\) 합 공식 (부호·사분면 주의)
\[
\arctan 2 + \arctan 3
= \arctan\!\left(\frac{2+3}{1-6}\right)
= \arctan\!\left(-\frac{5}{5}\right)=\arctan(-1)=-\frac{\pi}{4}.
\]
그러나 \(2,3>0\)이고 \(ab=6>1\)이므로 \(\boxed{\arctan 2+\arctan 3=\frac{3\pi}{4}}\) (규칙에 따라 \(\pi\) 보정).

### 예제 5 — 삼각측량(좌표→각)
평면에서 벡터 \((x,y)\)의 방향각 \(\theta\)는  
\[
\theta=\operatorname{atan2}(y,x)\in(-\pi,\pi].
\]
사분면을 자동 처리하므로 \(\arctan(y/x)\)보다 안전.

### 예제 6 — SSA 모호성 시뮬
주어진 \(a=7,b=9,\angle A=40^\circ\).  
\(\sin B = \frac{b\sin A}{a}=\frac{9\sin40^\circ}{7}\approx 0.8279\).  
\(B_1=\arcsin(0.8279)\approx 55.9^\circ\) 또는 \(B_2=180^\circ-55.9^\circ=124.1^\circ\).  
각각에 대해 \(C\)와 삼각형 성립 여부를 점검.

---

## 10) 파이썬 코드 예제

> 아래 코드는 설명용. (실행 시 `numpy`, `matplotlib`, `sympy` 필요)

### 10.1 도함수 검증(심볼릭)
```python
import sympy as sp

x = sp.symbols('x')
f = sp.asin(x) + sp.acos(x)  # ≡ π/2
print(sp.simplify(sp.diff(f, x)))  # 0
g = sp.atan(3*x - 1)
print(sp.simplify(sp.diff(g, x)))  # 3/(1+(3x-1)^2)
```

### 10.2 수치·시각화: arcsin vs 도함수
```python
import numpy as np
import matplotlib.pyplot as plt

xs = np.linspace(-0.99, 0.99, 400)
f  = np.arcsin(xs)
fp = 1.0/np.sqrt(1.0 - xs**2)

plt.plot(xs, f, label='arcsin(x)')
plt.plot(xs, fp, label="d/dx arcsin(x)", linestyle='--')
plt.axhline(0)
plt.legend(); plt.grid(True); plt.title("arcsin와 도함수")
plt.show()
```

### 10.3 삼각형 각도(atan2 이용)
```python
import math

def angle_of_vector(x, y):
    return math.atan2(y, x)  # (-π, π]

print(angle_of_vector( 1, 1))  # 45° (π/4)
print(angle_of_vector(-1, 1))  # 135° (2사분면)
```

### 10.4 수치안정: acos 안정화
```python
import numpy as np

def acos_stable(x):
    x = np.clip(x, -1.0, 1.0)  # 안전 클리핑
    t = np.sqrt((1.0 - x)/(1.0 + x))
    return 2.0*np.arctan(t)

for val in [0.0, 0.8, 0.9999999]:
    print(np.arccos(val), acos_stable(val))
```

---

## 11) 연습 문제(풀이 스케치 포함)

1. **미분**: \(y=\arccos(2x-1)\)의 도함수.  
   - 풀이: \(y'=-\dfrac{2}{\sqrt{1-(2x-1)^2}}\).

2. **적분**: \(\displaystyle\int \frac{dx}{(x^2+1)^2}\).  
   - 힌트: 부분분수/표준결과 → \(\dfrac{x}{2(1+x^2)}+\dfrac{1}{2}\arctan x + C\).

3. **항등식**: \(\arcsin x - \arccos x = ?\)  
   - 풀이: \(\arcsin x - \arccos x = x - \Big(\frac{\pi}{2}-\arcsin x\Big)=2\arcsin x - \frac{\pi}{2}\).

4. **방정식**: \(\tan \theta = -2,\ \theta\in(0,\pi)\).  
   - 주값 \(\arctan(-2)\in(-\frac{\pi}{2},0)\). (Ⅱ,Ⅳ사분면 주의)  
   - \((0,\pi)\)에서 \(\tan<0\)는 **Ⅱ사분면** → \(\theta=\pi+\arctan(-2)\)가 아닌, \(\theta=\arctan(-2)+\pi\in(\frac{\pi}{2},\pi)\).

5. **SSA**: \(a=5, b=6, A=30^\circ\). 가능한 \(B\)들을 구하라.  
   - \(\sin B=\dfrac{6\sin30^\circ}{5}=\dfrac{3}{5}\).  
   - \(B=\arcsin(0.6)\approx 36.87^\circ\) 또는 \(143.13^\circ\). 각에 따라 \(C\)와 삼각형 성립 검토.

---

## 12) 자주 하는 실수 & 체크리스트

- [ ] 역삼각 **주값 범위**를 확인했는가? (\(\arccos\)는 \([0,\pi]\)에서 감소!)  
- [ ] \(\arcsec,\arccsc\) 도함수에 **\(|x|\)**를 빼먹지 않았는가?  
- [ ] \(\arctan\) 합 공식에서 **\(\pi\) 보정**을 점검했는가? (또는 `atan2` 사용)  
- [ ] \(|x|\approx1\)에서의 \(\arccos,\arcsin\) **수치 불안정**을 피했는가?  
- [ ] 방정식은 **주값**이 아닌 **일반해**가 필요한지 확인했는가?

---

## 13) 마무리 요약

- **정의역 제한**으로 역함수(주값)를 만든다.  
- **미분·적분 표준형**을 숙지하면 계산이 빨라진다.  
- **수치 해석**에서는 `atan2`와 안정 변환식을 습관화하면 버그를 크게 줄인다.  
- 기하·물리·신호처리·로보틱스에서 **각도 추정**과 **해석**에 필수 도구!