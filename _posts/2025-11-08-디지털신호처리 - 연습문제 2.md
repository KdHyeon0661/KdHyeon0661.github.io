---
layout: post
title: 디지털신호처리 - 연습문제 2
date: 2025-11-08 21:25:23 +0900
category: 디지털신호처리
---
# 연습문제 세트 2 풀이 — DTFT 정의·성질·LTI 주파수응답·샘플링/복원

## (1–7) 파트 A. DTFT 정의/기본 신호

### 문제 1. DTFT 정의값 계산(짧은 신호)

#### 문제 재진술

짧은 신호에 대해 DTFT 정의식을 아래처럼 **직접 합산**해라.

- $$x[n]=\{1,2,1\},\ n=0,1,2$$
- 그 외 $$x[n]=0$$

#### DTFT 정의

DTFT(Discrete-Time Fourier Transform) 정의:

$$
X(e^{j\omega})=\sum_{n=-\infty}^{\infty} x[n]e^{-j\omega n}.
$$

이 신호는 유한 길이이므로 실제로는 3항만 남는다.

#### 직접 계산

$$
\begin{aligned}
X(e^{j\omega})
&=\sum_{n=0}^{2}x[n]e^{-j\omega n}\\
&=x[0]e^{-j\omega\cdot 0}+x[1]e^{-j\omega\cdot 1}+x[2]e^{-j\omega\cdot 2}\\
&=1+2e^{-j\omega}+e^{-j2\omega}.
\end{aligned}
$$

따라서

$$
\boxed{X(e^{j\omega})=1+2e^{-j\omega}+e^{-j2\omega}}
$$

#### 해석 포인트(직관)

- 이 식은 **3탭 FIR 필터**의 주파수응답과 동일하다.
- $$e^{-j\omega}$$ 와 $$e^{-j2\omega}$$ 는 각각 1샘플, 2샘플 지연된 성분의 위상 회전을 나타낸다.
- 짧은 신호일수록 스펙트럼은 매끄럽지 않고 **주기적으로 진동하는 형태**를 띤다.

#### 실습(원본 유지)

```octave
w = linspace(-pi, pi, 2001);
X = 1 + 2*exp(-1j*w) + exp(-1j*2*w);
plot(w, abs(X)); grid on; xlabel('\omega'); ylabel('|X|'); title('DTFT of [1,2,1]');
```

#### 추가 실험(위상도 같이 보기)

```octave
subplot(2,1,1); plot(w,abs(X)); grid on; title('|X|');
subplot(2,1,2); plot(w,unwrap(angle(X))); grid on; title('phase');
```

#### 흔한 함정

- **정의에서 n 범위를 음수까지 포함한다고 착각**하고 불필요한 항을 더하는 실수
- $$e^{-j\omega n}$$ 의 부호를 반대로 쓰는 실수
- DTFT는 **$$2\pi$$-주기**이므로, 주파수 축 해석 시 항상 -π~π 기준으로 생각해야 한다.

---

### 문제 2. 임펄스열의 DTFT

#### 문제 재진술

$$x[n]=3\delta[n]-\delta[n-2]$$ 일 때 $$X(e^{j\omega})$$?

#### 임펄스의 기본쌍

기본쌍:

$$
\delta[n-n_0]\ \longleftrightarrow\ e^{-j\omega n_0}.
$$

즉, 임펄스는 주파수영역에서 “순수 위상(선형 위상)”만 남긴다.

#### 선형 결합 적용

$$
\begin{aligned}
X(e^{j\omega})
&=3\cdot 1\;-\;1\cdot e^{-j\omega\cdot 2}\\
&=3-e^{-j2\omega}.
\end{aligned}
$$

따라서

$$
\boxed{X(e^{j\omega})=3-e^{-j2\omega}}
$$

#### 크기/위상 직관

- 상수 3은 모든 주파수에서 동일한 DC 성분처럼 작용.
- 두 번째 항은 2샘플 지연의 위상 회전만 있음.
- 둘의 합이므로 크기 스펙트럼이 주파수에 따라 출렁인다.

#### 실습(원본 유지)

```octave
w=linspace(-pi,pi,4001); X = 3 - exp(-1j*2*w);
subplot(1,2,1); plot(w, abs(X)); grid on; title('|X|');
subplot(1,2,2); plot(w, angle(X)); grid on; title('∠X');
```

#### 흔한 함정

- $$\delta[n-2] \leftrightarrow e^{-j2\omega}$$ 를
  $$e^{-j\omega/2}$$ 같이 잘못 쓰는 실수(지연 크기와 각 주파수의 곱을 정확히 보라).
- 임펄스는 “주파수 이동”이 아니라 “위상 회전”을 만든다는 점 혼동.

---

### 문제 3. 지수 감쇠 신호의 DTFT

#### 문제 재진술

$$x[n]=a^n u[n],\ |a|<1$$
의 $$X(e^{j\omega})$$ 와 Z-변환 ROC를 쓰라.

#### 정의로 직접 합

$$u[n]$$ 때문에 $$n\ge 0$$ 영역만 남는다.

$$
\begin{aligned}
X(e^{j\omega})
&=\sum_{n=0}^{\infty} a^n e^{-j\omega n}\\
&=\sum_{n=0}^{\infty} (a e^{-j\omega})^n.
\end{aligned}
$$

이는 비율이 $$r=a e^{-j\omega}$$ 인 등비급수.

#### 등비급수 합(수렴 조건 포함)

수렴 조건 $$|r|<1 \iff |a|<1$$ 하에서

$$
\boxed{
X(e^{j\omega})=\frac{1}{1-ae^{-j\omega}}
}
$$

DTFT가 존재하려면 단위원이 Z-ROC에 포함되어야 하는데,
우측 신호의 ROC는

$$
\boxed{
\text{ROC: } |z|>|a|
}
$$

따라서 $$|a|<1$$ 이면 단위원 포함 → DTFT 존재.

#### 물리적/시스템적 직관

- $$a^n u[n]$$ 는 1차 IIR 시스템의 임펄스응답 형태.
- $$|a|<1$$ 이면 시간에서 감쇠 → 주파수에서 유한 이득.
- $$\omega=0$$ (DC)에서

$$
X(e^{j0})=\frac{1}{1-a}
$$

즉, DC 이득이 $$a$$ 에 의해 결정됨.

#### 실습(원본 유지)

```octave
a=0.8; w=linspace(-pi,pi,4096);
X = 1 ./ (1 - a*exp(-1j*w));
plot(w, abs(X)); grid on; title('|X| of a^n u[n], a=0.8');
```

#### 추가 실험(다양한 a 비교)

```octave
w=linspace(-pi,pi,4096);
for a=[0.2 0.6 0.9]
  X=1./(1-a*exp(-1j*w));
  plot(w,20*log10(abs(X)+1e-12)); hold on;
end
grid on; legend('a=0.2','a=0.6','a=0.9');
title('Effect of a on |X|');
```

#### 흔한 함정

- $$|a|<1$$ 을 무시하고 DTFT가 항상 존재한다고 착각.
- DTFT 수식을 Z-변환 수식 $$1/(1-az^{-1})$$ 과 혼동(단위원 대입 시 $$z=e^{j\omega}$$).

---

### 문제 4. 에너지 신호 Parseval 검증

#### 문제 재진술

길이 $$N=1024$$ 실수 랜덤 신호 $$x[n]$$ 에 대해 Parseval 정리를 DFT로 근사 검증하라.

Parseval(시간–주파수 에너지 동일성):

$$
\sum_{n=-\infty}^{\infty}|x[n]|^2
=
\frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2 d\omega.
$$

DFT에서는 아래 근사 관계로 확인한다.

#### DFT 버전 Parseval

DFT 정의를 $$X[k]=\sum_{n=0}^{N-1} x[n]e^{-j2\pi kn/N}$$ 로 잡으면

$$
\sum_{n=0}^{N-1}|x[n]|^2
=
\frac{1}{N}\sum_{k=0}^{N-1}|X[k]|^2.
$$

즉 DTFT 적분을 **주파수 샘플 합**으로 바꾼 것이 DFT Parseval.

#### 실습(원본 유지)

```octave
N=1024; x=randn(1,N);
X=fft(x);
lhs = sum(abs(x).^2);
rhs = (1/N)*sum(abs(X).^2);
printf("Parseval error = %.3e\n", abs(lhs-rhs));
```

#### 실습 포인트

- 부동소수점 오차 때문에 0이 아니라 아주 작은 값이 나오는 게 정상.
- 창을 씌우면 Parseval 성립 형태가 달라질 수 있으니 **창 없이** 검증해야 한다.

#### 흔한 함정

- 정규화 계수(1/N, 1/√N 등)를 다른 규약으로 쓰면 Parseval 형태도 바뀐다.
  **자기가 쓰는 DFT 규약부터 명확히 고정**해야 한다.

---

### 문제 5. DTFT의 주기성 확인

#### 문제 재진술

문제 1의 DTFT가 $$2\pi$$-주기임을 $$\omega\to\omega+2\pi$$ 로 수치 확인하라.

#### 주기성 증명

$$
e^{-j(\omega+2\pi)n}
=
e^{-j\omega n}e^{-j2\pi n}
=
e^{-j\omega n}\cdot 1
=
e^{-j\omega n}.
$$

따라서 모든 항이 동일 → DTFT 전체가 $$2\pi$$-주기.

즉

$$
\boxed{
X(e^{j(\omega+2\pi)})=X(e^{j\omega})
}
$$

#### 실습(원본 유지)

```octave
w = linspace(-pi, 3*pi, 4001);
X = 1 + 2*exp(-1j*w) + exp(-1j*2*w);
plot(w, abs(X)); grid on; xlim([-pi,3*pi]); title('2π-periodicity');
```

#### 흔한 함정

- DTFT는 연속 주파수라 “주기성”이 DFT의 “순환성”과 다르다.
  DTFT는 **연속축 패턴이 정확히 반복**되는 것.

---

### 문제 6. 직사창의 DTFT(Dirichlet kernel)

#### 문제 재진술

$$
x[n]=\frac{1}{M},\quad 0\le n<M
$$

일 때 DTFT를 쓰고, 0 부근 메인로브/사이드로브를 해석하라.

#### 정의로 합

$$
X(e^{j\omega})
=\sum_{n=0}^{M-1}\frac{1}{M}e^{-j\omega n}
=\frac{1}{M}\sum_{n=0}^{M-1}(e^{-j\omega})^n.
$$

등비합:

$$
\sum_{n=0}^{M-1} r^n=\frac{1-r^M}{1-r},
\quad r=e^{-j\omega}.
$$

따라서

$$
X(e^{j\omega})
=\frac{1}{M}\cdot\frac{1-e^{-j\omega M}}{1-e^{-j\omega}}.
$$

이를 위상 중심 형태로 정리하면

$$
\boxed{
X(e^{j\omega})
=
\frac{1}{M}
\frac{\sin(\omega M/2)}{\sin(\omega/2)}
e^{-j\omega(M-1)/2}
}
$$

(Dirichlet kernel)

#### 메인로브/사이드로브 해석

- $$\frac{\sin(\omega M/2)}{\sin(\omega/2)}$$ 가 주파수 크기 패턴을 결정.
- 영점은 $$\omega M/2 = k\pi$$ 즉

$$
\omega=\frac{2\pi k}{M},\ k\neq 0.
$$

따라서 메인로브 폭(첫 영점 간 거리):

$$
\Delta\omega_\text{main} \approx \frac{4\pi}{M}.
$$

즉
- $$M$$ 이 커질수록 메인로브는 좁아지고(주파수 분해능 상승)
- 대신 사이드로브는 더 촘촘히 생긴다.

#### 실습(원본 유지)

```octave
M=31; w=linspace(-pi,pi,8193);
H = (sin(w*M/2)./(M*sin(w/2))).*exp(-1j*w*(M-1)/2);
plot(w, 20*log10(abs(H)+1e-12)); grid on; title('Rect window spectrum [dB]');
```

#### 흔한 함정

- $$\omega=0$$ 에서 $$0/0$$ 형태가 나오므로 수치 계산 시 NaN이 뜰 수 있다.
  이때는 극한값 $$X(e^{j0})=1$$ 로 치환해야 한다.
- 직사창은 사이드로브가 크기 때문에 **스펙트럼 누설(leakage)** 을 크게 만든다.
  창 함수 비교로 이어지는 핵심 예제.

---

### 문제 7. DTFT 정확 샘플러 작성(짧은 신호용)

#### 문제 재진술

정의 그대로 직접합 루틴으로 $$[1,2,3,2,1]$$ 의 DTFT를 그려라.

#### 핵심 아이디어

정의식:

$$
X(e^{j\omega_k})
=\sum_{n=0}^{L-1} x[n]e^{-j\omega_k n}
$$

을 **원 그대로** 구현한 것이 dtft_exact.

#### 실습(원본 유지)

```octave
function [w,X]=dtft_exact(x,M)
  if nargin<2, M=4096; end
  n=0:numel(x)-1; w=linspace(-pi,pi,M); X=zeros(1,M);
  for k=1:M, X(k)=sum(x.*exp(-1j*w(k)*n)); end
endfunction
x=[1 2 3 2 1]; [w,X]=dtft_exact(x,4096);
plot(w,abs(X)); grid on; title('|DTFT| of [1 2 3 2 1]');
```

#### 실습 포인트

- `fft`는 단위원 위 샘플을 빠르게 계산하는 특수한 경우.
  dtft_exact는 **어떤 주파수 격자에도 적용 가능한 순수 정의 구현**.

#### 흔한 함정

- 신호가 대칭이라면 위상은 선형이 되는 경향이 있으나,
  **정확 선형위상은 계수 대칭 조건**이 필요(문제 18과 연결).

---

## 파트 B. DTFT의 성질 (8–14)

### 문제 8. 선형성

#### 성질

DTFT 선형성:

$$
\mathcal{F}\{a x[n]+b y[n]\}
=aX(e^{j\omega})+bY(e^{j\omega}).
$$

#### 정의로 증명

$$
\begin{aligned}
\mathcal{F}\{a x+b y\}
&=\sum_n (a x[n]+b y[n])e^{-j\omega n}\\
&=a\sum_n x[n]e^{-j\omega n}+b\sum_n y[n]e^{-j\omega n}\\
&=aX+bY.
\end{aligned}
$$

#### 실습(원본 유지)

```octave
x=[1 0 1]; y=[0 1 0]; a=2; b=-1; N=4096; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
Y=fftshift(fft([y zeros(1,N-numel(y))]));
LHS=fftshift(fft([a*x+b*y zeros(1,N-numel(x))]));
RHS=a*X + b*Y;
printf("linearity error = %.2e\n", norm(LHS - RHS)/norm(LHS));
```

#### 함정

- `fftshift`를 안 맞춘 채 비교하면 위상 정렬이 달라져 에러처럼 보일 수 있다.
- 규약 차이(정규화)도 반드시 확인.

---

### 문제 9. 시간 시프트 ↔ 선형 위상

#### 성질

$$
x[n-n_0]
\ \longleftrightarrow\
e^{-j\omega n_0}X(e^{j\omega}).
$$

#### 증명

정의식에 치환 $$m=n-n_0$$ 하면

$$
\sum_n x[n-n_0]e^{-j\omega n}
=e^{-j\omega n_0}\sum_m x[m]e^{-j\omega m}.
$$

#### 의미

- 시간 지연은 주파수 영역에서 **선형 위상(직선 기울기)** 을 만든다.
- 크기는 바뀌지 않는다.

#### 실습(원본 유지)

```octave
x=hamming(41)'; n0=7; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
xs=circshift([x zeros(1,N-numel(x))],[0 n0]);
Xs=fftshift(fft(xs));
phase = exp(-1j*w*n0);
err = norm(Xs - X.*phase)/norm(Xs);
printf("time-shift property error = %.2e\n", err);
```

#### 함정

- `circshift`는 **순환 시프트**라 끝이 wrap된다.
  유한 길이 신호의 “진짜 지연”을 검증하려면 충분한 zero-padding이 선행돼야 한다.

---

### 문제 10. 변조 ↔ 주파수 이동

#### 성질

$$
e^{j\omega_0 n}x[n]
\ \longleftrightarrow\
X(e^{j(\omega-\omega_0)}).
$$

#### 증명

$$
\sum_n e^{j\omega_0 n}x[n]e^{-j\omega n}
=\sum_n x[n]e^{-j(\omega-\omega_0)n}
=X(\omega-\omega_0).
$$

#### 직관

- 시간에서 복소 사인을 곱하면, 스펙트럼이 **그만큼 이동**한다.
- 실수 코사인을 곱하면 양측 이동 후 **두 개의 복사본**이 생김(AM 변조 직관).

#### 실습(원본 유지)

```octave
x=hamming(101)'; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
w0=0.4*pi; n=0:(numel(x)-1); xm=x.*exp(1j*w0*n);
Xm=fftshift(fft([xm zeros(1,N-numel(xm))]));
[~,kX]=max(abs(X)); [~,kM]=max(abs(Xm));
dw = w(kM)-w(kX); printf("peak shift ≈ %.3f (w0=%.3f)\n", dw, w0);
```

#### 함정

- FFT bin 격자가 $$\omega_0$$ 와 안 맞으면 peak가 정확히 그만큼 이동하지 않아 보일 수 있다.
  이건 수치 격자 문제이지 성질 위반이 아니다.

---

### 문제 11. 컨볼루션 정리

#### 성질

$$
y[n]=(x*h)[n]
\ \longleftrightarrow\
Y(e^{j\omega})=X(e^{j\omega})H(e^{j\omega}).
$$

#### 증명 스케치

$$
y[n]=\sum_k x[k]h[n-k].
$$

DTFT:

$$
\sum_n\sum_k x[k]h[n-k]e^{-j\omega n}
=\sum_k x[k]e^{-j\omega k}\sum_m h[m]e^{-j\omega m}
=XH.
$$

#### 실습(원본 유지)

```octave
x=randn(1,1024); h=hamming(31)'; y=conv(x,h,'same');
N=2^nextpow2(numel(x));
Yf = ifft(fft(x,N).*fft(h,N));
printf("conv theorem error = %.2e\n", norm(y - Yf(1:numel(y)))/norm(y));
```

#### 함정

- 선형 컨볼루션을 FFT로 계산하면 길이가 $$N+M-1$$ 이 된다.
  `same`으로 자른 결과와 비교할 때 길이 정렬을 맞춰야 한다.

---

### 문제 12. 시간 곱 ↔ 주파수 원형 컨볼루션

#### 성질(연속 DTFT 버전)

시간 영역 곱:

$$
x[n]h[n]
\ \longleftrightarrow\
\frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j\theta})H(e^{j(\omega-\theta)})\,d\theta.
$$

즉 주파수에서 **원형 컨볼루션(circular convolution)**.

#### DFT 격자에서의 단순화

DFT에서는

$$
\text{DFT}\{x\cdot h\}
=
\frac{1}{N}(X \circledast H).
$$

규약에 따라 $$1/N$$ 계수는 달라질 수 있다.

#### 실습(원본 유지)

```octave
N=256; n=0:N-1; x=cos(2*pi*4*n/N); h=cos(2*pi*8*n/N);
LHS = fft(x.*h);
RHS = (1/N)*(fft(x).*fft(h)); % DFT 정규화 규약 주의
printf("circular conv (DFT) error = %.2e\n", norm(LHS - RHS));
```

#### 함정

- DFT 정규화 규약(전방/역방에서 1/N을 어디에 두는지)에 따라 RHS 스케일이 달라진다.
- “시간 곱”은 주파수에서 단순 곱이 **아니라 컨볼루션**이라는 점이 핵심.

---

### 문제 13. 미분 유사 성질

#### 성질

DTFT에서 n-가중:

$$
n\,x[n]
\ \longleftrightarrow\
j \frac{d}{d\omega}X(e^{j\omega}).
$$

#### 증명

$$
X(\omega)=\sum_n x[n]e^{-j\omega n}.
$$

미분하면

$$
\frac{dX}{d\omega}
=\sum_n x[n]\frac{d}{d\omega}(e^{-j\omega n})
=\sum_n x[n](-jn)e^{-j\omega n}
=-j\sum_n n x[n]e^{-j\omega n}.
$$

따라서

$$
\boxed{
\mathcal{F}\{n x[n]\}=j\frac{dX}{d\omega}
}.
$$

#### 실습(원본 유지)

```octave
x=hann(65)'; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
n=0:(numel(x)-1); nx = n.*x;
dX_num = gradient(X)./gradient(w);
Xnx = fftshift(fft([nx zeros(1,N-numel(nx))]));
ratio = Xnx ./ (1j*dX_num);
printf("mean phase of ratio ≈ %.3f rad\n", angle(mean(ratio(isfinite(ratio)))));
```

#### 함정

- 수치 미분은 고주파 잡음에 매우 약하다.
  샘플 수 $$N$$ 을 크게 하고 창을 충분히 매끄럽게 주는 게 안정적이다.

---

### 문제 14. 실수 신호의 켤레짝대칭

#### 성질

$$
x[n]\in\mathbb{R}
\Rightarrow
X(-\omega)=X^*(\omega).
$$

따라서
- 크기 스펙트럼은 **짝대칭**
- 위상은 **홀대칭(부호 반전)**

#### 증명 스케치

$$
X^*(\omega)
=\left(\sum_n x[n]e^{-j\omega n}\right)^*
=\sum_n x[n]e^{+j\omega n}
=X(-\omega).
$$

(실수이므로 $$x[n]^*=x[n]$$)

#### 실습(원본 유지)

```octave
x=randn(1,513); N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
X_neg = fliplr(X); % w→-w
err = norm(X_neg - conj(X))/norm(X);
printf("conjugate symmetry error = %.2e\n", err);
```

#### 함정

- `fliplr(X)`가 정확히 $$-\omega$$ 매칭이 되려면 `w`도 동일 격자/정렬을 가져야 한다.

---

## 파트 C. LTI 주파수 영역 표현 (15–21)

### 문제 15. FIR의 주파수 응답

#### 문제 재진술

$$
h[n]=\frac{1}{3}\{1,1,1\}
$$

의 $$H(e^{j\omega})$$ 크기·위상·군지연을 그려라.

#### DTFT 정의로 $$H$$ 구하기

$$
H(e^{j\omega})=\sum_{n=0}^{2}\frac{1}{3}e^{-j\omega n}
=\frac{1}{3}\left(1+e^{-j\omega}+e^{-j2\omega}\right).
$$

이는 3포인트 평균(이동평균) FIR.

#### 직관

- 저주파 성분은 통과, 고주파는 감쇠 → **저역통과 필터**.
- 계수 대칭 → **선형위상** → 군지연이 일정.

#### 실습(원본 유지)

```octave
h=[1 1 1]/3; a=1; [H,w]=freqz(h,a,2048);
phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
subplot(3,1,1); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
subplot(3,1,2); plot(w/pi,phi); grid on; title('phase');
subplot(3,1,3); plot(w/pi,tau); grid on; title('group delay');
```

---

### 문제 16. IIR 1차의 정상상태 사인 응답

#### 문제 재진술

$$
y[n]-0.7y[n-1]=x[n],\quad x[n]=\cos(\omega_0 n).
$$

정상상태 출력 진폭/위상은?

#### 전달함수

$$
H(z)=\frac{1}{1-0.7 z^{-1}}.
$$

따라서

$$
H(e^{j\omega})=\frac{1}{1-0.7e^{-j\omega}}.
$$

#### LTI 고유함수 성질

사인(복소지수)은 LTI의 고유함수이므로 정상상태 출력은 입력 주파수 유지:

$$
\boxed{
y_{ss}[n]=|H(e^{j\omega_0})|\cos(\omega_0 n+\angle H(e^{j\omega_0}))
}
$$

#### 실습(원본 유지)

```octave
[b,a]=deal(1,[1 -0.7]); w0=0.4*pi; n=0:800;
x=cos(w0*n); y=filter(b,a,x); H=freqz(b,a,w0);
printf("|H|=%.3f, ∠H=%.3f rad\n", abs(H), angle(H));
```

---

### 문제 17. 극/영점 맵과 응답 직관

#### 핵심 직관

단위원에 가까운
- **극(pole)** → 해당 각 주파수 증폭
- **영점(zero)** → 해당 각 주파수 감쇠/노치

#### 실습(원본 유지)

```octave
pkg load signal
w0=pi/3; r=0.95;
b=poly([exp(1j*w0),exp(-1j*w0)]);
a=poly([r*exp(1j*w0), r*exp(-1j*w0)]);
[H,w]=freqz(b,a,4096);

subplot(1,2,1);
theta=linspace(0,2*pi,600); plot(cos(theta),sin(theta),'k--'); hold on
plot(real(roots(b)),imag(roots(b)),'ob'); plot(real(roots(a)),imag(roots(a)),'xr'); axis equal; grid on
title('zeros/poles'); legend('unit','zeros','poles');

subplot(1,2,2);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
```

---

### 문제 18. 선형위상 FIR의 군지연 상수성

#### 성질

대칭 FIR 계수에서

$$
\tau_g(\omega)\approx \frac{N-1}{2}
$$

로 거의 상수.

#### 실습(원본 유지)

```octave
N=101; b=fir1(N-1,0.3,hamming(N)); a=1; [H,w]=freqz(b,a,4096);
phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
printf("mean τg ≈ %.2f (theory %.2f)\n", mean(tau), (N-1)/2);
```

#### 함정

- 계수가 “정확 대칭”이 아니면 군지연이 요동칠 수 있다.

---

### 문제 19. 직렬/병렬 합성

#### 직렬

$$
H_{series}=H_1 H_2.
$$

#### 병렬

$$
H_{parallel}=aH_1+bH_2.
$$

#### 실습(원본 유지)

```octave
[b1,a1]=butter(3,0.3); [b2,a2]=cheby1(3,1,0.2);
[H1,w]=freqz(b1,a1,2048); [H2,~]=freqz(b2,a2,2048);
Hseries = H1.*H2; Hpar = 0.6*H1 + 0.4*H2;
plot(w/pi,20*log10(abs(Hseries)+1e-12)); grid on; title('Series magnitude');
figure; plot(w/pi,20*log10(abs(Hpar)+1e-12)); grid on; title('Parallel magnitude');
```

---

### 문제 20. PSD 전파

#### 성질

입력이 WSS(광의 정상)이고 LTI 통과 시

$$
\boxed{
S_y(e^{j\omega})=|H(e^{j\omega})|^2 S_x(e^{j\omega})
}
$$

#### 직관

- 시스템은 확률적 신호의 “주파수별 분산”을 $$|H|^2$$ 배로 스케일한다.
- 화이트 잡음(평탄 PSD)이 필터를 통과하면 필터 모양대로 PSD가 변형됨.

#### 실습(원본 유지)

```octave
N=2^16; w=randn(1,N); [b,a]=butter(4,0.25);
y=filter(b,a,w); W=hanning(N)'; U=sum(W.^2)/N;
Sx=(abs(fft(w.*W)).^2)/(N*U); Sy=(abs(fft(y.*W)).^2)/(N*U);
[H,~]=freqz(b,a,N); theory = (abs(H').^2).*Sx(:);
f=(0:N-1)/N;
plot(f(1:N/2),10*log10(Sy(1:N/2)+1e-12)); hold on
plot(f(1:N/2),10*log10(theory(1:N/2)+1e-12));
grid on; legend('Sy (meas)','|H|^2 Sx (theory)');
```

---

### 문제 21. IIR 안정성 검사

#### 안정 조건

BIBO 안정 ⇔ 모든 극이 단위원 안:

$$
\boxed{|p_k|<1\ \forall k}
$$

#### 실습(원본 유지)

```octave
[b,a]=butter(6,0.4); p=roots(a);
printf("max |pole| = %.5f (stable if <1)\n", max(abs(p)));
```

#### 함정

- 극이 단위원 밖이면 시간응답이 발산 → 필터가 불안정.
- 극이 단위원에 “아주 가깝게” 있으면 안정하더라도 과도응답이 길다.

---

## 파트 D. 아날로그 샘플링과 복원 (22–28)

> 이 파트는 “DTFT/DFT 기반 디지털 관점”을
> 연속시간 신호의 샘플링/복원까지 연결하는 종합 훈련이다.

### 문제 22. 샘플링 조건 판정

#### 문제 재진술

$$
x(t)=\cos(2\pi\cdot 9\text{k}t)+0.5\cos(2\pi\cdot 14\text{k}t).
$$

두 성분을 **무왜곡 복원**하려면 최소 샘플링 주파수 $$f_s$$ 는?

#### 나이퀴스트 정리

최대 주파수 $$f_B$$ 를 포함하는 대역제한 신호는

$$
\boxed{
f_s>2f_B
}
$$

를 만족해야 aliasing 없이 복원 가능.

여기서 $$f_B=14\text{kHz}$$.

따라서

$$
\boxed{
f_s>28\text{kHz}
}
$$

실무적으로는 여유를 둬 32 kHz 이상을 쓰는 게 일반적.

---

### 문제 23. 이상 샘플링 스펙트럼(이미지)

#### 성질

연속 시간 신호 샘플링 후 스펙트럼:

$$
\boxed{
X_s(j\Omega)=\frac{1}{T}\sum_{k=-\infty}^{\infty} X(j(\Omega-k\Omega_s))
}
$$

즉 원 스펙트럼이 $$\Omega_s=2\pi f_s$$ 간격으로 복제된다.

#### 문제 적용

베이스밴드 $$[0,6]\text{kHz}$$ 대역만 있는 신호를
$$f_s=20\text{kHz}$$ 로 샘플링하면 복제 중심은

$$
\boxed{
\pm k f_s,\ k\in\mathbb{Z}
}
$$

즉 $$0,\pm20,\pm40,\dots$$ kHz 주변에 이미지가 생긴다.

---

### 문제 24. sinc 보간 vs ZOH 복원 비교(충분 샘플링)

#### 복원 방법

- **이상 복원(sinc interpolation)**:
  대역제한·나이퀴스트 조건 하에서 원 신호 완전 복원
- **ZOH(Zero-Order Hold)**:
  샘플을 계단 형태로 유지 → 고주파에서 롤오프(sinc 형태) 발생

#### 실습(원본 유지)

```octave
pkg load signal
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref); % 2 ms
x = 0.7*cos(2*pi*3e3*t) + 0.4*cos(2*pi*8e3*t);
Fs=48e3; T=1/Fs; n=0:floor(t(end)*Fs); ts=n*T+t(1);
xs = interp1(t,x,ts,"linear");

function xr=sinc_rec(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T);
  end
endfunction

function xr=zoh(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    mask=(t>=t(1)+n(k)*T)&(t<t(1)+(n(k)+1)*T);
    xr(mask)=xs(k);
  end
endfunction

xr_sinc=sinc_rec(n,xs,Fs,t);
xr_zoh=zoh(n,xs,Fs,t);

subplot(2,1,1); plot(t*1e3,x,'k'); hold on;
plot(t*1e3,xr_sinc,'b--'); plot(t*1e3,xr_zoh,'r-.');
grid on; legend('cont','sinc','ZOH'); xlim([0,2]);

subplot(2,1,2);
N=1<<18; X=fft(x, N); Xs=fft(xr_sinc,N); Xz=fft(xr_zoh,N);
f=(0:N-1)*Fref/N;
plot(f(1:N/2)/1e3, 20*log10(abs(X(1:N/2))/max(abs(X))+1e-12),'k'); hold on
plot(f(1:N/2)/1e3, 20*log10(abs(Xs(1:N/2))/max(abs(X))+1e-12),'b');
plot(f(1:N/2)/1e3, 20*log10(abs(Xz(1:N/2))/max(abs(X))+1e-12),'r'); grid on
xlim([0,40]); xlabel('kHz'); ylabel('norm dB'); legend('cont','sinc','ZOH');
```

#### 함정

- ZOH는 “복원 필터”가 아니라 “DAC의 물리적 hold” 모델에 가깝다.
  이상 sinc 복원과 결과가 다르게 나오는 게 정상.

---

### 문제 25. Anti-Alias 필터의 효과(언더샘플링 상황)

#### 핵심

샘플링 전 저역통과(AA) 필터로 피크 대역 밖 성분을 제거하면 aliasing을 억제한다.

#### 실습(원본 유지)

```octave
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
x = cos(2*pi*3e3*t)+0.8*cos(2*pi*12e3*t); % 12k 포함
Fs=20e3; T=1/Fs; n=0:floor(t(end)*Fs); ts=n*T+t(1);
xs_noAA = interp1(t,x,ts,"linear");

% AA FIR (컷 9k)
b=fir1(511, 9e3/(Fref/2), hamming(512));
xAA=filtfilt(b,1,x);
xs_AA = interp1(t,xAA,ts,"linear");

function xr=sinc_rec(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n), xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T); end
endfunction

xr_noAA = sinc_rec(n,xs_noAA,Fs,t);
xr_AA   = sinc_rec(n,xs_AA,Fs,t);
plot(t*1e3, xr_noAA, 'r'); hold on; plot(t*1e3, xr_AA, 'b');
grid on; xlim([0,2]);
legend('recon (no AA)','recon (with AA)'); title('Anti-Alias 필터 효과');
```

---

### 문제 26. 재구성 LPF

#### 핵심

ZOH 출력은 이미지가 많기 때문에
샘플링 이후 **재구성(anti-imaging) LPF** 로 기본 대역만 남겨야 한다.

#### 실습(원본 유지)

```octave
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
x = 0.8*cos(2*pi*2e3*t)+0.5*cos(2*pi*5e3*t);
Fs=24e3; n=0:floor(t(end)*Fs); ts=n/Fs+t(1); xs=interp1(t,x,ts,"linear");

% ZOH
function xr=zoh(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    mask=(t>=t(1)+n(k)*T)&(t<t(1)+(n(k)+1)*T); xr(mask)=xs(k);
  end
endfunction
x_zoh=zoh(n,xs,Fs,t);

% AF: 컷 0.45*Fs
bAF=fir1(511, 0.45*Fs/(Fref/2), hamming(512));
x_rec=filtfilt(bAF,1,x_zoh);

plot(t*1e3,x,'k'); hold on; plot(t*1e3,x_zoh,'r-.'); plot(t*1e3,x_rec,'b--');
grid on; xlim([0,2]);
legend('cont','ZOH','ZOH+AF'); title('재구성 LPF 효과');
```

---

### 문제 27. alias 주파수 확인

#### alias 공식

샘플링 후 나타나는 alias 주파수:

$$
\boxed{
f_{alias}=|f_c-m f_s|
}
$$

여기서 $$m$$ 은 가장 가까운 정수.

#### 실습(원본 유지)

```octave
Fref=5e6; t=linspace(0,2e-3,2e-3*Fref); fc=150e3; x=cos(2*pi*fc*t);
Fs=60e3; n=0:floor(t(end)*Fs); xs=interp1(t,x,n/Fs+t(1),"linear");
N=1<<19; Xs=fft(xs, N); f=(0:N-1)*Fs/N; [~,k]=max(abs(Xs(1:N/2)));
printf("alias ≈ %.1f kHz (theory 30 kHz)\n", f(k)/1e3);
```

---

### 문제 28. 샘플링 지터에 의한 SNR 저하 근사

#### 근사식

샘플링 시간 지터(표준편차 $$\sigma_t$$)가 있을 때 SNR 근사:

$$
\boxed{
\mathrm{SNR}_{jit}\approx -20\log_{10}(2\pi f_{in}\sigma_t)
}
$$

#### 수치 대입

$$f_{in}=200\text{kHz},\ \sigma_t=10\text{ps}=10^{-11}\text{s}$$

$$
2\pi f_{in}\sigma_t
=2\pi\cdot 2\times10^5\cdot 10^{-11}
\approx 1.26\times 10^{-5}.
$$

따라서

$$
\mathrm{SNR}_{jit}
\approx -20\log_{10}(1.26\times 10^{-5})
\approx 98\ \mathrm{dB}.
$$

---

## 보너스 미니 프로젝트: 자동 채점 스크립트(선택)

아래 스크립트는 세트 2 전체 성질을 한 번에 교차검증하도록 만든 “자동 채점기”다.

```octave
function report = dsp_autocheck()
  report=struct();

  % 1) Parseval
  N=1024; x=randn(1,N); X=fft(x);
  report.parseval_err = abs(sum(abs(x).^2) - (1/N)*sum(abs(X).^2))/sum(abs(x).^2);

  % 2) time shift
  n0=11; X0=fft(x); xs=circshift(x,[0 n0]); Xs=fft(xs);
  w=2*pi*(0:N-1)/N; phase=exp(-1j*w*n0);
  report.shift_err = norm(Xs - X0.*phase)/norm(Xs);

  % 3) convolution theorem
  h=hann(33)'; y=conv(x,h,'same');
  Np=2^nextpow2(numel(x)); yc = ifft(fft(x,Np).*fft(h,Np)); yc=yc(1:numel(x));
  report.conv_err = norm(y - yc)/norm(y);

  % 4) LTI stability
  [b,a]=butter(5,0.3); report.max_pole = max(abs(roots(a)));

  % 5) sampling/reconstruction RMS (ideal sinc)
  Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
  xcont = 0.8*cos(2*pi*3e3*t)+0.4*cos(2*pi*8e3*t);
  Fs=48e3; n=0:floor(t(end)*Fs); ts=n/Fs+t(1); xs=interp1(t,xcont,ts,"linear");
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T);
  end
  report.recon_rms = sqrt(mean((xcont - xr).^2))/rms(xcont);
endfunction

r=dsp_autocheck(); disp(r);
```

---

## 마무리 요약 체크리스트(세트 2 핵심)

1) **DTFT 정의**
- 유한길이: 정의합이 그대로 폐형식.
- 임펄스열: 선형 위상만 남음.
- 감쇠 지수: 등비급수 → $$1/(1-ae^{-j\omega})$$.

2) **DTFT 성질**
- 선형성, 시간시프트(선형위상), 변조(주파수이동),
- 컨볼루션 정리, 시간곱↔주파수 원형컨볼루션,
- n-가중↔주파수 미분,
- 실수신호 켤레짝대칭,
- Parseval 에너지 동일성.

3) **LTI 주파수영역**
- $$H(e^{j\omega})$$ 계산,
- 극/영점의 단위원 거리로 이득 직관,
- 대칭 FIR → 선형위상 → 군지연 상수,
- 직렬/병렬 합성, PSD 전파,
- 안정성: 극 반경 $$<1$$.

4) **샘플링/복원**
- 나이퀴스트 조건,
- 스펙트럼 복제(이미지),
- sinc(이상) vs ZOH(실제) 복원,
- AA/AF 필터 역할,
- alias 주파수 계산,
- 지터로 인한 SNR 저하 근사.
