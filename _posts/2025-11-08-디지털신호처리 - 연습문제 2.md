---
layout: post
title: 디지털신호처리 - 연습문제 2
date: 2025-11-08 21:25:23 +0900
category: 디지털신호처리
---
# 연습문제 세트 2

## (1–7)

### 문제 1. DTFT 정의값 계산(짧은 신호)

**목표**: 정의에 따라 직접 합산
**문제**: \(x[n]=\{1,2,1\}\) for \(n=0,1,2\), 그 외 0. \(X(e^{j\omega})\)를 구하라.
**해설**:
$$
X(e^{j\omega})=\sum_{n=0}^{2}x[n]e^{-j\omega n}=1+2e^{-j\omega}+e^{-j2\omega}.
$$
**Octave**:
```octave
w = linspace(-pi, pi, 2001);
X = 1 + 2*exp(-1j*w) + exp(-1j*2*w);
plot(w, abs(X)); grid on; xlabel('\omega'); ylabel('|X|'); title('DTFT of [1,2,1]');
```

---

### 문제 2. 임펄스열의 DTFT

**목표**: 시프트/선형결합 직관
**문제**: \(x[n]=3\delta[n]-\delta[n-2]\). \(X(e^{j\omega})\)는?
**해설**:
$$X(e^{j\omega})=3- e^{-j2\omega}.$$
**Octave**:
```octave
w=linspace(-pi,pi,4001); X = 3 - exp(-1j*2*w);
subplot(1,2,1); plot(w, abs(X)); grid on; title('|X|');
subplot(1,2,2); plot(w, angle(X)); grid on; title('∠X');
```

---

### 문제 3. 지수 감쇠 신호의 DTFT

**목표**: DTFT와 Z-변환 관계
**문제**: \(x[n]=a^n u[n]\), \(|a|<1\). \(X(e^{j\omega})\)와 수렴 영역(ROC)을 쓰라.
**해설**:
$$
X(e^{j\omega})=\sum_{n=0}^{\infty}a^n e^{-j\omega n}=\frac{1}{1-ae^{-j\omega}},\quad \text{ROC: }|z|>|a|.
$$
**Octave**:
```octave
a=0.8; w=linspace(-pi,pi,4096);
X = 1 ./ (1 - a*exp(-1j*w));
plot(w, abs(X)); grid on; title('|X| of a^n u[n], a=0.8');
```

---

### 문제 4. 에너지 신호 Parseval 검증

**목표**: 시간–주파수 에너지 동일성
**문제**: 길이 \(N=1024\) 실수 랜덤 \(x[n]\)에서
\(\sum |x[n]|^2 = \frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2 d\omega\)를 DFT로 근사 검증하라.
**해설**: DFT 근사로 \(\frac{1}{N}\sum_k |X[k]|^2\)와 비교.
**Octave**:
```octave
N=1024; x=randn(1,N);
X=fft(x);
lhs = sum(abs(x).^2);
rhs = (1/N)*sum(abs(X).^2);
printf("Parseval error = %.3e\n", abs(lhs-rhs));
```

---

### 문제 5. DTFT의 주기성 확인

**목표**: \(2\pi\)-주기성 수치 확인
**문제**: 문제 1의 \(X(e^{j\omega})\)가 \(\omega\to \omega+2\pi\)에서 같은지 그림으로 확인하라.
**해설**: \(e^{-j(\omega+2\pi)n}=e^{-j\omega n}\).
**Octave**:
```octave
w = linspace(-pi, 3*pi, 4001);
X = 1 + 2*exp(-1j*w) + exp(-1j*2*w);
plot(w, abs(X)); grid on; xlim([-pi,3*pi]); title('2π-periodicity');
```

---

### 문제 6. 직사창의 DTFT(Dirichlet kernel)

**목표**: 메인로브/사이드로브 직관
**문제**: \(x[n]=\frac{1}{M}, 0\le n<M\). \(X(e^{j\omega})\)를 쓰고 0 부근 로브를 해석하라.
**해설**:
$$
X=\frac{1}{M}\frac{\sin(\omega M/2)}{\sin(\omega/2)}e^{-j\omega(M-1)/2}.
$$
**Octave**:
```octave
M=31; w=linspace(-pi,pi,8193);
H = (sin(w*M/2)./(M*sin(w/2))).*exp(-1j*w*(M-1)/2);
plot(w, 20*log10(abs(H)+1e-12)); grid on; title('Rect window spectrum [dB]');
```

---

### 문제 7. DTFT 정확 샘플러 작성(짧은 신호용)

**목표**: 정의 그대로 DTFT 수치화
**문제**: 직접합 루틴으로 \([1,2,3,2,1]\)의 DTFT를 그려라.
**Octave**:
```octave
function [w,X]=dtft_exact(x,M)
  if nargin<2, M=4096; end
  n=0:numel(x)-1; w=linspace(-pi,pi,M); X=zeros(1,M);
  for k=1:M, X(k)=sum(x.*exp(-1j*w(k)*n)); end
endfunction
x=[1 2 3 2 1]; [w,X]=dtft_exact(x,4096);
plot(w,abs(X)); grid on; title('|DTFT| of [1 2 3 2 1]');
```

---

## 파트 B. DTFT의 성질 (8–14)

### 문제 8. 선형성

**목표**: \(\mathcal{F}\{ax+by\}=aX+bY\)
**문제**: \(x[n]=\{1,0,1\}\), \(y[n]=\{0,1,0\}\), \(a=2,b=-1\)에서 선형성 오차를 수치로 확인하라.
**해설/Octave**:
```octave
x=[1 0 1]; y=[0 1 0]; a=2; b=-1; N=4096; w=linspace(-pi,pi,N);
% DTFT via FFT with zero-padding
X=fftshift(fft([x zeros(1,N-numel(x))]));
Y=fftshift(fft([y zeros(1,N-numel(y))]));
LHS=fftshift(fft([a*x+b*y zeros(1,N-numel(x))]));
RHS=a*X + b*Y;
printf("linearity error = %.2e\n", norm(LHS - RHS)/norm(LHS));
```

---

### 문제 9. 시간 시프트 ↔ 선형 위상

**목표**: \(x[n-n_0]\leftrightarrow e^{-j\omega n_0}X\)
**문제**: 임의 \(x\)에 대해 수치 검증.
**Octave**:
```octave
x=hamming(41)'; n0=7; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
xs=circshift([x zeros(1,N-numel(x))],[0 n0]);
Xs=fftshift(fft(xs));
phase = exp(-1j*w*n0);
err = norm(Xs - X.*phase)/norm(Xs);
printf("time-shift property error = %.2e\n", err);
```

---

### 문제 10. 변조 ↔ 주파수 이동

**목표**: \(e^{j\omega_0 n}x[n]\leftrightarrow X(\omega-\omega_0)\)
**문제/Octave**:
```octave
x=hamming(101)'; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
w0=0.4*pi; n=0:(numel(x)-1); xm=x.*exp(1j*w0*n);
Xm=fftshift(fft([xm zeros(1,N-numel(xm))]));
% 측정: peak 이동량
[~,kX]=max(abs(X)); [~,kM]=max(abs(Xm));
dw = w(kM)-w(kX); printf("peak shift ≈ %.3f (w0=%.3f)\n", dw, w0);
```

---

### 문제 11. 컨볼루션 정리

**목표**: \((x*h)\leftrightarrow XH\)
**문제/Octave**:
```octave
x=randn(1,1024); h=hamming(31)'; y=conv(x,h,'same');
N=2^nextpow2(numel(x));
Yf = ifft(fft(x,N).*fft(h,N));
printf("conv theorem error = %.2e\n", norm(y - Yf(1:numel(y)))/norm(y));
```

---

### 문제 12. 시간 곱 ↔ 주파수 원형 컨볼루션

**목표**: \(x[n]h[n]\leftrightarrow (1/2\pi)X \overset{\circledast}{\ } H\)
**문제**: 간단 예로 \(x=h=\) 한 주기 코사인(DFT 격자 정렬)에서 비교.
**Octave(개념 시연)**:
```octave
N=256; n=0:N-1; x=cos(2*pi*4*n/N); h=cos(2*pi*8*n/N);
LHS = fft(x.*h);
RHS = (1/N)*(fft(x).*fft(h)); % 스케일 차 주의(DFT 정규화 규약)
printf("circular conv (DFT) error = %.2e\n", norm(LHS - RHS));
```

---

### 문제 13. 미분 유사 성질

**목표**: \(n x[n]\leftrightarrow j \frac{d}{d\omega}X(\omega)\)
**문제/Octave(수치 근사)**:
```octave
x=hann(65)'; N=8192; w=linspace(-pi,pi,N);
X=fftshift(fft([x zeros(1,N-numel(x))]));
n=0:(numel(x)-1); nx = n.*x;
dX_num = gradient(X)./gradient(w); % 수치 미분
Xnx = fftshift(fft([nx zeros(1,N-numel(nx))]));
ratio = Xnx ./ (1j*dX_num);
printf("mean phase of ratio ≈ %.3f rad\n", angle(mean(ratio(isfinite(ratio)))));
```

---

### 문제 14. 실수 신호의 켤레짝대칭

**목표**: \(x\in\mathbb{R}\Rightarrow X(-\omega)=X^*(\omega)\)
**문제/Octave**:
```octave
x=randn(1,513); N=8192; w=linspace(-pi,pi,N); X=fftshift(fft([x zeros(1,N-numel(x))]));
X_neg = fliplr(X); % w→-w
err = norm(X_neg - conj(X))/norm(X);
printf("conjugate symmetry error = %.2e\n", err);
```

---

## 파트 C. LTI 주파수 영역 표현 (15–21)

### 문제 15. FIR의 주파수 응답

**목표**: \(H(e^{j\omega})=\sum h[n]e^{-j\omega n}\)
**문제**: \(h[n]=\frac{1}{3}\{1,1,1\}\). 크기·위상·군지연을 그려라.
**Octave**:
```octave
h=[1 1 1]/3; a=1; [H,w]=freqz(h,a,2048);
phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
subplot(3,1,1); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
subplot(3,1,2); plot(w/pi,phi); grid on; title('phase');
subplot(3,1,3); plot(w/pi,tau); grid on; title('group delay');
```

---

### 문제 16. IIR 1차의 정상상태 사인 응답

**목표**: 고유함수 성질
**문제**: \(y[n]-0.7y[n-1]=x[n]\), \(x[n]=\cos(\omega_0 n)\). 정상상태 출력 진폭/위상은?
**해설**:
$$
H(e^{j\omega})=\frac{1}{1-0.7e^{-j\omega}},\;
y_{ss}[n]=|H(e^{j\omega_0})|\cos(\omega_0 n+\angle H).
$$
**Octave**:
```octave
[b,a]=deal(1,[1 -0.7]); w0=0.4*pi; n=0:800;
x=cos(w0*n); y=filter(b,a,x); H=freqz(b,a,w0);
printf("|H|=%.3f, ∠H=%.3f rad\n", abs(H), angle(H));
```

---

### 문제 17. 극/영점 맵과 응답 직관

**목표**: 단위원 근접성 ↔ 증폭/감쇠
**문제/Octave**:
```octave
pkg load signal
w0=pi/3; r=0.95;
b=poly([exp(1j*w0),exp(-1j*w0)]); a=poly([r*exp(1j*w0), r*exp(-1j*w0)]);
[H,w]=freqz(b,a,4096);
subplot(1,2,1);
theta=linspace(0,2*pi,600); plot(cos(theta),sin(theta),'k--'); hold on
plot(real(roots(b)),imag(roots(b)),'ob'); plot(real(roots(a)),imag(roots(a)),'xr'); axis equal; grid on
title('zeros/poles'); legend('unit','zeros','poles');
subplot(1,2,2); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
```

---

### 문제 18. 선형위상 FIR의 군지연 상수성

**목표**: 대칭 계수 ⇒ \(\tau_g\approx(N-1)/2\)
**문제/Octave**:
```octave
N=101; b=fir1(N-1,0.3,hamming(N)); a=1; [H,w]=freqz(b,a,4096);
phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
printf("mean τg ≈ %.2f (theory %.2f)\n", mean(tau), (N-1)/2);
```

---

### 문제 19. 직렬/병렬 합성

**목표**: \(H_{series}=H_1H_2,\;H_{parallel}=aH_1+bH_2\)
**문제/Octave**:
```octave
[b1,a1]=butter(3,0.3); [b2,a2]=cheby1(3,1,0.2);
[H1,w]=freqz(b1,a1,2048); [H2,~]=freqz(b2,a2,2048);
Hseries = H1.*H2; Hpar = 0.6*H1 + 0.4*H2;
plot(w/pi,20*log10(abs(Hseries)+1e-12)); grid on; title('Series magnitude');
figure; plot(w/pi,20*log10(abs(Hpar)+1e-12)); grid on; title('Parallel magnitude');
```

---

### 문제 20. PSD 전파

**목표**: \(S_y=|H|^2 S_x\)
**문제/Octave**:
```octave
N=2^16; w=randn(1,N); [b,a]=butter(4,0.25);
y=filter(b,a,w); W=hanning(N)'; U=sum(W.^2)/N;
Sx=(abs(fft(w.*W)).^2)/(N*U); Sy=(abs(fft(y.*W)).^2)/(N*U);
[H,~]=freqz(b,a,N); theory = (abs(H').^2).*Sx(:);
f=(0:N-1)/N;
plot(f(1:N/2),10*log10(Sy(1:N/2)+1e-12)); hold on
plot(f(1:N/2),10*log10(theory(1:N/2)+1e-12));
grid on; legend('Sy (meas)','|H|^2 Sx (theory)');
```

---

### 문제 21. IIR 안정성 검사

**목표**: \(|p_k|<1\)
**문제/Octave**:
```octave
[b,a]=butter(6,0.4); p=roots(a);
printf("max |pole| = %.5f (stable if <1)\n", max(abs(p)));
```

---

## 파트 D. 아날로그 샘플링과 복원 (22–28)

### 판정

**목표**: \(f_s>2f_B\)
**문제**: \(x(t)=\cos(2\pi\cdot 9\text{k}t)+0.5\cos(2\pi\cdot 14\text{k}t)\). 두 성분을 모두 무왜곡 복원하려면 최소 \(f_s\)?
**해설**: \(f_B=14\text{kHz}\Rightarrow f_s>28\text{kHz}\). 여유 포함 32 kHz 이상 권장.

---

### 문제 23. 이상 샘플링 스펙트럼(이미지)

**목표**: \(X_s(j\Omega)=\frac{1}{T}\sum X(j(\Omega-k\Omega_s))\)
**문제**: 베이스밴드 \([0,6]\)kHz 대역만 있는 \(x(t)\)를 \(f_s=20\)kHz로 샘플. 이미지 중심 주파수들은?
**해설**: \(\pm k f_s (k\in\mathbb{Z})\)를 중심으로 복제. 예: \(\pm20,\pm40,\dots\)kHz.

---

### 문제 24. sinc 보간 vs ZOH 복원 비교(충분 샘플링)

**목표**: 이상 복원 대비 ZOH의 롤오프/이미지 관찰
**Octave(연속은 고해상도 격자 근사)**:
```octave
pkg load signal
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref); % 2 ms
x = 0.7*cos(2*pi*3e3*t) + 0.4*cos(2*pi*8e3*t);
Fs=48e3; T=1/Fs; n=0:floor(t(end)*Fs); ts=n*T+t(1);
xs = interp1(t,x,ts,"linear");

function xr=sinc_rec(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n), xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T); end
endfunction
function xr=zoh(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    mask=(t>=t(1)+n(k)*T)&(t<t(1)+(n(k)+1)*T); xr(mask)=xs(k);
  end
endfunction
xr_sinc=sinc_rec(n,xs,Fs,t); xr_zoh=zoh(n,xs,Fs,t);

subplot(2,1,1); plot(t*1e3,x,'k'); hold on; plot(t*1e3,xr_sinc,'b--'); plot(t*1e3,xr_zoh,'r-.'); grid on
legend('cont','sinc','ZOH'); xlim([0,2]);
subplot(2,1,2);
N=1<<18; X=fft(x, N); Xs=fft(xr_sinc,N); Xz=fft(xr_zoh,N); f=(0:N-1)*Fref/N;
plot(f(1:N/2)/1e3, 20*log10(abs(X(1:N/2))/max(abs(X))+1e-12),'k'); hold on
plot(f(1:N/2)/1e3, 20*log10(abs(Xs(1:N/2))/max(abs(X))+1e-12),'b');
plot(f(1:N/2)/1e3, 20*log10(abs(Xz(1:N/2))/max(abs(X))+1e-12),'r'); grid on
xlim([0,40]); xlabel('kHz'); ylabel('norm dB'); legend('cont','sinc','ZOH');
```

---

### 문제 25. Anti-Alias 필터의 효과(언더샘플링 상황)

**목표**: 에일리어싱 억제
**Octave**:
```octave
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
x = cos(2*pi*3e3*t)+0.8*cos(2*pi*12e3*t); % 12k 포함
Fs=20e3; T=1/Fs; n=0:floor(t(end)*Fs); ts=n*T+t(1);
xs_noAA = interp1(t,x,ts,"linear");

% AA FIR (컷 9k)
b=fir1(511, 9e3/(Fref/2), hamming(512)); xAA=filtfilt(b,1,x);
xs_AA = interp1(t,xAA,ts,"linear");

function xr=sinc_rec(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n), xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T); end
endfunction

xr_noAA = sinc_rec(n,xs_noAA,Fs,t);
xr_AA   = sinc_rec(n,xs_AA,Fs,t);
plot(t*1e3, xr_noAA, 'r'); hold on; plot(t*1e3, xr_AA, 'b'); grid on; xlim([0,2]);
legend('recon (no AA)','recon (with AA)'); title('Anti-Alias 필터 효과');
```

---

### 후 재구성 LPF

**목표**: 이미지 억제
**Octave**:
```octave
Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
x = 0.8*cos(2*pi*2e3*t)+0.5*cos(2*pi*5e3*t);
Fs=24e3; n=0:floor(t(end)*Fs); ts=n/Fs+t(1); xs=interp1(t,x,ts,"linear");
% ZOH
function xr=zoh(n,xs,Fs,t)
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n)
    mask=(t>=t(1)+n(k)*T)&(t<t(1)+(n(k)+1)*T); xr(mask)=xs(k);
  end
endfunction
x_zoh=zoh(n,xs,Fs,t);
% AF: 컷 0.45*Fs
bAF=fir1(511, 0.45*Fs/(Fref/2), hamming(512)); x_rec=filtfilt(bAF,1,x_zoh);
plot(t*1e3,x,'k'); hold on; plot(t*1e3,x_zoh,'r-.'); plot(t*1e3,x_rec,'b--'); grid on; xlim([0,2]);
legend('cont','ZOH','ZOH+AF'); title('재구성 LPF 효과');
```

---

### 주파수 확인

**목표**: \(f_{alias}=|f_c - m f_s|\)
**Octave**:
```octave
Fref=5e6; t=linspace(0,2e-3,2e-3*Fref); fc=150e3; x=cos(2*pi*fc*t);
Fs=60e3; n=0:floor(t(end)*Fs); xs=interp1(t,x,n/Fs+t(1),"linear");
N=1<<19; Xs=fft(xs, N); f=(0:N-1)*Fs/N; [~,k]=max(abs(Xs(1:N/2)));
printf("alias ≈ %.1f kHz (theory 30 kHz)\n", f(k)/1e3);
```

---

### 문제 28. 샘플링 지터에 의한 SNR 저하 근사

**목표**: \(\mathrm{SNR}_{jit}\approx -20\log_{10}(2\pi f_{in}\sigma_t)\)
**문제**: \(f_{in}=200\)kHz, \(\sigma_t=10\)ps의 이론적 SNR은?
**해설**:
$$
2\pi f_{in}\sigma_t \approx 2\pi\cdot 2\cdot 10^5\cdot 10^{-11}=1.26\times 10^{-5}
$$
\(\Rightarrow \mathrm{SNR}\approx -20\log_{10}(1.26\times10^{-5})\approx 98\,\mathrm{dB}\).

---

# 보너스 미니 프로젝트: 자동 채점 스크립트(선택)

- 입력: (신호/필터) 정의
- 출력: 성질 검증(컨볼루션 정리, 선형성, 시프트, Parseval), LTI 안정성, 샘플링/복원 품질(RMS 오차)

```octave
function report = dsp_autocheck()
  report=struct();
  % 1) Parseval
  N=1024; x=randn(1,N); X=fft(x);
  report.parseval_err = abs(sum(abs(x).^2) - (1/N)*sum(abs(X).^2))/sum(abs(x).^2);

  % 2) shift
  n0=11; X0=fft(x); xs=circshift(x,[0 n0]); Xs=fft(xs);
  w=2*pi*(0:N-1)/N; phase=exp(-1j*w*n0);
  report.shift_err = norm(Xs - X0.*phase)/norm(Xs);

  % 3) conv theorem
  h=hann(33)'; y=conv(x,h,'same');
  Np=2^nextpow2(numel(x)); yc = ifft(fft(x,Np).*fft(h,Np)); yc=yc(1:numel(x));
  report.conv_err = norm(y - yc)/norm(y);

  % 4) LTI stability
  [b,a]=butter(5,0.3); report.max_pole = max(abs(roots(a)));

  % 5) sampling/reconstruction RMS
  Fref=1e6; t=linspace(0,2e-3,2e-3*Fref);
  xcont = 0.8*cos(2*pi*3e3*t)+0.4*cos(2*pi*8e3*t);
  Fs=48e3; n=0:floor(t(end)*Fs); ts=n/Fs+t(1); xs=interp1(t,xcont,ts,"linear");
  % sinc recon
  T=1/Fs; xr=zeros(size(t));
  for k=1:numel(n), xr += xs(k).*sinc((t-(t(1)+n(k)*T))/T); end
  report.recon_rms = sqrt(mean((xcont - xr).^2))/rms(xcont);
endfunction

r=dsp_autocheck(); disp(r);
```

---

## 마무리 요약 체크리스트

- **DTFT**: 정의/역변환/주기성, 직사창–누설 직관.
- **성질**: 선형성, 시프트, 변조, 컨볼루션/곱, 미분 유사, 켤레짝대칭, Parseval.
- **LTI 주파수 표현**: \(H(e^{j\omega})\), 극/영점–단위원 거리, FIR 선형위상–군지연, IIR 안정성.
- **샘플링·복원**: 나이퀴스트/밴드패스 조건, 이미지 스펙트럼, sinc vs ZOH/FOH, AA/AF, 지터·양자화.
