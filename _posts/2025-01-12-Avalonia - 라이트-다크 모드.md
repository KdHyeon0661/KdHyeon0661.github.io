---
layout: post
title: Avalonia - ë¼ì´íŠ¸-ë‹¤í¬ ëª¨ë“œ
date: 2024-12-26 19:20:23 +0900
category: Avalonia
---
# ğŸŒ— Avaloniaì—ì„œ ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ ì „í™˜ ê¸°ëŠ¥ êµ¬í˜„ (MVVM ê¸°ë°˜)

AvaloniaëŠ” ê°•ë ¥í•œ ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œì„ ì œê³µí•˜ë©°, ì´ë¥¼ ì´ìš©í•´ ì•± ì „ì²´ì˜ í…Œë§ˆ(Theme)ë¥¼ ë‹¤í¬ ëª¨ë“œ ë˜ëŠ” ë¼ì´íŠ¸ ëª¨ë“œë¡œ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ… êµ¬í˜„ ëª©í‘œ

- ë¼ì´íŠ¸/ë‹¤í¬ í…Œë§ˆë¥¼ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •
- MVVM êµ¬ì¡°ë¡œ ì „í™˜ ì²˜ë¦¬
- ì‚¬ìš©ìì˜ ì„¤ì •ì„ JSON ë“±ìœ¼ë¡œ ì €ì¥í•˜ì—¬ ì•± ì¬ì‹¤í–‰ ì‹œ ë³µì› (ì„ íƒ)

---

## ğŸ“ êµ¬ì¡° ì˜ˆì‹œ

```
MyAvaloniaApp/
â”œâ”€â”€ Themes/
â”‚   â”œâ”€â”€ DarkTheme.axaml
â”‚   â””â”€â”€ LightTheme.axaml
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ ThemeViewModel.cs
â”œâ”€â”€ Views/
â”‚   â””â”€â”€ ThemeToggleView.axaml
â”œâ”€â”€ App.axaml
```

---

# ğŸ¨ 1. í…Œë§ˆ ë¦¬ì†ŒìŠ¤ ë§Œë“¤ê¸°

## ğŸ“„ `Themes/LightTheme.axaml`

```xml
<ResourceDictionary xmlns="https://github.com/avaloniaui">
  <Color x:Key="BackgroundColor">#FFFFFFFF</Color>
  <Color x:Key="ForegroundColor">#FF000000</Color>

  <SolidColorBrush x:Key="BackgroundBrush" Color="{DynamicResource BackgroundColor}" />
  <SolidColorBrush x:Key="ForegroundBrush" Color="{DynamicResource ForegroundColor}" />
</ResourceDictionary>
```

## ğŸ“„ `Themes/DarkTheme.axaml`

```xml
<ResourceDictionary xmlns="https://github.com/avaloniaui">
  <Color x:Key="BackgroundColor">#FF1E1E1E</Color>
  <Color x:Key="ForegroundColor">#FFFFFFFF</Color>

  <SolidColorBrush x:Key="BackgroundBrush" Color="{DynamicResource BackgroundColor}" />
  <SolidColorBrush x:Key="ForegroundBrush" Color="{DynamicResource ForegroundColor}" />
</ResourceDictionary>
```

---

# ğŸ–Œï¸ 2. App.axamlì—ì„œ ë¦¬ì†ŒìŠ¤ ì„¤ì •

## ğŸ“„ `App.axaml`

```xml
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyAvaloniaApp.App">

  <Application.Styles>
    <!-- ê¸°ë³¸ í…Œë§ˆëŠ” Lightë¡œ ì‹œì‘ -->
    <FluentTheme Mode="Light" />
    <ResourceInclude Source="avares://MyAvaloniaApp/Themes/LightTheme.axaml" x:Key="AppTheme"/>
  </Application.Styles>
</Application>
```

> âš ï¸ `x:Key="AppTheme"`ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¶”ì í•  ìˆ˜ ìˆë„ë¡ ëª…ì‹œí•´ì¤˜ì•¼ ë‚˜ì¤‘ì— ì œê±°/êµì²´ê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤.

---

# âš™ï¸ 3. ViewModelë¡œ í…Œë§ˆ ì „í™˜ êµ¬í˜„

## ğŸ“„ `ThemeViewModel.cs`

```csharp
using Avalonia.Controls.ApplicationLifetimes;
using Avalonia.Markup.Xaml.Styling;
using ReactiveUI;
using System.Reactive;

public class ThemeViewModel : ReactiveObject
{
    private bool _isDark;

    public bool IsDark
    {
        get => _isDark;
        set => this.RaiseAndSetIfChanged(ref _isDark, value);
    }

    public ReactiveCommand<Unit, Unit> ToggleThemeCommand { get; }

    public ThemeViewModel()
    {
        ToggleThemeCommand = ReactiveCommand.Create(ToggleTheme);
    }

    private void ToggleTheme()
    {
        var app = Avalonia.Application.Current;
        if (app == null) return;

        // ê¸°ì¡´ í…Œë§ˆ ì œê±°
        var currentTheme = app.Styles.FirstOrDefault(s => s is ResourceInclude ri && ri.Source?.ToString().Contains("Theme") == true);
        if (currentTheme != null)
            app.Styles.Remove(currentTheme);

        // ìƒˆë¡œìš´ í…Œë§ˆ ë¡œë“œ
        var newThemeSource = IsDark
            ? "avares://MyAvaloniaApp/Themes/DarkTheme.axaml"
            : "avares://MyAvaloniaApp/Themes/LightTheme.axaml";

        var newTheme = new ResourceInclude(new Uri(newThemeSource))
        {
            Source = new Uri(newThemeSource)
        };

        app.Styles.Add(newTheme);
    }
}
```

---

# ğŸ–¼ï¸ 4. Viewì—ì„œ ìŠ¤ìœ„ì¹˜ UI êµ¬ì„±

## ğŸ“„ `ThemeToggleView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="MyAvaloniaApp.Views.ThemeToggleView"
             xmlns:vm="clr-namespace:MyAvaloniaApp.ViewModels"
             Width="300" Height="100">

  <UserControl.DataContext>
    <vm:ThemeViewModel/>
  </UserControl.DataContext>

  <StackPanel Margin="20" Spacing="10">
    <ToggleSwitch IsChecked="{Binding IsDark}" Content="ë‹¤í¬ ëª¨ë“œ" />
    <Button Content="í…Œë§ˆ ì ìš©" Command="{Binding ToggleThemeCommand}" />
  </StackPanel>
</UserControl>
```

> âœ… ì‚¬ìš©ìê°€ `ToggleSwitch`ë¥¼ í† ê¸€í•˜ê³  ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í…Œë§ˆê°€ ì¦‰ì‹œ ì „í™˜ë©ë‹ˆë‹¤.

---

# ğŸ§ª 5. ì ìš© ì˜ˆì‹œ (ë‹¤í¬/ë¼ì´íŠ¸ ìƒ‰ìƒ ë°˜ì˜)

## ğŸ“„ View ë‚´ë¶€ ì˜ˆì‹œ (`MainView.axaml`)

```xml
<StackPanel Background="{DynamicResource BackgroundBrush}" Padding="20">
  <TextBlock Text="í…Œë§ˆ í…ŒìŠ¤íŠ¸ ì¤‘" Foreground="{DynamicResource ForegroundBrush}" />
</StackPanel>
```

---

# ğŸ’¾ 6. ì„ íƒ ì‚¬í•­: í…Œë§ˆ ì„¤ì • ì €ì¥í•˜ê¸°

## ğŸ“„ SettingsService.cs ì¼ë¶€ ì¶”ê°€

```csharp
public class Settings
{
    public bool IsDarkMode { get; set; }
}
```

- ì•± ì¢…ë£Œ ì‹œ `IsDark`ë¥¼ JSONì— ì €ì¥í•˜ê³ 
- ì•± ì‹œì‘ ì‹œ `ThemeViewModel`ì— ì´ˆê¸°í™”í•˜ë©´ ë©ë‹ˆë‹¤.

---

## âœ… ì •ë¦¬

| í•­ëª© | ë‚´ìš© |
|------|------|
| í…Œë§ˆ ì •ì˜ | `ResourceDictionary`ë¡œ ìŠ¤íƒ€ì¼ ë¶„ë¦¬ |
| ë™ì  ë³€ê²½ | ê¸°ì¡´ í…Œë§ˆ ì œê±° í›„ ìƒˆ í…Œë§ˆ ì¶”ê°€ |
| MVVM êµ¬ì¡° | `IsDark`ì™€ `ToggleThemeCommand`ë¡œ ë¶„ë¦¬ |
| ì ìš© ë°©ë²• | `{DynamicResource}`ë¡œ ìƒ‰ìƒ ë°”ì¸ë”© |
| í™•ì¥ | í…Œë§ˆ ì„¤ì •ì„ JSONìœ¼ë¡œ ì €ì¥í•˜ë©´ ì¬ì‹¤í–‰ ì‹œ ìœ ì§€ ê°€ëŠ¥