---
layout: post
title: 미적분 - 단조성, 오목성 그리고 도함수
date: 2025-08-02 19:20:23 +0900
category: 미적분
---
# 단조성, 오목성(Concavity) · 볼록성(Convexity) 그리고 도함수

## 1. 단조성(Monotonicity)과 1계 도함수

### 1.1 정의 (구간 \(I\subset\mathbb{R}\))
- **단조 증가(non-decreasing)**: \(x_1<x_2\Rightarrow f(x_1)\le f(x_2)\).
- **단조 감소(non-increasing)**: \(x_1<x_2\Rightarrow f(x_1)\ge f(x_2)\).
- **엄격한 단조(strict)**: 위 부등식이 모두 엄격(<, >)하게 성립.

> 실무 팁: “단조”와 “엄격 단조”는 다릅니다. 최적화에서 역함수 존재(단사성)는 **엄격 단조 + 연속**이 필요합니다.

### 1.2 1계 도함수와의 관계 (평활성 가정 하)
**평균값정리(MVT)**로 즉시 증명됩니다.
- \(f'(x)>0\) (모든 \(x\in I\)) ⇒ \(f\)는 **엄격히 증가**.
- \(f'(x)<0\) ⇒ **엄격히 감소**.
- \(f'(x)=0\) (모든 \(x\)) ⇒ **상수함수**.

단, **필요충분은 아님**:
- \(f'(x)\ge 0\)이지만 특정 점에서 \(f'(x)=0\)일 수 있어도 \(f\)는 여전히(엄격)증가 가능.  
  예: \(f(x)=x^3\): \(f'(0)=0\)이지만 전체적으로 증가.

### 1.3 예제 · 함정

**예제 A — \(f(x)=x^3\)**  
\[
f'(x)=3x^2\ge 0 \quad(\forall x),\ \ f'\equiv 0\ \text{인 구간 없음}\Rightarrow \text{전구간 증가}.
\]

**예제 B — \(f(x)=e^x\)**  
\[
f'(x)=e^x>0 \quad(\forall x)\Rightarrow \text{엄격 증가}.
\]

**예제 C — \(f(x)=-\ln x\) (정의역 \(x>0\))**  
\[
f'(x)=-\frac{1}{x}<0 \Rightarrow \text{엄격 감소}.
\]

**함정 1**: \(f'(x)\ge 0\)가 **일부 지점에서만 0**이라도, 전체 증가성은 유지될 수 있습니다.  
**함정 2**: 미분 불가능해도 단조일 수 있음(예: \(f(x)=|x|\)은 \((-\infty,0]\)에서 감소, \([0,\infty)\)에서 증가).

### 1.4 1차 도함수 판정(First Derivative Test)
임계점 \(c\)에서
- \(f'\)가 \(+\to-\)로 바뀌면 \(c\)는 **극댓값**,
- \(-\to+\)로 바뀌면 **극솟값**,
- 부호 변화 없으면 극값 아님(평탄·변곡 등).

---

## 2. 오목/볼록성과 2계 도함수

### 2.1 정의(현·할선/지지선 관점)
- **볼록(convex)**: 모든 \(x,y\)와 \(\lambda\in[0,1]\)에 대해  
  \[
  f(\lambda x+(1-\lambda)y)\le \lambda f(x)+(1-\lambda)f(y).
  \]  
  (현선이 그래프 **위**를 지나지 않음)
- **오목(concave)**: 부등호 반대. (현선이 그래프 **아래**를 지나지 않음)

### 2.2 2계 도함수 판정 (2차 미분 가능 시)
- \(f''(x)>0\) ⇒ **볼록**.
- \(f''(x)<0\) ⇒ **오목**.
- \(f''(x)=0\)만으로는 결론 불가. (예: \(f(x)=x^4\)는 \(x=0\)에서 \(f''=0\)이지만 여전히 볼록)

> **변곡점**: 오목↔볼록이 실제로 **바뀌는 지점**. 필요한 조건은 \(f''(c)=0\) 또는 미분 불능이지만, **충분조건 아님**. 반드시 좌우에서 오목성 변화 확인.

### 2.3 예제

- \(f(x)=x^2\): \(f''=2>0\Rightarrow\) 전구간 볼록.  
- \(f(x)=-x^2\): \(f''=-2<0\Rightarrow\) 전구간 오목.  
- \(f(x)=x^3\): \(f''=6x\), \(x=0\)에서 부호 바뀜 ⇒ **변곡점**.

### 2.4 1계-2계 관계
볼록이면 \(f'\)가 **단조 증가**, 오목이면 \(f'\)가 **단조 감소**.  
직관: 기울기가 커지는(작아지는) 방향으로 휘어진다.

---

## 3. 종합 형태 분석 예제

**문제**: \(f(x)=x^3-3x\)

1) \(f'(x)=3x^2-3=3(x-1)(x+1)\Rightarrow\) 임계점 \(x=-1,1\).  
부호표:
- \((-\infty,-1)\): \(+\) (증가)
- \((-1,1)\): \(−\) (감소)
- \((1,\infty)\): \(+\) (증가)

⇒ 극댓값 \(x=-1\), 극솟값 \(x=1\).

2) \(f''(x)=6x\Rightarrow\) \(x=0\)에서 변곡점 후보.  
좌(음) 오목, 우(양) 볼록 ⇒ **실제 변곡점**.

3) 함수값
\[
f(-1)=(-1)^3-3(-1)=2,\quad f(1)=1-3=-2.
\]
⇒ 극대 \(=2\) at \(-1\), 극소 \(=-2\) at \(1\).

---

## 4. 역함수와 단조성

- **연속 + 엄격 단조**면 \(f\)는 **전단사**(역함수 존재).  
- 추가로 \(f'\)가 0이 아니고 연속이면,  
  \[
  (f^{-1})'(y)=\frac{1}{f'(x)}\quad\text{where }y=f(x).
  \]
  (역함수 미분법)

**예제**: \(f(x)=e^x\)는 엄격 증가, \(f'(x)=e^x>0\).  
역함수 \(f^{-1}(y)=\ln y\), \((f^{-1})'(y)=1/y\).

---

## 5. 변곡점 세밀 판정 — 반례와 체크리스트

- \(f''(c)=0\)이더라도 변곡점이 아닐 수 있음.  
  예: \(f(x)=x^4\), \(f''(0)=0\)이지만 좌우 모두 볼록.  
- **체크리스트**:  
  1) \(f''(c)=0\) 또는 미분 불능,  
  2) \((c-\epsilon,c)\)와 \((c,c+\epsilon)\)에서 오목성 부호가 실제로 **바뀌는지** 확인.

---

## 6. 다변수 확장 (간단 요약)

- \(f:\mathbb{R}^n\to\mathbb{R}\), **볼록**: 임의의 \(x,y\)와 \(\lambda\in[0,1]\)에 대해  
  \[
  f(\lambda x+(1-\lambda)y)\le \lambda f(x)+(1-\lambda)f(y).
  \]
- \(C^2\)면, Hessian \(H(x)=\nabla^2 f(x)\)가 **모든 \(x\)**에서 **양의 준정부호**이면 볼록(오목은 반대).
- 볼록 \(f\)의 그래디언트는 **단조 연산자**:  
  \[
  \langle \nabla f(x)-\nabla f(y),\,x-y\rangle \ge 0.
  \]

---

## 7. 실전 응용 스냅샷

- **경제학**: 체감수익 \(f''<0\)(오목) ⇒ 한계수익 감소. 비용함수 볼록 ⇒ 규모확대시 한계비용 증가.  
- **머신러닝**: 손실이 볼록이면 지역해=전역해, 최적화 용이.  
- **물리**: 퍼텐셜 \(U\)의 극소점에서 안정 평형, \(U''>0\).  
- **제조/설계**: 오목/볼록성으로 “유리한 방향” 설계(예: 재료 두께·응력 응답 곡선 분석).

---

## 8. 수치 검증 코드 (Python)

> 노트: 수치 미분은 오차가 있으므로 **그리드 + 부호 패턴**을 같이 보세요.

### 8.1 단조성/오목성 자동 추정 스니펫
```python
import numpy as np

def finite_diff_1st(f, xs, h=1e-5):
    xs = np.asarray(xs)
    return (f(xs+h) - f(xs-h)) / (2*h)

def finite_diff_2nd(f, xs, h=1e-4):
    xs = np.asarray(xs)
    return (f(xs+h) - 2*f(xs) + f(xs-h)) / (h*h)

def monotonicity_report(f, a=-3, b=3, n=2001):
    xs = np.linspace(a, b, n)
    f1 = finite_diff_1st(f, xs)
    f2 = finite_diff_2nd(f, xs)

    inc_ratio = np.mean(f1 > 1e-6)
    dec_ratio = np.mean(f1 < -1e-6)
    flat_ratio= np.mean(np.abs(f1) <= 1e-6)

    concave_ratio = np.mean(f2 < -1e-4)
    convex_ratio  = np.mean(f2 >  1e-4)
    inflect_ratio = 1 - concave_ratio - convex_ratio  # 완전한 판정은 아님

    return {
        "inc_ratio": inc_ratio,
        "dec_ratio": dec_ratio,
        "flat_ratio": flat_ratio,
        "convex_ratio": convex_ratio,
        "concave_ratio": concave_ratio,
        "undetermined_ratio": inflect_ratio
    }

# 예제: f(x)=x**3 - 3x
f = lambda x: x**3 - 3*x
print(monotonicity_report(f, a=-3, b=3))
```

### 8.2 시각화(함수/도함수/이계도함수)
```python
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-3, 3, 800)
f  = x**3 - 3*x
fp = 3*x**2 - 3
fpp= 6*x

plt.figure(figsize=(9,6))
plt.plot(x, f,  label='f(x) = x^3 - 3x')
plt.plot(x, fp, label="f'(x) = 3x^2 - 3", linestyle='--')
plt.plot(x, fpp,label="f''(x) = 6x", linestyle=':')
plt.axhline(0, linewidth=0.8, color='k')
plt.axvline(-1, linestyle='--', alpha=0.5)
plt.axvline( 1, linestyle='--', alpha=0.5)
plt.axvline( 0, linestyle='--', alpha=0.5)
plt.legend()
plt.title('단조성·오목성 분석: f, f\', f\'\'')
plt.grid(True, alpha=0.3)
plt.show()
```

---

## 9. 연습문제(해설 스케치)

**(1)** \(f(x)=x^4-4x^2\)의 증가/감소, 볼록/오목, 극값, 변곡점.  
- \(f'(x)=4x^3-8x=4x(x^2-2)\). 임계점 \(x=0, \pm\sqrt{2}\).  
- \(f''(x)=12x^2-8\). \(x=\pm\sqrt{\frac{2}{3}}\)에서 부호 전환 → 변곡점.  
- 부호표로 증가/감소, 극대/극소 판정.

**(2)** \(f(x)=x\ln x\) (정의역 \(x>0\))  
- \(f'(x)=\ln x+1\Rightarrow f'(x)=0 \iff x=e^{-1}\).  
- \(f''(x)=1/x>0\Rightarrow\) 볼록, \(x=e^{-1}\)는 극솟값.

**(3)** \(f(x)=|x|^3\)  
- \(f\)는 원점에서 미분 가능(도함수 0), \(f''(0)=0\)이지만 좌우 모두 볼록(2계도함수 \(=6|x|/2\) 해석) → 변곡점 아님.

**(4)** \(f(x)=\ln(1+e^x)\)  
- \(f'(x)=\frac{e^x}{1+e^x}\in(0,1)\Rightarrow\) 엄격 증가.  
- \(f''(x)=\frac{e^x}{(1+e^x)^2}>0\Rightarrow\) 볼록.

**(5)** 역함수 미분: \(f(x)=x^3+x\)  
- \(f'(x)=3x^2+1>0\Rightarrow\) 전구간 엄격 증가 → 역함수 존재.  
- \((f^{-1})'(y)=1/(3x^2+1)\) with \(x=f^{-1}(y)\).

---

## 10. 요약 표

| 주제 | 핵심 결론 |
|---|---|
| 단조성 vs \(f'\) | \(f'>0\Rightarrow\) 엄격 증가, \(f'<0\Rightarrow\) 엄격 감소, \(f'\equiv 0\Rightarrow\) 상수 |
| 볼록/오목 vs \(f''\) | \(f''>0\Rightarrow\) 볼록, \(f''<0\Rightarrow\) 오목, \(f''=0\Rightarrow\) 변곡 후보 |
| 변곡점 | 오목↔볼록의 **실제 전환** 확인 필수 |
| 역함수 | 연속+엄격 단조 ⇒ 역함수 존재, \((f^{-1})'(y)=1/(f'(x))\) |
| 다변수 | Hessian \( \succeq 0\Rightarrow\) 볼록, \( \preceq 0\Rightarrow\) 오목 |

---

### 마무리
- **1계 도함수**는 그래프의 **올라감/내려감**을, **2계 도함수**는 **휘어짐**을 말해줍니다.  
- 변곡점·역함수 미분 등은 실무 최적화, 신호/제어, 경제모형, ML 손실 설계에서 매일 쓰이는 도구입니다.  
- 실제 문제에서는 **도함수 판정 + 경계/정의역/수치검산**을 함께 사용하는 습관을 들이세요.