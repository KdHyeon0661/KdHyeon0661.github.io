---
layout: post
title: 미적분 - 최대값·최솟값 정리와 평균값 정리
date: 2025-06-24 19:20:23 +0900
category: 미적분
---
# 최대값·최솟값 정리와 평균값 정리

미분의 핵심 정리들인 **최대값·최솟값 정리(EVT)**, **롤의 정리**, **평균값 정리(MVT)**는  
함수의 **극값 존재**, **수평 접선의 존재**, **평균 변화율 = 순간 변화율**을 각각 보장한다.  
(모든 수식은 $$\cdots$$, 코드는 ``` 로 감싼다.)

---

## ✅ 1) 용어 정리 — 극댓값/극솟값과 임계점

| 용어 | 정의(요지) |
|---|---|
| **국소 극댓값** | 어떤 점 $$c$$의 근방에서 $$f(c)\ge f(x)$$ |
| **국소 극솟값** | 어떤 점 $$c$$의 근방에서 $$f(c)\le f(x)$$ |
| **전역(절대) 극댓/극솟** | 전체 구간에서 최대/최소값을 가짐 |
| **임계점** | $$f'(c)=0$$ 또는 $$f'$$ 미정인 점 |

> **필요조건(페르마 정리)**: $$f$$ 가 $$c$$ 에서 극값을 가지면(내부점) **미분 가능**할 때 $$f'(c)=0$$.

---

## ✅ 2) 롤의 정리 (Rolle’s Theorem)

### 조건
1) $$f$$ 는 $$[a,b]$$에서 **연속**, 2) $$(a,b)$$에서 **미분 가능**, 3) $$f(a)=f(b)$$.

### 결론
$$
\exists\,c\in(a,b)\ \text{ s.t. }\ f'(c)=0.
$$

> **기하학**: 시작과 끝 높이가 같다면 **어딘가 수평 접선**이 있다.

### 짧은 예
$$
f(x)=x^2-4x+4=(x-2)^2,\quad [0,4]\Rightarrow f(0)=f(4)=4.
$$
$$f'(x)=2x-4,\ f'(2)=0\Rightarrow c=2.$$

### 스케치 증명
EVT로 $$[a,b]$$에서 최대/최소를 갖는다.  
만약 내부점에서 달성되면 페르마 정리로 도함수 0.  
끝점에서만 달성된다면 높이가 같으므로 반대쪽 끝과 비교해도 내부에 적어도 하나의 수평 접선이 존재.

---

## ✅ 3) 평균값 정리 (MVT, 라그랑주)

### 조건
1) $$f$$ 는 $$[a,b]$$에서 **연속**, 2) $$(a,b)$$에서 **미분 가능**.

### 결론
$$
\exists\,c\in(a,b)\ \text{ s.t. }\quad 
\boxed{\,f'(c)=\dfrac{f(b)-f(a)}{b-a}\,}.
$$

> **기하학**: 그래프 위 **어딘가의 접선**이 **할선**과 **평행**.

### 예
$$
f(x)=x^2,\ [1,4]\Rightarrow \frac{f(4)-f(1)}{3}=\frac{15}{3}=5.
$$
$$
f'(x)=2x=5\Rightarrow x=\frac52,\ \ f'\!\Big(\frac52\Big)=5.
$$

### 중요한 귀결
- (증가/감소 판정) $$f'(x)\ge 0\ \forall x\in(a,b)\Rightarrow f$$ 단조 증가.  
- (리프시츠) $$|f'(x)|\le M\Rightarrow |f(b)-f(a)|\le M|b-a|$$.  
- (상수함수 판정) $$f'(x)=0\ \forall x\Rightarrow f$$ 는 상수.

---

## ✅ 4) 최대값·최솟값 정리 (EVT, 바이어슈트라스)

### 정리(존재성)
$$f$$ 가 **폐구간** $$[a,b]$$ 에서 **연속**이면,
$$
\exists\,x_{\min},x_{\max}\in[a,b]\ \text{ s.t. }\ 
f(x_{\min})=\min_{[a,b]}f,\ \ f(x_{\max})=\max_{[a,b]}f.
$$

> **해석**: **존재**만 보장. 위치나 개수는 말해주지 않음.  
> 핵심은 $$[a,b]$$ 의 **콤팩트성(닫히고 유계)**.

### 짧은 증명 스케치
연속 함수는 콤팩트 집합을 **정확히** 콤팩트 집합으로 사상 ⇒ 영상은 닫히고 유계 ⇒ 최솟값/최댓값 존재.

### 예
$$
f(x)=x^3-3x^2+1,\ \ [0,3].
$$
$$
f'(x)=3x(x-2)\Rightarrow x=0,2.
$$
$$
f(0)=1,\ f(2)=-3,\ f(3)=1 \Rightarrow \min=-3,\ \max=1.
$$

---

## ✅ 5) 평균값 정리의 확장 — 코시 평균값 정리(CMVT)

두 함수 $$f,g$$ 가 $$[a,b]$$에서 연속, $$(a,b)$$에서 미분 가능이면  
$$
\exists\,c\in(a,b):\quad
\frac{f'(c)}{g'(c)}=\frac{f(b)-f(a)}{\,g(b)-g(a)\,}\quad(g(b)\ne g(a)).
$$
> **로피탈의 법칙**은 CMVT의 자연스런 귀결.

---

## ✅ 6) 조건이 깨지면 생기는 반례들

- **연속성 결여(EVT 실패)**: $$f(x)=\frac1x,\ (0,1]$$ 은 상한 존재하지만 **최댓값 없음**.  
- **미분 가능성 결여(MVT 실패)**: $$f(x)=|x|,\ [-1,1]$$ 은 할선 기울기 0인데, $$(0,0)$$ 에서 미분 불능.  
- **롤의 정리 실패**: 위 $$|x|$$ 예에서 $$f(-1)=f(1)$$ 이지만 **수평 접선 없음**(미분 불능).

---

## ✅ 7) 응용 문제들

### (A) 속도 문제
1시간 평균속력이 80km/h → MVT로 **어떤 순간 속력 = 80km/h**.

### (B) 단조성/부등식
$$f'(x)\ge m \Rightarrow f(x)\ge f(a)+m(x-a).$$  
(접선 아래/위 선형 하한·상한: 미분 가능한 경우의 **선형 성장 조건**)

### (C) 에러 추정
$$|f'(x)|\le M\Rightarrow |f(x)-\ell(x)|\le \tfrac{M}{2}(x-a)$$ (적절한 선형근사 $$\ell$$ 에 대해).

---

## ✅ 8) 종합 예제 — 조건 확인부터

**문제**:  
$$f(x)=\sqrt{x}\ \ (x\ge 0),\ [a,b]=[1,4].$$  
1) EVT 적용 여부? 2) MVT로 어떤 $$c$$ 존재? 3) 증가성?

**풀이**  
1) $$[1,4]$$ 에서 연속 ⇒ EVT로 최댓값 $$f(4)=2$$, 최솟값 $$f(1)=1$$ 존재.  
2) MVT:  
$$
\frac{f(4)-f(1)}{4-1}=\frac{2-1}{3}=\frac13.
$$
$$f'(x)=\frac{1}{2\sqrt{x}}=\frac13\Rightarrow x=\frac{9}{4}.$$  
3) $$f'(x)>0$$ (모든 $$x>0$$) ⇒ 단조 증가.

---

## ✅ 9) 요약 표

| 정리 | 조건 | 결론 | 핵심 해석 |
|---|---|---|---|
| **EVT** | $$[a,b]$$ 연속 | $$\exists\ \min,\max$$ | 극값 **존재** 보장 |
| **롤** | 연속+미분 가능, $$f(a)=f(b)$$ | $$\exists c:\ f'(c)=0$$ | 수평 접선 존재 |
| **MVT** | 연속+미분 가능 | $$\exists c:\ f'(c)=\dfrac{\Delta f}{\Delta x}$$ | 순간=평균 변화율 |

---

## ✅ 10) 파이썬 시각화 — 평균값 정리

```python
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(0, 4, 400)
y = x**2
a, b = 1, 4
fa, fb = a**2, b**2
slope = (fb - fa)/(b - a)  # 평균 변화율 = 5
c = 2.5                     # MVT가 보장하는 한 점 (여기서는 해석적으로 2.5)

# c에서의 접선 (기울기 = 2c = 5)을 길게 그려 보이기
xt = np.linspace(c-1.2, c+1.2, 2)
yt = y[np.searchsorted(x, c)] + slope*(xt - c)

fig, ax = plt.subplots(figsize=(7,5))
ax.plot(x, y, label="f(x) = x^2")
ax.plot([a, b], [fa, fb], 'r--', label="할선 (평균 변화율 = 5)")
ax.plot(xt, yt, 'g--', label="c=2.5에서의 접선 (기울기 5)")
ax.scatter([a, b, c], [fa, fb, c**2], color=['red','red','green'])
ax.annotate('a=1', (a,fa), xytext=(0.8,1.5), arrowprops=dict(arrowstyle='->'))
ax.annotate('b=4', (b,fb), xytext=(3.6,14), arrowprops=dict(arrowstyle='->'))
ax.annotate('c=2.5', (c,c**2), xytext=(2.0,9), arrowprops=dict(arrowstyle='->'))
ax.grid(True); ax.legend(); ax.set_title("평균값 정리 시각화")
plt.show()
```

---

## ✅ 11) 빠른 연습문제

1) $$f(x)=x^3-3x,\ [0,3]$$ 의 절댓값(최대/최소)을 구하라.  
   *힌트: EVT + 임계점 + 경계 비교.*

2) $$f:[0,1]\to\mathbb{R}$$ 연속, 미분 가능, $$f(0)=0,\ f(1)=2$$.  
   (a) MVT로 어떤 $$c$$ 에서 $$f'(c)=2$$ 를 보이라.  
   (b) $$|f'(x)|\le 1$$ 이라면 모순임을 보여라.

3) $$f(x)=|x|,\ [-1,1]$$ 에 대해 MVT가 성립하지 않는 이유를 적어라.

---

### 마무리
- **EVT**: “연속 + 폐구간 ⇒ 극값 **존재**.”  
- **롤**: “끝값 동일 ⇒ **수평 접선** 존재.”  
- **MVT**: “어딘가에 **평균 변화율 = 순간 변화율**.”  
이 세 정리는 **단조성 판정, 오류 추정, 최적화, 로피탈의 법칙** 등으로 이어지는 미분해석의 토대를 이룬다.