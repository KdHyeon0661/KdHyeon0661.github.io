---
layout: post
title: 미적분 - 최대값·최솟값 정리와 평균값 정리
date: 2025-08-02 19:20:23 +0900
category: 미적분
---
# 최대값·최솟값 정리와 평균값 정리 (EVT, Rolle, MVT)

> 이 글은 **극댓값/극솟값(Extrema)**, **롤의 정리(Rolle)**, **평균값 정리(MVT)**를 한 번에 정리합니다.
> 핵심: **연속성(존재 보장)**, **미분 가능성(기하학적 결과)**, **경계점/임계점/비미분점 모두 점검**.

---

## 한눈에 보는 로드맵

- **EVT(최대/최소 존재 정리)**: 연속 함수 \(f:[a,b]\to\mathbb{R}\)는 **반드시** \([a,b]\)에서 **최대/최소를 가진다**.
- **Fermat의 정리**: \(f\)가 내부점 \(c\)에서 **로컬 극값**을 가지면서 **미분 가능**하면 \(f'(c)=0\).
- **Rolle**: \(f(a)=f(b)\)이면, 어딘가 \(c\in(a,b)\)에 **수평 접선** \(f'(c)=0\).
- **MVT**: 어딘가 \(c\)에서 **순간 변화율 = 평균 변화율**:
  \[
  f'(c)=\frac{f(b)-f(a)}{b-a}.
  \]
- **Cauchy MVT(일반형)** → **로피탈의 법칙**의 근간.

---

## 극댓값·극솟값: 개념·필요조건·찾는 절차

### 용어 정리

- **국소(극대/극소)**: 주변보다 크거나 작은 값.
- **절대(전역 최대/최소)**: 전체 구간에서 가장 큰/작은 값.
- **임계점**: \(f'(x)=0\) **또는** \(f'\)가 **정의되지 않는** 점.

### Fermat의 정리 (필요조건)

- \(f\)가 **열린 구간**의 내부점 \(c\)에서 로컬 극값, 그리고 \(f'\) 존재 ⇒ \(f'(c)=0\).
  (단, **끝점**이나 **뾰족점**(예: \(|x|\)의 0)은 예외. 그래서 “임계점 = 0 또는 미정”을 모두 본다.)

### EVT(Extreme Value Theorem, 최대·최소 존재)

- 가정: \(f\) 연속 on \([a,b]\).
- 결론: \(\exists x_{\min},x_{\max}\in[a,b]\) s.t. \(f(x_{\min})\le f(x)\le f(x_{\max})\) (모든 \(x\)).
- **증명 스케치**: \([a,b]\)는 **콤팩트**. 연속함수는 콤팩트 집합에서 **상/하한을 달성**(Weierstrass).

### **절대 극값 찾기 체크리스트(폐구간)**

1) \(f'(x)=0\) 푸는 **내부 임계점** 수집.
2) **미분 불능점**(뾰족/ cusp / 경계층)도 후보에 **추가**.
3) **끝점** \(a,b\)도 **반드시 포함**.
4) 위 모든 후보에서 \(f\)값을 **직접 비교** → 최대/최소 결정.

> ⚠ 열린 구간, 불연속, 무한 구간이면 **EVT 불가**. 이때는 따로 분석 필요(극한/성장률 등).

---

## 예제 — 절대 극값 찾기

### 예제 A) \(f(x)=x^3-3x^2+1\) on \([0,3]\)

- \(f'(x)=3x^2-6x=3x(x-2)\Rightarrow x=0,2\) (내부 후보: \(2\), 끝점: \(0,3\))
- 값:
  \[
  f(0)=1,\quad f(2)=-3,\quad f(3)=1.
  \]
- **최솟값** \(-3\) at \(x=2\), **최댓값** \(1\) at \(x=0,3\).

### 예제 B) \(f(x)=|x-1|+\sqrt{2-x}\) on \([0,2]\)

- **미분 불능** at \(x=1\). 또 \(\sqrt{2-x}\)는 끝점 \(x=2\)에서 미분 불능.
- 후보: \(x=0,1,2\).
  \[
  f(0)=|{-1}|+\sqrt{2}=1+\sqrt{2},\quad
  f(1)=0+\sqrt{1}=1,\quad
  f(2)=1+0=1.
  \]
- **최솟값** \(=1\) (at \(x=1\) 또는 \(2\)), **최댓값** \(=1+\sqrt{2}\) (at \(x=0\)).

---

## 조건이 깨지면? (반례와 함정)

- **불연속**: \(f(x)=\frac{1}{x-1/2}\) on \([0,1]\): \(x=1/2\)에서 불연속 → **최대/최소 없음**.
- **열린 구간**: \(f(x)=x\) on \((0,1)\): 상한 1, 하한 0은 있으나 **달성** 안 함 → 절대 극값 없음.
- **미분 불능**: \(|x|\)은 0에서 로컬 최소지만 \(f'(0)\) 불능 ⇒ **임계점**으로 취급해야 한다.

---

## Rolle의 정리

### 정리

가정:
1) 연속 on \([a,b]\), 2) 미분 가능 on \((a,b)\), 3) \(f(a)=f(b)\).
결론: \(\exists c\in(a,b)\) s.t. \(f'(c)=0\).

### 기하학

시작점과 끝점이 **같은 높이**면, **중간 어딘가 수평 접선**.

### 증명 스케치

EVT로 \([a,b]\)에서 최대/최소 **달성**. 값이 상수면 아무 데나 0. 아니면 최대/최소가 내부점에서 발생 → Fermat으로 그 점에서 \(f'=0\).

### 예제

\(f(x)=x^2-4x+4=(x-2)^2\) on \([0,4]\).
\(f(0)=f(4)=4\). \(f'(x)=2x-4\Rightarrow f'(2)=0\).

---

## 평균값 정리(MVT)

### 정리

가정: 연속 on \([a,b]\), 미분 가능 on \((a,b)\).
결론: \(\exists c\in(a,b)\) s.t.
\[
\boxed{\,f'(c)=\dfrac{f(b)-f(a)}{b-a}\,}.
\]

### 기하학

어딘가에서 **접선의 기울기**가 **시작–끝을 잇는 할선(초록 선)의 기울기**와 같다.

### 증명 스케치

\(g(x)=f(x)-\ell(x)\), \(\ell(x)\)는 (a,b)를 잇는 직선. 그러면 \(g(a)=g(b)=0\). Rolle 적용 → \(g'(c)=0\Rightarrow f'(c)=\ell'(x)\).

### 예제

\(f(x)=x^2\) on \([1,4]\): 평균 변화율 \(\frac{16-1}{3}=5\).
\(f'(x)=2x\Rightarrow 2c=5\Rightarrow c=2.5\).

---

## MVT의 강력한 귀결(응용)

### 단조성/상수함수 판정

- \(\forall x, f'(x)>0\Rightarrow f\) **엄격 증가**.
- \(\forall x, f'(x)=0\Rightarrow f\) **상수** (MVT로 즉시 증명).

### 리프시츠/차분 경계 (오차/안정성)

\[
|f(b)-f(a)|=|f'(\xi)|\,|b-a|\le \|f'\|_\infty |b-a|.
\]
- **삼각 부등식/신호 처리**: \(|\sin b-\sin a|\le |b-a|\) (왜냐면 \(|(\sin x)'|=|\cos x|\le 1\)).
- **수치 미분 오차**: \(|\tfrac{f(x+h)-f(x)}{h}-f'(x)|\le \tfrac{L}{2}|h|\) (만약 \(f''\) 연속으로 \(|f''|\le L\)).

### 불등식 증명 예

- \(x>0\)에서 \(\ln x\)는 \(f'(x)=1/x\). MVT로
  \[
  \ln b-\ln a=\frac{1}{\xi}(b-a)\quad\Rightarrow\quad
  \frac{b-a}{b}\le \ln\frac{b}{a}\le \frac{b-a}{a}.
  \]
- \(\sin x\le x\le \tan x\) (\(x>0\))도 MVT/볼록성으로 증명 가능.

### 평균 속력 = 어떤 순간 속력

거리 \(s(t)\) 연속·미분 가능 ⇒ \(\exists c\)에서 \(s'(c)=\frac{s(b)-s(a)}{b-a}\) (물리적 해석).

---

## **Cauchy 평균값 정리** (두 함수 버전) → 로피탈 연결

가정: \(f,g\) 연속 on \([a,b]\), 미분 가능 on \((a,b)\), 그리고 \(g'\)는 0이 아님.
결론: \(\exists c\) s.t.
\[
\boxed{\,\frac{f(b)-f(a)}{g(b)-g(a)}=\frac{f'(c)}{g'(c)}\,}.
\]
- \(g(x)=x\)이면 MVT로 귀결.
- **로피탈의 법칙**: \(\lim \frac{f}{g}\)이 \(\frac{0}{0}\) 또는 \(\frac{\infty}{\infty}\) 꼴일 때, 위 관계를 극한으로 보내면 \(\lim \frac{f'}{g'}\)로 귀결.

---

## 극값 판정법(복습): 1·2차 테스트

- **1차 부호 변화 테스트**: \(f'\)가 \(+\to -\)이면 극대, \(-\to +\)면 극소.
- **2차 도함수 테스트**: \(f'(c)=0\)이고 \(f''(c)>0\Rightarrow\) 극소, \(f''(c)<0\Rightarrow\) 극대, \(=0\Rightarrow\) 불확정(고차 필요).

> 단, **끝점/미분 불능점**도 절대 극값 후보임을 잊지 말기.

---

## “조건 실패”의 실제 영향 (경계/불연속/수직 접선)

- \(f\)가 **불연속**이면 EVT 실패 → 절대 극값이 없을 수 있다.
- \(f\)가 \((a,b)\)에서 **미분 불능**이면 Rolle/MVT 실패 → 수평 접선 또는 평균 변화율과 같은 접선이 **보장되지 않음**.
- 수직 접선(\(f'\) 발산)도 MVT의 결론을 무너뜨릴 수 있다(가정 위반).

---

## 실전 최적화 시나리오 3가지

### 생산 비용 최소화 (단순 모델)

총비용 \(C(q)=cq+\alpha q^2\), \(q\in[0,Q_{\max}]\).
\(C'(q)=c+2\alpha q=0\Rightarrow q^*=-c/(2\alpha)\).
- \(\alpha>0\)이면 볼록, 내부해가 음수일 수 있으므로 **경계** \(0\) 또는 \(Q_{\max}\) 비교.
- EVT 절차로 \(q\) 후보(임계+끝점)에서 \(C\)값 비교.

### 로지스틱 성장의 순간 최대 증가율

\(P'(t)=rP(1-\tfrac{P}{K})\). 증가율 최대는 \(P=K/2\) (미분으로 확인).
MVT 해석: 어떤 구간에서 평균 증가율과 같은 순간 증가율이 존재 → **중간 시점**에 최대 기울기 근처가 나타난다.

### 공정 품질 편차 경계

결함율 함수 \(d(T)\) 미분 가능, \(|d'(T)|\le L\). 온도 \(T\)가 \(\pm \Delta\) 변하면
\(|d(T+\Delta)-d(T)|\le L|\Delta|\) (MVT) → **허용 편차**를 \(L\)로 관리.

---

## 추가 예제 모음 (풀이 포함)

### MVT로 \(|\sin b-\sin a|\le |b-a|\)

\[
\sin b-\sin a=\cos(\xi)(b-a),\quad \xi\in(a,b).
\]
\(|\cos\xi|\le 1\Rightarrow\) 절댓값 양변 적용.

### 로그 차이 경계

위 §6.3 참조: \(\ln\)의 도함수로 상·하 경계 도출.

### 역함수 존재성 힌트 (단조성과 MVT)

\(f'(x)>0\) everywhere ⇒ \(f\) **단사**(strictly increasing) ⇒ 역함수 존재(적절한 공역에서).

### 극값 분류

\(f(x)=x^{4/3}\) at \(x=0\): \(f'(x)=\tfrac{4}{3}x^{1/3}\) (0에서 0), \(f''(x)=\tfrac{4}{9}x^{-2/3}\) (발산) → 2차 테스트 실패. 1차 부호 변화로 \(-\to +\) ⇒ **극소**.

---

## 파이썬 시각화/검증 코드 (설명용)

> 주: 아래 코드는 예시입니다. 실행하려면 `numpy`, `matplotlib`가 필요합니다.

### 평균값 정리 시각화 ( \(f(x)=x^2\), \([1,4]\) )

```python
import numpy as np
import matplotlib.pyplot as plt

f = lambda x: x**2
a, b = 1.0, 4.0
x = np.linspace(a-0.5, b+0.5, 400)
y = f(x)

# 평균 변화율

slope = (f(b) - f(a)) / (b - a)
c = (slope) / 2.0  # 2c = slope ⇒ c = 2.5
tangent_y = slope*(x - c) + f(c)

plt.figure(figsize=(7,5))
plt.plot(x, y, label='f(x)=x^2')
plt.plot([a,b], [f(a), f(b)], 'r--', label='Secant: avg slope')
plt.plot(x, tangent_y, 'g--', label=f"Tangent at c={c:.2f}")
plt.scatter([a,b,c], [f(a), f(b), f(c)], color=['red','red','green'])
plt.title('Mean Value Theorem on [1,4]')
plt.grid(True); plt.legend(); plt.show()
```

### EVT 절차 자동화 샘플 (임계점+끝점 비교)

```python
import numpy as np

def extrema_on_closed_interval(f, fp, a, b, candidates=()):
    # 후보: f'(x)=0 해 + 미분불능점(사용자가 넘겨 주거나 별도 처리) + a,b
    cand = [a, b] + list(candidates)
    # 수치적으로도 몇 개 찍어보면 안전장치가 된다(선택)
    xs = np.linspace(a, b, 401)
    sign = np.sign(fp(xs))
    zero_cross = xs[1:][(sign[:-1]*sign[1:]<=0)]
    cand.extend(zero_cross.tolist())
    cand = sorted(set(cand))
    vals = [(x0, f(x0)) for x0 in cand]
    x_min, v_min = min(vals, key=lambda t:t[1])
    x_max, v_max = max(vals, key=lambda t:t[1])
    return (x_min, v_min), (x_max, v_max), vals

f = lambda x: x**3 - 3*x**2 + 1
fp = np.vectorize(lambda x: 3*x**2 - 6*x)
print(extrema_on_closed_interval(f, fp, 0.0, 3.0))
```

### \(|\sin b-\sin a|\le |b-a|\) 수치 검증

```python
import numpy as np
import math
rng = np.random.default_rng(0)
for _ in range(5):
    a, b = rng.uniform(-3,3,2)
    lhs = abs(math.sin(b) - math.sin(a))
    rhs = abs(b - a)
    print(f"a={a:.3f}, b={b:.3f}, |Δsin|={lhs:.6f} ≤ |Δx|={rhs:.6f} ? {lhs<=rhs}")
```

---

## 요약 체크리스트

- [ ] **EVT**: 연속 + 폐구간 ⇒ **절대** 최대/최소 **존재**.
- [ ] **후보 모두**: \(f'(x)=0\), 미분 불능점, **끝점**.
- [ ] **Fermat**: 내부 로컬 극값 + 미분 가능 ⇒ \(f'(c)=0\).
- [ ] **Rolle**: \(f(a)=f(b)\) ⇒ 어딘가 \(f'(c)=0\).
- [ ] **MVT**: \(f'(c)=\frac{f(b)-f(a)}{b-a}\) (접선 = 할선 기울기).
- [ ] **응용**: 단조성/리프시츠/불등식/평균=순간 속도.
- [ ] **Cauchy MVT** → **로피탈**의 논리적 기반.
- [ ] **함정**: 열린 구간/불연속/비미분점/수직 접선은 정리 **가정 위반**.

---

## 마무리

- **EVT**는 “있다”를 보장하고, **Rolle/MVT**는 “어딘가에서 접선/기울기의 특정 성질”을 보장한다.
- 실전 최적화는 **임계점 + 비미분점 + 경계**를 모두 검사해야 안전하다.
- MVT로 얻는 **리프시츠 경계**와 **불등식들**은 분석/알고리즘 안정성 평가에 바로 쓸 수 있다.
