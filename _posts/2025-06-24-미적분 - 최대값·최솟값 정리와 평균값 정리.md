---
layout: post
title: 미적분 - 최대값·최솟값 정리와 평균값 정리
date: 2025-06-24 19:20:23 +0900
category: 미적분
---
# 최대값·최솟값 정리와 평균값 정리 (EVT, Rolle, MVT) — 정식 진술, 직관, 증명, 반례, 응용, 코드

미분의 핵심 정리들인 **최대값·최솟값 정리(EVT)**, **롤의 정리(Rolle)**, **평균값 정리(MVT)**는
함수의 **극값 존재**, **수평 접선의 존재**, **평균 변화율 = 순간 변화율**을 각각 보장한다.

---

## 0) 사전 용어 — 극값과 임계점

| 용어 | 정의(요지) |
|---|---|
| 국소 극댓값 | 어떤 점 $$c$$의 근방에서 $$f(c)\ge f(x)$$ |
| 국소 극솟값 | 어떤 점 $$c$$의 근방에서 $$f(c)\le f(x)$$ |
| 전역(절대) 극댓/극솟 | 전체 구간에서 최대/최소값을 가짐 |
| 임계점 | $$f'(c)=0$$ 또는 $$f'$$ 미정인 점 |

**페르마 정리(필요조건).** $$f$$ 가 내부점 $$c$$ 에서 극값을 가지며 미분 가능하면 $$f'(c)=0$$.

---

## 1) 최대값·최솟값 정리 (EVT, 바이어슈트라스)

**정리(존재성).** $$f$$ 가 폐구간 $$[a,b]$$ 에서 연속이면
$$
\exists\,x_{\min},x_{\max}\in[a,b]:\quad
f(x_{\min})=\min_{x\in[a,b]} f(x),\qquad
f(x_{\max})=\max_{x\in[a,b]} f(x).
$$

- 직관: 연속함수는 닫히고 유계인 구간의 값을 끊김 없이 메운다. 값의 집합이 닫히고 유계라 극값을 갖는다.
- 주의: 위치나 개수는 말해주지 않는다. 존재만 보장.

**짧은 증명 스케치.** 연속함수는 콤팩트 집합을 콤팩트 집합으로 보낸다. 콤팩트의 실수 부분집합은 닫히고 유계이므로 최솟값과 최댓값을 가진다.

**예.** $$f(x)=x^3-3x^2+1,\ [0,3]$$.
$$
f'(x)=3x(x-2)\Rightarrow x=0,2.
$$
값 비교
$$
f(0)=1,\quad f(2)=-3,\quad f(3)=1
\Rightarrow \min=-3\ (x=2),\ \max=1\ (x=0,3).
$$

**EVT 실패 반례.**
- 연속성 결여: $$f(x)=\frac1x,\ (0,1]$$ 은 상한이 있으나 최대값은 없다.
- 폐구간 아님: $$f(x)=x,\ (0,1)$$ 은 최소, 최대 없음.

---

## 2) 롤의 정리 (Rolle)

**가정.**
1) $$f$$ 는 $$[a,b]$$ 에서 연속,
2) $$(a,b)$$ 에서 미분 가능,
3) $$f(a)=f(b)$$.

**결론.**
$$
\exists\,c\in(a,b):\quad f'(c)=0.
$$

- 기하학: 시작과 끝의 높이가 같다면 그래프 어딘가에 수평 접선이 존재한다.
- EVT + 페르마 정리로 증명: 극값이 내부에서 달성되면 수평 접선이 있다. 끝점에서만 달성되는 경우에도 반대쪽 끝과 같은 값을 이용하면 내부에 적어도 하나가 존재한다.

**예.** $$f(x)=(x-2)^2,\ [0,4].\ f(0)=f(4)=4,\ f'(x)=2x-4,\ f'(2)=0.$$

**실패 반례.** $$f(x)=|x|,\ [-1,1]$$ 은 연속이고 $$f(-1)=f(1)$$ 이지만 $$x=0$$ 에서 미분 불능이므로 가정 위반. 수평 접선 보장 불가.

---

## 3) 평균값 정리 (MVT, 라그랑주)

**가정.**
1) $$f$$ 는 $$[a,b]$$ 에서 연속,
2) $$(a,b)$$ 에서 미분 가능.

**결론.**
$$
\exists\,c\in(a,b):\quad
\boxed{\,f'(c)=\frac{f(b)-f(a)}{b-a}\,}.
$$

- 기하학: 어떤 점에서의 접선이 양 끝점을 잇는 할선과 평행하다.
- 롤의 정리로 증명: $$\phi(x)=f(x)-\ell(x)$$, 여기서 $$\ell(x)$$ 는 두 끝점을 잇는 직선. 그러면 $$\phi(a)=\phi(b)=0$$ 이고 Rolle 적용으로 $$\phi'(c)=0\Rightarrow f'(c)=\ell'(x).$$

**예.** $$f(x)=x^2,\ [1,4]$$.
$$
\frac{f(4)-f(1)}{4-1}=\frac{16-1}{3}=5,\quad
f'(x)=2x=5\Rightarrow c=\frac52.
$$

**중요 귀결.**
- 단조성: $$f'(x)\ge 0\ \forall x\Rightarrow f$$ 단조 증가. (평균값정리로 임의의 두 점 차이를 양수로 보임)
- 리프시츠(1차 성장): $$|f'(x)|\le M\Rightarrow |f(b)-f(a)|\le M|b-a|.$$
- 상수함수 판정: $$f'(x)=0\ \forall x\Rightarrow f$$ 는 상수.

---

## 4) 코시 평균값 정리 (CMVT)와 연결

**정리.** $$f,g$$ 가 $$[a,b]$$ 연속, $$(a,b)$$ 미분 가능이고 $$g'$$ 가 어딘가에서 0이 아니면
$$
\exists\,c\in(a,b):\quad
\frac{f'(c)}{g'(c)}=\frac{f(b)-f(a)}{g(b)-g(a)}\quad(g(b)\ne g(a)).
$$

- $$g(x)=x$$ 로 두면 MVT가 나온다.
- **로피탈의 법칙**의 핵심 도구가 된다(극한에서 CMVT 적용).

---

## 5) 통합 관점: EVT → Rolle → MVT → CMVT

- EVT로 극값 존재,
- Rolle로 끝값이 같으면 수평 접선,
- MVT로 일반 두 점에서 접선과 할선의 평행 보장,
- CMVT로 두 함수의 변화율 비를 정밀 비교.

---

## 6) 조건이 깨질 때 생기는 대표 반례들

1) EVT 실패: 연속 아니거나 폐구간이 아니면 극값이 없을 수 있다.
   - $$f(x)=1/x,\ (0,1]$$ 최대 없음.
2) MVT 실패: 미분 가능 아님.
   - $$f(x)=|x|,\ [-1,1]$$ 은 할선 기울기 0인데 접선 기울기 0인 내부점이 없다(미분 불능).
3) Rolle 실패: $$f(a)=f(b)$$ 조건 불충족 또는 미분 불능.

---

## 7) 응용 1 — 단조성, 부등식, 오차 추정

### 7.1 단조성
$$f'(x)\ge 0$$ 이면 임의의 $$a<b$$ 에 대해
$$
f(b)-f(a)=f'(\xi)(b-a)\ge 0\quad(\exists\,\xi\in(a,b))
$$
이므로 단조 증가.

### 7.2 접선에 의한 하한/상한
$$f'(x)\ge m\ \forall x\in[a,b]\Rightarrow f(x)\ge f(a)+m(x-a).$$  
동일하게 $$f'(x)\le M\Rightarrow f(x)\le f(a)+M(x-a).$$

### 7.3 테일러 1차 근사 오차
$$|f'(x)|\le M\Rightarrow |f(x)-\ell(x)|\le \frac{M}{2}|x-a|\quad(\ell: a$$ 에서의 접선 근사).  
증명은 평균값 정리를 적분적 관점과 결합해 얻는다.

---

## 8) 응용 2 — 고전 부등식의 유도 예

### 8.1 사인 부등식
$$
\sin x \le x \le \tan x\quad(0<x<\pi/2)
$$
은 볼록성 또는 MVT로 유도 가능. 예를 들어
$$
\frac{\sin x - \sin 0}{x-0}=\cos \xi \le 1\ \Rightarrow\ \sin x \le x.
$$
또한
$$
\frac{\tan x - \tan 0}{x-0}=\sec^2\eta \ge 1\ \Rightarrow\ x \le \tan x.
$$

### 8.2 지수-로그 비교
$$
\ln(1+x)\le x\quad(x>-1)
$$
도 MVT로 가능. $$f(x)=\ln(1+x)$$ 에 대해 $$f'(x)=1/(1+x)\le 1$$.

---

## 9) 응용 3 — 최적화 루틴에서의 사용

- 임계점 후보: $$f'(x)=0$$ 또는 미분 불능점, 그리고 경계값을 EVT로 함께 비교.
- 극값 판정: 1차 부호 변화 또는 2차 도함수로 판정.
- 제약 문제에서는 라그랑주 승수와 결합(여기서는 생략).

**예.** 울타리 문제: 총 울타리 길이 고정 조건에서 직사각형 면적 최대.  
대입해 단변수로 만들고 임계점을 MVT 관점(도함수 0)으로 찾는다.

---

## 10) 정적분의 평균값 정리(참고)

$$f$$ 가 $$[a,b]$$ 연속, $$g$$ 가 부호 일정하고 연속이면
$$
\exists\,c\in[a,b]:\quad \int_a^b f(x)g(x)\,dx = f(c)\int_a^b g(x)\,dx.
$$
특히 $$g\equiv 1$$ 이면
$$
\exists\,c:\quad \int_a^b f(x)\,dx = f(c)\,(b-a).
$$

---

## 11) 종합 예제 — 조건 확인부터 계산까지

**문제.** $$f(x)=\sqrt{x},\ [1,4].$$  
1) EVT 적용 여부, 2) MVT가 보장하는 $$c$$, 3) 단조성.

**풀이.**
1) 연속이므로 EVT로 $$\min f=1\ (x=1),\ \max f=2\ (x=4)$$ 존재.  
2)
$$
\frac{f(4)-f(1)}{4-1}=\frac{2-1}{3}=\frac13,\qquad
f'(x)=\frac{1}{2\sqrt{x}}=\frac13\Rightarrow x=\frac{9}{4}.
$$
3) $$f'(x)>0\ (x>0)$$ 이므로 단조 증가.

---

## 12) 반례 모음과 해석

1) MVT 가정 불충족:
   - $$f(x)=|x|,\ [-1,1]$$ 은 연속이지만 미분 불능점 존재. 평균 변화율 0을 주는 접선 기울기가 내부에 존재한다고 결론 내릴 수 없다.
2) EVT 가정 불충족:
   - 열린구간, 불연속 함수 등에서는 전역 극값이 존재하지 않을 수 있다.

---

## 13) 파이썬 시각화 — 평균값 정리와 접선/할선 비교

아래 코드는 $$f(x)=x^2$$, 구간 $$[1,4]$$ 에서 MVT를 시각화한다.  
편의를 위해 접선은 $$c=2.5$$ 에서 그린다.

```python
import numpy as np
import matplotlib.pyplot as plt

# 함수와 구간
x = np.linspace(0, 4, 400)
y = x**2
a, b = 1, 4
fa, fb = a**2, b**2
slope = (fb - fa)/(b - a)  # 평균 변화율 = 5

# MVT가 보장하는 c (해석적으로 2x=5 -> x=2.5)
c = 2.5
yc = c**2

# c에서의 접선
xt = np.linspace(c-1.2, c+1.2, 2)
yt = yc + slope*(xt - c)

# 그림
fig, ax = plt.subplots(figsize=(7,5))
ax.plot(x, y, label="f(x) = x^2")
ax.plot([a, b], [fa, fb], 'r--', label="할선 (평균 변화율 = 5)")
ax.plot(xt, yt, 'g--', label="c=2.5에서의 접선 (기울기 5)")
ax.scatter([a, b, c], [fa, fb, yc], color=['red','red','green'])
ax.annotate('a=1', (a,fa), xytext=(0.8,1.5), arrowprops=dict(arrowstyle='->'))
ax.annotate('b=4', (b,fb), xytext=(3.6,14), arrowprops=dict(arrowstyle='->'))
ax.annotate('c=2.5', (c,yc), xytext=(2.0,9), arrowprops=dict(arrowstyle='->'))
ax.grid(True); ax.legend(); ax.set_title("평균값 정리 시각화")
plt.show()
```

원한다면 다른 함수(예: $$\sqrt{x}$$, $$\sin x$$)나 다른 구간으로 바꿔 실험할 수 있다.

---

## 14) 빠른 연습문제와 해설 스케치

1) $$f(x)=x^3-3x,\ [0,3]$$ 의 절대 최대/최소를 구하라.  
   해: $$f'(x)=3x^2-3=0\Rightarrow x=1.$$  
   값 비교: $$f(0)=0,\ f(1)=-2,\ f(3)=18.$$  
   절대최솟값 $$-2\ (x=1),$$ 절대최댓값 $$18\ (x=3).$$

2) $$f:[0,1]\to\mathbb{R}$$ 연속, 미분 가능, $$f(0)=0,\ f(1)=2.$$
   (a) MVT로 $$\exists c:\ f'(c)=2.$$  
   (b) 만약 $$|f'(x)|\le 1$$ 이면 $$|f(1)-f(0)|\le 1\cdot(1-0)=1$$ 과 모순. 따라서 그런 함수는 없다.

3) $$f(x)=|x|,\ [-1,1]$$ 에 대해 MVT가 왜 적용되지 않는가?  
   해: $$x=0$$ 에서 미분 불능이므로 가정 위반.

4) $$\ln(1+x)\le x\ (x>-1)$$ 을 MVT로 보이라.  
   해: $$f'(x)=1/(1+x)\le 1$$, $$f(0)=0$$ 을 이용하면 $$f(x)\le x$$.

5) $$\sin x \le x \le \tan x\ (0<x<\pi/2)$$ 을 MVT나 볼록성으로 보이라.  
   해: 위 8.1 참조.

---

## 15) 한눈 요약 표

| 정리 | 조건 | 결론 | 핵심 해석 |
|---|---|---|---|
| EVT | $$[a,b]$$ 연속 | $$\exists\ \min,\max$$ | 극값 존재 보장 |
| Rolle | 연속+미분 가능, $$f(a)=f(b)$$ | $$\exists c:\ f'(c)=0$$ | 수평 접선 존재 |
| MVT | 연속+미분 가능 | $$\exists c:\ f'(c)=\dfrac{\Delta f}{\Delta x}$$ | 순간=평균 변화율 |
| CMVT | 연속+미분 가능(두 함수) | $$\dfrac{f'(c)}{g'(c)}=\dfrac{\Delta f}{\Delta g}$$ | 변화율 비 동치 |

---

## 16) 마무리

- **EVT**: 연속 + 폐구간이면 극값이 반드시 존재한다.  
- **Rolle**: 끝값 같으면 어딘가 수평 접선이 있다.  
- **MVT**: 접선 기울기가 평균 변화율과 일치하는 점이 존재한다.  
- 이 3형제는 단조성 판정, 오차 추정, 최적화, 로피탈의 법칙, 각종 부등식의 증명으로 이어지는 미분 해석의 토대다.