---
layout: post
title: 미적분 - 미분방정식
date: 2025-07-02 23:20:23 +0900
category: 미적분
---
# 미분방정식 (Differential Equations) — 개념, 풀이법, 응용, 팁

(수학식은 반드시 $$\cdots$$, 코드가 있으면 ```로 감싼다.)

---

## ✅ 1) 무엇을 다루나? (정의와 예)
**미분방정식**은 **미지 함수와 그 도함수들** 사이의 관계를 식으로 나타낸 것.
- 예: $$\dfrac{dy}{dx}=k\,y\quad(\text{증가율이 함수 자체에 비례})$$
- 예: $$m y''+c y'+k y=F_0\cos\omega t\quad(\text{질량–댐핑–스프링})$$

---

## ✅ 2) 분류 (차수·선형성·상/편미분)
- **차수(order)**: 최고 미분차수
  - 1계: $$\dfrac{dy}{dx}=f(x,y)$$
  - 2계: $$y''+3y'+2y=0$$
- **선형/비선형**
  - 선형 1계: $$y'+p(x)y=q(x)$$
  - 비선형: $$y^2,\; \sin y,\; y\,y'$$ 등 포함
- **상미분/편미분**
  - ODE: $$y'(x)=x+y$$
  - PDE: $$u_t=c^2 u_{xx}$$ (열 방정식)

---

## ✅ 3) 해의 존재성과 유일성 (안심하고 푼다)
**피카르–린델뢰프 정리(요지)**  
$$y'=f(x,y),\; y(x_0)=y_0$$에서, $$f$$와 $$\partial f/\partial y$$가 근방에서 연속이면,
- **어떤 구간에 해가 존재**하고,
- 그 해는 **유일**하다.

> 경고: $$y'=\sqrt{|y|},\ y(0)=0$$ 처럼 **리프시츠 연속성이 깨진** 경우 해가 유일하지 않을 수 있다.

---

## ✅ 4) 1계 미분방정식 — 핵심 유형과 빠른 해법

### 4.1 변수분리형 (Separable)
$$
y'=g(x)h(y)\ \Rightarrow\ \frac{dy}{h(y)}=g(x)\,dx\ \Rightarrow\ \int\frac{dy}{h(y)}=\int g(x)\,dx.
$$

**예**: $$y'=x\,y\ \Rightarrow\ \ln|y|=\tfrac12 x^2+C\ \Rightarrow\ y=C e^{x^2/2}.$$

---

### 4.2 선형 1계 (Integrating Factor)
$$
y'+p(x)y=q(x),\quad \mu(x)=e^{\int p(x)\,dx}.
$$
곱하면 $$\dfrac{d}{dx}[\mu y]=\mu q\ \Rightarrow\ \mu y=\int \mu q\,dx+C.$$

**예**: $$y'-y=e^x\Rightarrow \mu=e^{-x} \Rightarrow (e^{-x}y)'=1 \Rightarrow y=e^x(x+C).$$

---

### 4.3 정확(Exact) 방정식
$$
M(x,y)\,dx+N(x,y)\,dy=0,\quad M_y=N_x\ \Rightarrow\ \exists\,\Phi:\ \Phi_x=M,\ \Phi_y=N.
$$
해는 $$\Phi(x,y)=C.$$

**예**: $$(2x+3y)\,dx+(3x+4y)\,dy=0,$$  
$$M_y=3=N_x\Rightarrow \Phi=\int M\,dx=x^2+3xy+g(y)$$  
$$\Phi_y=3x+g'(y)\equiv N=3x+4y\Rightarrow g'(y)=4y\Rightarrow g=2y^2.$$  
**해**: $$x^2+3xy+2y^2=C.$$

---

### 4.4 동차(Homogeneous, $$y/x$$형)
$$
y'=F\!\left(\frac{y}{x}\right),\quad v=\frac{y}{x}\Rightarrow y=xv,\ y'=v+xv'.
$$
대입 후 분리.

---

### 4.5 베르누이 (Bernoulli)
$$
y'+p(x)y=q(x) y^n\ (n\neq 0,1).
$$
$$
z=y^{1-n}\Rightarrow z'+(1-n)p(x) z=(1-n)q(x).
$$

**예**: $$y'+y= y^2\Rightarrow z=1/y\Rightarrow z'-z= -1.$$

---

### 4.6 리카티(Riccati) 짤막 노트
$$y'=a(x)y^2+b(x)y+c(x).$$ 한 개의 특수해를 알면 **선형**으로 환원 가능.

---

### 4.7 자율방정식(Autonomous)과 평형점
$$y'=f(y).$$  
평형점 $$f(y^\*)=0$$.  
- $$f'(y^\*)<0$$: 안정, $$>0$$: 불안정.

**예**(로지스틱): $$y'=r y\left(1-\frac{y}{K}\right)\Rightarrow y(t)=\frac{K}{1+A e^{-rt}}.$$

---

## ✅ 5) 2계 선형 ODE — 원리와 표준해

### 5.1 동차, 계수 상수
$$
a y''+b y'+c y=0\ \Rightarrow\ ar^2+br+c=0.
$$
- **서로 다른 실근** $$r_1\neq r_2$$: $$y=C_1 e^{r_1 x}+C_2 e^{r_2 x}.$$
- **중근** $$r$$: $$y=(C_1+C_2 x)e^{r x}.$$
- **복소근** $$\alpha\pm i\beta$$: $$y=e^{\alpha x}(C_1\cos\beta x+C_2\sin\beta x).$$

**예**: $$y''-3y'+2y=0\Rightarrow r=1,2\Rightarrow y=C_1 e^x+C_2 e^{2x}.$$

---

### 5.2 비동차: 두 가지 대표 기법
- **미정계수법**(우변이 $$e^{ax},\ \sin,\ \cos,\ \text{다항식}$$ 등):  
  특해 꼴을 ‘따라 쓰고’ 계수 결정.
- **가변계수법(파라메타 변분, Variation of Parameters)**: 일반 우변에 적용 가능.

**미정계수법 예**  
$$y''+y=\cos x.$$
1) 동차해: $$y_h=C_1\cos x+C_2\sin x.$$  
2) 우변과 공진 → $$y_p=Ax\sin x$$로 가정.  
3) 대입해 $$A=\tfrac12\Rightarrow y=\;C_1\cos x+C_2\sin x+\tfrac12 x\sin x.$$

---

### 5.3 오일러–코시(Euler–Cauchy)
$$
x^2 y''+\alpha x y'+\beta y=0,\quad y=x^r\Rightarrow r(r-1)+\alpha r+\beta=0.
$$

---

## ✅ 6) 물리 모델 한눈에 (질량–스프링–댐퍼)
$$
m y''+c y'+k y=F_0\cos\omega t.
$$
- 무감쇠 $$c=0$$: **공진** $$\omega=\sqrt{k/m}$$.
- 감쇠: **과/임/임계감쇠**는 판별식 $$\zeta=\frac{c}{2\sqrt{mk}}$$로 판정.
- 해 = **과도(transient)** + **정상(steady-state)**.

---

## ✅ 7) 시스템 ODE (벡터형)와 위상평면
$$
\mathbf{x}'=A\mathbf{x},\quad \mathbf{x}=\begin{bmatrix}x\\y\end{bmatrix}.
$$
고유값 $$\lambda_i$$, 고유벡터로 해: $$\mathbf{x}(t)=\sum C_i e^{\lambda_i t}\mathbf{v}_i.$$

**예**: $$\begin{bmatrix}x\\y\end{bmatrix}'=\begin{bmatrix}0&1\\-2&-3\end{bmatrix}\begin{bmatrix}x\\y\end{bmatrix}$$  
고유값 $$-1,-2\Rightarrow$$ 안정 절점.

---

## ✅ 8) 라플라스 변환으로 IVP 빠르게
선형 상수계수 + 초기치에 강력.
- 표준: $$\mathcal{L}\{y'\}=sY(s)-y(0),\ \mathcal{L}\{y''\}=s^2Y(s)-s y(0)-y'(0).$$
- 계단/임펄스(단위계단 $$u(t-a)$$, 델타 $$\delta$$) 신호 처리에 유리.

**예**: $$y''+y=\delta(t-\pi),\ y(0)=y'(0)=0 \Rightarrow$$ 역변환으로 **충격 응답**.

---

## ✅ 9) 수치해법 개요 (손으로 적분이 안 될 때)
- **오일러**: $$y_{n+1}=y_n+h f(x_n,y_n)$$ (간단/부정확)
- **개선 오일러(Heun)**, **RK4**: 정확도↑
- **강건성/경 stiff** 문제: **암시적** 방법 필요(예: Backward Euler, BDF)

```python
# 예: y' = y(1 - y), y(0)=0.2 (로지스틱) — RK4
import numpy as np
def f(x, y): return y*(1-y)
def rk4(x0, y0, h, N):
    xs=[x0]; ys=[y0]
    for _ in range(N):
        k1=f(x0,y0)
        k2=f(x0+h/2, y0+h*k1/2)
        k3=f(x0+h/2, y0+h*k2/2)
        k4=f(x0+h,   y0+h*k3)
        y0 += (h/6)*(k1+2*k2+2*k3+k4)
        x0 += h
        xs.append(x0); ys.append(y0)
    return np.array(xs), np.array(ys)
```

---

## ✅ 10) 방향장(슬로프 필드)로 해의 거동 미리 보기
$$y'=f(x,y)$$의 기울기 화살표들을 그려 해 곡선의 흐름을 직관적으로 파악.

```python
# 간단 슬로프필드: y' = x - y
import numpy as np, matplotlib.pyplot as plt
X,Y = np.meshgrid(np.linspace(-2,2,21), np.linspace(-2,2,21))
U = 1; V = X - Y
N = np.hypot(U,V); U/=N; V/=N
plt.quiver(X,Y,U,V, angles='xy')
plt.title("Slope field: y' = x - y"); plt.axis('equal'); plt.grid(True); plt.show()
```

---

## ✅ 11) 대표 응용 미니 캘럭션

### 11.1 지수 성장/감쇠
$$y'=k y\Rightarrow y=y_0 e^{k t}.$$

### 11.2 로지스틱 성장
$$y'=r y(1-y/K)\Rightarrow y(t)=\dfrac{K}{1+A e^{-r t}}.$$

### 11.3 RC 회로
$$
C v'(t)+\frac{1}{R}v(t)=\frac{1}{R}V_{\text{in}}(t).
$$

### 11.4 뉴턴 냉각
$$
T'=-k(T-T_{\text{env}})\Rightarrow T=T_{\text{env}}+(T_0-T_{\text{env}})e^{-k t}.
$$

---

## ✅ 12) 초기값·경계값 문제 구별
- **IVP**: $$y(x_0)=y_0,\ y'(x_0)=\cdots$$ (시간 진화형)
- **BVP**: $$y(a)=\alpha,\ y(b)=\beta$$ (정상상태, 고유치·고유함수 등장 자주)

---

## ✅ 13) 차원해석 & 무차원화(스케일링)
스케일 $$x=L\tilde x,\ t=T\tilde t,\ y=Y\tilde y$$ 로 **무차원 매개변수**를 밝히면
- 유효 변수 감소,
- 지배 파라미터(레이놀즈수 같은) 도출.

---

## ✅ 14) 흔한 실수 & 체크리스트
- [ ] **유형 판별** 먼저(분리/선형/정확/동차/베르누이/시스템/2계)  
- [ ] 존재·유일성 조건 확인(특이점에서 해 유일성 실패 가능)  
- [ ] 선형 1계는 **적분인자** 자동 시도  
- [ ] 비동차 2계: **우변 형태**와 **공진 여부** 점검(필요시 $$x$$ 곱해 교정)  
- [ ] 상수 결정 시 **초기·경계조건** 정확 대입  
- [ ] 물리모델: **단위**·**에너지/안정성** 상식 점검

---

## ✅ 15) 요약 표

| 유형 | 표준형 | 핵심 아이디어 | 한 줄 해법 |
|---|---|---|---|
| 분리형 | $$y'=g(x)h(y)$$ | 변수 분리 | $$\int\frac{dy}{h}=\int g\,dx$$ |
| 선형 1계 | $$y'+py=q$$ | 적분인자 | $$\mu=e^{\int p},\ (\mu y)'=\mu q$$ |
| 정확 | $$Mdx+Ndy=0$$ | $$M_y=N_x$$ | $$\Phi_x=M,\ \Phi_y=N$$ |
| 동차(1계) | $$y'=F(y/x)$$ | $$v=y/x$$ 치환 | $$y=xv,\ y'=v+xv'$$ |
| 베르누이 | $$y'+py=qy^n$$ | 멱치환 | $$z=y^{1-n}$$ |
| 2계 동차 | $$ay''+by'+cy=0$$ | 특성방정식 | $$ar^2+br+c=0$$ |
| 2계 비동차 | $$ay''+by'+cy=g$$ | 미정/가변계수 | 공진 주의 |

---

## ✅ 16) 연습문제(정답 스케치)

1) $$y'=(x^2+1)y,\ y(0)=3$$  
   분리: $$\ln y=\tfrac{x^3}{3}+x+C\Rightarrow y=3\,e^{x+x^3/3}.$$

2) $$y'+\dfrac{2}{x}y=\dfrac{\sin x}{x^2},\ x>0$$  
   선형: $$\mu=e^{\int 2/x\,dx}=x^2,\ (x^2 y)'=\sin x\Rightarrow y=\dfrac{-\cos x+C}{x^2}.$$

3) $$y''-4y'+4y=e^{2x}$$  
   동차근 $$r=2$$(중근) → $$y_h=(C_1+C_2 x)e^{2x}$$, 공진 → 특해 $$y_p=Ax^2e^{2x}$$.

4) $$y'=y(1-y),\ y(0)=y_0$$  
   로지스틱: $$y=\dfrac{1}{1+((1/y_0)-1)e^{-t}}.$$

---

## ✅ 17) 한 문장 결론
미분방정식은 **유형 판별 → 표준 기법 적용 → 조건 대입/안정성 해석**의 루틴으로 푼다.  
공진·특이점·경계조건에만 주의하면, 대부분의 초·중급 문제는 **적분인자/분리/특성방정식/미정계수** 네 가지로 제압된다.