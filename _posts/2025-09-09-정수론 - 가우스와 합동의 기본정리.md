---
layout: post
title: 정수론 - 가우스와 합동의 기본정리
date: 2025-09-09 17:25:23 +0900
category: 정수론
---
# 합동이론 — 가우스와 합동의 기본정리

## 합동의 기초

### 정의와 표기

**정의.** 정수 $$a,b$$, 양의 정수 $$m\ge2$$ 에 대하여
$$
a\equiv b \pmod m
\quad\Longleftrightarrow\quad
m\mid (a-b).
$$
이는 $$a$$, $$b$$ 가 $$m$$ 으로 나눈 **나머지가 같다**는 말과 동치다. 합동은 다음을 만족한다:

- 반사성: $$a\equiv a\pmod m.$$
- 대칭성: $$a\equiv b\pmod m\Rightarrow b\equiv a\pmod m.$$
- 추이성: $$a\equiv b\pmod m,\ b\equiv c\pmod m\Rightarrow a\equiv c\pmod m.$$

따라서 $$\mathbb{Z}$$ 를 $$m$$ 으로 나눴을 때의 **동치관계**가 된다.

### 연산의 보존

합동은 덧셈·뺄셈·곱셈·거듭제곱에서 안정적이다:
$$
a\equiv b,\ c\equiv d\ (\bmod m)
\ \Rightarrow\
a\pm c\equiv b\pm d,\ \ ac\equiv bd,\ \ a^k\equiv b^k\ (\bmod m).
$$

> **주의(나눗셈의 위험)**: 일반적으로 합동에서 “양변을 같은 수로 나누는” 연산은 **항상 허용되지 않는다**. 이를 안전하게 다루는 핵심이 ‘가우스의 정리(소거법칙)’다.

---

## 잔여계(Residue Systems)와 $$\varphi$$

### 완전잔여계·축약잔여계

- **완전 잔여계(CRS)**: $$\{0,1,\dots,m-1\}$$ 와 같이 $$m$$ 개의 서로 다른 잔여를 정확히 한 번씩 대표하는 집합.
- **축약(감소) 잔여계(RRS)**: $$\{1\le r\le m:\ \gcd(r,m)=1\}$$ 를 모은 집합(순서 무관). 원소의 개수는 **오일러 피 함수**
$$
\varphi(m)=\#\{1\le r\le m:\ \gcd(r,m)=1\}.
$$

### RRS의 선형 보존 성질

**정리.** $$\gcd(k,m)=1$$ 이면, $$R$$ 가 $$m$$ 에 대한 RRS일 때
$$
kR:=\{kr\ (\bmod m): r\in R\}
$$
역시 RRS이다(즉, $$\bmod m$$ 에서 서로 다른 원소로 전단사).

**증명.** $$kr_1\equiv kr_2\ (\bmod m)$$ 이면 $$m\mid k(r_1-r_2)$$. $$\gcd(k,m)=1$$ 이므로 **가우스의 정리**(§2)로 $$m\mid (r_1-r_2)$$, 즉 $$r_1\equiv r_2\ (\bmod m)$$. 하지만 $$R$$ 는 서로 다른 잔여의 대표자 집합이므로 $$r_1=r_2$$. 전사성은 크기 비교로 따른다. □

> 위 증명에서 이미 ‘가우스의 정리(소거법칙)’가 암묵적으로 쓰였다. 다음 절에서 이를 정식화한다.

---

## 가우스의 정리(소거 법칙; Gauss’s Theorem on Cancellation)

### 진술 A(서로소 소거)

**정리(가우스의 정리·소거).** $$\gcd(c,m)=1$$ 이고
$$
ac\equiv bc \pmod m
$$
이면
$$
a\equiv b \pmod m.
$$

**증명.** $$ac\equiv bc\ (\bmod m) \iff m\mid c(a-b).$$ 베주 항등식으로 정수 $$x,y$$ 가 있어 $$cx+my=1$$. 양변에 $$(a-b)$$ 를 곱하면
$$
(a-b)=cx(a-b)+my(a-b).
$$
우변 첫 항은 $$c(a-b)$$ 의 배수, 둘째 항은 $$m$$ 의 배수이므로 전체가 $$m$$ 의 배수. 곧 $$m\mid(a-b)$$, 따라서 $$a\equiv b\ (\bmod m)$$. □

### 진술 B(일반 소거)

**정리(일반 소거).** $$d=\gcd(c,m)$$ 라면
$$
ac\equiv bc\ (\bmod m)
\quad\Longleftrightarrow\quad
a\equiv b\ (\bmod \tfrac{m}{d}).
$$

**증명.** $$ac\equiv bc\ (\bmod m) \iff m\mid c(a-b)$$. $$c=dc',\ m=dm'$$, $$\gcd(c',m')=1$$ 로 놓으면 조건은 $$dm'\mid d c'(a-b) \iff m'\mid c'(a-b)$$. 여기서 §2.1을 적용하면 $$m'\mid (a-b)$$, 즉 $$a\equiv b\ (\bmod m')$$. 역방향은 즉시 성립한다. □

> **요점**: 공통 인수 $$d=\gcd(c,m)$$ 만큼 **법을 줄여서**는 소거가 허용되지만, 그 이상(즉 $$\bmod m$$ 자체)으로는 일반적으로 불가하다. $$\gcd(c,m)=1$$ 일 때만 완전 소거가 가능(§2.1).

---

## 합동의 기본정리(선형합동의 해 존재·개수·형태)

여기서 말하는 “**합동의 기본정리**”는 1차(선형) 합동식
$$
ax\equiv b \pmod m
$$
의 **해 존재 조건**, **해의 개수**, **해의 전형적 형태**를 한 번에 정리하는 정리다.

### 정리(선형합동 기본정리)

**정리.** $$d=\gcd(a,m)$$ 라 하자.
1) **존재 조건**: $$ax\equiv b\ (\bmod m)$$ 이 **해를 갖는 필요충분조건**은 $$d\mid b$$.
2) **해의 개수**: 해가 존재하면, $$\bmod m$$ 에서 **서로 다른 해의 개수는 정확히 $$d$$ 개**.
3) **해의 형태**: 하나의 해 $$x_0$$ 가 있을 때, 모든 해는
$$
x\equiv x_0+\frac{m}{d}\,t \pmod m,\qquad t=0,1,\dots,d-1.
$$
(즉, 법 $$m$$ 에서 서로 다른 $$d$$ 개의 잔여류.)

**증명.**

- (1) **필요성**: $$ax\equiv b\ (\bmod m)\iff m\mid (ax-b).$$ 어떤 공약수(특히 $$d$$)는 좌변을 나누므로 $$d\mid b$$.
  **충분성**: $$d\mid b$$ 이면 $$a=da',\ m=dm',\ b=db'$$ 로 쓰자. 그러면
  $$
  a'x\equiv b' \pmod{m'}\qquad(\gcd(a',m')=1).
  $$
  베주로 $$a' u + m' v=1$$ 인 정수 $$u,v$$ 가 존재하므로 양변에 $$b'$$ 를 곱해 $$a'(ub')\equiv b' \ (\bmod m')$$. 따라서 $$x\equiv x_0:=ub'\ (\bmod m')$$ 는 해. 이를 $$\bmod m$$ 의 진술로 끌어올리면 해가 존재한다.

- (2) **개수**: $$\bmod m'$$ 에서 해는 **정확히 1개**(상기 $$\gcd(a',m')=1$$ 이므로 소거 가능). 이를 $$\bmod m=dm'$$ 으로 끌어올리면, 서로 다른 해는 $$m'$$ 주기의 계급이 $$d$$ 개 생긴다. 좀 더 직접적으로는 다음이 자명하다:
  $$
  a(x+t m')\equiv ax + a t m'\equiv b + 0\ (\bmod m).
  $$
  따라서 $$t=0,1,\dots,d-1$$ 가 서로 다른 해를 만든다. $$t$$ 를 $$d$$ 만큼 더하면 같은 잔여가 된다(왜냐하면 $$d m'=m$$).

- (3) **형태**: 위에서 이미 보였다: 한 해 $$x_0$$ 로부터 $$x_0+t m'$$ (단 $$m'=m/d$$)가 전부이며 서로 다른 해는 $$t=0,\dots,d-1$$ 로 딱 $$d$$ 개. □

---

## — 가우스의 구성

가우스는 합동이론에서 CRT를 체계적으로 다뤘다. 여기서는 **서로소 법**에 대한 표준 정리와 가우스의 **구성적 해법**을 제시한다.

### 정리(CRT: 서로소 법)

**정리(CRT).** $$m_1,\dots,m_k$$ 가 **상호 서로소**(즉 $$\gcd(m_i,m_j)=1\ (i\ne j)$$)라 하자. 임의의 정수열 $$a_1,\dots,a_k$$ 에 대하여
$$
\begin{cases}
x\equiv a_1 \pmod{m_1}\\
\ \ \vdots\\
x\equiv a_k \pmod{m_k}
\end{cases}
$$
는 **법 $$M:=m_1\cdots m_k$$ 에서 유일한 해**를 갖는다.

**증명(존재).** 각 $$i$$ 에 대하여 $$M_i:=M/m_i$$ 를 두면 $$\gcd(M_i,m_i)=1$$. 베주로 정수 $$e_i$$ 가 존재하여
$$
M_i e_i \equiv 1 \pmod{m_i}.
$$
이때
$$
x_0:=\sum_{i=1}^k a_i M_i e_i
$$
라 두면 $$x_0\equiv a_i \ (\bmod m_i)$$ 가 동시에 성립한다(다른 항은 $$m_i$$ 의 배수). 따라서 해가 존재.

**증명(유일성).** 만약 $$x\equiv y \ (\bmod m_i)$$ 가 모든 $$i$$ 에 대해 성립하면, $$m_i\mid (x-y)$$ 가 모든 $$i$$ 에 대해 성립하고, $$m_i$$ 들이 서로소이므로 곱 $$M$$ 도 $$x-y$$ 를 나눈다(소거/귀납으로 보이거나, 이상(ideal) 관점에서 직접적). 곧 $$x\equiv y\ (\bmod M)$$. □

> **핵심**: CRT는 **서로소 법의 덩어리**를 **곱의 법 하나**로 통합/분해하는 **가우스적 도구**다.

---

## 예제 (소수·서로소·해의 개수/형태를 모두 보여주는 하나의 예)

> 요청에 따라 **예제는 적게** 두되 **아주 자세히** 다룬다.

### 예제: $$12x\equiv 8\pmod{20}$$

1) **존재 조건**: $$d=\gcd(12,20)=4$$, $$4\mid 8$$ 이므로 **해 존재**.
2) **축약**: $$12=4\cdot3,\ 20=4\cdot5,\ 8=4\cdot2$$ 이므로
   $$
   3x\equiv 2 \pmod 5.
   $$
   이제 $$\gcd(3,5)=1$$ 이므로 **가우스의 정리(소거)**로 나눗셈을 안전하게 해도 된다.
3) **역원 계산**: $$3^{-1}\ (\bmod 5)$$ 를 찾자. $$3\cdot 2=6\equiv 1\ (\bmod 5)$$, 따라서 $$3^{-1}\equiv 2\ (\bmod 5)$$.
   $$
   x\equiv 2\cdot 2\equiv 4 \pmod 5.
   $$
4) **해의 개수/형태**: 원래 법은 $$m=20$$ 이고 $$d=4$$ 이므로 해는 **서로 다른 것 $$d=4$$ 개**. 위의 일반형에 따라
   $$
   x\equiv 4 + \frac{20}{4}t = 4+5t \pmod{20},\qquad t=0,1,2,3.
   $$
   즉
   $$
   x\equiv 4,9,14,19 \pmod{20}.
   $$
5) **검산(가우스 소거 B형식)**: $$12x\equiv 8\ (\bmod 20) \iff 4\mid(12x-8) \iff 3x\equiv 2\ (\bmod 5)$$ 와 동치. **일반 소거정리**(§2.2)에 정확히 부합한다.

> 이 한 예제에 합동의 기본정리(존재/개수/형태), 가우스 소거(A/B), 역원의 사용이 모두 응축되어 있다.

---

## 추가 정리: 합동의 “나눗셈”과 역원

### 역원 존재성

**정리.** $$\gcd(a,m)=1$$ 일 때에 한해 $$a$$ 의 **모듈러 역원** $$a^{-1}$$ 이 존재하며
$$
aa^{-1}\equiv 1 \pmod m.
$$
**증명.** 베주로 $$ax+my=1$$ 인 정수 $$x,y$$ 가 존재. 양변을 $$\bmod m$$ 로 보면 $$ax\equiv 1$$. 역으로 $$aa^{-1}\equiv 1$$ 이면 $$\gcd(a,m)=1$$ (공약수가 1 이외이면 좌변이 1이 될 수 없음). □

### 합동의 “나눗셈”은 소거정리의 다른 얼굴

$$
ac\equiv bc\ (\bmod m)
$$
에서 양변을 $$c$$ 로 “나누려면”, 실제로는 §2.2의 형식대로
$$
a\equiv b\ (\bmod m/\gcd(c,m))
$$
로 **법을 축소**해야 한다. 특히 $$\gcd(c,m)=1$$ 일 때만 **그대로** $$a\equiv b\ (\bmod m)$$ 가 된다(§2.1).

---

## CRT의 구성적 알고리즘(가우스의 방법)

두 법이 서로소인 경우 $$k=2$$부터 보자.
$$
\begin{cases}
x\equiv a_1\ (\bmod m_1),\\
x\equiv a_2\ (\bmod m_2),
\end{cases}
$$
$$\gcd(m_1,m_2)=1,\ M=m_1m_2.$$

- $$M_1=M/m_1=m_2,\ M_2=M/m_2=m_1.$$
- 정수 $$e_1,e_2$$ 를 구해
  $$
  M_1 e_1\equiv 1\ (\bmod m_1),\qquad
  M_2 e_2\equiv 1\ (\bmod m_2).
  $$
  (확장 유클리드로 계산.)
- 그러면
  $$
  x\equiv a_1 M_1 e_1 + a_2 M_2 e_2 \pmod M
  $$
  가 해이며, $$\bmod M$$ 에서 유일하다.

> **확장**: $$k>2$$ 일 때도 동일. 각 $$i$$ 에 대해 $$M_i=M/m_i$$ 와 $$e_i\equiv M_i^{-1}\ (\bmod m_i)$$ 를 구해 $$x\equiv\sum a_i M_i e_i\ (\bmod M)$$.

---

## 응용 미니어처 — 선형 합동계 해법 요약

1. 각 식 $$a_i x\equiv b_i\ (\bmod m_i)$$ 를 §3의 기본정리로 **정규화**한다: $$d_i=\gcd(a_i,m_i)$$ 가 $$b_i$$ 를 나누는지 확인 → 나누면 축약해 $$a_i',m_i',b_i'$$ (서로소)로 변환, 해를 $$x\equiv r_i\ (\bmod m_i')$$ 꼴로 만든다.
2. 축약된 **서로소 법**들의 모임이면 §4의 **CRT**로 통합하여 $$x\equiv r\ (\bmod M)$$ 의 단일 해로 만든다.
3. 서로소가 아니면 합치는 과정에서 §2.2(일반 소거)를 이용해 **합치기 가능성(일관성)**을 점검한다(두 합동 간 충돌 여부).

> 이 체계가 가우스가 정립한 합동이론의 **작동 원리**다: 선형합동의 해법(기본정리) ↔ 법의 병합(CRT) ↔ 소거 정리로 안전한 “나눗셈”.

---

## 결론 요약(개념 지도)

- **가우스의 정리(소거)**: $$\gcd(c,m)=1$$ 이면 $$ac\equiv bc\ (\bmod m)\Rightarrow a\equiv b\ (\bmod m)$$. 일반형으론 $$a\equiv b\ (\bmod m/\gcd(c,m))$$. 합동에서의 “나눗셈”을 정당화한다.
- **합동의 기본정리(선형)**: $$ax\equiv b\ (\bmod m)$$ 은 $$d=\gcd(a,m)$$ 가 $$b$$ 를 나눌 때에만 해가 있으며, 해가 있으면 서로 다른 해가 **정확히 $$d$$ 개**이고, $$x\equiv x_0+\frac{m}{d}t\ (\bmod m),\ t=0,\dots,d-1$$ 의 꼴.
- **CRT(가우스 구성)**: 서로소 법에서는 선형 합동계가 **항상** 해를 가지며, 곱의 법에서 **유일**하다. 확장 유클리드로 해를 **구성적으로** 계산한다.
