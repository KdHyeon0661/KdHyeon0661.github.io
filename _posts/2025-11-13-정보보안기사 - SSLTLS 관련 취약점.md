---
layout: post
title: 정보보안기사 - SSL/TLS 관련 취약점
date: 2025-11-13 23:25:27 +0900
category: 정보보안기사
---
# SECTION 16 주요 취약점 — 02. SSL/TLS 관련 취약점

## 1) SSL/TLS 취약점 분류 체계(개요)

| 층위 | 대표 예시 | 핵심 원인 | 주된 대응 |
|---|---|---|---|
| **프로토콜 수준** | SSLv2/3(POODLE), TLS 1.0/1.1 CBC류(Lucky13/BEAST), 재협상 버그 | 구식 설계, 다운그레이드 취약 | **구버전 비활성화**, 다운그레이드 방지 |
| **알고리즘/암호군** | RC4 편향, 3DES(SWEET32) 64비트 블록 충돌, 약한 DH 그룹(Logjam) | 약한/퇴역 알고리즘, 작은 파라미터 | **AEAD(ECDHE+AES-GCM/ChaCha20-Poly1305)** 고정, 약한 스위트 퇴출 |
| **핸드셰이크/키교환** | RSA 키교환(무PFS), 불량 그룹 협상, 0-RTT 재생 | PFS 부재, 협상 하위 호환성 | **(EC)DHE 의무화**, 0-RTT 제한 |
| **구현 버그** | Heartbleed(OpenSSL), CCS Injection, ROBOT, ALPACA, Raccoon | 라이브러리 결함, 크로스-프로토콜 상호작용 | **업데이트/패치**, 보안 프록시/ALPN 정책 |
| **운영·구성** | 취약 스위트 허용, 인증서/체인/OCSP Stapling 오구성, 세션티켓 장기 사용 | 잘못된 설정, 키/티켓 로테이션 미흡 | **모던 서버 프로파일 적용**, 키/티켓 주기적 회전 |

> 현대 권고안은 **TLS 1.3 우선, 필요 시 하위 호환의 TLS 1.2(안전한 스위트만)** 을 권장한다. TLS 1.3은 **RSA 키교환·CBC·비AEAD**를 제거하고 **PFS 의무화** 등 구조적 취약 지점을 정리했다.

---

## 2) 최신 베이스라인(운영 기준)

### 2.1 버전 정책
- **권장**: TLS 1.3 **우선 사용**, 호환성 목적일 때만 TLS 1.2 허용.  
- **차단**: **SSLv2/SSLv3/TLS 1.0/TLS 1.1 비활성화**(예외 불허).  
- NIST SP 800-52r2: 2024-01-01부터 **정부 시스템은 TLS 1.3 지원**을 요구. 일반적으로 TLS 1.3과 1.2 병행을 권장.

### 2.2 암호군(서버 관점)
- **Only AEAD**: `TLS_AES_128_GCM_SHA256`, `TLS_AES_256_GCM_SHA384`, `TLS_CHACHA20_POLY1305_SHA256` (TLS 1.3).  
- TLS 1.2 유지 시 **ECDHE + AES-GCM/CHACHA20**만 허용. **RSA 키교환·CBC·RC4·3DES 금지**. Mozilla 최신 프로파일을 따른다.

### 2.3 핸드셰이크·키교환
- **PFS 의무화**: (EC)DHE. **RSA 키교환 금지**.  
- **0-RTT(early data)**: 재생 공격 우려 → **읽기 전용/멱등 API**에 한정 또는 전면 비활성화.

### 2.4 인증서·체인
- 신뢰 루트/중간 체인 정합, **CT(증명)·OCSP Stapling** 활성화, **키/서명 알고리즘**은 **ECDSA(P-256 이상) 또는 RSA-2048/3072 + SHA-256 이상**.

### 2.5 참고 표준/권고(핵심)
- **RFC 8446**(TLS 1.3) — TLS 1.2(5246) 폐지, AEAD 중심, PFS 의무.  
- **NIST SP 800-52r2** — TLS 1.3 지원 및 안전한 1.2 구성 가이드.  
- **Mozilla Server-Side TLS(2025-01 업데이트)** — Modern/Intermediate 프로파일.  
- **OWASP TLS Cheat Sheet** — 애플리케이션·서비스 구현 권고.  
- **IETF UTA draft(2024)** — 신규 프로토콜은 TLS 1.3 요구, RSA 키교환·CBC·취약 FFDHE 금기.

---

## 3) 대표 취약점(안전 요약 + 완화 가이드)

### 3.1 다운그레이드·구버전 취약
- **POODLE(SSLv3 CBC 패딩)**, **BEAST/CRIME/BREACH**(TLS 1.0 또는 압축/반복 패턴 악용), **재협상(Renegotiation) 버그** 등.  
- **대응**: SSLv2/3, TLS 1.0/1.1 완전 차단, **TLS 압축 금지**, HSTS/H2/ALPN 일관성, 서버 우선 암호군.

### 3.2 약한 암호군
- **RC4** 편향, **3DES(SWEET32)** 충돌 위험(64비트 블록) → 대용량 트래픽 시 충돌 확률 증가. 충돌 기대치는 대략 $$\approx 2^{n/2}$$ 블록이므로, **64비트 블록 암호는 약 $$2^{32}$$ 블록**(수십 GiB)에서 실질 우려가 발생한다.  
- **대응**: RC4/3DES/MD5/SHA-1 스위트 전면 금지, **AEAD + SHA-2/3**.

### 3.3 키교환/파라미터
- **RSA 키교환**: 세션키 노출 시 과거 트래픽 복호화 가능(**PFS 부재**).  
- **약한 DH 그룹(Logjam)**: 작은 FFDHE/재사용된 그룹.  
- **대응**: **ECDHE** 고정, **FFDHE(>= 2048)** 또는 권고 곡선(P-256/384) 사용.

### 3.4 구현 취약(라이브러리)
- **Heartbleed**, **CCS Injection**, **ROBOT(Bleichenbacher)**, **Lucky13**, **ALPACA(크로스-프로토콜)**, **Raccoon(DH 타이밍)** 등.  
- **대응**: **최신 라이브러리로 신속 업그레이드**, ALPN 제한, 동일 인증서/키를 여러 프로토콜에서 혼용하지 않기.

### 3.5 TLS 1.3 특이점
- **0-RTT(early data) 재생 위험**: 멱등/읽기 전용 엔드포인트에만 허용하거나 **비활성화**.  
- **세션티켓(PSK) 수명**: 공유키/티켓 장기 재사용은 위험 → **짧은 수명·키 롤링** 필수.

---

## 4) 점검 툴·무해한 진단 예시

### 4.1 `nmap` + `ssl-enum-ciphers`
```bash
# 허용 프로토콜/암호군 열거(안전)
nmap -p 443 --script ssl-enum-ciphers example.com
```

### 4.2 `testssl.sh`(권장)
```bash
# 범용 자동 점검(로컬/원격 모두)
./testssl.sh --openssl=openssl -U --sneaky https://example.com
# 프로토콜/스위트/ALPN/HSTS/OCSP 등 종합 리포트
```

### 4.3 `openssl s_client`
```bash
# (1) TLS 1.3 강제 수립
openssl s_client -connect example.com:443 -tls1_3 -brief

# (2) TLS 1.0 강제 시도(차단이 정상)
openssl s_client -connect example.com:443 -tls1
# -> 실패해야 정상

# (3) 취약 스위트 시도(예: RC4) - 협상 거부가 정상
openssl s_client -connect example.com:443 -cipher 'RC4' -tls1_2
```

### 4.4 브라우저/클라이언트 스캐닝
- **Qualys SSL Labs**와 같은 외부 진단도 유용하지만, 사내·개인정보 서비스는 **사전 승인** 하에 내부 스캐너 사용을 권장.

---

## 5) 안전한 서버 구성 예시(최신 프로파일 기반)

> 아래 예시는 **Mozilla Server-Side TLS**의 *Modern/Intermediate* 가이드를 참조해 개념화했다. 실제 운영 시 **ssl-config.mozilla.org** 생성기에서 **소프트웨어·버전별 스니펫**을 받아 적용하라.

### 5.1 Nginx(개념 스니펫)
```nginx
ssl_protocols             TLSv1.3 TLSv1.2;
ssl_prefer_server_ciphers on;

# TLS 1.3 암호군은 구현체 고정. TLS 1.2만 명시
ssl_ciphers "ECDHE-ECDSA-AES256-GCM-SHA384:
             ECDHE-ECDSA-AES128-GCM-SHA256:
             ECDHE-RSA-AES256-GCM-SHA384:
             ECDHE-RSA-AES128-GCM-SHA256:
             ECDHE-ECDSA-CHACHA20-POLY1305:
             ECDHE-RSA-CHACHA20-POLY1305";

ssl_ecdh_curve            X25519:P-256:P-384;
ssl_session_timeout       10m;
ssl_session_cache         shared:SSL:50m;

ssl_stapling              on;
ssl_stapling_verify       on;

# 0-RTT(early data) 비활성 또는 멱등 엔드포인트에 한정
ssl_early_data            off;
```

### 5.2 Apache httpd(개념 스니펫)
```apache
SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1
SSLCipherSuite          TLSv1.2 HIGH:!aNULL:!MD5:!RC4:!3DES:!RSA:!DES:!CBC
SSLHonorCipherOrder     on
SSLUseStapling          on
SSLStaplingResponderTimeout 5
```

### 5.3 HAProxy(개념 스니펫)
```haproxy
bind :443 ssl crt /etc/haproxy/certs/bundle.pem alpn h2,http/1.1 \
     ssl-min-ver TLSv1.2 ssl-max-ver TLSv1.3 \
     ciphers ECDHE+AESGCM:ECDHE+CHACHA20:!aNULL:!MD5:!RC4:!3DES:!RSA
no-tls-tickets  # TLS 1.2 세션티켓 미사용(또는 주기적 키 롤링)
```

---

## 6) 애플리케이션 관점(클라이언트/백엔드) 샘플

### 6.1 Java (JDK 11+/17+)
```java
// TLS 1.3 우선, 필요 시 1.2 포함
SSLContext ctx = SSLContext.getInstance("TLSv1.3");
ctx.init(null, null, null);
SSLSocketFactory f = ctx.getSocketFactory();

HttpsURLConnection c = (HttpsURLConnection) new URL("https://example.com").openConnection();
c.setSSLSocketFactory(f);
// 멱등 요청만 재시도/0-RTT 제한 등은 프레임워크 정책으로
```

### 6.2 Python (requests + modern OpenSSL)
```python
import requests
from urllib3.util.ssl_ import create_urllib3_context

ctx = create_urllib3_context()
# TLS 1.2/1.3는 OpenSSL 빌드에 따름. 약한 스위트 제거
ctx.set_ciphers("ECDHE+AESGCM:ECDHE+CHACHA20:!aNULL:!MD5:!RC4:!3DES:!RSA")

s = requests.Session()
s.mount("https://", requests.adapters.HTTPAdapter())
r = s.get("https://example.com", timeout=5)
print(r.status_code)
```

### 6.3 Node.js (TLS 정책)
```js
const https = require('https');

const agent = new https.Agent({
  maxVersion: 'TLSv1.3',
  minVersion: 'TLSv1.2',
  ciphers: 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:' +
           'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256',
  honorCipherOrder: true
});
https.get('https://example.com', { agent }, res => console.log(res.statusCode));
```

### 6.4 Go (`crypto/tls`)
```go
package main
import ("crypto/tls"; "net/http"; "fmt")

func main() {
  tr := &http.Transport{
    TLSClientConfig: &tls.Config{
      MinVersion: tls.VersionTLS12,
      MaxVersion: tls.VersionTLS13,
      CurvePreferences: []tls.CurveID{tls.X25519, tls.CurveP256, tls.CurveP384},
      CipherSuites: []uint16{
        tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
        tls.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
        tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,
        tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,
      },
    },
  }
  cli := &http.Client{Transport: tr}
  r, _ := cli.Get("https://example.com")
  fmt.Println(r.Status)
}
```

---

## 7) TLS 1.3의 보안상 이점(요지)
- **RSA 키교환 제거 & PFS 의무화**, **CBC 제거 & AEAD 강제**, **간소화된 스위트·협상**으로 오구성 리스크를 대폭 축소.  
- **전체 핸드셰이크 서명**을 통해 중간자 공격 여지를 낮춤.

---

## 8) 0-RTT(early data) 안전 가이드
- **재생 가능**: 요청 재전송만으로 상태 변화가 생기는 엔드포인트(POST/결제/구독 변경)에는 금지.  
- **정책**: 서버 전역 `early_data off` 또는 **멱등(GET/HEAD/OPTIONS)** 만 허용, **Nonce/Replay Cache**로 0-RTT 수락 범위를 관리.

Nginx 예시:
```nginx
ssl_early_data off; # 또는 멱등 API 프록시에서만 on + 서버측 재생 방지
```

---

## 9) 세션 티켓/PSK 운영
- **위험**: 장기 재사용·광범위 공유키는 대규모 복호화 위험을 키움.  
- **권고**: **짧은 유효기간**, **서비스 단위 키 롤링**, **환경/네트워크 분리**.  
- HAProxy: `no-tls-tickets`(비활성) 또는 키 주기적 교체 스크립트.

---

## 10) 인증서·체인·검증 체크
- **Must**: 올바른 체인, **OCSP Stapling** 활성, **SAN** 정확성, **ECDSA 또는 RSA-2048/3072** + **SHA-256 이상**.  
- **CT 모니터링**: 잘못 발급/위조 탐지(운영팀 알림 연동).  
- **HPKP(핀닝 헤더)**: 역사적 이유로 **사용 금지**(운영 리스크 큼) → **CA/B 정책 + CT 모니터링** 대체.

---

## 11) 운영 점검 플레이북(실무)

### 11.1 프로토콜/스위트 정책 검증
```bash
# 1) 프로토콜 강제 시도(거부 확인)
for v in -ssl3 -tls1 -tls1_1; do
  echo "Try $v"
  openssl s_client -connect example.com:443 $v </dev/null 2>&1 | grep -i 'Protocol\|handshake'
done

# 2) 취약 스위트 강제(거부 확인)
openssl s_client -connect example.com:443 -tls1_2 -cipher 'RC4,DES-CBC3-SHA' </dev/null
```

### 11.2 외부 노출 표면 스캔(무해)
```bash
nmap -Pn -p 443 --script ssl-enum-ciphers,ssl-cert,ssl-dh-params example.com
```

### 11.3 CI/CD 게이트(예)
```bash
# 컨테이너 빌드 후 testssl.sh로 실패 기준 설정
./testssl.sh --warnings=batch --quiet https://staging.example.com \
  | tee /tmp/tls.txt
grep -E 'TLSv1\.0|TLSv1\.1|RC4|3DES|weak' /tmp/tls.txt && exit 1 || true
```

---

## 12) 보고서/감사 포맷(샘플)

- **개요**: 서비스별 TLS 버전/암호군/ALPN/OCSP/HSTS 현황 요약(현행/목표 대비).  
- **리스크**: 다운그레이드 허용, 약한 스위트 노출, 0-RTT 남용, 세션티켓 장기 사용, 인증서/체인 오류.  
- **개선안**: Mozilla 최신 프로파일 적용, NIST 요건 부합, 0-RTT 제한, 키/티켓 롤링 정책 수립.  
- **검증**: `testssl.sh`/`nmap` 결과 스냅샷, 실패 기준·재검 일정.

---

## 13) 자주 묻는 질문(FAQ)

**Q. TLS 1.2를 완전히 꺼도 되나요?**  
A. 자사 고객 단말 호환성이 충분히 검증된 경우 **가능**. 다만 공공/대민 시스템은 **TLS 1.2 병행**이 일반적이다. 정책은 NIST/기관 가이드를 따르라.

**Q. RSA 인증서(서명)는 괜찮나요? RSA 키교환만 금지죠?**  
A. 맞다. **서명용 RSA**는 안전 파라미터로 여전히 널리 사용된다. **금지 대상은 “RSA 키교환”** 이다(=PFS 부재). TLS 1.3은 애초에 RSA 키교환을 지원하지 않는다.

**Q. 어떤 “레시피”를 그대로 쓰면 되나요?**  
A. **Mozilla Server-Side TLS**의 최신 Modern/Intermediate를 소프트웨어별 생성기로 받아 적용하라. 환경별 차이는 있으니 반드시 테스트/점진 배포.

---

## 14) 부록 — 수학 메모(충돌 근사치)
- **SWEET32 맥락**: 블록 크기 **n=64비트** 암호는 **생일 한계**에 의해  
  $$\text{충돌 기대 블록 수} \approx \sqrt{\pi/2}\,2^{n/2} \approx 1.25 \times 2^{32} \text{ blocks}$$  
  대용량 트래픽에서 같은 세션키로 3DES를 오래 사용하면 충돌·정보 노출 확률이 유의미해진다.

---

## 15) 최종 체크리스트(2025 기준)

- [ ] **TLS 1.3 우선, 필요 시 1.2 병행**(1.0/1.1/SSLv2/3 전면 차단).  
- [ ] **AEAD + (EC)DHE**만 허용( **RSA 키교환·CBC·RC4·3DES 금지** ).  
- [ ] **0-RTT 제한/비활성**, 멱등 엔드포인트만 허용.  
- [ ] **세션티켓·PSK 수명 단축/키 롤링**, 티켓 광역 공유 금지.  
- [ ] **OCSP Stapling + 체인 검증 + CT 모니터링**.  
- [ ] **HSTS** 설정 및 리다이렉션 정책 일관성.  
- [ ] **정기 스캔**: `testssl.sh`/`nmap`/외부 평가(사전 승인).  
- [ ] **CI/CD 게이트**로 취약 스위트/구버전 자동 차단.  
- [ ] **운영 표준화**: Mozilla 프로파일 기반 템플릿화, 분기별 재검토.

---

## 16) 참고·근거(핵심)
- RFC 8446, **TLS 1.3** (TLS 1.2(5246) 폐지, AEAD/PFS 중심 설계).  
- **NIST SP 800-52r2**: TLS 1.3 지원 요구, 안전한 1.2 구성 가이드.  
- **Mozilla Server-Side TLS(2025-01)** & **SSL Config Generator**.  
- **OWASP TLS Cheat Sheet**(구 Transport Layer Protection CS는 폐기).  
- **IETF UTA draft(2024)**: 신규 프로토콜은 TLS 1.3 의무, 취약 프리미티브 배제.