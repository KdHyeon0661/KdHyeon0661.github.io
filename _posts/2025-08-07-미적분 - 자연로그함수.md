---
layout: post
title: 미적분 - 자연로그함수
date: 2025-08-07 23:20:23 +0900
category: 미적분
---
# 자연로그함수 (Natural Logarithmic Function)

> 핵심 한 줄: **자연로그**는 지수함수 \(e^x\)의 역함수이며, \(\ln(xy)=\ln x+\ln y\), \(\dfrac{d}{dx}\ln x=\dfrac1x\) ( \(x>0\) ), \(\displaystyle \int \frac{1}{x}\,dx=\ln|x|+C\).

---

## 1. 정의와 기본 관계

- 정의(역함수 관점):  
  \[
  \ln x = y \ \Longleftrightarrow\ e^y=x,\quad x>0.
  \]
- 로그 밑: \(e\approx 2.71828\) (자연상수).
- 정의역/치역:
  - 정의역: \(x>0\)
  - 치역: \((-\infty,\infty)\)
- 단조성: \(x>0\)에서 **엄격히 증가**.

---

## 2. 그래프와 기하적 성질

- 기준점: \(\ln 1=0,\ \ln e=1\).
- 수직 점근선: \(x=0^+\)에서 \(\ln x\to -\infty\).
- 무한대로의 성장: \(x\to\infty\Rightarrow \ln x\to\infty\) (느리지만 무한히 증가).
- 지수함수 \(y=e^x\)와 **\(y=x\)**에 대한 대칭(역함수 관계).

---

## 3. 미분, 연쇄법칙, 고계 도함수

### 3.1 기본 미분
\[
\frac{d}{dx}\ln x=\frac{1}{x}\quad(x>0).
\]

### 3.2 합성함수(연쇄법칙)
\[
\frac{d}{dx}\ln f(x)=\frac{f'(x)}{f(x)}\quad(\text{단 } f(x)>0).
\]

**예:**  
\[
\frac{d}{dx}\,\ln(3x^2+1)=\frac{6x}{3x^2+1}.
\]

### 3.3 고계 도함수
\[
\frac{d^2}{dx^2}\ln x=-\frac{1}{x^2}<0\quad\Rightarrow\quad \ln x\ \text{는 }(0,\infty)\text{에서 볼록(오목) 내려감(Concave)}.
\]

---

## 4. 적분: 표준형과 기법

### 4.1 표준 적분
\[
\int \frac{1}{x}\,dx = \ln|x| + C.
\]

### 4.2 \(\displaystyle \int \ln x\,dx\) (부분적분)
\[
\int \ln x\,dx = x\ln x - x + C,\quad (x>0).
\]

일반화: \(\displaystyle \int \ln(ax+b)\,dx=\frac{(ax+b)}{a}\ln(ax+b)-\frac{(ax+b)}{a}+C\).

### 4.3 유용한 변형
- \(\displaystyle \int \frac{f'(x)}{f(x)}\,dx=\ln|f(x)|+C\).
- \(\displaystyle \int \frac{2x}{x^2+1}\,dx=\ln(x^2+1)+C\) (치환 \(u=x^2+1\)).

---

## 5. 로그의 대수적 성질(증명 스케치 포함)

\[
\ln(ab)=\ln a+\ln b,\quad
\ln\!\left(\frac{a}{b}\right)=\ln a-\ln b,\quad
\ln(a^r)=r\ln a\quad(a,b>0,\ r\in\mathbb{R}).
\]

**증명 아이디어(지수 역함수 사용):**  
\(\ln(ab)=y \iff e^y=ab=e^{\ln a}\,e^{\ln b}=e^{\ln a+\ln b}\iff y=\ln a+\ln b\).

**밑 변환:** \(\displaystyle \log_a x=\frac{\ln x}{\ln a}\) ( \(a>0,\ a\ne 1\) ).

**미분:** \(\displaystyle \frac{d}{dx}\log_a x=\frac{1}{x\ln a}\).

---

## 6. 극한으로 보는 \(\ln\) — 정의와 성질

### 6.1 적분 정의
\[
\ln x=\int_{1}^{x}\frac{1}{t}\,dt,\quad x>0.
\]
→ 연속성·미분가능성 자연 도출: \(\dfrac{d}{dx}\ln x=\dfrac{1}{x}\).

### 6.2 극한 정의(등가)
\[
\ln x=\lim_{n\to\infty} n\,(x^{1/n}-1).
\]

### 6.3 대표 극한
\[
\lim_{x\to 0}\frac{\ln(1+x)}{x}=1,\qquad
\lim_{x\to 0^+}x\ln x=0.
\]

**활용:** \(0\cdot\infty\)형, \(\dfrac{0}{0}\)형 처리에 로피탈/로그 변환 사용.

---

## 7. 테일러 전개와 수렴 구간

### 7.1 \(\ln(1+x)\)의 거듭제곱급수
\[
\ln(1+x)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{x^n}{n},\quad |x|<1,\ x\ne -1.
\]
- \(x=-1\)에서 발산, \(x=1\)에서 교대조화급수(\(\ln 2\))로 조건부 수렴.

### 7.2 \(\ln x\)의 \(x=1\) 주변 전개
\[
\ln x=\ln\!\big(1+(x-1)\big)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{(x-1)^n}{n},\quad 0<x<2.
\]

---

## 8. 불평등과 볼록성(오목성) 활용

### 8.1 기본 접선 불등식
\[
\ln x \le x-1\quad(x>0),\qquad \text{(평등은 }x=1\text{)}.
\]
- 증명 1: \(\ln x\)는 오목 → 임의 점에서 접선이 그래프 위.  
- 증명 2: \(f(x)=x-1-\ln x\)는 \(f'(x)=1-\frac1x,\ f''(x)=\frac1{x^2}>0\), \(f(1)=0\Rightarrow f(x)\ge 0\).

### 8.2 AM–GM (평균–기하평균)  
\[
\ln\left(\frac{x_1+\cdots+x_n}{n}\right) \ge \frac{1}{n}\sum_{i=1}^{n}\ln x_i
\Rightarrow \frac{x_1+\cdots+x_n}{n}\ge (x_1\cdots x_n)^{1/n}.
\]

### 8.3 Log-Sum-Exp (LSE) 트릭
\[
\ln\sum_i e^{z_i} = m + \ln\sum_i e^{z_i-m},\quad m=\max_i z_i.
\]
(수치 안정성 필수 — §11 참조)

---

## 9. 응용 분야 하이라이트

- **성장/감쇠**: \(y'=ky \Rightarrow y=Ce^{kx}\Rightarrow \ln y = \ln C + kx\).
- **반감기**: \(N(t)=N_0 e^{-\lambda t}\Rightarrow t_{1/2}=\dfrac{\ln 2}{\lambda}\).
- **금융(연속복리)**: \(A=Pe^{rt}\Rightarrow r=\dfrac{\ln(A/P)}{t}\).
- **정보이론(엔트로피)**: \(H=-\sum p_i\ln p_i\).
- **통계(최우도)**: 로그우도 \(\ell(\theta)=\ln L(\theta)\)는 합으로 변환되어 최적화 용이.
- **머신러닝**: 로지스틱/소프트맥스 손실, KL 발산, LSE 안정화, log1p/expm1 사용.

---

## 10. 예제 모음(풀이 포함)

### 예제 1 (미분)
\[
\frac{d}{dx}\,\ln(3x^2+1)=\frac{6x}{3x^2+1}.
\]

### 예제 2 (치환 적분)
\[
\int \frac{2x}{x^2+1}\,dx=\ln(x^2+1)+C.
\]

### 예제 3 (부분적분)
\[
\int \ln x\,dx = x\ln x - x + C.
\]

### 예제 4 (극한)
\[
\lim_{x\to 0^+} x\ln x=0.
\]
(치환 \(x=e^{-u}\Rightarrow x\ln x=-ue^{-u}\to 0\).)

### 예제 5 (방정식 해 존재성)
\[
\ln x = 2-x\quad(x>0).
\]
좌변은 증가, 우변은 감소 → 교점 유일. 수치해(예: 뉴턴법)로 \(x\approx 1.146\).

### 예제 6 (테일러 근사)
\[
\ln(1+x)\approx x-\frac{x^2}{2}+\frac{x^3}{3}\quad(|x|<1).
\]
\(x=0.1\Rightarrow \ln 1.1\approx 0.09531\) (오차 \(\approx 10^{-4}\) 수준).

### 예제 7 (부등식 확인)
\[
\ln x \le x-1.
\]
\(x=1.5:\ \ln 1.5\approx 0.4055 \le 0.5\) 성립.

---

## 11. 실전 코딩 팁(수치안정)

- **작은 \(x\)**: `log1p(x)`는 \(\ln(1+x)\)를 안정 계산.  
  (예: \(x=10^{-12}\)에서 \(\ln(1+x)\approx x\)인데 `log(1+x)`는 소수부 소실 위험)
- **작은 \(y\)**: `expm1(y)`는 \(e^{y}-1\)을 안정 계산.
- **Softmax/LSE**: `logsumexp` 사용 또는 수동으로 \(m=\max z\) 빼기.

```python
import numpy as np

def logsumexp(z):
    m = np.max(z)
    return m + np.log(np.sum(np.exp(z - m)))

def stable_softmax(z):
    m = np.max(z)
    e = np.exp(z - m)
    return e / np.sum(e)

# log1p / expm1 예시
x = 1e-12
print(np.log1p(x), np.log(1.0 + x))   # 두 번째는 정밀도 손실 가능
y = 1e-8
print(np.expm1(y), np.exp(y) - 1.0)
```

---

## 12. 시각화/검증 코드 (Python)

> 단일 플롯 원칙으로 각각 그려서 확인.

```python
import numpy as np
import matplotlib.pyplot as plt

# 1) ln(x)와 1/x
xs = np.linspace(0.05, 4, 400)
lnx = np.log(xs)
inv = 1/xs

plt.plot(xs, lnx, label='ln x')
plt.axvline(1, linestyle='--')
plt.axhline(0, linestyle=':')
plt.legend(); plt.grid(True); plt.title('ln x')
plt.show()
```

```python
# 2) ln(1+x)와 테일러 근사 x - x^2/2 + x^3/3
x = np.linspace(-0.9, 0.9, 400)
f = np.log1p(x)
approx = x - x**2/2 + x**3/3

plt.plot(x, f, label='ln(1+x)')
plt.plot(x, approx, linestyle='--', label='Taylor 3rd')
plt.legend(); plt.grid(True); plt.title('ln(1+x) vs Taylor')
plt.show()
```

---

## 13. 연습 문제 (해설 스케치)

1) 미분: \(\displaystyle \frac{d}{dx}\ln\!\big(\sqrt{x^2+4}\,\big)\).  
→ \(\displaystyle \frac{1}{\sqrt{x^2+4}}\cdot\frac{x}{\sqrt{x^2+4}}=\frac{x}{x^2+4}\).

2) 적분: \(\displaystyle \int \frac{3x+1}{x^2+x+1}\,dx\).  
→ 분자=분모’ 조합: \(\ln(x^2+x+1)+C\).

3) 극한: \(\displaystyle \lim_{x\to 0}\frac{\ln(1+2x)}{x}\).  
→ 로피탈 또는 1차 근사로 \(2\).

4) 부등식: \(\ln(1+x)\le x\) (\(x>-1\)).  
→ 오목성/접선 불등식. 평등은 \(x=0\).

5) 방정식: \(e^{x}=ax\) 해의 개수( \(a>0\) ).  
→ \(f(x)=e^x-ax\)의 미분 \(f'(x)=e^x-a\).  
최소값 \(x=\ln a\)에서 \(f(\ln a)=a-a\ln a\).  
- \(a<e\): 두 해, \(a=e\): 한 해, \(a>e\): 한 해.

---

## 14. 요약 표

| 항목 | 공식/사실 |
|---|---|
| 정의 | \(\ln x = y \iff e^y=x\) |
| 미분 | \(\dfrac{d}{dx}\ln x=\dfrac1x\) |
| 적분 | \(\displaystyle \int \frac{1}{x}\,dx=\ln|x|+C\), \(\ \int\ln x\,dx=x\ln x-x+C\) |
| 성질 | \(\ln(ab)=\ln a+\ln b\), \(\ln(a^r)=r\ln a\) |
| 극한 | \(\ln(1+x)\sim x,\ x\to 0\); \(\ x\ln x\to 0^+\) |
| 불등식 | \(\ln x\le x-1\) (오목성) |
| 수치 팁 | `log1p`, `expm1`, `logsumexp` |

---

## 15. 추가 예제 코드(심볼릭 확인)

```python
import sympy as sp
x = sp.symbols('x', positive=True)
expr = sp.log(3*x**2 + 1)
print(sp.simplify(sp.diff(expr, x)))         # 6x/(3x^2+1)

print(sp.integrate(sp.log(x), x))            # x*log(x) - x
print(sp.limit(sp.log(1+x)/x, x, 0))         # 1
print(sp.limit(x*sp.log(x), x, 0, dir='+'))  # 0
```

---

### 마무리
- 자연로그는 **지수–로그 변환의 관문**이며, 미분/적분, 극한/급수, 불등식, 수치계산, 데이터과학·정보이론·금융·물리에서 **필수 도구**다.  
- 실전에서는 **오목성(접선 불등식)**, **log1p/expm1**, **log-sum-exp**를 습관화하면 정확성과 안정성을 모두 잡을 수 있다.