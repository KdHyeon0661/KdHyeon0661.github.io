---
layout: post
title: 디지털신호처리 - 연습문제 1
date: 2025-11-08 17:25:23 +0900
category: 디지털신호처리
---
# 연습문제 세트 1

## 파트 A. 이산 시간 신호 — 기초/개념 (1–8)

### 문제 1. 단위 임펄스/계단으로 신호 전개

**학습 목표**: 임펄스 전개와 구간 지표 표현을 익힌다.

**문제**: 다음 신호를 임펄스의 선형결합으로, 그리고 계단함수로 표현하라.
$$
x[n] =
\begin{cases}
2, & n=0\\
-1, & n=1\\
3, & n=3\\
0, & \text{그 외}
\end{cases}
$$

**풀이 개요**: 임펄스 전개 $$x[n]=\sum_k x[k]\delta[n-k]$$, 계단 기반 펄스는 $$\delta[n-k]=u[n-k]-u[n-k-1]$$.

**상세 해설**:
- 임펄스 전개:
  $$
  x[n]=2\delta[n]-\delta[n-1]+3\delta[n-3].
  $$
- 계단으로:
  $$
  x[n]=2(u[n]-u[n-1])-(u[n-1]-u[n-2])+3(u[n-3]-u[n-4]).
  $$

**Octave**:
```
N=6; n=0:N;
x_imp = 2*(n==0) - 1*(n==1) + 3*(n==3);
x_step = 2*((n>=0)-(n>=1)) - ((n>=1)-(n>=2)) + 3*((n>=3)-(n>=4));
assert(norm(x_imp - x_step)==0);
stem(n, x_imp, 'filled'); grid on; title('x[n] via impulses/steps');
```

---

### 문제 2. 에너지/전력 판정

**학습 목표**: 에너지/전력 신호의 구분과 계산.

**문제**: $$x[n]=a^n u[n],\ |a|<1$$의 에너지 $$E_x$$와 $$x[n]=\cos(\omega_0 n)$$의 평균 전력 $$P_x$$를 구하라.

**풀이 개요**: 에너지는 제곱합의 수렴, 전력은 장기 평균.

**상세 해설**:
- $$x[n]=a^n u[n]$$:
  $$
  E_x=\sum_{n=0}^{\infty}|a|^{2n}=\frac{1}{1-|a|^2}.
  $$
- $$\cos(\omega_0 n)$$:
  $$
  P_x=\lim_{N\to\infty}\frac{1}{2N+1}\sum_{n=-N}^{N}\cos^2(\omega_0 n)=\tfrac12.
  $$

**Octave**:
```
a=0.9; N=2000; n=0:N; x=(a.^n); E=sum(abs(x).^2);
printf("E approx = %.6f (theory %.6f)\n", E, 1/(1-a^2));

w0=pi/4; n=-N:N; xc=cos(w0*n); P=mean(abs(xc).^2);
printf("P approx cos = %.6f (theory 0.5)\n", P);
```

---

### 문제 3. 시프트/반전/스케일 조합의 효과

**학습 목표**: 시간축 변환과 위상.

**문제**: $$x[n]=\sin\!\big(\tfrac{\pi}{6}n\big)$$에 대해 $$y[n]=2x[-n+3]$$의 주기/위상/진폭을 설명하고 그래프를 그려라.

**풀이 개요**: 반전은 부호 변화, 시프트는 위상 이동, 스케일은 진폭 변화.

**상세 해설**:
- 주기 $$N_0=2\pi/(\pi/6)=12$$.
- $$x[-n]=-\sin(\tfrac{\pi}{6}n)$$,
  $$x[-n+3]=\sin\!\big(-\tfrac{\pi}{6}n+\tfrac{\pi}{2}\big)$$,
  $$y[n]=2\sin\!\big(-\tfrac{\pi}{6}n+\tfrac{\pi}{2}\big)$$.

**Octave**:
```
n=0:47;
x = sin(pi/6*n);
y = 2*sin(-pi/6*n + pi/2);
plot(n,x,'-o'); hold on; plot(n,y,'-x'); grid on
legend('x[n]=sin(\pi/6 n)','y[n]=2x[-n+3]');
```

---

### 문제 4. Parseval 검증

**학습 목표**: 시간–주파수 에너지 동일성 수치 확인.

**문제**: 길이 $$N$$ 시퀀스에 대해
$$
\sum_{n=0}^{N-1}|x[n]|^2=\frac{1}{N}\sum_{k=0}^{N-1}|X[k]|^2
$$
를 검증하라.

**Octave**:
```
N=1024; x=randn(1,N); X=fft(x);
lhs=sum(abs(x).^2); rhs=(1/N)*sum(abs(X).^2);
printf("Parseval error = %.3e\n", abs(lhs-rhs));
```

---

### 문제 5. 주기 신호의 전력 스펙트럼

**학습 목표**: DFT 라인/주파수 해상도.

**문제**: $$x[n]=\cos(2\pi f_0 n/F_s)$$, $$f_0=1000$$Hz, $$F_s=8000$$Hz, $$N=4096$$에서 피크 bin을 찾고 제로패딩의 효과를 논하라.

**핵심 해설**: 주파수 간격 $$\Delta f=F_s/N$$. 제로패딩은 **보간**일 뿐 실제 해상도 개선은 아니다.

**Octave**:
```
Fs=8000; N=4096; f0=1000; n=0:N-1;
x=cos(2*pi*f0/Fs*n); X=fft(x); f=(0:N-1)*Fs/N;
[~,k]=max(abs(X(1:N/2))); printf("peak bin f≈%.2f Hz\n", f(k));
```

---

### 문제 6. 복소지수의 고유함수 성질

**학습 목표**: LTI 입력-출력 고유성.

**문제**: 임의 FIR에 $$x[n]=e^{j\omega_0 n}$$을 넣으면 $$y[n]=H(e^{j\omega_0})e^{j\omega_0 n}$$임을 수치 확인하라.

**Octave**:
```
pkg load signal
N=61; b=fir1(N-1,0.3,hamming(N)); a=1;
w0=pi/5; n=0:1023; x=exp(1j*w0*n); y=filter(b,a,x);
H=freqz(b,a,w0); ratio=y./x;
printf("ratio mean ≈ %g%+gj\n", mean(real(ratio)), mean(imag(ratio)));
```

---

### 문제 7. DTFT의 $$2\pi$$-주기성

**학습 목표**: 주기성 시각화.

**문제**: 유한 길이 $$x[n]$$의 DTFT가 $$2\pi$$-주기임을 FFT 샘플로 확인하라.

**Octave**:
```
x=[1 2 3]; Nfft=1024; w=(0:Nfft-1)/Nfft*2*pi; X=fft(x,Nfft);
plot(w,abs(X)); hold on; plot(w,abs(X),'r--'); grid on
```

---

### 문제 8. 다운샘플링과 에일리어싱

**학습 목표**: 스펙트럼 folding.

**문제**: $$F_s=8\text{kHz},\ x[n]=\sin(2\pi\cdot2\text{kHz}\cdot n/F_s)$$를 $$M=2$$로 다운샘플하고 스펙트럼을 비교하라.

**Octave**:
```
Fs=8000; n=0:8191; x=sin(2*pi*2000/Fs*n);
xd=x(1:2:end); Fsd=Fs/2;
N=4096; X=fft(x(1:N)); F=(0:N-1)*Fs/N;
Xd=fft(xd(1:N/2)); Fd=(0:N/2-1)*Fsd/(N/2);
subplot(2,1,1); plot(F(1:N/2),abs(X(1:N/2))); xlim([0,Fs/2]); grid on
subplot(2,1,2); plot(Fd(1:end/2),abs(Xd(1:end/2))); xlim([0,Fsd/2]); grid on
```

---

## 파트 B. 이산 시스템/차분 방정식 — 분석 (9–18)

### 문제 9. 선형/시불변성 판정

**학습 목표**: 시스템 성질.

**문제**: (1) $$y[n]=x[n]^2$$ (2) $$y[n]=x[n]-x[n-1]$$의 선형/시불변/인과/BIBO 여부를 판정하라.

**풀이 개요/해설**:
- (1) 비선형(제곱), 시불변, 인과, BIBO(유계입력→유계출력).
- (2) 선형, 시불변, 인과, BIBO 안정.

**Octave**:
```
x=randn(1,128); n0=5;
sys=@(x) [x(1), x(2:end)-x(1:end-1)];
lhs=sys([zeros(1,n0),x(1:end-n0)]);
rhs=[zeros(1,n0), sys(x)(1:end-n0)];
printf("TI error (diff) = %.2e\n", norm(lhs-rhs));
```

---

### 문제 10. FIR과 IIR 구분

**학습 목표**: 구조와 임펄스응답.

**문제/해설**:
- $$y[n]=\sum_{k=0}^{10} b_k x[n-k]$$: 길이 11의 FIR, $$h[n]=0$$ for $$n>10$$.
- $$y[n]=\sum_{k=0}^{2} b_k x[n-k]+\sum_{m=1}^{2} a_m y[n-m]$$: 재귀 IIR, 일반적으로 무한 길이 $$h[n]$$.

---

### 문제 11. 스텝응답–임펄스응답 관계

**학습 목표**: 누적합/차분.

**문제**: $$s[n]=\sum_{k=-\infty}^{n}h[k]$$임을 보이고 수치 검증하라.

**Octave**:
```
h=[1 1 1]/3; N=16; u=ones(1,N); imp=[1 zeros(1,N-1)];
s=filter(h,1,u); h_from_s=[s(1), diff(s)];
printf("||h - diff(s)||=%.2e\n", norm(h - h_from_s(1:numel(h))));
```

---

### 문제 12. BIBO 안정성의 등가 조건

**학습 목표**: 컨볼루션 불등식–극조건.

**문제/해설**:
$$
\sum_n|h[n]|<\infty \ \Leftrightarrow\ \text{BIBO 안정}.
$$
IIR은 모든 폴이 단위원 내일 때 위 조건 성립.

---

### 문제 13. 차분 방정식의 일반해

**학습 목표**: 자유/강제 응답.

**문제**: $$y[n]-0.6y[n-1]=x[n],\ y[-1]=y_0$$. (1) 자유, (2) $$x[n]=\delta[n]$$ 강제, (3) 전체해.

**해설**:
- 자유: $$y_f[n]=C(0.6)^n$$, $$C=y_0$$.
- 강제: $$h[n]=(0.6)^n u[n]$$.
- 전체: $$y[n]=y_0(0.6)^n + (0.6)^n u[n]$$ (임펄스 입력 시).

**Octave**:
```
a=[1 -0.6]; b=1; N=40;
imp=[1 zeros(1,N-1)]; h=filter(b,a,imp);
y0=2; zi=filtic(b,a,y0,0); y_free=filter(b,a,zeros(1,N),zi);
plot([h(:), y_free(:), (h(:)+y_free(:))]); grid on; legend('h','free','sum');
```

---

### 문제 14. 특성방정식 중복근

**학습 목표**: 다항 해형태.

**문제/해설**: $$y[n]-2y[n-1]+y[n-2]=0 \Rightarrow (r-1)^2=0$$,
$$y[n]=C_1 + C_2 n$$.

---

### 문제 15. 정현파 정상응답

**학습 목표**: $$H(e^{j\omega})$$ 활용.

**문제**: $$y[n]-0.5y[n-1]=x[n]$$, $$x[n]=\cos(\omega_0 n)$$.
정상상태: $$|H|\cos(\omega_0 n+\angle H)$$,
$$H(e^{j\omega})=\frac{1}{1-0.5e^{-j\omega}}$$.

**Octave**:
```
[b,a]=deal(1,[1 -0.5]); w0=pi/4; n=0:512;
x=cos(w0*n); y=filter(b,a,x); H=freqz(b,a,w0);
plot(n,[x(:),y(:)]); grid on; legend('x','y');
```

---

### 문제 16. 합 절대수렴 점검

**학습 목표**: 불안정 사례.

**문제**: $$y[n]=1.01y[n-1]+x[n]$$의 $$h[n]$$과 $$\sum|h[n]|$$.

**Octave**:
```
a=[1 -1.01]; b=1; N=2000;
h=filter(b,a,[1 zeros(1,N-1)]);
S=sum(abs(h)); printf("sum|h|≈%.2e\n", S);
```

---

### 문제 17. Z-변환과 ROC

**학습 목표**: ROC–인과/안정.

**문제/해설**: $$x[n]=a^n u[n]$$,
$$X(z)=\frac{1}{1-az^{-1}},\ \text{ROC } |z|>|a|.$$
인과 우측신호는 바깥쪽 ROC, 안정은 단위원 포함 ⇒ $$|a|<1$$.

---

### 문제 18. 극/영점과 주파수응답

**학습 목표**: 단위원 근접 영향.

**문제**: 단위원 근처의 영/극 배치로 크기 응답 변화를 시각화하라.

**Octave**:
```
pkg load signal
b=poly([exp(1j*pi/3), exp(-1j*pi/3)]);
a=poly([0.9*exp(1j*pi/3), 0.9*exp(-1j*pi/3)]);
[H,w]=freqz(b,a,2048);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; xlabel('\omega/\pi'); ylabel('dB');
```

---

## 파트 C. 컨볼루션 — 이론/계산/알고리즘 (19–28)

### 문제 19. 선형 컨볼루션 길이

**학습 목표**: 길이/에일리어싱.

**문제/해설**: $$N_y=7+5-1=11$$. DFT $$N=8$$로 곱하면 원형 컨볼루션 ⇒ 접힘 왜곡.

---

### 문제 20. 컨볼루션 정리 증명 스케치

**학습 목표**: 시간–주파수 등가.

**문제/해설**:
$$
Y(e^{j\omega})=\sum_n \left(\sum_k x[k]h[n-k]\right)e^{-j\omega n}
=\sum_k x[k]e^{-j\omega k}\sum_m h[m]e^{-j\omega m}
=X(e^{j\omega})H(e^{j\omega}).
$$

---

### 문제 21. 이동평균 FIR의 DTFT

**학습 목표**: 폐형식/영점.

**문제/해설**:
$$
h[n]=\tfrac{1}{M}\mathbf{1}_{\{0\le n<M\}},\quad
H(e^{j\omega})=\frac{1}{M}\frac{\sin(\omega M/2)}{\sin(\omega/2)}e^{-j\omega (M-1)/2},
$$
영점 $$\omega=2\pi k/M,\ k=1,\dots,M-1$$.

**Octave**:
```
M=9; h=ones(1,M)/M; [H,w]=freqz(h,1,4096);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on
```

---

### 문제 22. 선형/원형 컨볼루션 수치 비교

**학습 목표**: 제로패딩 기준.

**문제/Octave**:
```
x=randn(1,50); h=hamming(11)'; y_lin=conv(x,h);
for N=[32,64]
  y_circ = ifft(fft(x,N).*fft(h,N));
  K=min(numel(y_lin),N);
  printf("N=%d error(first %d) = %.2e\n", N, K, norm(y_lin(1:K)-y_circ(1:K)));
end
```

---

### 문제 23. Overlap-Add 구현/검증

**학습 목표**: 블록 FFT.

**문제**: OLA 직접 구현하고 `conv`와 비교, 블록 길이별 시간/오차 비교.

**Octave**: (함수 정의 후 테스트)
```
function y = ola_conv(x, h, L)
  Nx=numel(x); Nh=numel(h); Nfft=2^nextpow2(L+Nh-1); H=fft(h,Nfft);
  y=zeros(1,Nx+Nh-1); i=1;
  while i<=Nx
    iEnd=min(i+L-1,Nx); xb=x(i:iEnd);
    yb=ifft(fft(xb,Nfft).*H);
    y(i:i+numel(yb)-1)+=yb; i+=L;
  endwhile
endfunction

x=randn(1,8000); h=fir1(127,0.2,hamming(128));
y1=conv(x,h); y2=ola_conv(x,h,512);
printf("OLA error = %.2e\n", norm(y1-y2));
```

---

### 문제 24. Overlap-Save 구현/검증

**학습 목표**: 스트리밍 처리.

**문제/Octave**:
```
function y = ols_conv(x,h,L)
  Nh=numel(h); Nfft=2^nextpow2(L+Nh-1); H=fft(h,Nfft);
  xpad=[zeros(1,Nh-1),x,zeros(1,Nh-1)]; y=[]; idx=1;
  while idx+Nfft-1 <= numel(xpad)
    xb=xpad(idx:idx+Nfft-1); yb=ifft(fft(xb).*H);
    y=[y, yb(Nh:end)]; idx+=L;
  endwhile
  y=y(1:numel(x)+Nh-1);
endfunction

x=randn(1,10000); h=fir1(127,0.2); y1=conv(x,h);
y2=ols_conv(x,h,512); printf("OLS error=%.2e\n", norm(y1-y2));
```

---

### 문제 25. 경계효과와 패딩

**학습 목표**: 시작/끝 왜곡.

**문제/Octave**:
```
x=[zeros(1,50), ones(1,500), zeros(1,50)];
h=hamming(21)'; h=h/sum(h);
y1=conv(x,h,'same'); y2=filter(h,1,x); y3=filtfilt(h,1,x);
plot([y1(:),y2(:),y3(:)]); grid on; legend('conv same','filter','filtfilt');
```

---

### 문제 26. Group Delay 측정

**학습 목표**: 선형위상 FIR 지연.

**문제/Octave**:
```
N=101; b=fir1(N-1,0.2,hamming(N)); a=1;
[H,w]=freqz(b,a,2048); phi=unwrap(angle(H));
dw=gradient(w); dphi=gradient(phi); tau=-dphi./dw;
printf("mean group delay ~ %.2f (theory %.2f)\n", mean(tau), (N-1)/2);
```

---

### 문제 27. 스펙트럼 누설과 윈도우 비교

**학습 목표**: 메인로브/사이드로브.

**문제/Octave**:
```
pkg load signal
Fs=1000; N=1024; n=(0:N-1)'; f0=100.5; x=sin(2*pi*f0/Fs*n);
W={rectwin(N),hanning(N),hamming(N),blackman(N)}; L={'Rect','Hann','Hamm','Blackman'};
for i=1:numel(W)
  X=fft(x.*W{i}); subplot(numel(W),1,i);
  plot((0:N-1)*Fs/N,20*log10(abs(X)+1e-12)); xlim([0,300]); title(L{i}); grid on
end
```

---

### 문제 28. 실시간 프레임 처리 지연 추정

**학습 목표**: 프레임/오버랩 지연.

**문제/해설**: OLA/OLS에서 대략 지연은 프레임 길이 $$L$$의 절반~한 프레임 수준(구현/버퍼링에 의존).
임펄스 입력의 출력 최대 위치로 지연을 추정한다.

**Octave 힌트**:
```
Fs=16000; L=1024; h=fir1(127,0.2); x=[1, zeros(1,8*L-1)];
y=ols_conv(x,h,L); [~,idx]=max(y); latency_s=idx/Fs; printf("lat ≈ %.4fs\n", latency_s);
```

---

## 파트 D. 차분 방정식 — 설계/해석/검증 (29–40)

### 문제 29. 1차 IIR의 임펄스/주파수응답

**학습 목표**: 기본 IIR.

**문제/해설**: $$y[n]=ay[n-1]+x[n],\ |a|<1$$,
$$h[n]=a^n u[n],\quad H(e^{j\omega})=\frac{1}{1-ae^{-j\omega}}.$$

---

### 문제 30. 차분식↔전달함수↔극/영점

**학습 목표**: 표상 간 변환.

**문제**: $$y[n]-1.6y[n-1]+0.64 y[n-2]=x[n]+0.5x[n-1]$$의 $$H(z)$$, 극/영점.

**Octave**:
```
b=[1 0.5]; a=[1 -1.6 0.64]; z=roots(b), p=roots(a)
```

---

### 문제 31. 정상상태 사인 응답 공식

**학습 목표**: $$H(e^{j\omega_0})$$ 직접 사용.

**문제/Octave**:
```
pkg load signal
[b,a]=butter(3,0.3); w0=pi/3; H=freqz(b,a,w0);
printf("|H|=%.3f, ∠H=%.3f rad\n", abs(H), angle(H));
```

---

### 문제 32. 자유응답 붕괴 시간

**학습 목표**: 극 반경–감쇠.

**문제**: 최대 극 반경 $$\rho=0.95$$, $$-60\ \text{dB}$$ 도달 샘플 수:
$$
20\log_{10}\rho^N=-60\ \Rightarrow\ N=\frac{60}{-20\log_{10}\rho}
=\frac{3}{-\log_{10}0.95}\approx \frac{3}{0.022276}\approx 134.6.
$$
즉 약 135샘플.

---

### 문제 33. 초기조건에 의한 과도응답

**학습 목표**: free vs forced 분리.

**문제/Octave**:
```
a=[1 -0.8]; b=1; N=80; x=zeros(1,N);
y_free=filter(b,a,x, filtic(b,a,10,0));
x(1)=1; y_total=filter(b,a,x, filtic(b,a,10,0));
plot([y_free(:), y_total(:)]); grid on; legend('free','free+forced');
```

---

### 문제 34. IIR 수치 민감성(Direct Form II)

**학습 목표**: 구조 선택.

**문제/해설**: 고차 IIR에서 Direct Form II는 내부 상태가 큰 동적 범위를 가져 수치 불안정. **2차 섹션(바이쿼드) 분해**와 스케일링을 통해 개선.

---

### 문제 35. IIR의 FIR 근사

**학습 목표**: 임펄스응답 자르기.

**문제/Octave**:
```
pkg load signal
[b,a]=cheby1(4,1,0.3);
N=1024; imp=[1 zeros(1,N-1)]; h=filter(b,a,imp);
x=randn(1,2000); y_iir=filter(b,a,x); y_fir=conv(x,h,'same');
printf("IIR vs FIR approx error=%.2e\n", norm(y_iir-y_fir)/norm(y_iir));
```

---

### 문제 36. 디지털 적분기/미분기

**학습 목표**: 단위원 근처 동작.

**문제/해설**:
- 적분기: $$H(z)=\frac{1}{1-z^{-1}},\ h[n]=u[n]$$, BIBO 불안정, DC 무한 이득.
- 1차 차분: $$H(z)=1-z^{-1},\ h[n]=\delta[n]-\delta[n-1]$$, 안정, DC=0.

**Octave**:
```
N=64; u=ones(1,N); h_int=u; h_diff=[1 -1 zeros(1,N-2)];
[H1,w]=freqz(h_int,1,1024); [H2,~]=freqz(h_diff,1,1024);
plot(w/pi,20*log10(abs(H1)+1e-12)); hold on
plot(w/pi,20*log10(abs(H2)+1e-12)); grid on; legend('Integrator','Differentiator');
```

---

### 문제 37. Notch 필터 설계

**학습 목표**: 영/극 배치.

**문제/Octave**:
```
w0=pi/3; r=0.95;
b=poly([exp(1j*w0), exp(-1j*w0)]);
a=poly([r*exp(1j*w0), r*exp(-1j*w0)]);
[H,w]=freqz(b,a,2048);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; xlabel('\omega/\pi'); ylabel('dB');
```

---

### 문제 38. 선형위상 FIR 타입 분류

**학습 목표**: 대칭성 제약.

**문제/해설 요약**:
- 타입 I: 홀수 길이, 대칭. DC/π 모두 자유.
- 타입 II: 짝수 길이, 대칭. π에서 제약(0).
- 타입 III: 홀수 길이, 반대칭. DC=0.
- 타입 IV: 짝수 길이, 반대칭. DC/π 모두 0.

---

### 문제 39. 실제 데이터에서의 필터링

**학습 목표**: 실전 파이프라인.

**문제/Octave**:
```
pkg load signal
Fs=16000; t=(0:1/Fs:2-1/Fs);
x = sin(2*pi*440*t) + 0.7*sin(2*pi*2000*t) + 0.1*randn(size(t));
b_lp=fir1(200, 1200/(Fs/2), hamming(201)); y1=filtfilt(b_lp,1,x);
w0=2*pi*2000/Fs; r=0.98; b=poly([exp(1j*w0),exp(-1j*w0)]); a=poly([r*exp(1j*w0),r*exp(-1j*w0)]);
y2=filtfilt(b,a,y1);
N=4096; W=hanning(N)'; spec=@(s) 20*log10(abs(fft(s(1:N).*W,N))+1e-12);
f=(0:N-1)*Fs/N;
plot(f(1:N/2), [spec(x)(1:N/2); spec(y2)(1:N/2)]'); grid on; legend('orig','filtered');
```

---

### 문제 40. 파이프라인 자동 검증 체크리스트

**학습 목표**: 안정성/동치/지연 자동 점검.

**문제/Octave 템플릿**:
```
function report = dsp_selfcheck(x, b, a, Fs)
  report=struct();
  p=roots(a); report.max_pole= max(abs(p));       % (2) 안정성
  N=2^nextpow2(numel(x)+numel(b)-1);              % (3) conv vs filter
  yf=filter(b,a,x);
  yc=ifft(fft(x,N).*fft(b,N)); yc=yc(1:numel(x));
  report.conv_filter_err = norm(yf - yc)/norm(yf);
  [H,w]=freqz(b,a,2048); phi=unwrap(angle(H));    % (5) 군지연
  tau=-gradient(phi)./gradient(w);
  report.group_delay = mean(tau);
  report.Fs = Fs;
endfunction

% 사용 예
x=randn(1,4096); [b,a]=butter(4,0.2); Fs=8000;
r=dsp_selfcheck(x,b,a,Fs); disp(r);
```

---

## 마무리

- 본 문제 세트는 **정의→성질→표상→알고리즘→실전** 흐름으로 설계했으며, 각 문항은 수식·직관·코드로 학습 루프를 닫는다.
- 추가 심화: **멀티레이트(업/다운샘플·폴리페이즈)**, **STFT/필터뱅크**, **적응형 필터(LMS/RLS)**, **웨이블릿** 등.
- 실무 전 점검: **안정성(극 반경)**, **경계 처리**, **지연(군지연/프레임)**, **정규화(디컨볼루션 시)**를 자동화 스크립트로 반복 검증할 것.
