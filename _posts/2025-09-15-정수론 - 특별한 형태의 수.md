---
layout: post
title: 정수론 - 특별한 형태의 수
date: 2025-09-15 15:25:23 +0900
category: 정수론
---
# 메르센(느), 완전수, 메르센 소수·친화수, 페르마 수

> **구성/원칙**
> - 역사·정의 → 성질 → 증명(또는 증명 스케치) → 계산 예제를 **적게** 두되 **아주 자세히** 제시한다.
> - 모든 수식은 $$\dots$$ 로 감싼 **MathJax** 표기다.
> - 표기: $$\sigma(n)=\sum_{d\mid n} d$$(약수의 합), $$s(n)=\sigma(n)-n$$(진약수의 합), $$\varphi(n)$$(오일러 함수).

---

## 메르센(느) — 배경과 문제 제기

**마랭 메르센(마르탱 메르센느, Marin Mersenne, 1588–1648)** 는 프랑스의 수도자·수학자다. 오늘날 그의 이름은
$$
M_p:=2^p-1
$$
형태(지수 $$p$$ 는 보통 **소수**)의 수들, 즉 **메르센 수(Mersenne number)**, 특히 이들 중 **소수**인 **메르센 소수(Mersenne prime)** 로 기억된다.

- 왜 $$2^p-1$$ 인가?
  2진법에서 **모든 자리 1**인 수가 바로 $$2^p-1=(\underbrace{11\cdots 1}_{p\text{자리}})_2$$ 이다. “반복된 1”의 산술적 성질이 **완전수** 등과 깊이 연결된다.

---

## 메르센 수와 메르센 소수

### 기본 성질

- **필요조건(간단하지만 중요한 사실)**
  $$
  2^p-1\ \text{이 소수이면}\ p\ \text{는 반드시 소수.}
  $$
  **증명.** \(p=ab\ (a,b>1)\) 라면
  $$
  2^{ab}-1=(2^a)^b-1=(2^a-1)\Big(1+2^a+2^{2a}+\cdots+2^{(b-1)a}\Big),
  $$
  따라서 합성. □

- **역은 거짓**: $$p$$ 가 소수여도 $$2^p-1$$ 이 **반드시** 소수인 것은 아니다. 예: \(p=11\) 에서 \(2^{11}-1=2047=23\cdot 89\).

### 판정법(메르센 소수 전용)

**정리(루카스–레머).** \(p\ge 3\) 를 **소수**라 하자. 수열
$$
s_0=4,\quad s_{k+1}=s_k^2-2\quad (k\ge 0)
$$
를 정의한다. 그러면
$$
M_p=2^p-1\ \text{가 소수} \iff s_{p-2}\equiv 0\pmod{M_p}.
$$

**증명 스케치.** 이 수열은 실수체에서 \(x^2-2\) 의 반복합성으로 얻어지는 **체수론적 순환점**을 모듈러 \(M_p\) 로 끌어온 것이다. 핵심은 적절한 **이차 분할체**에서 원소의 노름과 위수를 추적해 \(M_p\) 가 소수일 때에만 위 수열이 0을 만들고, 반대로 0을 만들면 분해를 막는다는 것. (고전 정수론 교재에 상세 전개.) □

**예제(짧지만 세부)**: \(p=5\)
\(M_5=31\).
\(s_0=4\), \(s_1=4^2-2=14\), \(s_2=14^2-2=194\equiv 194-31\cdot6=8\), \(s_3=8^2-2=62\equiv 0\ (\bmod 31)\).
→ \(s_{p-2}=s_3\equiv 0\). **\(31\)은 메르센 소수**.

---

## — 메르센 소수와의 일대일 대응(짝수의 경우)

### 정의와 고전 정리

- **정의.** \(n\) 의 **진약수 합** \(s(n)=\sigma(n)-n\).
  \(s(n)=n\) 이면 \(n\) 을 **완전수(Perfect number)** 라 한다.

- **예**: \(6\)
  약수 \(1,2,3,6\), 진약수 합 \(1+2+3=6\) → 완전.

### 유클리드–오일러 정리(Euclid–Euler)

**정리.** 짝수 완전수는 **정확히**
$$
N=2^{p-1}\,(2^p-1)
$$
꼴이며, 여기서 \(2^p-1\) 이 **메르센 소수**다. 반대로 \(2^p-1\) 이 소수이면 위 \(N\) 은 완전수다.

**증명(→: 유클리드 방향)**
\(M=2^p-1\) 이 소수일 때
$$
\sigma(N)=\sigma(2^{p-1})\sigma(M)=(2^p-1)\cdot(1+M)=(2^p-1)\cdot 2^p=2N.
$$
따라서 \(s(N)=\sigma(N)-N=2N-N=N\). □

**증명 스케치(←: 오일러 방향)**
짝수 완전수 \(N\) 를 \(N=2^{k}m\ (m\ \text{홀수})\) 로 쓰고 \(\sigma\) 의 곱셈성을 이용해
\(\sigma(N)=\sigma(2^k)\sigma(m)=2N\) 조건을 해석하면 \(m\) 이 소수, \(k=p-1\), \(m=2^p-1\) 이어야 함이 귀결된다. (정교한 약수 구조 분석.) □

**예제**
- \(p=2\): \(N=2^{1}(2^2-1)=6\).
- \(p=3\): \(N=2^{2}(7)=28\).
- \(p=5\): \(2^{4}\cdot 31=496\).
- \(p=7\): \(2^{6}\cdot 127=8128\).

> **중요**: **모든 짝수 완전수**는 메르센 소수와 **일대일 대응**한다.
> **열린 문제**: **홀수 완전수**의 존재 여부는 **미해결**. (존재한다면 엄청나게 크고 가혹한 필수조건들을 만족해야 함: 소인수 구조·최소 소인수 하한 등.)

---

## — 메르센형 구성과의 연결

### 정의

서로 다른 두 양의 정수 \((m,n)\) 에 대해
$$
s(m)=n,\quad s(n)=m
$$
이면 \((m,n)\) 을 **친화수(amicable pair)** 라 한다.

- 가장 유명한 예: \((220,284)\).
  \(220\) 의 진약수 합은 \(284\), \(284\) 의 진약수 합은 \(220\).

### 타비트(Thābit ibn Qurra, 9세기)의 구성(메르센형 소수 3개가 관여)

**정리(타비트의 정리).** 정수 \(n\ge 2\) 에 대해
$$
p=3\cdot 2^{\,n-1}-1,\quad
q=3\cdot 2^{\,n}-1,\quad
r=9\cdot 2^{\,2n-1}-1
$$
가 모두 **소수**라면
$$
A=2^{\,n}\,p\,q,\qquad B=2^{\,n}\,r
$$
은 **친화수**이다.

**예제(고전)** \(n=2\):
\(p=5,\ q=11,\ r=71\) (모두 소수) →
\(A=2^2\cdot 5\cdot 11=220,\ B=2^2\cdot 71=284\) → \((220,284)\).

**증명 스케치.** \(\sigma\) 의 곱셈성과 위 세 소수 조건을 이용해
\(\sigma(A)-A=B,\ \sigma(B)-B=A\) 를 직접 전개해 얻는다. 구조는 **메르센형(2의 거듭제곱 ±1)** 소수 3개가 절묘하게 엮여 서로의 진약수 합을 만들어내는 형태.

> 친화수의 **일반 이론**은 매우 어려우며 알려진 구성들은 제한적이다. (오일러의 확장, 이후의 수많은 컴퓨터 탐색 결과 등.)

---

## 페르마 수와 페르마 소수

### 정의와 기본 성질

**정의.**
$$
F_n:=2^{2^n}+1\quad (n=0,1,2,\dots)
$$
를 **페르마 수(Fermat number)** 라 한다. 페르마는 \(F_n\) 이 **모두 소수**일 것이라 추정했으나, 이는 틀렸다.

- **상호 서로소성**: \(m\ne n\) 이면 \(\gcd(F_m,F_n)=1\).
  **증명.** 곱의 항등
  $$
  F_0F_1\cdots F_{n-1}=F_n-2
  $$
  에서 \(\gcd(F_n,F_0\cdots F_{n-1})=1\). □
  (따라서 서로 다른 \(F_n\) 간에는 공약수가 없다.)

- **알려진 페르마 소수**: \(F_0=3,\ F_1=5,\ F_2=17,\ F_3=257,\ F_4=65537\) 는 **소수**.
  \(F_5=4294967297\) 은 합성(아래).

### 판정법(페르마 수 전용)

**정리(페피앵).** \(n\ge 1\). \(F_n\) 은 소수 \(\iff\)
$$
3^{\frac{F_n-1}{2}}\equiv -1 \pmod{F_n}.
$$

**증명 스케치.** \((\mathbb Z/F_n\mathbb Z)^\times\) 의 구조(크기 \(F_n-1=2^{2^n}\))와 제곱 잔여 성질을 이용해 \(3\) 의 지수가 정확히 \((F_n-1)/2\) 일 때에만 \(-1\) 을 낳음을 보인다. □

**예: \(F_5\) 의 합성 판정과 인수 641**
고전적 트릭: \(641\mid F_5\) (아이덴티티를 이용한 깔끔한 증명)
$$
641=5\cdot 2^7+1=625+16=5^4+2^4.
$$
아래를 관찰하자:
$$
2^{32}+1=(2^{16})^2+1
=(2^{8})^4+1
$$
한편 모듈러 \(641\) 에서 \(2^{32}\equiv -1\) 을 보이면 끝이다. 실제로
$$
2^{32}=(2^{16})^2\equiv (-5^2)^2\equiv 25^2\equiv -1\ (\bmod 641)
$$
가 되도록 적절히 동치들을 배열하면(상세 전개 생략) \(641\mid F_5\) 가 확인된다.
또 다른 인수는 \(6700417\). 따라서 \(F_5\) 는 합성.

> \(n\ge 5\) 에 대해 \(F_n\) 은 모두 합성인 **것으로 추정**(증명 불가). 현재까지 \(n=5,\dots,11\) 등 상당수가 합성으로 밝혀졌다.

### 정다각형 작도(가우스–방첼)와 페르마 소수

**정리(가우스–방첼).** 정수 \(N\) 에 대하여 **자와-컴퍼스**로 정\(N\)각형이 작도 가능 \(\iff\)
$$
N=2^k \cdot p_1\cdots p_r,
$$
여기서 \(p_i\) 는 **서로 다른 페르마 소수**.
→ \(N\) 의 홀수 부분이 **서로 다른 페르마 소수들의 곱**일 때만 가능.

**예**
- \(N=17\): \(F_2\) 이므로 작도 가능(가우스의 유명한 결과).
- \(N=65537\): \(F_4\), 작도 가능.
- \(N=7\) 은 페르마 소수가 아니므로 정7각형은 자와-컴퍼스로 작도 불가.

---

## 더 깊은 연결: 메르센 ↔ 완전수, 페르마 ↔ 작도, 친화수 ↔ 메르센형 구성

- 짝수 완전수 전부가 **메르센 소수**와 1:1 (유클리드–오일러).
- 페르마 소수는 **유클리드 기하 작도**와 직결(가우스–방첼).
- 친화수의 **고전적 무한한 패밀리**는 \(2\)-멱에 선형 결합된 **메르센형 소수** 3개가 맞물릴 때 출현(타비트).

---

## 계산 예제(적게, 그러나 끝까지)

### 케이스

- \(M_{13}=2^{13}-1=8191\) 은 실제 소수다.
- 완전수:
  $$
  N=2^{12}\cdot 8191=4096\cdot 8191=33{,}550{,}336.
  $$
- 검증(핵심만): \(\sigma(2^{12})=2^{13}-1=8191\), \(\sigma(8191)=8192\) → \(\sigma(N)=8191\cdot 8192=2N\).

### 의 완전 검산

- \(220=2^2\cdot 5\cdot 11\)
  \(\sigma(220)=\sigma(2^2)\sigma(5)\sigma(11)=(1+2+4)(1+5)(1+11)=7\cdot 6\cdot 12=504\)
  \(s(220)=504-220=284\).
- \(284=2^2\cdot 71\)
  \(\sigma(284)=\sigma(2^2)\sigma(71)=7\cdot 72=504\)
  \(s(284)=504-284=220\).

### 확인

- \(M_7=127\).
  \(s_0=4\), \(s_1=14\), \(s_2=194\equiv 194-127=67\), \(s_3=67^2-2=4489-2=4487\equiv 4487-127\cdot35=4487-4445=42\),
  \(s_4=42^2-2=1764-2=1762\equiv 1762-127\cdot 13=1762-1651=111\),
  \(s_5=111^2-2=12321-2=12319\equiv 12319-127\cdot 97=12319-12319=0\).
  → \(s_{p-2}=s_5\equiv 0\). **127은 메르센 소수**.

---

## 추가 성질 모음(핵심만)

### 메르센 소수

- 메르센 소수의 **개수는 무한한지 미지수**(열린 문제).
- 매우 큰 소수 탐색은 **GIMPS** 같은 분산 계산 프로젝트에서 루카스–레머로 이뤄진다.

### 완전수

- **홀수 완전수**가 존재한다면, 엄청난 제약(예: 최소 소인수 \(\ge 10^8\) 수준 등)이 필요함이 알려져 있다. (단, 직접 존재/부존재는 미정.)
- **과잉수/부족수** 개념: \(s(n)>n\)/\(s(n)<n\). 완전수는 경계선.

### 친화수

- 많은 친화수가 알려졌지만 **모두의 구조적 분류**는 미해결.
- \(s(s(n))=n\) 인 **친화성**보다 긴 주기를 갖는 **사교수(sociable numbers)** 도 존재한다.

### 페르마 수

- \(F_n\) 들은 **서로소** → 각기 서로 다른 새로운 소인수들을 “강제”한다.
- \(F_n\) 의 소인은 반드시 \(k\cdot 2^{n+1}+1\) 꼴(기본 합동론으로 보임).

---

## 증명 아이디어 몇 가지(요약)

### 유클리드–오일러(짝수 완전수)

- \(\sigma\) 의 곱셈성과 기하급수합 공식
  \(1+p+\cdots+p^a=\dfrac{p^{a+1}-1}{p-1}\)
  만으로 유클리드 방향은 한 줄.
- 오일러 방향은 \(2\)-진 분해와 약수 집합의 일치 조건을 세밀히 추적.

### 루카스–레머

- 이차 확장체 \(\mathbb{Q}(\sqrt{3})\) 또는 \(\mathbb{Q}(\sqrt{d})\) 의 단위와 노름에서 비롯된 재귀.
- “소수이면 0, 0이면 소수”의 양방향을 각기 위수·나눗셈 불가능성으로 귀결.

### 페피앵

- \((\mathbb Z/F_n\mathbb Z)^\times\) 의 크기가 \(2^{2^n}\) 인 **2-멱**임을 활용.
- \(3\) 의 거듭제곱이 \(-1\) 을 만들려면 정확히 \((F_n-1)/2\) 승이 필요·충분.

---

## 마무리 요약

- **메르센 수**: \(M_p=2^p-1\). \(M_p\) 가 소수려면 \(p\) 가 소수여야 한다. 메르센 소수 판정은 **루카스–레머**.
- **짝수 완전수**: 정확히 \(2^{p-1}(2^p-1)\) (유클리드–오일러). → 메르센 소수와 1:1 대응.
- **친화수**: \(s(m)=n, s(n)=m\). 타비트 구성은 \(2\)-멱·메르센형 소수 세 개가 맞물릴 때 \((A,B)\) 친화수가 된다.
- **페르마 수**: \(F_n=2^{2^n}+1\). 서로소이며 **페피앵 판정법**으로 소수성 판단(작은 \(n\) 에서만). 페르마 소수는 **작도가능 정다각형**과 직결.
- **열린 문제**: 메르센 소수의 무한성, 홀수 완전수의 존재, 페르마 수의 소수성 패턴 등.

> “반복된 1(메르센)”과 “2의 이중지수(페르마)”는 단순한 형태에서 출발해 **깊은 정수론**(약수 함수, 합동론, 유한군)과 **기하/알고리즘**(작도·판정법)로 뻗어 나간다. 몇몇은 우아한 완결(유클리드–오일러)을 갖고, 몇몇은 여전히 **미지의 영역**을 비춘다.
