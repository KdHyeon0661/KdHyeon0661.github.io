---
layout: post
title: 정보보안기사 - 윈도우 서비스 관리
date: 2025-11-06 18:25:23 +0900
category: 정보보안기사
---
# SECTION 03 윈도우 서버 취약점 — 02. 서비스 관리 (SCM·서비스 구성·권한·계정·바이너리·방화벽·감사·자동화)

> 목적: **Windows Service**(서비스) 전 생애주기(설계→배포→운영→감사→폐기)에서의 취약점과 하드닝 방법을 **실무 예제 중심**으로 정리한다.  
> 범위: **SCM(서비스 제어 관리자) 구조**, **서비스 시작 유형/복구/트리거**, **실행 계정/권한(권한 토큰·Service SID)**, **바이너리/폴더 ACL**, **레지스트리/SDDL**, **방화벽의 서비스 바인딩**, **취약 구성 탐지 스크립트**, **변경 모니터링(이벤트/Sysmon)**, **자동화(GPO/PowerShell)**.  
> 전제: Windows Server 2019/2022, PowerShell 5.1 이상. 도메인 환경(AD) 기준 예시 포함. 모든 실습은 **검증 환경**에서.

---

## 1. 서비스 보안의 위협 모델과 핵심 원칙

### 대표 위협
- **권한 상승**:  
  - *Unquoted Service Path* / *경로 인용 누락*  
  - 서비스/ServiceDLL 경로 또는 상위 폴더 **과다 ACL(Everyone/Users: Modify)**  
  - 서비스 **구성 변경 권한**이 일반 사용자/비인가 그룹에 부여됨(SDDL 부실)
- **지속성(Persistence)**:  
  - *서비스 신규 등록*(7045), *FailureActions*에 **프로그램 실행** 삽입  
  - *Service Trigger*로 **은닉 자동 시작**  
  - svchost **ServiceDLL 하이재킹**(Parameters\ServiceDll)  
- **자격증명 악용**:  
  - 고권한 서비스 계정(로컬 관리자/도메인 사용자) 재사용  
  - 불필요 **권한(SeImpersonatePrivilege 등)** 보유  
- **측면 이동/포트 탈취**:  
  - 방화벽 **서비스 바인딩 미사용** → 동일 포트를 다른 프로세스가 악용  
- **가시성 부족**:  
  - 7000~7045/4697 등 **이벤트 수집 부재**, 레지스트리/파일 변경 미감시

### 핵심 원칙(요약)
- **원칙 1 – 최소 권한 실행 계정**: *Virtual Account* 또는 **gMSA** + **필요 권한만(Privileges)**.  
- **원칙 2 – 최소 노출 파일/레지스트리**: 실행 파일·디렉터리·ServiceDLL·레지스트리 **강한 ACL**.  
- **원칙 3 – 구성/수정 권한 제한**: 서비스 SDDL에 **변경 권한**을 관리자/시스템에만.  
- **원칙 4 – 서비스-포트 바인딩**: 방화벽 규칙을 **특정 서비스**에 바인딩.  
- **원칙 5 – 변경 가시화**: 7040/7045/13(Sysmon RegistrySet), 4657(레지스트리), 4663(파일) 모니터링.  
- **원칙 6 – 자동화**: GPO *System Services*, PowerShell DSC/스크립트로 **표준화**.

---

## 2. 서비스 기본 구조와 핵심 개념

- **SCM(서비스 제어 관리자)**: 서비스 메타/상태 관리.  
- **서비스 형식**: Own Process(독립 프로세스), Share Process(svchost 공유), Driver(커널 드라이버).  
- **구성 핵심**:  
  - 레지스트리: `HKLM\SYSTEM\CurrentControlSet\Services\<ServiceName>`  
  - 주요 값: `ImagePath`, `Type`, `Start`, `ObjectName`(실행 계정), `FailureActions`, `Parameters\ServiceDll`(svchost형)  
  - 보안 설명자(SDDL): 서비스/SCM에 대한 **DACL**(변경/제어 권한)

확인:
```powershell
Get-Service | Select-Object Name,DisplayName,Status,StartType,ServiceType
Get-CimInstance Win32_Service | Select Name,StartMode,ProcessId,StartName,PathName
```

---

## 3. 위험 구성 자동 점검 스크립트(현장용)

> 아래 스크립트는 **3가지**를 찾는다:  
> (1) **Unquoted Path + 공백 포함**, (2) **서비스 바이너리/ServiceDLL 경로의 취약 ACL**, (3) **비인가 계정이 서비스 변경 가능**(SDDL).

```powershell
# ServiceHardening-Audit.ps1
# 관리자 PowerShell에서 실행 권고

$services = Get-CimInstance Win32_Service

Write-Host "[1] Unquoted Path with spaces" -ForegroundColor Cyan
$services | Where-Object {
  $_.PathName -and ($_.PathName -match '\s') -and ($_.PathName -notmatch '^"')
} | Select Name, PathName

function Test-WeakAcl {
  param([string]$Path)
  try {
    if (-not (Test-Path $Path)) { return $false }
    $acl = Get-Acl $Path
    $weak = $acl.Access | Where-Object {
      # Everyone/Users/Authenticated Users 가 Modify/Write/FullControl 보유?
      ($_.IdentityReference -match 'Everyone|Users|Authenticated Users') -and
      ($_.FileSystemRights -match 'Write|Modify|FullControl')
    }
    return [bool]$weak
  } catch { return $true } # 에러도 위험으로 간주
}

Write-Host "`n[2] Binary/Folder weak ACL" -ForegroundColor Cyan
foreach ($svc in $services) {
  if (-not $svc.PathName) { continue }
  # 따옴표 제거 및 매개변수 제외
  $exe = ($svc.PathName -replace '^"|"$','').Split(' ')[0]
  $folder = Split-Path $exe -ErrorAction SilentlyContinue
  if (Test-WeakAcl $exe -or (Test-WeakAcl $folder)) {
    [pscustomobject]@{Service=$svc.Name; Path=$exe; Folder=$folder}
  }
}

Write-Host "`n[3] Service SDDL – change 권한 과다" -ForegroundColor Cyan
foreach($svc in $services){
  $sddl = sc.exe sdshow $svc.Name 2>$null
  if (-not $sddl) { continue }
  # Everyone(ED), Authenticated Users(AU)에게 서비스 변경권한(WP,DT,CR,LC,SW 등)이 포함되면 경고
  if ($sddl -match '\(A;;(.*WP|.*DT|.*CR|.*SW|.*LC).*;;;(WD|AU)\)'){
    [pscustomobject]@{Service=$svc.Name; SDDL=$sddl}
  }
}
```

**후속 조치 원칙**
- (1) Unquoted: **경로를 반드시 인용부호로** 수정.  
- (2) ACL 약함: **Users/Authenticated Users**의 **Write/Modify 제거**, 상위 폴더까지 확인.  
- (3) SDDL 과다: **sdset**로 DACL 재설정(표준 템플릿 또는 GPO *System Services*로 배포).

---

## 4. Unquoted Service Path(경로 인용 누락) — 권한 상승 고전 취약점

### 탐지
```powershell
Get-CimInstance Win32_Service |
  Where-Object { $_.PathName -and ($_.PathName -match '\s') -and ($_.PathName -notmatch '^"') } |
  Select Name,PathName
```

### 수정
- `ImagePath` 전체를 **반드시** `"`로 감싼다.
```powershell
$svc = "MyApp"
$path = 'C:\Program Files\My App\app.exe -k start'
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\$svc" -Name ImagePath -Value "`"$path`""
```
- 상위 경로(`C:\Program.exe`, `C:\Program Files\My.exe` 등)에 **쓰기 권한이 없어도** 만들 수 있는 경우가 있으므로, **상위 폴더 ACL**도 확인·정비.

---

## 5. 서비스 실행 계정·권한 하드닝

### 5.1 실행 계정 선택 우선순위
1) **Virtual Service Account** 또는 **built-in** 최소권한(LocalService/NetworkService)  
2) **gMSA(Group Managed Service Account)**(도메인·암호 자동 회전)  
3) 부득이하게 **로컬 사용자**(권한 최소/비대화형) — *지양*

변경 예:
```powershell
# 로컬 서비스로 실행
$svc = "MyApp"
sc.exe config $svc obj= "NT AUTHORITY\LocalService" password= ""
```

### 5.2 Service SID & 권한 제한(토큰 특권)
- **Service SID**: `sc.exe sidtype <svc> unrestricted` → `NT SERVICE\<svc>` SID 생성, 파일/레지스트리 ACL에 **해당 SID만 허용** 가능(격리 강화).
```powershell
sc.exe sidtype MyApp unrestricted
# 폴더 ACL에 NT SERVICE\MyApp만 쓰기 허용(예)
icacls "C:\ProgramData\MyApp" /inheritance:r
icacls "C:\ProgramData\MyApp" /grant "NT SERVICE\MyApp:(OI)(CI)M" "SYSTEM:(OI)(CI)F" "Administrators:(OI)(CI)F"
```

- **필요 권한만 부여(sc.exe privs)**: 불필요한 `SeImpersonatePrivilege` 등 제거로 *Potato류* 악용 억제.
```powershell
# 요구 특권을 최소로(예: 통상 SeChangeNotifyPrivilege, SeIncreaseWorkingSetPrivilege 정도)
sc.exe privs MyApp SeChangeNotifyPrivilege/SeIncreaseWorkingSetPrivilege
sc.exe qprivs MyApp
```

### 5.3 “Log on as a service” 권한 관리
- GPO: **컴퓨터 구성 → Windows 설정 → 보안 설정 → 로컬 정책 → 사용자 권한 할당 → 서비스로 로그온**
- 지정된 **gMSA/로컬 계정만** 부여(광범위 그룹 금지).

---

## 6. 파일/폴더 ACL 하드닝(바이너리·작업 디렉터리·업데이트 폴더)

### 원칙
- 서비스 **실행 파일과 상위 디렉터리**에 `Users/Authenticated Users` **Write/Modify 금지**.  
- 업데이트/캐시/로그 디렉터리는 **서비스 SID/서비스 계정**에만 쓰기 허용.

예시:
```powershell
# 실행 디렉터리
$dir = "C:\Program Files\MyApp"
icacls $dir /inheritance:r
icacls $dir /grant "SYSTEM:(OI)(CI)F" "Administrators:(OI)(CI)F"
icacls $dir /remove "Users" "Authenticated Users" "Everyone"

# 데이터 디렉터리(서비스만 쓰기)
icacls "C:\ProgramData\MyApp" /inheritance:r
icacls "C:\ProgramData\MyApp" /grant "NT SERVICE\MyApp:(OI)(CI)M" "SYSTEM:(OI)(CI)F" "Administrators:(OI)(CI)F"
```

> *TIP*: 권한 조정 후 **서브 경로까지** 정합성 확인(`icacls /verify`), **업데이트 에이전트** 동작 영향 검토.

---

## 7. svchost 기반 서비스(ServiceDLL) 하드닝

### 위험 포인트
- `HKLM\SYSTEM\CCS\Services\<svc>\Parameters\ServiceDll` 경로가 **사용자 쓰기 가능한 폴더**를 가리키면 **DLL 하이재킹**.

### 점검/수정
```powershell
Get-ChildItem 'HKLM:\SYSTEM\CurrentControlSet\Services' |
  ForEach-Object {
    $p = Get-ItemProperty -Path $_.PsPath -ErrorAction SilentlyContinue
    $dll = (Get-ItemProperty -Path "$($_.PsPath)\Parameters" -Name ServiceDll -ErrorAction SilentlyContinue).ServiceDll
    if ($dll) {
      $dllPath = $dll -replace '^@',''  # MUI 문자열 제거
      try {
        $acl = Get-Acl $dllPath
        $weak = $acl.Access | Where-Object { $_.IdentityReference -match 'Users|Authenticated Users|Everyone' -and $_.FileSystemRights -match 'Write|Modify|FullControl' }
        if ($weak){ [pscustomobject]@{Service=$_.PSChildName; ServiceDll=$dllPath} }
      } catch {}
    }
  }
```

- **ServiceDLL**은 **시스템/관리자만 쓰기**, 사용자 쓰기는 **절대 금지**.

---

## 8. 서비스 시작 유형/복구/트리거 하드닝

### 8.1 시작 유형(StartType)
- **Automatic (Delayed Start)**: 부팅 지연 필요 서비스에만.  
- **Manual**: 필요 시만 시작.  
- **Disabled**: 필요 없는 서비스는 비활성.  
```powershell
Set-Service -Name "MyApp" -StartupType AutomaticDelayedStart
```

### 8.2 복구(FailureActions) — 악용 방지
- “프로그램 실행” 복구 동작은 **금지**(지속성 벡터). 필요 시 **서비스 재시작**만.
```powershell
# sc.exe로 FailureActions 설정 예(재시작만, 1분 후)
sc.exe failure MyApp reset= 86400 actions= restart/60000/restart/60000/""/0
```

### 8.3 서비스 트리거(Trigger)
- 네트워크 연결/디바이스 도착 등 **조건부 자동 시작**.  
- 공격자는 트리거로 **은닉 지속성**을 만들 수 있으므로 정기 점검.
```powershell
sc.exe qtriggerinfo MyApp
# 불필요 트리거 제거 필요 시
# sc.exe triggerinfo MyApp delete <TriggerGUID>
```

---

## 9. 서비스 보안 설명자(SDDL) — 변경 권한 최소화

### 확인·적용
```powershell
# SDDL 조회
sc.exe sdshow MyApp

# 예시: 관리자/시스템만 변경 허용하는 보수적 DACL 템플릿(참고용)
# D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCLCSWRPWPDTLOCRRC;;;BA)
#  - CC/LC: 연결/쿼리, SW: 중지, RP/RC: 읽기, WP/DT: 구성 변경/삭제
# 적용 전 반드시 테스트
sc.exe sdset MyApp "D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCLCSWRPWPDTLOCRRC;;;BA)"
```

> **주의**: SDDL은 오타·권한 과소/과다 시 **운영 중단** 가능. GPO “System Services”로 **관리형 배포** 권장.

---

## 10. 방화벽 규칙을 서비스에 바인딩 — 포트 탈취 차단

- 동일 포트(예: 8080)를 **해당 서비스 프로세스**만 사용할 수 있게 강제.
```powershell
# 서비스 단축 이름(ShortName) 확인
sc.exe getkeyname "My Application Service"

# 방화벽 규칙 생성(인바운드 8080, 서비스 바인딩)
New-NetFirewallRule -DisplayName "MyApp Inbound 8080" `
  -Direction Inbound -Protocol TCP -LocalPort 8080 -Service MyApp -Action Allow
```
> 이렇게 하면 **다른 프로세스**가 8080을 수신해도 **규칙 적용 불가** → 노출 최소화.

---

## 11. 프로세스/이미지 취약성 완화(EMET 대체: IFEO Mitigations)

- 서비스 이미지 파일에 **DEP/ASLR/CFG/Strict Handle Check** 등 완화 적용.
```powershell
# 서비스 실행 파일에 이미지 완화 적용
Set-ProcessMitigation -Name "C:\Program Files\MyApp\app.exe" -Enable DEP,ASLR,BottomUpASLR,StrictHandle,CFG,SEHOP
Get-ProcessMitigation -Name "C:\Program Files\MyApp\app.exe"
```
> 레거시 컴포넌트와의 호환성은 *사전 테스트* 필수.

---

## 12. 변경 모니터링 — Event Log & Sysmon

### 12.1 이벤트 로그(핵심)
- **Service Control Manager**  
  - 7000~7011: 시작 실패/시간 초과  
  - **7040**: 시작 유형 변경  
  - **7045**: 서비스 설치(신규 등록)  
  - 7036: 서비스 상태 변경
- **Security**  
  - **4697**: 서비스 설치(감사 정책 필요)  
  - 4657: 레지스트리 값 변경(감사 활성)  
  - 4663: 파일/디렉터리 접근(“개체 액세스” 감사)

PowerShell 조회 예:
```powershell
# 최근 24시간 서비스 설치/시작유형 변경 감시
$since = (Get-Date).AddDays(-1)
Get-WinEvent -FilterHashtable @{LogName='System'; ID=@(7040,7045); StartTime=$since} |
  Select TimeCreated, Id, ProviderName, Message

# Security 4697(서비스 설치) – 감사가 켜져 있어야 함
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4697; StartTime=$since} |
  Select TimeCreated, Message
```

### 12.2 Sysmon(권장 룰 아이디어)
- **Event ID 13**: Registry value set → `HKLM\SYSTEM\CCS\Services\*\ImagePath|ServiceDll`  
- **Event ID 1**: Process Create → `services.exe`가 호출하는 **비서명** exe/dll  
- **Event ID 7**: Image Loaded → 서비스 경로에 **비정상 DLL** 로드

*(규칙 작성은 환경별로 튜닝 — 예: `TargetObject endswith \ImagePath`)*

---

## 13. 서비스 수명주기 운영(템플릿)

### 13.1 배포 체크리스트
- [ ] 실행 계정: *Virtual/LocalService/NetworkService* 우선, 필요 시 **gMSA**.  
- [ ] **Service SID 활성화**(`sidtype unrestricted`) 및 폴더 ACL에 **NT SERVICE\<svc>** 반영.  
- [ ] **sc.exe privs**로 특권 최소화.  
- [ ] **ImagePath 인용**, 상위 폴더 포함 **강한 ACL**.  
- [ ] svchost형 **ServiceDll 경로**의 ACL 검증.  
- [ ] 방화벽 **서비스 바인딩** 규칙 생성.  
- [ ] 시작유형·복구(프로그램 실행 금지)·트리거 점검.  
- [ ] SDDL(구성 변경 권한 최소화) 적용.  
- [ ] 이벤트/감사/알림 규칙 배포(7040/7045/4697/4657).  
- [ ] 문서화(운영자/배포자/로그 위치/업데이트 절차).

### 13.2 운영 변경(런북)
- 변경 사유 → 영향도 분석 → **테스트 서버** 적용 → 배포 → **검증 스크립트**(위 3항) → 이벤트/감사 확인 → 롤백 포인트 보관.

### 13.3 폐기
- 서비스 **중지/비활성** → 방화벽 규칙 제거 → SDDL/폴더/레지스트리 **잔존 제거** → 로그/데이터 보관 요건 이행.

---

## 14. GPO로 “System Services” 보안 표준화

- 경로: **컴퓨터 구성 → Windows 설정 → 보안 설정 → 시스템 서비스**  
- 각 서비스에 대해 **시작 모드**와 **보안(권한)** 정의 가능(내부적으로 SDDL 적용).  
- 장점: **드리프트 방지**(주기적 강제), 감사 추적 용이.

> 도메인 전역 영향 → **스코프 제한 OU/링크** + 파일럿 후 확산.

---

## 15. 실전 시나리오

### 시나리오 A — “경로 인용 누락 + 상위 폴더 쓰기 가능”
**증상**: 7045 이후 비정상 바이너리 실행, 포렌식 결과 `C:\Program Files\Vendor\bin\svc.exe`가 인용 없음.  
**조치**:  
1) `PathName` 인용 보정, 상위 `C:\Program Files\Vendor\bin` ACL에서 Users/Everyone **Write 제거**  
2) 서비스 SDDL에서 AU/WD 변경 권한 제거  
3) 7040/7045/4697/4657 룰 강화, 동일 패턴 스캔 전개

### 시나리오 B — “svchost ServiceDLL 하이재킹”
**증상**: 특정 서비스의 ServiceDLL이 `C:\ProgramData\App\lib\svc.dll`(사용자 쓰기 가능)을 가리킴.  
**조치**:  
1) ServiceDLL을 **보호된 시스템 폴더**로 이관, 폴더 ACL 최소화  
2) `Parameters` 키 권한 검토(Users 쓰기 제거)  
3) Sysmon RegSet 룰 배포, 4663(파일) 감사 구간 추가

### 시나리오 C — “FailureActions 악용(프로그램 실행)”
**증상**: 7040/7045 이후 서비스 실패 시 `cmd.exe /c ...` 실행 흔적.  
**조치**:  
1) FailureActions를 **restart**만 허용하게 재설정  
2) 서비스 실행 계정·권한 재검토(SeImpersonate 제거)  
3) GPO System Services로 고정

---

## 16. 배포 템플릿(예제) — 안전한 신규 서비스 등록

```powershell
# 1. 서비스 등록(Own Process), 인용 포함
New-Service -Name "MyApp" -BinaryPathName "`"C:\Program Files\MyApp\app.exe`" --run" `
  -DisplayName "My Application Service" -StartupType Automatic

# 2. 실행 계정 최소화(LocalService), Service SID 활성화
sc.exe config MyApp obj= "NT AUTHORITY\LocalService" password= ""
sc.exe sidtype MyApp unrestricted

# 3. 서비스 전용 데이터 폴더 ACL
New-Item -ItemType Directory -Path "C:\ProgramData\MyApp" -Force | Out-Null
icacls "C:\ProgramData\MyApp" /inheritance:r
icacls "C:\ProgramData\MyApp" /grant "NT SERVICE\MyApp:(OI)(CI)M" "SYSTEM:(OI)(CI)F" "Administrators:(OI)(CI)F"

# 4. 필요 권한만(Privileges) 선언
sc.exe privs MyApp SeChangeNotifyPrivilege/SeIncreaseWorkingSetPrivilege

# 5. 복구 정책(재시작만)
sc.exe failure MyApp reset= 86400 actions= restart/60000/restart/60000/""/0

# 6. 방화벽 규칙 서비스 바인딩
New-NetFirewallRule -DisplayName "MyApp Inbound 8080" -Direction Inbound -Protocol TCP -LocalPort 8080 -Service MyApp -Action Allow

# 7. SDDL(보수적) – 테스트 환경에서 검증 후 적용
sc.exe sdset MyApp "D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCLCSWRPWPDTLOCRRC;;;BA)"
```

---

## 17. 운영자 점검 스니펫 모음

```powershell
# 서비스 변경/설치 탐지(최근 1일)
$since = (Get-Date).AddDays(-1)
Get-WinEvent -FilterHashtable @{LogName='System'; ID=@(7040,7045); StartTime=$since} |
  Select TimeCreated,Id,Message

# Unquoted Path & 취약 ACL 요약
.\ServiceHardening-Audit.ps1

# ServiceDLL 경로 부적절 권한 점검(요약)
Get-ChildItem 'HKLM:\SYSTEM\CurrentControlSet\Services' |
  ForEach-Object {
    $p = Get-ItemProperty -Path "$($_.PsPath)\Parameters" -Name ServiceDll -ErrorAction SilentlyContinue
    if($p){
      $dll = $p.ServiceDll -replace '^@',''
      try {
        $acl = Get-Acl $dll
        if($acl.Access | ? { $_.IdentityReference -match 'Users|Authenticated Users|Everyone' -and $_.FileSystemRights -match 'Write|Modify|FullControl' }){
          "$($_.PSParentPath) => $dll (WEAK ACL)"
        }
      } catch {}
    }
  }

# 서비스-포트 바인딩 규칙 조회
Get-NetFirewallRule | Where-Object Service -ne $null | Select DisplayName, Service, Direction, Enabled
```

---

## 18. 체크리스트(운영 증적 중심)

- [ ] **ImagePath 인용**(공백 포함 경로는 반드시 `"`).  
- [ ] **실행 파일/폴더 ACL**: Users/AU/Everyone **쓰기 없음**(상위 폴더 포함).  
- [ ] **ServiceDLL** 경로 ACL 안전(시스템/관리자만 쓰기).  
- [ ] **실행 계정 최소화**(LocalService/NetworkService/gMSA) + **Service SID 활성화**.  
- [ ] **특권 최소화**(`sc.exe privs`로 불필요 권한 제거).  
- [ ] **FailureActions**: 재시작만, **프로그램 실행 금지**.  
- [ ] **서비스 트리거** 비필요 제거, 정기 점검.  
- [ ] **SDDL**: 변경 권한은 관리자/시스템에만.  
- [ ] **방화벽 서비스 바인딩**(필요 포트만, 특정 서비스로).  
- [ ] **이벤트/감사/Sysmon**: 7040/7045/4697/4657/13(RegSet) 수집 및 경보.  
- [ ] **GPO System Services**로 표준화, 드리프트 억제.

---

## 19. 예상문제(필기/실무)

1) *Unquoted Service Path* 취약 조건과 **수정 절차**를 기술하라.  
2) 서비스 **바이너리/폴더 ACL**에서 **반드시 제거해야 하는 ACE**와 그 이유를 설명하라.  
3) **Service SID**의 목적과 파일/레지스트리 ACL에서의 활용 방식을 예시로 설명하라.  
4) `sc.exe privs`의 활용 예를 들고, **SeImpersonatePrivilege** 제거의 보안 효과를 설명하라.  
5) **FailureActions**에서 “프로그램 실행”이 위험한 이유와 안전한 대안을 제시하라.  
6) **방화벽 서비스 바인딩**의 장점을 설명하고 PowerShell 예시를 작성하라.  
7) svchost형 서비스에서 **ServiceDLL** 하이재킹을 방지하는 2가지 방법을 쓰라.  
8) **7045/4697** 이벤트의 차이와 함께, 서비스 신규 등록을 탐지/경보하는 쿼리를 작성하라.

---

## 20. 결론

- 윈도우 **서비스 보안**은 “**실행 컨텍스트(계정/특권)** × **코드 위치(경로/ACL)** × **변경 통제(SDDL/GPO)** × **네트워크 노출(방화벽 서비스 바인딩)** × **가시성(이벤트/Sysmon)**”의 곱이다.  
- 본 문서의 **점검 스크립트/배포 템플릿/체크리스트**를 조직 표준으로 고정하면, 경로 인용 누락·취약 ACL·과다 권한·지속성 트릭 등의 **대다수 서비스 기반 침해 시나리오**를 선제 차단할 수 있다.