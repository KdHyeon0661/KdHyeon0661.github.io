---
layout: post
title: ê¸°ê³„í•™ìŠµ - í‰ê· , ë¶„ì‚°, í‘œì¤€í¸ì°¨, ìƒê´€ê´€ê³„
date: 2025-08-14 18:20:23 +0900
category: ê¸°ê³„í•™ìŠµ
---
# í‰ê· , ë¶„ì‚°, í‘œì¤€í¸ì°¨, ìƒê´€ê´€ê³„

## 1. í‰ê· (Mean)

### 1.1 ì •ì˜ì™€ í•´ì„
- í‘œë³¸ í‰ê· (ì¤‘ì‹¬ ê²½í–¥ì„±):
$$
\bar{x}=\frac{1}{n}\sum_{i=1}^n x_i
$$
- **ìµœì í™” ê´€ì :** í‰ê· ì€ **ì œê³±ì†ì‹¤**ì„ ìµœì†Œí™”í•˜ëŠ” ê°’. ì¦‰,
$$
\bar{x}=\arg\min_m \sum_{i=1}^n (x_i-m)^2
$$

### 1.2 ê°€ì¤‘ í‰ê· (Weighted Mean)
- ê°€ì¤‘ì¹˜ \(w_i\ge 0\), \(\sum w_i=1\):
$$
\mu_w=\sum_{i=1}^n w_i x_i
$$

### 1.3 ê²°í•© í‰ê· (ë‘ ê·¸ë£¹ í•©ì¹˜ê¸°)
- ê·¸ë£¹ A(í‰ê·  \(\bar{x}_A\), í¬ê¸° \(n_A\)), B(í‰ê·  \(\bar{x}_B\), í¬ê¸° \(n_B\)):
$$
\bar{x}_{A\cup B}=\frac{n_A\bar{x}_A+n_B\bar{x}_B}{n_A+n_B}
$$

### 1.4 ì‹¤ì „ íŒ
- í‰ê· ì€ **ì´ìƒì¹˜ì— ë¯¼ê°**. ë¶„í¬ê°€ ë¹„ëŒ€ì¹­/ê¼¬ë¦¬ ë‘êº¼ìš¸ ë•ŒëŠ” **ì¤‘ì•™ê°’**, **íŠ¸ë¦¬ë° í‰ê· ** ê³ ë ¤.

```python
import numpy as np

x = np.array([2,4,6,8,10,1000])  # ì´ìƒì¹˜
print("í‰ê· :", x.mean())
print("ì¤‘ì•™ê°’:", np.median(x))
# 20% íŠ¸ë¦¬ë° í‰ê· 
trim = np.sort(x)[int(0.2*len(x)): -int(0.2*len(x)) or None].mean()
print("íŠ¸ë¦¬ë° í‰ê· (20%):", trim)
```

---

## 2. ë¶„ì‚°(Variance)ê³¼ í‘œì¤€í¸ì°¨(Standard Deviation)

### 2.1 ì •ì˜
- **í‘œë³¸ ë¶„ì‚°(ë¶ˆí¸ì¶”ì •):**
$$
s^2=\frac{1}{n-1}\sum_{i=1}^n (x_i-\bar{x})^2
$$
- **í‘œì¤€í¸ì°¨:**
$$
s=\sqrt{s^2}
$$
- **ëª¨ë¶„ì‚°(ëª¨ì§‘ë‹¨):** \(\sigma^2=\frac{1}{N}\sum (x_i-\mu)^2\)

> **Bessel ë³´ì •:** í‘œë³¸ìœ¼ë¡œ ëª¨ë¶„ì‚°ì„ ì¶”ì •í•  ë•Œ \(n\) ëŒ€ì‹  \(n-1\)ì„ ì‚¬ìš©í•˜ë©´ **ê¸°ëŒ“ê°’ì´ ëª¨ë¶„ì‚°ê³¼ ì¼ì¹˜**(ë¶ˆí¸).

### 2.2 ë¶„ì‚°ì˜ ì„±ì§ˆ(ìì£¼ ì“°ëŠ” ë“±ì‹)
- ì„ í˜•ë³€í™˜: \(\mathrm{Var}(aX+b)=a^2\mathrm{Var}(X)\)
- ë¶„í•´: \( \mathrm{Var}(X)=E[X^2]-E[X]^2 \)
- í•©ì˜ ë¶„ì‚°: \(\mathrm{Var}(X+Y)=\mathrm{Var}(X)+\mathrm{Var}(Y)+2\mathrm{Cov}(X,Y)\)

### 2.3 ê²°í•© ë¶„ì‚°(ë‘ ê·¸ë£¹ í•©ì¹˜ê¸°; Pooled)
- ê·¸ë£¹ A,Bì˜ ê²°í•© í‘œë³¸ë¶„ì‚°:
$$
s^2_{A\cup B}=\frac{(n_A-1)s_A^2+(n_B-1)s_B^2+\frac{n_A n_B}{n_A+n_B}(\bar{x}_A-\bar{x}_B)^2}{n_A+n_B-1}
$$
(ë§ˆì§€ë§‰ í•­ì€ **ì§‘ë‹¨ ê°„ í‰ê· ì°¨**ë¡œ ì¸í•œ ë¶„ì‚° ì¦ê°€)

### 2.4 ìˆ˜ì¹˜ì•ˆì •ê³¼ ìŠ¤íŠ¸ë¦¬ë° ê³„ì‚° (Welford)
- í° \(x\)ì—ì„œ \(E[X^2]-E[X]^2\)ëŠ” **ì†Œìˆ˜ì  ì†Œì‹¤** ìœ„í—˜. â†’ **Welford** ì•Œê³ ë¦¬ì¦˜ ê¶Œì¥.

```python
def welford(iterable):
    n, mean, M2 = 0, 0.0, 0.0
    for x in iterable:
        n += 1
        delta = x - mean
        mean += delta/n
        M2 += delta*(x - mean)
    if n < 2: return float('nan'), float('nan')
    variance = M2/(n-1)
    return mean, variance

# í…ŒìŠ¤íŠ¸
import numpy as np
x = np.random.default_rng(0).normal(1e9, 1e3, size=10_000)
m, v = welford(x)
print("Welford í‰ê· /ë¶„ì‚°:", m, v)
```

---

## 3. ê³µë¶„ì‚°(Covariance)ê³¼ ìƒê´€(Correlation)

### 3.1 ê³µë¶„ì‚°
- **í‘œë³¸ ê³µë¶„ì‚°(ë¶ˆí¸):**
$$
\mathrm{Cov}(X,Y)=\frac{1}{n-1}\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})
$$

### 3.2 í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜(ì„ í˜• ìƒê´€)
- **ì •ì˜:**
$$
r=\frac{\mathrm{Cov}(X,Y)}{s_X s_Y}
$$
- ë²”ìœ„: \([-1,1]\); **ì´ë™Â·ìŠ¤ì¼€ì¼ ë¶ˆë³€**(í‰í–‰ì´ë™/ì–‘ì˜ë°°ìœ¨ì— ì˜í–¥ ì—†ìŒ).
- **í•´ì„:** í¬ê¸°=ì„ í˜• ê²°í•© ê°•ë„, ë¶€í˜¸=ë°©í–¥.

### 3.3 í‘œë³¸ ê³µì‹(ê³„ì‚°í˜•)
$$
r=\frac{\sum (x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum (x_i-\bar{x})^2}\sqrt{\sum (y_i-\bar{y})^2}}
$$

### 3.4 ìŠ¤í”¼ì–´ë§Œ(ìˆœìœ„ ìƒê´€), ì¼„ë‹¬(ìˆœìœ„ ì¼ì¹˜)
- **ìŠ¤í”¼ì–´ë§Œ \(\rho\):** ê°’ ëŒ€ì‹  **ìˆœìœ„**ì— í”¼ì–´ìŠ¨ ì ìš© â†’ **ë‹¨ì¡° ê´€ê³„** ê°ì§€Â·ì´ìƒì¹˜ ê²¬ê³ .
- **ì¼„ë‹¬ \(\tau\):** ìˆœì„œìŒ ì¼ì¹˜/ë¶ˆì¼ì¹˜ ê¸°ë°˜.

```python
import numpy as np
from scipy.stats import pearsonr, spearmanr, kendalltau

rng = np.random.default_rng(42)
x = rng.uniform(-3,3,400)
y_lin = 2*x + rng.normal(0,0.5,400)
y_nlin = x**2 + rng.normal(0,0.5,400)  # ë¹„ì„ í˜• ë‹¨ì¡°X

print("ì„ í˜•ê´€ê³„ Pearson:", pearsonr(x,y_lin)[0])
print("ë¹„ì„ í˜• Pearson:", pearsonr(x,y_nlin)[0])  # ~0 ê·¼ì²˜ ê°€ëŠ¥
print("ë¹„ì„ í˜• Spearman:", spearmanr(x,y_nlin)[0])  # ë‹¨ì¡°ì„± ì¼ë¶€ í¬ì°©
print("ë¹„ì„ í˜• Kendall :", kendalltau(x,y_nlin)[0])
```

### 3.5 ë¶€ë¶„ìƒê´€(Partial Correlation)
- ì œ3ë³€ìˆ˜ \(Z\)ì˜ ì„ í˜• íš¨ê³¼ë¥¼ ì œê±°í•œ \(X\)â€“\(Y\) ìƒê´€.
- ì‹¤ë¬´ êµ¬í˜„: **ì”ì°¨ ìƒê´€**(ë‘ íšŒê·€ì˜ ì”ì°¨ ìƒê´€ê³„ìˆ˜).

```python
import numpy as np
from numpy.linalg import lstsq

def residualize(y, Z):
    Z = np.c_[np.ones(len(Z)), Z]  # ì ˆí¸
    beta, *_ = lstsq(Z, y, rcond=None)
    return y - Z @ beta

# X,Yì—ì„œ Z(ë‹¤ì°¨ì›) ì˜í–¥ ì œê±° í›„ Pearson
def partial_corr(X, Y, Z):
    rx = residualize(X, Z); ry = residualize(Y, Z)
    r = np.corrcoef(rx, ry)[0,1]
    return r

# ì˜ˆì‹œ
rng = np.random.default_rng(1)
n=500
Z = rng.normal(size=(n,2))
X = 0.8*Z[:,0] + rng.normal(size=n)
Y = 0.8*Z[:,0] + rng.normal(size=n)
print("ë‹¨ìˆœ ìƒê´€:", np.corrcoef(X,Y)[0,1])
print("ë¶€ë¶„ ìƒê´€(Z ì œê±°):", partial_corr(X,Y,Z))
```

---

## 4. ìƒê´€ì˜ ì‹ ë¢°êµ¬ê°„ê³¼ ìœ ì˜ì„± â€” Fisher z ë³€í™˜

### 4.1 Fisher z
- í‘œë³¸ ìƒê´€ \(r\)ì˜ ê·¼ì‚¬ ì •ê·œí™”:
$$
z=\frac{1}{2}\ln\frac{1+r}{1-r}=\mathrm{arctanh}(r),\qquad \mathrm{SE}(z)\approx\frac{1}{\sqrt{n-3}}
$$
- \(100(1-\alpha)\%\) **ì‹ ë¢°êµ¬ê°„**:
$$
[z_L,z_U]=z \pm z_{1-\alpha/2}\cdot \frac{1}{\sqrt{n-3}},\quad
[r_L,r_U]=[\tanh(z_L),\tanh(z_U)]
$$

```python
import numpy as np
from scipy.stats import norm

def corr_ci(r, n, alpha=0.05):
    z = np.arctanh(r)
    se = 1/np.sqrt(n-3)
    z_crit = norm.ppf(1-alpha/2)
    lo, hi = z - z_crit*se, z + z_crit*se
    return np.tanh(lo), np.tanh(hi)

r, n = 0.35, 120
print("CI for r:", corr_ci(r, n))
```

---

## 5. í‘œì¤€í™”(z-score)Â·ì½”ì‚¬ì¸ ìœ ì‚¬ë„Â·\(R^2\)ì™€ì˜ ì—°ê²°

### 5.1 z-score í‘œì¤€í™”
- \(z=(x-\bar{x})/s\). **ìƒê´€**ì€ ë‘ ë³€ìˆ˜ì˜ z-scoreì˜ **(nâˆ’1)ë¶„ëª¨ í‰ê·  ë‚´ì **:
$$
r=\frac{1}{n-1}\sum_{i=1}^n z_{x,i}\,z_{y,i}
$$

### 5.2 ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì™€ ì°¨ì´
- ì½”ì‚¬ì¸: \(\cos\theta=\frac{x\cdot y}{\|x\|\|y\|}\) (í‰ê·  ì¤‘ì‹¬í™” **ì—†ìŒ**).
- ìƒê´€ì€ **í‰ê· ì„ ì œê±°**í•˜ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ” â†’ ìœ„ì¹˜ ì´ë™Â·ìŠ¤ì¼€ì¼ ë³€í™”ì— ë¶ˆë³€.

### 5.3 ë‹¨ìˆœíšŒê·€ì—ì„œ \(R^2=r^2\)
- í•œ ì„¤ëª…ë³€ìˆ˜ \(X\)ë¡œ \(Y\)ë¥¼ ì„ í˜• íšŒê·€í•˜ë©´ ê²°ì •ê³„ìˆ˜:
$$
R^2 = r_{XY}^2
$$

---

## 6. ê²¬ê³  í†µê³„(ì´ìƒì¹˜ì— ê°•í•œ ëŒ€ì•ˆ)

### 6.1 ëŒ€ì²´ í†µê³„ëŸ‰
- **ì¤‘ì•™ê°’**, **MAD**(ì¤‘ìœ„ì ˆëŒ€í¸ì°¨):
$$
\mathrm{MAD}=\mathrm{median}(|x_i-\mathrm{median}(x)|)
$$
- **ìŠ¤í”¼ì–´ë§Œ/ì¼„ë‹¬ ìƒê´€**: ì´ìƒì¹˜ ì˜í–¥ ì™„í™”.
- **Winsorization/Trimming**: ê¼¬ë¦¬ ì ˆì‚­/ì ˆë‹¨.

```python
import numpy as np
from scipy.stats import median_abs_deviation, spearmanr

x = np.array([1,2,2,2,3,100])
print("í‰ê· /í‘œì¤€í¸ì°¨:", x.mean(), x.std(ddof=1))
print("ì¤‘ì•™ê°’/MAD:", np.median(x), median_abs_deviation(x, scale='normal'))
print("ìŠ¤í”¼ì–´ë§Œ ìƒê´€(ìê¸°ìì‹ ):", spearmanr(x, np.sort(x)).correlation)
```

---

## 7. ìƒê´€í–‰ë ¬Â·ê³µë¶„ì‚°í–‰ë ¬

### 7.1 ì •ì˜
- **ê³µë¶„ì‚°í–‰ë ¬** \( \Sigma\in\mathbb{R}^{d\times d} \): \(\Sigma_{jk}=\mathrm{Cov}(X_j,X_k)\)
- **ìƒê´€í–‰ë ¬** \(R\): \(R_{jk}=\Sigma_{jk}/\sqrt{\Sigma_{jj}\Sigma_{kk}}\)

### 7.2 ê³„ì‚° ì£¼ì˜
- `numpy.cov` ê¸°ë³¸ `ddof=0`(ëª¨ì§‘ë‹¨) ì•„ë‹˜? â†’ ì‹¤ì œ ê¸°ë³¸ì€ `bias=False`ë¡œ **\(n-1\)**.
- `pandas.DataFrame.cov()`ë„ ê¸°ë³¸ **\(n-1\)**.

```python
import numpy as np, pandas as pd
rng = np.random.default_rng(0)
X = pd.DataFrame(rng.normal(size=(100,3)), columns=list("ABC"))
print("ê³µë¶„ì‚°í–‰ë ¬:\n", X.cov())       # ddof=1
print("ìƒê´€í–‰ë ¬:\n", X.corr())
```

---

## 8. ì˜ˆì œ ì‹œë‚˜ë¦¬ì˜¤ â€” ë¶„í¬ íŒŒì•… â†’ ì „ì²˜ë¦¬ â†’ ìƒê´€ ì§„ë‹¨

```python
import numpy as np, pandas as pd
from scipy.stats import spearmanr, kendalltau

rng = np.random.default_rng(0)
n=400
height = rng.normal(172, 7, n)
weight = 0.45*(height-172) + rng.normal(0,3,n) + 68
salary = np.exp(0.01*height + rng.normal(0,0.15,n))*1000  # ì–‘ì˜ ì™œë„(ë¡œê·¸ì •ê·œ)
weight[::50] += 25  # ì´ìƒì¹˜ ëª‡ ê°œ

df = pd.DataFrame({"height":height, "weight":weight, "salary":salary})

# ê¸°ìˆ  í†µê³„
desc = df.describe().T[["mean","std","min","25%","50%","75%","max"]]
print(desc)

# ìŠ¤ì¼€ì¼ë§ ì „ ìƒê´€
pear = df.corr(numeric_only=True)
print("\ní”¼ì–´ìŠ¨ ìƒê´€:\n", pear)

# ë¡œê·¸ ë³€í™˜ìœ¼ë¡œ salary ì™œë„ ì™„í™”
df["log_salary"] = np.log(df["salary"])
print("\nsalary-ë¡œê·¸ í›„ í”¼ì–´ìŠ¨:\n", df[["height","weight","log_salary"]].corr(numeric_only=True))

# ìˆœìœ„ ìƒê´€
print("\nìŠ¤í”¼ì–´ë§Œ ìƒê´€(heightâ†”salary):", spearmanr(df["height"], df["salary"]).correlation)
print("ì¼„ë‹¬ ìƒê´€(heightâ†”salary):", kendalltau(df["height"], df["salary"]).correlation)
```

> **í•´ì„ ê°€ì´ë“œ**
> - `salary`ëŠ” ë¡œê·¸ì •ê·œ â†’ ì› ê°’ìœ¼ë¡œ í”¼ì–´ìŠ¨ ìƒê´€ì´ ì™œê³¡ë  ìˆ˜ ìˆìŒ â†’ **ë¡œê·¸ ë³€í™˜ í›„** ìƒê´€ í•´ì„.
> - ì´ìƒì¹˜(ì²´ì¤‘)ì— ì˜í•´ heightâ€“weight í”¼ì–´ìŠ¨ì´ í”ë“¤ë¦´ ê²½ìš° **ìŠ¤í”¼ì–´ë§Œ**ìœ¼ë¡œ ê²€í† .
> - ìƒê´€ì€ **ì¸ê³¼**ê°€ ì•„ë‹˜(ì ì¬ë³€ìˆ˜Â·ì„¸ê·¸ë¨¼íŠ¸ ì²´í¬, ë¶€ë¶„ìƒê´€/ê³„ì¸µí™”).

---

## 9. ì§‘ì¤‘ ìš”ì•½ í‘œ

| ê°œë… | ì •ì˜(í‘œë³¸) | íŠ¹ì§•/ì£¼ì˜ | ì‹¤ì „ í¬ì¸íŠ¸ |
|---|---|---|---|
| í‰ê·  \(\bar{x}\) | \( \frac{1}{n}\sum x_i \) | ì´ìƒì¹˜ ë¯¼ê° | L2 ìµœì í™”ì˜ minimizer |
| ë¶„ì‚° \(s^2\) | \( \frac{1}{n-1}\sum (x_i-\bar{x})^2 \) | ë‹¨ìœ„ ì œê³±, Bessel | Welfordë¡œ ìˆ˜ì¹˜ì•ˆì • |
| í‘œì¤€í¸ì°¨ \(s\) | \( \sqrt{s^2} \) | ì› ë‹¨ìœ„ | ìŠ¤ì¼€ì¼ ë¹„êµ ìš©ì´ |
| ê³µë¶„ì‚° | \( \frac{1}{n-1}\sum (x-\bar{x})(y-\bar{y}) \) | ë‹¨ìœ„ ì˜ì¡´ | ìƒê´€ ì „ ë‹¨ê³„ |
| í”¼ì–´ìŠ¨ \(r\) | \( \frac{\mathrm{Cov}(X,Y)}{s_X s_Y} \) | ì„ í˜•/ì´ìƒì¹˜ ë¯¼ê° | ë‹¨ì¡°/ë¹„ì„ í˜•ì€ ìŠ¤í”¼ì–´ë§Œ/ì¼„ë‹¬ |
| ìŠ¤í”¼ì–´ë§Œ \(\rho\) | rankì— Pearson | ë‹¨ì¡°Â·ê²¬ê³  | ìˆœìœ„ ê¸°ë°˜ ì „ì²˜ë¦¬ |
| ì¼„ë‹¬ \(\tau\) | ìˆœì„œìŒ ì¼ì¹˜/ë¶ˆì¼ì¹˜ | í‘œë³¸ì‘ì„ ë•Œ ê°•ì  | í•´ì„ ì§ê´€ì  |
| ë¶€ë¶„ìƒê´€ | ì”ì°¨ì˜ ìƒê´€ | êµë€ë³€ìˆ˜ ì œì–´ | ì„¸ê·¸ë¨¼íŠ¸Â·ì ì¬ë³€ìˆ˜ í†µì œ |
| ìƒê´€ CI | Fisher z | \(n\ge 10\) ê·¼ì‚¬ | íš¨ê³¼í¬ê¸°+ë¶ˆí™•ì‹¤ì„± ë³´ê³  |

---

## 10. FAQ Â· ë¹ˆì¶œ ì‹¤ìˆ˜

1) **ì™œ \(n\) ëŒ€ì‹  \(n-1\)ì¸ê°€?**
í‘œë³¸í‰ê· ì„ ì‚¬ìš©í•˜ë©´ ë¶„ì‚° ì¶”ì •ì— **í•˜ë‚˜ì˜ ììœ ë„ ì†Œëª¨** â†’ \(n-1\)ë¡œ ë³´ì •í•˜ë©´ ë¶ˆí¸.

2) **ìƒê´€ì´ 0ì´ë©´ ê´€ê³„ê°€ ì—†ë‹¤?**
í”¼ì–´ìŠ¨ 0ì€ **ì„ í˜• ê´€ê³„ ì—†ìŒ**ì¼ ë¿. **ë¹„ì„ í˜•**ì¼ ìˆ˜ ìˆìŒ(ì˜ˆ: \(Y=X^2\)) â†’ ìˆœìœ„ ìƒê´€/ì»¤ë„ ë°©ë²• ê²€í† .

3) **ì½”ì‚¬ì¸ê³¼ ìƒê´€ì˜ ì°¨ì´?**
ì½”ì‚¬ì¸ì€ **í‰ê·  ì¤‘ì‹¬í™” ì—†ì´** ê°ë„ë§Œ, ìƒê´€ì€ **ì¤‘ì‹¬í™”+í‘œì¤€í™”** â†’ ìœ„ì¹˜Â·ìŠ¤ì¼€ì¼ ë¶ˆë³€.

4) **í‘œì¤€í™”ëŠ” ê¼­ í•´ì•¼ í•˜ë‚˜?**
ìƒê´€ì€ ìŠ¤ì¼€ì¼ ë¶ˆë³€ì´ì§€ë§Œ, **íšŒê·€/ê±°ë¦¬ ê¸°ë°˜ ëª¨ë¸**ì€ í‘œì¤€í™”ê°€ í•„ìš”.

---

## 11. ì‹¤ë¬´ ìœ í‹¸ í•¨ìˆ˜ ëª¨ìŒ

```python
import numpy as np
from numpy.linalg import lstsq
from scipy.stats import norm, spearmanr, kendalltau

def trimmed_mean(x, prop=0.1):
    x = np.sort(np.asarray(x))
    k = int(prop*len(x))
    return x[k: len(x)-k or None].mean()

def welford_mean_var(x):
    n=0; mean=0.0; M2=0.0
    for xi in x:
        n+=1; d = xi-mean; mean += d/n; M2 += d*(xi-mean)
    return mean, M2/(n-1)

def pearson_r(x,y):
    x = np.asarray(x); y = np.asarray(y)
    xc = x - x.mean(); yc = y - y.mean()
    return (xc@yc)/np.sqrt((xc@xc)*(yc@yc))

def fisher_ci_r(r, n, alpha=0.05):
    z = np.arctanh(r); se = 1/np.sqrt(n-3); zc = norm.ppf(1-alpha/2)
    lo, hi = z - zc*se, z + zc*se
    return np.tanh(lo), np.tanh(hi)

def partial_corr_xy_given_Z(x, y, Z):
    Z = np.c_[np.ones(len(Z)), Z]
    bx,_res,_,_ = lstsq(Z, x, rcond=None); by,_,_,_ = lstsq(Z, y, rcond=None)
    rx = x - Z@bx; ry = y - Z@by
    return pearson_r(rx, ry)

def corr_matrix(df):
    return df.corr(numeric_only=True)
```

---

## ğŸ“Œ ì •ë¦¬
1. **í‰ê· â€“ë¶„ì‚°â€“í‘œì¤€í¸ì°¨**ëŠ” ë¶„í¬ì˜ ì¤‘ì‹¬ê³¼ í¼ì§ì„ ìš”ì•½í•˜ë©°, í‰ê· ì€ L2 ê¸°ì¤€ ìµœì ì˜ ëŒ€í‘œê°’ì´ë‹¤.
2. **ê³µë¶„ì‚°â€“ìƒê´€**ì€ ë‘ ë³€ìˆ˜ì˜ ê³µë™ ë³€ë™ì„ ì¸¡ì •í•œë‹¤. í”¼ì–´ìŠ¨ì€ ì„ í˜•, ìŠ¤í”¼ì–´ë§Œ/ì¼„ë‹¬ì€ ë‹¨ì¡°Â·ê²¬ê³ .
3. **Bessel ë³´ì •, Welford**ë¡œ ì •í™•í•˜ê³  ì•ˆì •ì ì¸ ë¶„ì‚° ê³„ì‚°ì„ ìŠµê´€í™”í•˜ë¼.
4. ìƒê´€ì—ëŠ” **ì‹ ë¢°êµ¬ê°„(Fisher z)**ì„ í•¨ê»˜ ë³´ê³ í•˜ê³ , **ë¶€ë¶„ìƒê´€**ìœ¼ë¡œ êµë€ì„ í†µì œí•˜ë¼.
5. **ìƒê´€ â‰  ì¸ê³¼**. í•„ìš”í•˜ë©´ ì‹¤í—˜Â·ê³„ì¸µí™”Â·ë¶€ë¶„ìƒê´€Â·ë„êµ¬ë³€ìˆ˜ ë“± ì¸ê³¼ì  ëŒ€ë¹„ë¥¼ ê³ ë ¤í•˜ë¼.
