---
layout: post
title: 미적분 - 반복적분
date: 2025-08-12 20:20:23 +0900
category: 미적분
---
# 반복적분(Repeated / Iterated Integrals)

> **핵심 한 줄**
> 다중적분은 **단일변수 적분의 반복**으로 계산할 수 있고(반복적분), 그 정당성은 **Fubini–Tonelli 정리**가 보장한다. 영역의 기하를 **타입 I/II**로 쪼개고, 필요하면 **적분 순서를 바꾸거나 좌표변환**(극·원통·구면)으로 단순화한다.

---

## 용어·표기

- 다중적분: \(\iint_R f(x,y)\,dA\), \(\iiint_\Omega f(x,y,z)\,dV\) 등.
- 반복적분(또는 반복하여 계산한 적분, iterated integrals):
  $$
  \iint_R f(x,y)\,dA
  \;=\;
  \int_{x=x_1}^{x_2}\,\left(\,\int_{y=\alpha(x)}^{\beta(x)} f(x,y)\,dy\right)dx
  \quad\text{혹은}\quad
  \int_{y=y_1}^{y_2}\,\left(\,\int_{x=\gamma(y)}^{\delta(y)} f(x,y)\,dx\right)dy.
  $$

---

## 반복적분의 정의와 직사각형에서의 기본 성질

### 직사각형 영역에서의 반복적분

직사각형 \(R=[a,b]\times[c,d]\) 위에서
$$
I \;=\; \iint_R f(x,y)\,dA
=\int_a^b\int_c^d f(x,y)\,dy\,dx
=\int_c^d\int_a^b f(x,y)\,dx\,dy
$$
가 성립하려면 \(f\)가 적절한 의미에서 “적분 가능”이어야 한다. Riemann 문맥에서는 조각연속(piecewise continuous) 정도가 충분한 충분조건, Lebesgue 문맥에선 Tonelli/Fubini가 일반적 기준을 준다.

### Fubini–Tonelli 정리(개요)

- **Tonelli (비음이 아닌 함수)**: \(f\ge 0\) 가 가측이면
  $$
  \int\!\!\int f\,dA
  =\int\left(\int f\,dy\right)dx
  =\int\left(\int f\,dx\right)dy
  $$
  이며, 값은 \([0,\infty]\) 내에서 같다.
- **Fubini (절대적분가능)**: \(\iint |f|\,dA<\infty\) 이면 반복적분 가능하고 순서교환 가능.
- **주의(조건수렴)**: \(|f|\)가 적분가능이 아니면 반복적분 값이 서로 다르거나 발산할 수도 있다(조건수렴의 함정).

> 실전 요약: **비음함수**거나 **절대적분가능(\(\iint |f|<\infty\))**이면 순서바꿈 안전.

---

## — 타입 I/II 분할

### 타입 I / 타입 II

- **타입 I (x-먼저)**:
  $$
  R=\{(x,y): a\le x\le b,\;\alpha(x)\le y\le \beta(x)\}
  $$
  이면
  $$
  \iint_R f\,dA=\int_a^b\left(\int_{\alpha(x)}^{\beta(x)} f(x,y)\,dy\right)dx.
  $$
- **타입 II (y-먼저)**:
  $$
  R=\{(x,y): c\le y\le d,\;\gamma(y)\le x\le \delta(y)\}
  $$
  이면
  $$
  \iint_R f\,dA=\int_c^d\left(\int_{\gamma(y)}^{\delta(y)} f(x,y)\,dx\right)dy.
  $$

### 일반 영역의 분할

복잡한 \(R\)은 타입 I 또는 II로 **여러 조각** \(R=\bigcup_k R_k\) 으로 쪼갠 뒤 합:
$$
\iint_R f\,dA=\sum_k \iint_{R_k} f\,dA.
$$
부호·특이점·불연속이 있으면 가능하면 **절대적분가능성**을 확인하거나, 특이점 주변을 별도 조각으로 다뤄야 한다.

---

## 적분 순서 바꾸기(변경 알고리즘)

### 기하적 알고리즘(2D)

1. 원래 반복적분의 **내부 변수**(예: \(y\))의 범위를 **그린다**.
2. 해당 범위의 상·하(또는 좌·우) 경계를 식으로 확인한다.
3. **영역을 \(y\)-먼저 → \(x\)-먼저**(또는 반대로) 재기술한다.
4. 필요하면 영역을 부분들로 나누어 각각의 경계함수를 정리한다.

### 대표 예제 — 순서 바꾸기

다음 반복적분:
$$
I=\int_{x=0}^{2}\left(\int_{y=x}^{2x} (x+2y)\,dy\right)dx.
$$
영역은 \(0\le x\le 2,\ x\le y\le 2x\). 이를 \(y\)-먼저로 표현:
- \(y\) 범위는 \(0\le y\le 4\) (최소는 \(x=0\Rightarrow y=0\), 최대는 \(x=2\Rightarrow y\le 4\)).
- 주어진 \(y\)에서 \(x\)는 \(y\le 2x\Rightarrow x\ge \frac{y}{2}\), 또 \(x\le y\Rightarrow x\le y\).
  또한 전체 \(x\) 상한이 2이므로 \(x\le \min(y,2)\).
- 실제로 \(y\in[0,2]\)이면 \(x\in[y/2,\,y]\), \(y\in[2,4]\)이면 \(x\in[y/2,\,2]\).
따라서
$$
I=\int_{y=0}^{2}\int_{x=y/2}^{y}(x+2y)\,dx\,dy
+\int_{y=2}^{4}\int_{x=y/2}^{2}(x+2y)\,dx\,dy.
$$
이처럼 **두 조각**으로 나눠 순서를 바꾸었다.

---

## 예제들: 타입·순서교환·검산

### 기본 — 직사각형에서 다항함수

$$
I=\int_0^1\int_0^2 (x^2+xy+1)\,dy\,dx.
$$
내부 적분:
$$
\int_0^2 (x^2+xy+1)\,dy= x^2 y+\frac{x}{2}y^2+y\Big|_{0}^{2}
=2x^2+\frac{x}{2}\cdot 4+2=2x^2+2x+2.
$$
바깥 적분:
$$
\int_0^1 (2x^2+2x+2)\,dx=\frac{2}{3}+1+2=\frac{11}{3}.
$$

### — 포물선 사이 넓이 적분

영역 \(R=\{(x,y): 0\le x\le 1,\ x^2\le y\le \sqrt{x}\}\).
면적:
$$
A=\iint_R 1\,dA=\int_0^1\left(\int_{x^2}^{\sqrt{x}} 1\,dy\right)dx=\int_0^1 \left(\sqrt{x}-x^2\right)\,dx
=\left(\frac{2}{3}x^{3/2}-\frac{1}{3}x^3\right)_0^1=\frac{2}{3}-\frac{1}{3}=\frac{1}{3}.
$$
**순서 교환**을 연습해보자. \(y\)-먼저:
- 곡선 \(y=x^2\Rightarrow x=\sqrt{y}\), \(y=\sqrt{x}\Rightarrow x=y^2\).
- \(y\) 범위: \(y\in[0,1]\).
- 고정 \(y\)에서 \(x\)는 \(y^2\le x\le \sqrt{y}\).
따라서
$$
A=\int_{y=0}^{1}\left(\int_{x=y^2}^{\sqrt{y}} 1\,dx\right)dy=\int_0^1(\sqrt{y}-y^2)\,dy=\frac{1}{3}.
$$
일치 확인.

### 적분 순서 교환의 이점 — 내부가 쉬운 쪽 선택

$$
I=\int_{x=0}^{1}\left(\int_{y=0}^{x} e^{y^2}\,dy\right)dx.
$$
내부 \(\int e^{y^2}dy\)는 원시함수 없음. **순서 교환**:
- 영역: \(0\le y\le x\le 1\) ↔ \(0\le y\le 1\), \(y\le x\le 1\).
$$
I=\int_{y=0}^{1}\left(\int_{x=y}^{1} e^{y^2}\,dx\right)dy
=\int_0^1 e^{y^2}(1-y)\,dy,
$$
여전히 닫힌형은 없지만, **내부가 상수**가 되어 수치적분·급수 근사가 한결 쉽다(또는 \(\text{erfi}\)로 표현).

---

## 포인트

### 절대적분가능성의 힘

\(\iint |f|<\infty\)이면 Fubini로 **순서 교환이 항상 정당**하다.

### 조건수렴의 함정(스케치)

고전적 반례들처럼 적절히 진동·감소하는 함수는 반복적분 순서에 따라 값이 달라지거나, 하나는 수렴·다른 하나는 발산하는 경우가 있다.
실전 규칙: **가능하면 절대적분가능성 확인**(혹은 비음함수로 Tonelli).

### 특이점 주변 처리

- 루트/극점이 경계에 닿으면 **부등식 엄밀화**와 **영역 분할**로 improper 다중적분 정의에 맞춰야 한다.
- 정적분이라도 내부가 무한대 가능 → **극한 정의**로 접근, 또는 좌표변환으로 제거.

---

## 3중 반복적분과 좌표변환

### 직육면체

$$
\iiint_{[a,b]\times[c,d]\times[e,f]} f(x,y,z)\,dV
=\int_a^b\int_c^d\int_e^f f(x,y,z)\,dz\,dy\,dx
$$
순서 총 6가지. 절대적분가능이면 교환 가능.

### 일반영역 — 층쌓기

- **타입 z-먼저**:
  $$
  \Omega=\{(x,y,z): (x,y)\in R,\;\phi_1(x,y)\le z\le \phi_2(x,y)\}
  $$
  이면
  $$
  \iiint_\Omega f\,dV=\iint_R\left(\int_{\phi_1(x,y)}^{\phi_2(x,y)} f\,dz\right)\,dA.
  $$

### — **야코비안** 필수

- 극좌표: \(x=r\cos\theta,\ y=r\sin\theta,\ dA=r\,dr\,d\theta\).
- 원통좌표: \(x=r\cos\theta,\ y=r\sin\theta,\ z=z,\ dV=r\,dr\,d\theta\,dz\).
- 구면좌표: \(x=\rho\sin\phi\cos\theta,\ y=\rho\sin\phi\sin\theta,\ z=\rho\cos\phi,\ dV=\rho^2\sin\phi\,d\rho\,d\phi\,d\theta\).

**예**(원판 위의 \(\iint_R e^{x^2+y^2} dA\), \(R:x^2+y^2\le a^2\)):
$$
\int_0^{2\pi}\int_0^a e^{r^2}\, r\,dr\,d\theta
=2\pi\cdot \frac{1}{2}\left(e^{a^2}-1\right)=\pi\left(e^{a^2}-1\right).
$$

---

## 응용: 확률·컨볼루션·베타/감마

### 확률 — 독립성, 결합분포의 적분

확률밀도 \(f_{X,Y}\)가 절대적분가능이고, \(R\subset\mathbb{R}^2\)에서
$$
\mathbb{P}((X,Y)\in R)=\iint_R f_{X,Y}(x,y)\,dx\,dy.
$$
독립이면 \(f_{X,Y}(x,y)=f_X(x)f_Y(y)\) 로 분리되어 반복적분이 곧 곱적분.

### 컨볼루션(2D)

$$
(f*g)(x,y)=\iint f(\xi,\eta)\,g(x-\xi,y-\eta)\,d\xi\,d\eta,
$$
반복적분·순서교환을 통해 계산.

### 베타/감마와 반복적분

고전적 결과:
$$
\mathrm{B}(p,q)=\int_0^1 t^{p-1}(1-t)^{q-1}\,dt=\frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}.
$$
또한
$$
\int_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dx\,dy
= \left(\int_{-\infty}^{\infty} e^{-x^2}\,dx\right)^2=\pi,
$$
이는 극좌표 반복적분으로도 고전적으로 유도.

---

## 극한·부정형 반복적분(Improper)

### 무한영역

\(R=\mathbb{R}^2\) 등에서 \(\iint_R f\) 는
$$
\lim_{N\to\infty} \iint_{[-N,N]^2} f
$$
혹은 원판 \(B(0,N)\)로 제한 후 극한. **절대적분가능성**이 핵심.

### 특이점

경계나 내부에서 \(f\to\infty\)면 작은 구/사각형을 제거한 후 극한으로 정의:
$$
\iint_R f = \lim_{\varepsilon\to 0^+} \iint_{R\setminus U_\varepsilon} f
$$
(존재하면). 순서교환은 더 엄격 — 가급적 **Tonelli/Fubini 조건** 확인.

---

## 연습예제 — 풀이 포함

### 삼각영역에서의 다항

\(R=\{(x,y):0\le x\le 1,\ 0\le y\le 1-x\}\),
$$
I=\iint_R (x+2y)\,dA.
$$
타입 I:
$$
I=\int_0^1\int_0^{1-x}(x+2y)\,dy\,dx
=\int_0^1\left[x y+y^2\right]_{0}^{1-x}dx
=\int_0^1(x(1-x)+(1-x)^2)\,dx
=\int_0^1(1-x)\,dx=\frac{1}{2}.
$$
타입 II(검산):
\(0\le y\le 1,\ 0\le x\le 1-y\).
$$
I=\int_0^1\int_0^{1-y}(x+2y)\,dx\,dy
=\int_0^1\left[\tfrac12 x^2+2yx\right]_0^{1-y}\,dy
=\int_0^1\left(\tfrac12 (1-y)^2+2y(1-y)\right)dy=\frac{1}{2}.
$$

### 순서교환 트릭(지수 제곱)

이미 §4.3에서 다룸:
$$
\int_0^1\int_0^{x} e^{y^2}\,dy\,dx=\int_0^1 e^{y^2}(1-y)\,dy.
$$

### 원판 위의 1/√(a^2−r^2)

\(R:x^2+y^2\le a^2\),
$$
I=\iint_R \frac{1}{\sqrt{a^2-(x^2+y^2)}}\,dA.
$$
극좌표:
$$
I=\int_0^{2\pi}\int_0^a \frac{1}{\sqrt{a^2-r^2}}\,r\,dr\,d\theta.
$$
\(u=a^2-r^2\Rightarrow du=-2r\,dr\),
$$
\int_0^a \frac{r}{\sqrt{a^2-r^2}}\,dr
=\frac{1}{2}\int_{a^2}^{0} u^{-1/2}(-du)
=\frac{1}{2}\int_0^{a^2} u^{-1/2}\,du=\frac{1}{2}\cdot 2\sqrt{u}\Big|_0^{a^2}=a.
$$
따라서 \(I=2\pi a\).

---

## 실전 체크리스트

- □ **Tonelli/Fubini 조건**(비음·절대적분가능) 확인 후 순서교환.
- □ **타입 I/II**로 경계함수 정확히 쓰기.
- □ 순서교환 시 **영역분할** 필요 여부 판단.
- □ 특이점/무한영역은 **improper 정의** 준수.
- □ 좌표변환 시 **야코비안** 필수.
- □ 수치계산 시 내부가 상수/단순한 순서를 선택.

---

## 파이썬 코드 예제(심볼릭/수치)

### SymPy — 타입 I/II, 순서교환 검산

```python
import sympy as sp

x, y = sp.symbols('x y', real=True)
f = x + 2*y

# 예제 9.1: R = {(x,y): 0<=x<=1, 0<=y<=1-x}

I_typeI  = sp.integrate(sp.integrate(f, (y, 0, 1 - x)), (x, 0, 1))
I_typeII = sp.integrate(sp.integrate(f, (x, 0, 1 - y)), (y, 0, 1))
sp.simplify(I_typeI), sp.simplify(I_typeII)
```

### NumPy — 사다리꼴/몬테카를로 근사

```python
import numpy as np

def trap2_rect(f, ax, bx, ay, by, nx=400, ny=400):
    xs = np.linspace(ax, bx, nx)
    ys = np.linspace(ay, by, ny)
    X, Y = np.meshgrid(xs, ys, indexing='xy')
    Z = f(X, Y)
    hx = (bx-ax)/(nx-1)
    hy = (by-ay)/(ny-1)
    w = np.ones_like(Z)
    # 2D trapezoidal weights
    w[0,:]  *= 0.5
    w[-1,:] *= 0.5
    w[:,0]  *= 0.5
    w[:,-1] *= 0.5
    return np.sum(Z*w)*hx*hy

# 테스트: f(x,y)=x+2y on [0,1]x[0,1], exact = ∫∫ (x+2y)= [1/2 + 2*1/2] = 1.5

exact = 1.5
approx = trap2_rect(lambda X,Y: X + 2*Y, 0,1,0,1)
print(approx, "error:", abs(approx-exact))

# 몬테카를로: 삼각형 R={0<=x<=1, 0<=y<=1-x}

def mc_triangle(f, n=200000):
    count = 0
    acc = 0.0
    for _ in range(n):
        x = np.random.rand()
        y = np.random.rand()
        if y <= 1 - x:
            acc += f(x,y)
            count += 1
    # 영역 면적 1/2
    area = 0.5
    return area * (acc / count)

val = mc_triangle(lambda x,y: x + 2*y, n=20000)
print("MC on triangle:", val)
```

### 극좌표 — 원판에서의 지수

```python
import sympy as sp
r, th, a = sp.symbols('r th a', positive=True)
expr = sp.integrate(sp.integrate(sp.exp(r**2)*r, (r, 0, a)), (th, 0, 2*sp.pi))
sp.simplify(expr)  # π (e^{a^2} - 1)
```

### 순서교환으로 내부가 상수화되는 예제(수치)

```python
import mpmath as mp

# dy

f_inner = lambda y: mp.e**(y*y)
I1 = mp.quad(lambda x: mp.quad(lambda y: mp.e**(y*y), [0, x]), [0, 1])   # 직접 반복
I2 = mp.quad(lambda y: mp.e**(y*y)*(1-y), [0, 1])                        # 순서교환 후
print(I1, I2, "diff:", abs(I1-I2))
```

---

## 추가 연습문제

1) \(R=\{(x,y): 0\le x\le 2,\ x^2\le y\le 2x\}\),
   \(\iint_R (x^2+y)\,dA\). (순서교환도 수행)

2) \(R\)가 원판 \(x^2+y^2\le 1\)일 때 \(\iint_R (x^2+y^2)\,dA\). (극좌표로)

3) \(\int_0^\infty\int_0^\infty e^{-x^2-y^2}\,dx\,dy\). (곱으로 분리 vs 극좌표)

4) \(R=\{(x,y): 0\le y\le 1,\ y^2\le x\le \sqrt{y}\}\),
   \(\iint_R \frac{1}{1+x^2}\,dA\). (순서교환으로 내부 단순화)

5) 3중적분: \(\Omega=\{(x,y,z): x^2+y^2\le a^2,\ 0\le z\le \sqrt{a^2-x^2-y^2}\}\) 에서 \(\iiint_\Omega 1\,dV\).
   (반구의 부피 — 원통→극, 또는 구면좌표)

---

## 한 페이지 요약(붙여두기)

- **반복적분**: 다중적분을 **내부→외부** 순서로 1변수 적분을 반복 계산.
- **Fubini–Tonelli**: \(f\ge 0\) 또는 \(\iint |f|<\infty\)면 순서교환 OK.
- **타입 I/II**: \(y=\alpha(x)\sim\beta(x)\) 또는 \(x=\gamma(y)\sim\delta(y)\)로 경계기술.
- **순서교환 알고리즘**: 영역을 그려 범위 재기술, 필요시 분할.
- **특이점/무한영역**: improper 정의(극한), 절대적분가능성 확인.
- **좌표변환**: 극/원통/구면 + 야코비안.
- **응용**: 확률, 컨볼루션, 베타/감마, 물리적 면적·부피·질량·모멘트.

---

## 부록 A. 베타/감마의 반복적분 유도 스케치

가우스 적분:
$$
\left(\int_{-\infty}^{\infty} e^{-x^2}\,dx\right)^2
=\iint_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dA
=\int_0^{2\pi}\int_0^\infty e^{-r^2} r\,dr\,d\theta
=\pi.
$$
따라서 \(\int e^{-x^2}=\sqrt{\pi}\).
이를 바탕으로 \(\Gamma(1/2)=\sqrt{\pi}\) 등 고전 결과를 반복적분/극좌표로 깔끔하게 얻는다.

---

## 부록 B. 자주하는 실수

- 절대값 없이 **조건수렴** 함수에서 순서교환 남발.
- 영역을 그림 없이 해석하여 **경계함수**를 잘못 씀.
- 좌표변환에서 **야코비안** 누락.
- improper 상황에서 **극한 정의** 무시.

---

## 결론

반복적분은 다중적분의 실전 계산법이다. **Fubini–Tonelli**로 정당성을 확인하고, 영역을 **타입 I/II**로 쪼개거나 **순서를 바꾸기**, 더 나아가 **좌표변환**까지 구사하면, 원래 “어려워 보이던” 다중적분이 놀랄 만큼 간결해진다. 이전 글(삼각치환, 극좌표, 접평면·전미분, 벡터장의 적분)에서 강조한 **기하적 관점**을 유지하면, 반복적분의 성공 확률이 크게 높아진다.
