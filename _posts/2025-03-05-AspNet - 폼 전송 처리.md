---
layout: post
title: AspNet - í¼ ì „ì†¡ ì²˜ë¦¬
date: 2025-03-05 19:20:23 +0900
category: AspNet
---
# ğŸ“¤ Razor Pagesì—ì„œ í¼ ì „ì†¡ ì²˜ë¦¬ ì™„ì „ ì •ë³µ (`OnPost`, `RedirectToPage`)

ASP.NET Core Razor Pagesì—ì„œëŠ” `GET` ìš”ì²­ì€ `OnGet()`, `POST` ìš”ì²­ì€ `OnPost()` ë©”ì„œë“œì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤.  
í¼ ì „ì†¡ì€ ëŒ€ë¶€ë¶„ `POST` ìš”ì²­ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, **`OnPost` ë©”ì„œë“œì™€ ë¦¬ë‹¤ì´ë ‰ì…˜ íë¦„**ì„ ì œëŒ€ë¡œ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤.

---

## âœ… ê¸°ë³¸ í¼ ì²˜ë¦¬ íë¦„

1. ì‚¬ìš©ìì—ê²Œ `<form>`ì´ í¬í•¨ëœ í˜ì´ì§€ ì œê³µ (`OnGet`)
2. ì‚¬ìš©ì ì…ë ¥ í›„ ì œì¶œ (`method="post"`)
3. Razor Pageì˜ `OnPost()` ë©”ì„œë“œ í˜¸ì¶œ
4. ë°ì´í„° ê²€ì¦ (`ModelState.IsValid`)
5. ì²˜ë¦¬ ì„±ê³µ ì‹œ `RedirectToPage()`ë¡œ ì´ë™
6. ì‹¤íŒ¨ ì‹œ `Page()`ë¡œ í˜„ì¬ í¼ ë‹¤ì‹œ ë Œë”ë§

---

## ğŸ§© ê¸°ë³¸ ì˜ˆì œ

### ğŸ“„ `Pages/Contact.cshtml`

```razor
@page
@model ContactModel

<h2>ë¬¸ì˜í•˜ê¸°</h2>

<form method="post">
    <label asp-for="Message"></label>
    <textarea asp-for="Message"></textarea>
    <span asp-validation-for="Message"></span>

    <button type="submit">ë³´ë‚´ê¸°</button>
</form>
```

---

### ğŸ“„ `Contact.cshtml.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.ComponentModel.DataAnnotations;

public class ContactModel : PageModel
{
    [BindProperty]
    [Required]
    public string Message { get; set; }

    public void OnGet() { }

    public IActionResult OnPost()
    {
        if (!ModelState.IsValid)
        {
            return Page(); // ìœ íš¨ì„± ì‹¤íŒ¨ ì‹œ í¼ ë‹¤ì‹œ í‘œì‹œ
        }

        // TODO: ë©”ì‹œì§€ ì €ì¥ ë˜ëŠ” ì´ë©”ì¼ ë°œì†¡

        return RedirectToPage("Thanks"); // ì„±ê³µ ì‹œ ë¦¬ë‹¤ì´ë ‰ì…˜
    }
}
```

---

## ğŸ§­ `RedirectToPage()`ë€?

í¼ ì²˜ë¦¬ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ëŠ” ì‚¬ìš©ìì˜ **ìƒˆë¡œê³ ì¹¨ ì¤‘ë³µ ì œì¶œì„ ë°©ì§€**í•˜ê³   
**Post-Redirect-Get (PRG)** íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

### âœ… ì‚¬ìš©ë²•

```csharp
return RedirectToPage("Index");             // ê°™ì€ í´ë”ì˜ Index.cshtml
return RedirectToPage("/Home/Index");       // ì ˆëŒ€ ê²½ë¡œ
return RedirectToPage("Result", new { id = 5 }); // íŒŒë¼ë¯¸í„° ì „ë‹¬
```

---

## ğŸ” `Page()`ì™€ì˜ ì°¨ì´ì 

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `Page()` | í˜„ì¬ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë Œë”ë§ (ì…ë ¥ê°’ ìœ ì§€ë¨) |
| `RedirectToPage()` | ìƒˆ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ (ì…ë ¥ê°’ ìœ ì§€ ì•ˆë¨) |

```csharp
if (!ModelState.IsValid)
    return Page(); // ë‹¤ì‹œ í¼ í‘œì‹œ
else
    return RedirectToPage("Success"); // ìƒˆ í˜ì´ì§€ë¡œ ì´ë™
```

---

## ğŸ§ª íŒŒë¼ë¯¸í„° ì „ë‹¬ ì˜ˆì‹œ

### ğŸ“„ `OnPost`ì—ì„œ íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ë¦¬ë‹¤ì´ë ‰íŠ¸

```csharp
return RedirectToPage("Result", new { id = 10, keyword = "apple" });
```

â†’ ì´ë™ ëŒ€ìƒ: `/Result?id=10&keyword=apple`

---

### ğŸ“„ ëŒ€ìƒ í˜ì´ì§€ì—ì„œ ë°›ê¸°

```csharp
public class ResultModel : PageModel
{
    public int Id { get; set; }
    public string Keyword { get; set; }

    public void OnGet(int id, string keyword)
    {
        Id = id;
        Keyword = keyword;
    }
}
```

---

## ğŸ”¥ `TempData`ë¡œ ë©”ì‹œì§€ ì „ë‹¬í•˜ê¸°

`RedirectToPage`ë¡œ ì´ë™í•˜ë©´ ê¸°ì¡´ ëª¨ë¸ ì†ì„±ì€ ì‚¬ë¼ì§.  
í•˜ì§€ë§Œ **í•œ ë²ˆë§Œ ìœ ì§€í•  ë°ì´í„°**ëŠ” `TempData`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### âœ… ì„¤ì •

```csharp
TempData["SuccessMessage"] = "ì „ì†¡ ì™„ë£Œ!";
return RedirectToPage("Thanks");
```

### âœ… ìˆ˜ì‹ 

```csharp
public class ThanksModel : PageModel
{
    [TempData]
    public string SuccessMessage { get; set; }

    public void OnGet() { }
}
```

**ë·°ì—ì„œ ì¶œë ¥**:

```razor
@if (!string.IsNullOrEmpty(SuccessMessage))
{
    <div class="alert alert-success">@SuccessMessage</div>
}
```

---

## ğŸ“Œ í¼ ì²˜ë¦¬ ì‹œ ì£¼ì˜í•  ì 

| í•­ëª© | ì„¤ëª… |
|------|------|
| `method="post"` | ìƒëµ ì‹œ ê¸°ë³¸ GETìœ¼ë¡œ ì²˜ë¦¬ë¨ |
| ìœ íš¨ì„± ê²€ì‚¬ | `ModelState.IsValid` í•„ìˆ˜ í™•ì¸ |
| PRG íŒ¨í„´ | `RedirectToPage()`ë¡œ ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜ ë°©ì§€ |
| `TempData` | ë¦¬ë‹¤ì´ë ‰íŠ¸ ê°„ ì„ì‹œ ë©”ì‹œì§€ ì „ë‹¬ì— ìœ ìš© |
| `BindProperty(SupportsGet = true)` | GET ìš”ì²­ì—ì„œë„ ìˆ˜ì‹  ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì • |

---

## âœ… ë§ˆë¬´ë¦¬ ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ì„¤ëª… |
|-----------|------|
| `OnPost()` | POST ìš”ì²­ ì²˜ë¦¬ |
| `Page()` | í˜„ì¬ í˜ì´ì§€ ë‹¤ì‹œ í‘œì‹œ |
| `RedirectToPage()` | ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ |
| `TempData` | ì„ì‹œ ë°ì´í„° ì „ë‹¬ (ì„±ê³µ ë©”ì‹œì§€ ë“±) |
| `ModelState.IsValid` | ìœ íš¨ì„± ê²€ì‚¬ í•„ìˆ˜ ì²´í¬ |

---

## ğŸ”œ ë‹¤ìŒ ì¶”ì²œ ì£¼ì œ

- âœ… ì—¬ëŸ¬ `OnPost[Handler]()` í•¸ë“¤ëŸ¬ í™œìš© (`asp-page-handler`)
- âœ… Ajax í¼ ì „ì†¡ê³¼ ì„œë²„ ì²˜ë¦¬ íë¦„
- âœ… `TempData` + PRG + ê²½ê³ /ì„±ê³µ ë©”ì‹œì§€ í†µí•© ì²˜ë¦¬
- âœ… ë³µìˆ˜ í¼ ì²˜ë¦¬ (í•œ í˜ì´ì§€ ë‚´ ë‹¤ì¤‘ í¼)