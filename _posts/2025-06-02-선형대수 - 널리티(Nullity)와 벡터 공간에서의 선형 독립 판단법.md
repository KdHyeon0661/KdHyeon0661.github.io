---
layout: post
title: 선형대수 - 널리티(Nullity)와 벡터 공간에서의 선형 독립 판단법
date: 2025-06-02 20:20:23 +0900
category: 선형대수
---
# 널리티(Nullity)와 벡터 공간에서의 선형 독립 판단법

> **핵심 한 줄**  
> 행렬 $$A\in\mathbb{R}^{m\times n}$$에 대해 $$\boxed{\operatorname{rank}(A)+\operatorname{nullity}(A)=n}$$.  
> 널리티는 **영공간의 차원 = 자유변수 개수**, 선형 독립 판정은 **랭크 = 열의 수**인지로 끝난다.

---

## 0) 직관 먼저: 랭크 vs 널리티

- **랭크(rank)**: 열(또는 행)벡터 중 **서로 독립인 최대 개수**. 즉 컬럼(또는 로우) 공간의 **차원**.  
- **널리티(nullity)**: **영공간**(동차식 $$A\vec{x}=\vec{0}$$의 해 공간)의 **차원** = **자유 변수의 수**.  
- 왜 중요한가? **해의 개수**와 **자유도**, 그리고 **선형 독립/종속**이 한 번에 보인다.

$$
\boxed{\text{rank}(A) = \dim(\text{Col}(A)) = \dim(\text{Row}(A)),\quad
\text{nullity}(A)=\dim(\text{Null}(A))}
$$

---

## 1) 정의 정리

### 1.1 랭크(rank)
$$
\text{Col}(A)=\{A\vec{x}\in\mathbb{R}^m\mid \vec{x}\in\mathbb{R}^n\},\qquad
\text{Row}(A)=\text{Col}(A^\top)
$$
$$
\boxed{\operatorname{rank}(A)=\dim(\text{Col}(A))=\dim(\text{Row}(A))}
$$

### 1.2 영공간(null space)과 널리티(nullity)
$$
\text{Null}(A)=\{\vec{x}\in\mathbb{R}^n\mid A\vec{x}=\vec{0}\},\qquad
\boxed{\operatorname{nullity}(A)=\dim(\text{Null}(A))}
$$

---

## 2) 랭크–널리티 정리(핵심 공식)

$$
\boxed{\operatorname{rank}(A)+\operatorname{nullity}(A)=n}
$$

- $$n$$: 열(변수) 개수.  
- 해석: **독립 제약식의 개수(랭크)** + **자유 변수의 개수(널리티)** = **전체 변수의 수**.

### 2.1 짧은 증명 스케치(선형사상 관점)
선형사상 $$T:\mathbb{R}^n\to\mathbb{R}^m,\ T(\vec{x})=A\vec{x}$$로 두면  
$$
\dim(\mathbb{R}^n)=\dim(\ker T)+\dim(\operatorname{im} T) 
\iff n=\operatorname{nullity}(A)+\operatorname{rank}(A).
$$
(선형대수의 제1동형정리/기본차원정리)

---

## 3) 해의 기하: 동차식과 비동차식

### 3.1 동차식
$$
A\vec{x}=\vec{0}\quad\Longleftrightarrow\quad \vec{x}\in\text{Null}(A)
$$

- **널리티 = 0**이면 오직 **영해**만 존재 → **열들이 선형 독립**.  
- **널리티 > 0**이면 무한해(자유변수 존재) → **열들은 선형 종속**.

### 3.2 비동차식
$$
A\vec{x}=\vec{b}\ \text{(일반)}.
$$

- 해가 존재할 조건: $$\vec{b}\in\text{Col}(A)$$.  
- 한 해 $$\vec{x}_p$$가 있으면 **모든 해**는
$$
\boxed{\vec{x}=\vec{x}_p+\vec{z},\ \ \vec{z}\in\text{Null}(A)}
$$
- 즉 **해 공간 = 한 점(특정해) + 영공간**(아핀공간). 자유도의 수는 **널리티**.

---

## 4) 선형 독립 판단법(여러 방식)

### 4.1 RREF(행 기약 사다리꼴) — 표준 절차
벡터들을 열로 쌓아 $$A=[\vec{v}_1\ \cdots\ \vec{v}_n]$$:
1) 가우스 소거로 RREF 계산  
2) **피벗 열의 개수 = 랭크**  
3) **랭크 = 열 개수**이면 **선형 독립**, 아니면 종속

> **Tip**: 열공간의 기저는 **원본 행렬의 피벗 열**이다(소거 후가 아님).

### 4.2 정방행렬(정사각) 한정: 행렬식 테스트
$$
A\in\mathbb{R}^{n\times n}\quad\Rightarrow\quad
\boxed{\det(A)\neq 0 \iff \text{열(행) 선형 독립} \iff \operatorname{rank}(A)=n}
$$

### 4.3 내적공간에서: 직교성(Orthonormality)
비영 벡터들이 **상호 직교**이면 자동으로 **선형 독립**.
$$
\vec{v}_i\cdot\vec{v}_j=0\ (i\ne j),\ \ \|\vec{v}_i\|\ne 0\ \Rightarrow\ \{\vec{v}_i\}\ \text{독립}.
$$
(그람–슈미트로 직교기저를 만들면 판별/좌표가 쉬워진다.)

### 4.4 수치해석(부동소수)에서는: SVD/허용오차 기반 랭크
수치적 의존(거의 배수) 판정엔 SVD 권장:
$$
A=USV^\top,\ S=\operatorname{diag}(\sigma_1\ge\cdots\ge\sigma_r\ge 0),\ 
\text{유효 랭크}=\#\{\sigma_i>\tau\}
$$
- 임계치 $$\tau$$ 예: $$\tau=\max(m,n)\,\sigma_1\,\varepsilon_{\text{machine}}$$  
- **조건수** $$\kappa(A)=\sigma_1/\sigma_{\min}$$가 크면 수치적으로 불안.

### 4.5 함수공간에서: Wronskian(고급)
함수들 $$\{f_1,\dots,f_n\}$$의 Wronskian이 어떤 구간에서 0이 아니면 독립(충분조건). (필요충분은 아님)

---

## 5) 예제로 직관 확장

### 5.1 뻔하지만 중요한 두 극단
- **명백한 독립**: 표준기저 $$\{(1,0,0),(0,1,0),(0,0,1)\}$$ → 랭크 3, 널리티 0  
- **명백한 종속**:
  $$
  \vec{v}_1=(1,2,3),\ \vec{v}_2=2\vec{v}_1,\ \vec{v}_3=3\vec{v}_1\ \Rightarrow\ \operatorname{rank}=1,\ \operatorname{nullity}=2
  $$

### 5.2 $$\mathbb{R}^3$$에서 네 벡터
- 어떤 집합이든 **3차원 공간에서 독립 가능한 최대 개수는 3**.  
- 4개 벡터가 독립일 수는 없다(비둘기집 원리: 랭크 ≤ 3).

### 5.3 비슷하지만 다른(수치적으로 위험한) 사례
$$
\vec{v}_1=(1,1,1),\ \vec{v}_2=(1,1,1+\epsilon),\ \vec{v}_3=(2,2,2+\epsilon).
$$
- 이론상 독립일 수 있어도, 아주 작은 $$\epsilon$$에서는 **수치적으로 종속처럼 보일 수 있음** → SVD/허용오차 필수.

### 5.4 일반해 구조 보기
$$
A=\begin{bmatrix}
1&2&3\\
0&1&4\\
1&3&7
\end{bmatrix},\quad A\vec{x}=\vec{0}
$$
가우스 소거로 자유변수 1개 →  
$$
\text{Null}(A)=\text{span}\left\{\begin{bmatrix}1\\-2\\1\end{bmatrix}\right\},\quad
\operatorname{rank}(A)=2,\ \operatorname{nullity}(A)=1
$$
랭크–널리티: $$2+1=3=n$$ 확인.

---

## 6) 파이썬 실전: SymPy(정확) & NumPy/SciPy(수치)

### 6.1 SymPy: 랭크/널리티/영공간/기저/독립 판정
```python
from sympy import Matrix

# 예제 행렬 (열벡터 모음)
A = Matrix([
    [1, 2, 3],
    [2, 4, 6],
    [3, 6, 9]
])

rank = A.rank()
nullity = A.shape[1] - rank

print("rank(A)   =", rank)
print("nullity(A)=", nullity)
print("선형 독립? =", rank == A.shape[1])

# 영공간(기저 벡터들) — 모든 해는 이 기저의 선형결합
null_basis = A.nullspace()
print("Null(A) 기저 개수:", len(null_basis))
for i, v in enumerate(null_basis, 1):
    print(f"u{i} =", v)

# 열공간/행공간 기저
col_basis = A.columnspace()
row_basis = A.rowspace()
print("Col(A) 기저 개수:", len(col_basis))
print("Row(A) 기저 개수:", len(row_basis))
```

### 6.2 NumPy+SVD: 수치 랭크/독립 판정(허용오차 포함)
```python
import numpy as np

def numerical_rank(A, tol=None):
    U, s, Vt = np.linalg.svd(A, full_matrices=False)
    if tol is None:
        tol = max(A.shape) * np.amax(s) * np.finfo(A.dtype).eps
    return np.sum(s > tol), s

def is_independent_numeric(cols, tol=None):
    A = np.column_stack(cols)  # 열벡터들
    r, s = numerical_rank(A, tol=tol)
    return r == A.shape[1], r, s

# 근접 종속 예제
v1 = np.array([1., 1., 1.])
v2 = np.array([1., 1., 1.000000001])
v3 = np.array([2., 2., 2.000000001])

indep, r, s = is_independent_numeric([v1, v2, v3])
print("수치적 선형 독립?", indep, "| rank =", r, "| singular values =", s)
```

### 6.3 일반해 시연: 비동차식의 “특정해 + 영공간”
```python
from sympy import Matrix

A = Matrix([[1, 2, 3],
            [0, 1, 4],
            [1, 3, 7]])
b = Matrix([1, 2, 3])

# 해 존재 여부: b가 Col(A)에 있는가?
# SymPy의 solve는 정방이 아니면 최소제곱으로 가지 않으므로, gauss_jordan_solve 사용
sol = A.gauss_jordan_solve(b)  # (특정해, 파라미터 벡터) 형태
x_particular = sol[0]
print("특정해 x_p =", x_particular)

N = A.nullspace()
print("Null(A) 기저:")
for v in N:
    print(v)
print("모든 해: x = x_p + c * u (u는 Null(A) 기저)")
```

---

## 7) 체크리스트 & 실무 팁

1) **0벡터 포함?** → 그 집합은 **무조건 종속**.  
2) **벡터 개수 > 공간 차원?** → 항상 종속. (예: $$\mathbb{R}^3$$에서 4개 이상은 독립 불가)  
3) **정방행렬?** → $$\det\neq 0$$이면 독립, $$=0$$이면 종속.  
4) **직교(정규직교) 집합?** → 비영이면 독립.  
5) **수치 문제**: 거의 배수인 벡터들 → RREF보다 **SVD 기반 랭크** 권장.  
6) **기저 추출**: RREF의 **피벗 열(원본 열)**을 골라라.  
7) **해 공간 파악**: 비동차식은 ‘특정해 + 영공간’. 자유도는 널리티.  
8) **함수공간**: Wronskian, 이론적 근거+수치 검증을 병행.

---

## 8) 응용 미니 사례

### 8.1 데이터 차원 축소(전처리)
- 특성(열)들 중 다중공선성(선형 종속)이 존재하면 **랭크 < 열 수**.  
- 널리티만큼 불필요한 특성이 있다는 뜻 → SVD/QR로 **독립 특성 선택**.

### 8.2 회귀(최소제곱)에서 가역성
- 설계행렬 $$X$$의 열이 독립이면 $$X^\top X$$ 가역 → 유일 최소제곱해.  
- 종속이면 무한해 → 정규화(릿지/라쏘)나 차원 축소 필요.

---

## 9) 연습 문제

1) $$A=\begin{bmatrix}1&1&2\\0&1&1\\1&2&3\end{bmatrix}$$ 에 대해  
   - RREF로 랭크/널리티/Null(A) 기저를 구하고, $$\operatorname{rank}+\operatorname{nullity}=3$$ 확인.  
2) $$\mathbb{R}^4$$에서 3개 벡터가 독립일 충분조건을 드시오(힌트: 정사각 부분행렬식/피벗).  
3) 함수 $$\{1,\ \sin x,\ \cos x\}$$ 가 $$[-\pi,\pi]$$에서 독립임을 설명하시오(내적/직교성 사용).

---

## 10) 요약 표

| 항목 | 수식/판정 | 해석/의미 |
|---|---|---|
| 랭크 | $$\operatorname{rank}(A)=\dim\text{Col}(A)=\dim\text{Row}(A)$$ | 독립 제약 수(독립 열/행 수) |
| 널리티 | $$\operatorname{nullity}(A)=\dim\text{Null}(A)$$ | 자유 변수 개수(동차해 자유도) |
| 랭크–널리티 | $$\operatorname{rank}(A)+\operatorname{nullity}(A)=n$$ | 제약+자유=전체 변수 |
| 독립 판정 | RREF 피벗 수 $$=\text{열 수}?$$ | 같으면 독립, 작으면 종속 |
| 정방 특수 | $$\det(A)\neq 0\iff \text{독립}$$ | 가역성/유일해 |
| 직교 집합 | 비영·상호직교 ⇒ 독립 | 그람–슈미트/QR 유리 |
| 수치 판정 | SVD로 유효 랭크 | 허용오차 기반, 조건수 주의 |

---

### 마무리 한 문장

**널리티는 “얼마나 자유로운가”를, 랭크는 “얼마나 제약되는가”를 말한다.**  
둘의 합이 항상 변수의 수가 된다는 사실이 선형 시스템의 구조를 완전히 설명한다.