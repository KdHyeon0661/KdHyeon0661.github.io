---
layout: post
title: 미적분 - 부분적분
date: 2025-07-11 21:20:23 +0900
category: 미적분
---
# 부분적분 (Integration by Parts)

## 1. 개념·공식·유도

### 1.1 기본 공식
두 함수 \(u(x)\), \(v(x)\)가 미분 가능할 때
$$
\int u(x)\,v'(x)\,dx \;=\; u(x)\,v(x)\;-\;\int u'(x)\,v(x)\,dx.
$$
기호로 간단히
$$
\int u\,dv \;=\; uv \;-\;\int v\,du.
$$

### 1.2 유도 (곱의 미분에서)
곱의 미분:
$$
\frac{d}{dx}\big(u v\big)=u'v+uv' \;\Rightarrow\;
\int \frac{d}{dx}(uv)\,dx=\int u'v\,dx+\int uv'\,dx.
$$
좌변은 \(uv\). 정리하면
$$
\int u\,v' \,dx \;=\; uv - \int u'v\,dx.
$$

> 해석: “곱의 적분 = **한 번 미분** + **한 번 적분**으로 바꿔 푼다.”
> 목표는 **더 쉬운 적분**으로 변환하는 것.

---

## 2. 언제 쓰나? (치환과의 비교, 성공 기준)

- **곱의 꼴** \((\text{대수} \times \text{지수/삼각/로그/역삼각})\), 또는
  치환으로는 간단해지지 않는데 **한쪽을 미분하면 점점 단순**해지는 경우.
- **치환적분**이 “안 보일” 때 1순위로 떠올려보기.
- **비용 모델**: \(u\)를 미분할수록(반복 적용 시) **종결**되는 방향(다항식 차수 ↓, 로그·역삼각은 단순화)을 선택.

#### 쓰면 좋은 전형
- \(x^n e^{ax}\), \(x^n \sin bx\), \(x^n \cos bx\) (다항식 차수 떨어뜨리기)
- \(\ln x\), \(\arctan x\), \(\arcsin x\) 같은 **미분하면 단순해지는** 항
- \(e^{ax}\cos bx\), \(e^{ax}\sin bx\)처럼 **자기참조**로 방정식 풀기

#### 피해야 할 전형
- 두 항 모두 미분/적분해도 **복잡도 불변/증가** (예: \(\sqrt{1+x^2}\cdot e^{x^2}\) 등)
- 사실은 **치환**이 즉시 되는 형태(예: \(\int f'(x)g(f(x))dx\))

---

## 3. \(u\)와 \(dv\) 선택 요령 — LIATE 그 이상

### 3.1 LIATE(우선순위)
Logarithmic > Inverse trig > Algebraic > Trig > Exponential.
즉, \(u\)는 보통 **\(\ln x\)·역삼각 > 다항 > 삼각 > 지수** 순으로 고른다.

### 3.2 예외·세부 팁
- **삼각 vs 지수**: 반복 시 어느 쪽이 이득인지 비교. \(x^n\)이 있으면 \(u=x^n\)가 보통 정답.
- **합성함수**: \(u=\ln(ax+b)\), \(dv=dx\)처럼 선형합성은 그대로 둔다.
- **정적분**: 경계에서 \(uv\) **경계항이 예쁘게 소거**되는 선택을 우선 (예: \([0,\infty)\)에서 \(e^{-x}\)가 경계항을 죽임).

---

## 4. 기본 예제

### 4.1 \( \int x e^x\,dx \)
\(u=x\Rightarrow du=dx,\; dv=e^x dx\Rightarrow v=e^x\)
$$
\int x e^x dx= x e^x-\int e^x dx = x e^x - e^x + C = e^x(x-1)+C.
$$

### 4.2 \( \int \ln x\,dx \)  (치환 불가 → 부분적분 1순위)
\(u=\ln x\Rightarrow du=\frac{dx}{x},\; dv=dx\Rightarrow v=x\)
$$
\int \ln x\,dx = x\ln x - \int 1\,dx = x\ln x - x + C.
$$

### 4.3 반복 예: \( \int x^2\cos x\,dx \)
1차:
\(u=x^2\Rightarrow du=2x\,dx,\; dv=\cos x\,dx\Rightarrow v=\sin x\)
$$
\int x^2\cos x\,dx = x^2\sin x - \int 2x\sin x\,dx.
$$
2차:
\(u=2x,\; dv=\sin x\,dx\Rightarrow du=2dx,\; v=-\cos x\)
$$
= x^2\sin x -\big(-2x\cos x + \int 2\cos x\,dx\big)
= x^2\sin x + 2x\cos x - 2\sin x + C.
$$

---

## 5. 탭(Tabular) 부분적분 — 반복을 자동화

다항×(지수/삼각)일 때 **미분 열**과 **적분 열**을 표로 만들고 부호 \(+,-,+,-,\dots\)를 교차 적용.

### 5.1 절차
1) 왼쪽 열: \(u\)를 계속 미분 (끝에 0이 나오도록)
2) 오른쪽 열: \(dv\)를 계속 적분
3) 대각선 곱을 \(+,-,+,\dots\)로 합.

### 5.2 예: \( \int x^3 e^{2x} dx \)
```
u:    x^3     x^2      x       1        0
du:   3x^2    2x       1       0
dv:   e^{2x}  e^{2x}   e^{2x}  e^{2x}
v:    (1/2)e^{2x}  (1/2)^2 e^{2x}  (1/2)^3 e^{2x}  (1/2)^4 e^{2x}
부호:   +        -        +        -
```
결과
$$
\int x^3 e^{2x}dx
= \tfrac12 x^3 e^{2x}
-\tfrac14 x^2 e^{2x}
+\tfrac18 x e^{2x}
-\tfrac{1}{16} e^{2x}+C
= e^{2x}\!\left(\tfrac12 x^3-\tfrac14 x^2+\tfrac18 x-\tfrac{1}{16}\right)+C.
$$

> 실전 팁: \(e^{ax}\)면 적분할 때마다 \(\tfrac{1}{a}\)가 곱해진다. \(\sin/\cos\)는 주기가 돌며 부호만 바뀐다.

---

## 6. “자기참조”로 푸는 유형 — 식 세우고 미지수처럼 풀기

### 6.1 \( \int e^{ax}\cos bx\,dx \)
\(I=\int e^{ax}\cos bx\,dx\).
한 번 부분적분 후 다시 부분적분(또는 동시 체계화)을 하면
$$
I=\frac{e^{ax}}{a^2+b^2}\big(a\cos bx+b\sin bx\big)+C.
$$
같은 방식으로
$$
\int e^{ax}\sin bx\,dx=\frac{e^{ax}}{a^2+b^2}\big(a\sin bx-b\cos bx\big)+C.
$$

### 6.2 \( \int e^{-x}\sin x\,dx \) (특수치)
공식에 \(a=-1,b=1\) 대입:
$$
\int e^{-x}\sin x\,dx=\frac{e^{-x}}{2}\big(-\sin x-\cos x\big)+C.
$$

---

## 7. 감소식(감소 관계) 만들기 — 일반 패턴을 한 번에

### 7.1 \( \displaystyle I_n=\int x^n e^{ax}\,dx \) (다항×지수)
부분적분 \(u=x^n,\,dv=e^{ax}dx\Rightarrow du=nx^{n-1}dx,\, v=\frac{1}{a}e^{ax}\)
$$
I_n=\frac{x^n}{a}e^{ax} - \frac{n}{a}\int x^{n-1}e^{ax}\,dx
=\frac{x^n}{a}e^{ax} - \frac{n}{a} I_{n-1}.
$$
초기값 \(I_0=\tfrac{1}{a}e^{ax}\). 이로부터 닫힌꼴이 귀납적으로 생성.

### 7.2 \( \displaystyle S_n=\int x^n\sin bx\,dx,\quad C_n=\int x^n\cos bx\,dx \)
부분적분 \(u=x^n\)로 하면
$$
S_n=-\frac{x^n}{b}\cos bx+\frac{n}{b}C_{n-1},\qquad
C_n=\frac{x^n}{b}\sin bx-\frac{n}{b}S_{n-1}.
$$
짝지음으로 차수 1씩 줄여가며 계산.

### 7.3 \( \displaystyle J_n=\int (\ln x)^n\,dx\ (x>0) \)
\(u=(\ln x)^n,\ dv=dx\Rightarrow du=n(\ln x)^{n-1}\frac{dx}{x}, v=x\)
$$
J_n=x(\ln x)^n-n\int (\ln x)^{n-1}\,dx
= x(\ln x)^n-nJ_{n-1}.
$$
초기 \(J_0=\int 1\,dx=x\).
예) \(n=2\): \(J_2=x(\ln x)^2-2x\ln x+2x+C\).

### 7.4 \( \displaystyle \int x^m(\ln x)^n\,dx\ (m\neq -1) \)
\(u=(\ln x)^n,\ dv=x^m dx\Rightarrow v=\frac{x^{m+1}}{m+1}\)
$$
\int x^m(\ln x)^n dx
=\frac{x^{m+1}}{m+1}(\ln x)^n-\frac{n}{m+1}\int x^m(\ln x)^{n-1} dx.
$$

---

## 8. 역삼각함수 적분도 부분적분으로

### 8.1 \( \displaystyle \int \arctan x\,dx \)
\(u=\arctan x\Rightarrow du=\frac{dx}{1+x^2},\ dv=dx\Rightarrow v=x\)
$$
\int \arctan x\,dx = x\arctan x-\int \frac{x}{1+x^2}\,dx
= x\arctan x-\tfrac12\ln(1+x^2)+C.
$$

### 8.2 \( \displaystyle \int \arcsin x\,dx \)
\(u=\arcsin x,\ dv=dx\Rightarrow du=\frac{dx}{\sqrt{1-x^2}},\ v=x\)
$$
= x\arcsin x-\int \frac{x}{\sqrt{1-x^2}}\,dx
= x\arcsin x+\sqrt{1-x^2}+C.
$$

---

## 9. 정적분·부적분(경계항 주의)

### 9.1 정적분 버전
$$
\int_a^b u\,dv=[uv]_a^b-\int_a^b v\,du.
$$
경계항 \([uv]_a^b\)가 **소거**되도록 \(u, dv\)를 택하면 계산이 크게 단순화.

#### 예: \( \displaystyle \int_{0}^{\infty} x e^{-x}\,dx \)
\(u=x,\ dv=e^{-x}dx\Rightarrow du=dx,\ v=-e^{-x}\)
$$
\int_{0}^{\infty} x e^{-x}\,dx
=\big[-x e^{-x}\big]_{0}^{\infty}+\int_{0}^{\infty} e^{-x}\,dx
=0+1=1.
$$
(\(xe^{-x}\)는 \(\infty\)에서 0으로 감쇠.)

### 9.2 감마함수 귀결 (반복 IBP)
$$
\int_{0}^{\infty} x^n e^{-x}\,dx=n!,\quad n=0,1,2,\dots
$$
부분적분 \(u=x^n,\ dv=e^{-x}dx\) 반복으로 귀납적 증명 가능(경계항 0).

### 9.3 부적분 경계 체크
- \([uv]_a^b\)에 **무한대/특이점**이 개입되면, 각 항의 극한이 **개별로 유한**한지 확인.
- 미련 없이 **극한 표기**:
  \(\int_{1}^{\infty} u\,dv=\lim_{R\to\infty}\big([uv]_1^R-\int_1^R v\,du\big)\).

---

## 10. 잘못되기 쉬운 포인트(체크리스트)

- [ ] **\(u\) 선택 미스**: 미분해도 단순해지지 않는 \(u\). (다항을 우선적으로 \(u\)로)
- [ ] **경계항 누락**: 정적분에서 \([uv]_a^b\) 빠뜨리기
- [ ] **부호 실수**: \(\int v\,du\) 앞의 음수(특히 2회 반복 시)
- [ ] **무의미한 반복**: 치환으로 끝나는 걸 괜히 부분적분
- [ ] **부적분**에서 경계항 발산을 무시
- [ ] \( \int f'/f=\ln|f| \) 같은 **치환형**을 부분적분으로 억지 시도

---

## 11. 실전 미니 카탈로그 (패턴 → 처방)

| Integrand | 권장 \(u\) | 권장 \(dv\) | 비고 |
|---|---|---|---|
| \(x^n e^{ax}\) | \(x^n\) | \(e^{ax}dx\) | 탭법/감소식 |
| \(x^n\sin bx\) | \(x^n\) | \(\sin bx\,dx\) | \(S_n,C_n\) 상호감소 |
| \(x^n\cos bx\) | \(x^n\) | \(\cos bx\,dx\) | 위와 동일 |
| \(\ln x\) | \(\ln x\) | \(dx\) | 표준 |
| \(\arctan x\) | \(\arctan x\) | \(dx\) | 표준 |
| \(e^{ax}\cos bx\) | \(\cos bx\) | \(e^{ax}dx\) | 자기참조로 풀기 |
| \((\ln x)^n\) | \((\ln x)^n\) | \(dx\) | \(J_n=x(\ln x)^n-nJ_{n-1}\) |
| \(x^m(\ln x)^n\) | \((\ln x)^n\) | \(x^m dx\) | 일반화 감소식 |

---

## 12. 정교한 예제 모음

### 12.1 \( \int x e^{2x}\sin x\,dx \) (혼합)
먼저 \(dv=\sin x\,dx\), \(u=xe^{2x}\)로:
- \(v=-\cos x\)
- \(du=(e^{2x}+2x e^{2x})dx=e^{2x}(1+2x)dx\)

$$
\int x e^{2x}\sin x\,dx
=-x e^{2x}\cos x + \int e^{2x}(1+2x)\cos x\,dx.
$$
오른쪽은 \(e^{2x}\cos x\), \(x e^{2x}\cos x\) 조합 → **섹션 6 공식**을 사용하면 빠르다.
(직접 반복해도 되지만 공식 재사용을 권장)

### 12.2 \( \int_{0}^{1} x \ln(1+x)\,dx \)
부분적분 \(u=\ln(1+x),\, dv=x\,dx\Rightarrow v=\tfrac{x^2}{2},\, du=\tfrac{dx}{1+x}\)
$$
\int_0^1 x\ln(1+x)\,dx
=\Big[\tfrac{x^2}{2}\ln(1+x)\Big]_0^1-\int_0^1 \frac{x^2}{2(1+x)}\,dx.
$$
분수 단순화: \(\dfrac{x^2}{1+x}=x-1+\dfrac{1}{1+x}\).
따라서
$$
=\frac12\ln 2 - \frac12\int_0^1 \Big(x-1+\frac{1}{1+x}\Big)dx
=\frac12\ln 2 - \frac12\Big[\frac{x^2}{2}-x+\ln(1+x)\Big]_0^1
$$
$$
=\frac12\ln 2 - \frac12\Big(\frac12-1+\ln 2\Big)
=\frac12\ln 2 - \frac12\Big(-\frac12+\ln 2\Big)
=\frac14.
$$

### 12.3 \( \int_{0}^{\infty} e^{-ax}\cos bx\,dx \) (\(a>0\))
공식 활용(섹션 6):
\(\displaystyle \int e^{-ax}\cos bx\,dx = \frac{e^{-ax}}{a^2+b^2}\big(-a\cos bx+b\sin bx\big)+C\).
\(0\to\infty\)에 대입: \(\infty\)에서 항은 0, \(x=0\)에서 \(-a/(a^2+b^2)\).
부호 주의:
$$
\int_{0}^{\infty} e^{-ax}\cos bx\,dx = \frac{a}{a^2+b^2}.
$$

---

## 13. 파이썬으로 검산(선택)

### 13.1 심볼릭 검산(미분해서 integrand 복원)
```python
# sympy로 부분적분 결과 검산 (미분=원 integrand?)
import sympy as sp

x = sp.symbols('x', positive=True)
expr = sp.exp(x)*(x-1)   # ∫ x e^x dx 결과
print(sp.simplify(sp.diff(expr, x) - x*sp.exp(x)))  # 0이면 정답
```

### 13.2 수치 정적분 검산(사다리꼴/적응 구적)
```python
import numpy as np

def trapz(f, a, b, n=200000):
    xs = np.linspace(a, b, n+1)
    ys = f(xs)
    h = (b-a)/n
    return h*(0.5*ys[0] + ys[1:-1].sum() + 0.5*ys[-1])

# 예: ∫_0^1 x ln(1+x) dx = 1/4
f = lambda x: x*np.log(1+x)
approx = trapz(f, 0.0, 1.0)
print("수치:", approx, "이론:", 0.25, "오차:", approx-0.25)
```

### 13.3 탭 부분적분 자동화(다항×지수)
```python
import sympy as sp
x, a = sp.symbols('x a', positive=True)

def tabular_poly_exp(n, a_val):
    # ∫ x^n e^{a x} dx 의 탭 결과
    a_sub = sp.Rational(1,1)*a_val
    term = sp.integrate((x**n)*sp.exp(a_sub*x), x)
    return sp.simplify(term)

print(tabular_poly_exp(3, 2))  # ∫ x^3 e^{2x} dx
```
> 실제 탭 알고리즘을 일반화하려면 “미분열·적분열·교차부호”를 코드로 작성하면 된다.
> 위 예시는 `sympy.integrate`로 결과를 확인하는 간략 버전.

---

## 14. 연습 문제(풀이 스케치 포함)

1) \(\displaystyle \int x e^{3x}\,dx\)
   \(=e^{3x}\big(\tfrac{x}{3}-\tfrac{1}{9}\big)+C\).

2) \(\displaystyle \int x^2\sin(2x)\,dx\)
   탭법: \(= -\tfrac{x^2}{2}\cos(2x)+\tfrac{x}{2}\sin(2x)+\tfrac{1}{4}\cos(2x)+C\).

3) \(\displaystyle \int \arcsin(2x)\,dx\)
   \(u=\arcsin(2x),\,dv=dx\Rightarrow du=\frac{2\,dx}{\sqrt{1-4x^2}},\, v=x\)
   \(=x\arcsin(2x)-\int \frac{2x}{\sqrt{1-4x^2}}dx\)
   치환 \(w=1-4x^2\Rightarrow\) 결과 \(=x\arcsin(2x)+\frac{\sqrt{1-4x^2}}{2}+C\).

4) \(\displaystyle \int_0^\infty x^2 e^{-x}\,dx\)
   \(=2!=2\) (감마 귀결 또는 부분적분 2회).

5) \(\displaystyle \int (\ln x)^3 dx\ (x>0)\)
   감소식 \(J_3=x(\ln x)^3-3J_2\), \(J_2=x(\ln x)^2-2x\ln x+2x\)
   \(\Rightarrow x(\ln x)^3-3x(\ln x)^2+6x\ln x-6x+C\).

6) \(\displaystyle \int e^{-x}\cos x\,dx\)
   공식: \(\frac{e^{-x}}{2}\big(-\cos x+\sin x\big)+C\).

7) \(\displaystyle \int x\ln(ax+b)\,dx\)
   \(u=\ln(ax+b),\,dv=x\,dx\Rightarrow v=\tfrac{x^2}{2}\)
   \(\Rightarrow \tfrac{x^2}{2}\ln(ax+b)-\tfrac{a}{2}\int \frac{x^2}{ax+b}\,dx\)
   (다항나눗셈/부분분수로 마무리 — 정적분이면 경계항이 정리되며 더 간단해짐).

---

## 15. 요약

- 공식을 정확히:
  $$\int u\,dv=uv-\int v\,du.$$
- \(u\)는 **미분하면 단순**해지는 것, \(dv\)는 **적분이 쉬운** 것으로. (LIATE(+경계항) 고려)
- **반복/탭법**으로 다항×(지수/삼각) 완전 공략.
- **자기참조** 유형(\(e^{ax}\sin bx\), \(e^{ax}\cos bx\))은 식 세워 **미지수처럼** 풀기.
- 정적분/부적분에선 **경계항**과 **수렴**을 항상 점검.
- 필요시 **수치검산(파이썬)**으로 결과를 빠르게 확인.

이 흐름과 패턴만 손에 익히면, 부분적분으로 풀리는 적분의 80% 이상을 **안정적으로** 처리할 수 있다.
