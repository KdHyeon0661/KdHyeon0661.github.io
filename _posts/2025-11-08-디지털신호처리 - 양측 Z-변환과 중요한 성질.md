---
layout: post
title: 디지털신호처리 - 양측 Z-변환과 중요한 성질
date: 2025-11-08 22:25:23 +0900
category: 디지털신호처리
---
# 양측 Z-변환과 중요한 성질

## 0. 맥락과 목표

앞서 정리한 DTFT·LTI 주파수 응답·샘플링/복원 위에, 이번 글은 **양측(이측) Z-변환**을 완결적으로 정리한다. 목표는 다음 네 가지다.

1) **정의–역변환–ROC**: 변환의 뼈대를 정확히 세운다.
2) **극/영점–안정/인과**: z-평면에서 시스템과 신호를 직관적으로 읽는다.
3) **핵심 성질**: 선형·시프트·미분·컨볼루션·지수곱·반전 등을 도구화한다.
4) **복원과 검증**: 부분분수/잔여정리로 역변환하고, Octave로 **수치적 일치**를 확인한다.

---

## 1. 양측 Z-변환: 정의·역변환·ROC

### 1.1 정의(양측)
$$
X(z)\; \triangleq\; \sum_{n=-\infty}^{\infty} x[n]\;z^{-n},\quad z\in\mathbb{C}\setminus\{0\}.
$$

- 단위원 대입 $$z=e^{j\omega}$$ 에서
$$
X\!\left(e^{j\omega}\right)=\sum_{n=-\infty}^{\infty} x[n]\,e^{-j\omega n},
$$
즉 **DTFT**가 된다. DTFT가 잘 정의되려면 단위원이 **ROC**에 포함되어야 한다.

### 1.2 역변환(컨투어 적분·잔여정리)
적절한 **수렴영역(ROC)** 에서
$$
x[n]\;=\;\frac{1}{2\pi j}\oint_{\mathcal{C}} X(z)\;z^{\,n-1}\,dz,
$$
여기서 $$\mathcal{C}$$ 는 ROC에 놓인 임의의 원형 폐곡선(극을 가로지르지 않게 선택).
잔여정리에 의해
$$
x[n]\;=\;\sum_{z_k\in\text{ROC 내부의 극}} \operatorname{Res}\!\left\{\,X(z)\,z^{n-1},\,z=z_k\right\}.
$$

### 1.3 ROC(Region of Convergence) — 원칙
- ROC는 **원점 중심의 환대(annulus)** 이다.
- **극은 ROC에 포함되지 않는다.**
- **우측신호(right-sided)**: 충분히 큰 $$n$$ 에서 0이 아닌 신호. 보통
  $$
  \text{ROC:}\quad |z|>r_{\max} \quad(\text{가장 큰 극 반경 바깥, 무한대 포함})
  $$
- **좌측신호(left-sided)**: 충분히 작은 $$n$$ 에서 0이 아닌 신호. 보통
  $$
  \text{ROC:}\quad |z|<r_{\min} \quad(\text{가장 작은 극 반경 안쪽, 원점 포함})
  $$
- **양측신호(two-sided)**: 좌·우측 성분이 공존 → **극 사이 환대**가 ROC.
- **DTFT 존재성**: 단위원 $$|z|=1$$ 이 ROC에 포함되어야 $$X(e^{j\omega})$$ 가 존재한다.

### 1.4 표준쌍과 ROC

- 지수 우측신호
$$
x[n]=a^n u[n]\quad\Longleftrightarrow\quad X(z)=\frac{1}{1-a z^{-1}},\qquad \text{ROC: } |z|>|a|.
$$

- 지수 좌측신호
$$
x[n]=-\,a^{\,n-1}u[-n-1]\quad\Longleftrightarrow\quad X(z)=\frac{-z}{z-a},\qquad \text{ROC: } |z|<|a|.
$$

- 임펄스·지연
$$
\delta[n]\Longleftrightarrow 1,\qquad \delta[n-n_0]\Longleftrightarrow z^{-n_0},\qquad \text{ROC: } 0<|z|<\infty.
$$

- 양측 지수(예)
$$
x[n]=a_1^n u[-n-1]+a_2^n u[n]\;\Rightarrow\;X(z)=\frac{z}{z-a_1}+\frac{1}{1-a_2 z^{-1}},
$$
$$
\text{ROC:}\quad |a_1|<|z|<|a_2|.
$$

---

## 2. z-평면, DTFT, 극/영점

### 2.1 단위원 평가 = DTFT
$$
X\!\left(e^{j\omega}\right)=X(z)\big|_{z=e^{j\omega}}.
$$
따라서 **단위원 근방의 극/영점 배치**는 크기·위상 응답에 직접적인 영향을 준다.

### 2.2 극/영점 분해
$$
X(z)=C\cdot\frac{\prod_i \left(1- z_i z^{-1}\right)}{\prod_k \left(1- p_k z^{-1}\right)}.
$$
- 단위원 위에서 $$|X(e^{j\omega})|$$ 는 **영점에 가까우면 감쇠**, **극에 가까우면 증폭**한다.
- **영점 반사**(예: 최소위상화)는 크기는 유지하면서 위상·군지연을 조절할 수 있다(시스템 맥락).

### 2.3 안정/인과(시스템)
임펄스응답 $$h[n]$$ 의 Z-변환 $$H(z)$$ 에 대해
- **BIBO 안정**: **단위원이 ROC에 포함**.
- **인과(우측)**: ROC가 **무한대**를 포함(가장 바깥 극 바깥).
- **인과+안정**: 모든 극이 **단위원 내부**.

---

## 3. 중요한 성질(양측 기준)

### 3.1 선형성
$$
\mathcal{Z}\{a\,x[n]+b\,y[n]\}=a\,X(z)+b\,Y(z).
$$

### 3.2 시간 시프트
$$
\mathcal{Z}\{x[n-n_0]\}=z^{-n_0}X(z).
$$

### 3.3 지수 곱(주파수 평행이동)
$$
\mathcal{Z}\{a^n x[n]\}=X\!\left(\frac{z}{a}\right),\qquad a\neq 0.
$$

### 3.4 가중 $$n$$ (미분 성질)
$$
\mathcal{Z}\{n\,x[n]\}=-\,z\,\frac{dX(z)}{dz}.
$$

### 3.5 컨볼루션 ↔ 곱
$$
\mathcal{Z}\{(x*h)[n]\}=X(z)\,H(z).
$$

### 3.6 반전(시간 뒤집기)
$$
\mathcal{Z}\{x[-n]\}=X\!\left(z^{-1}\right),\qquad \text{ROC: } \rho_2^{-1}<|z|<\rho_1^{-1}.
$$

### 3.7 차분·지연 연산자
$$
x[n-1]\Longleftrightarrow z^{-1}X(z),\qquad (I-Z^{-1})x[n]\Longleftrightarrow \left(1-z^{-1}\right)X(z).
$$

---

## 4. 역 Z-변환(실전 절차)

### 4.1 부분분수 전개
유리함수 $$X(z)=\dfrac{B(z)}{A(z)}$$ 를 $$z^{-1}$$ 의 다항식으로 보고 부분분수 전개:
- 우측신호 ROC(무한대 포함)라면 항은 보통 $$\dfrac{C_k}{1-p_k z^{-1}}\Rightarrow C_k\,p_k^n u[n]$$ 으로 해석.
- 좌측신호 ROC(원점 포함)라면 같은 형식도 **좌측 해석**으로 바뀐다:
  $$
  \frac{1}{1-a z^{-1}}=-\sum_{n=-\infty}^{-1} a^n z^{-n}\;\Rightarrow\; -a^{n-1}u[-n-1].
  $$

### 4.2 거듭제곱 급수
- $$|z|>|a|$$ 이면
  $$
  \frac{1}{1-a z^{-1}}=\sum_{n=0}^{\infty} a^{n} z^{-n}\;\Rightarrow\; a^n u[n].
  $$
- $$|z|<|a|$$ 이면
  $$
  \frac{1}{1-a z^{-1}}=-\sum_{n=-\infty}^{-1} a^n z^{-n}\;\Rightarrow\; -a^{n-1}u[-n-1].
  $$

### 4.3 잔여정리
$$
x[n]=\sum_{k} \operatorname{Res}\!\left\{X(z)\,z^{n-1},\,z=p_k\right\},
$$
중복극이면 고계 잔여 공식을 사용(계수 비교나 미분 도구로 계산).

---

## 5. 차분방정식 ↔ 전달함수

### 5.1 LCCDE → $$H(z)$$
$$
\sum_{m=0}^{M} a_m\,y[n-m]\;=\;\sum_{k=0}^{K} b_k\,x[n-k]
\;\Longrightarrow\;
H(z)\equiv\frac{Y(z)}{X(z)}=\frac{\sum_{k=0}^{K} b_k z^{-k}}{\sum_{m=0}^{M} a_m z^{-m}}.
$$

### 5.2 예제
$$
y[n]-0.8y[n-1]+0.15y[n-2]=x[n]-0.5x[n-1]
\;\Rightarrow\;
H(z)=\frac{1-0.5z^{-1}}{1-0.8z^{-1}+0.15z^{-2}}.
$$
- 극은 분모 근, 영은 분자 근.
- 인과+안정 여부는 극 반경으로 판정한다.

---

## 6. Octave 실습 ① — 극/영점·주파수 응답

```octave
% H(z) = (1 - 0.5 z^-1) / (1 - 0.8 z^-1 + 0.15 z^-2)
clear; close all; clc; pkg load signal

b = [1 -0.5];           % numerator in z^-1
a = [1 -0.8 0.15];      % denominator in z^-1

% 주파수응답 (DTFT = 단위원 평가)
[H, w] = freqz(b, a, 4096);

subplot(2,2,1);
plot(w/pi, 20*log10(abs(H)+1e-12)); grid on; ylabel('dB');
title('|H(e^{j\omega})|');

subplot(2,2,2);
plot(w/pi, unwrap(angle(H))); grid on; ylabel('rad');
title('∠H(e^{j\omega})');

% 극/영점 (주의: roots는 z 다항식 계수 기준 → fliplr)
z = roots(fliplr(b));
p = roots(fliplr(a));

subplot(2,2,3);
th = linspace(0, 2*pi, 600);
plot(cos(th), sin(th), 'k--'); hold on
plot(real(z), imag(z), 'ob', 'markerfacecolor','b');
plot(real(p), imag(p), 'xr', 'markersize', 8);
axis equal; grid on; legend('unit circle','zeros','poles');
title('Z-plane');

subplot(2,2,4);
bar(abs(p)); grid on; ylim([0 1.2]); title('pole magnitudes');
```

---

## 7. Octave 실습 ② — 부분분수 vs 임펄스응답

```octave
% 부분분수 전개 → h[n] 재구성, impz와 비교
clear; close all; clc; pkg load signal

b = [1 -0.5];
a = [1 -0.8 0.15];

[r, p, k] = residuez(b, a);  % H(z) = sum r_i / (1 - p_i z^-1) + k (우측 ROC 가정)
N = 120; n = 0:N-1;

h_pf = zeros(size(n));
for i = 1:numel(p)
  h_pf += r(i) * (p(i) .^ n);
endfor
h_imp = impz(b, a, N);

subplot(2,1,1);
stem(n, real(h_pf), '.'); hold on; stem(n, real(h_imp), 'r.'); grid on
legend('PF-real','impz-real'); title('Impulse response (real part)');

subplot(2,1,2);
stem(n, imag(h_pf), '.'); hold on; stem(n, imag(h_imp), 'r.'); grid on
legend('PF-imag','impz-imag'); title('Impulse response (imag part)');

printf("RMS error = %.3e\n", rms(h_pf - h_imp));
```

---

## 8. Octave 실습 ③ — $$n x[n] \leftrightarrow -z\,dX/dz$$ 확인

```octave
% x[n] = a^n u[n] → X(z) = 1/(1 - a z^-1), 관계: Z{n x[n]} = - z dX/dz
clear; close all; clc

a = 0.7; N = 400; n = 0:N-1; x = a.^n;

R = 1.0; theta = linspace(0, 2*pi, 1500);
z = R * exp(1j*theta);

% 직접합으로 X(z)
X = zeros(size(z));
for k = 1:numel(z)
  X(k) = sum( x .* (z(k).^(-n)) );
endfor

% 수치 미분
dXdz = gradient(X) ./ gradient(z);

% Z{n x[n]} 직접합
Xn = zeros(size(z));
for k = 1:numel(z)
  Xn(k) = sum( (n.*x) .* (z(k).^(-n)) );
endfor

relerr = norm(Xn + z .* dXdz) / norm(Xn);
printf("relative error (nx vs -z dX/dz) = %.2e\n", relerr);
```

---

## 9. ROC 감각 익히기 — 좌/우/양측 사례

```octave
% 양측 신호: x[n] = (0.9)^n u[n] + (0.6)^n u[-n-1]
clear; close all; clc

n = -1000:1000;
x = (n>=0).*(0.9.^n) + (n<=-1).*(0.6.^n);

thetas = linspace(0, 2*pi, 2000);
Rs = [0.7, 0.8, 0.95, 1.1];  % 서로 다른 반지름 원에서 X(z) 평가

for r = Rs
  z = r*exp(1j*thetas);
  X = zeros(size(z));
  for k = 1:numel(z)
    X(k) = sum( x .* (z(k).^(-n)) );
  endfor
  plot(thetas, 20*log10(abs(X) + 1e-12)); hold on
endfor

grid on; xlabel('angle [rad]'); ylabel('|X| [dB]');
legend('|z|=0.7','0.8','0.95','1.1');
title('ROC 체감: 서로 다른 반지름에서의 |X(z)|');
```

- 반지름에 따라 수렴/발산 경향이 다르게 나타난다. 극 사이의 환대가 **ROC**임을 감각적으로 확인할 수 있다.

---

## 10. 동일한 유리함수, 다른 ROC → 다른 $$x[n]$$

### 10.1 문제
$$
X(z)=\frac{1}{1-a z^{-1}}.
$$
- **ROC1: $$|z|>|a|$$** →
$$
x[n]=a^n u[n]\quad(\text{우측신호})
$$
- **ROC2: $$|z|<|a|$$** →
$$
x[n]=-a^{\,n-1}u[-n-1]\quad(\text{좌측신호})
$$

### 10.2 관찰
형식적으로 같은 $$X(z)$$ 라도 **ROC가 다르면 원 신호가 달라진다.**
역변환·부분분수 해석 시 **반드시 ROC를 먼저** 고정해야 한다.

---

## 11. 실전: 중복극·복소 켤레극

### 11.1 중복극
$$
H(z)=\frac{1}{(1-p z^{-1})^2}
\quad\Longrightarrow\quad
h[n]=n\,p^n u[n].
$$

### 11.2 복소 켤레극
$$
H(z)=\frac{1}{1-2r\cos\Omega_0\, z^{-1}+r^2 z^{-2}}
\quad\Longrightarrow\quad
h[n]=\frac{1}{\sin \Omega_0}\,r^n \sin\!\big((n+1)\Omega_0\big)\,u[n],
$$
크기 응답 봉우리는 단위원 상의 $$e^{\pm j\Omega_0}$$ 근처에서 형성된다.

---

## 12. 일측 Z-변환(참고)와 초기/최종값 정리

### 12.1 일측 정의
$$
\mathcal{Z}_+\{x[n]\}=\sum_{n=0}^{\infty} x[n] z^{-n}.
$$

### 12.2 초기/최종값 정리(조건 하)
$$
x[0]=\lim_{z\to\infty} X_+(z),\qquad
\lim_{n\to\infty} x[n]=\lim_{z\to 1}(1-z^{-1})X_+(z).
$$
초기조건을 포함한 LCCDE 해석에 유리하다. 양측 변환은 신호 전체를 다루고 **ROC로 좌/우/양측을 구분**한다.

---

## 13. 종합 예제 — 차분방정식 → $$H(z)$$ → $$h[n]$$ → DTFT → 검증

### 13.1 문제
$$
y[n]-1.2y[n-1]+0.36y[n-2]=x[n]+0.5x[n-1].
$$

### 13.2 해설
$$
H(z)=\frac{1+0.5 z^{-1}}{1-1.2 z^{-1}+0.36 z^{-2}}
=\frac{1+0.5 z^{-1}}{(1-0.6 z^{-1})^2}.
$$
- 극: $$p=0.6$$ (중복극, 단위원 내부) → 인과+안정 가능.
- 부분분수:
$$
\frac{1+0.5 z^{-1}}{(1-0.6 z^{-1})^2}
=\frac{A}{1-0.6 z^{-1}}+\frac{B}{(1-0.6 z^{-1})^2},
$$
계수 비교로 $$A,B$$ 를 구하면
$$
h[n]=(A\cdot 0.6^n + B\cdot n\cdot 0.6^n)\,u[n].
$$

### 13.3 Octave 검증

```octave
clear; close all; clc; pkg load signal

b = [1 0.5];
a = [1 -1.2 0.36];

[H, w] = freqz(b, a, 4096);
subplot(2,2,1); plot(w/pi, 20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
subplot(2,2,2); plot(w/pi, unwrap(angle(H))); grid on; title('phase');

N = 140; h = impz(b, a, N); n = 0:N-1;
subplot(2,1,2); stem(n, h, '.'); grid on; title('h[n]');

[r,p,k] = residuez(b,a);
h_pf = zeros(size(n));
for i=1:numel(p), h_pf += r(i)*(p(i).^n); endfor
printf("RMS err(PF vs impz)=%.3e\n", rms(h_pf - h));
```

---

## 14. 자주 쓰는 Z-변환 표(요약)

| 신호 $$x[n]$$ | $$X(z)$$ | ROC | 메모 |
|---|---|---|---|
| $$\delta[n]$$ | $$1$$ | $$0<|z|<\infty$$ | |
| $$\delta[n-n_0]$$ | $$z^{-n_0}$$ | 전체 | 시프트 |
| $$a^n u[n]$$ | $$\dfrac{1}{1-a z^{-1}}$$ | $$|z|>|a|$$ | 우측 |
| $$-a^{\,n-1}u[-n-1]$$ | $$\dfrac{-z}{z-a}$$ | $$|z|<|a|$$ | 좌측 |
| $$n a^n u[n]$$ | $$\dfrac{a z^{-1}}{(1-a z^{-1})^2}$$ | $$|z|>|a|$$ | 중복극 |
| $$x[n-n_0]$$ | $$z^{-n_0}X(z)$$ | ROC 동일 | 시간 이동 |
| $$a^n x[n]$$ | $$X(z/a)$$ | 반지름 스케일 | 지수 곱 |
| $$x[-n]$$ | $$X(z^{-1})$$ | 반전 ROC | 시간 반전 |

---

## 15. 실무 체크리스트

1) **ROC 먼저 고정**: 같은 유리함수도 ROC에 따라 다른 $$x[n]$$.
2) **안정/인과 판정**: 단위원 포함 ↔ 안정, 무한대 포함 ↔ 인과(우측).
3) **DTFT 존재성**: 단위원이 ROC에 포함되어야 한다.
4) **부분분수/잔여**: 중복극·켤레극 처리, ROC에 맞는 좌/우 해석.
5) **수치 검증**: `impz`/`freqz`/`residuez`/직접합으로 상호 교차 점검.
6) **모델링 일관성**: $$z^{-1}$$ 다항식 vs $$z$$ 다항식 계수 순서 주의(`roots`, `poly` 사용 시 관례 확인).

---

## 16. 결론
양측 Z-변환은 **DTFT–LTI–차분방정식**을 하나의 복소평면 언어로 통합한다. 핵심은 **ROC와 극/영점**이다. 이를 정확히 해석하면 **안정·인과·스펙트럼**이 한눈에 들어오고, 역변환은 **부분분수·잔여정리**로 체계화된다.
본문의 Octave 루틴으로 **정의–성질–복원–검증**을 즉시 재현하고, 실제 필터/시스템 설계에서도 확신을 가지고 적용하라.
