---
layout: post
title: 미적분 - 극좌표계
date: 2025-07-17 20:20:23 +0900
category: 미적분
---
# 극좌표계 (Polar Coordinates)

## 극좌표계란?

한 점의 위치를 **거리(반지름) \(r\)**와 **각도 \(\theta\)**로 나타내는 좌표계.
- \(r\ge 0\): 원점(극점)으로부터의 거리
- \(\theta\): 양의 x축에서 반시계 방향의 각(라디안)

점의 표기: \((r,\theta)\).
예) \(\bigl(3,\ \frac{\pi}{4}\bigr)\): 원점에서 거리 3, x축에서 \(45^\circ\) 방향.

> **주의**
> 표현은 **유일하지 않음**. \((r,\theta)\equiv(-r,\theta+\pi)\), \((r,\theta+2k\pi)\) 등.

---

## 직교좌표계와의 변환 (Polar ↔ Cartesian)

### 극 → 직교

$$
x=r\cos\theta,\qquad y=r\sin\theta.
$$

### 직교 → 극

$$
r=\sqrt{x^2+y^2},\qquad \theta=\operatorname{atan2}(y,x).
$$

- \(\operatorname{atan2}(y,x)\)를 쓰면 **사분면 문제**를 자동 해결.
- \(\theta\)는 보통 \((-\pi,\pi]\) 또는 \([0,2\pi)\)로 정규화.

---

## 극좌표에서 곡선

극좌표 곡선은 보통
$$
r=f(\theta)
$$
형태로 주어진다. (각도에 따라 반지름이 결정)

### 대표 예시

- **원**: \(r=a\) → 원점 중심, 반지름 \(a\).
- **직선**: \(\theta=\alpha\) → 원점 지나는 직선(각 \(\alpha\)).
- **장미곡선**: \(r=a\cos(n\theta)\) 또는 \(r=a\sin(n\theta)\)
  - \(n\) 홀수 → 꽃잎 \(n\)개, 짝수 → \(2n\)개.
- **카디오이드/리마송**: \(r=a(1\pm\cos\theta)\), \(r=a(1\pm\sin\theta)\)
- **아르키메데스 나선**: \(r=a\theta\)
- **로그 나선**: \(r=ae^{b\theta}\)
- **원점 초점의 원뿔곡선**: \(r=\dfrac{\ell}{1+e\cos(\theta-\theta_0)}\) (이심률 \(e\), 준선거리 \(\ell\))

---

## 미소요소와 기본 공식

### 미소 호길이

극좌표 곡선 \(r=f(\theta)\)의 미소 호길이:
$$
ds=\sqrt{r^2+\left(\frac{dr}{d\theta}\right)^2}\,d\theta.
$$

### 면적 (부채꼴 합성)

극좌표에서 \(\theta\in[\alpha,\beta]\) 구간의 면적:
$$
A=\frac12\int_{\alpha}^{\beta} \bigl(r(\theta)\bigr)^2\,d\theta.
$$

### 곡선 길이

$$
L=\int_{\alpha}^{\beta}\sqrt{r^2+\left(\frac{dr}{d\theta}\right)^2}\,d\theta.
$$

### 접선 기울기/수직·수평 접선

매개형 \(x=r\cos\theta,\ y=r\sin\theta\).
\(\displaystyle \frac{dy}{dx}=\frac{dy/d\theta}{dx/d\theta}\)에서
$$
\frac{dy}{dx}=\frac{r'(\theta)\sin\theta+r(\theta)\cos\theta}{r'(\theta)\cos\theta-r(\theta)\sin\theta}.
$$
- 분모 \(=0\) → **수직 접선**, 분자 \(=0\) → **수평 접선**.

### 접선방향(궤도 각)과 곡률

- 접선이 반지름 벡터와 이루는 각 \(\psi\):
  $$
  \tan\psi=\frac{r}{dr/d\theta}.
  $$
- 곡률(참고):
  $$
  \kappa=\frac{r^2+2(r')^2-r\,r''}{\bigl(r^2+(r')^2\bigr)^{3/2}}.
  $$

---

## 이중적분(평면적분)과 야코비안

극좌표의 야코비안: \(|J|=r\).
영역 \(R\)에 대해
$$
\iint_R f(x,y)\,dx\,dy
=\int_{\theta=\alpha}^{\beta}\int_{r=0}^{g(\theta)} f(r\cos\theta,r\sin\theta)\,r\,dr\,d\theta.
$$

### 원/원환 영역 예시

- 반지름 \(R\) 원판의 면적:
  $$
  A=\int_0^{2\pi}\int_0^R r\,dr\,d\theta
   =\int_0^{2\pi}\left[\frac{r^2}{2}\right]_0^R d\theta
   =\pi R^2.
  $$
- 고리 \(a\le r\le b\): 면적 \(\pi(b^2-a^2)\).

---

## 대표 예제 (정확값/해석/수치)

### 면적: 카디오이드 \(r=a(1+\cos\theta)\)

전체 영역 면적:
$$
A=\frac12\int_0^{2\pi} a^2(1+\cos\theta)^2\,d\theta
=\frac{a^2}{2}\int_0^{2\pi}(1+2\cos\theta+\cos^2\theta)\,d\theta.
$$
\(\int_0^{2\pi}\cos\theta\,d\theta=0,\ \int_0^{2\pi}\cos^2\theta\,d\theta=\pi\).
따라서
$$
A=\frac{a^2}{2}\,(2\pi+\pi)=\frac{3\pi a^2}{2}.
$$

### 꽃잎 하나의 면적: 장미 \(r=a\cos(n\theta)\)

한 꽃잎 영역(예: \(-\tfrac{\pi}{2n}\le\theta\le\tfrac{\pi}{2n}\)):
$$
A_{\text{petal}}=\frac12\int r^2 d\theta
=\frac12\int_{-\pi/(2n)}^{\pi/(2n)} a^2\cos^2(n\theta)\,d\theta.
$$
치환 \(u=n\theta\Rightarrow d\theta=du/n\), 적분 구간 \([-\pi/2,\pi/2]\):
$$
A_{\text{petal}}=\frac{a^2}{2n}\int_{-\pi/2}^{\pi/2}\cos^2 u\,du
=\frac{a^2}{2n}\cdot\frac{\pi}{2}
=\frac{\pi a^2}{4n}.
$$

### 길이: 아르키메데스 나선 \(r=a\theta\), \(0\le\theta\le b\)

\(r'=a\).
$$
L=\int_0^b \sqrt{(a\theta)^2+a^2}\,d\theta
=a\int_0^b \sqrt{\theta^2+1}\,d\theta
=\frac{a}{2}\Bigl[\theta\sqrt{\theta^2+1}+\operatorname{asinh}\theta\Bigr]_0^b.
$$
따라서
$$
L=\frac{a}{2}\left(b\sqrt{b^2+1}+\operatorname{asinh} b\right).
$$

### 길이: 카디오이드 \(r=a(1+\cos\theta)\)

\(r'=-a\sin\theta\).
\(r^2+(r')^2=a^2\bigl((1+\cos\theta)^2+\sin^2\theta\bigr)=2a^2(1+\cos\theta)=4a^2\cos^2(\tfrac{\theta}{2})\).
따라서 \(\sqrt{\cdot}=2a|\cos(\theta/2)|\).
$$
L=\int_0^{2\pi}2a|\cos(\tfrac{\theta}{2})|\,d\theta
=4a\int_0^{\pi}|\cos u|\,du=4a\cdot 2=8a.
$$

### (한 루프 면적)

\(|\theta|\le\pi/4\)에서 \(r^2\ge 0\).
$$
A_{\text{loop}}=\frac12\int_{-\pi/4}^{\pi/4} a^2\cos 2\theta\,d\theta
=\frac{a^2}{4}\Bigl[\sin 2\theta\Bigr]_{-\pi/4}^{\pi/4}
=\frac{a^2}{4}(1-(-1))=\frac{a^2}{2}.
$$

### 수치적분 스케치 (면적/길이)

```python
# 극곡선 r=f(theta)의 면적/길이 수치계산 (적응형 심프슨 스케치)

import math

def area_polar(f, a, b, eps=1e-10):
    g = lambda th: 0.5 * f(th)**2
    def S(F, x0, x1):
        c = 0.5*(x0+x1)
        return (x1-x0)*(F(x0)+4*F(c)+F(x1))/6
    def A(F, x0, x1, Sx, tol):
        c = 0.5*(x0+x1)
        S1, S2 = S(F, x0, c), S(F, c, x1)
        if abs(S1+S2 - Sx) < 15*tol:
            return S1+S2 + (S1+S2 - Sx)/15
        return A(F, x0, c, S1, tol/2) + A(F, c, x1, S2, tol/2)
    return A(g, a, b, S(g,a,b), eps)

def length_polar(f, fp, a, b, eps=1e-10):
    g = lambda th: math.hypot(f(th), fp(th))  # sqrt(r^2 + r'^2)
    # 이하 동일
    def S(F, x0, x1):
        c = 0.5*(x0+x1)
        return (x1-x0)*(F(x0)+4*F(c)+F(x1))/6
    def A(F, x0, x1, Sx, tol):
        c = 0.5*(x0+x1)
        S1, S2 = S(F, x0, c), S(F, c, x1)
        if abs(S1+S2 - Sx) < 15*tol:
            return S1+S2 + (S1+S2 - Sx)/15
        return A(F, x0, c, S1, tol/2) + A(F, c, x1, S2, tol/2)
    return A(g, a, b, S(g,a,b), eps)

# 예: r = a(1+cosθ), a=1

f  = lambda th: 1.0*(1.0+math.cos(th))
fp = lambda th: -1.0*math.sin(th)

A = area_polar(f, 0.0, 2*math.pi)
L = length_polar(f, fp, 0.0, 2*math.pi)
print(A, L)  # 이론값: A=1.5π, L=8
```

---

## 직선·원뿔곡선의 극좌표 방정식

### 직선(원점에서 거리 \(d\), 법선 각 \(\alpha\))

원점에서 거리 \(d\), 법선 방향 \(\alpha\)인 직선:
$$
r\cos(\theta-\alpha)=d.
$$
- 원점을 지나면 \(d=0\Rightarrow \cos(\theta-\alpha)=0\Rightarrow \theta=\alpha\pm\frac{\pi}{2}\) (극식 표현의 중복성 주의).

### 원뿔곡선(초점 원점, 이심률 \(e\), 준선거리 \(\ell\))

$$
r=\frac{\ell}{1+e\cos(\theta-\theta_0)}.
$$
- \(e<1\): 타원, \(e=1\): 포물선, \(e>1\): 쌍곡선.
- \(\theta_0\): 주축 방향.

---

## 미분기하: 접선·법선·곡률 (요약)

곡선 \(r(\theta)\)에서
- **방향벡터**: \(\mathbf{r}(\theta)=\langle r\cos\theta,\ r\sin\theta\rangle\)
  \(\displaystyle \mathbf{r}'=\langle r'\cos\theta-r\sin\theta,\ r'\sin\theta+r\cos\theta\rangle\).
- **접선기울기**: 앞의 \(\frac{dy}{dx}\) 공식을 사용.
- **법선**: 접선에 수직.
- **곡률**: \(\displaystyle \kappa=\frac{|x'y''-y'x''|}{\bigl((x')^2+(y')^2\bigr)^{3/2}}\) 를 극표현으로 정리하면 4.5식.

---

## 벡터해석(2D)에서의 극좌표 미분 연산자

극 단위벡터 \(\mathbf{e}_r=\langle\cos\theta,\sin\theta\rangle,\ \mathbf{e}_\theta=\langle-\sin\theta,\cos\theta\rangle\).
- **그래디언트**: \( \nabla f = f_r\,\mathbf{e}_r + \frac{1}{r}f_\theta\,\mathbf{e}_\theta \)
- **발산**: \( \nabla\cdot\mathbf{A} = \frac{1}{r}\frac{\partial}{\partial r}(rA_r)+\frac{1}{r}\frac{\partial A_\theta}{\partial\theta} \)
- **컬(스칼라 z-성분)**: \( (\nabla\times\mathbf{A})_z = \frac{1}{r}\frac{\partial}{\partial r}(rA_\theta)-\frac{1}{r}\frac{\partial A_r}{\partial\theta} \)

> 전자기학·유체 분야에서 원형/회전 대칭 문제에 필수.

---

## 복소수와 극좌표

복소수 평면 \(z=x+iy\)에서 극형식:
$$
z=re^{i\theta}=r(\cos\theta+i\sin\theta).
$$
- 곱셈: \(r_1e^{i\theta_1}\cdot r_2e^{i\theta_2}= (r_1r_2)e^{i(\theta_1+\theta_2)}\).
- 거듭제곱: \(z^n=r^n e^{in\theta}\) (드무아브르).
- \(n\)제곱근: \(r^{1/n} e^{i(\theta+2k\pi)/n}\), \(k=0,\dots,n-1\) (정\(n\)각형으로 배치).

---

## 실전 팁 & 함정 체크리스트

- [ ] \(\theta\) **라디안**인지 도 단위인지 명확히(미적분/수식은 **라디안** 전제).
- [ ] \((r,\theta)\equiv(-r,\theta+\pi)\) → **표현 중복** 주의.
- [ ] **영점/교점** 구할 때 \(r(\theta)=0\)의 해와 주기 \(2\pi\)를 고려.
- [ ] **면적 공식**은 \(r^2\)로 **부호 영향 없음**.
- [ ] **길이**는 \(\sqrt{r^2+(r')^2}\)이므로 급격한 변화 구간은 **세분 적분**.
- [ ] \(\theta\) 경계에서 **연결성** 확인(예: \([0,2\pi]\)와 \((-\pi,\pi]\) 전환).
- [ ] 수치구현은 `atan2`, 적응형 적분, 샘플링 균등화(등호장 샘플링은 재매개화 필요).

---

## 시각화/수치 코드 예시

### 파이썬: 극곡선 플로팅(매트플롯립)

```python
import numpy as np
import matplotlib.pyplot as plt

def polar_plot(r_of_theta, th_min, th_max, N=2000, title="polar curve"):
    th = np.linspace(th_min, th_max, N)
    r  = r_of_theta(th)
    x, y = r*np.cos(th), r*np.sin(th)

    plt.figure()
    plt.plot(x, y)
    plt.gca().set_aspect('equal', 'box')
    plt.title(title)
    plt.xlabel('x'); plt.ylabel('y'); plt.grid(True)
    plt.show()

# 예: 장미 r = cos(3θ)

polar_plot(lambda th: np.cos(3*th), -np.pi, np.pi, title="r = cos(3θ)")

# 예: 카디오이드 r = 1 + cos θ

polar_plot(lambda th: 1 + np.cos(th), 0, 2*np.pi, title="r = 1 + cos θ")

# 예: 아르키메데스 나선 r = 0.2 θ (0~6π)

polar_plot(lambda th: 0.2*th, 0, 6*np.pi, title="r = 0.2 θ")
```

### 접선 기울기/수평·수직 접선 찾기

```python
import numpy as np

def polar_slope(r, rp, th):
    num = rp(th)*np.sin(th) + r(th)*np.cos(th)
    den = rp(th)*np.cos(th) - r(th)*np.sin(th)
    return num/den

# 예: r = 1 + cosθ

r  = lambda th: 1 + np.cos(th)
rp = lambda th: -np.sin(th)

ths = np.linspace(0, 2*np.pi, 10001)
num = rp(ths)*np.sin(ths) + r(ths)*np.cos(ths)
den = rp(ths)*np.cos(ths) - r(ths)*np.sin(ths)

horiz = ths[np.isclose(num, 0, atol=1e-6)]  # 수평 접선 후보
vert  = ths[np.isclose(den, 0, atol=1e-6)]  # 수직 접선 후보
print("수평 접선 θ:", horiz[:10], "... (총", len(horiz), ")")
print("수직 접선 θ:", vert[:10],  "... (총", len(vert),  ")")
```

### 예: 평균 반지름 계산

영역 \(r\in[0,f(\theta)]\), \(\theta\in[\alpha,\beta]\)에서 평균 반지름
$$
\bar r=\frac{\iint r\,dA}{\iint dA}
=\frac{\int_\alpha^\beta\int_0^{f(\theta)} r\cdot r\,dr\,d\theta}
{\int_\alpha^\beta\int_0^{f(\theta)} r\,dr\,d\theta}.
$$
```python
import numpy as np

def mean_radius(f, th_min, th_max, M=2000, K=2000):
    th = np.linspace(th_min, th_max, M)
    num = 0.0
    den = 0.0
    for t in th:
        rmax = f(t)
        rs = np.linspace(0.0, rmax, K)
        num += np.trapz(rs*rs, rs)  # ∫ r^2 dr
        den += np.trapz(rs, rs)     # ∫ r   dr
    num = np.trapz(num*np.ones_like(th), th)
    den = np.trapz(den*np.ones_like(th), th)
    return num/den

f = lambda th: 1 + 0.5*np.cos(th)
print("평균 반지름 ≈", mean_radius(f, 0.0, 2*np.pi, 400, 400))
```

---

## 연습문제 (정답 스케치 포함)

1) \(r=2\sin\theta\)의 면적(0부터 \(\pi\)까지).
   **해**: \(\frac12\int_0^\pi 4\sin^2\theta\,d\theta=2\cdot\frac{\pi}{2}=\pi\).

2) \(r=a\cos\theta\)의 원 내부(오른쪽 반원) 면적.
   **해**: \(\theta\in[-\pi/2,\pi/2]\), \(A=\frac12\int a^2\cos^2\theta\,d\theta=\frac{a^2}{2}\cdot\frac{\pi}{2}=\frac{\pi a^2}{4}\).

3) \(r=\theta\) (\(0\le\theta\le 2\pi\))의 길이.
   **해**: 6.3식에서 \(a=1,\ b=2\pi\) 대입:
   \(\displaystyle L=\frac12\bigl(2\pi\sqrt{1+4\pi^2}+\operatorname{asinh}(2\pi)\bigr)\).

4) \(r=1+\cos\theta\)의 수평/수직 접선 \(\theta\) 찾기.
   **해**: \(\frac{dy}{dx}\) 분자=0(수평), 분모=0(수직). 수치/해석으로 \(\theta=0,\pi\) 등 도출.

5) 레무니스케이트 \(r^2=2\cos2\theta\)의 한 루프 면적.
   **해**: 6.5과 동일 구조, \(a^2=2\Rightarrow A=1\).

6) 원뿔곡선 \(r=\dfrac{\ell}{1+e\cos\theta}\). \(e<1\)일 때 근점/원점에서의 반지름.
   **해**: \(\theta=0\Rightarrow r_{\min}=\frac{\ell}{1+e}\), \(\theta=\pi\Rightarrow r_{\max}=\frac{\ell}{1-e}\).

7) 장미 \(r=\sin(4\theta)\) 꽃잎 하나의 면적.
   **해**: \(n=4\Rightarrow A=\dfrac{\pi}{16}\) (일반식 \(\frac{\pi a^2}{4n}\), 여기 \(a=1\)).

---

## 정리 요약

- 변환: \(x=r\cos\theta,\ y=r\sin\theta\), \(\theta=\operatorname{atan2}(y,x)\).
- 면적: \(\displaystyle A=\frac12\int r^2\,d\theta\).
- 길이: \(\displaystyle L=\int \sqrt{r^2+(r')^2}\,d\theta\).
- 접선 기울기: \(\displaystyle \frac{dy}{dx}=\frac{r'\sin\theta+r\cos\theta}{r'\cos\theta-r\sin\theta}\).
- 이중적분: \(\displaystyle \iint f\,dxdy=\int\!\!\int f(r\cos\theta,r\sin\theta)\,r\,dr\,d\theta\).
- 장점: 회전/방사 대칭 문제에서 **표현·계산 모두 간결**.
- 실무: `atan2`·적응형 적분·라디안 단위·경계 사후 검증 필수.
