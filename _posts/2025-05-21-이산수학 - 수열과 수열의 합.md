---
layout: post
title: 이산수학 - 수열과 수열의 합
date: 2025-05-21 20:20:23 +0900
category: 이산수학
---
# 수열과 수열의 합 — 이산수학에서의 수적 패턴 탐구

## 학습 로드맵

- 수열을 **함수** 관점으로 정의한다: $$a:\mathbb{N}\to \mathbb{F}$$.
- 대표 수열(등차·등비·다항·교대·조화·계승·피보나치 등)의 **일반항**, **합**, **점화식**을 유도한다.
- 합을 구하는 **기술**: 지수화/소거(geometric trick), 망원형(telecoping), 지표 이동, 부분합, 이항정리, 부분분수, 생성함수.
- **선형 점화식** 해법(특성방정식, 부분해)과 **생성함수**(OGF) 기초를 적용한다.
- 파이썬으로 **검산 퍼저**와 고정밀 연산(분수, 행렬 거듭제곱)을 구현한다.

---

## 수열의 정의와 표기

**정의**: 수열은 자연수 인덱스를 값(실수/정수/복소 등)에 대응시키는 함수이다.

$$
a:\mathbb{N}\to \mathbb{F},\quad n\mapsto a_n.
$$

표기:
- 항: $$a_1,a_2,\dots,a_n,\dots$$
- 집합이 아닌 **순서 있는 나열**이며, **중복 허용**.

예:
```text
(2,5,8,11,...)   (등차, d=3)
(3,6,12,24,...)  (등비, r=2)
(1,4,9,16,...)   (제곱수, a_n=n^2)
```

---

## 대표 수열

### 등차수열

$$
a_n=a_1+(n-1)d.
$$
합:
$$
S_n=\sum_{k=1}^n a_k=\frac{n(a_1+a_n)}{2}
=\frac{n}{2}\big(2a_1+(n-1)d\big).
$$

**증명(짝짓기)**: $$S_n=a_1+a_2+\cdots+a_n$$ 과 역순 합을 더하면 각 쌍이 $$a_1+a_n$$ 이다. 쌍이 $$n$$ 개이므로 $$2S_n=n(a_1+a_n)$$.

### 등비수열

$$
a_n=a_1 r^{n-1}.
$$
부분합(공비 $$r\ne 1$$):
$$
S_n=\sum_{k=1}^n a_1 r^{k-1}
=a_1\,\frac{1-r^n}{1-r}.
$$
**증명(지수화-소거)**: $$S_n-rS_n=a_1-a_1 r^n$$.

무한등비급수(절댓값 수렴 조건 $$|r|<1$$):
$$
S_\infty=\sum_{k=1}^{\infty} a\, r^{k-1}=\frac{a}{1-r}.
$$

### 다항수열과 계차

- $$a_n=n^2$$ 의 1차 차분은 $$\Delta a_n=a_{n+1}-a_n=2n+1$$(등차).
- 일반적으로 **차수 $$m$$ 다항수열의 $$m$$-차 차분은 상수**.

### 교대수열

- 부호가 번갈아 바뀌는 수열: $$a_n=(-1)^{n-1}b_n$$.
- 합에서 **소거**와 **조건부 수렴** 이슈가 자주 등장(해석학에서는 수렴성 판단이 필요).

### 조화수열과 조화급수

- $$a_n=\frac{1}{n}$$, 부분합 $$H_n=\sum_{k=1}^n \frac{1}{k}$$ (발산).
- 이산수학에서는 근사: $$H_n=\ln n+\gamma+o(1)$$ (여기서 $$\gamma$$ 는 오일러-마스케로니 상수).

### 계승수열

- $$a_n=n!$$, 이항계수 $$\binom{n}{k}=\frac{n!}{k!(n-k)!}$$.

### 피보나치

- $$F_1=1,\ F_2=1,\ F_{n}=F_{n-1}+F_{n-2}$$.
- 닫힌형(Binet):
$$
F_n=\frac{\phi^n-\psi^n}{\phi-\psi},\quad \phi=\frac{1+\sqrt{5}}{2},\ \psi=\frac{1-\sqrt{5}}{2}.
$$

---

## 수열의 합(Series) 기초

표기:
$$
\sum_{k=1}^{n} a_k = a_1+a_2+\cdots+a_n.
$$

지표 이동:
$$
\sum_{k=0}^{n} a_{k+1}=\sum_{j=1}^{n+1} a_j \quad (j=k+1).
$$

부분합 정의:
$$
S_n=\sum_{k=1}^{n}a_k,\quad a_n=S_n-S_{n-1}\ (n\ge 2),\ S_1=a_1.
$$

---

## 합을 구하는 기술들

### 망원형(텔레스코핑)

차분형 항이 누적 소거되는 구조.

예:
$$
\sum_{k=1}^{n}\left(\frac{1}{k}-\frac{1}{k+1}\right)=1-\frac{1}{n+1}.
$$

**증명**: 전개하면 중간항이 모두 상쇄.

### 부분분수

유리식 항 분해 후 망원형을 만든다.

예:
$$
\frac{1}{k(k+1)}=\frac{1}{k}-\frac{1}{k+1}
\ \Rightarrow\
\sum_{k=1}^{n}\frac{1}{k(k+1)}=1-\frac{1}{n+1}.
$$

### 등비 트릭(지수화-소거)

지수 꼴 합은 배율 후 빼서 소거.

예:
$$
\sum_{k=0}^{n-1} r^{k}=\frac{1-r^{n}}{1-r}\ (r\ne 1).
$$

### 이항정리 이용

$$
(1+x)^n=\sum_{k=0}^{n}\binom{n}{k}x^{k}.
$$
합의 예:
$$
\sum_{k=0}^{n}\binom{n}{k}=2^n,\qquad
\sum_{k=0}^{n}(-1)^k\binom{n}{k}=0\ (n\ge 1).
$$

### 지표 가중 합

$$
\sum_{k=0}^{n}k\binom{n}{k}=n2^{n-1},\quad
\sum_{k=0}^{n}k^2\binom{n}{k}=n(n+1)2^{n-2}.
$$
**스케치**: 생성함수 미분 또는 이항항등식으로 유도.

### 부분합 재귀

부분합 정의를 활용해 재귀를 쓰거나, **지표 이동 후 뺄셈**으로 망원형을 만든다.

### 합·차 교환/지표 치환

지표를 바꿔 **같은 합을 다른 모양**으로 바꾸면 패턴이 보이는 경우가 많다.

---

## 선형 점화식(상수계수) 해법

형태:
$$
a_n=c_1 a_{n-1}+c_2 a_{n-2}+\cdots+c_m a_{n-m}+f(n).
$$

### 동차식 $$f(n)=0$$

특성방정식:
$$
\lambda^m-c_1\lambda^{m-1}-\cdots-c_m=0.
$$
서로 다른 근 $$\lambda_1,\dots,\lambda_m$$ 이면
$$
a_n=A_1\lambda_1^n+\cdots+A_m\lambda_m^n.
$$
중근이나 복소근도 표준 형태로 처리(중근이면 다항곱, 복소근은 실수형으로 변환).

예(피보나치):
$$
\lambda^2=\lambda+1 \Rightarrow \lambda=\phi,\psi.
$$

### 비동차식

특별해 $$a_n^{(p)}$$ 를 찾고, 전체해 $$a_n=a_n^{(h)}+a_n^{(p)}$$.
- $$f(n)$$ 이 다항이면 **다항 가정**, 지수면 **지수 가정**, 지수·다항 곱이면 그 형태 가정.
- 동특성근과 겹치면 **차수 승수 곱**.

예:
$$
a_n=2a_{n-1}+3^n,\ a_0=0.
$$
- 동차해: $$C\cdot 2^n$$
- 특별해 가정: $$A\cdot 3^n$$, 대입하면 $$A3^n=2A3^{n-1}+3^n \Rightarrow A=\frac{3}{1}$$ 이 아님에 주의. 정확히
$$
A3^n=2A3^{n-1}+3^n \Rightarrow A3^n=\frac{2A}{3}3^n+3^n \Rightarrow A=\frac{2A}{3}+1 \Rightarrow \frac{A}{3}=1 \Rightarrow A=3.
$$
따라서 $$a_n=C2^n+3\cdot 3^n$$, $$a_0=0 \Rightarrow C=-3$$, $$a_n=3^n-3\cdot 2^n$$.

---

## 생성함수(OGF) 초급

수열 $$a_0,a_1,\dots$$ 의 **보통 생성함수**:
$$
A(x)=\sum_{n\ge 0} a_n x^n.
$$

### 등비형

$$
\sum_{n\ge 0}x^n=\frac{1}{1-x},\quad |x|<1.
$$

### 등차의 부분합

$$
\sum_{n\ge 0} n x^n=\frac{x}{(1-x)^2},\qquad
\sum_{n\ge 0} n^2 x^n=\frac{x(1+x)}{(1-x)^3}.
$$
**스케치**: $$\frac{1}{1-x}$$ 를 미분해 계수에 **지표 가중**을 부여.

### 점화식→유리함수

피보나치 $$F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}$$ 의 OGF:
$$
F(x)=\sum_{n\ge 0}F_n x^n=\frac{x}{1-x-x^2}.
$$
이후 부분분수 전개로 Binet을 복구 가능.

---

## 자주 쓰는 합 공식 모음

- 산술합:
$$
\sum_{k=1}^{n}k=\frac{n(n+1)}{2},\quad
\sum_{k=1}^{n}k^2=\frac{n(n+1)(2n+1)}{6},\quad
\sum_{k=1}^{n}k^3=\left(\frac{n(n+1)}{2}\right)^2.
$$
- 기하합:
$$
\sum_{k=0}^{n-1} r^k=\frac{1-r^n}{1-r}\ (r\ne 1).
$$
- 교대 산술합:
$$
\sum_{k=1}^{n}(-1)^{k-1}=\begin{cases}
1 & \text{n 홀수}\\
0 & \text{n 짝수}
\end{cases}
$$
- 망원형:
$$
\sum_{k=1}^{n}\frac{1}{k(k+1)}=1-\frac{1}{n+1}.
$$
- 이항계수:
$$
\sum_{k=0}^{n}\binom{n}{k}=2^{n},\
\sum_{k=0}^{n}k\binom{n}{k}=n2^{n-1},\
\sum_{k=0}^{n}k^2\binom{n}{k}=n(n+1)2^{n-2}.
$$

---

## 합의 증명 예시

### $$\sum_{k=1}^{n}k^2=\frac{n(n+1)(2n+1)}{6}$$ (귀납)

- 기초 $$n=1$$ 확인.
- 가정: $$\sum_{k=1}^{m}k^2=\frac{m(m+1)(2m+1)}{6}$$.
- 단계:
$$
\sum_{k=1}^{m+1}k^2=\frac{m(m+1)(2m+1)}{6}+(m+1)^2
=\frac{(m+1)(m+2)(2m+3)}{6}.
$$
정확한 전개는 뺄셈/인수분해로 맞춤.

### 망원형 합

$$
\sum_{k=1}^{n} \left(\frac{1}{k}-\frac{1}{k+1}\right)=1-\frac{1}{n+1}.
$$
전개하여 중간항 상쇄.

### 등비 부분합

위 2.2의 지수화-소거법.

---

## 조합적 해석이 주는 직관

- $$\sum_{k=0}^{n}\binom{n}{k}=2^n$$ 은 원소 선택의 모든 부분집합 개수.
- $$\sum_{k=0}^{n}k\binom{n}{k}=n2^{n-1}$$ 은 “선택된 집합에서 특정 원소가 선택되는 경우의 수”로 이중계산.

---

## 복잡도와 합의 근사

- 선형: $$\sum_{k=1}^{n}1=\Theta(n)$$
- 로그: $$\sum_{k=1}^{n}\frac{1}{k}=\Theta(\log n)$$
- 다항: $$\sum_{k=1}^{n}k^p=\Theta(n^{p+1})$$
- 기하: $$\sum_{k=0}^{\lfloor \log_r n\rfloor} r^k=\Theta(n)$$ when $$r>1$$.

알고리즘 분석에서 반복문 비용은 대개 위의 표준 합으로 환원된다.

---

## 파이썬 구현과 검산

주의:
- 정수 나눗셈 `//` 은 내림 나눗셈이다. 일반 합 공식에서는 `/` 를 쓰거나 `fractions.Fraction` 사용.
- 큰 수는 파이썬이 자동으로 arbitrary precision 정수를 지원.
- 부동소수 근사는 오차 누적을 초래할 수 있으므로 분수/정수 기반 권장.

### 등차/등비/피보나치

```python
from fractions import Fraction

def arithmetic_nth(a1, d, n):
    return a1 + (n-1)*d

def arithmetic_sum(a1, d, n):
    # S_n = n/2 * (2a1 + (n-1)d)
    return Fraction(n, 2) * (2*a1 + (n-1)*d)

def geometric_nth(a1, r, n):
    return a1 * (r**(n-1))

def geometric_sum(a1, r, n):
    if r == 1:
        return a1 * n
    # S_n = a1 * (1 - r^n) / (1 - r)
    return a1 * Fraction(1 - r**n, 1 - r)

def fibonacci(n):
    if n <= 0:
        raise ValueError("n must be positive")
    a, b = 1, 1
    if n <= 2:
        return 1
    for _ in range(n-2):
        a, b = b, a + b
    return b

print(arithmetic_sum(1, 1, 100))   # 5050
print(geometric_sum(2, 2, 5))      # 62
print(fibonacci(10))               # 55
```

### 피보나치 빠른 거듭제곱(행렬/더블링)

```python
def fib_fast_doubling(n):
    # returns (F_n, F_{n+1})
    if n == 0:
        return (0, 1)
    a, b = fib_fast_doubling(n >> 1)
    c = a * (2*b - a)
    d = a*a + b*b
    if n & 1:
        return (d, c + d)
    else:
        return (c, d)

print(fib_fast_doubling(10)[0])  # 55
```

### 망원형/부분분수 검산 퍼저

```python
import random

def telescoping_sum(n):
    return sum((1/k - 1/(k+1)) for k in range(1, n+1))

for n in [5, 10, 100]:
    left = telescoping_sum(n)
    right = 1 - 1/(n+1)
    assert abs(left - right) < 1e-12

def partial_fraction_sum(n):
    return sum(1/(k*(k+1)) for k in range(1, n+1))

for n in [5, 10, 100]:
    left = partial_fraction_sum(n)
    right = 1 - 1/(n+1)
    assert abs(left - right) < 1e-12
```

### 이항계수 항등식 검산

```python
from math import comb

def check_binomial_identities(nmax=12):
    for n in range(nmax+1):
        s0 = sum(comb(n,k) for k in range(n+1))
        assert s0 == 2**n
        s1 = sum(k*comb(n,k) for k in range(n+1))
        assert s1 == n * 2**(n-1)
        s2 = sum(k*k*comb(n,k) for k in range(n+1))
        assert s2 == n*(n+1) * 2**(n-2)
    return True

print(check_binomial_identities())
```

---

## 실전 시나리오

### 금융: 기하급수 이자

초기액 $$P$$, 월이자율 $$r$$, 월 납입액 $$c$$, 기간 $$n$$.

- 순예치가 없을 때: $$A_n=Pr^n$$.
- 매월 동일 납입:
$$
A_n = Pr^n + c\sum_{k=0}^{n-1} r^k = Pr^n + c\frac{1-r^n}{1-r}.
$$

### 알고리즘: 이중 루프 비용

다음 루프의 작업 수를 구하라.

```text
for i=1..n:
    for j=1..i:
        work += 1
```

합:
$$
\sum_{i=1}^{n} \sum_{j=1}^{i} 1 = \sum_{i=1}^{n} i = \frac{n(n+1)}{2}=\Theta(n^2).
$$

### 통신/신호: 기하급수 합의 창함수

유한 기하열은 길이 $$n$$ 의 **이산 창(convolution kernel)** 로 자주 나타난다.

---

## 연습문제(풀이 스케치 포함)

1) 망원형:
$$
\sum_{k=1}^{n}\frac{2k+1}{k(k+1)}\ \text{를 구하라.}
$$
힌트: 부분분수 분해 후 소거.

2) 교대 지수:
$$
\sum_{k=0}^{n}(-1)^k r^k\ \text{를 닫힌형으로.}
$$
정답:
$$
\frac{1-(-r)^{\,n+1}}{1+r},\ r\ne -1.
$$

3) 다항합:
$$
\sum_{k=1}^{n}k^3=\left(\frac{n(n+1)}{2}\right)^2\ \text{를 증명하라.}
$$
힌트: 좌변을 부분합으로 보고 유도하거나, 생성함수/귀납으로 처리.

4) 점화:
$$
a_n=3a_{n-1}-2,\ a_1=1\ \text{의 닫힌형.}
$$
해: 동차해 $$C\cdot 3^{n-1}$$, 특별해 상수 가정 $$A=1$$, $$a_n=C\cdot 3^{n-1}+1$$, 초기치로 $$C=0$$ 이 아님에 주의. 실제로
$$
a_1=1=C\cdot 3^{0}+1 \Rightarrow C=0,\ a_n=1.
$$
점검: $$1=3\cdot 1-2$$ 성립.

5) 이항계수 가중합:
$$
\sum_{k=0}^{n} k\binom{n}{k}x^{k} = nx(1+x)^{n-1}.
$$
힌트: $$(1+x)^n$$ 를 미분하고 $$x$$ 를 곱한다.

---

## 마무리

- 수열은 **함수**이고, 합은 **연산**이다.
- 등차·등비·망원형·이항정리·부분분수·생성함수는 합을 풀어내는 **표준 공구 상자**다.
- 선형 점화식은 **특성방정식**과 **특별해 가정**으로 닫힌형을 찾는다.
- 파이썬에서는 분수/정수 기반으로 **검산**하라. 유한 검사는 증명 대체가 아닌 **직관 보조**임을 명심하라.

이 글의 패턴을 반복 연습하면, 대부분의 경쟁 프로그래밍/알고리즘 분석/금융 수식 합산 문제에서 **몇 줄의 표준 테크닉**으로 빠르게 닫힌형을 도출할 수 있다.
