---
layout: post
title: 미적분 - 단조성, 오목성 그리고 도함수
date: 2025-06-24 20:20:23 +0900
category: 미적분
---
# 단조성·오목성(볼록성)과 도함수 전반 정리

단조성(증가/감소)과 오목성/볼록성은 **도함수의 부호**로 빠르게 판정할 수 있다.
여기서는 1계·2계 도함수와의 관계, 정확한 정의, 반례/주의점, 다변수 확장, 실전 절차, 시각화 코드까지 한 번에 정리한다.

---

## 한 장 요약 (지도)

- **증가/감소(단조성)**: $$f'(x)\ge 0\Rightarrow$$ 단조 증가, $$f'(x)\le 0\Rightarrow$$ 단조 감소 (평균값정리).
- **엄격 증가/감소**: $$f'(x)>0$$ 이 구간 전반에 걸쳐 유지되면 엄격 증가(감소도 유사).
  또는 $$f'(x)\ge 0$$ 이고 **어느 부분구간에서도** 항등적 0이 아니면 엄격 증가.
- **볼록/오목**: $$f''(x)\ge 0\Rightarrow$$ 볼록(convex), $$f''(x)\le 0\Rightarrow$$ 오목(concave).
  (매끄러움이 없더라도 정의로 판정 가능: 접선/현수선 비교, Jensen 부등식)
- **변곡점**: 오목성의 실제 전환(부호 변화). $$f''(c)=0$$ 은 흔한 신호지만 **필요충분 아님**.
- **다변수**: 헤시안 $$H=\nabla^2 f$$ 이 양의 준정부호 ⇒ 볼록, 음의 준정부호 ⇒ 오목.
  (또는 ⟨∇f(x)−∇f(y), x−y⟩의 비음/비양성으로 판정)

---

## 단조성(Monotonicity)의 정의와 1계 도함수
### 정의(단변수)

- **단조 증가(nondecreasing)**: $$x_1<x_2\Rightarrow f(x_1)\le f(x_2).$$
- **엄격 증가(strictly increasing)**: $$x_1<x_2\Rightarrow f(x_1)<f(x_2).$$
- 감소/엄격 감소도 부호만 반대로 정의.

### 평균값정리(MVT)로 연결

$$f$$ 가 구간 $$I$$ 에서 미분 가능하면 임의의 $$x_1<x_2$$ 에 대해
$$
\frac{f(x_2)-f(x_1)}{x_2-x_1}=f'(\xi)\quad(\xi\in(x_1,x_2)).
$$
따라서
- $$f'(x)\ge 0\ \forall x\in I\Rightarrow f(x_2)\ge f(x_1)$$ (단조 증가).
- $$f'(x)\le 0\Rightarrow$$ 단조 감소.
- $$f'(x)=0\Rightarrow$$ 상수함수.

> **엄격 증가 보장**: (i) $$f'(x)>0$$ 가 구간 전체에서 유지되면 충분.
> (ii) $$f'(x)\ge 0$$ 이지만 **어떤 부분구간에서도 항등적으로 0이 아닌 경우**에도 엄격 증가.

### 간단 예제

- $$f(x)=x^3:\ f'(x)=3x^2\ge 0$$ → **단조 증가**(단, $$x=0$$ 에서 $$f'=0$$ 가능).
- $$f(x)=e^x:\ f'(x)=e^x>0$$ → **엄격 증가**.
- $$f(x)=-\ln x\ (x>0):\ f'(x)=-1/x<0$$ → **엄격 감소**.

> **주의**: $$f'(c)=0$$ 이라도 극값이 아닐 수 있다(예: $$x^3$$ 은 변곡점).
> 극값 판정에는 **부호 변화(1차 판정)** 또는 **2계 판정**이 필요.

---

## 볼록성/오목성(Convexity/Concavity)과 2계 도함수
### 정의(접선/현수선 비교)

- **볼록(convex)**: 임의의 $$x_1,x_2$$, $$t\in[0,1]$$ 에 대해
$$
f(tx_1+(1-t)x_2)\le t f(x_1)+(1-t)f(x_2).
$$
(그래프는 **위로 볼록**; 모든 접선이 그래프 **아래**에 위치.)
- **오목(concave)**: 부등호 반대(접선이 그래프 **위**).

### 2계 판정 (스무스 가정)

- $$f''(x)>0\Rightarrow$$ 볼록, $$f''(x)<0\Rightarrow$$ 오목.
- $$f''(x)=0$$ 은 변곡점 **후보**에 불과. 실제 변곡점은 **오목성 부호 전환**으로 확인.

### 예제

- $$x^2$$: $$f''=2>0$$ → 항상 **볼록**.
- $$-x^2$$: $$f''=-2<0$$ → 항상 **오목**.
- $$x^3$$: $$f''=6x$$ → $$x<0$$ 오목, $$x>0$$ 볼록, $$x=0$$ 변곡점.

> **정확성**: 2계 도함수가 없어도 볼록/오목을 **정의**로 판정 가능 (예: 절댓값, 노름).
> 두 번 미분 가능하면 2계 판정이 **필요충분**이 되는 경우가 많다.

---

## 1·2계 도함수로 형태 분석 — 절차
### 표준 루틴(단변수)

1) **정의역** 확인(로그/분수/루트의 제약).
2) **1계 도함수**: $$f'(x)=0$$ 및 미분 불능점(코너) 계산 → **부호표** 작성(증가/감소).
3) **2계 도함수**: $$f''(x)=0$$ 후보 계산 → 오목/볼록, 변곡점 판정(부호 전환).
4) **극값 후보**: 임계점 + 경계(닫힌 구간이면 꼭 비교).
5) 그래프 개형 요약(증가/감소/극값/변곡/끝점 값).

### 종합 예: $$f(x)=x^3-3x$$

- 1계: $$f'(x)=3x^2-3=3(x^2-1)=0\iff x=\pm1.$$
  - 부호표:
    $$x<-1:\ f'>0,\quad -1<x<1:\ f'<0,\quad x>1:\ f'>0.$$
    ⇒ **극대** at $$x=-1$$, **극소** at $$x=1$$.
- 2계: $$f''(x)=6x$$ → $$x=0$$ 에서 오목↔볼록 전환 → **변곡점**.

---

## 변곡점(Inflection Point)

- **정의**: 오목성(볼록/오목)이 실제로 **바뀌는** 점.
- **판정 팁**: $$f''(c)=0$$ 은 흔한 신호지만 필요충분 아님.
  - 반례: $$f(x)=x^4$$ 은 $$f''(0)=0$$ 이지만 **항상 볼록**(변곡점 아님).
  - 비미분 예: $$f(x)=x^{1/3}$$ 은 $$f''$$ 이 무한대로 치우치나
    $$x<0$$ 에서 오목, $$x>0$$ 에서 볼록 → $$x=0$$ 변곡점.

---

## 엄격/약한 단조성의 미묘함 (주의)

- $$f'(x)\ge 0$$ 이어도 부분구간에서 **항등적 0**이면 엄격 증가가 아닐 수 있음.
- **Cantor 함수**처럼 거의 모든 곳에서 $$f'=0$$ 인데 단조 증가인 예도 존재(고급 예시).
- 실전에서는 “**부호표** + **항등적 0 여부**(평탄 구간) + **정의역 경계**”까지 점검.

---

## 단조함수 ↔ 역함수

- 단조(특히 엄격 단조)면 **전단사**로서 **역함수** 존재.
- 미분 가능 + $$f'(x)\ne 0$$ 이면 역함수도 미분 가능이고
$$
\big(f^{-1}\big)'(y)=\frac{1}{f'\big(f^{-1}(y)\big)}.
$$
- 부호에 따라 역함수의 단조성(증가/감소)이 결정된다.

---

## 다변수 확장 (개요와 핵심)
### 헤시안과 볼록/오목

$$
H(\mathbf{x})=\nabla^2 f(\mathbf{x})\ \text{(대칭)}.
$$
- $$H(\mathbf{x})\succeq 0\ (\text{양의 준정부호}) \Rightarrow f$$ **볼록**.
- $$H(\mathbf{x})\preceq 0\Rightarrow f$$ **오목**.
- 정부호/정부호-음의 경우에는 **엄격 볼록/오목**.

### 등가 성질(스무스 가정)

- $$f$$ 볼록 ⇔ 모든 직선 제한 $$g(t)=f(\mathbf{x}+t\mathbf{v})$$ 이 1D에서 볼록 ⇔
  모든 방향에서 2계 방향도함수 $$\mathbf{v}^\top H \mathbf{v}\ge 0$$.

### 그래디언트의 단조 연산자 성질

- $$f$$ 가 볼록이면
$$
\langle \nabla f(\mathbf{x})-\nabla f(\mathbf{y}),\ \mathbf{x}-\mathbf{y}\rangle \ge 0.
$$
- 강볼록(모수 $$\mu>0$$)이면 좌변이 $$\ge \mu\|\mathbf{x}-\mathbf{y}\|^2$$.

---

## 실전 예제 모음 (풀이 포함)
### 절댓값/루트/로그

- $$f(x)=|x|$$: 미분 불능(0) 있지만 단조성은 구간별로 분명(좌 감소·우 증가), **항상 볼록**(접선 아래).
- $$f(x)=\sqrt{x}\ (x>0)$$: $$f'>0, f''<0$$ → 엄격 증가 + 오목.
- $$f(x)=\ln x\ (x>0)$$: $$f'=1/x>0, f''=-1/x^2<0$$ → 엄격 증가 + 오목.

### 지수/시그모이드

- $$f(x)=e^x$$: $$f'=e^x>0,\ f''=e^x>0$$ → 엄격 증가 + 볼록.
- $$\sigma(x)=\frac{1}{1+e^{-x}}$$:
  $$\sigma'(x)=\sigma(1-\sigma)>0,\quad \sigma''(x)=\sigma(1-\sigma)(1-2\sigma).$$
  $$x=0$$ 에서 $$\sigma=1/2$$ → 그 전은 볼록, 후는 오목(변곡점 0).

### 삼각함수

- $$\sin x$$: 구간별 단조(예: $$[-\pi/2,\pi/2]$$ 에선 증가), $$f''=-\sin x$$ 로 오목성 주기적 변화.
- $$\cos x$$: 비슷하게 구간별 감소/증가 교대.

### 유리함수

- $$f(x)=\dfrac{x}{1+x^2}$$:
  $$f'=\dfrac{1-x^2}{(1+x^2)^2},\ f''=\dfrac{-2x(1-3x^2)}{(1+x^2)^3}.$$
  1계 부호표로 증가/감소 구간, 2계로 변곡점(0, ±1/√3 등) 판정 가능.

### 적분형 함수의 단조성/볼록성

- $$f(x)=\int_{0}^{x} g(t)\,dt$$ 이고 $$g\ge 0$$ 이면 $$f' = g \ge 0$$ → 단조 증가.
- $$f''=g'$$ 의 부호로 오목성 판정(매끄러움 가정).

---

## 반례·주의 포인트

- **극값 오판**: $$f'(c)=0$$ ⇒ 극값? ❌ (예: $$x^3$$). **1차 부호 전환** 확인.
- **변곡 오판**: $$f''(c)=0$$ ⇒ 변곡? ❌ 오목성 실제 전환 필요.
- **평탄 구간**: $$f' \equiv 0$$ 인 부분구간은 단조지만 **엄격 단조 아님**.
- **정의역**: 로그/분수/루트의 **도메인**과 **끝점** 비교(절대 극값 문제).
- **다변수**: 헤시안 한 점의 부호만으로 전역 성질 단정하지 않기(국소 판정임).
- **불연속/비미분**: 도함수 기반 판정이 불가하면 **정의**와 **접선 비교**로 판정.

---

## 체크리스트 (실전 루틴)

- [ ] 정의역·끝점·특이점(분모 0, 로그/루트 조건) 확인했는가?
- [ ] $$f'(x)=0$$, 미분 불능점, 부호표를 완성했는가?
- [ ] $$f''(x)$$ 부호와 변곡점의 **실제 전환**을 확인했는가?
- [ ] 절대 극값 문제라면 **끝점 비교**를 포함했는가?
- [ ] (다변수) 헤시안의 정부호성/등가 조건(방향 2계형)으로 판정했는가?

---

## 시각화/검산 코드 (NumPy + Matplotlib)

> 주의: 아래 코드는 시각화를 위한 예시다. 구간·샘플 수를 조절해 부호표/개형을 눈으로 확인하자.

### 단변수: $$f(x)=x^3-3x$$ 의 단조/오목성

```python
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-3, 3, 800)
f  = x**3 - 3*x
fp = 3*x**2 - 3
fpp= 6*x

plt.figure(figsize=(9,6))
plt.plot(x, f,  label='f(x) = x^3 - 3x')
plt.plot(x, fp, label="f'(x)")
plt.plot(x, fpp,label="f''(x)")
for v in [-1, 0, 1]:
    plt.axvline(v, linestyle='--', alpha=0.5)
plt.axhline(0, linewidth=0.8)
plt.title('단조성/오목성: 부호표 시각화')
plt.grid(True); plt.legend(); plt.show()
```

### 변곡점 예: $$\sigma(x)=1/(1+e^{-x})$$

```python
import numpy as np
import matplotlib.pyplot as plt

def sigma(x): return 1/(1+np.exp(-x))
x = np.linspace(-8, 8, 800)
y = sigma(x)
yp = y*(1-y)               # sigma'(x)
ypp= y*(1-y)*(1-2*y)       # sigma''(x)

plt.plot(x, y,  label='sigma')
plt.plot(x, yp, label="sigma'")
plt.plot(x, ypp,label="sigma''")
plt.axvline(0, linestyle='--', alpha=0.5)
plt.axhline(0, linewidth=0.8)
plt.title('시그모이드의 변곡점(0)과 오목성 전환')
plt.grid(True); plt.legend(); plt.show()
```

### 다변수: 등고선과 헤시안 부호 감각 익히기

```python
import numpy as np
import matplotlib.pyplot as plt

def f(x, y):  # 볼록성 예: 2차식
    return x**2 + y**2 + x*y - 6*x - 2*y + 10

xs = np.linspace(-1, 4, 200)
ys = np.linspace(-2, 2, 200)
X, Y = np.meshgrid(xs, ys)
Z = f(X, Y)

plt.contour(X, Y, Z, levels=20)
plt.title('등고선으로 느끼는 볼록성(타원 등고선)')
plt.xlabel('x'); plt.ylabel('y')
plt.axis('equal'); plt.grid(True); plt.show()
```

---

## 연습문제 (간단 해설 포함)

1) $$f(x)=\sqrt{x}-\ln x\ (x>0)$$ 의 단조구간과 오목성.
   - $$f'=\frac{1}{2\sqrt{x}}-\frac{1}{x}=\frac{x-2\sqrt{x}}{2x\sqrt{x}}$$
     → $$x=4$$ 에서 0, $$x<4$$ 감소, $$x>4$$ 증가.
   - $$f''=-\frac{1}{4}x^{-3/2}+\frac{1}{x^2}<0$$ 인 구간/부호 비교로 오목성 판정.

2) $$f(x)=x e^{-x}$$ 의 극값/변곡점.
   - $$f'=e^{-x}(1-x)$$ → 극댓값 at $$x=1$$.
   - $$f''=e^{-x}(x-2)$$ → 변곡점 $$x=2$$(오목↔볼록 전환).

3) $$f(x)=|x|^p\ (p>1)$$ 의 볼록성.
   - $$f''(x)=p(p-1)|x|^{p-2}\ge 0$$ (단, $$x=0$$ 에선 비미분이거나 무한대 가능) → **볼록**.

4) 다변수: $$f(x,y)=x^2+3y^2-2xy$$ 의 볼록성.
   - 헤시안 $$H=\begin{pmatrix}2&-2\\-2&6\end{pmatrix}$$, 고유값 양수 ⇒ **볼록**.

5) 변곡점 판정: $$f(x)=x^4+ax^3$$ 의 변곡점 존재 범위.
   - $$f''=12x^2+6ax=6x(2x+a)$$ → 서로 다른 해가 있고 오목성 전환이 일어나려면 $$a\ne 0$$.

---

## 마무리 요약

- **단조성**은 1계 도함수의 **부호**로, **오목/볼록**은 2계 도함수의 **부호**로 빠르게 판정.
- 극값/변곡 오판을 피하려면 **부호 전환**과 **경계 비교**를 반드시 포함.
- 다변수에서는 **헤시안 정부호성**과 **그래디언트의 단조 연산자 성질**이 핵심.
- 실전 루틴: **정의역 확인 → 1계 부호표 → 2계로 곡률/변곡 → 끝점/코너 비교 → 결론**.

> 팁: 복잡할수록 “치환으로 자유도 축소 → 대칭/스케일 분석 → 부호표 → 간단한 수치 시각화”를 습관화하라.
