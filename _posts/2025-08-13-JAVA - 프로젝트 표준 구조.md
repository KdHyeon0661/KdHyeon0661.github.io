---
layout: post
title: Java - 프로젝트 표준 구조
date: 2025-08-13 14:20:23 +0900
category: Java
---
# 프로젝트 표준 구조 — `src/main/java`, `src/test/java` (Maven/Gradle 공통)

Java/JVM 프로젝트는 **표준 디렉터리 레이아웃**을 따르는 것이 관례입니다. Maven의 *Standard Directory Layout*을 Gradle도 그대로 인식하므로, 아래 구조를 사용하면 **IDE 인식, 플러그인 호환, CI 구축**이 수월합니다.

---

## 1) 한눈에 보는 기본 레이아웃

```
project/
├─ src/
│  ├─ main/
│  │  ├─ java/            ← 프로덕션 소스 코드(.java)
│  │  ├─ resources/       ← 리소스(설정, 템플릿, 정적 파일 등)
│  │  └─ webapp/          ← (옵션, WAR 패키징) 웹 리소스
│  └─ test/
│     ├─ java/            ← 테스트 소스 코드(.java)
│     └─ resources/       ← 테스트 리소스
├─ build/ or target/      ← 빌드 산출물(Gradle=build, Maven=target)
├─ pom.xml or build.gradle(.kts)
└─ settings.gradle(.kts) / .mvn/ / gradlew 등
```

> Gradle은 `build/`, Maven은 `target/`에 컴파일 결과와 패키지 산출물을 둡니다.

---

## 2) `src/main/java` — 프로덕션 코드

- **용도**: 애플리케이션 실행에 필요한 **주요 클래스**(도메인, 서비스, 컨트롤러 등)와 `module-info.java`(JPMS 사용 시).
- **패키지 네이밍**: 보통 **역도메인 규칙** 사용 (예: `com.example.app`). 그룹ID와 맞추면 관리가 편합니다.
- **가시성/캡슐화**: 외부로 공개할 API와 내부 구현을 **패키지로 분리**하세요(예: `api` vs `internal`).
- **리소스 접근**: 파일 경로 대신 **클래스패스**를 사용하세요.
  ```java
  // resources에 있는 application.properties 읽기
  try (var in = getClass().getClassLoader().getResourceAsStream("application.properties")) {
      // null 체크 후 사용
  }
  ```
- **리소스와의 관계**: `src/main/resources`의 파일은 빌드 시 **그대로 클래스패스**에 복사됩니다.
  - 예: `src/main/resources/META-INF/services/...` → ServiceLoader 메타데이터
  - `logback.xml`, `application.yml`, 메시지 번들 등

---

## 3) `src/test/java` — 테스트 코드

- **용도**: 단위/통합 테스트, 테스트 유틸, 테스트 전용 설정.
- **클래스패스 규칙**:
  - **테스트 컴파일/런타임** 시에는 `main` 산출물 + `test` 산출물이 함께 클래스패스에 포함됩니다.
  - 즉, 테스트에서는 프로덕션 클래스를 직접 참조할 수 있습니다.
- **이름 규칙(관례)**: `*Test`, `*Tests`(JUnit), `*IT`(통합 테스트, Maven Failsafe와 매칭) 등.
- **테스트 예시 (JUnit 5)**:
  ```java
  import org.junit.jupiter.api.Test;
  import static org.junit.jupiter.api.Assertions.*;

  class GreetingServiceTest {
      @Test
      void hello() {
          assertEquals("Hello", new GreetingService().hello());
      }
  }
  ```
- **테스트 리소스**: `src/test/resources`의 파일은 **테스트 시에만** 클래스패스에 추가됩니다.
  - 동일 경로의 파일이 `main/resources`와 **중복**되면 테스트 리소스가 우선할 수 있으므로 유의하세요.

---

## 4) `src/main/resources` & `src/test/resources` — 리소스 처리

- 텍스트/바이너리 리소스(프로퍼티, YAML, 정적 파일, 템플릿 등)는 **`resources/`**에 둡니다.
- Maven은 `resource filtering`로 `${...}` 치환이 가능하고, Gradle도 유사 기능을 제공합니다.
  - **Maven 예시(필터링)**:
    ```xml
    <build>
      <resources>
        <resource>
          <directory>src/main/resources</directory>
          <filtering>true</filtering>
        </resource>
      </resources>
    </build>
    ```
- 리소스는 **절대 파일 경로로 접근하지 말고** `ClassLoader#getResource*`로 읽으세요(환경 이식성 ↑).

---

## 5) 웹 애플리케이션(옵션) — `src/main/webapp`

- **WAR 패키징**(서블릿 컨테이너 배포)에서는 JSP, `WEB-INF/`, 정적 리소스를 `webapp/`에 둡니다.
- Spring Boot는 보통 **JAR 실행**을 권장하며, 정적/템플릿은 `src/main/resources/static/`, `templates/`에 둡니다.

---

## 6) 멀티 언어/플랫폼 소스셋(옵션)

- Gradle/Maven 모두 **Kotlin/Groovy/Scala**를 함께 쓸 수 있습니다.
  ```
  src/main/kotlin, src/test/kotlin
  src/main/groovy, src/test/groovy
  src/main/scala,  src/test/scala
  ```
- 네이티브/자원 전용 디렉터리(예: `src/main/native`)는 플러그인에 따라 다릅니다.

---

## 7) 통합 테스트 분리(권장 패턴)

- **Maven**: Failsafe 플러그인으로 `verify` 단계에 통합 테스트(`*IT`)를 배치.
  ```xml
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-failsafe-plugin</artifactId>
        <version>3.2.5</version>
        <executions>
          <execution>
            <goals>
              <goal>integration-test</goal>
              <goal>verify</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  ```
- **Gradle**: 별도 소스셋을 만들면 깔끔합니다.
  ```kotlin
  sourceSets {
      val integrationTest by creating {
          compileClasspath += sourceSets.main.get().output + configurations.testRuntimeClasspath.get()
          runtimeClasspath += output + compileClasspath
          java.srcDir("src/integrationTest/java")
          resources.srcDir("src/integrationTest/resources")
      }
  }

  tasks.register<Test>("integrationTest") {
      description = "Runs integration tests."
      testClassesDirs = sourceSets["integrationTest"].output.classesDirs
      classpath = sourceSets["integrationTest"].runtimeClasspath
      useJUnitPlatform()
      shouldRunAfter("test")
  }
  ```

---

## 8) 커스터마이징(필요할 때만!)

표준 레이아웃이 최선이지만, 상황에 따라 경로를 바꿀 수 있습니다.

- **Maven**:
  ```xml
  <build>
    <sourceDirectory>src/java</sourceDirectory>
    <testSourceDirectory>test/java</testSourceDirectory>
    <resources>
      <resource><directory>conf</directory></resource>
    </resources>
  </build>
  ```
- **Gradle**:
  ```kotlin
  sourceSets {
      main {
          java.setSrcDirs(listOf("src/java"))
          resources.setSrcDirs(listOf("conf"))
      }
      test {
          java.setSrcDirs(listOf("test/java"))
      }
  }
  ```
> 단, **도구/IDE 호환성**을 위해 가능하면 표준 경로를 유지하세요.

---

## 9) 빌드 산출물과 클래스패스

- `src/main/java` → `build/classes/java/main`(Gradle) / `target/classes`(Maven)
- `src/test/java` → `build/classes/java/test` / `target/test-classes`
- 패키징 시:
  - **JAR**: `main` 클래스/리소스만 포함
  - **WAR**: `webapp` 포함(서블릿 컨테이너 배포용)

---

## 10) 베스트 프랙티스 체크리스트

- [ ] **표준 레이아웃 유지** (`src/main/java`, `src/test/java/resources`)
- [ ] **패키지 네임스페이스 정리**(역도메인, `api`/`internal` 구분)
- [ ] **리소스는 클래스패스**로 접근(파일 경로 X)
- [ ] **테스트는 분리**(단위 vs 통합), 필요 시 별도 소스셋/플러그인
- [ ] **중복 리소스 주의**(test가 main을 가리는지 확인)
- [ ] **IDE 프로젝트 파일 커밋 금지**(Gradle/Maven로 재생성)
- [ ] **CI에서 Wrapper 사용**(`mvnw`, `gradlew`)로 빌드 재현성 보장
