---
layout: post
title: AWS - IAM
date: 2025-07-23 17:20:23 +0900
category: AWS
---
# IAM: 사용자, 권한, 역할 관리

AWS의 보안 및 접근 제어의 핵심은 **IAM(Identity and Access Management)**입니다. IAM을 사용하면 AWS 리소스에 대한 **세밀한 접근 제어**를 설정할 수 있습니다. 이 문서에서는 IAM의 기본 개념부터 고급 기능, 그리고 다른 서비스와의 연계까지 폭넓고 깊이 있게 설명합니다.

---

## ✅ 1. IAM이란?

IAM(Identity and Access Management)은 AWS에서 사용자와 그룹, 역할(Role)을 생성하고, **각각에게 필요한 권한만 부여**할 수 있게 하는 서비스입니다.

IAM의 목적은 다음과 같습니다:

- **안전한 접근 제어**: 인증(Authentication)과 인가(Authorization)를 명확히 구분.
- **권한 최소화 원칙(Least Privilege)** 적용.
- **정책 기반 관리**: JSON 문법으로 세부 권한 제어 가능.

---

## ✅ 2. IAM의 구성 요소

### 🔹 사용자 (User)
- IAM 사용자란 AWS 리소스에 접근할 수 있는 엔터티(사람, 시스템)를 의미.
- 각각의 사용자에게는 **고유한 자격 증명**이 부여됨 (예: 사용자명, 비밀번호, 액세스 키 등).

예시:
```json
"Effect": "Allow",
"Action": "s3:*",
"Resource": "*"
```

### 🔹 그룹 (Group)
- 여러 IAM 사용자에게 동일한 권한을 일괄 부여할 때 사용.
- 사용자마다 동일한 정책을 붙일 필요 없이, **그룹에 정책을 연결**하면 일괄 적용됨.

### 🔹 정책 (Policy)
- JSON 형식으로 작성된 **권한 부여 문서**.
- 정책에는 `Action`, `Resource`, `Effect` 등이 포함됨.
- 정책 유형:
  - 관리형 정책(Managed Policy): AWS 제공 또는 사용자 정의 가능.
  - 인라인 정책(Inline Policy): 특정 사용자나 역할에 **직접 부착**됨.

### 🔹 역할 (Role)
- **IAM 사용자 없이도** AWS 리소스를 사용할 수 있도록 **임시 권한을 부여**하는 개념.
- 예: EC2 인스턴스가 S3에 접근할 때 역할을 부여.

---

## ✅ 3. 정책(Policy)의 구조

정책은 JSON 형식으로 구성되며, 주요 필드는 다음과 같습니다:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:ListBucket",
      "Resource": "arn:aws:s3:::example-bucket"
    }
  ]
}
```

- `Effect`: 허용(Allow) 또는 거부(Deny)
- `Action`: 허용 또는 거부할 API 동작 (예: `s3:GetObject`)
- `Resource`: 대상 리소스의 ARN
- `Condition`: 조건부 접근 제어 (예: IP, 시간 등)

---

## ✅ 4. MFA (Multi-Factor Authentication)

- IAM 사용자의 계정을 추가로 보호하기 위해 MFA 사용 가능.
- AWS에서는 가상 MFA (Google Authenticator 등), 하드웨어 MFA 지원.

---

## ✅ 5. IAM 역할(Role) 활용 사례

### ✅ EC2에서 S3 접근

EC2 인스턴스에 IAM 역할을 부여하여 **액세스 키 없이도** S3 접근 가능.

1. IAM 역할 생성
2. 역할에 S3 접근 정책 부착
3. EC2 인스턴스 시작 시 해당 역할 연결

```json
{
  "Effect": "Allow",
  "Action": [
    "s3:GetObject",
    "s3:PutObject"
  ],
  "Resource": "arn:aws:s3:::my-bucket/*"
}
```

### ✅ Lambda 함수의 IAM 역할

Lambda 함수는 실행될 때 필요한 권한을 **IAM 역할로 위임**받음. 예를 들어:

- DynamoDB 읽기/쓰기
- SNS 발송
- S3에서 파일 읽기

---

## ✅ 6. 권한 위임과 신뢰 정책

역할(Role)은 '누가 사용할 수 있는지'에 대한 **신뢰 정책(Trust Policy)**을 포함해야 함.

예시: EC2가 역할을 사용하도록 허용

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Service": "ec2.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
```

---

## ✅ 7. IAM 권장 보안 전략

| 항목 | 권장 내용 |
|------|------------|
| 최소 권한 원칙 | 반드시 필요한 권한만 부여 |
| MFA 활성화 | 모든 사용자에 대해 MFA 적용 |
| 루트 계정 사용 제한 | IAM 사용자 사용, 루트 계정은 비상용 |
| IAM 역할 활용 | EC2, Lambda 등에서 역할 기반 접근 |
| 정책 정기 검토 | 오래된, 과도한 정책 제거 |
| CloudTrail | 누가 어떤 리소스를 접근했는지 기록 |

---

## ✅ 8. AWS 서비스와 IAM 연계

| AWS 서비스 | IAM과의 연계 방식 |
|-------------|------------------|
| EC2 | IAM 역할 부여로 S3, RDS 접근 |
| S3 | IAM 정책을 통해 접근 제어 |
| Lambda | IAM 역할로 S3, DynamoDB 등 접근 |
| RDS | DB 인증은 DB 계정 기반, DB 작업은 IAM으로 관리 가능 |
| CloudWatch | IAM 권한으로 로그 및 메트릭 제어 |
| CodePipeline | IAM 역할로 빌드 및 배포 권한 관리 |

---

## ✅ 9. 실습 예: EC2에서 S3에 파일 업로드

1. IAM 역할 생성 (EC2에서 S3 접근 허용)
2. EC2 시작 시 역할 연결
3. S3에 파일 업로드 테스트

```bash
aws s3 cp test.txt s3://my-bucket/
```

IAM 역할 덕분에 `aws configure`로 액세스 키 설정 없이도 가능.

---

## ✅ 10. 실습 예: Lambda 함수가 DynamoDB에 쓰기

1. IAM 역할 생성: DynamoDB `PutItem` 권한 부여
2. Lambda 함수 생성 시 역할 연결
3. 코드에서 DynamoDB 사용

```python
import boto3
dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table('Users')
table.put_item(Item={'id': '123', 'name': 'DoHyun'})
```

---

## ✅ 11. 정책 시뮬레이터

- AWS Console에서 제공
- 특정 사용자/역할에 대해 특정 작업이 가능한지 시뮬레이션 가능
- 정책 오류 분석에 매우 유용

---

## ✅ 12. IAM 정리

- IAM은 AWS 보안의 핵심.
- 사용자/그룹/역할/정책 구조로 설계됨.
- 정책 기반으로 세밀한 권한 제어.
- IAM 역할을 활용해 키 없는 보안 접근 가능.
- CloudTrail, Config, 정책 시뮬레이터와 연계해 정기적 점검이 중요.

---

IAM은 잘 설계하면 강력한 보안을, 잘못 설계하면 큰 사고를 초래할 수 있습니다. AWS 인프라의 규모가 커질수록 IAM의 중요성은 배가됩니다.

지속적인 검토와 보안 전략 수립이 필수입니다.