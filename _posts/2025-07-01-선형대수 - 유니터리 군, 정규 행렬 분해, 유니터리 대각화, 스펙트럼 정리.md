---
layout: post
title: 선형대수 - 유니터리 군, 정규 행렬 분해, 유니터리 대각화, 스펙트럼 정리
date: 2025-07-01 19:20:23 +0900
category: 선형대수
---
# 유니터리 군, 정규 행렬 분해, 유니터리 대각화, 스펙트럼 정리

> **핵심 한 줄**  
> $$\text{정규 행렬 }A\ (AA^*=A^*A)\ \Longleftrightarrow\ \exists\ \text{유니터리 }U:\ A=U\Lambda U^*$$  
> (스펙트럼 정리) — 복잡한 선형변환을 **직교(유니터리) 좌표계**에서 **스케일링(대각)**으로 단순화한다.

---

## 0. 로드맵

1) 유니터리 군 \(U(n)\) — 정의, 기하/군 구조, 리 대수  
2) 정규 행렬 — 등가조건, 분해들과의 연결(슈어, 폴라, SVD)  
3) 유니터리 대각화 — 이론적 절차와 수치 알고리즘(안정성·복잡도)  
4) 스펙트럼 정리 — 증명 스케치, 함수해석적 해석(스펙트럴 측도)  
5) 동치/확장 결과 — 동시 대각화, 정상연산자, 함수계산 \(f(A)\)  
6) 실전 시나리오 — 양자 시간진화, 그래프 라플라시안, 순환행렬  
7) 코드 — NumPy/SciPy로 검증(정규성, 대각화, 잔차, 수반, 폴라)  
8) 실무 팁 — 수치적 주의, 고유치 군집/중복, 위상(phase) 고정

모든 수식은 **반드시** $$\cdots$$ 로 표기합니다. 코드 블록은 ``` 로 감쌉니다.

---

## 1. 유니터리 군 \(U(n)\)

### 1.1 정의와 기하
$$
U(n)=\{\,U\in\mathbb{C}^{n\times n}\mid U^*U=UU^*=I\,\}
$$
- $$U^*$$: 켤레 전치, $$I$$: 단위행렬.  
- **길이/내적 보존**: 임의의 벡터에 대해 $$\|Ux\|_2=\|x\|_2$$, $$\langle Ux,Uy\rangle=\langle x,y\rangle$$.  
- **기하적 의미**: 복소 힐베르트 공간의 **회전/반사**.

### 1.2 군 구조와 성질
- **군 공리**: 닫힘, 항등원 $$I$$, 역원 $$U^{-1}=U^*$$, 결합법칙.  
- **행렬식**: $$|\det U|=1$$. 부분군 $$SU(n)=\{U:\det U=1\}$$.
- **컴팩트 리 군**: 리 대수 $$\mathfrak{u}(n)=\{K:K^*=-K\}$$(**스큐-에르미트**).  
  지수 사상으로 임의의 $$U\in U(n)$$ 를 $$U=e^K$$ 형태로(전역 서젝티브).

---

## 2. 정규 행렬(Normal Matrix)와 분해

### 2.1 정의와 등가 조건
$$
A\in\mathbb{C}^{n\times n}\ \text{가}\ \boxed{AA^*=A^*A}\ \Rightarrow\ \text{정규}.
$$
다음과 동치:
- (스펙트럼 정리) **유니터리 대각화 가능**: $$\exists U\in U(n):\ A=U\Lambda U^*$$.
- **슈어(유니터리 삼각) 분해가 대각**: 모든 행렬의 유니터리 슈어분해 $$A=Q T Q^*$$ 에서, $$A$$ 정규이면 상삼각 $$T$$ 가 실제로 **대각**.
- **노름 동등**: 모든 벡터에 대해 $$\|Ax\|_2=\|A^*x\|_2$$.
- **스펙트럴 정규직교 기저**: 고유벡터들이 **정규직교 기저**를 이룸.

> 반례(비정규): $$J=\begin{bmatrix}1&1\\0&1\end{bmatrix}$$ 는 $$JJ^*\ne J^*J$$, 유니터리 대각화 불가(요르당 블록).

### 2.2 다른 분해와의 연결
- **슈어 분해**: $$A=Q T Q^*$$, 임의의 $$A$$ 존재. $$A$$ 정규 ⇒ $$T$$ 대각.  
- **폴라 분해**: $$A=U H$$, $$U\in U(n)$$, $$H=(A^*A)^{1/2}\succeq0$$.  
  정규이면 $$U,H$$ 가 **가환**: $$UH=HU$$.  
- **SVD**: $$A=U\Sigma V^*$$. 정규 + 대각화 가능 ⇒ 고유값/특이값 관계가 단순해짐(대각이면 자명).

---

## 3. 유니터리 대각화 — 이론→수치 절차

### 3.1 이론적 4단계
1) **고유값**: $$\det(A-\lambda I)=0 \Rightarrow \{\lambda_i\}$$.  
2) **고유공간**: $$\ker(A-\lambda_i I)$$ 에서 기저 추출.  
3) **정규직교화**: 각 고유공간의 기저를 그람-슈미트로 **정규직교**.  
4) **유니터리 구성**: $$U=[u_1\,\cdots\,u_n],\ \Lambda=\operatorname{diag}(\lambda_1,\dots,\lambda_n)$$ 로 $$A=U\Lambda U^*$$.

> **중복 고유값**이 있으면 해당 고유공간에서 **임의의 유니터리**로 기저를 바꿔도 성립(비유일성).

### 3.2 수치 알고리즘(안정/복잡도)
- **Hermitian/실대칭**: 하우스홀더 **삼대각화**(tridiagonal, $$O(n^3)$$) → QR(윌킨슨 쉬프트)로 고유값/벡터.  
  수치적으로 **가장 안정**.  
- **일반 정규**: 하우스홀더 **헤센버그**(upper Hessenberg) 축소 → QR로 유니터리 슈어 → 정규성 때문에 급속히 **대각** 수렴.  
- **복잡도**: 전체 $$O(n^3)$$, 대규모는 분할정복/망각 기법/랙-사이클릭 QR 등 활용.  
- **안정성**: 정규 행렬은 고유치 **민감도 최상**(호프만–바일란트, 바우어-파이크 등 경계가 타이트). 비정규는 의사스펙트럼 팽창.

---

## 4. 스펙트럼 정리(Spectral Theorem)

### 4.1 진술(유한차원)
$$
\boxed{\ A\ \text{정규}\ \Longleftrightarrow\ \exists U\in U(n):\ A=U\Lambda U^*\ }
$$
- **Hermitian**이면 $$\Lambda\in\mathbb{R}^{n\times n}$$(모든 고유값 실수).  
- **Unitary**이면 고유값이 **단위원** 위에: $$|\lambda_i|=1$$.  
- **Skew-Hermitian**이면 고유값이 **순허수**.

### 4.2 증명 스케치(슈어 사용)
임의의 $$A$$ 에 대해 $$A=Q T Q^*$$(유니터리 슈어). 정규성이 주어지면
$$
AA^*=A^*A\ \Longleftrightarrow\ TT^*=T^*T.
$$
상삼각 $$T$$ 가 정상 ⇒ 대각 원소 외의 상삼각 성분이 **모두 0** 이어야 함 ⇒ $$T$$ 는 **대각**.  
따라서 $$A=Q\,\operatorname{diag}(\lambda_i)\,Q^*$$.

### 4.3 스펙트럴 분해/함수 계산
정규 $$A$$ 에 대해, 서로 직교하는 **스펙트럴 투영** $$\{P_i\}$$ 가 존재:
$$
A=\sum_{i}\lambda_i P_i,\qquad P_iP_j=\delta_{ij}P_i,\ \sum_i P_i=I.
$$
임의의 복소 다항/연속/해석 함수 $$f$$ 에 대해
$$
\boxed{\,f(A)=\sum_i f(\lambda_i)\,P_i=U\,f(\Lambda)\,U^*\,}
$$
(연산자 함수 계산의 핵심 — 예: 지수행렬, 로그, 분수 거듭제곱).

---

## 5. 확장/파생: 동시 대각화·정상연산자

- **가환하는 정규 행렬들** $$A,B$$ 가 **모두 정규**이고 $$AB=BA$$ 이면 **동시 유니터리 대각화** 가능.  
  ⇒ 함께 대각에서 함수계산/최적화 단순화.
- **정상 연산자(Normal operator)**: 무한차원 힐베르트 공간에서도 스펙트럼 정리(스펙트럴 측도) 성립 — 유한차원은 그 특수 경우.

---

## 6. 실전 시나리오

### 6.1 양자 시간진화(해밀토니안 대칭)
- **해밀토니안** $$H=H^*$$(에르미트) ⇒ 유니터리 진화 $$U(t)=e^{-iHt}$$,  
  스펙트럴 분해로
  $$
  e^{-iHt}=U\,e^{-i\Lambda t}\,U^*.
  $$
  수치적으로는 고유분해 한 번으로 모든 시간 $$t$$ 에 대해 빠른 계산.

### 6.2 그래프 라플라시안
- **정규화 라플라시안** $$L_{\mathrm{sym}}=I-D^{-1/2}AD^{-1/2}$$ 은 **에르미트(대칭)**.  
  고유분해로 스펙트럴 클러스터링/필터링/그래프 신호 처리 구현.

### 6.3 순환행렬과 푸리에
- 순환행렬 $$C$$ 는 **DFT 유니터리** $$F$$ 로 대각화:
  $$
  C=F^*\,\operatorname{diag}(\hat c)\,F.
  $$
  컨볼루션/회전 대칭 문제에서 즉시 대각 영역 계산 가능.

---

## 7. 코드 — 정규성 검증, 유니터리 대각화, 폴라/수반

> 아래 코드는 **정규성 검사 → 유니터리 대각화 → 잔차 확인 → 폴라 분해/수반 확인**을 단계별 재현합니다.

```python
import numpy as np
from numpy.linalg import norm, eig, svd

def is_normal(A, tol=1e-10):
    return norm(A @ A.conj().T - A.conj().T @ A, 2) <= tol

def unitary_diagonalize(A):
    # 고유분해 (일반 정규 행렬에 적용 가능)
    vals, vecs = eig(A)                 # vecs: 열이 고유벡터
    # 고유벡터 정규화 및 위상 고정(첫 비영  성분 실수+)
    for j in range(vecs.shape[1]):
        v = vecs[:, j]
        k = np.argmax(np.abs(v))
        phase = np.exp(-1j * np.angle(v[k])) if v[k] != 0 else 1.0
        vecs[:, j] *= phase / norm(v)
    U = vecs
    Lam = np.diag(vals)
    return U, Lam

def residuals(A, U, Lam):
    rec = U @ Lam @ U.conj().T
    resA = norm(A - rec, 2)
    unit = norm(U.conj().T @ U - np.eye(U.shape[0]), 2)
    return resA, unit

# 예제 1) Hermitian (에르미트)
A = np.array([[2, 1j],
              [-1j, 3]], dtype=complex)

print("Normal?", is_normal(A))
U, Lam = unitary_diagonalize(A)
rA, rU = residuals(A, U, Lam)
print("‖A - UΛU*‖₂ =", rA, "  ‖U*U - I‖₂ =", rU)
print("Eigenvalues:", np.diag(Lam).round(6))

# 예제 2) 유니터리 행렬의 고유치(단위원)
theta = 0.3
Urot = np.array([[np.exp(1j*theta), 0],
                 [0, np.exp(-1j*theta)]])
print("Unitary?", np.allclose(Urot.conj().T @ Urot, np.eye(2)))

# 예제 3) 비정규 반례
J = np.array([[1., 1.],
              [0., 1.]])
print("Normal?(Jordan)", is_normal(J))

# 폴라 분해: A = UH (H = (A* A)^{1/2})
def polar_decomposition(A):
    U, s, Vh = svd(A)
    H = (Vh.conj().T) @ np.diag(s) @ Vh
    Up = U @ Vh
    return Up, H

Up, H = polar_decomposition(A)
print("Polar: ‖A - U_p H‖₂ =", norm(A - Up @ H, 2))
print("Unitary in polar?", np.allclose(Up.conj().T @ Up, np.eye(A.shape[0])))
print("Hermitian PSD in polar?", np.allclose(H, H.conj().T) and np.all(np.linalg.eigvalsh(H) >= -1e-12))

# 수반(Adjoint) 검증: 표준 내적에서 A† = A*
x = np.array([1+2j, -0.5j])
y = np.array([2-1j, 3+4j])
lhs = (A @ x).conj().T @ y
rhs = x.conj().T @ (A.conj().T @ y)
print("〈Ax,y〉 == 〈x,A†y〉 ?", np.allclose(lhs, rhs))
```

**출력 해석 포인트**
- `Normal? True` / 비정규는 `False`.  
- `‖A - UΛU*‖₂` 가 머신 정밀도 수준 → 유니터리 대각화 성공.  
- 유니터리 예제의 고유치는 **절대값 1**.  
- 폴라 분해: `Up` 유니터리, `H` 는 에르미트 양의 반정정부호.

---

## 8. 실무 팁(수치·모델링)

1) **중복 고유값**: 고유벡터는 유니터리 자유도만큼 **비유일**.  
   파이프라인에서 **위상 고정**(첫 비영 성분 실수화)·**정렬 규칙** 필요.
2) **가까운 고유값**: 벡터 방향이 수치적으로 민감. 정규 행렬은 그래도 안정(호프만–바일란트:  
   $$\sum_i |\tilde\lambda_{\pi(i)}-\lambda_i|^2 \le \|E\|_F^2$$).
3) **정규성 테스트**: $$\|AA^*-A^*A\|$$ 가 작으면 “근사 정규”.  
   하지만 비정규면 의사스펙트럼이 커져 불안정(모드 간 결합).
4) **함수 계산**: 정규일 때 $$f(A)=U f(\Lambda) U^*$$ 로 **안전/효율**.  
   비정규면 슈어–파르렛 알고리즘 등 필요.
5) **동시 대각화**: 다변량 모형(커널, 공변량)에서 **가환+정규** 체크 후 한 번에 대각화하면 속도·안정성 향상.

---

## 9. 예제 모음(상황별)

### 9.1 양자 시간진화
- 상황: 헤밀토니안 $$H=H^*$$(크기 수천)에서 $$\psi(t)=e^{-iHt}\psi(0)$$.  
- 해법: 한 번 고유분해 후 시간마다 대각에서 지수만 곱함.
$$
e^{-iHt}=U\,\operatorname{diag}(e^{-i\lambda_k t})\,U^*.
$$

### 9.2 그래프 라플라시안 필터
- 상황: 신호 $$x$$ 가 그래프 정점에 얹힘. 라플라시안 $$L=L^*$$.  
- 필터(다항/가우시안 등) $$g(L)$$ 를 스펙트럼에서 곱하기로 구현:
$$
g(L)=U\,g(\Lambda)\,U^*,\quad \hat x=U^*x,\quad g(L)x=U\,g(\Lambda)\,\hat x.
$$

### 9.3 순환(컨볼루션) 선형 시스템
- 상황: 주기 경계 컨볼루션. 순환행렬 $$C$$.  
- DFT 유니터리 $$F$$ 로
$$
C=F^*\,\operatorname{diag}(\widehat c)\,F
$$
이므로 주파수 영역에서 **스칼라 곱**으로 계산.

---

## 10. 요약 표

| 주제 | 핵심 식/사실 | 코멘트 |
|---|---|---|
| 유니터리 군 | $$U^*U=I$$ | 길이·내적 보존, 리 대수 $$K^*=-K$$ |
| 정규 행렬 | $$AA^*=A^*A$$ | 스펙트럼 정리의 정확한 대상 |
| 스펙트럼 정리 | $$A=U\Lambda U^*$$ | Hermitian: $$\Lambda\in\mathbb{R}$$, Unitary: $$|\lambda|=1$$ |
| 슈어→대각 | 정상 상삼각은 대각 | 증명 핵심 트릭 |
| 폴라 분해 | $$A=UH,\ H=(A^*A)^{1/2}$$ | 정규 ⇒ $$UH=HU$$ |
| 함수계산 | $$f(A)=U f(\Lambda) U^*$$ | exp/log/sqrt 등 안정 |
| 동시 대각화 | 가환 + 정규 ⇒ 동시에 | 여러 연산 동시 단순화 |

---

### 마무리

정규성은 “**유니터리 좌표계에서 스케일링만 남도록 하는 조건**”입니다.  
스펙트럼 정리 덕분에 **해석(기하)**와 **계산(수치)**이 만나는 지점이 선명해지고,  
양자·그래프·신호·머신러닝에서 **복잡한 연산을 대각에서의 단순 연산**으로 바꿔줍니다.