---
layout: post
title: Linux - 마운트
date: 2024-11-09 19:20:23 +0900
category: Linux
---
# 리눅스 8편: 마운트

## 🗂️ 리눅스 파일 시스템 구조란?

리눅스는 단일 루트(`/`)를 기준으로 모든 파일과 디스크가 계층 구조로 연결된 구조입니다.

### 📁 주요 디렉토리 의미

| 디렉토리         | 설명                              |
|------------------|-----------------------------------|
| `/`              | 루트 디렉토리, 최상위 경로         |
| `/home`          | 사용자 홈 디렉토리 (`/home/user`) |
| `/etc`           | 시스템 설정 파일                  |
| `/var`           | 로그, 캐시 등 가변 데이터 저장    |
| `/bin`, `/sbin`  | 실행 파일 및 시스템 명령어         |
| `/usr`           | 프로그램, 라이브러리, 문서 등      |
| `/tmp`           | 임시 파일 저장 디렉토리            |
| `/mnt`, `/media` | 외부 장치 마운트용                |
| `/dev`           | 디바이스 파일 (`/dev/sda1` 등)    |

---

## 📊 `df` - 디스크 공간 확인

```bash
df -h
```

| 옵션 | 설명                          |
|------|-------------------------------|
| `-h` | 사람이 읽기 쉬운 형식 (GB/MB) |
| `-T` | 파일 시스템 종류 포함         |
| `-i` | inode 사용량 표시             |

### 예시
```bash
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda1        50G   20G   27G  43% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
```

> `/proc/mounts`를 기반으로 정보 제공

---

## 📦 `du` - 디렉토리/파일 용량 확인

```bash
du -sh *
```

| 옵션 | 설명                                  |
|------|---------------------------------------|
| `-s` | 요약 출력 (합계만 표시)               |
| `-h` | 사람이 읽기 쉬운 크기 (KB, MB, GB)     |
| `--max-depth=N` | 하위 디렉토리 깊이 제한    |

### 예시
```bash
$ du -sh *
12M logs
600K config
2.1G videos
```

---

## 🧷 `mount` - 디스크 마운트

```bash
sudo mount /dev/sdb1 /mnt/usb
```

| 항목             | 설명                                |
|------------------|-------------------------------------|
| 디바이스 파일    | `/dev/sdb1` 등                      |
| 마운트 지점      | `/mnt/usb`, `/media/usb` 등         |
| 파일 시스템 유형 | `-t ext4`, `-t vfat`, 자동 추정 가능 |
| 마운트 옵션      | `-o ro`, `-o rw`, `-o noexec` 등     |

### 주요 옵션

| 옵션       | 설명                                  |
|------------|---------------------------------------|
| `ro`       | 읽기 전용 마운트                      |
| `rw`       | 읽기-쓰기 가능 (기본값)               |
| `noexec`   | 실행 파일 실행 금지                   |
| `nosuid`   | SUID 비트 무시                        |
| `defaults` | 일반적인 옵션 세트 (rw, suid 등 포함) |

---

## 🔌 `umount` - 마운트 해제

```bash
sudo umount /mnt/usb
```

| 옵션 | 설명                  |
|------|-----------------------|
| 없음 | 마운트 지점 해제      |
| `-l` | Lazy unmount (사용 종료 시 해제) |
| `-f` | 강제 해제 (권장 X)     |

> 디스크가 사용 중이면 오류 발생 → `lsof`, `fuser`로 확인

```bash
lsof /mnt/usb
fuser -vm /mnt/usb
```

---

## 📜 `/etc/fstab` - 부팅 시 자동 마운트

`/etc/fstab` 파일에 디스크 정보를 등록하면 시스템 부팅 시 자동으로 마운트됩니다.

### 예시 항목
```fstab
/dev/sdb1  /mnt/usb  ext4  defaults  0  2
```

| 필드 순서      | 설명                                         |
|----------------|----------------------------------------------|
| 장치           | `/dev/sdX` 또는 `UUID=xxxx-xxxx`             |
| 마운트 위치    | `/`, `/home`, `/mnt/data` 등                 |
| 파일 시스템    | `ext4`, `xfs`, `vfat`, `ntfs` 등             |
| 옵션           | `defaults`, `noauto`, `ro`, `rw`, `user` 등 |
| dump 설정      | 백업 여부 (`0`=X, `1`=백업 대상)             |
| fsck 순서      | 부팅 시 파일시스템 검사 순서 (`0`=검사 안함) |

### UUID 확인
```bash
sudo blkid
```

---

## 💽 디스크 확인 및 관리

### 📍 `lsblk` - 디스크 및 파티션 구조 보기
```bash
lsblk
```

| 옵션 | 설명                         |
|------|------------------------------|
| `-f` | 파일 시스템, 마운트 정보 포함 |
| `-o NAME,SIZE,TYPE,MOUNTPOINT` | 출력 형식 지정 |

### 📍 `fdisk` - 파티션 테이블 보기
```bash
sudo fdisk -l
```

### 📍 `fsck` - 파일 시스템 검사
```bash
sudo fsck /dev/sdb1
```

> 사용 중인 파티션이 아닐 때만 실행 가능 (마운트 해제 필수)

---

## 🧪 실전 예시

### 예시 1: USB 마운트
```bash
sudo mkdir /mnt/usb
sudo mount /dev/sdb1 /mnt/usb
```

### 예시 2: 사용 중인 USB 강제 해제
```bash
sudo fuser -vm /mnt/usb
sudo umount /mnt/usb
```

### 예시 3: 디스크 사용량 큰 디렉토리 찾기
```bash
sudo du -sh /var/*
```

### 예시 4: fstab 등록 (ext4)
```fstab
UUID=1234-ABCD  /mnt/data  ext4  defaults  0  2
```

---

## 📎 명령어 요약

| 명령어             | 설명                                 |
|--------------------|--------------------------------------|
| `df -h`            | 전체 디스크 사용량 확인              |
| `du -sh *`         | 디렉토리별 용량 확인                 |
| `mount`            | 디스크 수동 마운트                   |
| `umount`           | 디스크 마운트 해제                   |
| `lsblk`            | 디스크 및 파티션 구조 확인           |
| `blkid`            | 디바이스 UUID 확인                   |
| `fdisk -l`         | 디스크 파티션 정보 확인              |
| `fsck`             | 파일 시스템 오류 검사                |
| `fuser`, `lsof`    | 디스크 점유 확인                     |
| `cat /etc/fstab`   | 자동 마운트 설정 확인                |

---

## ✨ 마무리

이번 편에서는 **리눅스 파일 시스템의 기본 구조**, **디스크 사용량 확인**, **마운트/해제 및 자동 마운트 설정 방법**을 실습 중심으로 정리했습니다.  
파일 시스템은 운영체제의 뼈대이므로 안정성과 관리 효율을 위해 꼭 익혀둬야 할 부분입니다.