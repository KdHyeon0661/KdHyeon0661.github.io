---
layout: post
title: 미적분 - 편도함수
date: 2025-07-27 22:20:23 +0900
category: 미적분
---
# 편도함수(Partial Derivatives)

다변수 함수 \(f:\mathbb{R}^n\!\to\!\mathbb{R}\) 또는 \(f:\mathbb{R}^n\!\to\!\mathbb{R}^m\)에서 **편도함수**는 “나머지 변수는 고정하고 한 변수만 바꿨을 때의 변화율”입니다.

---

## 1. 정의(Definition)

### 1.1 두 변수 \(f(x,y)\)의 편도함수
$$
\frac{\partial f}{\partial x}(x,y)
=\lim_{h\to 0}\frac{f(x+h,y)-f(x,y)}{h},\qquad
\frac{\partial f}{\partial y}(x,y)
=\lim_{h\to 0}\frac{f(x,y+h)-f(x,y)}{h}.
$$

**예제 A**  
\( f(x,y)=x^2y+3xy^2 \)이면
$$
\frac{\partial f}{\partial x}=2xy+3y^2,\qquad
\frac{\partial f}{\partial y}=x^2+6xy.
$$

### 1.2 \(n\)변수 일반형
\(f(\mathbf{x})=f(x_1,\dots,x_n)\)에 대해
$$
\frac{\partial f}{\partial x_i}(\mathbf{x})
=\lim_{h\to 0}\frac{f(x_1,\dots,x_i+h,\dots,x_n)-f(\mathbf{x})}{h}.
$$

---

## 2. 기하학적 의미(Geometric Meaning)

- \(f:\mathbb{R}^2\to\mathbb{R}\)의 그래프 \(z=f(x,y)\)에서  
  \(\partial f/\partial x\)는 **\(y\) 고정 단면**의 접선 기울기,  
  \(\partial f/\partial y\)는 **\(x\) 고정 단면**의 접선 기울기입니다.
- **그래디언트** \(\nabla f=(f_x,f_y)\)는 함수가 가장 빠르게 증가하는 **방향**을 가리키고 그 크기는 증가율의 최대값입니다.
- **방향도함수**(단위벡터 \(\hat{\mathbf{u}}\) 방향):
  $$
  D_{\hat{\mathbf{u}}}f(x,y)=\nabla f(x,y)\cdot \hat{\mathbf{u}}.
  $$

**예제 B (투영 해석)**  
\(\nabla f\)가 \((2x,2y)\)인 \(f(x,y)=x^2+y^2\)에서, \(\hat{\mathbf{u}}=(\tfrac1{\sqrt2},\tfrac1{\sqrt2})\)이면
$$
D_{\hat{\mathbf{u}}}f= \langle 2x,2y\rangle\cdot \langle \tfrac1{\sqrt2},\tfrac1{\sqrt2}\rangle
=\frac{2x+2y}{\sqrt2}.
$$

---

## 3. 계산 규칙(Rules) — 합·곱·몫·합성

- **선형성**: \(\partial_x(af+bg)=a\,\partial_x f+b\,\partial_x g\).  
- **곱셈법칙**: \(\partial_x(fg)=f_x g+f g_x\).  
- **몫셈법칙**: \(\partial_x\!\left(\frac{f}{g}\right)=\frac{f_x g-f g_x}{g^2}\) (\(g\neq 0\)).  
- **연쇄법칙(스칼라 출력)**: \(z=f(\mathbf{g}(t))\), \(\mathbf{g}=(x(t),y(t))\)이면
  $$
  \frac{dz}{dt}=f_x\,x'(t)+f_y\,y'(t).
  $$
- **연쇄법칙(벡터형)**: \(h(\mathbf{x})=f(\mathbf{g}(\mathbf{x}))\),
  $$
  \nabla h(\mathbf{x})=J_{\mathbf{g}}(\mathbf{x})^\top\nabla f(\mathbf{g}(\mathbf{x})),
  $$
  여기서 \(J_{\mathbf{g}}\)는 야코비안.

**예제 C (연쇄법칙 빠른 적용)**  
\( f(x,y)=e^{x y^2}\).  
- \(f_x= y^2 e^{xy^2}\), \(f_y= (2xy)e^{xy^2}\).  
곡선 \(x=t^2,\,y=\sin t\)를 따라
$$
\frac{d}{dt}f(x(t),y(t))
= f_x\,\underbrace{2t}_{x'}+f_y\,\underbrace{\cos t}_{y'}.
$$

---

## 4. 고계 편도함수 · 혼합편도(Clairaut)

- 2계:
  $$
  f_{xx},\ f_{yy},\ f_{xy}=\frac{\partial}{\partial y}\!\left(\frac{\partial f}{\partial x}\right),\
  f_{yx}=\frac{\partial}{\partial x}\!\left(\frac{\partial f}{\partial y}\right).
  $$
- **클레로(Clairaut) 정리**: \(f\)가 이차 편도함수까지 **연속**이면 \(f_{xy}=f_{yx}\).

**예제 D**  
\( f(x,y)=x^2y+3xy^2\)에서
$$
f_{xy}=\frac{\partial}{\partial y}(2xy+3y^2)=2x+6y,\quad
f_{yx}=\frac{\partial}{\partial x}(x^2+6xy)=2x+6y.
$$

---

## 5. 연속성과 미분가능성의 함정

**사실 1.** 편도함수의 존재만으로 **연속**을 보장하지 않음.  
**사실 2.** 모든 편도함수가 존재해도 함수가 **(총괄) 미분가능**하다고 결론낼 수 없음.

**반례(연속 아님)**  
$$
f(x,y)=
\begin{cases}
\dfrac{xy}{x^2+y^2},&(x,y)\neq(0,0),\\[4pt]
0,&(x,y)=(0,0).
\end{cases}
$$
- \(x\)-, \(y\)-축을 따라가면 \(0\)이므로 \(f_x(0,0)=f_y(0,0)=0\) 존재.  
- 그러나 \(y=x\)로 가면 \(f=\frac{x^2}{2x^2}=\tfrac12\), \(y=-x\)로 가면 \(-\tfrac12\) → **원점에서 불연속**.

**미분가능성 판정(2D)**  
\(\nabla f\)가 **원점 근방에서 연속**이고  
오차항 \(R(\mathbf{h})=f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})-\nabla f(\mathbf{a})\cdot \mathbf{h}\)가
\(\displaystyle \lim_{\mathbf{h}\to 0}\frac{R(\mathbf{h})}{\|\mathbf{h}\|}=0\)면 \(\mathbf{a}\)에서 **미분가능**.

---

## 6. 2변수 테일러 전개(근사·오차)

점 \(\mathbf{a}=(a,b)\) 근방:
$$
f(\mathbf{a}+\mathbf{h})\approx
f(\mathbf{a})+\nabla f(\mathbf{a})\cdot \mathbf{h}
+\tfrac12\,\mathbf{h}^\top H(\mathbf{a})\,\mathbf{h},
$$
- \(\mathbf{h}=(h,k)\),  
- \(H(\mathbf{a})=\begin{bmatrix}f_{xx}&f_{xy}\\ f_{yx}&f_{yy}\end{bmatrix}\): **헤시안**.

**용도**: 근사 계산, 뉴턴법, 극값 분류(음정/양정/부정부호).

---

## 7. 접평면, 그라디언트, 등고선

- **접평면**(at \((a,b)\)):  
  \( z\approx f(a,b)+f_x(a,b)(x-a)+f_y(a,b)(y-b)\).
- **수준곡선(level set)** \(f(x,y)=c\)에서 \(\nabla f\)는 **법선** 방향.  
- 등고선에 **접하는 방향**의 변화율은 0 (그래디언트와 직교).

**예제 E (접평면)**  
\(f(x,y)=\sqrt{1-x^2-y^2}\), 점 \((0,0)\)에서  
\(f_x(0,0)=0,\ f_y(0,0)=0\) → 접평면 \(z\approx 1\).

---

## 8. 최적화: 정지점과 헤시안 판정

- 정지점(critical): \(\nabla f=0\).
- 2변수에서 \(D=f_{xx}f_{yy}-f_{xy}^2\)라 할 때  
  - \(D>0\) & \(f_{xx}>0\): 국소 **최소**  
  - \(D>0\) & \(f_{xx}<0\): 국소 **최대**  
  - \(D<0\): **안장점**  
  - \(D=0\): 불충분(고차항 필요)

**예제 F**  
\(f(x,y)=x^2+y^2\) → \(\nabla f=0\) at (0,0), \(H=2I\succ 0\) → 최소.

---

## 9. 암시함수에서의 편도함수(Implicit)

방정식 \(F(x,y)=0\)이 \(y=y(x)\)를 암시하면
$$
\frac{dy}{dx}=-\frac{F_x}{F_y}\quad(F_y\neq 0).
$$
**예**: \(x^2+y^2-1=0\Rightarrow y'=-\dfrac{x}{y}\).

---

## 10. 수치 미분(실전 팁)

- **전진차분**: \(\partial_x f\approx\frac{f(x+h,y)-f(x,y)}{h}\) (간단하지만 오차 \(O(h)\))  
- **중심차분**: \(\partial_x f\approx\frac{f(x+h,y)-f(x-h,y)}{2h}\) (오차 \(O(h^2)\), 권장)  
- **스텝 크기**: \(h\approx \sqrt{\epsilon}(1+\|x\|)\) (부동소수점 \(\epsilon\) 고려)  
- 잡음/비매끄러움 함수는 **스무딩**이나 **정규화** 고려.

---

## 11. 실전 예제 모음(풀이 포함)

### 예제 1️⃣: 기본 편도
\( f(x,y)=\ln(1+x^2y)\), \(1+x^2y>0\).
$$
f_x=\frac{2xy}{1+x^2y},\qquad
f_y=\frac{x^2}{1+x^2y}.
$$

### 예제 2️⃣: 방향도함수
\( f(x,y)=e^{x^2-y}\), \(\hat{\mathbf{u}}=(\tfrac35,\tfrac45)\), 점 \((1,0)\):
- \(\nabla f=(2xe^{x^2-y},\ -e^{x^2-y})\Rightarrow \nabla f(1,0)=(2e,\ -e)\).
- \(D_{\hat{\mathbf{u}}}f=\langle 2e,-e\rangle\cdot\langle \tfrac35,\tfrac45\rangle=\tfrac{6e}{5}-\tfrac{4e}{5}=\tfrac{2e}{5}\).

### 예제 3️⃣: 혼합편도와 클레로
\( f(x,y)=x^3y^2\Rightarrow f_{xy}=6x^2y=f_{yx}\).

### 예제 4️⃣: 미분가능성 판정
\( f(x,y)=\sqrt{x^2+y^2}\)은 원점에서 부분적으로 방향 미분이 존재하나,
\(\nabla f\)가 원점에서 정의되지 않아(속도 동일할 수 없고 기울기 방향 불연속) **미분가능 아님**.

### 예제 5️⃣: 접평면
\( f(x,y)=\sin(xy)+x\), at \((a,b)=(1,\pi)\):
- \(f_x=b\cos(xy)+1\Rightarrow f_x(1,\pi)=\pi\cos\pi+1= -\pi+1\).
- \(f_y=x\cos(xy)\Rightarrow f_y(1,\pi)=\cos\pi=-1\).
- 접평면
  $$
  z\approx f(1,\pi)+(-\pi+1)(x-1)+(-1)(y-\pi).
  $$

---

## 12. PyTorch로 검증(오토그라드) — 사용자가 선호하는 PyTorch 기준

> 아래 코드는 **PyTorch**에서 편도, 그래디언트, 방향도함수, 헤시안을 **수치적으로** 확인합니다.

```python
import torch
torch.set_default_dtype(torch.float64)

# 예제 함수: f(x,y) = exp(x^2 - y) + x*y^2
def f_xy(xy):
    x, y = xy[..., 0], xy[..., 1]
    return torch.exp(x**2 - y) + x * y**2

# 1. 편도함수 & 그래디언트
xy = torch.tensor([1.0, 0.5], requires_grad=True)
f = f_xy(xy)
f.backward()  # df/dx, df/dy in xy.grad
grad_autograd = xy.grad.clone().detach()

# 수식으로 직접 계산(검증)
with torch.no_grad():
    x, y = xy
    fx = (2*x)*torch.exp(x**2 - y) + y**2
    fy = (-1.0)*torch.exp(x**2 - y) + 2*x*y
    grad_manual = torch.stack([fx, fy])

print("Gradient autograd:", grad_autograd.tolist())
print("Gradient manual :", grad_manual.tolist())

# 2. 방향도함수: u = normalized(1, 2)
u = torch.tensor([1.0, 2.0])
u = u / u.norm()
dir_deriv = (grad_autograd * u).sum().item()
print("Directional derivative along u:", dir_deriv)

# 3. 헤시안: jacobian-of-gradient 또는 torch.autograd.functional.hessian
xy = torch.tensor([1.0, 0.5], requires_grad=True)

def scalar_fn(xy):
    return f_xy(xy)

H = torch.autograd.functional.hessian(scalar_fn, xy)
print("Hessian:\n", H)

# 4. 수치 중심차분으로 ∂f/∂x 검증
def central_diff_x(xy, h=1e-5):
    x, y = xy.detach().numpy()
    xy_p = torch.tensor([x+h, y], dtype=torch.float64)
    xy_m = torch.tensor([x-h, y], dtype=torch.float64)
    return ((f_xy(xy_p) - f_xy(xy_m)) / (2*h)).item()

cdx = central_diff_x(torch.tensor([1.0, 0.5]))
print("Central-diff ∂f/∂x ≈", cdx)
print("Autograd      ∂f/∂x =", grad_autograd[0].item())
```

**출력 해석**
- `Gradient autograd` = `Gradient manual` 일치 → 편도/그래디언트 계산 확인.  
- 방향도함수 = \(\nabla f\cdot \hat{\mathbf{u}}\) 일치.  
- `Hessian`으로 2계 편도(혼합 포함) 확인.  
- 중심차분 근사와 오토그라드의 \(\partial f/\partial x\) 비교로 수치 검산.

---

## 13. 자주 보는 함수의 편도 요약(치트시트)

- \(f(x,y)=x^m y^n \Rightarrow f_x=mx^{m-1}y^n,\ f_y=nx^m y^{n-1}\).
- \(f(x,y)=e^{ax+by}\Rightarrow f_x=a e^{ax+by},\ f_y=b e^{ax+by}\).
- \(f(x,y)=\ln(ax+by+c)\Rightarrow f_x=\frac{a}{ax+by+c},\ f_y=\frac{b}{ax+by+c}\).
- \(f(x,y)=\| \mathbf{x}\|=\sqrt{x^2+y^2}\Rightarrow\)
  \(f_x=\dfrac{x}{\sqrt{x^2+y^2}},\ f_y=\dfrac{y}{\sqrt{x^2+y^2}}\) (단, 원점 제외).

---

## 14. 연습문제(간단 해설)

**Q1.** \(f(x,y)=\ln(1+xy+x^2)\). \(\partial f/\partial x,\ \partial f/\partial y\)?  
**A.** 분모 \(1+xy+x^2\).
\[
f_x=\frac{y+2x}{1+xy+x^2},\quad f_y=\frac{x}{1+xy+x^2}.
\]

**Q2.** \(f(x,y)=x e^{xy}\)의 \(\nabla f\)와 \(H\)?  
**A.**  
\(\nabla f=(e^{xy}+xy e^{xy},\ x^2 e^{xy})\).  
\(f_{xx}=2y e^{xy}+x y^2 e^{xy}\), \(f_{xy}=e^{xy}+x y e^{xy}+x y e^{xy}+x^2 e^{xy}=e^{xy}(1+2xy+x^2)\),  
\(f_{yy}=x^3 e^{xy}\).

**Q3.** \(F(x,y)=x^2+xy+y^2-3=0\)이 암시하는 \(y=y(x)\)의 \(dy/dx\)?  
**A.** \(dy/dx=-F_x/F_y=-(2x+y)/(x+2y)\) (단, \(x+2y\neq 0\)).

---

## 15. 요약

| 주제 | 핵심 식/포인트 |
|---|---|
| 정의 | \(\partial f/\partial x = \lim_{h\to 0}\dfrac{f(x+h,\cdot)-f(x,\cdot)}{h}\) |
| 기하학 | 단면 기울기, \(\nabla f\)는 최급상승 방향 |
| 방향도함수 | \(D_{\hat{\mathbf{u}}}f=\nabla f\cdot \hat{\mathbf{u}}\) |
| 고계·클레로 | \(f_{xy}=f_{yx}\) (이차 편도 연속 시) |
| 미분가능성 | 편도 존재 ≠ 연속/미분가능. 총괄 오차 \(o(\|\mathbf{h}\|)\) 확인 |
| 테일러/헤시안 | 2차 근사: \(f\approx f_0+\nabla f^\top h+\tfrac12 h^\top H h\) |
| 최적화 | \(\nabla f=0\) → \(H\)로 분류(최소/최대/안장) |
| 암시함수 | \(dy/dx=-F_x/F_y\) |
| 수치 미분 | 중심차분 권장, 스텝 \(h\) 조율 |
