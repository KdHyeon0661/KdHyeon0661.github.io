---
layout: post
title: 미적분 - 삼중적분
date: 2025-08-12 22:20:23 +0900
category: 미적분
---
# 삼중적분(Triple Integral)

## 0. 정의와 기하적 의미

스칼라장 \(f(x,y,z)\)와 3차원 영역 \(E\subset\mathbb{R}^3\)에 대해 **삼중적분**은
$$
\iiint_E f(x,y,z)\,dV
$$
로 표기하며, \(dV\)는 체적 미소요소(보통 \(dx\,dy\,dz\), \(r\,dr\,d\theta\,dz\), \(r^2\sin\phi\,dr\,d\phi\,d\theta\) 등)이다.

- **기하적 의미**:
  - \(f\equiv 1\) 이면 \(\iiint_E 1\,dV = \text{Vol}(E)\): **체적**.
  - \(f=\rho(x,y,z)\) 이면 \(\iiint_E \rho\,dV\): **질량**(밀도 \(\rho\)).

연속·유계 등의 통상 가정 하에서 적분 가능하다(엄밀성은 르베그론, 실전은 Fubini/Tonelli 정리로 뒷받침).

---

## 1. 반복적분과 Fubini/Tonelli 정리

삼중적분은 적절한 순서의 **반복적분**으로 계산한다. 예컨대
$$
\iiint_E f\,dV
=\int\!\!\int\!\!\int f(x,y,z)\,dz\,dy\,dx
=\int\!\!\int\!\!\int f(x,y,z)\,dx\,dz\,dy
=\cdots
$$
**Fubini/Tonelli** 정리는 적절한 가정 하에 **순서 교환 가능**함을 보장한다. 실전에서는 **가장 계산이 쉬운 순서**를 고른다.

---

## 2. 영역 \(E\)의 분류(Type I/II/III)

2차원에서 x-단순, y-단순이 있었듯 3차원에서는 보통 다음과 같이 분류한다.

- **Type I (z-단순)**:
  $$
  E=\{(x,y,z)\mid (x,y)\in D,\ \phi_1(x,y)\le z\le \phi_2(x,y)\}
  $$
  그러면
  $$
  \iiint_E f\,dV
  =\iint_D\left(\int_{z=\phi_1(x,y)}^{\phi_2(x,y)} f(x,y,z)\,dz\right)\,dA.
  $$

- **Type II (y-단순)**:
  $$
  E=\{(x,y,z)\mid (x,z)\in D,\ \psi_1(x,z)\le y\le \psi_2(x,z)\}
  $$
  $$
  \iiint_E f\,dV=\iint_D\left(\int_{y=\psi_1(x,z)}^{\psi_2(x,z)} f(x,y,z)\,dy\right)\,dA.
  $$

- **Type III (x-단순)**:
  $$
  E=\{(x,y,z)\mid (y,z)\in D,\ \eta_1(y,z)\le x\le \eta_2(y,z)\}
  $$
  $$
  \iiint_E f\,dV=\iint_D\left(\int_{x=\eta_1(y,z)}^{\eta_2(y,z)} f(x,y,z)\,dx\right)\,dA.
  $$

복잡한 영역은 \(E=E_1\cup E_2\cup\cdots\) 로 **분할**하여 각 부분에서 단순형으로 표현한다.

---

## 3. 기본 예제 — 체적과 간단한 함수

### 예제 A (사면체 체적)
평면 \(x=0\), \(y=0\), \(z=0\), 그리고 \(x+y+z=1\)로 둘러싸인 사면체 \(E\). 체적은?
- Type I (z-단순)로:
  - \((x,y)\) 영역 \(D=\{(x,y)\mid x\ge 0, y\ge 0, x+y\le 1\}\) (삼각형).
  - \(z\) 범위: \(0\le z\le 1-x-y\).
  $$
  \text{Vol}(E) = \iint_D\int_{0}^{1-x-y} 1\,dz\,dA
  = \iint_D (1-x-y)\,dA.
  $$
  이제 2D로:
  $$
  \int_{x=0}^{1}\int_{y=0}^{1-x} (1-x-y)\,dy\,dx
  =\int_0^1 \left[(1-x)y-\frac{y^2}{2}\right]_{0}^{1-x} dx
  $$
  $$
  =\int_0^1 \left((1-x)^2-\frac{(1-x)^2}{2}\right)dx
  =\frac12\int_0^1 (1-x)^2\,dx
  =\frac12\cdot\frac{1}{3}=\frac{1}{6}.
  $$
  정답: \(\text{Vol}(E)=\boxed{\frac{1}{6}}\).

### 예제 B (단위원기둥 위 “지붕”)
\(E\): \(x^2+y^2\le 1\) 원기둥 내부, \(0\le z \le 1-x^2-y^2\) (포물면 지붕).
- Type I:
  - \(D\): 원판 \(x^2+y^2\le 1\),
  - \(z\): \(0\le z\le 1-x^2-y^2\).
  $$
  \text{Vol}(E)=\iint_{x^2+y^2\le 1}\!\!\!(1-x^2-y^2)\,dA.
  $$
  극좌표 \(x=r\cos\theta, y=r\sin\theta, dA=r\,dr\,d\theta\)로:
  $$
  \int_0^{2\pi}\!\!\int_0^1 (1-r^2)\, r\,dr\,d\theta
  =2\pi\left[\frac{r^2}{2}-\frac{r^4}{4}\right]_{0}^{1}
  =2\pi\left(\frac12-\frac14\right)=\frac{\pi}{2}.
  $$
  \(\text{Vol}=\boxed{\pi/2}\).

---

## 4. 적분 순서 바꾸기(3D): 경계 재기술

### 예제 C (쐐기형 교차영역)
\(E=\{(x,y,z)\mid 0\le z\le 1,\ 0\le y\le z,\ 0\le x\le y\}\). \(\iiint_E 1\,dV\) ?
- 주어진 순서 \(dx\,dy\,dz\)라면:
  $$
  \int_{z=0}^{1}\int_{y=0}^{z}\int_{x=0}^{y} 1\,dx\,dy\,dz
  =\int_0^1\int_0^z y\,dy\,dz
  =\int_0^1 \frac{z^2}{2}\,dz
  =\frac{1}{6}.
  $$
- 순서를 바꾸어도 결과는 동일. 다만 다른 문제에서 \(f\)의 구조 때문에 어떤 순서가 유리해지는 경우가 흔하다.

---

## 5. 좌표변환 1: **원통좌표**(Cylindrical)

### 5.1 변환식과 야코비안
$$
x=r\cos\theta,\quad y=r\sin\theta,\quad z=z,\qquad dV=r\,dr\,d\theta\,dz.
$$

**적용 상황**: 원기둥/회전체/나선형 등 **축대칭** 구조.

### 5.2 예제

#### 예제 D (원뿔의 체적)
원뿔 \(E=\{(x,y,z)\mid 0\le z\le h,\ x^2+y^2\le (\alpha z)^2\}\) (꼭짓점 원점, 위로 열린 원뿔).
- 원통좌표로 \(0\le r\le \alpha z\), \(0\le \theta\le 2\pi\), \(0\le z\le h\).
  $$
  \text{Vol}=\int_{z=0}^{h}\int_{\theta=0}^{2\pi}\int_{r=0}^{\alpha z} r\,dr\,d\theta\,dz
  =\int_0^h \left(2\pi\cdot \frac{(\alpha z)^2}{2}\right)dz
  =\pi\alpha^2 \int_0^h z^2\,dz
  =\pi\alpha^2 \frac{h^3}{3}.
  $$
  바닥 반지름 \(R=\alpha h\) 이면 \(\text{Vol} = \frac13 \pi R^2 h\) (고전 결과).

#### 예제 E (반구 위의 적분)
\(x^2+y^2+z^2\le R^2\), \(z\ge 0\), \(f(x,y,z)=z\).
- 원통좌표: \(z\in[0,\sqrt{R^2-r^2}],\ r\in[0,R],\ \theta\in[0,2\pi]\).
  $$
  \iiint_E z\,dV
  =\int_0^{2\pi}\int_0^R\int_0^{\sqrt{R^2-r^2}} z\cdot r\,dz\,dr\,d\theta
  =2\pi\int_0^R\left[ \frac{z^2}{2}\right]_0^{\sqrt{R^2-r^2}} r\,dr
  $$
  $$
  =\pi\int_0^R (R^2-r^2) r\,dr
  =\pi\left[\frac{R^2 r^2}{2}-\frac{r^4}{4}\right]_0^R
  =\pi\left(\frac{R^4}{2}-\frac{R^4}{4}\right)=\frac{\pi R^4}{4}.
  $$

---

## 6. 좌표변환 2: **구면좌표**(Spherical)

### 6.1 변환식과 야코비안
극각 표준을 \(\phi\): \(z\)-축에서의 편각(0~\(\pi\)), \(\theta\): \(xy\)-평면의 방위각(0~\(2\pi\))
$$
x=\rho\sin\phi\cos\theta,\quad
y=\rho\sin\phi\sin\theta,\quad
z=\rho\cos\phi,\qquad
dV=\rho^2\sin\phi\,d\rho\,d\phi\,d\theta.
$$

**적용 상황**: 구/구각, 구대칭 \((x^2+y^2+z^2)\) 구조.

### 6.2 예제

#### 예제 F (구의 체적)
\(E: \rho\in[0,R], \phi\in[0,\pi], \theta\in[0,2\pi]\), \(f\equiv 1\).
$$
\text{Vol}
=\int_0^{2\pi}\int_0^{\pi}\int_0^{R} \rho^2\sin\phi\,d\rho\,d\phi\,d\theta
=2\pi\cdot \left[-\cos\phi\right]_0^\pi \cdot \frac{R^3}{3}
=2\pi\cdot (2)\cdot \frac{R^3}{3}
=\frac{4\pi R^3}{3}.
$$

#### 예제 G (구대칭 함수)
\(f(x,y,z)=g(\rho)\) 이면
$$
\iiint_E f\,dV
=\int\!\int\!\int g(\rho)\,\rho^2\sin\phi\,d\rho\,d\phi\,d\theta
=(\int_0^{2\pi} d\theta)(\int_0^\pi \sin\phi\,d\phi)\cdot \int g(\rho)\rho^2\,d\rho.
$$
방위/편각 적분은 \(4\pi\) 로 정리되어 **1D 적분** 문제로 귀결된다.

---

## 7. 일반 좌표변환(3D)와 야코비안

일반 변환 \(T:(u,v,w)\mapsto (x(u,v,w), y(u,v,w), z(u,v,w))\)가 가역·미분가능하고 야코비안
$$
J_T(u,v,w)=
\det
\begin{pmatrix}
\dfrac{\partial x}{\partial u} & \dfrac{\partial x}{\partial v} & \dfrac{\partial x}{\partial w}\\[6pt]
\dfrac{\partial y}{\partial u} & \dfrac{\partial y}{\partial v} & \dfrac{\partial y}{\partial w}\\[6pt]
\dfrac{\partial z}{\partial u} & \dfrac{\partial z}{\partial v} & \dfrac{\partial z}{\partial w}
\end{pmatrix}
\neq 0
$$
이면
$$
\iiint_E f(x,y,z)\,dV
=\iiint_{E^*} f\big(x(u,v,w), y(u,v,w), z(u,v,w)\big)\,\big|J_T(u,v,w)\big|\,du\,dv\,dw.
$$

### 예제 H (선형 스케일: 타원체 체적)
타원체
$$
\frac{x^2}{a^2}+\frac{y^2}{b^2}+\frac{z^2}{c^2}\le 1
$$
의 체적. 변환 \(x=au,\ y=bv,\ z=cw\) → 단위구 \(u^2+v^2+w^2\le 1\).
야코비안 \(|J|=abc\). 따라서
$$
\text{Vol}=\iiint_{u^2+v^2+w^2\le 1} abc\;du\,dv\,dw
=abc\cdot \frac{4\pi}{3}.
$$
고전 결과: \(\boxed{\frac{4\pi}{3}abc}\).

---

## 8. 물리량: 질량·무게중심·관성모멘트

### 8.1 질량과 무게중심
밀도 \(\rho(x,y,z)\) 를 가진 3차원 물체 \(E\) 의 **질량**
$$
M=\iiint_E \rho\,dV.
$$
무게중심 \((\bar{x},\bar{y},\bar{z})\)
$$
\bar{x}=\frac{1}{M}\iiint_E x\,\rho\,dV,\quad
\bar{y}=\frac{1}{M}\iiint_E y\,\rho\,dV,\quad
\bar{z}=\frac{1}{M}\iiint_E z\,\rho\,dV.
$$

#### 예제 I (균질 반구의 무게중심)
반구 \(x^2+y^2+z^2\le R^2,\ z\ge 0\), \(\rho\equiv \rho_0\).
대칭성으로 \(\bar{x}=\bar{y}=0\). \(\bar{z}=\dfrac{1}{M}\iiint_E z\rho_0\,dV\).
- 앞서 예제 E: \(\iiint_E z\,dV=\frac{\pi R^4}{4}\).
- 질량 \(M=\rho_0\cdot \text{Vol}(\text{반구})=\rho_0\cdot \frac{2\pi R^3}{3}\).
따라서
$$
\bar{z}=\frac{\rho_0\cdot (\pi R^4/4)}{\rho_0\cdot (2\pi R^3/3)}
=\frac{3R}{8}.
$$
고전 결과 \(\boxed{\bar{z}=3R/8}\).

### 8.2 관성모멘트(원점 기준)
밀도 \(\rho\) 에 대해
$$
I_O=\iiint_E (x^2+y^2+z^2)\,\rho\,dV.
$$
축 관성모멘트(예: z-축)
$$
I_z=\iiint_E (x^2+y^2)\,\rho\,dV.
$$

#### 예제 J (균질 실구의 원점 관성모멘트)
반지름 \(R\), \(\rho\equiv \rho_0\), \(E=\{\rho\le R\}\). 구면좌표에서
$$
I_O=\iiint_E \rho_0\, (x^2+y^2+z^2)\,dV
=\rho_0 \int_0^{2\pi}\int_0^\pi\int_0^R (\rho^2)\, \rho^2\sin\phi\,d\rho\,d\phi\,d\theta
$$
$$
= \rho_0\cdot (2\pi)\cdot 2\cdot \int_0^R \rho^4\,d\rho
=4\pi\rho_0\cdot \frac{R^5}{5}
=\frac{3M}{R^3}\cdot \frac{R^5}{5} \quad (M=\frac{4\pi R^3}{3}\rho_0)
=\frac{3}{5}MR^2.
$$
고전 결과: \(I_O=\boxed{\frac{3}{5}MR^2}\).

---

## 9. 비정상(Improper) 삼중적분

무한 영역 또는 특이점이 있는 경우 **극한**으로 정의한다.

### 예제 K (3D 가우스)
\(\mathbb{R}^3\) 에서 \(f(x,y,z)=e^{-(x^2+y^2+z^2)}\).
- 구면좌표:
  $$
  \iiint_{\mathbb{R}^3} e^{-(x^2+y^2+z^2)}\,dV
  =\int_0^{2\pi}\int_0^\pi\int_0^\infty e^{-\rho^2}\rho^2\sin\phi\,d\rho\,d\phi\,d\theta
  $$
  $$
  =(4\pi)\int_0^\infty e^{-\rho^2}\rho^2\,d\rho
  =4\pi\cdot \frac{\sqrt{\pi}}{4}=\pi^{3/2}.
  $$
(사용한 표준 적분: \(\int_0^\infty e^{-\rho^2}\rho^{n}\,d\rho\) 의 값, 또는 1D 가우스 적분의 3중 곱으로 증명 가능.)

---

## 10. 계산 숙련: 순서 선택·분할·대칭·좌표변환

- **순서 선택**: 내적분을 쉽게 만드는 변수를 고른다. 분모에 \(x^2+y^2\)형이 보이면 **원통/구면** 고려.
- **영역 분할**: 하나의 단순형으로 안 되면 \(E=E_1\cup E_2\)로 쪼갠다.
- **대칭**: 함수·영역의 대칭을 활용해 0 또는 배수로 줄인다.
- **좌표변환**: 원통(\(r\)), 구면(\(\rho^2\sin\phi\))의 **야코비안**을 절대 잊지 말 것.

---

## 11. 심볼릭·수치 검증 코드 (SymPy·NumPy)

```python
# SymPy로 기본 예제 검증 및 NumPy로 몬테카를로/격자 근사
import sympy as sp
import numpy as np

# ---------- SymPy 심볼릭 ----------
x, y, z, R, h, a, b, c = sp.symbols('x y z R h a b c', positive=True, real=True)

# 예제 A: 사면체 체적 = 1/6
vol_tetra = sp.integrate(sp.integrate(sp.integrate(1, (z, 0, 1 - x - y)),
                                      (y, 0, 1 - x)),
                         (x, 0, 1))
print("Tetra volume:", sp.simplify(vol_tetra))  # 1/6

# 예제 B: 포물지붕 원기둥 Vol = π/2
r, th = sp.symbols('r th', positive=True, real=True)
vol_b = sp.integrate(sp.integrate((1 - r**2)*r, (r, 0, 1)), (th, 0, 2*sp.pi))
print("Paraboloid over unit disk:", sp.simplify(vol_b))  # π/2

# 예제 H: 타원체 체적 = 4πabc/3
vol_ellipsoid = 4*sp.pi*a*b*c/3
print("Ellipsoid volume:", vol_ellipsoid)

# ---------- NumPy: 몬테카를로로 구체적분 근사 ----------
# ∭_{x^2+y^2+z^2 <= 1} (x^2 + y^2 + z^2) dV = ? (분석값: ∫_0^1 4π r^4 dr = 4π/5)
def monte_carlo_sphere_integral(n=200000, R=1.0, seed=0):
    rng = np.random.default_rng(seed)
    # 박스 [-R,R]^3에서 샘플
    pts = rng.uniform(-R, R, size=(n, 3))
    rsq = np.sum(pts**2, axis=1)
    inside = rsq <= R**2
    vals = rsq[inside]  # f = x^2 + y^2 + z^2
    vol_box = (2*R)**3
    # 구 내부 비율 * 평균값 * 박스 부피
    est = vol_box * np.mean(vals)
    # 하지만 평균은 inside에 대한 평균 -> inside 비율도 곱해야 실제 평균
    est = vol_box * np.mean(inside) * np.mean(vals)
    return est

est = monte_carlo_sphere_integral()
print("Monte Carlo ∭_{ball} (x^2+y^2+z^2) dV ≈", est, "  exact:", 4*np.pi/5)
```

**메모**: 구 내부에서 직접 샘플링하면 분산이 감소한다. 여기서는 단순 박스-샘플로 개념만 시연.

---

## 12. 대표 종합 예제

### 예제 L (두 곡면 사이의 체적: 포물면과 평면)
\(E=\{(x,y,z)\mid x^2+y^2\le 1,\ 0\le z \le 2 - x^2 - y^2\}\).
- 원통좌표로 즉시:
  $$
  \text{Vol}=\int_0^{2\pi}\int_0^1\int_{z=0}^{2-r^2} r\,dz\,dr\,d\theta
  =2\pi\int_0^1 (2 - r^2) r\,dr
  =2\pi \left[\frac{2r^2}{2}-\frac{r^4}{4}\right]_0^1
  $$
  $$
  =2\pi\left(1-\frac{1}{4}\right)=\frac{3\pi}{2}.
  $$

### 예제 M (무게중심: 선형 밀도)
밀도 \(\rho(x,y,z)=1+z\) 가 \(\{x^2+y^2\le 1,\ 0\le z\le 1-x^2-y^2\}\) 에 분포.
- 질량:
  $$
  M=\int_0^{2\pi}\int_0^1\int_0^{1-r^2} (1+z)\, r\,dz\,dr\,d\theta
  =2\pi\int_0^1 \left[(z + z^2/2)r\right]_0^{1-r^2} dr
  $$
  $$
  =2\pi\int_0^1 \left[(1-r^2) + \frac{(1-r^2)^2}{2}\right] r\,dr.
  $$
  \((1-r^2)^2 = 1 - 2r^2 + r^4\) 로 전개하여 다항 적분 가능.
- \(\bar{z}=\frac{1}{M}\iiint z\rho\,dV\) 도 같은 방식으로 계산(생략).  
  **핵심**: 원통좌표로 변환하면 **z-적분이 닫힌형**이 되어 1D 다항 적분 문제로 떨어진다.

### 예제 N (관성모멘트: z-축 기준)
\(E=\{x^2+y^2+z^2\le R^2\}\), \(\rho\equiv 1\). \(I_z=\iiint_E (x^2+y^2)\,dV\).
- 원통좌표에서 \(x^2+y^2=r^2\):
  $$
  I_z=\int_0^{2\pi}\int_0^R\int_{-\,\sqrt{R^2-r^2}}^{\sqrt{R^2-r^2}} r^2 \cdot r\,dz\,dr\,d\theta
  =2\pi\int_0^R r^3 \cdot 2\sqrt{R^2-r^2}\, dr.
  $$
  치환 \(r=R\sin t\) 등으로 닫힌형 결과(표준 결과 \(I_z=\frac{2}{5}MR^2\))를 얻는다(균질 구의 축 관성모멘트).

---

## 13. 자주 하는 실수와 체크리스트

- □ **영역 스케치**(두세 뷰: \(xy\), \(xz\), \(yz\)-투영)를 먼저 한다.
- □ **Type I/II/III** 중 하나로 표현 가능한가? 안 되면 **분할**.
- □ 적분 순서가 **내적분을 쉽게** 하는가? 필요 시 **순서 교환**.
- □ 원통·구면 좌표의 **야코비안**( \(r\), \(\rho^2\sin\phi\) )을 반드시 포함했는가.
- □ **대칭성**(짝·홀, 회전대칭)을 적극 활용했는가.
- □ 비정상(무한 영역·특이점) 적분은 **극한 정의**와 수렴성 점검을 했는가.
- □ 심볼릭/수치로 **결과 검증**(단위·극한·근사 일치)했는가.

---

## 14. 한 페이지 요약(공식 모음)

- 반복적분(3D): Type I/II/III 로 펴고, Fubini/Tonelli로 순서 교환 가능.  
- 원통좌표:
  $$
  x=r\cos\theta,\ y=r\sin\theta,\ z=z,\quad dV=r\,dr\,d\theta\,dz.
  $$
- 구면좌표:
  $$
  x=\rho\sin\phi\cos\theta,\ y=\rho\sin\phi\sin\theta,\ z=\rho\cos\phi,\quad
  dV=\rho^2\sin\phi\,d\rho\,d\phi\,d\theta.
  $$
- 일반변환:
  $$
  \iiint_E f\,dV=\iiint_{E^*} f\circ T\cdot |J_T|\,du\,dv\,dw.
  $$
- 물리: \(M=\iiint \rho\,dV\), \(\bar{\mathbf{r}} = \frac{1}{M}\iiint \mathbf{r}\rho\,dV\), \(I_O=\iiint r^2\rho\,dV\).

---

## 15. 연습문제(풀이 스케치)

1) \(E=\{x^2+y^2\le 1,\ 0\le z\le 1\}\) 에서 \(\iiint_E (x^2+y^2)\,dV\).  
   → 원통좌표, \(r\in[0,1], z\in[0,1]\).

2) \(E=\{x^2+y^2+z^2\le R^2,\ z\ge 0\}\) 에서 \(\iiint_E z\,dV\).  
   → 원통좌표 또는 구면좌표, 위 결과 \(\pi R^4/4\) 확인.

3) 사면체 \(x=0,y=0,z=0,x+y+z=1\) 에서 \(\iiint_E (x+y+z)\,dV\).  
   → Type I, 내적분부터 선형 다항.

4) 타원체 \(\frac{x^2}{9}+\frac{y^2}{4}+\frac{z^2}{1}\le 1\) 면적/체적.  
   → 선형변환 야코비안 \(|J|=abc=3\cdot 2\cdot 1\), 체적 \(=4\pi abc/3=8\pi\).

5) \(E=\{0\le z\le 2,\ x^2+y^2\le z\}\) 에서 \(\iiint_E 1\,dV\) (상부로 갈수록 반지름 \(\sqrt{z}\)).  
   → 원통좌표 \(r\le \sqrt{z}\) 로 \(z\)-우선 적분.

---

## 16. 마무리

삼중적분은 **영역 기하**(투영/단순형/분할)와 **함수 구조**(대칭/좌표변환)를 동시에 읽어내는 기술이다.  
루틴은 다음과 같다:
1) **3면 투영 스케치** → Type I/II/III 설계,  
2) **순서 교환**으로 내적분 단순화,  
3) **원통·구면·일반 변환 + 야코비안**으로 구조적 단순화,  
4) **심볼릭/수치**로 검증.