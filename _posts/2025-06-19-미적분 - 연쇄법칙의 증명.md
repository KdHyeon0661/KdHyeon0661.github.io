---
layout: post
title: 미적분 - 연쇄법칙의 증명
date: 2025-06-19 23:20:23 +0900
category: 미적분
---
# 연쇄법칙의 증명 (Proof of the Chain Rule)

합성함수 $$y=f(g(x))$$ 의 도함수는
$$
\boxed{\displaystyle \frac{d}{dx}f(g(x))=f'(g(x))\cdot g'(x)}
$$
입니다. 아래에 **정의에서 출발한 표준 증명**, **잔차항(소-o) 기반의 엄밀 증명**, **코시 평균값정리(CMVT) 증명**, **선형화(가해석적) 증명**, 그리고 **확장·주의점**을 정리합니다.  
(모든 수식은 $$\cdots$$, 코드는 ``` 로 감쌉니다.)

---

## ✅ 1) 연쇄법칙이란?

미분 가능한 두 실함수 $$f, g$$ 에 대해 합성 $$y=f(g(x))$$ 가 주어지면
$$
\frac{dy}{dx}=f'(g(x))\,g'(x).
$$
직관적으로는 **“밖을 미분하고, 안의 도함수를 곱한다.”**

---

## ✅ 2) 표준 해석적 증명(정의에서 바로)

가정: $$g$$ 는 $$x$$ 에서 미분 가능, $$f$$ 는 $$g(x)$$ 에서 미분 가능.

도함수 정의로 시작:
$$
\frac{d}{dx}f(g(x))
=\lim_{h\to 0}\frac{f\big(g(x+h)\big)-f\big(g(x)\big)}{h}.
$$
분모·분자에 $$g(x+h)-g(x)$$ 를 곱하고 나눔:
$$
=\lim_{h\to 0}
\left(
\frac{f(g(x+h))-f(g(x))}{g(x+h)-g(x)}
\cdot
\frac{g(x+h)-g(x)}{h}
\right).
$$
여기서 $$g(x+h)\to g(x)$$ 이므로 첫 번째 극한은 $$f'(g(x))$$, 두 번째는 $$g'(x)$$:
$$
\frac{d}{dx}f(g(x))=f'(g(x))\,g'(x).
$$
□

> 핵심 트릭: **중간변수 증분** $$g(x+h)-g(x)$$ 로 나누어 **곱의 두 극한**으로 분리.

---

## ✅ 3) 잔차항(소-o) 기반의 ε–δ 엄밀 증명

미분 가능은 **선형근사 + 잔차항**으로 기술됩니다. $$h\to 0$$ 에 대하여
$$
g(x+h)=g(x)+g'(x)h+\alpha(h),\qquad \frac{\alpha(h)}{h}\xrightarrow[h\to 0]{}0,
$$
$$
f(u+\Delta)=f(u)+f'(u)\,\Delta+\beta(\Delta),\qquad \frac{\beta(\Delta)}{\Delta}\xrightarrow[\Delta\to 0]{}0.
$$
여기서 $$u=g(x)$$, $$\Delta=g(x+h)-g(x)=g'(x)h+\alpha(h)$$.

그럼
$$
\begin{aligned}
f(g(x+h))-f(g(x))
&= f'(g(x))\,\Delta+\beta(\Delta) \\
&= f'(g(x))\big(g'(x)h+\alpha(h)\big)+\beta(\Delta).
\end{aligned}
$$
이를 $$h$$ 로 나누면
$$
\frac{f(g(x+h))-f(g(x))}{h}
= f'(g(x))\,g'(x)+f'(g(x))\frac{\alpha(h)}{h}+\frac{\beta(\Delta)}{h}.
$$
여기서
- $$\dfrac{\alpha(h)}{h}\to 0$$,
- $$\dfrac{\beta(\Delta)}{h}=\dfrac{\beta(\Delta)}{\Delta}\cdot \dfrac{\Delta}{h} \to 0\cdot g'(x)=0.$$

따라서
$$
\lim_{h\to 0}\frac{f(g(x+h))-f(g(x))}{h}=f'(g(x))\,g'(x).
$$
□

> 이 증명은 **ε–δ 수준의 엄밀성**을 갖추며, “미분 가능 ⇔ 선형근사 가능”을 핵심으로 씁니다.

---

## ✅ 4) 코시 평균값정리(CMVT) 기반 증명

$$h\neq 0$$ 에 대해 구간 $$[x,x+h]$$ 에서
$$
A(t)=f(g(t)),\quad B(t)=g(t).
$$
코시 평균값정리를 $$A,B$$ 에 적용하면 어떤 $$\xi\in(x,x+h)$$ 가 존재하여
$$
\frac{A(x+h)-A(x)}{B(x+h)-B(x)}=\frac{A'(\xi)}{B'(\xi)}
=\frac{f'(g(\xi))\,g'(\xi)}{g'(\xi)}=f'(g(\xi)),
$$
단 $$B(x+h)\ne B(x)$$(즉 $$g'$$ 이 어딘가에서 0이 아니면 성립; 0이어도 전체 논증은 표준 방식으로 정리 가능).  
따라서
$$
\frac{f(g(x+h))-f(g(x))}{h}
=\frac{f(g(x+h))-f(g(x))}{g(x+h)-g(x)}\cdot\frac{g(x+h)-g(x)}{h}
=f'(g(\xi))\cdot \frac{g(x+h)-g(x)}{h}.
$$
$$h\to 0$$ 이면 $$\xi\to x$$, 연속성과 미분가능성에 의해
$$
\to f'(g(x))\cdot g'(x).
$$
□

---

## ✅ 5) 선형화(가해석적 관점) 증명

미분 가능을 **선형변환 + 고차잔차**로 본 관점:
$$
g(x+h)=g(x)+g'(x)h+o(h),\qquad
f(u+\Delta)=f(u)+f'(u)\Delta+o(\Delta).
$$
합성하면
$$
f(g(x+h))=f(g(x))+f'(g(x))\big(g'(x)h+o(h)\big)+o(h)
=f(g(x))+f'(g(x))\,g'(x)h+o(h).
$$
따라서 미분계수는 $$f'(g(x))\,g'(x)$$. □

---

## ✅ 6) 예제로 흐름 재확인

### 예: $$y=\sin(x^2)$$
- $$f(u)=\sin u,\ f'(u)=\cos u;\quad g(x)=x^2,\ g'(x)=2x.$$
- 연쇄법칙: 
  $$
  \frac{d}{dx}\sin(x^2)=\cos(x^2)\cdot 2x.
  $$

> 같은 방식으로 $$\ln(\cos x),\ e^{\tan x},\ \sqrt{3x+1}$$ 등도 바로 나온다.

---

## ✅ 7) 다변수 연쇄법칙(확장 스냅샷)

벡터값 내부함수 $$\mathbf{u}(t)$$, 스칼라 외부함수 $$f:\mathbb{R}^n\to\mathbb{R}$$:
$$
\frac{d}{dt}f(\mathbf{u}(t))=\nabla f(\mathbf{u}(t))\cdot \mathbf{u}'(t).
$$
행렬형(스칼라/벡터 혼합 일반형):
$$
D\big(f\circ g\big)(x)=Df\big(g(x)\big)\cdot Dg(x).
$$

---

## ✅ 8) 자주 하는 오해·주의

- **연속성 필요**: $$g$$ 가 $$x$$ 에서 미분 가능 ⇒ **연속**이므로 $$g(x+h)\to g(x)$$. 이 점이 2단계 극한에서 중요.  
- **정의역 점검**: $$f$$ 는 반드시 $$u=g(x)$$ 의 **값에서** 미분 가능해야 함.  
- **특이점**: $$g'(x)=0$$ 여도 연쇄법칙은 성립(값이 0이 될 뿐).  
- **암시적/역함수 미분**: 모두 연쇄법칙의 변형·응용이다.

---

## ✅ 9) 요약 정리

| 관점 | 핵심 아이디어 | 결론 |
|---|---|---|
| 정의 직진 | $$\frac{f(g(x+h))-f(g(x))}{h}$$ 를 중간증분으로 분해 | $$f'(g(x))\,g'(x)$$ |
| 소-o/ε–δ | 선형근사 + 잔차항 소멸 | $$f'(g(x))\,g'(x)$$ |
| CMVT | 두 함수에 코시 평균값정리 | $$f'(g(\xi))\to f'(g(x))$$ |
| 선형화 | 합성의 1차 항만 추출 | $$f'(g(x))\,g'(x)$$ |

연쇄법칙은 **미분의 합성 규칙**이자, 다변수/암시적/역함수/로그 미분 등 **거의 모든 미분 테크닉의 뼈대**입니다.