---
layout: post
title: 형식언어와 오토마타 - 문맥 자유 언어에 대한 결정 불가능 문제
date: 2025-08-10 14:20:23 +0900
category: 형식언어와 오토마타
---
# 문맥 자유 언어(CFL)에 대한 **결정 불가능 문제**

문맥 자유 언어(CFL)는 파싱·컴파일러의 **실무 핵심 클래스**이지만, **전역적 성질**을 묻는 많은 문제는 **결정 불가능**(undecidable)이다.

---

## 0. 한눈에 보는 지형도

### 0.1 **결정 가능한**(Decidable) 표준 문제
- **멤버십(소속성)**: $$w\in L(G)\ ?$$  → **다항시간**(CYK: $$O(n^3)$$, Earley 평균 좋음).
- **공백성(emptiness)**: $$L(G)=\varnothing\ ?$$ → **결정 가능**(생성 가능한 비단말/도달 가능한 비단말만 남겨 검사).
- **유한성/무한성**: $$|L(G)|<\infty\ ?$$ → **결정 가능**(유도 그래프의 순환·펌핑 증거).
- **CFL ∩ REG의 공백성**: $$L(G)\cap R=\varnothing\ ?$$ → **결정 가능**(PDA×DFA 제품 → CFL 공백성).
- **포함(한쪽이 정규)**: $$L(G)\subseteq R\ ?$$
  $$\iff\ L(G)\cap \overline{R}=\varnothing$$ 이고 $$\overline{R}$$도 정규 → **결정 가능**.

### 0.2 **결정 불가능**(Undecidable) 표준 문제
- **보편성(Universality)**: $$L(G)=\Sigma^*$$ ?
- **포함(둘 다 CFL)**: $$L(G_1)\subseteq L(G_2)$$ ?
- **동치**: $$L(G_1)=L(G_2)$$ ?
- **교집합 공백성**: $$L(G_1)\cap L(G_2)=\varnothing$$ ?
- **모호성(Ambiguity)**: 주어진 CFG가 모호한가?
- **본질적(고유) 모호성**: 해당 언어가 **어떤 CFG로도** 비모호화 불가인가?
- **정규성 여부**: $$L(G)$$가 정규(REG)인가?
- **DCFL 여부**: $$L(G)$$가 **결정적** PDA(=DPDA)로 인식 가능한가?

> **핵심 감각**
> - **정규와 섞인 연산**(정규의 보수·교집합 활용)은 종종 **결정 가능**.
> - **CFL끼리의 전역 비교**(포함/동치/보편성/교집합 공백성)와 **구문-의미 성질**(모호성/정규성/결정성)은 **결정 불가능**으로 떨어진다.

---

## 1. “가능” 영역 — 알고리즘 스냅샷

### 1.1 멤버십(CYK) 의사코드
```text
# 입력: CNF 형태 CFG G=(V,Σ,P,S), 단어 w[1..n]
CYK(G, w):
  for i in 1..n:
    T[i,i] := { A | A→w[i] ∈ P }
  for len in 2..n:
    for i in 1..n-len+1:
      j := i+len-1
      T[i,j] := ∅
      for k in i..j-1:
        for A→BC in P:
          if B∈T[i,k] and C∈T[k+1,j]: add A to T[i,j]
  return (S ∈ T[1,n])
```

### 1.2 공백성 / 유한성 검사
- **공백성**: “생성 가능한 비단말(터미널을 유도)”과 “시작기호에서 도달 가능한 비단말”을 남기고, 시작기호가 남는지 검사.
- **유한성**: 유도 그래프에 “길이를 늘리는 순환(생산적 사이클)”이 있으면 무한. 없으면 유한.

```text
# 공백성 개략
Emptiness(G):
  mark all A that derive some terminal string (backward reachable via A→α with α∈(marked∪Σ)*)
  keep only marked + reachable-from-S
  return (S is removed ?)  # 제거되면 공백
```

### 1.3 CFL ∩ REG 공백성(제품 구성)
- 주어진 DFA $$\mathcal{A}$$ 와 CFG $$G$$ 에 대해 **PDA×DFA** 제품을 구성하면 다시 **PDA**.
- 그 PDA의 **공백성**은 CFG로 변환 후 **결정 가능**.

---

## 2. 대표 **결정 불가능 문제** — 직관과 스케치

### 2.1 **보편성**: $$L(G)=\Sigma^*$$ ?
- **직관**: 보수에 닫혀 있지 않고, “모든 문자열”은 $$\forall w$$ 전역 양화를 내포 → **전역 검증** 필요.
- **감소 스케치(정지 문제/$$A_{TM}$$ → 보편성)**
  튜링 기계 $$M,w$$ 를 받아 **“옳은 계산만 빠져나가는 작은 구멍”**을 남기도록 CFG를 구성.
  - $$M(w)$$ 가 **수용**이면 그 구멍이 **사라져** $$\Sigma^*$$ 전체 생성(=보편).
  - 수용하지 않으면 구멍이 남아 **보편 아님**.

### 2.2 **포함/동치**: $$L(G_1)\subseteq L(G_2),\ L(G_1)=L(G_2)$$ ?
- 둘 다 **\(\forall w\)** 비교. 보편성에서 변형 가능:
  $$\Sigma^*\subseteq L(G) \iff L(G)=\Sigma^*.$$
- 따라서 포함/동치도 **결정 불가능**.

### 2.3 **교집합 공백성**: $$L(G_1)\cap L(G_2)=\varnothing$$ ?
- **핵심**: CFL은 **교집합에 닫혀 있지 않음**.
- **감소(PCP)**: PCP에 해가 **있으면** 두 CFG가 **같은 문자열**을 하나라도 만든다(교집합 **비공백**).
  해가 없으면 **공백**.
  ⇒ **결정 불가능**, 한편 “비공백 여부”는 **RE**(증거 문자열을 열거해 두 멤버십을 검사) → **공백성은 co-RE-완**.

### 2.4 **모호성(Ambiguity)** / **본질적 모호성**
- **정의**: 어떤 $$w$$ 에 대해 **서로 다른 두 유도(파스 트리)** 가 있으면 **모호**.
- **문제**: “CFG가 모호한가?”는 **결정 불가능**. (PCP류 감소로 클래식)
  “언어 자체가 본질적으로 모호한가?”도 **결정 불가능**.

> **예시 감각**: 산술식 문법의 전형적 모호성
> ```
> E → E + E | E * E | (E) | id
> ```
> 같은 문자열에 대해 우선순위/결합규칙이 없으면 **여러 파스 트리** 가능 → 모호.

### 2.5 **정규성 여부** / **DCFL 여부**
- “$$L(G)$$ 가 정규인가?” — **결정 불가능**.
  (정규/비정규를 가르는 전역 동기화(펌핑 역방향)를 일반 프로그램으로 판정할 수 없음.)
- “$$L(G)$$ 가 결정적 PDA(=DPDA)로 인식 가능한가?” — **결정 불가능**.
  *(참고)* DPDA **동치성**은 매우 난해하지만 **결정 가능**(Sénizergues). 그러나 **일반 PDA 동치성**은 **결정 불가능**.

---

## 3. 전형 **감소(변형) 레시피** — 패턴과 가젯

### 3.1 PCP → **CFL 교집합 공백성**
- **입력**: PCP 인스턴스 $$P=\{(u_i,v_i)\}_{i=1}^k$$.
- **구성 요지**: 두 CFG $$G_1,G_2$$ 를 만들어 같은 인덱스열로
  $$L(G_1)=\{u_{i_1}\cdots u_{i_m} \# i_1\cdots i_m\}$$,
  $$L(G_2)=\{v_{i_1}\cdots v_{i_m} \# i_1\cdots i_m\}$$.
- **정직성**: PCP 해 ⇔ 어떤 인덱스열에 대해 위·아래 문자열이 같음 ⇔ **교집합 비공백**. 해가 없으면 공백.

> **가젯 공통기술**
> - **구분자** `#`, **시작/종료 마커**,
> - “한 칸/두 칸짜리 **지역 검사**” 규칙(CNF, GNF로도 구현),
> - 필요 시 **호모모르피즘**으로 중간 기호 제거.

### 3.2 $$A_{TM}$$/정지 → **보편성/포함/동치**
- **아이디어**: “**올바른 계산**을 제외한 나머지 문자열은 **전부 생성**”하도록 CFG를 설계.
  올바른 계산이 **존재**하면 그 **유일 패턴**은 생성되지 않아 **보편 실패**,
  존재하지 않으면 **모든 문자열** 생성 → **보편**.

### 3.3 **모호성**으로 암호화
- 동일 문자열을 **두 방식**으로 유도 가능하게 가젯을 설계하고,
  그 두 방식 중 하나가 “올바른 계산”을 의미하도록 연결.
  계산이 성립할 때만 **두 유도**가 모두 가능 ⇒ **모호**.

---

## 4. 수식 관점 — 왜 상위 계층으로 “뛰나”?

- **보편성**:
  $$
  L(G)=\Sigma^* \iff \forall w\ \ (w\in L(G)).
  $$
  한편 $$w\in L(G)$$ 는 “$$\exists$$ 유도 길이, $$\exists$$ 파스 트리 …”의 **존재 양화**.
  ⇒ 전반적으로 **\(\forall\exists\)** 형태(산술계층 **\(\Pi^0_2\)** 류) → **결정 불가능**.

- **포함/동치**:
  $$
  L(G_1)\subseteq L(G_2) \iff \forall w\ (w\in L(G_1) \Rightarrow w\in L(G_2)).
  $$

- **교집합 공백성**:
  $$
  L(G_1)\cap L(G_2)\neq\varnothing \iff \exists w\ (w\in L(G_1)\land w\in L(G_2)),
  $$
  **존재 증거(문자열)**가 있으면 **RE**(열거·검증 가능) → **공백성은 co-RE**.

---

## 5. “정규와 섞으면 쉬워지는” 이유

정규 $$R$$ 에 대해
$$
L(G)\subseteq R \iff L(G)\cap \overline{R}=\varnothing.
$$
정규류는 **보수/교집합**에 닫혀 있고, **CFL ∩ REG**도 **CFL**이므로 **공백성**으로 환원 → **결정 가능**.
반대로 **REG ⊆ CFL** 판정은 곧 **보편성**( $$\Sigma^*\subseteq L(G)$$ )이라 **결정 불가능**.

---

## 6. 작동 예제 — **PCP → 교집합 공백성** 끝까지

### 6.1 입력 PCP
```
P = { (u1, v1), (u2, v2), ..., (uk, vk) }  over alphabet Σ
```

### 6.2 두 CFG의 스켈레톤
```text
# 공통 아이디어: 같은 인덱스열 i1...im 을 오른쪽에 그대로 붙여
# '윗줄 문자열'과 '아랫줄 문자열'이 같을 때만 L(G1)과 L(G2)가 같은 w를 만든다.

# Gidx: 인덱스열 생성 보조 문법
I  -> i1 I | i2 I | ... | ik I | ε

# G1: u-문자열을 만든 다음 #와 인덱스열을 덧붙임
S1 -> U I
U  -> U u1 | U u2 | ... | U uk | ε
# 실제로는 U와 I를 '짝'으로 동기화해야 하므로
#   (U,I) 상태를 함께 진행하게 만드는 규칙 가젯이 필요(인덱스 하나 뽑아 두 줄에 똑같이 반영)

# G2: v-문자열을 만든 다음 #와 같은 인덱스열을 덧붙임
S2 -> V I
V  -> V v1 | V v2 | ... | V vk | ε
```

### 6.3 동기화(핵심 가젯)
실제 구현에서는 “**같은 인덱스**를 동시에 택해 두 줄에 각각 $$u_i, v_i$$ 를 추가”하는 **결합 규칙**이 필요하다.
예를 들어 중간 기호 $$X$$ 를 써서
```text
S  -> X S | ε
X  -> (u1 , i1 , v1) | (u2 , i2 , v2) | ... | (uk , ik , vk)
```
처럼 “삼중 구조”를 생성해 놓고, **두 다른 투영**으로 각각을 읽게 만드는 기법(호모모르피즘/역호모)으로 구현한다.

- 투영 $$h_1$$: 삼중에서 **윗줄(u\_i)** 만 읽고 끝에 `#`와 **인덱스열**을 출력.
- 투영 $$h_2$$: 삼중에서 **아랫줄(v\_i)** 만 읽고 동일 인덱스열.

그러면
- **PCP 해 존재** ⇒ 어떤 삼중열의 윗줄과 아랫줄 투영이 **동일 문자열** ⇒
  $$h_1(L(\text{삼중})) \cap h_2(L(\text{삼중})) \neq \varnothing$$.
- 해 **부재** ⇒ 교집합 **공백**.

> *참고*: 실제 정규형(CNF/GNF)로 다듬는 과정에서는 **보조 비단말**과 **지역 일관성 규칙**을 추가한다.
> 핵심은 “**같은 인덱스열**이라는 정보”를 **구분자/마커**와 함께 끝까지 운반하는 것.

---

## 7. 실무 체크리스트 — 새 문제를 **CFL-불가능**으로 만들 때

1) **출발점** 고르기: **PCP**, **정지/$$A_{TM}$$**.
2) **부호화**: 문자열·인덱스열·경계 `#` 로 **지역 제약**을 강제.
3) **양방향 논리**:
   - (⇒) 예(PCP 해/수용 계산)면 목표 성질(**비공백/보편/모호**)이 **성립**.
   - (⇐) 목표 성질이 성립이면 반드시 예에 해당하는 **증거**가 존재.
4) **정규형**: CNF/GNF로 정리(멤버십/공백성 등 후속 검사용).
5) **정규와의 교차**는 피할 수 있으면 피하되, 필요하면 “정규 필터”로 **NP-hard/PSPACE**가 아닌 **CFL 레벨**에 고정.

---

## 8. 대비표 — “가능 vs 불가능”

| 분류 | 문제 | 상태 | 메모 |
|---|---|---|---|
| 결정 | 멤버십 \(w\in L(G)\) | **Decidable** | CYK/Earley |
| 결정 | 공백성 \(L(G)=\varnothing\) | **Decidable** | 생성/도달 기호 그래프 |
| 결정 | 유한성 | **Decidable** | 생산적 사이클 검사 |
| 결정 | \(L(G)\cap R=\varnothing\) | **Decidable** | PDA×DFA 제품 |
| 결정 | \(L(G)\subseteq R\) | **Decidable** | 보수·교집합 트릭 |
| 불가능 | 보편성 \(L(G)=\Sigma^*\) | **Undecidable** | 전형적으로 \(\Pi^0_2\)-급 |
| 불가능 | 포함 \(L(G_1)\subseteq L(G_2)\) | **Undecidable** | \(\forall\exists\) 구조 |
| 불가능 | 동치 \(L(G_1)=L(G_2)\) | **Undecidable** | 〃 |
| 불가능 | 교집합 공백성 | **Undecidable** | 보통 **co-RE-완** |
| 불가능 | 모호성 | **Undecidable** | PCP류 감소 |
| 불가능 | 본질적 모호성 | **Undecidable** | 〃 |
| 불가능 | 정규성 여부 | **Undecidable** | 상위 계층 |
| 불가능 | DCFL 여부 | **Undecidable** | 상위 계층 |

---

## 9. 미니 실습 세트(핸즈온)

### 9.1 **CFL ∩ REG 공백성** 체크 (PDA×DFA 스케치)
```text
# 입력: CFG G, DFA A=(Q,Σ,δ,q0,F)
# 절차:
# 1. G를 PDA P로 바꾼다. P=(K,Σ,Γ,Δ,k0,Z0,Fp)
# 2. 제품 오토마타 P'의 상태를 (k,q) 로 두고, 입력을 한 글자씩 읽을 때
#    - PDA 전이를 따라 스택을 조작
#    - 동시에 DFA 상태를 δ(q, a) 로 전이
# 3. 수용조건: (k∈Fp) ∧ (q∈F)
# 4. P'를 CFG로 변환하여 공백성 검사(결정 가능)
```

### 9.2 **공백성** 결정 (생성/도달 그래프)
```text
# 생성 가능한 비단말(mark_gen) 찾기:
mark_gen := ∅
repeat
  for A→α in P:
    if α∈(mark_gen∪Σ)*: add A to mark_gen
until no change

# 시작에서 도달 가능한 비단말(mark_reach):
mark_reach := {S}
repeat
  for A→α in P, A∈mark_reach:
    for B∈α∩V: add B to mark_reach
until no change

# 결과:
if S∉mark_gen or S∉mark_reach: L(G)=∅
```

### 9.3 **모호성 감지용** 작은 반례 만들기
- 비모호 문법(우선순위/결합성 부여):
```text
E  -> E + T | T
T  -> T * F | F
F  -> (E) | id
# 이는 여전히 좌재귀라 실제 파서에선 우재귀/우선순위로 변형 필요
```
- 모호 문법(우선순위 없음):
```text
E  -> E + E | E * E | (E) | id
# 같은 'id+id*id' 에 서로 다른 파스 트리 2개 이상 존재 ⇒ 모호
```

---

## 10. 자주 묻는 질문(FAQ)

**Q1. 왜 정규와 섞이면 쉬워지나요?**
A. 정규류는 **보수/교집합**에 닫혀 있고, **PDA×DFA 제품**이 다시 PDA라서 **CFL 공백성**으로 귀결 → **결정 가능**.

**Q2. “CFL끼리의 포함/동치”가 왜 그리 어려운가요?**
A. 전형적으로 $$\forall w\ \exists \text{유도}$$ 구조를 가져 **\(\Pi^0_2\)** 급 “전역 비교”가 된다.

**Q3. 모호성은 왜 못 잡나?**
A. “서로 다른 두 유도 존재?”는 **존재형**처럼 보이지만, 그 **존재성**이 PCP류의 복잡성을 내장(감소로 귀속)한다.

**Q4. DPDA 동치성은 정말 결정 가능한가요?**
A. 예(심층 이론 결과). 다만 알고리즘은 **극도로 복잡**하고 실용과 거리가 멀다. **일반 PDA 동치성**은 반대로 **결정 불가능**.

---

## 11. 요약

- **가능**: 멤버십, 공백성, 유한성, **정규와의 교집합/포함**.
- **불가능**: 보편성, 포함/동치(둘 다 CFL), 교집합 공백성, 모호성(및 본질적 모호성), 정규성/결정성 여부.
- **증명법**: **PCP/정지 문제**로부터의 **감소**, **구분자/인덱스/지역검사** 가젯 설계.
- **실전 전략**: 전역 성질을 직접 묻기보다, **정규 필터**와 **제품 구성**으로 **결정 가능한 영역**으로 내려오라.

---

## 부록 A. 작은 **연습 문제**

1) 주어진 PCP 인스턴스에 대해 위의 “삼중 가젯 + 투영”으로 두 CFG를 직접 작성하고,
   **교집합 공백성**이 PCP 해와 동치임을 검토하라.
2) CFG $$G$$ 와 DFA $$A$$ 를 임의로 만들어 **CFL ∩ REG 공백성** 절차를 손으로 따라가 보라.
3) 산술식 문법의 모호성과 비모호 버전을 만들어, 같은 입력에 대해 파스 트리를 두 개 그려보라.
4) $$L(G)\subseteq R$$ 검사를 **보수·교집합**으로 환원하는 등식을 증명하라.

---

## 부록 B. 기호·참조 요약

- CNF/GNF: CFG 정규형, CYK/Earley: 멤버십 알고리즘
- PDA×DFA: 제품 구성, REG 보수/교집합 닫힘
- PCP: Post Correspondence Problem(결정 불가능의 허브)
- RE/co-RE: (반)열거 가능, 산술계층 \(\Sigma^0_1/\Pi^0_1/\Pi^0_2\)
