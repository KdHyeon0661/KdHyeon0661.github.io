---
layout: post
title: 정수론 - 원시근과 지표
date: 2025-09-09 22:25:23 +0900
category: 정수론
---
# 원시근과 지표(지수론) — 정의 → 존재 정리 → 합성수의 경우 → 지표이론과 응용

> **구성/원칙**
> - 예제는 **적게** 두되 **아주 자세히** 설명한다.
> - 가능한 곳에 **증명(또는 엄밀한 증명 스케치)** 를 포함한다.
> - 모든 수식은 $$\dots$$ 로 감싼 **MathJax** 표기.
> - 기호: $$\mathbb Z/n\mathbb Z$$ 의 단위군을 $$(\mathbb Z/n\mathbb Z)^\times$$ 로 쓴다. $$\varphi$$ 는 오일러의 φ-함수.

---

## 0. 법 \(n\)에 대한 정수의 계수(순서, order)

### 0.1 정의: 계수(순서)
\(\gcd(a,n)=1\) 인 정수 \(a\) 에 대해,
$$
\operatorname{ord}_n(a)
:=\min\{k\in\mathbb Z_{>0}\mid a^k\equiv 1\pmod n\}
$$
을 **법 \(n\)에서 \(a\)의 계수(순서)** 라 한다.

- 존재성: \(\gcd(a,n)=1\)이면 오일러 정리로 \(a^{\varphi(n)}\equiv 1\pmod n\) 이므로 순서는 존재.
- **기본 성질**
  1) \(a^k\equiv 1\pmod n\iff \operatorname{ord}_n(a)\mid k\).
  2) (라그랑주) \(\operatorname{ord}_n(a)\mid \#(\mathbb Z/n\mathbb Z)^\times=\varphi(n)\).
  3) \(a^r\equiv a^s\pmod n \iff \operatorname{ord}_n(a)\mid (r-s)\) (단, \(\gcd(a,n)=1\)).

**증명 스케치(1)**: 순서의 정의로부터 트리비얼한 최소성 논증.
**(2)**: 군론에서 원소의 위수는 군의 크수를 나눈다.
**(3)**: \(a^s\)로 나누면 \(a^{r-s}\equiv 1\), (1) 적용.

---

## 1. 원시근(primitive root)

### 1.1 정의
\(\gcd(g,n)=1\) 이고
$$
\operatorname{ord}_n(g)=\varphi(n)
$$
이면 \(g\)를 **법 \(n\)의 원시근**이라 한다. 즉, \(g\)가 \( (\mathbb Z/n\mathbb Z)^\times\) 를 **생성**한다:
$$
(\mathbb Z/n\mathbb Z)^\times=\langle g\rangle
=\{g^k\ (\bmod n): 0\le k<\varphi(n)\}.
$$

> 존재하면 \( (\mathbb Z/n\mathbb Z)^\times\) 는 **순환군**이 된다(반대도 참).

### 1.2 원시근이 있을 때의 표준 성질
- 모든 단위 \(a\)는 \(a\equiv g^t\ (\bmod n)\) 꼴로 **유일하게** 표현(여기서 \(t\)는 \(\bmod \varphi(n)\) 까지 유일).
- 모든 해석(예: \(x^k\equiv a\))이 **지수의 선형식**으로 환원된다(§4 참조).
- 원시근의 개수는 **정확히** \(\varphi(\varphi(n))\) 개.
  **이유**: 순환군 \(C_m\) 의 생성원 개수는 \(\varphi(m)\). 여기서 \(m=\varphi(n)\).

---

## 2. 소수 법에서의 원시근: **항상 존재**

### 2.1 정리(소수 법의 존재 정리)
**정리.** 임의의 소수 \(p\) 에 대해 \( (\mathbb Z/p\mathbb Z)^\times\) 는 **순환군**이다. 즉, **원시근이 항상 존재**한다.

**증명 스케치(대표적 증명 흐름)**
핵심 아이디어 2가지 중 하나를 사용한다.

- **(A) 군론적 구조 + 지수 분해**
  \((\mathbb Z/p\mathbb Z)^\times\) 는 크기 \(p-1\) 인 유한 아벨군.
  모든 유한 아벨군은 순환군들의 곱 \(C_{m_1}\times\cdots\times C_{m_r}\) 로 분해되며 크기는 \(m_1\cdots m_r=p-1\).
  각 소인수 \(q\mid p-1\) 에 대해 \(q\)-유형의 원소(위수가 \(q\)의 거듭제곱을 포함하는 원소)가 존재함을 보이고, 이들의 곱의 위수가 소인수 지수의 **최대공배수** \(=\) 전부 \(p-1\) 이 되도록 선택하면 생성원이 얻어진다(지수 분해 선택 논법).

- **(B) \(x^d\equiv 1\) 의 해 개수 범위 비교(가우스 고전 논법)**
  각 \(d\mid p-1\) 에 대해 방정식 \(x^d\equiv 1\) (모듈러 \(p\))의 해의 개수는 최대 \(d\)(다항식의 차수 이상 불가).
  모든 진약수들의 해들을 합치면 \(p-1\) 개를 채울 수 없으므로, 위수 \(p-1\) 인 원소가 **반드시** 존재.

> 두 방식 모두 초등적 또는 기본 군론으로 완결된다.

### 2.2 예제(하나, 자세히) — \(p=7\) 의 원시근
\((\mathbb Z/7\mathbb Z)^\times=\{1,2,3,4,5,6\}\), 크기 \(6\).
각 수의 순서를 계산:
- \(2^1=2,\ 2^2=4,\ 2^3=8\equiv1\Rightarrow \operatorname{ord}_7(2)=3\) (원시근 아님).
- \(3^1=3,\ 3^2=9\equiv2,\ 3^3\equiv 6,\ 3^4\equiv 18\equiv4,\ 3^5\equiv 12\equiv5,\ 3^6\equiv 15\equiv1\)
  \(\Rightarrow \operatorname{ord}_7(3)=6\). **\(3\)는 원시근**.
- 원시근의 개수는 \(\varphi(6)=2\) 이므로 나머지 하나는 \(3^5\equiv 5\) (역원)이다. 실제 \(\operatorname{ord}_7(5)=6\).

---

## 3. 원시근을 갖는 **합성수** \(n\): 완전 분류

### 3.1 정리(고전 정리)
**정리.** \( (\mathbb Z/n\mathbb Z)^\times\) 가 순환군(= \(n\)이 원시근을 갖는다)인 합성수 \(n\)은 정확히
$$
n\in\{\,1,\,2,\,4,\,p^k,\,2p^k\,\}
$$
(여기서 \(p\)는 **홀수 소수**, \(k\ge 1\))이다.

즉, **원시근을 갖는 \(n\)** 은 \(n=1,2,4, p^k, 2p^k\ (p\) 홀수\()\) 뿐이다.

**증명 스케치(표준)**
유한 아벨군 구조 정리를 모듈러 단위군에 적용한다.
- \( (\mathbb Z/p^k\mathbb Z)^\times\) 의 구조는 \(k=1\)이면 순환, \(k\ge 2\)도 \(p\) 홀수면 순환(원시근 존재)임이 알려져 있다(평면적/리프팅 증명: §3.2).
- \(2\)-멱의 경우 \(k=1,2\) (\(n=2,4\))는 순환이지만, \(k\ge 3\)이면 \( (\mathbb Z/2^k\mathbb Z)^\times\) 는 \(C_2\times C_{2^{k-2}}\) 꼴의 **비순환군**(원시근 없음).
- 서로소 곱 \(mn\)에서는 CRT로 \( (\mathbb Z/mn\mathbb Z)^\times \cong (\mathbb Z/m\mathbb Z)^\times\times(\mathbb Z/n\mathbb Z)^\times\).
  두 군의 곱이 순환이려면 상수 조건이 매우 강하며, 가능한 케이스를 전부 좁히면 위 목록만 남는다.

### 3.2 소수멱 \(p^k\) 에서의 원시근(홀수 소수)
**정리(리프팅).** \(p\) 홀수 소수, \(k\ge 1\). \(g\) 가 \(\bmod p\) 의 원시근이면, 적절히 선택/수정하여 \(\bmod p^k\) 의 원시근을 얻는다(존재).
**아이디어**
- \(\operatorname{ord}_{p}(g)=p-1\).
- \(g^{p-1}\equiv 1\ (\bmod p)\) 이지만 \(\bmod p^2\)에선 \(g^{p-1}\not\equiv 1\) 인 \(g\)를 잡을 수 있다(헤헨셀 유사 리프팅).
- 귀납적으로 \(\operatorname{ord}_{p^k}(g)=\varphi(p^k)=p^{k-1}(p-1)\) 를 보장.

> 결론: \(p\) 홀수면 \(p^k\) 마다 원시근 존재.

### 3.3 \(2\)-멱에서의 실패(\(n=8,16,\dots\))
\((\mathbb Z/2^k\mathbb Z)^\times\) 의 구조는 \(k\ge 3\) 에서 \(C_2\times C_{2^{k-2}}\) (순환이 아님).
따라서 \(2^k\ (k\ge 3)\) 에는 **원시근이 없다**.
그러나 \(n=2,4\) 에서는 \((\mathbb Z/2\mathbb Z)^\times=\{1\}\), \((\mathbb Z/4\mathbb Z)^\times=\{1,3\}\cong C_2\), 순환.

### 3.4 예제(하나, 자세히) — \(n=14=2\cdot 7\)
정리는 \(2p^k\) (홀수 \(p\)) 에 **원시근 존재**를 보장. 실제 체크:
- \(\varphi(14)=6\). \((\mathbb Z/14\mathbb Z)^\times=\{1,3,5,9,11,13\}\).
- \(3\)의 순서: \(3^2=9,\ 3^3=27\equiv -1,\ 3^6\equiv 1 \Rightarrow \operatorname{ord}_{14}(3)=6\).
  따라서 **\(g=3\)** 는 \(\bmod 14\)의 원시근.

> 비교: \(n=8\) 은 원시근이 없다. \(\varphi(8)=4\) 이지만 각 단위(1,3,5,7)의 순서를 보면 최대 2.

---

## 4. 지표(지수, index) 이론 — 원시근을 기준으로 한 **불연속 로그**

### 4.1 정의(지표)
법 \(n\)이 **원시근을 갖는 경우**에만 정의한다. \(g\) 를 \(\bmod n\) 의 원시근으로 고정.
\(\gcd(a,n)=1\) 인 \(a\) 에 대해
$$
\operatorname{ind}_g(a):=\text{유일한 }t\in\{0,1,\dots,\varphi(n)-1\}\ \text{로서}\ a\equiv g^t\pmod n.
$$
이를 \(g\) 를 밑으로 한 \(a\)의 **지표(index)** 또는 **이산 로그(discrete log)** 라 한다.

- **존재·유일성**: 원시근 \(g\) 가 단위군을 생성하므로 모든 \(a\) 가 \(g\)의 거듭제곱으로 **유일**(지수는 \(\bmod\,\varphi(n)\)까지).
- 밑을 바꾸면 지표는 선형 변환으로 바뀐다(아래 성질).

### 4.2 성질(선형화 규칙)
모두 \(\bmod \varphi(n)\) 에서의 등식이다.

1) 곱셈-덧셈 법칙
   $$
   \operatorname{ind}_g(ab)=\operatorname{ind}_g(a)+\operatorname{ind}_g(b).
   $$
   **이유**: \(ab\equiv g^{u}g^{v}=g^{u+v}\).

2) 거듭제곱-스칼라 법칙
   $$
   \operatorname{ind}_g(a^k)=k\,\operatorname{ind}_g(a).
   $$

3) 역원-부호
   $$
   \operatorname{ind}_g(a^{-1})=-\operatorname{ind}_g(a).
   $$

4) 밑 변환
   \(h\equiv g^r\) (원시근)라면
   $$
   \operatorname{ind}_h(a)
   = r^{-1}\operatorname{ind}_g(a)\quad (\bmod \varphi(n)),
   $$
   여기서 \(r^{-1}\)은 \(\bmod \varphi(n)\) 에서의 역원(원시근이므로 \(\gcd(r,\varphi(n))=1\)).

> **핵심 메시지**: 곱셈 문제를 **덧셈/선형 문제**로 바꿔 푼다.

### 4.3 지표로 푸는 전형 문제

#### (A) \(x^k\equiv a\pmod n\) 의 해 집합
- 원시근 \(g\) 고정, \(a\equiv g^t\).
- 식은 \(g^{k\cdot \operatorname{ind}_g(x)}\equiv g^t \Rightarrow k\cdot \operatorname{ind}_g(x)\equiv t\ (\bmod \varphi(n))\).
- 해 존재 조건: \(\gcd(k,\varphi(n))\mid t\).
  해가 있으면 \(\gcd(k,\varphi(n))\) 개의 해가 나옴(선형동치류의 기본).

#### (B) \(x^x\equiv a\) 형식(지표를 취해도 \(x\)가 지수에도 있어 일반론은 곤란하지만, \(x\)가 특정 집합으로 제한되면 모듈러 선형화로 접근).

### 4.4 예제(하나, 자세히) — \(x^3\equiv 2\ (\bmod 7)\)
- §2.2에서 본 대로 \(\bmod 7\)의 원시근 \(g=3\).
- \(2\)의 지표: \(3^1=3,\ 3^2=2\Rightarrow \operatorname{ind}_3(2)=2\).
- 식: \(x^3\equiv 2 \iff 3\operatorname{ind}_3(x)\equiv 2\ (\bmod \varphi(7)=6)\).
- \(\gcd(3,6)=3\nmid 2\). **해 없음**이 즉시 결론.

> 실제로도 \(x=1,\dots,6\) 대입하면 3제곱이 2가 되는 해가 없다.

---

## 5. 원시근 탐색과 계산 팁(간결 정리)

### 5.1 소수 \(p\) 에서의 원시근 찾기
- \(p-1=\prod q_i^{e_i}\) 소인수분해.
- 단위 \(a\) 를 골라 모든 \(i\)에 대해 \(a^{(p-1)/q_i}\not\equiv 1\) 이면 \(a\)는 **원시근**.
  **이유**: 만약 어떤 \(q_i\) 에 대해 \(=1\) 이면 순서는 \(p-1\)의 진약수.

> 이 방식은 **확인 비용**이 작다. 실제로는 난수 \(a\) 하나 뽑아 시험하면 빠르게 끝난다.

### 5.2 합성수의 경우
- \(n\) 이 원시근을 갖는 종류인지 먼저 판정(§3.1).
- \(p^k\) 또는 \(2p^k\) 이면 위와 유사하게 \(\varphi(n)\) 의 소인수들을 쓰는 판정이 통한다.
- \(2^k\ (k\ge 3)\) 나 \(pq\ (p,q\) 홀수\() \) 등은 **애초에 존재하지 않음**.

---

## 6. 보충: 원시근과 거듭제곱 잔여

- \(g\) 가 원시근이면 **모든** 단위가 \(g^t\) 꼴.
- \(k\)-제곱 잔여 집합은 \(\{g^{kt}\}\). 그 크기는 \(\varphi(n)/\gcd(\varphi(n),k)\).
- 예: \(k=2\) 인 경우(제곱 잔여) 크기는 \(\varphi(n)/2\) 가 아니라 일반적으로 \(\varphi(n)/\gcd(\varphi(n),2)\).
  소수 \(p\) 가 홀수면 \(\varphi(p)=p-1\) 이 짝수이므로 제곱 잔여의 개수는 \((p-1)/2\)(클래식).

---

## 7. 하나로 엮는 예제(짧지만 밀도 있게)

### 7.1 \(\bmod 9\) 에서의 원시근
- \(\varphi(9)=6\). 후보 \(2\): \(2^1=2, 2^2=4, 2^3=8\equiv -1, 2^6\equiv 1\).
  \(\operatorname{ord}_9(2)=6\) → **원시근**. (정리 §3.2에 부합: \(3^k\) 는 원시근 존재.)

### 7.2 \(\bmod 15\) 의 부재 확인
- \(\varphi(15)=8\). 하지만 §3.1에 따르면 \(15\)는 목록에 없다 → **원시근 없음**.
- 실제로 \((\mathbb Z/15\mathbb Z)^\times\cong C_4\times C_2\) (CRT로 \(C_4\)와 \(C_2\)의 곱), 비순환.

### 7.3 지표로 풀기: \(x^5\equiv 7\ (\bmod 9)\)
- §7.1에서 밑 \(g=2\) 가 원시근.
- \(7\equiv -2\equiv 2^3\Rightarrow \operatorname{ind}_2(7)=3\).
- 식: \(5\,\operatorname{ind}_2(x)\equiv 3\ (\bmod 6)\).
  \(\gcd(5,6)=1\) → \(\operatorname{ind}_2(x)\equiv 3\cdot 5^{-1}\equiv 3\cdot 5\equiv 15\equiv 3\ (\bmod 6)\).
  따라서 \(x\equiv 2^3\equiv 8\equiv -1\ (\bmod 9)\). **해는 \(x\equiv 8\)**.

---

## 8. 요약

1) **계수(순서)**: \(\gcd(a,n)=1\) 에서 \(a\)의 순서 \(\operatorname{ord}_n(a)\)는 항상 \(\varphi(n)\)을 나눈다.
2) **원시근**: \(\operatorname{ord}_n(g)=\varphi(n)\) 이면 단위군을 생성. 존재 시 원시근 수는 \(\varphi(\varphi(n))\).
3) **존재 정리**:
   - 소수 \(p\): **항상 존재**.
   - 합성수 \(n\): **\(n\in\{1,2,4,p^k,2p^k\}\)** (단 \(p\) 홀수)인 경우에만.
   - \(p^k\) (홀수 \(p\))에서 존재, \(2^k (k\ge 3)\) 에서는 **없음**.
4) **지표 이론**: 원시근 \(g\)를 밑으로 \(\operatorname{ind}_g\) 정의.
   - \(\operatorname{ind}_g(ab)=\operatorname{ind}_g(a)+\operatorname{ind}_g(b)\), \(\operatorname{ind}_g(a^k)=k\,\operatorname{ind}_g(a)\).
   - \(x^k\equiv a\) 는 선형 합동 \(k\,\operatorname{ind}_g(x)\equiv \operatorname{ind}_g(a)\) 로 환원.
5) **실전 팁**: \(p-1\) 소인수분해 후 \(a^{(p-1)/q_i}\not\equiv 1\) 판정으로 원시근을 빠르게 찾는다.

> 이 체계를 익히면, **모듈러 지수 방정식**과 **거듭제곱 잔여** 문제가 선형 합동으로 ‘평평해져’서, 해 존재/개수/구체적 해까지 한 번에 다룰 수 있다.
