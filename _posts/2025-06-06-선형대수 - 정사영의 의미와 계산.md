---
layout: post
title: 선형대수 - 정사영의 의미와 계산
date: 2025-06-06 19:20:23 +0900
category: 선형대수
---
# 🎯 정사영의 의미와 계산

선형대수에서 **정사영(projection)**은  
한 벡터를 다른 벡터 또는 공간 위로 **"그림자처럼 투영"**하는 연산입니다.  

이 개념은 **직교성, 최소 제곱 근사, 직선/평면 거리, 정규 방정식** 등과 깊은 관련이 있으며,  
기계학습, 컴퓨터 그래픽스, 통계 등 다양한 분야에서 사용됩니다.

---

## 📐 1. 정사영이란?

### 🔍 직관적 의미

벡터 \( \vec{v} \)를 어떤 기준 벡터 또는 공간에 대해 **수직으로 내린 그림자**  
즉, 그 공간에 가장 가까운 점(최단 거리 점)을 의미합니다.

---

## 🧮 2. 벡터 위의 정사영

### 🎯 정의

벡터 \( \vec{v} \)를 벡터 \( \vec{u} \)에 정사영한 결과는 다음과 같습니다:

\[
\boxed{
\text{proj}_{\vec{u}} \vec{v} = \frac{\vec{v} \cdot \vec{u}}{\vec{u} \cdot \vec{u}} \vec{u}
}
\]

- 분자: \( \vec{v} \)가 \( \vec{u} \) 방향으로 얼마나 향해 있는지 (내적)
- 분모: \( \vec{u} \)의 크기를 조절 (정규화)
- 결과: \( \vec{u} \)와 같은 방향의 벡터

---

### ✔️ 예제

\[
\vec{v} =
\begin{bmatrix}
2 \\
3
\end{bmatrix}, \quad
\vec{u} =
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\Rightarrow
\text{proj}_{\vec{u}} \vec{v} =
\frac{2}{1}
\begin{bmatrix}
1 \\
0
\end{bmatrix} =
\begin{bmatrix}
2 \\
0
\end{bmatrix}
\]

---

## 🧱 3. 서브스페이스(공간)에의 정사영

단일 벡터가 아닌, 벡터 공간(예: 평면)에 벡터를 정사영할 수도 있습니다.

예를 들어, \( \vec{v} \in \mathbb{R}^n \)을 **공간 \( W = \text{Col}(A) \)**에 투영하려면:

### 📘 최소 제곱 해 기반 정사영

\[
\text{proj}_W \vec{v} = A(A^T A)^{-1} A^T \vec{v}
\]

- \( A \): \( W \)의 기저 벡터들을 열로 구성한 행렬
- 이 정사영 벡터는 \( W \) 안에 존재하며, \( \vec{v} \)와의 거리 최소화

---

### 🔍 왜 이렇게 계산할까?

이 식은 **정사영 벡터가 \( \vec{v} \)와의 거리를 최소화한다**는 조건에서 유도됩니다.  
즉,  
\[
\vec{p} = \arg\min_{\vec{w} \in W} \| \vec{v} - \vec{w} \|^2
\Rightarrow
\vec{p} = A(A^T A)^{-1} A^T \vec{v}
\]

이건 사실상 **최소 제곱 해(Least Squares)**입니다!

---

## 🧮 4. 정사영 행렬 (Projection Matrix)

벡터 \( \vec{v} \)를 **항상 같은 공간 \( W = \text{Col}(A) \)**에 정사영할 때,  
이 연산을 수행하는 **행렬 P**를 다음과 같이 정의합니다:

\[
\boxed{
P = A(A^T A)^{-1} A^T
}
\quad \text{(정사영 행렬)}
\]

- P는 대칭(symmetric)이고, 멱등(idempotent):  
  \( P^2 = P \)

\[
\text{proj}_W \vec{v} = P \vec{v}
\]

---

## 🧠 5. 정사영과 직교성

정사영된 벡터 \( \vec{p} \)와 잔차 벡터 \( \vec{v} - \vec{p} \)는 항상 **직교**합니다:

\[
(\vec{v} - \vec{p}) \cdot \vec{p} = 0
\]

이 성질은 **에너지 최소화, 잔차 최소화, 정규방정식** 등을 도출할 때 핵심이 됩니다.

---

## ✏️ 6. Python 예제

```python
import numpy as np

# 공간 W의 기저 (열벡터로 구성)
A = np.array([[1, 0], [1, 1], [0, 1]])  # 3차원 공간에서 2차원 평면
v = np.array([[1], [2], [3]])          # 투영할 벡터

# 정사영 계산
AtA_inv = np.linalg.inv(A.T @ A)
P = A @ AtA_inv @ A.T

projection = P @ v

print("정사영 벡터:\n", projection)
```

---

## ✅ 요약

| 개념 | 정의 | 수식 |
|------|------|------|
| 벡터 위 정사영 | 벡터 \( \vec{u} \) 방향으로의 투영 | \( \frac{\vec{v} \cdot \vec{u}}{\vec{u} \cdot \vec{u}} \vec{u} \) |
| 공간 위 정사영 | 공간 \( \text{Col}(A) \)으로의 투영 | \( A(A^T A)^{-1} A^T \vec{v} \) |
| 정사영 행렬 | 항상 같은 공간으로 투영하는 연산자 | \( P = A(A^T A)^{-1} A^T \) |
| 직교성 | 투영된 벡터와 잔차는 직교 | \( (\vec{v} - \vec{p}) \cdot \vec{p} = 0 \) |