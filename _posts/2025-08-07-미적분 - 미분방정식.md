---
layout: post
title: 미적분 - 미분방정식
date: 2025-08-07 21:20:23 +0900
category: 미적분
---
# 미분방정식 (Differential Equations) — 완전 가이드

> **핵심 한 줄**: 미분방정식은 “미지 함수(미래/상태)와 그 변화율(동역학)의 관계”를 수식으로 묶은 것.  
> 해법은 **형태 인식 → 적절한 기법 선택 → 초기/경계조건으로 상수 결정**의 흐름!

---

## 0. 표기와 기본 개념

- 미지 함수: \(y=y(x)\) 또는 벡터 \(\mathbf{x}(t)\)
- 도함수: \(y'=\dfrac{dy}{dx},\ y''=\dfrac{d^2y}{dx^2}\)
- **계(order)**: 최고차 도함수의 차수 (예: \(y''\) 포함이면 2계)
- **선형/비선형**  
  - 선형: \(a_n(x)y^{(n)}+\cdots+a_1(x)y'+a_0(x)y=b(x)\) (미지 함수와 도함수에 **곱/제곱/삼각함수** 등 없음)  
  - 비선형: 위를 벗어난 모든 경우(예: \(y^2,\ \sin y,\ y y'\) 등)
- **자율(autonomous)**: \(y'=f(y)\) 처럼 독립변수 \(x\)가 명시적으로 나타나지 않음
- **ODE vs PDE**  
  - ODE: 하나의 독립변수 (시간/공간 하나)  
  - PDE: 둘 이상의 독립변수 (예: \(u_t=c^2 u_{xx}\))

---

## 1. 존재성과 유일성(감각 잡기)

**Picard–Lindelöf(로컬)**: \(y'=f(x,y)\)가 \((x_0,y_0)\) 주변에서 연속이고 \(y\)에 대해 **Lipschitz**면,  
초기값문제 \(y(x_0)=y_0\)는 **해가 존재**하고 **유일**함.

> 실무 감각: “보통의 매끈한 \(f\)”면 **근방에서** 해가 잘 정의된다고 생각해도 무방. 특이점/불연속/루트 분기 등은 주의.

---

## 2. 1계 미분방정식 — 툴박스

### 2.1 변수분리형 (Separable)
형태: \(y'=g(x)h(y)\).  
\[
\frac{1}{h(y)}\,dy=g(x)\,dx \quad\Rightarrow\quad \int \frac{1}{h(y)}\,dy=\int g(x)\,dx + C
\]

**예제 A — 지수성장/감쇠**
\[
y'=ky \ \Rightarrow\ \frac{1}{y}dy=k\,dx \Rightarrow \ln|y|=kx+C \Rightarrow y=Ce^{kx}.
\]
초기조건 \(y(0)=y_0 \Rightarrow y=y_0 e^{kx}\).

**예제 B — 로지스틱 성장**
\[
y'=ry\Big(1-\frac{y}{K}\Big),\quad \int \frac{1}{y(1-y/K)}\,dy=\int r\,dx
\]
부분분수 → 
\[
\ln\!\Big|\frac{y}{K-y}\Big| = r x + C \Rightarrow 
y(x)=\frac{K}{1+A e^{-rx}},\ A>0.
\]

---

### 2.2 선형 1계 (Integrating Factor)
형태: \(y'+p(x)y=q(x)\).

적분인자 \(\mu(x)=e^{\int p(x)dx}\)로
\[
\frac{d}{dx}[\mu y]=\mu q \ \Rightarrow\ 
\mu(x)\,y(x)=\int \mu(x)\,q(x)\,dx + C.
\]

**예제 C**
\[
y'-y=e^x \Rightarrow p=-1,\ \mu=e^{-\int 1 dx}=e^{-x}
\]
\[
\frac{d}{dx}(e^{-x}y)=1 \Rightarrow e^{-x}y=x+C \Rightarrow y=e^x(x+C).
\]

---

### 2.3 정확방정식 (Exact) & 적분인자
형태: \(M(x,y)\,dx+N(x,y)\,dy=0\) 가 **정확**이면 \(\exists\ \Phi\) s.t.  
\(\Phi_x=M,\ \Phi_y=N\) ⇒ \(\Phi(x,y)=C\).

정확성 테스트: \(M_y=N_x\).

**예제 D**
\[
(2xy+y^2)dx+(x^2+2xy)dy=0.
\]
\(M_y=2x+2y,\ N_x=2x+2y\) ⇒ 정확.  
\(\Phi_x=2xy+y^2\Rightarrow \Phi=x^2y+xy^2+g(y)\).  
\(\Phi_y=x^2+2xy+g'(y)\stackrel{!}{=}x^2+2xy\Rightarrow g'=0\).  
\(\Rightarrow x^2y+xy^2=C\).

> 정확이 아니면 적분인자 \(\mu(x)\) 또는 \(\mu(y)\)를 찾아서 정확화(패턴 있음).

---

### 2.4 Bernoulli / Homogeneous 변환
- **Bernoulli**: \(y'+p(x)y=q(x)y^n\)  
  \(n\neq 0,1\)에서 \(v=y^{1-n}\) 치환 → 선형화.
- **Homogeneous**: \(y'=F(y/x)\) → \(y=vx,\ y'=v+xv'\)로 변환 → 분리형.

---

### 2.5 방향장/등사선(시각)
- **Direction Field**: \((x,y)\) 그리드에서 \(y'=f(x,y)\) 값으로 미소기울기 표시 → 해 곡선의 흐름 감.
- **Isocline**: \(f(x,y)=\text{상수}\) 곡선 → 같은 기울기 선.

---

## 3. 응용 미니 사례 (1계)

### 3.1 뉴턴 냉각법
\[
T'=-k(T-T_{\text{env}})\ \Rightarrow\ T(t)=T_{\text{env}}+(T_0-T_{\text{env}})e^{-kt}.
\]

### 3.2 혼합 탱크
유입 농도 \(c_{\text{in}}\), 유량 \(q\), 부피 \(V\) 일정:  
염량 \(A(t)\): \(A' = q c_{\text{in}} - \frac{q}{V} A\) (선형 1계).

### 3.3 낙하 + 공기저항(선형)
\[
m v' = mg - kv \Rightarrow v' + \frac{k}{m}v = g \Rightarrow 
v(t)=\frac{mg}{k}+ \Big(v_0-\frac{mg}{k}\Big)e^{-kt/m}.
\]

### 3.4 RC/RL 회로(1차 선형)
- RC 방전: \(C v'+\frac{1}{R}v=0 \Rightarrow v=v_0 e^{-t/RC}\).
- RL 계단응답: \(L i' + R i = V_0 \Rightarrow i=\frac{V_0}{R}\big(1-e^{-Rt/L}\big)\).

### 3.5 감염병 SIR (시스템, 1계)
\[
\begin{cases}
S'=-\beta SI,\quad I'=\beta SI - \gamma I,\quad R'=\gamma I.
\end{cases}
\]
총인구 \(N=S+I+R\) 보존, 임계 \(R_0=\dfrac{\beta N}{\gamma}\).

---

## 4. 2계 선형 ODE (상수계수)

형태: \(a y''+b y'+c y = f(x)\).

### 4.1 동차해(특성방정식)
\[
a r^2+br+c=0 \Rightarrow
\begin{cases}
r_{1,2}\in\mathbb{R}\ \Rightarrow y_h=C_1 e^{r_1 x}+C_2 e^{r_2 x}\\[2mm]
r=\alpha\pm i\beta \ \Rightarrow y_h=e^{\alpha x}\big(C_1\cos\beta x+C_2\sin\beta x\big)\\[2mm]
r\text{ 중근 } \Rightarrow y_h=(C_1+C_2 x)e^{rx}
\end{cases}
\]

### 4.2 비동차 — 특해
- **미정계수법(UC)**: \(f(x)\in\{e^{ax},\ \sin bx,\ \cos bx,\ \text{다항}\}\) 조합에 ansatz. 근과 겹치면 \(x\)승 곱.
- **변수변환법(VoP)**: \(y_p=u_1(x)y_1+u_2(x)y_2\) 일반해.

**예제 E**
\[
y''-3y'+2y = 0 \Rightarrow (r-1)(r-2)=0\Rightarrow y_h=C_1 e^x+C_2 e^{2x}.
\]

**예제 F (강제 진동)**
\[
y''+2\zeta\omega_n y' + \omega_n^2 y = F_0\cos\omega t.
\]
정상상태 진폭
\[
|H(i\omega)|=\frac{F_0}{\sqrt{(\omega_n^2-\omega^2)^2+(2\zeta\omega_n\omega)^2}}.
\]
\(\zeta\ll 1\), \(\omega\simeq\omega_n\)에서 **공진**.

### 4.3 기계–전기 아날로지
- 질량–스프링–댐퍼 ↔ RLC:  
  \(m y'' + c y' + k y = f(t)\) ↔ \(L q'' + R q' + \frac{1}{C}q = v_s(t)\).

---

## 5. 선형 시스템 \( \mathbf{x}'=A\mathbf{x}+\mathbf{b} \)

### 5.1 행렬지수와 해
\[
\mathbf{x}(t)=e^{At}\mathbf{x}_0 + \int_0^t e^{A(t-\tau)}\mathbf{b}\,d\tau.
\]
대각화 가능 시 \(A=PDP^{-1}\Rightarrow e^{At}=P e^{Dt} P^{-1}\) (대각엔 \(e^{\lambda t}\)).

### 5.2 2차원 위상평면 분류 (자율, \(\mathbf{x}'=A\mathbf{x}\))
- \(\det A<0\): **안장**(불안정)  
- \(\det A>0,\ \operatorname{tr}A<0\): **안정 노드/나선**  
- \(\det A>0,\ \operatorname{tr}A>0\): 불안정  
- \(\det A>0,\ \operatorname{tr}A=0,\ \det A=\omega^2\): **중심**(보존)

**예제 G**  
\(A=\begin{bmatrix}0&1\\-2&-3\end{bmatrix}\) → \(\lambda^2+3\lambda+2=0\) → \(\lambda=-1,-2\), 안정 노드.

---

## 6. 라플라스 변환 — IVP/불연속/임펄스에 강함

### 6.1 정의와 성질
\[
\mathcal{L}\{f(t)\}=F(s)=\int_0^\infty e^{-st}f(t)\,dt,\quad
\mathcal{L}\{f'\}=sF(s)-f(0^+),
\]
\[
\mathcal{L}\{f''\}=s^2F-s f(0^+)-f'(0^+).
\]

### 6.2 단위계단/임펄스
- \(u_a(t)\): \(t\ge a\)에서 1 → 시간지연 처리에 유용  
- \(\delta(t-a)\): 임펄스 입력, \(\mathcal{L}\{\delta(t-a)\}=e^{-as}\)

### 6.3 예제 H — IVP
\[
y''+y=\sin t,\ y(0)=0,\ y'(0)=1.
\]
\(\Rightarrow (s^2Y-s\cdot 0 -1)+Y=\frac{1}{s^2+1}\)  
\(\Rightarrow Y=\frac{1}{(s^2+1)^2}+\frac{1}{s^2+1}\).  
역변환 → \(y(t)=\tfrac12(\sin t - t\cos t)+\sin t\).

### 6.4 예제 I — 계단입력
\[
y'+y=u_2(t),\ y(0)=0
\]
\(\Rightarrow sY-0+Y=\frac{e^{-2s}}{s}\) ⇒ \(Y=\dfrac{e^{-2s}}{s(s+1)}\).  
부분분수/지연 성질 → \(y(t)=(1-e^{-(t-2)})u_2(t)\).

---

## 7. 수치해석(필수): Euler, Heun, RK4, 강건성

### 7.1 오일러(Euler)
\[
y_{n+1}=y_n+h\,f(x_n,y_n)
\]
- 간단하지만 **저차(1차), 조건부 안정**.

### 7.2 개선 오일러(Heun/Trapezoid)
\[
\tilde{y}=y_n+h f(x_n,y_n),\quad 
y_{n+1}=y_n+\tfrac{h}{2}\big[f(x_n,y_n)+f(x_{n+1},\tilde{y})\big].
\]

### 7.3 고전 RK4
\[
\begin{aligned}
k_1&=f(x_n,y_n),\\
k_2&=f(x_n+\tfrac{h}{2},\ y_n+\tfrac{h}{2}k_1),\\
k_3&=f(x_n+\tfrac{h}{2},\ y_n+\tfrac{h}{2}k_2),\\
k_4&=f(x_n+h,\ y_n+h k_3),\\
y_{n+1}&=y_n+\tfrac{h}{6}(k_1+2k_2+2k_3+k_4).
\end{aligned}
\]

### 7.4 강건성/강건안정(스티프)
- \(y'=\lambda y\), \(\lambda\ll -1\)일 때 오일러는 \(h<\frac{2}{|\lambda|}\) 등 제약 큼.  
- **Implicit Euler**: \(y_{n+1}=y_n+h f(x_{n+1},y_{n+1})\) → 스티프에 유리(해석/뉴턴 필요).

---

## 8. 파이썬 예제 코드

> 교육용. 실제 실행엔 `numpy`, `matplotlib` 필요.

### 8.1 로지스틱 방정식 — 오일러 vs RK4
```python
import numpy as np
import matplotlib.pyplot as plt

def logistic_rhs(t, y, r=1.0, K=10.0):
    return r*y*(1 - y/K)

def euler(f, t0, y0, h, n):
    t = np.linspace(t0, t0 + n*h, n+1)
    y = np.zeros_like(t); y[0] = y0
    for k in range(n):
        y[k+1] = y[k] + h*f(t[k], y[k])
    return t, y

def rk4(f, t0, y0, h, n):
    t = np.linspace(t0, t0 + n*h, n+1)
    y = np.zeros_like(t); y[0] = y0
    for k in range(n):
        k1 = f(t[k], y[k])
        k2 = f(t[k] + h/2, y[k] + h*k1/2)
        k3 = f(t[k] + h/2, y[k] + h*k2/2)
        k4 = f(t[k] + h,   y[k] + h*k3)
        y[k+1] = y[k] + h*(k1 + 2*k2 + 2*k3 + k4)/6
    return t, y

r, K, y0 = 1.0, 10.0, 0.5
h, n = 0.1, 200
f = lambda t, y: logistic_rhs(t, y, r=r, K=K)

t1, y1 = euler(f, 0.0, y0, h, n)
t2, y2 = rk4(f, 0.0, y0, h, n)

plt.plot(t1, y1, label='Euler')
plt.plot(t2, y2, '--', label='RK4')
plt.axhline(K, color='gray', linestyle=':')
plt.legend(); plt.grid(True); plt.title('Logistic: Euler vs RK4')
plt.show()
```

### 8.2 방향장 + 해곡선(예: \(y'=x-y\))
```python
import numpy as np
import matplotlib.pyplot as plt

def f(x, y): return x - y

xv = np.linspace(-2, 2, 21)
yv = np.linspace(-2, 2, 21)
X, Y = np.meshgrid(xv, yv)
U = 1
V = f(X, Y)
N = np.sqrt(U**2 + V**2)
plt.quiver(X, Y, U/N, V/N, angles='xy')

# 한 해곡선 (RK4)
def rk4_step(x, y, h):
    k1 = f(x, y)
    k2 = f(x + h/2, y + h*k1/2)
    k3 = f(x + h/2, y + h*k2/2)
    k4 = f(x + h, y + h*k3)
    return y + h*(k1 + 2*k2 + 2*k3 + k4)/6

h = 0.05
xs = np.arange(-2, 2+h, h)
ys = np.zeros_like(xs); ys[0] = 1.0
for i in range(len(xs)-1):
    ys[i+1] = rk4_step(xs[i], ys[i], h)

plt.plot(xs, ys, 'r', label='solution')
plt.legend(); plt.grid(True); plt.axis('equal'); plt.title("Direction Field & Solution")
plt.show()
```

---

## 9. 자율 1계 \(y'=f(y)\) — 위상선/안정성

- **평형점**: \(f(y^\*)=0\)
- 선형화: \(y'=f(y)\approx f'(y^\*)(y-y^\*)\)
  - \(f'(y^\*)<0\): **안정(흡인)**
  - \(f'(y^\*)>0\): **불안정(반발)**
- **위상선(phase line)**: 축 위에 화살표로 증가/감소 구간 표시.

**예제 J — 로지스틱**
\[
y'=ry(1-y/K),\quad y^\*=0,\ K.
\]
\(f'(0)=r>0\) 불안정, \(f'(K)=-r<0\) 안정.

---

## 10. PDE 스냅샷(한 컷)

- **열 방정식** \(u_t=\alpha u_{xx}\) (확산)  
- **파동 방정식** \(u_{tt}=c^2 u_{xx}\) (전파)  
- **라플라스** \(u_{xx}+u_{yy}=0\) (정상상태)  

분리해법: \(u(x,t)=X(x)T(t)\) 가정 → ODE들의 결합 + 경계조건으로 고유치/고유함수.

---

## 11. 자주 틀리는 포인트 (체크리스트)

- [ ] **형태 인식**: 분리형? 선형? 정확? 베르누이/동차형?
- [ ] 적분인자 \(\mu=e^{\int p}\) **부호 실수** 주의
- [ ] **정확성 테스트** \(M_y \stackrel{?}{=} N_x\)
- [ ] 2계 **공진**: 구동이 동차근과 겹치면 특해에 \(x\) 곱
- [ ] **초기조건 대입** 후 상수 확정(단, 정의역/특이점 확인)
- [ ] 수치해석은 **스텝 크기**와 **안정성** 모니터링(발산 체크)

---

## 12. 연습문제(풀이 스케치 포함)

1) \(y'=(x^2+1)\,y,\ y(0)=2\)  
   → 분리형, \(\ln y=\tfrac{x^3}{3}+x+C\) → \(y=2e^{x+x^3/3}\).

2) \(y'+\dfrac{2}{x}y=\dfrac{\sin x}{x^2},\ x>0\)  
   → 선형, \(\mu=e^{\int 2/x dx}=x^2\).  
   \(d(x^2 y)/dx=\sin x\) → \(x^2 y=-\cos x+C\) → \(y=\dfrac{-\cos x + C}{x^2}\).

3) 정확성 검사: \((2xy+3)dx+(x^2+4y)dy=0\)  
   \(M_y=2x,\ N_x=2x\) 정확.  
   \(\Phi_x=2xy+3\Rightarrow \Phi=x^2y+3x+g(y)\).  
   \(\Phi_y=x^2+g'(y)\stackrel{!}{=}x^2+4y\Rightarrow g'=4y\Rightarrow g=2y^2\).  
   \(\Rightarrow x^2y+3x+2y^2=C\).

4) \(y''+4y=8\cos 2x\)  
   동차근 \(r=\pm 2i\) → \(y_h=C_1\cos 2x + C_2 \sin 2x\).  
   RHS가 \(\cos 2x\)로 겹침 → 특해 \(y_p=Ax\sin 2x\).  
   대입해서 \(A=2\) → \(y_p=2x\sin 2x\).  
   \(y=y_h+y_p\).

5) 시스템 \(\mathbf{x}'=A\mathbf{x},\ A=\begin{bmatrix}1&-4\\1&-1\end{bmatrix}\)  
   \(\lambda^2-(0)\lambda+3=0\Rightarrow \lambda=\pm i\sqrt{3}\): 중심(보존), 회전 해.

---

## 13. 요약 표

| 분류 | 전형 형태 | 해법 키워드 |
|---|---|---|
| 분리형 | \(y'=g(x)h(y)\) | 변수분리, 양변 적분 |
| 선형 1계 | \(y'+p(x)y=q(x)\) | 적분인자 \(\mu=e^{\int p}\) |
| 정확 | \(Mdx+Ndy=0,\ M_y=N_x\) | 퍼텐셜 \(\Phi\), \(\Phi=C\) |
| 베르누이 | \(y'+py=q y^n\) | \(v=y^{1-n}\) 치환 |
| 동차형 | \(y'=F(y/x)\) | \(y=vx\) 치환 |
| 2계 상수계수 | \(ay''+by'+cy=f\) | 특성방정식, UC/VoP |
| 시스템 | \(\mathbf{x}'=A\mathbf{x}+\mathbf{b}\) | \(e^{At}\), 고유값/기저 |
| 라플라스 | 초기값/계단/임펄스 | 미분 → 대수화, 역변환 |
| 수치 | 임의 RHS | Euler/Heun/RK4, 안정성 |

---

## 14. 실무/학습 팁

- **형태 인식 훈련**: “보자마자 기법 2~3개”가 떠오르도록 스택을 쌓자.  
- **해 검증**: 원식에 **미분 후 대입**(차분 오차, 경계조건 모두).  
- **단위/차원**: 물리 모델은 항상 차원 일관성 체크.  
- **수치해석 병행**: 폐형해가 어려우면 **수치 + 직관**으로 먼저 모양을 파악.  
- **PDE로 확장**: ODE 감각은 PDE의 분리해법/고유치로 자연 연장.

---

### 마무리

미분방정식은 “현실을 움직이게 하는 방정식”.  
**형태를 알아보고, 맞는 도구로 풀고, 초기/경계조건으로 닫아주는 루틴**을 체화하면  
물리·공학·경제·생물 어디서든 모델링과 해석이 **도구처럼** 손에 잡힙니다.