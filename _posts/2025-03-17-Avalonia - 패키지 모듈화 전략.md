---
layout: post
title: Avalonia - íŒ¨í‚¤ì§€ ëª¨ë“ˆí™” ì „ëµ
date: 2025-03-17 21:20:23 +0900
category: Avalonia
---
# ğŸ“¦ Avalonia ì•±ì˜ íŒ¨í‚¤ì§€ ëª¨ë“ˆí™” ì „ëµ (Avalonia.Modules, NuGet)

---

## ğŸ¯ ëª©í‘œ

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| âœ… ê¸°ëŠ¥ë³„ í”„ë¡œì íŠ¸ ë¶„ë¦¬ | View, ViewModel, Model, Service ë“±ì„ ë…ë¦½ |
| âœ… ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸í™” | ë‹¤ë¥¸ ì•±ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ NuGet íŒ¨í‚¤ì§€í™” |
| âœ… ìœ ì§€ë³´ìˆ˜ í¸ë¦¬ì„± í–¥ìƒ | ê° ëª¨ë“ˆì€ ë…ë¦½ì  CI/CD ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

---

## 1ï¸âƒ£ ëª¨ë“ˆí™” ì„¤ê³„ ì˜ˆì‹œ

### ì˜ˆì‹œ: `MyApp.Modules.Dashboard`

```plaintext
MyApp/
 â”œâ”€ MainApp/                  # ì‹¤í–‰ í”„ë¡œì íŠ¸
 â”œâ”€ Modules/
 â”‚   â””â”€ Dashboard/
 â”‚       â”œâ”€ Views/
 â”‚       â”œâ”€ ViewModels/
 â”‚       â”œâ”€ Models/
 â”‚       â”œâ”€ Services/
 â”‚       â”œâ”€ DashboardModule.csproj
```

ì´ë ‡ê²Œ `ê¸°ëŠ¥ ë‹¨ìœ„`ë¡œ ë³„ë„ í”„ë¡œì íŠ¸(`.csproj`)ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.

---

## 2ï¸âƒ£ Avalonia ì „ìš© ëª¨ë“ˆí™” íŒ

ëª¨ë“ˆì— ë‹¤ìŒ ìš”ì†Œë“¤ì„ í¬í•¨í•˜ì„¸ìš”:

- `View.axaml`, `ViewModel.cs`
- `Model.cs` ë˜ëŠ” `DTO`
- `Service`, `Command`, `Converter`
- (ì„ íƒ) DI ë“±ë¡ìš© `ModuleStartup` í´ë˜ìŠ¤

---

## 3ï¸âƒ£ `.csproj` ì„¤ì • (ëª¨ë“ˆ í”„ë¡œì íŠ¸)

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <AvaloniaUseCompiledXaml>true</AvaloniaUseCompiledXaml>
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>
    <PackageId>MyApp.Modules.Dashboard</PackageId>
    <Version>1.0.0</Version>
    <Authors>DoHyun</Authors>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Avalonia" Version="11.0.0" />
    <PackageReference Include="Avalonia.ReactiveUI" Version="11.0.0" />
  </ItemGroup>

</Project>
```

> í•µì‹¬: `GeneratePackageOnBuild=true` ì„¤ì •

---

## 4ï¸âƒ£ ë¹Œë“œí•´ì„œ NuGet ìƒì„±

```bash
dotnet pack Modules/Dashboard/DashboardModule.csproj -c Release
```

â†’ `bin/Release/` ì•„ë˜ `.nupkg` íŒŒì¼ ìƒì„±

---

## 5ï¸âƒ£ ë¡œì»¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê¸°

`MainApp.csproj`ì— ë‹¤ìŒê³¼ ê°™ì´ ì°¸ì¡°:

```xml
<ItemGroup>
  <PackageReference Include="MyApp.Modules.Dashboard" Version="1.0.0" />
</ItemGroup>
```

> ë¡œì»¬ íŒ¨í‚¤ì§€ë¼ë©´ `NuGet.Config` ì— `local` ê²½ë¡œ ë“±ë¡ í•„ìš”:

### ğŸ“„ `NuGet.Config` ì˜ˆì‹œ

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="LocalPackages" value="C:\MyPackages" />
  </packageSources>
</configuration>
```

---

## 6ï¸âƒ£ DI ë° View ë“±ë¡ (Appì—ì„œ í†µí•©)

### ëª¨ë“ˆ ì´ˆê¸°í™” ì¸í„°í˜ì´ìŠ¤ ì •ì˜

```csharp
public interface IModule
{
    void RegisterServices(IServiceCollection services);
}
```

### ëª¨ë“ˆ ë‚´ Startup êµ¬í˜„

```csharp
public class DashboardModule : IModule
{
    public void RegisterServices(IServiceCollection services)
    {
        services.AddTransient<DashboardView>();
        services.AddTransient<DashboardViewModel>();
    }
}
```

### App.xaml.cs ë˜ëŠ” MainAppì—ì„œ ë¡œë“œ

```csharp
List<IModule> modules = new()
{
    new DashboardModule(),
    new AnotherFeatureModule()
};

foreach (var module in modules)
{
    module.RegisterServices(services);
}
```

---

## 7ï¸âƒ£ ViewLocator + ViewModelLocator êµ¬ì¡° í™•ì¥

- `ViewLocator`ë¥¼ í†µí•´ ëª¨ë“ˆì—ì„œ View ìë™ íƒìƒ‰
- `ViewModelLocator`ë„ DI ê¸°ë°˜ìœ¼ë¡œ ì£¼ì… ê°€ëŠ¥

```csharp
// ViewLocator.cs
public IControl Build(object data)
{
    var vmType = data.GetType();
    var viewType = FindViewByConvention(vmType);
    return (Control)Activator.CreateInstance(viewType);
}
```

---

## 8ï¸âƒ£ NuGet ë°°í¬ í™•ì¥ (GitHub + CI/CD)

### GitHub Packagesì— ë“±ë¡

```bash
dotnet nuget push *.nupkg --source "github"
```

- `NuGet.config` ì— GitHub í† í° í•„ìš”
- `GitHub Actions`ë¡œ ìë™ ë°°í¬ ê°€ëŠ¥

---

## 9ï¸âƒ£ ëª¨ë“ˆí™”ì˜ ì¥ì  ì •ë¦¬

| ì¥ì  | ì„¤ëª… |
|------|------|
| âœ… ì¬ì‚¬ìš©ì„± | ì—¬ëŸ¬ ì•±ì— ë™ì¼ ê¸°ëŠ¥ ê³µìœ  ê°€ëŠ¥ |
| âœ… í…ŒìŠ¤íŠ¸ ìš©ì´ì„± | ëª¨ë“ˆ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë…ë¦½ ìˆ˜í–‰ |
| âœ… í˜‘ì—… íš¨ìœ¨ì„± | íŒ€ë³„ ê¸°ëŠ¥ ë¶„ë‹´ ìš©ì´ |
| âœ… ë¹Œë“œ íš¨ìœ¨ì„± | ë³€ê²½ëœ ëª¨ë“ˆë§Œ ë‹¤ì‹œ ë¹Œë“œ ê°€ëŠ¥ |
| âœ… CI/CD ë¶„ë¦¬ | ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ íŒ¨í‚¤ì§€ ë¦´ë¦¬ìŠ¤ ê°€ëŠ¥

---

## ğŸ”§ Tip: ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶„ë¦¬ë„ í•¨ê»˜ ê³ ë ¤

```plaintext
Common/
 â”œâ”€ Controls/
 â”œâ”€ Extensions/
 â”œâ”€ Behaviors/
 â””â”€ CommonUtils.csproj
```

- `CommonControls`, `ValueConverters`, `ThemeHelper` ë“± ë³„ë„ ëª¨ë“ˆí™” ì¶”ì²œ

---

## âœ… ê²°ë¡ 

| ìš”ì†Œ | í•µì‹¬ ìš”ì•½ |
|------|-----------|
| ğŸ§± êµ¬ì¡° | ê¸°ëŠ¥ë³„ `.csproj`ë¡œ ë¶„ë¦¬, NuGet íŒ¨í‚¤ì§€í™” ê°€ëŠ¥ |
| ğŸ› ï¸ ì„¤ì¹˜ | `dotnet pack` + `dotnet add package` |
| ğŸ”§ DI í†µí•© | `IModule` + `RegisterServices()` íŒ¨í„´ |
| ğŸ“¦ ë°°í¬ | ë¡œì»¬ NuGet or GitHub/NuGet ê³µì‹ ë°°í¬ ê°€ëŠ¥ |

â†’ **ëŒ€ê·œëª¨ Avalonia ì•± ë˜ëŠ” ê³µí†µ ê¸°ëŠ¥ì„ íŒ€ ë‚´ ê³µìœ í•  ë•Œ ë°˜ë“œì‹œ ê³ ë ¤í•´ì•¼ í•  ì „ëµ**