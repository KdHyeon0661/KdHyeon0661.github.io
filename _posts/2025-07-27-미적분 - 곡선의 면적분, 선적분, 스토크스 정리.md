---
layout: post
title: 미적분 - 곡선의 면적분, 선적분, 스토크스 정리
date: 2025-07-27 20:20:23 +0900
category: 미적분
---
# 곡선의 면적분, 선적분, 스토크스 정리

> 한눈에 요약
> - **스칼라 선적분**: $$\displaystyle \int_C f\,ds=\int_a^b f(\mathbf r(t))\ \|\mathbf r'(t)\|\,dt$$
> - **벡터장 선적분(일)**: $$\displaystyle \int_C \mathbf F\cdot d\mathbf r=\int_a^b \mathbf F(\mathbf r(t))\cdot \mathbf r'(t)\,dt$$
> - **스칼라 면적분**: $$\displaystyle \iint_S f\,dS=\iint_D f(\mathbf r(u,v))\ \|\mathbf r_u\times \mathbf r_v\|\,du\,dv$$
> - **유량(벡터장 면적분)**: $$\displaystyle \iint_S \mathbf F\cdot d\mathbf S=\iint_S \mathbf F\cdot \mathbf n\,dS=\iint_D \mathbf F(\mathbf r)\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv$$
> - **스토크스 정리**: $$\displaystyle \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_S(\nabla\times \mathbf F)\cdot \mathbf n\,dS$$
>   (경계의 방향은 **오른손 법칙**으로 표면의 법선과 일치해야 함)

---

## 준비: 매개화·방향·규칙

- **곡선 매개화**: \(C:\ \mathbf r(t)=(x(t),y(t),z(t)),\ t\in[a,b]\)
  방향(시계/반시계)은 \(t\)가 증가하는 방향으로 결정.
- **곡면 매개화**: \(S:\ \mathbf r(u,v),\ (u,v)\in D\subset\mathbb R^2\)
  법선방향은 \(\mathbf r_u\times\mathbf r_v\)의 방향으로 정해짐(순서가 바뀌면 부호 반전).
- **오른손 규칙**: 엄지(법선), 손가락(경계 진행 방향).
  둘이 불일치하면 스토크스 부호가 틀어진다.

---

## 선적분 (Line Integral)

### 스칼라장에 대한 선적분

스칼라 함수 \(f(x,y,z)\), 곡선 \(C\):
$$
\int_C f\,ds=\int_a^b f(\mathbf r(t))\ \|\mathbf r'(t)\|\,dt,\quad ds=\|\mathbf r'(t)\|\,dt.
$$
**의미**: 곡선을 따라 “길이 가중치”로 \(f\)를 누적(열량·질량 누적 등).

### 벡터장에 대한 선적분(일·Work)

\(\mathbf F=(P,Q,R)\), \(d\mathbf r=(dx,dy,dz)\):
$$
\int_C \mathbf F\cdot d\mathbf r=\int_C P\,dx+Q\,dy+R\,dz=\int_a^b \mathbf F(\mathbf r(t))\cdot \mathbf r'(t)\,dt.
$$
**의미**: 힘 \(\mathbf F\)가 경로 \(C\)를 따라 한 **일**.

### 보존장·경로독립성(Gradient Theorem)

\(\mathbf F=\nabla \phi\) (보존장)이면
$$
\int_C \mathbf F\cdot d\mathbf r=\phi(\text{끝점})-\phi(\text{시작점})
$$
경로와 무관. 닫힌경로에선 0.

---

## 면적분 (Surface Integral)

### 스칼라 면적분

\(S:\ \mathbf r(u,v)\), \(D\subset\mathbb R^2\):
$$
\iint_S f\,dS=\iint_D f(\mathbf r(u,v))\ \|\mathbf r_u\times\mathbf r_v\|\,du\,dv.
$$

### 벡터장 면적분(유량)

$$
\iint_S \mathbf F\cdot d\mathbf S=\iint_S \mathbf F\cdot \mathbf n\,dS
=\iint_D \mathbf F(\mathbf r(u,v))\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv.
$$
**의미**: 표면을 “뚫고 나가는” \(\mathbf F\)의 총량(유체 유량·전기/자기 플럭스).

---

## 스토크스 정리 (Stokes’ Theorem)

### 정리

스무스한 곡면 \(S\), 경계 \(\partial S\), 연속 미분 가능한 \(\mathbf F\)에서
$$
\boxed{\ \ \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_S (\nabla\times \mathbf F)\cdot \mathbf n\,dS\ \ }.
$$

### 직관

- \(\nabla\times \mathbf F\)는 **미소 회전(소용돌이)** 강도.
- 표면 전체의 회전 “누적” = 경계선에서 실제로 “도는” 양(일).

### 그린 정리와의 관계(특수한 경우)

평면 \(z=0\), \(\mathbf F=(P,Q,0)\)이면
$$
\oint_{\partial R} (P\,dx+Q\,dy)=\iint_R \left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA,
$$
즉 **그린 정리**는 스토크스의 특수한 2D 버전.

---

## 완전 정복 예제

### 예제 A — 원둘레에서의 선적분(‘도는’ 장의 대표)

\[
\mathbf F=(-y,\ x,\ 0),\quad C:\ x^2+y^2=1\ \text{(상공에서 보아 반시계)}
\]
매개화 \( \mathbf r(t)=(\cos t,\ \sin t,\ 0),\ t\in[0,2\pi] \).
\[
\mathbf F(\mathbf r(t))=(-\sin t,\ \cos t,\ 0),\quad \mathbf r'(t)=(-\sin t,\ \cos t,\ 0)
\]
\[
\Rightarrow\ \mathbf F\cdot \mathbf r'(t)=(-\sin t)(-\sin t)+(\cos t)(\cos t)=\sin^2 t+\cos^2 t=1
\]
\[
\therefore \oint_C \mathbf F\cdot d\mathbf r=\int_0^{2\pi}1\,dt=2\pi.
\]
**교훈**: \(\mathbf F=(-y,x,0)\)는 원 주위를 **반시계로 도는** 장 → 양의 일 \(2\pi\).

> 참고: \(\mathbf F=(y,-x,0)\)로 바꾸면 값이 \(-2\pi\)가 된다(방향 반대).

---

### 예제 B — 스토크스로 같은 값을 면적분으로

위 \(\mathbf F=(-y,x,0)\)의 컬:
\[
\nabla\times \mathbf F=\left(0,0,\frac{\partial}{\partial x}(x)-\frac{\partial}{\partial y}(-y)\right)=(0,0,2).
\]
경계 \(C\)를 감싸는 **단위 원판** \(S:\ x^2+y^2\le1\), 위쪽 법선 \(\mathbf n=(0,0,1)\):
\[
\iint_S (\nabla\times \mathbf F)\cdot \mathbf n\,dS=\iint_S 2\,dS=2\cdot(\text{원판 면적})=2\pi.
\]
\(\boxed{2\pi=2\pi}\) — 스토크스 정리 확인!

---

### 예제 C — 같은 경계, 다른 곡면(포물면 캡), 그래도 값은 같다

곡면 \(S: z=1-x^2-y^2\) (원 \(x^2+y^2=1\)와 만나는 캡), 위쪽(바깥쪽) 법선.
컬은 여전히 \((0,0,2)\).
그래프형 표면 \(z=g(x,y)\)에서는 \(d\mathbf S=(-g_x,-g_y,1)\,dA\) 이므로
\[
(\nabla\times \mathbf F)\cdot d\mathbf S=(0,0,2)\cdot(-g_x,-g_y,1)\,dA=2\,dA.
\]
투영 영역은 단위 원판이므로
\[
\iint_S (\nabla\times \mathbf F)\cdot \mathbf n\,dS=\iint_{x^2+y^2\le 1} 2\,dA=2\pi.
\]
**표면 선택의 독립성**(경계·방향만 같으면 결과 동일).

---

### 예제 D — 스칼라 선적분과 스칼라 면적분

1) 스칼라 선적분: \(f(x,y)=x^2\), \(C: \mathbf r(t)=(t,t^2),\ t\in[0,1]\)
\[
\int_C f\,ds=\int_0^1 f(\mathbf r(t))\ \|\mathbf r'(t)\|\,dt=\int_0^1 t^2 \sqrt{1+(2t)^2}\,dt.
\]
(치환 \(u=1+4t^2\) 등으로 계산)

2) 스칼라 면적분: \(f(x,y,z)=z\), \(S: z=x^2+y^2,\ x^2+y^2\le1\) (상향)
\[
\iint_S z\,dS=\iint_{x^2+y^2\le 1} (x^2+y^2)\ \sqrt{1+4x^2+4y^2}\ dA.
\]
(극좌표로 변환하면 수월)

---

### 예제 E — 경로독립성 확인(보존장)

\(\phi(x,y)=x^2y\Rightarrow \mathbf F=\nabla\phi=(2xy, x^2)\).
두 경로 \(C_1:\ (0,0)\to(1,1)\) 직선, \(C_2:\ y=x^2\) 같은 끝점:
\[
\int_{C_1}\mathbf F\cdot d\mathbf r=\phi(1,1)-\phi(0,0)=1,\quad
\int_{C_2}\mathbf F\cdot d\mathbf r=\phi(1,1)-\phi(0,0)=1.
\]
**경로 독립**.

---

## 실전 절차(레시피)

### 선적분 \(\int_C \mathbf F\cdot d\mathbf r\)

1) 경로 매개화 \(\mathbf r(t)\).
2) \(\mathbf r'(t)\) 계산.
3) \(\mathbf F(\mathbf r(t))\) 대입.
4) 내적 후 적분: \(\int_a^b \mathbf F(\mathbf r(t))\cdot \mathbf r'(t)\,dt\).
※ 방향 바뀌면 부호 바뀜.

### 면적분 \(\iint_S \mathbf F\cdot d\mathbf S\)

1) 표면 매개화 \(\mathbf r(u,v)\).
2) \(\mathbf r_u\times \mathbf r_v\) (법선·면요소) 계산.
3) \(\mathbf F(\mathbf r(u,v))\) 대입.
4) \(\iint_D \mathbf F\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv\).

### 스토크스

- 컬 \(\nabla\times\mathbf F\) 계산 → 표면에 투영 가능한 쉬운 형태로 선택.
- **오른손 방향 일치** 확인(매우 중요).

---

## 파이썬 코드 예제 (심볼릭/수치 검증)

> 실행 환경이 있으면 그대로 복붙해 확인해보세요.

### SymPy로 스토크스 정리 상징 검증

```python
import sympy as sp
x, y, z, t = sp.symbols('x y z t', real=True)
# F = (-y, x, 0)

P, Q, R = -y, x, 0
F = sp.Matrix([P, Q, R])

# curl F

curlF = sp.Matrix([sp.diff(R,y)-sp.diff(Q,z),
                   sp.diff(P,z)-sp.diff(R,x),
                   sp.diff(Q,x)-sp.diff(P,y)])
print("curl F =", curlF)   # (0, 0, 2)

# = (cos t, sin t, 0)

r = sp.Matrix([sp.cos(t), sp.sin(t), 0])
rp = sp.diff(r, t)
F_on_C = F.subs({x:r[0], y:r[1], z:r[2]})
line_integrand = sp.simplify(F_on_C.dot(rp))
print("Line integrand =", sp.simplify(line_integrand))  # 1
line_val = sp.integrate(line_integrand, (t, 0, 2*sp.pi))
print("∮ F·dr =", sp.simplify(line_val))  # 2π

# Surface integral over the unit disk z=0 (n=(0,0,1))

u, v = sp.symbols('u v', real=True)
# in polar: u=r, v=theta

r_pol = sp.Matrix([u*sp.cos(v), u*sp.sin(v), 0])
ru = sp.diff(r_pol, u)
rv = sp.diff(r_pol, v)
nvec = ru.cross(rv)    # oriented upward
curl_on_S = curlF.subs({x:r_pol[0], y:r_pol[1], z:r_pol[2]})
surf_integrand = sp.simplify(curl_on_S.dot(nvec))
# Jacobian in polar: |nvec| = u

surf_val = sp.integrate(sp.integrate(surf_integrand, (v, 0, 2*sp.pi)), (u, 0, 1))
print("∬ (curl F)·n dS =", sp.simplify(surf_val))  # 2π
```

### NumPy로 수치 적분(원둘레 선적분 vs 포물면 캡 면적분)

```python
import numpy as np

# Vector field F = (-y, x, 0)

def F(x, y, z):
    return np.array([-y, x, 0.0])

# Line integral on unit circle (CCW)

ts = np.linspace(0, 2*np.pi, 20001)
xC, yC = np.cos(ts), np.sin(ts)
dx, dy = -np.sin(ts), np.cos(ts)
integrand = (-yC)*dx + (xC)*dy  # F·dr
line_num = np.trapz(integrand, ts)
print("Line integral ≈", line_num)  # ~ 2π

# Surface integral over paraboloid cap z=1 - x^2 - y^2 (same boundary)
# Using Stokes: (curl F)·n dS = 2 * dA for upward normal
# so it's simply 2 * area of unit disk = 2π

print("Surface integral (by Stokes) =", 2*np.pi)
```

---

## 자주 하는 실수 & 디버깅 체크리스트

1) **방향 불일치**: 경계의 진행 방향이 표면 법선의 오른손 규칙과 달라지면 부호가 바뀜.
2) **매개화 순서**: \(\mathbf r_u\times \mathbf r_v\) vs \(\mathbf r_v\times \mathbf r_u\).
3) **컬 0인데 닫힌경로 값이 0이 아님?** — 영역이 **단일연결**이 아닐 수 있음(구멍, 특이점).
4) **법선 정규화**: 면적분에선 \(\mathbf n\,dS\)를 통째로 쓰면 정규화 필요 없음.
5) **수치 미분 노이즈**: 곡면/곡선이 데이터(샘플)라면 스무딩 후 미분.

---

## 연습문제 (풀이 또는 결과 포함)

### \), \(C\): 단위원(반시계)

- 컬: \(\nabla\times\mathbf F=(0,0,\partial_x(2xy)-\partial_y(y^2))=(0,0,2y-2y)=(0,0,0)\).
  **보존장처럼 보이므로** \(\oint_C \mathbf F\cdot d\mathbf r=0\).

### \), \(S\): 원뿔 \(z=\sqrt{x^2+y^2}\), \(1\le z\le 2\), 바깥쪽 법선

- 컬: \(\nabla\times\mathbf F=(0,0,0)\Rightarrow \oint_{\partial S}\mathbf F\cdot d\mathbf r=0\).
- 경계는 두 원 \(z=1,2\)로 두 개의 원이 반대 방향으로 감겨 합이 0.

### Q3. 스칼라 선적분: \( f(x,y)=x+y,\ C:\ \mathbf r(t)=(t,\ t^2),\ t\in[0,1] \)

\[
\int_0^1 (t+t^2)\sqrt{1+(2t)^2}\,dt.
\]
(계산: 치환 \(u=1+4t^2\) 등으로 가능)

### \), \(S:\ z=1-x^2-y^2,\ x^2+y^2\le 1 \), 상향

\(d\mathbf S=(-z_x,-z_y,1)\,dA=(2x,2y,1)\,dA\)
\[
\iint_S \mathbf F\cdot d\mathbf S=\iint_{x^2+y^2\le1}\big(x(2x)+y(2y)+1\big)\,dA
=\iint_{r\le1}(2r^2+1)\,dA
=2\cdot\frac{\pi}{2}+ \pi=2\pi.
\]

---

## 응용 스냅샷

- **유체역학**: 유량 \(\iint_S \mathbf v\cdot \mathbf n\,dS\)
- **전자기학**: 맥스웰 방정식의 회전/발산 정리(패러데이 유도 법칙은 스토크스 형태)
- **컴퓨터 그래픽스**: 곡면의 조명 계산 시 면적분(예: 환경광 샘플링 근사)
- **로보틱스**: 경로에 따른 일/에너지 계산(선적분)

---

## 치트시트 표

| 구분 | 공식 | 메모 |
|---|---|---|
| 스칼라 선적분 | $$\displaystyle \int_C f\,ds=\int f(\mathbf r)\|\mathbf r'\|\,dt$$ | 길이 가중 |
| 벡터 선적분 | $$\displaystyle \int_C \mathbf F\cdot d\mathbf r=\int \mathbf F(\mathbf r)\cdot \mathbf r'\,dt$$ | 일(Work) |
| 스칼라 면적분 | $$\displaystyle \iint_S f\,dS=\iint f(\mathbf r)\|\mathbf r_u\times\mathbf r_v\|\,du\,dv$$ | 면소 가중 |
| 유량 | $$\displaystyle \iint_S \mathbf F\cdot d\mathbf S=\iint \mathbf F\cdot(\mathbf r_u\times\mathbf r_v)\,du\,dv$$ | 법선 방향 중요 |
| 스토크스 | $$\displaystyle \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_S(\nabla\times\mathbf F)\cdot \mathbf n\,dS$$ | 오른손 규칙 |
| 그린 정리 | $$\displaystyle \oint_{\partial R}(P\,dx+Q\,dy)=\iint_R \left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)dA$$ | 2D 특수형 |
