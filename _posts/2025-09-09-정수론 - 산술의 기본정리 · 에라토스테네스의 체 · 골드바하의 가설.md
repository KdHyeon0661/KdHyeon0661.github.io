---
layout: post
title: 정수론 - 산술의 기본정리 · 에라토스테네스의 체 · 골드바하의 가설
date: 2025-09-09 16:25:23 +0900
category: 정수론
---
# 산술의 기본정리 · 에라토스테네스의 체 · 골드바하의 가설
> **요청 반영**: 예제는 **적게** 두되 **매우 자세히**, 이후 서술은 **가능한 한 증명 포함**. 수식은 모두 $$…$$.

---

## 0. 준비: 표기 · 기본 정리들(증명 동반)

### 0.1 표기
- 정수 집합 $$\mathbb{Z}$$, 양의 정수 $$\mathbb{Z}_{>0}$$, 소수 집합을 $$\mathcal{P}$$ 로 쓴다.  
- $$a\mid b$$ 는 “정수 $$k$$ 가 있어 $$b=ak$$”을 뜻한다.  
- 바닥 함수는 $$\lfloor x\rfloor$$, 대략적 크기는 $$f(n)\asymp g(n)$$ 로 쓴다.

### 0.2 나눗셈정리(Division Algorithm)
**정리.** 임의의 정수 $$a$$ 와 양의 정수 $$b>0$$ 에 대해, 유일한 정수 $$q,r$$ 가 존재하여
$$
a=bq+r,\qquad 0\le r<b.
$$
**증명(존재).** $$q:=\left\lfloor \frac{a}{b}\right\rfloor$$ 로 두면 $$0\le a-bq<b$$ 이므로 $$r:=a-bq$$ 가 조건을 만족한다.  
**증명(유일).** $$a=bq+r=bq'+r'$$ 이고 $$0\le r,r'<b$$ 라 하자. 그러면 $$b(q-q')=r'-r$$. 좌변은 $$b$$ 의 배수, 우변은 절댓값이 $$<b$$ 인 정수이므로 유일하게 $$r=r'$$, 따라 $$q=q'$$.

### 0.3 베주 항등식(Bézout)
**정리.** 임의의 정수 $$a,b$$ 에 대해 정수 $$x,y$$ 가 존재하여
$$
\gcd(a,b)=ax+by.
$$
**증명.** 집합 $$S=\{ax+by>0: x,y\in\mathbb{Z}\}$$ 는 공집합이 아니며(예: $$|a|+|b| \in S$$), 자연수의 정렬성으로 최소 원소 $$d$$ 가 있다. 나눗셈정리를 $$a=dq+r\ (0\le r<d)$$ 로 적용하면 $$r=a-dq=a-bq_1 - a q_2$$ 같은 꼴이라 $$r\in S\cup\{0\}$$. 최소성에 의해 $$r=0$$ 이므로 $$d\mid a$$. 같은 방식으로 $$d\mid b$$. 따라서 $$d$$ 는 공약수. 한편 $$d\in S$$ 는 $$a,b$$ 의 정수선형결합이므로 모든 공약수는 $$d$$ 를 나눈다. 즉 $$d=\gcd(a,b)$$.

### 0.4 유클리드 보조정리(Euclid’s Lemma)
**정리.** $$\gcd(a,b)=1$$ 이고 $$a\mid bc$$ 이면 $$a\mid c$$. 특히 $$p$$ 가 소수이고 $$p\mid ab$$ 이면 $$p\mid a$$ 또는 $$p\mid b$$.  
**증명.** 베주 항등식으로 $$ax+by=1$$ 인 정수 $$x,y$$ 존재. 양변에 $$c$$ 를 곱해 $$acx+bcy=c$$. 좌변은 $$a$$ 의 배수이므로 $$a\mid c$$. 소수 버전은 $$p\nmid a$$ 이면 $$\gcd(p,a)=1$$ 을 쓰면 된다.

---

## 1. 산술의 기본정리(FTA: Fundamental Theorem of Arithmetic)

### 1.1 정리(존재·유일성)
**정리(FTA).** $$1$$ 보다 큰 모든 정수 $$n$$ 은 소수들의 거듭제곱 곱
$$
n=\prod_{i=1}^k p_i^{\alpha_i}\qquad (p_i\in\mathcal{P},\ \alpha_i\in\mathbb{Z}_{\ge1})
$$
으로 표현되며, 이 표현은 **인수의 순서를 제외하고 유일**하다.

> **주석.** $$1$$ 을 소수로 취급하면 $$2=2=2\cdot1=2\cdot 1\cdot 1=\cdots$$ 로 유일성이 붕괴하므로 $$1$$ 은 소수가 아니다.

### 1.2 존재의 증명(최소반례 + 분해의 종결성)
**증명(존재).** 반대로, 소수들의 곱으로 표현되지 않는 $$>1$$ 인 정수들의 집합 $$T$$ 가 공집합이 아니라고 가정하고 그중 최소를 $$n$$ 이라 하자. $$n$$ 이 소수라면 스스로 소수의 곱(=자기 자신)이고, 합성수라면 $$n=ab,\ 1<a,b<n$$ 으로 쓸 수 있다. 최소성으로 $$a,b\notin T$$ 이니 둘 다 소수들의 곱. 곱하면 $$n$$ 도 소수들의 곱이 되어 모순. 따라서 $$T=\emptyset$$.

### 1.3 유일성의 증명(유클리드 보조정리)
**증명(유일).** 서로 다른 분해
$$
n=p_1p_2\cdots p_r=q_1q_2\cdots q_s\qquad (p_i,q_j\in\mathcal{P})
$$
가 있다고 하자. 그러면 $$p_1\mid n$$ 이고, 따라서 $$p_1\mid q_1\cdots q_s$$. 유클리드 보조정리로 어떤 $$j$$ 에 대해 $$p_1=q_j$$. 양변에서 그 소수를 약분하여 같은 형태의 등식을 얻고, 이 과정을 반복하면 길이가 0이 되어야 한다. 즉 두 분해는 인수의 순서를 제외하면 동일하다.

### 1.4 (결과) 곱셈적 함수의 구조: $$\tau,\ \sigma,\ \varphi$$
- **약수 개수 함수** $$\tau(n)$$: $$n=\prod p_i^{\alpha_i}$$ 이면
  $$
  \tau(n)=\prod_{i=1}^k (\alpha_i+1).
  $$
  **증명.** 각 소수 지수 $$\alpha_i$$ 에 대해 지수 선택이 $$0,\dots,\alpha_i$$ 로 독립. 곱의 원리로 위 식.
- **약수 합 함수** $$\sigma(n)$$: 동일 가정에서
  $$
  \sigma(n)=\prod_{i=1}^k \frac{p_i^{\alpha_i+1}-1}{p_i-1}.
  $$
  **증명.** $$1+p_i+\cdots+p_i^{\alpha_i}=\frac{p_i^{\alpha_i+1}-1}{p_i-1}$$ 의 곱으로 분해(FTA의 곱셈성).
- **오일러의 피 함수** $$\varphi(n)$$: $$n=\prod p_i^{\alpha_i}$$ 이면
  $$
  \varphi(n)=n\prod_{p\mid n}\left(1-\frac{1}{p}\right).
  $$
  **증명 스케치.** 포함배제: $$n$$ 이하 정수 중 $$p\mid n$$ 의 배수를 제거.

> 이 세 함수의 **곱셈성**(서로소 곱에 대해 값이 곱으로 분해됨)은 FTA에 의존한다.

### 1.5 (한 개의 예제) $$n=3600$$
$$
3600=2^4\cdot 3^2\cdot 5^2.
$$
$$
\tau(3600)=(4+1)(2+1)(2+1)=45,\quad
\sigma(3600)=\frac{2^5-1}{1}\cdot\frac{3^3-1}{2}\cdot\frac{5^3-1}{4}=31\cdot13\cdot31=12493.
$$
계산 절차는 위 정리들의 직접 적용이며, **FTA가 유일성**을 보장하므로 결과가 정해진다.

---

## 2. 에라토스테네스의 체(Sieve of Eratosthenes)

### 2.1 알고리즘(표준형)
- 목표: $$n$$ 이하의 모든 소수 나열.  
- 배열 $$A[2..n]$$ 을 “가능성 있음”으로 초기화.  
- $$p=2,3,4,\dots,\lfloor \sqrt{n}\rfloor$$ 순회:
  - $$A[p]$$ 가 아직 참(지워지지 않음)이라면, **$$p^2, p^2+p, p^2+2p,\dots\le n$$** 을 모두 지움.
- 마지막에 참으로 남은 인덱스가 소수.

> 실전 최적화(개념): 짝수 생략(홀수 전용), 휠(wheel), 세그먼트(segmented) 등은 §2.4에서 정리.

### 2.2 올바름의 증명(왜 $$p^2$$ 부터인가)
**보조정리.** 합성수 $$m>1$$ 에는 $$\le \sqrt{m}$$ 인 소인수가 존재.  
**증명.** $$m=ab$$ 가 최소 분해라 하자. 만약 $$a,b>\sqrt{m}$$ 이면 $$ab>m$$ 이 되어 모순. 따라서 최소 하나는 $$\le \sqrt{m}$$.

**정리(올바름).** 위 알고리즘은 정확히 소수만 남긴다.  
**증명.**
1) **지워지는 수는 모두 합성수.** 어떤 단계의 소수 $$p$$ 에 대해 지우는 수는 $$p\cdot (p+k)$$ 꼴로, 분명 $$p$$ 를 인수로 가지는 합성수다.  
2) **모든 합성수는 지워진다.** 합성수 $$m$$ 을 잡자. 보조정리에 의해 $$m=pu$$ 이고 $$p\le \sqrt{m}\le \sqrt{n}$$ 인 소수가 존재한다. 알고리즘이 $$p$$ 를 만나는 시점에 $$p^2, p^2+p,\dots$$ 를 지우는데, 이 수열 안에 $$m=p\cdot u$$ 가 포함된다(왜냐하면 $$u\ge p$$ 이면 $$m\ge p^2$$ 이고, $$u=p+k$$ 로 쓰여 해당 항). 만약 $$u<p$$ 라면 $$m=up$$ 에서 earlier 단계의 소수 $$u$$ 가 이미 지워버린다.  
3) 따라서 남는 수는 합성수가 아니며, $$\ge 2$$ 의 자연수 중 합성수가 아니면 소수이므로 정확하다.

### 2.3 연산량(시간 복잡도 스케치)
마킹 횟수는 대략
$$
\sum_{\substack{p\ \text{소수}\\ p\le \sqrt{n}}}\left(\left\lfloor\frac{n-p^2}{p}\right\rfloor+1\right)
\ \sim\ \sum_{p\le n}\frac{n}{p}
\ =\ n\sum_{p\le n}\frac{1}{p}.
$$
고전적 사실(메르텐스 유형 추정치)로
$$
\sum_{p\le n}\frac{1}{p}=\log\log n + M + o(1)
$$
가 알려져 있으므로 전체 시간은
$$
O\!\big(n\log\log n\big).
$$
정밀 상수/캐시 효과는 구현에 좌우되지만, 이 상한은 체류적(near tight)이다.

> **주의(증명 수준에 대하여)**: $$\sum_{p\le n}1/p=\log\log n+O(1)$$ 은 소수정리 수준의 도구 없이도 상하근사를 줄 수 있으며, 정밀한 상수는 메르텐스 정리로 얻는다. 여기서는 복잡도 직관을 위한 표준 사실로 사용한다.

### 2.4 세그먼트 체(segmented sieve)의 올바름 개요
큰 구간 $$[1,n]$$ 을 메모리에 맞는 작은 창 $$[L,R]$$ 로 나누어 처리한다:
1) 먼저 $$\le \sqrt{n}$$ 의 소수들을 **기저 소수**로 표 생성(표준 체로).  
2) 각 창 $$[L,R]$$ 에 대해, 모든 기저 소수 $$p$$ 에 대해 $$p$$ 의 배수들을 $$[L,R]$$ 안에서만 지움(시작점은 $$L$$ 이상 최초의 $$p$$ 배수).  
3) 각 창에서 남은 수는 그 창 안의 소수.

**정당화.** $$m\in[L,R]$$ 가 합성수면 최소 소인수 $$p\le \sqrt{m}\le \sqrt{n}$$ 가 존재하여 2)에서 지워진다. 반대로 소수는 어떤 기저 소수의 배수도 아니므로 남는다. 즉, “전역적으로 $$\le\sqrt{n}$$ 까지만 알고 있으면, 국소 창에서의 체질(소수 걸러내기)은 완전하다”.

### 2.5 (한 개의 예제) $$n=50$$ 에서의 전 과정
- $$p=2\ (\le 7)$$: $$[4,6,8,\dots,50]$$ 제거  
- $$p=3$$: $$[9,12,15,\dots,48]$$ 제거  
- $$p=5$$: $$[25,30,35,40,45,50]$$ 제거  
- $$p=7$$: $$[49]$$ 제거  
남은 수: $$2,3,5,7,11,13,17,19,23,29,31,37,41,43,47$$.  
여기서 각 합성수 $$m$$ 는 적어도 하나의 소수 $$p\le \sqrt{m}$$ 에 의해 지워졌음을 실제로 확인할 수 있다(예: $$35=5\cdot7$$ 은 $$p=5$$ 단계에서 제거).

---

## 3. 골드바하의 가설(Goldbach)

### 3.1 진술
- **강 골드바하(짝수형)**: 모든 짝수 $$N\ge 4$$ 는 두 소수의 합 $$N=p+q$$ 로 표현된다.  
- **약(삼수) 골드바하(홀수형)**: 모든 홀수 $$n\ge 5$$ 는 세 소수의 합 $$n=p+q+r$$ 로 표현된다.

> 역사·현황: 약가설은 **증명됨**(Harald Helfgott, 2013; 대수적/해석적 보강을 거쳐 정리 완료). 강가설은 **미해결**이지만 천문학적 범위까지 계산 검증. 이 문서에서는 **증명이 끝난 명제들**은 구조를 간략히, **미해결 가설**은 관련 정리들의 증명 아이디어를 소개한다.

### 3.2 “세 소수의 합”의 해석적 골격(서클 방법 개요, 증명 아이디어)
세 소수의 합 표현 개수를
$$
R_3(n)=\sum_{\substack{p_1+p_2+p_3=n}} 1
$$
로 쓰자(소수의 중복 허용). 본질적으로는 **소수 지시 함수** $$\mathbf{1}_{\mathcal{P}}(m)$$ (혹은 대체로 **폰 망골트 함수** $$\Lambda(m)$$)의 **3중 합성곱**을 다룬다:
$$
R_3(n)\ \approx\ \sum_{a+b+c=n}\Lambda(a)\Lambda(b)\Lambda(c).
$$
이 합을 지수합
$$
S(\alpha):=\sum_{m\le n}\Lambda(m)e(\alpha m),\qquad e(x):=e^{2\pi i x}
$$
으로 옮기면
$$
\sum_{a+b+c=n}\Lambda(a)\Lambda(b)\Lambda(c)
=\int_{0}^{1}S(\alpha)^3 e(-\alpha n)\,d\alpha.
$$
**하디–리틀우드의 서클 방법**은 구간 $$[0,1]$$ 을
- **주호(major arcs)**: 유리수 $$a/q$$(작은 분모)의 근방,
- **소호(minor arcs)**: 그 밖의 영역
으로 나누어 적분을 평가한다.

- 주호에서는 디리클레 급수/해석적 기법으로
  $$
  S(\alpha)\approx \frac{\mu(q)}{\varphi(q)}\cdot \frac{n}{\log n}
  $$
  같은 “주항”을 구축(정확식은 더 복잡함).  
- 소호에서는 지수합에 대한 **비자명한 상계**(예: 빈니코프–코라보프형, 지수합 추정, Vaughan/Goldston–Pintz–Yıldırım류 보강)를 쌓아 전체 기여를 **주항보다 작게** 억제한다.

**핵심 아이디어(증명에서 실제로 하는 일)**:  
1) $$S(\alpha)$$ 를 Vaughan 항등식 등으로 분해(타입 I/II 합).  
2) 주호의 주요항 추출(리만 제타함수 및 디리클레 $$L$$-함수의 해석적 성질 활용).  
3) 소호에서 각 타입 합을 줄이는 해석적 추정(지수합/대합).  
4) **전체 적분이 양(positive)** 임을 보이는 임계 불평등을 확보 ⇒ $$R_3(n)>0$$.

Harald Helfgott의 작업은 위 골격을 **효과적 상수**까지 명시해 **모든 충분히 큰 홀수**는 물론, **남은 유한한 범위를 전산 검증**으로 마감하여 **약가설을 전범위로 확정**한다.

### 3.3 첸의 정리(강가설의 강력한 근사)
**정리(Chen, 1973).** 충분히 큰 모든 짝수 $$N$$ 은
$$
N=p+P_2
$$
로 표현된다. 여기서 $$p$$ 는 소수, $$P_2$$ 는 **적어도 두 소수의 곱**(반소수; square-free일 필요는 없음).  
**증명 아이디어(체 방법).** 셀버그 체/이중 체를 사용하여 소수 조건을 “배제 조건”으로 전환하고, 유형 I/II 추정으로 오차를 제어한다. “두 소수의 곱” 허용은 체에서 제거 손실을 흡수하는 절묘한 절충이다(완전한 “소수+소수”로 가려면 훨씬 더 강한 추정이 필요).

> **요지**: 강가설은 미해결이지만, 첸의 정리로 “거의” 두 소수의 합이라는 구조가 확립되어 있다.

### 3.4 (한 개의 예제) $$N=100$$ 의 분해를 논리적으로 확인
- 체로 만든 소수표(§2)를 바탕으로 작은 쪽 소수 $$p\le 50$$ 를 훑어 $$100-p$$ 가 소수인지 확인한다.
- 실제로 $$100=47+53=41+59=37+63(\times)$$ … 등 중 첫 성공쌍은 $$47+53$$.  
- 이 과정은 **강가설의 “검증” 절차**의 미시 모델과 같다: 모든 짝수에 대해 한쪽을 작은 소수로 순회해 상대가 소수인지 빠르게 판정(현대 검증에서는 세그먼트 체 + Miller–Rabin 가속).

---

## 4. 세 주제의 구조적 연결(증명 관점)
1) **FTA(증명 완료)**: 정수의 **곱셈적 원자화**(소수)와 그 **유일성**. 유클리드 보조정리의 결정적 역할.  
2) **체(증명 완료)**: 원자를 **대량 생산**하는 알고리즘. 올바름(모든 합성수 제거, 소수 보존)과 복잡도는 정밀하게 따질 수 있다.  
3) **골드바하(강가설 미해결, 약가설 증명 완료)**: “원자들의 합 구조” 문제. 약가설은 서클 방법 + 효과적 추정으로 완결. 강가설에는 여전히 소호 추정의 **한계 타개**가 관건.

---

## 5. (보충 증명) 체의 복잡도에 대한 구체적 상계
마킹 총량을 더 구체적으로 억제해 보자. 소수 $$p$$ 단계의 작업량은 대략
$$
\left\lfloor\frac{n-p^2}{p}\right\rfloor+1\ \le\ \frac{n}{p}-p+1\ \le\ \frac{n}{p}.
$$
따라서 전체는
$$
\sum_{p\le \sqrt{n}}\left(\left\lfloor\frac{n-p^2}{p}\right\rfloor+1\right)
\le n\sum_{p\le \sqrt{n}}\frac{1}{p}
\le n\sum_{p\le n}\frac{1}{p}.
$$
그리고 임의의 $$n\ge 3$$ 에 대해
$$
\sum_{p\le n}\frac{1}{p}\le \log\log n + B_1
$$
인 상수 $$B_1$$ 가 존재한다(증명은 소수정리까진 필요 없고, 푸리에–체비쇼프류 기법으로 충분한 상계를 준다). 결과적으로
$$
T(n)\ \le\ n(\log\log n + B_1)=O(n\log\log n).
$$

---

## 6. 마무리 요약(증명 관점)
- 나눗셈정리와 베주 항등식 → **유클리드 보조정리** → **FTA(존재·유일성)**: 모두 **엄밀한 최소반례/귀납**과 **정수선형결합** 논리로 증명 완료.  
- **에라토스테네스의 체**: “$$p^2$$ 시작”과 “최소 소인수 $$\le\sqrt{m}$$” 보조정리로 **올바름** 증명, **마킹 합**의 조화급수형 집약으로 **시간 상계** 도출.  
- **골드바하**:  
  - 약가설: **서클 방법**의 주/소호 분할 + 효과적 추정으로 **증명**.  
  - 첸의 정리: 체 방법으로 “소수 + 반소수”를 **증명**.  
  - 강가설: 미해결이지만, 위 도구들이 핵심이며 **소호 추정 강화**가 관건.