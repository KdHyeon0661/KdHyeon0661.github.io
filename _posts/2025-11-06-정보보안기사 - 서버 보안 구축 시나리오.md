---
layout: post
title: 정보보안기사 - 서버 보안 구축 시나리오
date: 2025-11-06 15:25:23 +0900
category: 정보보안기사
---
# 서버 보안 구축 시나리오(웹/DB/AD/로그 서버 하드닝 실전)

## 0) 큰 그림(한 페이지 요약)

```
[Internet]
    |
    v
 [WAF/Edge] --(TLS offload optional)--> [WEB REVERSE PROXY: Nginx]
    |                                        |(127.0.0.1:8080 or AppNet)
    |                                        v
    |                                     [APP]
    |                                          \
    |                                           v
    |                                        [DB]
    |
    +--> [VPN/Bastion] --> [Mgmt Subnet] --> (RDP/SSH/JEA/JIT)
                                           \
                                            +--> [AD DS/DC + DNS + (LAPS/PKI 주의)]
                                                 \
                                                  +--> [WEF Collector / SIEM / rsyslog]
```

- **네트워크 분리**: `Edge/WAF` · `Web/App` · `DB` · `Mgmt(AD/Collector)` · `Jump/Bastion` **서브넷 분리 + SG/ACL**.  
- **기본 원칙**: 최소권한, 기본거부(Default Deny), **암호화(전송/저장)**, **감사·가시성(로그/지표)**, **불변성(이미지/형상관리)**.  
- **운영 모토**: “**작동하며 안전**하게” → 변경은 **파일럿 → 링 배포** → **롤백 문서화**.

---

# 1) 공통 OS 하드닝(Windows/Linux)

## 1.1 패치·시간·사용자·서비스

### Linux (Debian/RHEL 계열)
```bash
# 패치
sudo apt update && sudo apt -y upgrade || { sudo dnf -y upgrade; }
# 시간 동기
sudo timedatectl set-ntp true
# 불필요 데몬 정리(예)
sudo systemctl disable --now avahi-daemon || true
sudo systemctl disable --now cups || true
```

### Windows Server (PowerShell)
```powershell
# 업데이트 모듈
Install-Module PSWindowsUpdate -Force
Get-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -AutoReboot

# 시간 동기(도메인 환경은 PDC Emulator 기준)
w32tm /query /status
```

## 1.2 SSH/RDP 최소화

### SSH (서버용 공통)
```bash
sudo cp /etc/ssh/sshd_config{,.bak}
sudo bash -c 'cat > /etc/ssh/sshd_config' <<'CONF'
Protocol 2
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
KexAlgorithms curve25519-sha256@libssh.org
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
AllowUsers admin@10.10.0.0/16 devops@10.10.0.0/16
ClientAliveInterval 300
ClientAliveCountMax 2
CONF
sudo systemctl reload sshd
```

### Windows RDP(방화벽/네트워크로 제한)
- RDP는 **배스천** 또는 **VPN**에서만.  
- LAPS/PAW(Privileged Access Workstation)로 관리자 접속 분리.

## 1.3 파일시스템/커널 네트워크 하드닝

```bash
# /tmp 실행 차단
echo "tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev,mode=1777 0 0" | sudo tee -a /etc/fstab
sudo mount -o remount /tmp

# sysctl 네트워크 방어(예)
sudo bash -c 'cat > /etc/sysctl.d/99-hardening.conf' <<'SYS'
net.ipv4.conf.all.rp_filter=1
net.ipv4.conf.default.rp_filter=1
net.ipv4.conf.all.accept_redirects=0
net.ipv4.conf.default.accept_redirects=0
net.ipv4.tcp_syncookies=1
net.ipv4.icmp_echo_ignore_broadcasts=1
kernel.kptr_restrict=1
fs.protected_hardlinks=1
fs.protected_symlinks=1
SYS
sudo sysctl --system
```

---

# 2) 웹 서버 하드닝 (Nginx Reverse Proxy 중심)

## 2.1 목표
- **TLS 강제**, **보안 헤더**, **업스트림 분리(내부 주소)**, **systemd 샌드박스**, **SELinux/AppArmor**.

## 2.2 Nginx TLS/헤더 구성(예)

```nginx
# /etc/nginx/conf.d/site.conf
server {
  listen 443 ssl http2;
  server_name app.example.com;

  # TLS
  ssl_certificate     /etc/letsencrypt/live/app.example.com/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/app.example.com/privkey.pem;
  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers HIGH:!aNULL:!MD5;
  ssl_prefer_server_ciphers on;
  ssl_session_cache shared:SSL:20m;
  ssl_stapling on; ssl_stapling_verify on;

  # 보안 헤더
  add_header X-Frame-Options "DENY";
  add_header X-Content-Type-Options "nosniff";
  add_header Referrer-Policy "strict-origin-when-cross-origin";
  add_header Permissions-Policy "geolocation=(), camera=(), microphone=()";

  # (필요 시) Content-Security-Policy는 앱에 맞춰 정밀 설정
  # add_header Content-Security-Policy "default-src 'self'; object-src 'none'; frame-ancestors 'none'";

  # 업스트림(App) — 내부 접근만
  location / {
    proxy_pass http://127.0.0.1:8080;    # 또는 App 전용 서브넷 IP
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header X-Forwarded-Proto https;
    client_max_body_size 10m;
  }

  access_log /var/log/nginx/access_json.log json;
  error_log  /var/log/nginx/error.log warn;
}

# 로그 포맷(JSON)
log_format json escape=json
  '{ "time":"$time_iso8601", "remote":"$remote_addr", "host":"$host", '
  '"request":"$request", "status":$status, "bytes":$body_bytes_sent, '
  '"ref":"$http_referer", "ua":"$http_user_agent", "upstream":"$upstream_addr", '
  '"req_time":$request_time, "up_time":$upstream_response_time }';
```

**검증**
```bash
sudo nginx -t && sudo systemctl reload nginx
curl -I https://app.example.com
```

## 2.3 ModSecurity(OWASP CRS) (선택)
- Nginx 빌드/패키지로 `modsecurity + owasp crs` 도입 → **감사 모드**로 먼저 운영 → 오탐 튜닝 후 차단.

## 2.4 systemd 샌드박스 + SELinux/AppArmor

```ini
# /etc/systemd/system/nginx.service.d/hardening.conf
[Service]
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadOnlyPaths=/usr /etc
ReadWritePaths=/var/lib/nginx /var/log/nginx /var/cache/nginx
MemoryDenyWriteExecute=true
RestrictSUIDSGID=true
RestrictAddressFamilies=AF_INET AF_INET6
SystemCallFilter=@system-service
```

```bash
sudo systemctl daemon-reload
sudo systemctl restart nginx
systemd-analyze security nginx.service
```

### SELinux (RHEL 계열)
```bash
# 웹 데이터 라벨
sudo semanage fcontext -a -t httpd_sys_content_t "/srv/www(/.*)?"
sudo restorecon -Rv /srv/www
# 아웃바운드 필요 시
sudo setsebool -P httpd_can_network_connect on
```

---

# 3) DB 서버 하드닝 (PostgreSQL & MySQL)

## 3.1 공통 목표
- **네트워크 분리**(App 서브넷만 접속), **TLS 전송 암호화**, **최소권한 계정/스키마**, **감사 로깅**, **백업/복구**.

## 3.2 PostgreSQL

### (A) 네트워크/TLS
`postgresql.conf`
```conf
listen_addresses = '10.20.0.5'    # DB 서브넷 NIC만
ssl = on
ssl_cert_file = '/etc/pki/tls/certs/pg.crt'
ssl_key_file  = '/etc/pki/tls/private/pg.key'
ssl_ciphers = 'HIGH:!aNULL:!MD5'
log_connections = on
log_disconnections = on
log_line_prefix = '%m [%p] %u@%d %r '
log_statement = 'ddl'
```

`pg_hba.conf`
```conf
# App 서브넷만, TLS만
hostssl    appdb    appuser    10.10.30.0/24   md5
# 관리자는 Bastion에서만
hostssl    postgres postgres   10.10.99.10/32  cert clientcert=1
```

### (B) 최소권한 스키마/계정
```sql
-- 접속용 최소 권한 계정
CREATE ROLE appuser LOGIN ENCRYPTED PASSWORD '********';
REVOKE ALL ON DATABASE appdb FROM PUBLIC;
GRANT CONNECT ON DATABASE appdb TO appuser;

\c appdb
REVOKE ALL ON SCHEMA public FROM PUBLIC;
GRANT USAGE ON SCHEMA public TO appuser;

-- 필요한 테이블에만 DML 허용(예)
GRANT SELECT, INSERT, UPDATE, DELETE ON TABLE public.orders TO appuser;
```

### (C) pgaudit 설치/로깅(요약)
- `shared_preload_libraries = 'pgaudit'`  
- `pgaudit.log = 'read,write,ddl,role,grant'` → SIEM 연동.

### (D) 백업/복구(단계별)
```bash
# 논리 백업(스케줄)
pg_dump -Fc -d appdb | openssl enc -aes-256-cbc -salt -out /backup/appdb_$(date +%F).dump.enc

# PITR(물리)용 WAL 보관
archive_mode=on
archive_command='test ! -f /wal/%f && cp %p /wal/%f'
```

## 3.3 MySQL/MariaDB

`mysqld.cnf`
```cnf
bind-address = 10.20.0.6
require_secure_transport = ON
ssl_ca   = /etc/ssl/mysql/ca.pem
ssl_cert = /etc/ssl/mysql/server-cert.pem
ssl_key  = /etc/ssl/mysql/server-key.pem
tls_version = TLSv1.2,TLSv1.3

# 보안 옵션
local_infile = 0
secure_file_priv = /var/lib/mysql-files
symbolic-links = 0

# 비밀번호 정책(플러그인에 따라 상이)
validate_password.policy = MEDIUM
```

최소권한 사용자
```sql
CREATE USER 'app'@'10.10.30.%' IDENTIFIED BY '********' REQUIRE SSL;
GRANT SELECT, INSERT, UPDATE, DELETE ON appdb.* TO 'app'@'10.10.30.%';
FLUSH PRIVILEGES;
```

감사(엔터프라이즈/감사 플러그인)
```sql
-- (플러그인/에디션에 따라 설정 방법 상이)
-- 설치 후 CONNECT/DML/DDL 이벤트 로깅하여 SIEM로 전달
```

백업
```bash
mysqldump --single-transaction appdb | gzip > /backup/appdb_$(date +%F).sql.gz
# 대용량은 Percona XtraBackup/MariaBackup 고려
```

---

# 4) Active Directory(AD DS) 하드닝

> **핵심**: 관리 계층화(Tier 0/1/2), **도메인 컨트롤러 보호**, **LDAP/SMB/Kerberos 강화**, **LAPS/gMSA**, **감사/WEF/Sysmon**.

## 4.1 관리 모델(요약)
- **Tier 0**: DC/PKI/Azure AD Connect 등 → **PAW**에서만 접속.  
- **Tier 1**: 서버 관리자. **Tier 2**: 워크스테이션.  
- 도메인/엔터프라이즈 관리자 **상시 비활성/빈 세션** 지향(JIT/JEA).

## 4.2 GPO(도메인 컨트롤러/도메인) 핵심 설정

### LDAP/SMB/Kerberos 강화
```powershell
# LDAP 서명/채널 바인딩
New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Services\NTDS\Parameters" -Force | Out-Null
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\NTDS\Parameters" -Name "LDAPServerIntegrity" -Value 2 -PropertyType DWord -Force | Out-Null
# 1=Negotiate signing, 2=Require signing

# SMB 서명/암호화 정책은 GPO로 강제
# 컴퓨터 구성 → Windows 설정 → 보안 설정 → 네트워크 보안: LAN Manager 인증 수준 = NTLMv2만
```

### NTLM 제한(권장)
- **NTLM v1 금지**, NTLM 사용 최소화(가능 시 Kerberos-only).

### 감사·WEF·Sysmon
```powershell
# 고급 감사 정책(예)
auditpol /set /subcategory:"Logon" /success:enable /failure:enable
auditpol /set /subcategory:"Process Creation" /success:enable /failure:enable
# 명령줄 로깅
New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Name "ProcessCreationIncludeCmdLine_Enabled" -Type DWord -Value 1
```

### LAPS / gMSA
```powershell
# gMSA 예
Install-WindowsFeature RSAT-AD-PowerShell
New-ADServiceAccount -Name gmsaWeb -DNSHostName web01.corp.local -PrincipalAllowedToRetrieveManagedPassword "WEB-SERVERS"
# 웹 서비스에 계정 연결(앱 풀/서비스)
```

### DC 보호 기타
- DC에 **인터넷 직접 연결 금지**, **Defender/EDR** 필수.  
- **백업/시스템 상태 백업** 주기화, 복구 테스트.

---

# 5) 로그 서버 하드닝 (WEF + rsyslog/Elastic 계열)

## 5.1 Windows Event Forwarding(WEF)

**Collector**
```cmd
wecutil qc          :: Event Collector 서비스 준비
winrm quickconfig   :: WinRM (운영은 HTTPS로)
```

**Subscription**  
- 보안 로그(4624/4625/4672/4688/1102), PowerShell Operational(4103/4104).  
- 대상: OU/그룹 단위로 필터링.

**검증 스니펫**
```powershell
Get-WinEvent -LogName "ForwardedEvents" -MaxEvents 5 | Format-List
```

## 5.2 Linux rsyslog + TLS 중앙집중

Collector (`/etc/rsyslog.d/10-input-tls.conf`)
```conf
module(load="imtcp")
module(load="imptcp")
module(load="imudp")
module(load="imrelp")

# RELP(신뢰성) 또는 TCP/TLS
input(type="imtcp" port="6514" StreamDriver.Name="gtls" StreamDriver.Mode="1" StreamDriver.Authmode="x509/name" PermittedPeer="*.example.com")
```

Client (`/etc/rsyslog.d/99-remote.conf`)
```conf
*.* @@(o)logs.example.com:6514;RSYSLOG_SyslogProtocol23Format
# (o)=TLS, @@=TCP
```

**권한/보존**
- `/var/log` **권한 750/640** 유지, logrotate 적용, 장기보관은 **오브젝트 스토리지**.

## 5.3 Elastic/Opensearch/Graylog (개요)
- **인덱스 수명주기(ILM)**, **역할/권한**(읽기 전용 대시보드), **Alert**(스냅샷 공개·관리자 로그인 폭증 등).

---

# 6) 네트워크 세그멘테이션 & 방화벽

## 6.1 SG/ACL 모델(클라우드 식 사고)
- **Web**: 443(Internet) → **App**: 8080(내부) → **DB**: 5432/3306(내부, App 서브넷만).  
- **AD/Collector**: Mgmt 서브넷만 접속 허용(WEF, WinRM, LDAP/Kerberos).

## 6.2 Linux 방화벽 (nftables 예)
```bash
sudo bash -c 'cat > /etc/nftables.conf' <<'NFT'
table inet filter {
  chain input {
    type filter hook input priority 0;
    ct state established,related accept
    iif lo accept
    tcp dport { 22, 443 } accept     # Nginx/SSH 예
    ip saddr != 10.10.0.0/16 drop    # 내부만 허용(역할별 조정)
    counter drop
  }
}
NFT
sudo systemctl enable --now nftables
```

## 6.3 Windows Defender Firewall (서버 역할별 인바운드 최소)
- 웹: 443, 80(리다이렉트만)  
- DB: 5432/3306(앱 서브넷 소스만)  
- DC: 도메인 서비스 포트만, 나머지 **거부**.

---

# 7) 백업/복구/스냅샷 전략

- **웹/앱**: 설정 파일, 인증서, 배포 아티팩트(버전 핀).  
- **DB**: 논리/물리 백업 + **복구 연습(PITR)**.  
- **AD**: 시스템 상태 백업 + **권한 있는 복원** 테스트.  
- **로그**: 장기 보존은 오브젝트 스토리지 + 해시/무결성 마커.

### systemd 타이머(백업 실행)
```ini
# /etc/systemd/system/pgdump.service
[Service]
Type=oneshot
ExecStart=/usr/local/bin/pgdump.sh

# /etc/systemd/system/pgdump.timer
[Timer]
OnCalendar=*-*-* 02:00:00
Persistent=true
[Install]
WantedBy=timers.target
```

---

# 8) 엔드투엔드 시나리오

## 시나리오 A — “웹 계층 신규 구축(Reverse Proxy + 샌드박스)”
1. OS 하드닝(패치, SSH, /tmp noexec, sysctl).  
2. Nginx 설치/`site.conf`(TLS/헤더/업스트림 내부).  
3. systemd 하드닝 Drop-in + SELinux 라벨.  
4. 방화벽: 443만 인바운드, 관리자 IP에만 22 허용.  
5. 파일럿 → 부하/오탐(모드시큐리티) → 조정 → 운영 반영.  
6. 검증: `ss -ltnp`, `systemd-analyze security`, 스캔(SSL Labs 등).

**롤백**: Drop-in 제거, 이전 conf 복원, SELinux boolean 되돌리기.

---

## 시나리오 B — “DB 분리 + TLS + 최소권한”
1. DB NIC를 **내부 서브넷 주소**만 바인드.  
2. TLS 키/인증서 배포(내부 CA).  
3. `pg_hba.conf`/`mysqld.cnf` 수정 → App 서브넷만 허용.  
4. 최소 테이블 권한 부여, 관리자 접속은 배스천에서만.  
5. pgaudit/감사 플러그인 활성 → Collector로 전달.  
6. 백업/복구 연습 + 성능 영향 점검.

**롤백**: 설정 파일 `.bak`로 복원, 서비스 재기동.

---

## 시나리오 C — “AD/DC 보강 + 로그 집계”
1. DC에 **최신 패치**, LDAP/SMB/Kerberos 강화 GPO.  
2. LAPS/gMSA 도입, 관리자 계층화/PAW.  
3. **WEF Collector** 구성, DC/서버 로그 수집.  
4. Sysmon 배포(최소: proc/net/file).  
5. 경보(관리자 로그인 급증/로그 삭제 1102/PowerShell -enc).

**롤백**: GPO 링크 해제/백업 복원, WEF 구독 비활성, Sysmon 제거.

---

## 시나리오 D — “로그 서버 중앙집중 + 장기보존”
1. rsyslog TLS/RELP로 수집, Windows는 WEF.  
2. 인덱스 수명주기/압축, 역할 기반 접근 제어.  
3. 대시보드/KPI(로그 유실률, 최신 이벤트 시각).  
4. 보존 정책 준수(예: 1년 온라인 + 5년 아카이브).

**롤백**: 송신 측 로컬 로깅 전환, Collector 규칙 롤백.

---

# 9) 헌팅/탐지 쿼리(운영 점검)

## 9.1 Windows (PowerShell)
```powershell
# 최근 24h 관리자 특권 로그인(4672)
$start=(Get-Date).AddDays(-1)
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4672; StartTime=$start} |
  Group-Object {$_.Properties[1].Value} | Sort Count -Desc | Select Name,Count

# 프로세스 생성(4688) 중 -enc 흔적
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4688; StartTime=$start} |
? { $_.Message -match " -enc " } | Select TimeCreated,Message
```

## 9.2 Linux (osquery)
```sql
-- 비정상 리스닝 포트
SELECT p.name, l.port, l.address, p.cmdline
FROM listening_ports l JOIN processes p ON l.pid=p.pid
WHERE l.address != '127.0.0.1' AND l.port NOT IN (22,80,443,5432,3306);
```

## 9.3 Nginx 접근 로그 (jq)
```bash
jq -r 'select(.status>=500) | [.time,.remote,.request,.status,.upstream] | @tsv' /var/log/nginx/access_json.log
```

---

# 10) 검증 체크리스트

**네트워크**
- [ ] 각 서브넷/역할별 **기본거부**, 허용만 열림  
- [ ] Web→App, App→DB만, Mgmt는 Bastion 통해서만

**웹**
- [ ] TLS 1.2/1.3, 보안 헤더 적용  
- [ ] 업스트림 내부, 파일권한 최소, systemd 샌드박스 OK  
- [ ] (선택) WAF/CRS 감사→차단

**DB**
- [ ] 내부 NIC만 바인드, TLS 강제  
- [ ] 최소권한 계정/스키마, 감사 로그 SIEM 연동  
- [ ] 백업/복구 테스트 통과

**AD**
- [ ] LDAP/SMB/Kerberos 강화, NTLMv1 금지  
- [ ] LAPS/gMSA, PAW/계층화  
- [ ] 고급 감사/WEF/Sysmon 정상 수집

**로그**
- [ ] WEF/rsyslog TLS, 유실률 모니터링  
- [ ] 보존/권한/무결성

**운영**
- [ ] 패치 창구/롤링, 스냅샷/롤백 경로  
- [ ] 변경/예외/승인 기록  
- [ ] KPI 대시보드(커버리지/지연/알람)

---

# 11) 트러블슈팅 & 롤백 가이드

- **웹 갑작스런 403/오탐**: WAF/CRS 규칙 ID 확인 → 화이트리스트(경로/파라미터) → 로그 근거 첨부해 룰 조정.  
- **DB 연결 실패(TLS)**: 인증서 체인/서버네임(SNI)/`pg_hba.conf`/`require_secure_transport` 점검.  
- **AD 로그인 지연**: DNS/시간(NTP) 확인, 복제 헬스(`repadmin /replsummary`).  
- **로그 유실**: rsyslog 큐/디스크 공간/네트워크 방화벽 확인, RELP 전환.  

**롤백 스니펫**
```bash
# Nginx 설정 되돌리기
sudo cp /etc/nginx/conf.d/site.conf.bak /etc/nginx/conf.d/site.conf
sudo systemctl reload nginx

# PostgreSQL
sudo cp /var/lib/pgsql/data/postgresql.conf.bak /var/lib/pgsql/data/postgresql.conf
sudo systemctl restart postgresql

# SELinux Boolean
sudo setsebool -P httpd_can_network_connect off
```

```powershell
# GPO 링크 비활성(예)
Set-GPLink -Name "DC-Hardening" -Target "OU=Domain Controllers,DC=corp,DC=local" -Enforced:$false -LinkEnabled:$false
```

---

# 12) 자동화 템플릿(발췌)

## 12.1 Ansible — 웹/DB 공통 하드닝
```yaml
- hosts: webservers, dbservers
  become: true
  tasks:
    - name: Patch
      package:
        name: '*'
        state: latest

    - name: SSH hardening
      copy:
        dest: /etc/ssh/sshd_config
        content: |
          Protocol 2
          PermitRootLogin no
          PasswordAuthentication no
          PubkeyAuthentication yes
      notify: Reload sshd

    - name: /tmp noexec
      mount:
        path: /tmp
        src: tmpfs
        fstype: tmpfs
        opts: defaults,noexec,nosuid,nodev,mode=1777
        state: mounted

  handlers:
    - name: Reload sshd
      service: { name: sshd, state: reloaded }
```

## 12.2 Terraform — 보안 그룹(예시)
```hcl
resource "aws_security_group" "web" {
  name   = "sg-web"
  vpc_id = var.vpc_id
  ingress {
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }
  egress { from_port=0 to_port=0 protocol="-1" cidr_blocks=["0.0.0.0/0"] }
}

resource "aws_security_group" "db" {
  name   = "sg-db"
  vpc_id = var.vpc_id
  ingress {
    from_port       = 5432
    to_port         = 5432
    protocol        = "tcp"
    security_groups = [aws_security_group.web.id] # Web/App만 허용
  }
}
```

---

# 13) 요약(암기 포인트)

- **분리**: 네트워크/권한/역할을 층화 → Web/App/DB/Mgmt/Logs 구획.  
- **기본거부**: 방화벽/SG는 허용만 열기.  
- **암호화**: TLS(전송), 디스크/백업(저장).  
- **최소권한**: DB 계정·AD 권한·시스템 서비스(systemd/SELinux/AppArmor).  
- **가시성**: 고급 감사/WEF/rsyslog/JSON 로그 → SIEM.  
- **복원력**: 백업+복구 연습, 스냅샷/롤백 경로 상시 준비.  
- **자동화**: Ansible/Terraform/GPO로 **일관성** 확보 → 파일럿→링 배포.
