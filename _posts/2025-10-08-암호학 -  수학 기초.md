---
layout: post
title: 암호학 - 수학 기초
date: 2025-10-08 21:30:23 +0900
category: 암호학
---
# 2. 수학 기초 압축 가이드

## ✅ 2.1 정수론 (Number Theory) — 모듈러 산술·오일러 φ·페르마/오일러 정리·중국인의 나머지 정리(CRT)

### 2.1.1 모듈러 산술의 직관
- 어떤 정수 \(a\)를 **법(modulus)** \(n \ge 2\)에 대해 “나머지”만 본다.
- 기호: \(a \equiv b \pmod n \iff n \mid (a-b)\).
- 덧셈·뺄셈·곱셈은 **나머지 연산**과 잘 맞는다:
  \[
  (a \bmod n) + (b \bmod n) \equiv (a+b) \pmod n,\quad
  (a \bmod n)\cdot(b \bmod n) \equiv ab \pmod n.
  \]
- **나눗셈**은 조심! 역원(inverse)이 있을 때만 가능.

**예제 2.1.1**  
\( 17 \equiv 2 \pmod{5}\), \( 9 \equiv -1 \pmod{5}\).  
따라서 \(17\cdot 9 \equiv 2\cdot (-1) \equiv -2 \equiv 3 \pmod 5\).

---

### 2.1.2 최대공약수·확장 유클리드
- \(\gcd(a,b)\)는 \(a,b\)의 **가장 큰** 공약수.
- **확장 유클리드 알고리즘**: \(\gcd(a,b)=d\)와 함께 정수 \(x,y\)를 찾아
  \[
  ax + by = d
  \]
  를 만족(베주 항등식). 특히 \(\gcd(a,n)=1\)이면 \(ax \equiv 1 \pmod n\)인 **모듈러 역원 \(x=a^{-1} \bmod n\)** 을 얻는다.

**예제 2.1.2 (모듈러 역원)**  
\(7x \equiv 1 \pmod{26}\)의 해를 찾자.  
\(\gcd(7,26)=1\)이고, 확장 유클리드로 \(26=3\cdot7+5,\; 7=1\cdot5+2,\; 5=2\cdot2+1\).  
되올림하면 \(1=5-2\cdot2=5-2\cdot(7-1\cdot5)=3\cdot5-2\cdot7=3(26-3\cdot7)-2\cdot7=3\cdot26-11\cdot7\).  
따라서 \( -11\cdot 7 \equiv 1 \pmod{26}\Rightarrow x\equiv -11\equiv 15 \pmod{26}\).

---

### 2.1.3 오일러의 φ 함수
- \( \varphi(n) \): \(1\le k\le n\) 중 \(\gcd(k,n)=1\)인 수의 개수.
- 성질:
  - \(p\)가 소수이면 \( \varphi(p)=p-1\).
  - \(p\) 소수, \(k\ge1\): \( \varphi(p^k)=p^k-p^{k-1}=p^{k-1}(p-1)\).
  - \(m,n\)이 서로소면 \( \varphi(mn)=\varphi(m)\varphi(n)\) (**곱셈적**).
- \(n=\prod_i p_i^{e_i}\) 프라임 분해 시
  \[
  \varphi(n)=n\prod_i\left(1-\frac{1}{p_i}\right).
  \]

**예제 2.1.3**  
\(n=60=2^2\cdot 3\cdot 5\).  
\(\varphi(60)=60(1-\tfrac12)(1-\tfrac13)(1-\tfrac15)=60\cdot \tfrac12\cdot \tfrac23\cdot \tfrac45=16\).

---

### 2.1.4 페르마의 소정리 & 오일러 정리
- **페르마의 소정리(Fermat’s little theorem)**: \(p\) 소수, \(\gcd(a,p)=1\)이면
  \[
  a^{p-1} \equiv 1 \pmod p.
  \]
  따라서 \( a^{-1}\equiv a^{p-2}\pmod p\).

- **오일러 정리(Euler’s theorem)**: \(\gcd(a,n)=1\)이면
  \[
  a^{\varphi(n)} \equiv 1 \pmod n.
  \]

**예제 2.1.4 (역원 계산 빠르게)**  
\(a=7,\; p=13\). \(\gcd(7,13)=1\).  
\(7^{-1}\equiv 7^{11}\pmod{13}\) (왜냐면 \(p-2=11\)).  
계산하면 \(7^{2}=49\equiv10,\;7^{4}\equiv10^2=100\equiv9,\;7^{8}\equiv9^2=81\equiv3\).  
\(7^{11}=7^{8}\cdot7^{2}\cdot7 \equiv 3\cdot10\cdot7=210\equiv 210-13\cdot16=210-208=2\).  
따라서 \(7^{-1}\equiv 2 \pmod{13}\).

---

### 2.1.5 중국인의 나머지 정리 (CRT)
- **정리(간단형)**: 서로소인 \(n_1,\dots,n_k\)에 대해
  \[
  x\equiv a_1\pmod{n_1},\;
  \dots,\;
  x\equiv a_k\pmod{n_k}
  \]
  는 \(N=n_1\cdots n_k\)를 법으로 **유일한 해**를 갖는다. 해의 구성도 가능.
- **직관**: 서로소 모듈로 조건이 서로 “겹치지 않음” → 조합하면 큰 주기의 정합 해를 하나 만들 수 있다.

**예제 2.1.5 (구성)**  
\[
x\equiv 2\pmod{3},\quad x\equiv 3\pmod{5},\quad x\equiv 2\pmod{7}.
\]
\(N=3\cdot 5\cdot 7=105\).  
\(N_1=35\,(=105/3),\;N_2=21,\;N_3=15\).  
각각 \(y_i\equiv N_i^{-1}\pmod{n_i}\) 구한다.
- \(35y_1\equiv 1\pmod{3}\Rightarrow 35\equiv -1\pmod 3\Rightarrow y_1\equiv -1\equiv 2\).
- \(21y_2\equiv 1\pmod{5}\Rightarrow 21\equiv 1\pmod 5\Rightarrow y_2\equiv 1\).
- \(15y_3\equiv 1\pmod{7}\Rightarrow 15\equiv 1\pmod 7\Rightarrow y_3\equiv 1\).

해:
\[
x\equiv a_1N_1y_1+a_2N_2y_2+a_3N_3y_3
\equiv 2\cdot 35\cdot 2 + 3\cdot 21\cdot 1 + 2\cdot 15\cdot 1
= 140+63+30=233\equiv 233-2\cdot 105=23 \pmod{105}.
\]
검증: \(23\bmod3=2,\;23\bmod5=3,\;23\bmod7=2\) ✓

**암호학 연결**
- **RSA**: 복호 시 \(p,q\)에 대해 **CRT 최적화**(큰 지수 연산을 두 번의 작은 모듈로 연산으로 나눔).  
- **다중 모듈러** 구조·잔여 시스템 기반 암호 등.

---

### 2.1.6 모듈러 거듭제곱(빠른 제곱-나머지)
큰 지수 연산은 분할정복(제곱-곱)로 수행한다.

```python
def modexp(base, exp, mod):
    """빠른 모듈러 거듭제곱: base^exp mod mod"""
    res = 1
    b = base % mod
    e = exp
    while e > 0:
        if e & 1:
            res = (res * b) % mod
        b = (b * b) % mod
        e >>= 1
    return res

# 예시: 7^12345 mod 97
print(modexp(7, 12345, 97))
```

**실수 포인트**
- 나눗셈(역원) 존재 조건: \(\gcd(a,n)=1\)일 때만 \(a^{-1}\)가 존재.
- CRT는 **서로소**가 핵심(공약수 있으면 “수정판” 필요).
- 큰 수 연산에서는 **모듈러 연산의 중간 오버플로**를 주의(언어·라이브러리 의존).

---

## ✅ 2.2 확률·정보이론 — 엔트로피·충돌 확률·생일 역설

### 2.2.1 랜덤 변수·확률의 기본
- 이산 확률 공간에서 사건 \(A\)의 확률: \(0\le \Pr[A]\le 1\), \(\sum \Pr[\text{모든 사건}] = 1\).
- 기대값: \(\mathbb{E}[X]=\sum_x x\Pr[X=x]\).
- 조건부 확률: \(\Pr[A\mid B]=\frac{\Pr[A\cap B]}{\Pr[B]}\).
- 베이즈 정리: \(\Pr[A\mid B]=\frac{\Pr[B\mid A]\Pr[A]}{\Pr[B]}\).

---

### 2.2.2 정보량·엔트로피
- 어떤 결과 \(x\)의 **자기 정보량**: \(\displaystyle I(x)=-\log_2\Pr[X=x]\) (희귀할수록 정보량 ↑).
- **샤논 엔트로피(Shannon entropy)**:
  \[
  H(X)=\mathbb{E}[I(X)]=-\sum_x \Pr[X=x]\log_2\Pr[X=x].
  \]
  균등분포(크기 \(N\))의 엔트로피는 \(H=\log_2 N\) (최대 불확실성).

**예제 2.2.2**  
- 공정 동전 \(P(H)=P(T)=\tfrac12\): \(H=1\) bit.  
- 256가지 값이 **균등**하게 나오는 바이트: \(H=8\) bits.

**암호학 연결**
- **키 엔트로피**: 키 후보 집합이 균등·독립이면 엔트로피 \(\approx\) 비트 길이.  
- 패스워드 엔트로피는 **분포가 균등하지 않아** 기대보다 훨씬 낮음 → KDF 필요.

---

### 2.2.3 충돌 확률(collision)과 해시
- 해시 함수 \(h:\{0,1\}^\*\to \{0,1\}^n\)에서 **충돌**: \(x\ne x'\)인데 \(h(x)=h(x')\).
- 무작위 함수(이상적 해시)라고 가정 시, \(q\)번 질의할 때 **충돌 발생 확률**은 대략:
  \[
  \approx \frac{q(q-1)}{2\cdot 2^n} \sim \frac{q^2}{2^{n+1}}.
  \]
- 충돌을 “현실적으로” 만들 확률이 0.5에 근접하려면 \(q\approx 1.17\cdot 2^{n/2}\) 수준. (다음 생일 역설 참조)

**실수 포인트**
- “\(n\)-비트 해시니까 보안 수준 \(2^n\)?” → **충돌 공격**에 대해서는 **\(2^{n/2}\)** 로 약화(이유: 생일 역설).

---

### 2.2.4 생일 역설(birthday paradox)
- 사람 \(k\)명 중 **생일이 같은 쌍**이 있을 확률은 \(k\)가 23만 되어도 50%에 근접한다(365일 가정).
- 일반화: 출력공간 크기 \(N=2^n\)인 이상적 해시에서, \(k\approx 1.17\sqrt{N}\)이면 충돌 확률 \(\approx 0.5\).
- **결론**: \(n\)-비트 해시는 **충돌 저항** 관점에서 **보안 수준 \(n/2\) 비트**로 보는 게 보수적.

**예제 2.2.4**  
- 해시 출력 256비트(SHA-256). 충돌 난이도 \(\sim 2^{128}\) 수준.  
- 서명 스킴에서 해시에 의존하는 설계는 이 사실을 반영해 **파라미터**를 고른다.

---

### 2.2.5 조건부 엔트로피·상호정보량 (간단 맛보기)
- **조건부 엔트로피** \(H(X\mid Y)=\mathbb{E}_y[H(X\mid Y=y)]\): \(Y\)가 주어졌을 때 남는 불확실성.
- **상호정보량** \(I(X;Y)=H(X)-H(X\mid Y)\): \(Y\)가 \(X\)에 대해 주는 정보량.
- 키·암호문 \(I(K;C)\approx 0\)이면(계산적 의미에서) 기밀성 만족에 가까움.

---

## ✅ 2.3 대수 구조 — 군(Group)·환(Ring)·체(Field), 유한체 GF(p), GF(2^n)

### 2.3.1 군(Group)
- 집합 \(G\)와 연산 \(\circ\)가 다음을 만족:
  1. 닫힘: \(a,b\in G\Rightarrow a\circ b\in G\)
  2. 결합법칙: \((a\circ b)\circ c=a\circ(b\circ c)\)
  3. 항등원 존재: \(\exists e\in G,\; e\circ a=a\circ e=a\)
  4. 역원 존재: \(\forall a\in G,\; \exists a^{-1}\in G,\; a\circ a^{-1}=e\)

- **가환군(Abelian group)**: \(a\circ b=b\circ a\).

**예제 2.3.1**  
\((\mathbb{Z}, +)\)는 가환군(항등원 0, 역원 \(-a\)).  
\((\mathbb{Z}_n^\*, \cdot)\) — \(\mathbb{Z}_n\) 중 \(\gcd(a,n)=1\) 요소에 대해 곱셈은 군.

**암호학 연결**  
- **이산로그 문제**: 군 \(G=\langle g\rangle\)에서 \(g^x=h\)일 때 \(x\)를 찾기 어려운 문제.  
- **ECDH/EdDSA**: 타원곡선 점들의 가환군 구조 이용.

---

### 2.3.2 환(Ring)
- 두 연산 \(+,\cdot\)을 가지며, \((R,+)\)는 가환군, \(\cdot\)는 결합적이고 분배법칙 성립.  
- 항등원 1이 있는 경우도 있고 없는 경우도(암호에서는 보통 1 포함).
- 예: \((\mathbb{Z}, +, \cdot)\), \((\mathbb{Z}_n, +, \cdot)\), 다항식환 \(\mathbb{F}[x]\).

---

### 2.3.3 체(Field)
- \(F\)가 환이고, \(F\setminus\{0\}\)가 곱셈에 대해 **가환군**이면 체.
- 직관: 덧셈·뺄셈·곱셈·나눗셈(0 제외)이 “정상적으로” 되는 연산 공간.
- 예: \(\mathbb{Q}, \mathbb{R}, \mathbb{F}_p\) (소수 \(p\)에 대한 정수 나머지 체).

**암호학 연결**
- 대칭키(블록암호)의 내부 연산은 \(\mathbb{F}_2\) 또는 \(\mathbb{F}_{2^n}\) 위 선형·비선형 혼합.  
- ECC는 유한체 \(\mathbb{F}_p\) 또는 \(\mathbb{F}_{2^m}\) 위의 타원곡선 위 점들의 군.

---

### 2.3.4 유한체 \(\mathbb{F}_p\) (소수 법)
- \(\mathbb{Z}_p=\{0,\dots,p-1\}\), \(p\) 소수 → **체**가 된다.  
- 모든 비영(0 아닌) 원소는 역원을 가짐:
  \[
  a^{p-1}\equiv 1\pmod p \Rightarrow a^{-1}\equiv a^{p-2}\pmod p.
  \]
- 덧셈·곱셈은 모듈러 \(p\) 연산.

**예제 2.3.4**  
\(p=13\)에서 \(5^{-1}\equiv 5^{11}\equiv 8 \pmod{13}\) (직접 빠른 거듭제곱으로 확인 가능).

---

### 2.3.5 유한체 \(\mathbb{F}_{2^n}\) (이진 확장체)
- **구성 아이디어**: \(\mathbb{F}_2[x]\)에서 **기약다항식** \(P(x)\) (차수 \(n\))로 나눈 동치류:
  \[
  \mathbb{F}_{2^n} \cong \mathbb{F}_2[x]/\langle P(x)\rangle.
  \]
- 원소는 **최대 차수 \(n-1\)** 의 다항식(계수 0/1)으로 표현 → **비트열**로 보기도 쉬움.
- 덧셈: 계수(비트)별 XOR.  
- 곱셈: 다항식 곱 \(\bmod P(x)\) (감산은 XOR과 같음).

**예제 2.3.5 (간단한 곱셈)**  
\(n=4\), \(P(x)=x^4+x+1\) (기약이라 가정).  
\(a(x)=x^3+x\) (이진 1010), \(b(x)=x^2+1\) (0101).
- 곱: \(a\cdot b = (x^3+x)(x^2+1)=x^5+x^3+x^3+x=x^5+x\).
- \(\bmod P(x)\): \(x^5 = x\cdot x^4 \equiv x(x+1)=x^2+x\) (왜냐면 \(x^4\equiv x+1\) from \(x^4\equiv -x-1=x+1\) in \(\mathbb{F}_2\)).  
  따라서 \(x^5+x \equiv (x^2+x)+x = x^2\). 결과: \(x^2\) (0100).

**AES와의 연결**
- AES의 SubBytes는 \(\mathbb{F}_{2^8}\)에서의 **역원** + **아핀 변환**.  
- **MixColumns**는 \(\mathbb{F}_{2^8}\) 위 **선형 변환**(확산).

---

### 2.3.6 기약·원시 다항식, 원시 원소
- 기약다항식 \(P(x)\): \(\mathbb{F}_2[x]\)에서 서로 낮은 차수 다항식의 곱으로 인수분해되지 않음.
- 원시 원소 \(\alpha\): \(\mathbb{F}_{2^n}^\*\)의 생성원(곱셈군의 크기 \(2^n-1\)을 생성).
- 구현에서는 표준·검증된 \(P(x)\)를 사용(자체 선택 금지).

**실수 포인트**
- \(\mathbb{F}_{2^n}\)의 덧셈은 **XOR**, 곱셈은 **다항식 곱+감산=XOR**임을 상기.  
- 서로 다른 기약다항식으로 만든 \(\mathbb{F}_{2^n}\)도 **동형**이지만 **표현**은 달라짐 → 구현 혼용 주의.

---

## ✅ 2.4 선형대수 & 격자 — 노름·기저·짧은 벡터(SVP) 맛보기

### 2.4.1 노름(norm)
- \(\mathbb{R}^n\)에서 벡터 길이를 재는 함수 \(\lVert\cdot\rVert\)로, 다음을 만족:
  1. 양의 정부호: \(\lVert x\rVert\ge 0\), \(\lVert x\rVert=0\iff x=0\)
  2. 동차성: \(\lVert \alpha x\rVert=|\alpha|\lVert x\rVert\)
  3. 삼각부등식: \(\lVert x+y\rVert\le \lVert x\rVert+\lVert y\rVert\)

- 자주 쓰는 노름:
  - \(\ell_2\): \(\lVert x\rVert_2=\sqrt{\sum_i x_i^2}\) (유클리드 길이)
  - \(\ell_1\): \(\lVert x\rVert_1=\sum_i |x_i|\)
  - \(\ell_\infty\): \(\lVert x\rVert_\infty=\max_i |x_i|\)

**암호학 연결**
- 격자기반 암호에서 **노름 제한**은 보안·정확성(복호 오류율)과 직접 연결.

---

### 2.4.2 기저(basis)·선형독립·랭크
- 벡터공간 \(V\)에서 서로 **선형독립**이며 \(V\) 전체를 생성하는 집합.  
- 행렬 \(B=[b_1\; b_2\;\dots\; b_n]\)의 열벡터가 기저를 이루면 모든 \(x\in V\)를 정수/실수 조합으로 표현 가능.

---

### 2.4.3 격자(lattice)의 개념
- **정의**: 선형독립 벡터 \(B=(b_1,\dots,b_n)\subset \mathbb{R}^m\)에 대한 **정수** 선형결합의 집합:
  \[
  \mathcal{L}(B)=\left\{\sum_{i=1}^{n} z_i b_i : z_i\in\mathbb{Z}\right\}.
  \]
- **직관**: 공간에 “격자점”이 주기적으로 찍힌 구조.  
- **기저 비유일성**: 같은 격자라도 여러 **다른 기저**가 있음(짧고 직교적인 것도, 길고 비스듬한 것도).

**예제 2.4.3**  
\(b_1=(2,0),\; b_2=(1,3)\)이면 \(\mathcal{L}=\{z_1(2,0)+z_2(1,3)\}\).  
기저를 \(b'_1=(1,3), b'_2=(1,-3)\) 등으로 바꿔도 같은 격자일 수 있음(정수 가역 변환 관계).

---

### 2.4.4 기본 문제: SVP·CVP
- **SVP (Shortest Vector Problem)**: 격자에서 **0이 아닌** 가장 짧은 벡터 찾기.  
- **CVP (Closest Vector Problem)**: 주어진 점 \(t\)에 가장 가까운 격자점 찾기.  
- 일반적으로 **난해**(특히 차원↑) → 격자기반 암호의 안전성 근거.

**암호학 연결**
- **LWE/LWR/RLWE/MLWE**: 노이즈가 섞인 선형방정식에서 비밀복구가 어렵다는 가정.  
- **NIST PQC** 표준 후보 대부분이 격자 기반(키 교환·서명 등).

---

### 2.4.5 Gram–Schmidt 직교화 & 기저 품질
- 주어진 기저 \(B=(b_1,\dots,b_n)\)에서 **직교화** \(B^\*=(b_1^\*,\dots,b_n^\*)\)를 만든다:
  \[
  \begin{aligned}
  b_1^\*&=b_1,\\
  b_i^\*&=b_i-\sum_{j<i}\mu_{i,j}b_j^\*,\;\;\mu_{i,j}=\frac{\langle b_i,b_j^\*\rangle}{\langle b_j^\*,b_j^\*\rangle}.
  \end{aligned}
  \]
- \( \lVert b_i^\*\rVert \)가 작을수록 “잘 정리된” 기저.  
- **LLL** 같은 기저 **환원(reduction)** 알고리즘은 \(\lVert b_1\rVert\)을 어느 정도 줄여 “준최적” 기저로 만든다(다항시간).

**실무 직감**
- 격자 암호의 키(공개키)는 “거칠고 긴” 기저, 비밀키는 “짧고 잘 정리된” 기저(복호 쉬움).

---

### 2.4.6 아주 작은 차원의 LLL 맛보기(개념)
- LLL은 매개변수 \(\delta\in(\tfrac14,1)\)로 제어되며, \(\delta\)-감소 조건과 사이즈-리듀스 조건을 만족하도록 기저를 바꾼다.
- 결과: \( \lVert b_1\rVert \le 2^{(n-1)/2}\cdot \lambda_1(\mathcal{L})\) (여기서 \(\lambda_1\)는 최단벡터 길이) 같은 보증.
- 이는 **근사 SVP** 해에 해당(정확 최적은 아님).

**암호학 연결**
- **격자기반 서명**(예: Dilithium)에서 샘플링/노름 제한, **디코딩 오류** 확률 관리, 파라미터 선택이 모두 **노름·기저 품질**과 연결.

---

### 2.4.7 노름 제약과 오류 확률
- LWE 류 복호는 \(\lVert\text{노이즈}\rVert\)가 경계 이하면 “정확 복호”, 넘으면 “오류”.  
- 보안은 **노이즈 충분히 큼** + **차원 충분히 큼** → **공격자**는 어려움, **정상 사용자**는 제한된 노름 덕에 복호 가능.

---

## ✅ 2.5 실전 연결: 이론 ↔ 구현 체크리스트

- **정수론**  
  - 모듈러 역원/거듭제곱은 **확장 유클리드 + 빠른 제곱**으로 구현.  
  - **CRT 최적화**: RSA 복호·서명 가속(단, CRT-하드닝 필수: 오류주입 방어).

- **확률·정보이론**  
  - **엔트로피 예산**: 키·Nonce·시드의 최소 비트수 및 독립성 확인.  
  - 해시 충돌·생일 경계 반영해 **파라미터** 결정(예: 해시 길이·태그 길이).

- **대수 구조**  
  - \(\mathbb{F}_p\)·\(\mathbb{F}_{2^n}\) 구현 시 **표준 기약다항식** 사용(독자 선택 금지).  
  - \(\mathbb{F}_{2^n}\) 연산: XOR(덧셈) + 다항식 곱 mod \(P(x)\) (곱셈·역원).

- **선형대수·격자**  
  - 파라미터 선택은 **노름 경계**와 **오류 확률**로 안전성·성능 균형.  
  - 키/서명 크기, 샘플링 분포(중심/테일 컷), 디버깅 시 **노름 로그 금지**(정보 누설).

---

## ✅ 2.6 미니 실습 모음 (교육용)

### 2.6.1 확장 유클리드로 역원 구하기
```python
def egcd(a, b):
    """확장 유클리드: gcd와 (x,y) s.t. ax+by=gcd"""
    if b == 0:
        return a, 1, 0
    d, x1, y1 = egcd(b, a % b)
    return d, y1, x1 - (a // b) * y1

def inv_mod(a, n):
    d, x, _ = egcd(a % n, n)
    if d != 1:
        raise ValueError("역원이 존재하지 않음")
    return x % n

print(inv_mod(7, 26))  # 15
```

### 2.6.2 CRT 구성 (서로소 모듈러)
```python
def crt_pair(a1, n1, a2, n2):
    # x ≡ a1 mod n1, x ≡ a2 mod n2, gcd(n1,n2)=1
    d, s, t = egcd(n1, n2)
    if d != 1:
        raise ValueError("서로소가 아님")
    # x = a1 + (a2 - a1) * s (mod n2) * n1
    x = (a1 + (a2 - a1) * s % n2 * n1) % (n1 * n2)
    return x, n1 * n2

# 예: (mod 3,5,7)를 단계적으로 결합
x, m = crt_pair(2, 3, 3, 5)   # mod 15
x, m = crt_pair(x, m, 2, 7)   # mod 105
print(x, m)  # 23 105
```

### 2.6.3 \(\mathbb{F}_{2^n}\)의 간이 곱셈 (작은 n, 교육용)
```python
def gf2n_mul(a, b, poly, n):
    """
    a,b: 정수로 나타낸 다항식 (최대 차수 < n)
    poly: 기약다항식의 정수표현(최고차항 포함), 예: x^4+x+1 -> 0b1_00011 = 0x13
    n: 차수
    """
    res = 0
    x = a
    y = b
    for _ in range(n*2):  # upper bound (교육용 단순)
        if y & 1:
            res ^= x
        y >>= 1
        carry = (x >> (n-1)) & 1
        x = (x << 1) & ((1 << n) - 1)
        if carry:
            x ^= (poly & ((1 << n) - 1))
        if y == 0:
            break
    return res

# 예: n=4, P(x)=x^4+x+1 -> 1_00011b = 0x13
n = 4
poly = 0x13
a = 0b1010  # x^3 + x
b = 0b0101  # x^2 + 1
print(bin(gf2n_mul(a, b, poly, n)))  # 0b0100 (x^2)
```

**주의**: 실제 구현은 최적화·상수시간·표준 다항식 사용·테이블/캐리 등 고려 필수.

---

## ✅ 2.7 “실수 체크리스트” (시험·구현 공통)

- [ ] **나눗셈 주의**: \(\bmod n\)에서 역원 조건 \(\gcd(a,n)=1\) 확인.  
- [ ] **CRT 전제**: 모듈러는 서로소? (아니면 확장판/분해 필요)  
- [ ] **엔트로피 과대평가 금지**: 패스워드 분포는 균등이 아님.  
- [ ] **생일 경계 기억**: \(n\)-비트 해시 충돌 강도 \(\approx 2^{n/2}\).  
- [ ] **\(\mathbb{F}_{2^n}\) 연산**: 덧셈=XOR, 곱셈=다항식 곱 mod \(P(x)\).  
- [ ] **격자**: 기저가 하나가 아님. 노름·직교화·환원 개념을 구분.  
- [ ] **수치로그 금지**: 노름/키/비밀 파생값을 로깅하지 않는다(정보 누설).

---

## ✅ 2.8 요약 카드(암기용)

- **정수론**: \(\gcd\), 확장 유클리드 → **역원**; \(a^{\varphi(n)}\equiv1\); **CRT**로 큰 모듈러 분할정복.  
- **확률·정보**: **엔트로피**는 불확실성; **충돌 확률 \(\sim q^2/2^{n+1}\)**; **생일 역설**로 \(n\)-비트 해시의 충돌 강도 \(\sim 2^{n/2}\).  
- **대수**: 군/환/체; \(\mathbb{F}_p\)·\(\mathbb{F}_{2^n}\) 운용; AES·ECC의 수학.  
- **선형대수·격자**: 노름·기저·직교화; **SVP/CVP 난함** → 격자기반 암호의 근거.

---

## ✅ 2.9 연습문제(셀프 체크)

1) \(n=84\)에 대해 \(\varphi(n)\)을 구하라(프라임 분해부터).  
2) \(a=11,\; p=41\)에서 \(a^{-1}\bmod p\)를 **페르마 소정리**로 구하라.  
3) CRT: \(x\equiv 1\pmod 4,\; x\equiv 2\pmod 5,\; x\equiv 3\pmod 7\)의 최소 양의 해.  
4) 해시 출력 192비트에서, 50% 충돌확률에 필요한 질의 횟수의 대략적 규모는?  
5) \(\mathbb{F}_{2^4}\)에서 \(P(x)=x^4+x+1\)일 때 \(a=x^3+x^2+1\), \(b=x+1\)의 곱을 구하라.  
6) 격자 \(\mathcal{L}(B)\)와 \(\mathcal{L}(B')\)가 같음을 보이는 “정수 가역 변환”의 의미를 서술하라.  
7) LWE류에서 노름 경계가 왜 복호 오류와 직결되는지 설명하라.
