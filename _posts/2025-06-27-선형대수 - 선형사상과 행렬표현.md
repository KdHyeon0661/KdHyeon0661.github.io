---
layout: post
title: 선형대수 - 선형사상과 행렬표현
date: 2025-06-27 19:20:23 +0900
category: 선형대수
---
# 선형사상과 행렬표현의 관계

> **핵심 한 줄 요약**  
> 같은 선형사상 $$T:V\to W$$라도 **기저**를 어떻게 잡느냐에 따라 **행렬표현**이 달라진다.  
> 그러나 **랭크·고유값(동일 공간일 때)·핵심 성질**은 기저에 의존하지 않는 **불변량**이다.  
> 일반적으로
> $$
> \boxed{\ [T]_{\mathcal C\leftarrow \mathcal B}\;=\;P_{\mathcal C}^{-1}\,A_{\text{std}}\,P_{\mathcal B}\ }
> $$
> 가 성립한다. (여기서 $$P_{\mathcal B}$$, $$P_{\mathcal C}$$는 각 기저의 **좌표→표준좌표** 변환행렬)

---

## 1. 선형사상(Linear Transformation) 복습

선형사상은 두 벡터공간 $$V,W$$ 사이의 함수 $$T:V\to W$$로서 다음을 만족한다.

- **덧셈 보존**  
  $$
  T(\mathbf u+\mathbf v)=T(\mathbf u)+T(\mathbf v)
  $$
- **스칼라곱 보존**  
  $$
  T(c\,\mathbf v)=c\,T(\mathbf v)
  $$

예)  
$$
T\!\begin{bmatrix}x\\y\end{bmatrix}
=
\begin{bmatrix}2x+y\\ x-y\end{bmatrix}
=
\underbrace{\begin{bmatrix}2&1\\1&-1\end{bmatrix}}_{=:A_{\text{std}}}
\begin{bmatrix}x\\y\end{bmatrix}.
$$

---

## 2. “사상 → 행렬” 만들기: 기저가 정해지면 행렬이 정해진다

### 2.1 좌표사상과 표준행렬

- $$V$$의 기저 $$\mathcal B=\{\mathbf b_1,\dots,\mathbf b_n\}$$,  
  $$W$$의 기저 $$\mathcal C=\{\mathbf c_1,\dots,\mathbf c_m\}$$를 고정한다.
- **좌표→표준좌표** 변환행렬
  $$
  P_{\mathcal B}
  =
  \begin{bmatrix}\ \mathbf b_1 & \cdots & \mathbf b_n\ \end{bmatrix}\in\mathbb R^{n\times n},
  \quad
  P_{\mathcal C}
  =
  \begin{bmatrix}\ \mathbf c_1 & \cdots & \mathbf c_m\ \end{bmatrix}\in\mathbb R^{m\times m}.
  $$
  임의 벡터 $$\mathbf x\in V$$에 대해
  $$
  \mathbf x_{\text{std}}=P_{\mathcal B}\,[\mathbf x]_{\mathcal B},\qquad
  [\mathbf x]_{\mathcal B}=P_{\mathcal B}^{-1}\,\mathbf x_{\text{std}}.
  $$

- **표준행렬** $$A_{\text{std}}\in\mathbb R^{m\times n}$$은  
  $$\mathbf y_{\text{std}}=A_{\text{std}}\mathbf x_{\text{std}}$$를 만족.

### 2.2 기저에 따른 행렬표현

기저 $$\mathcal B,\mathcal C$$에서의 행렬표현 $$[T]_{\mathcal C\leftarrow\mathcal B}$$는
$$
[\mathbf y]_{\mathcal C}=[T]_{\mathcal C\leftarrow\mathcal B}\,[\mathbf x]_{\mathcal B},
$$
와 같이 정의된다. 변환식을 표준좌표로 끼워 넣으면
$$
\begin{aligned}
[\mathbf y]_{\mathcal C}
&=P_{\mathcal C}^{-1}\,\mathbf y_{\text{std}}
= P_{\mathcal C}^{-1}\,A_{\text{std}}\,\mathbf x_{\text{std}}
= P_{\mathcal C}^{-1}\,A_{\text{std}}\,P_{\mathcal B}\,[\mathbf x]_{\mathcal B}.
\end{aligned}
$$

따라서
$$
\boxed{\ [T]_{\mathcal C\leftarrow \mathcal B}=P_{\mathcal C}^{-1}\,A_{\text{std}}\,P_{\mathcal B}\ }.
$$

> **열벡터 해석**  
> $$[T]_{\mathcal C\leftarrow\mathcal B}$$의 **i번째 열**은  
> $$T(\mathbf b_i)$$를 **공역 기저 $$\mathcal C$$** 좌표로 나타낸 것이다.

### 2.3 유일성

기저가 고정되면, 모든 $$\mathbf x$$에 대해 $$[\mathbf y]_{\mathcal C}=[T]_{\mathcal C\leftarrow\mathcal B}[\mathbf x]_{\mathcal B}$$를 만족하는 행렬은 **유일**하다.  
(선형성 + 기저의 선형독립성으로 즉시 증명 가능)

---

## 3. 조합(Composition)과 행렬곱

세 공간 $$U\xrightarrow{\,T\,} V\xrightarrow{\,S\,} W$$, 기저를 각각 $$\mathcal A,\mathcal B,\mathcal C$$로 두면
$$
\boxed{\ [S\circ T]_{\mathcal C\leftarrow\mathcal A}
=
[S]_{\mathcal C\leftarrow\mathcal B}\,[T]_{\mathcal B\leftarrow\mathcal A}\ }.
$$

즉 **사상의 합성 → 행렬곱**과 일치한다.

---

## 4. 기저변환 공식(아주 중요)

### 4.1 도메인·공역이 **다른** 기저로 바뀔 때
도메인 기저 $$\mathcal B\to\mathcal B'$$, 공역 기저 $$\mathcal C\to\mathcal C'$$로 바꾸면
$$
\boxed{\ [T]_{\mathcal C'\leftarrow\mathcal B'}=P_{\mathcal C'\leftarrow\mathcal C}\,[T]_{\mathcal C\leftarrow\mathcal B}\,P_{\mathcal B\leftarrow\mathcal B'}\ }.
$$
여기서
$$
P_{\mathcal B\leftarrow\mathcal B'}=P_{\mathcal B}^{-1}P_{\mathcal B'},\qquad
P_{\mathcal C'\leftarrow\mathcal C}=P_{\mathcal C'}^{-1}P_{\mathcal C}.
$$

### 4.2 **같은 공간**에서의 기저변환(유사변환·Similarity)
$$V=W,\ \mathcal B=\mathcal C,\ \mathcal B'=\mathcal C'$$라면
$$
\boxed{\ [T]_{\mathcal B'} = S^{-1}\,[T]_{\mathcal B}\,S\ },\qquad
S=P_{\mathcal B\leftarrow\mathcal B'}.
$$
→ **유사변환**. 이때 **고유값·랭크·추적(trace)·행렬식(det)** 등은 **불변**.

---

## 5. 예시 모음 (상황 + 계산)

### 예제 A — $$\mathbb R^2$$ 전단(shear)과 이기저 표현

- 표준행렬
  $$
  A_{\text{std}}=
  \begin{bmatrix}
  1 & 1\\
  0 & 1
  \end{bmatrix},\quad
  T(x,y)=(x+y,\ y).
  $$

- 도메인 기저  
  $$
  \mathcal B=\big\{\mathbf b_1,(1,1)^{\mathsf T},\ \mathbf b_2,(1,-1)^{\mathsf T}\big\},\quad
  P_{\mathcal B}=\begin{bmatrix}1&1\\1&-1\end{bmatrix}.
  $$
- 공역 기저  
  $$
  \mathcal C=\big\{\mathbf c_1,(2,0)^{\mathsf T},\ \mathbf c_2,(0,1)^{\mathsf T}\big\},\quad
  P_{\mathcal C}=\begin{bmatrix}2&0\\0&1\end{bmatrix}.
  $$

- 기저 표현
  $$
  [T]_{\mathcal C\leftarrow\mathcal B}
  =
  P_{\mathcal C}^{-1}A_{\text{std}}P_{\mathcal B}
  =
  \begin{bmatrix}1/2&0\\0&1\end{bmatrix}
  \begin{bmatrix}1&1\\0&1\end{bmatrix}
  \begin{bmatrix}1&1\\1&-1\end{bmatrix}
  =
  \begin{bmatrix}1&0\\1&-1\end{bmatrix}.
  $$

**해석**: 이 행렬의 첫째 열은 $$T(\mathbf b_1)$$를 $$\mathcal C$$ 좌표로 쓴 것.

---

### 예제 B — 차원 불일치 사상 $$T:\mathbb R^3\to\mathbb R^2$$

기본기저에서
$$
T(x,y,z)=(x+2y,\ y-3z)
\ \Rightarrow\
A_{\text{std}}=
\begin{bmatrix}
1&2&0\\
0&1&-3
\end{bmatrix}.
$$
도메인/공역 기저를 바꾸면 위의 일반식을 그대로 쓰면 된다:
$$
[T]_{\mathcal C\leftarrow\mathcal B}=P_{\mathcal C}^{-1}A_{\text{std}}P_{\mathcal B}.
$$
(이 경우 고유값 개념은 적용되지 않지만 **랭크**, **커널/이미지** 등은 여전히 기저 불변량이다.)

---

### 예제 C — **추상공간**에서의 행렬: 다항식 공간과 미분 연산자

- 공간: $$\mathcal P_2=\{a+bx+cx^2\}$$  
- 기저 $$\mathcal B=\{1,x,x^2\}$$.  
- 사상: 미분 $$D:\mathcal P_2\to\mathcal P_1\subset\mathcal P_2,\quad D(a+bx+cx^2)=b+2cx.$$

이때
$$
[D]_{\mathcal B}
=
\begin{bmatrix}
0&1&0\\
0&0&2\\
0&0&0
\end{bmatrix}.
$$

다른 기저 $$\mathcal C=\{1,(x-1),(x-1)^2\}$$로 바꾸면
$$
[D]_{\mathcal C}
=
P_{\mathcal C\leftarrow\mathcal B}\,[D]_{\mathcal B}\,P_{\mathcal B\leftarrow\mathcal C}
=
P_{\mathcal C}^{-1}P_{\mathcal B}\,[D]_{\mathcal B}\,(P_{\mathcal B}^{-1}P_{\mathcal C}),
$$
즉 **유사변환**으로 얻어진다. (미분의 본질이 변한 게 아니라 **표현**만 변한다.)

---

## 6. 불변량과 해석

- **랭크**: $$\operatorname{rank}(T)=\operatorname{rank}([T]_{\mathcal C\leftarrow\mathcal B})$$ (기저 불변).  
- **커널/이미지**: 기저를 바꿔도 치환될 뿐 차원은 동일.  
- **동일 공간의 선형연산자**(operator)일 때  
  **유사변환 불변량**: 고유값 다중도, 특성다항식, 트레이스, 행렬식, 최소다항식 등.

> 대각화 가능성·조르당 형·SVD(직사각형) 등은 **적절한 기저/분해**를 택해 사상을 단순화하는 대표 예.

---

## 7. 내적·수반(Adjoint)과 전치

내적공간에서 **정규직교 기저**를 쓰면
$$
[T^*] = [T]^{\mathsf T}\quad(\text{실수}),
\qquad
[T^*] = \overline{[T]}^{\mathsf T}\quad(\text{복소}).
$$
정규직교가 아니면 **Gram 행렬** $$G$$가 등장한다:
$$
[T^*]_{\mathcal B}=G^{-1}\,[T]_{\mathcal B}^{\mathsf T}\,H,
$$
(도메인/공역의 Gram 행렬이 각각 $$G,H$$) — 따라서 **계산 편의상 정규직교 기저**가 유리하다.

---

## 8. 실전 코드 — 수식 검증 & 응용

### 8.1 기저-전환 공식의 수치 검증(NumPy)

```python
import numpy as np

# ----- 표준행렬(전단) -----
A_std = np.array([[1., 1.],
                  [0., 1.]])

# ----- 도메인/공역 기저 -----
B = np.column_stack([np.array([1., 1.]),  # b1
                     np.array([1.,-1.])]) # b2
C = np.column_stack([np.array([2., 0.]),  # c1
                     np.array([0., 1.])]) # c2

# [T]_{C<-B} = P_C^{-1} A_std P_B
T_C_from_B = np.linalg.inv(C) @ A_std @ B

# 무작위 벡터 x_B 를 뽑아 검증: 
# 1. 표준으로 보내서 T 적용 후 다시 C좌표로
# 2. 직접 [T]_{C<-B}로 곱하기
x_B = np.array([2., -1.])
lhs = np.linalg.inv(C) @ (A_std @ (B @ x_B))  # [y]_C
rhs = T_C_from_B @ x_B                        # [T]_{C<-B} [x]_B

print(" [T]_{C<-B} =\n", T_C_from_B)
print(" 좌표 일치? ", np.allclose(lhs, rhs))
```

출력에서 `좌표 일치? True`를 확인할 수 있다.

---

### 8.2 동일 공간에서의 유사변환(기저 변경)

```python
import numpy as np

A_B = np.array([[2., 1.],
                [1.,-1.]])        # 어떤 기저 B에서의 [T]_B (예: 위 예제의 결과)

# B' 기저 (표준의 회전기저)
theta = np.deg2rad(30)
Q = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])  # 정규직교 기저의 열

# 좌표변환 S = P_{B<-B'} = P_B^{-1} P_{B'}
# 여기서는 편의상 B=표준, B'=Q 라고 가정 (P_B=I, P_{B'}=Q)
S = np.linalg.inv(np.eye(2)) @ Q  # = Q

A_Bp = np.linalg.inv(S) @ A_B @ S  # 유사변환
# 불변량 확인
print("trace 불변:", np.trace(A_B), np.trace(A_Bp))
print("det 불변:", np.linalg.det(A_B), np.linalg.det(A_Bp))
```

---

### 8.3 다항식 공간의 미분 연산자(기저 변경 검증)

```python
import numpy as np

# B = {1, x, x^2}
D_B = np.array([[0.,1.,0.],
                [0.,0.,2.],
                [0.,0.,0.]])

# C = {1, (x-1), (x-1)^2} 를 B에 대한 좌표로 표현
# (x-1) = -1*1 + 1*x + 0*x^2
# (x-1)^2 = 1*1 -2*x + 1*x^2
P_C = np.column_stack([np.array([1., 0., 0.]),
                       np.array([-1., 1., 0.]),
                       np.array([1., -2., 1.])])  # 좌표->표준(=B) 변환

# [D]_C = P_{C<-B} [D]_B P_{B<-C} = (P_C^{-1} * I) D_B (I^{-1} * P_C) = P_C^{-1} D_B P_C
D_C = np.linalg.inv(P_C) @ D_B @ P_C

# 무작위 계수로 검증
coeff_B = np.array([1., 2., 3.])      # 1 + 2x + 3x^2
coeff_C = np.linalg.inv(P_C) @ coeff_B
lhs = D_C @ coeff_C                    # C좌표에서 미분 적용
rhs = np.linalg.inv(P_C) @ (D_B @ coeff_B)
print("좌표계 불변성 확인:", np.allclose(lhs, rhs))
```

---

## 9. 기하학적 해석: 좌표 → 표준 → 좌표

임의의 $$\mathbf x\in V$$에 대해
$$
\boxed{
[\mathbf y]_{\mathcal C}
= P_{\mathcal C}^{-1}\,\underbrace{A_{\text{std}}}_{\text{고정}}\,
\underbrace{P_{\mathcal B}}_{\text{좌표→표준}}\,[\mathbf x]_{\mathcal B}.
}
$$
즉,
1) **도메인 좌표를 표준좌표로** 바꾸고,  
2) **같은 선형사상**(표준행렬)을 적용한 다음,  
3) **공역 표준좌표를 공역 좌표**로 되돌린다.

---

## 10. 프로젝터·정사영(Projection)의 기저 독립성(응용)

열공간 $$\operatorname{Col}(S)$$로의 **정규직교 투영**은
$$
\boxed{\,P=S(S^{\mathsf T}S)^{-1}S^{\mathsf T}\,}
$$
으로 주어지며, 이는 **기저 선택과 무관**하다.  
(기저를 바꾸면 $$S\to S M$$이 되지만 위 식은 동일한 투영 연산자를 준다.)

---

## 11. 현업 체크리스트(실수 방지)

- [ ] **행·열 방향**: “i번째 열 = $$T(\mathbf b_i)$$의 공역 좌표”.  
- [ ] **도메인/공역 기저 행렬 순서**: $$[T]_{\mathcal C\leftarrow\mathcal B}=P_{\mathcal C}^{-1}A_{\text{std}}P_{\mathcal B}$$ (순서 뒤바뀌지 않게!).  
- [ ] **같은 공간**이면 유사변환: $$A' = S^{-1}AS$$.  
- [ ] **정규직교 기저**를 쓰면 수반/전치 계산이 단순해진다.  
- [ ] **불변량**(랭크·trace·det·스펙트럼)은 표현이 바뀌어도 변하지 않는다.  
- [ ] **비정방(차원 불일치)**에서도 행렬표현은 동일 공식으로 작동(다만 고유분해 개념은 달라짐—SVD 참고).

---

## 12. 소연습(스스로 확인해보기)

1. $$T(x,y,z)=(x+z,\,2y-z)$$에 대해  
   (a) 표준기저 행렬, (b) 도메인 기저 $$\{(1,1,0),(0,1,1),(1,0,1)\}$$,  
   공역 기저 $$\{(1,1),(1,-1)\}$$에서의 $$[T]_{\mathcal C\leftarrow\mathcal B}$$를 구하라.  
2. $$\mathcal P_3$$에서 적분연산자 $$I(p)=\int_0^x p(t)\,dt$$의 행렬을  
   $$\{1,x,x^2,x^3\}$$ 기준으로 구하고, 기저 $$\{1,(x-1),\dots,(x-1)^3\}$$로 바꾸어 검증하라.  
3. 임의의 정사각행렬 $$A$$에 대해 기저변환으로 얻은 $$A'$$와의 **trace/det**가 같음을 수치로 확인하라.

---

## 마무리

- **선형사상 그 자체**는 좌표와 무관한 **기하학적 대상**이며,  
  **행렬은 그 사상을 특정 기저에서 계산 가능한 형태로 기록**한 것이다.  
- 기저를 바꾸면 행렬표현은 변하지만, **랭크·스펙트럼(유사불변량)·프로젝션 등 본질**은 바뀌지 않는다.  
- 실무에서는 “**좌표→표준→좌표**”의 3단 고리를 기억하면 **기저혼동 없이** 코드를 짤 수 있다.
