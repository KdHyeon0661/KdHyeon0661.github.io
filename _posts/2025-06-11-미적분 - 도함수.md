---
layout: post
title: 미적분 - 도함수
date: 2025-06-11 22:20:23 +0900
category: 미적분
---
# 도함수란? (Derivative Function)

## 0. 한눈에 개요

- **도함수의 정의**:
  $$f'(x)=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h}$$
  평균변화율의 극한 = **순간변화율**, 그래프 접선의 **기울기**.

- **핵심 해석**:
  $$f'(x)>0$$ (증가 경향), $$f'(x)<0$$ (감소 경향), $$f'(x)=0$$ (정지점/극값 후보).
  물리에서 위치 $$s(t)$$ 의 미분은 속도 $$v(t)=s'(t)$$, 두 번 미분은 가속도 $$a(t)=s''(t)$$.

- **미분 가능 ⇒ 연속**(항상 참), **연속 ⇒ 미분 가능**(항상 아님: 예 $$|x|$$ at 0).

---

## 1. 정의(미분계수)와 대안적 관점

### 1.1 미분계수(차분비의 극한)
$$
f'(x)=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h}.
$$

- 극한이 **존재하지 않거나 좌·우극한이 다르면** 해당 점에서 **미분 불가**.
- **대칭 차분비**(수치미분에서 유용):
  $$\displaystyle f'(x)=\lim_{h\to 0}\frac{f(x+h)-f(x-h)}{2h}.$$

### 1.2 “최적 선형근사”의 관점(정의의 등가 형식)
$$
f(x+h)=f(x)+f'(x)\,h+o(h)\qquad(h\to 0).
$$
- 여기서 $$o(h)$$ 는 $$\displaystyle \lim_{h\to 0}\frac{o(h)}{h}=0$$ 인 **더 작은 차수**의 오차.
- 즉, 도함수는 **가장 잘 맞는 1차 근사**의 기울기.

---

## 2. 그래프·물리적 해석

- **접선 방정식**(점 $$(a,f(a))$$):
  $$y=f(a)+f'(a)(x-a).$$
- **법선 방정식**(접선과 수직):
  $$y=f(a)-\frac{1}{f'(a)}(x-a)\quad(f'(a)\ne 0).$$
- **즉시속도/민감도**: 단위가 “출력/입력”. 스케일 변화에 민감(아래 §10.3).

---

## 3. 첫 원리(정의)로 미분—기본 예제

### 3.1 $$f(x)=x^2$$
$$
\begin{aligned}
f'(x)
&=\lim_{h\to 0}\frac{(x+h)^2-x^2}{h}
=\lim_{h\to 0}\frac{2xh+h^2}{h}
=\lim_{h\to 0}(2x+h)=2x.
\end{aligned}
$$

### 3.2 $$f(x)=\dfrac{1}{x}$$
$$
\frac{\frac{1}{x+h}-\frac{1}{x}}{h}
=\frac{\frac{x-(x+h)}{x(x+h)}}{h}
=-\frac{1}{x(x+h)}\xrightarrow[h\to 0]{}-\frac{1}{x^2}.
$$

### 3.3 $$f(x)=|x|$$ — 미분 불가 예
$$
f'(0^-)=\lim_{h\to 0^-}\frac{|h|-0}{h}=-1,\quad
f'(0^+)=\lim_{h\to 0^+}\frac{h}{h}=1.
$$
좌·우가 달라 **미분 불가**(뾰족점).

### 3.4 $$f(x)=\sqrt{x}$$ (at $$a>0$$)
켤레 이용:
$$
\frac{\sqrt{x+h}-\sqrt{x}}{h}
=\frac{(\sqrt{x+h}-\sqrt{x})(\sqrt{x+h}+\sqrt{x})}{h(\sqrt{x+h}+\sqrt{x})}
=\frac{1}{\sqrt{x+h}+\sqrt{x}}\xrightarrow[h\to 0]{}\frac{1}{2\sqrt{x}}.
$$

---

## 4. 도함수 존재, 미분 불가능의 유형

- **불연속점**: 미분 불가(연속 필요).
- **뾰족점/모서리**: $$|x|,\,|x|^{2/3}$$ 등.
- **수직 접선**: 기울기 발산(예: $$f(x)=\sqrt[3]{x}$$ at 0 은 미분 가능, 반면 $$f(x)=\sqrt[3]{x^2}$$ 는 0에서 수직 접선).
- **진동**: 극한 불존재(예: $$x\sin(1/x)$$ 의 미분가능성 논점).

---

## 5. 미분의 연산 법칙(증명 스케치 포함)

### 5.1 선형성
$$
(af+bg)'=af'+bg'.
$$
> 정의에 대입하여 분자 선형성으로 바로 증명.

### 5.2 곱의 법칙(Leibniz)
$$
(fg)'=f'g+fg'.
$$
> 차분비 전개:
> $$\frac{f(x+h)g(x+h)-f(x)g(x)}{h}=\frac{[f(x+h)-f(x)]g(x+h)}{h}+f(x)\frac{g(x+h)-g(x)}{h}$$
> 극한 분리 + 연속성.

### 5.3 몫의 법칙
$$
\left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^2}\quad(g\ne 0).
$$
> $$\displaystyle \frac{f}{g}=f\cdot g^{-1}$$ 로 보고 곱·연쇄 적용.

### 5.4 연쇄법칙(Chain Rule)
$$
(f\circ g)'(x)=f'(g(x))\,g'(x).
$$
> 증명 스케치: $$\Delta f\approx f'(g)\Delta g,\ \Delta g\approx g'(x)\Delta x.$$

---

## 6. 표준 함수의 도함수

| 함수 $$f(x)$$ | 도함수 $$f'(x)$$ | 비고 |
|---|---|---|
| $$c$$ | $$0$$ | 상수 |
| $$x^n\ (n\in\mathbb{R})$$ | $$n\,x^{n-1}$$ | 거듭제곱법칙 |
| $$e^x$$ | $$e^x$$ | 자기 자신 |
| $$a^x\ (a>0)$$ | $$a^x\ln a$$ | 체인으로 유도 |
| $$\ln x\ (x>0)$$ | $$1/x$$ | 역함수 규칙으로도 |
| $$\log_a x$$ | $$1/(x\ln a)$$ | 밑변환 |
| $$\sin x$$ | $$\cos x$$ | 라디안 기준 |
| $$\cos x$$ | $$-\sin x$$ | 〃 |
| $$\tan x$$ | $$\sec^2 x$$ | 〃 |
| $$\arcsin x$$ | $$1/\sqrt{1-x^2}$$ | 암시적 미분 |
| $$\arccos x$$ | $$-1/\sqrt{1-x^2}$$ | 〃 |
| $$\arctan x$$ | $$1/(1+x^2)$$ | 〃 |
| $$\sinh x$$ | $$\cosh x$$ | 쌍곡선 |
| $$\cosh x$$ | $$\sinh x$$ | 〃 |

> **라디안 주의**: $$\dfrac{d}{dx}\sin x=\cos x$$ 는 **라디안**일 때만 성립.

---

## 7. 역함수·암시적·로그 미분·매개·극좌표

### 7.1 역함수 미분
$$
y=f^{-1}(x)\ \Rightarrow\ (f^{-1})'(x)=\frac{1}{f'(f^{-1}(x))}\quad(f'\ne 0).
$$
**예**: $$y=\ln x$$ 는 $$x=e^y$$ 의 역 ⇒ $$\dfrac{d}{dx}\ln x=\dfrac{1}{x}.$$

### 7.2 암시적 미분
**예**: 원 $$x^2+y^2=1$$ 에서 $$\dfrac{dy}{dx}$$
양변 미분:
$$
2x+2y\,\frac{dy}{dx}=0\ \Rightarrow\ \frac{dy}{dx}=-\frac{x}{y}.
$$

### 7.3 로그 미분(곱/멱/지수의 복잡한 조합)
**예**: $$y=x^x\ (x>0)$$
$$
\ln y=x\ln x\ \Rightarrow\ \frac{y'}{y}=\ln x+1\ \Rightarrow\ y'=x^x(\ln x+1).
$$

### 7.4 매개변수 곡선
$$
x=x(t),\ y=y(t)\ \Rightarrow\ \frac{dy}{dx}=\frac{dy/dt}{dx/dt}\quad(dx/dt\ne 0).
$$
**예**: 원 $$x=\cos t,\ y=\sin t$$ ⇒ $$\displaystyle \frac{dy}{dx}=\frac{\cos t}{-\sin t}=-\cot t.$$

### 7.5 극좌표 $$r=f(\theta)$$
$$
x=r\cos\theta,\ y=r\sin\theta,\quad
\frac{dy}{dx}=\frac{dy/d\theta}{dx/d\theta}.
$$

---

## 8. 선형화, 접선·법선, 오차·민감도

### 8.1 선형 근사(1차 테일러)
$$
f(x)\approx f(a)+f'(a)(x-a).
$$
- **근사 오차**:
  $$f(x)=f(a)+f'(a)(x-a)+\frac{f''(\xi)}{2}(x-a)^2\quad(\xi\ \text{중간값}).$$

### 8.2 차분과 오차 전파
- 미세 변화 $$dx$$ 에 대한 출력 변화 **미분(차분)**:
  $$df\approx f'(x)\,dx.$$
- 불확실성 $$\Delta x$$ 가 출력에 주는 1차 영향: $$\Delta f\approx f'(x)\,\Delta x.$$

---

## 9. 평균값정리(MVT)와 1·2차 판정, 곡률

### 9.1 롤·평균값정리
- **롤 정리**: $$f(a)=f(b)$$, 연속(닫힌구간)/미분가능(열린구간) ⇒ $$\exists c:\ f'(c)=0.$$
- **평균값정리**: $$\exists c:\ f'(c)=\dfrac{f(b)-f(a)}{b-a}.$$

### 9.2 증감·극값(1차 판정)
- $$f'(x)>0$$(증가), $$<0$$(감소).
- 점 $$a$$ 에서 $$f'(a)=0$$ 이고 부호가 **+\(\to\)-** 이면 **극대**, **-\(\to\)+** 이면 **극소**.

### 9.3 오목/볼록·변곡(2차 판정)
- $$f''(x)>0$$: 위로 볼록(오목↑), $$f''(x)<0$$: 아래로 오목(볼록↓).
- $$f''(a)=0$$ 이고 볼록성 바뀌면 **변곡점**.

### 9.4 곡률
그래프 $$y=f(x)$$ 의 곡률:
$$
\kappa(x)=\frac{|f''(x)|}{\big(1+f'(x)^2\big)^{3/2}}.
$$

---

## 10. 수치미분(현업 팁)

### 10.1 전진/후진/중앙 차분
- 전진: $$\displaystyle \frac{f(x+h)-f(x)}{h}=\ f'(x)+O(h).$$
- **중앙**: $$\displaystyle \frac{f(x+h)-f(x-h)}{2h}=\ f'(x)+O(h^2)$$ ← 권장.

### 10.2 반올림 vs 절단 오차
- 너무 작은 $$h$$ 는 **부동소수점 반올림**을 키움, 너무 큰 $$h$$ 는 **절단오차** 큼 → **적정 $$h$$** 필요.

### 10.3 단위/스케일
- 입력 스케일을 바꾸면 도함수의 단위/수치가 변함(민감도 해석 시 주의).

---

## 11. 파이썬 시각화/계산 예제

### 11.1 함수·도함수 그래프 겹쳐 보기 (예: $$x^2$$ vs $$2x$$)
```python
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-3, 3, 400)
fx = x**2
fpx = 2*x

plt.plot(x, fx, label='f(x)=x^2')
plt.plot(x, fpx, linestyle='--', label="f'(x)=2x")
plt.axhline(0, linestyle=':')
plt.legend(); plt.grid(True); plt.title('함수와 도함수'); plt.show()
```

### 11.2 접선과 할선(정의의 직관)
```python
import numpy as np
import matplotlib.pyplot as plt

def f(x): return np.sin(x) + 0.2*x
a = 0.7
def secant_slope(h): return (f(a+h)-f(a))/h

x = np.linspace(a-2, a+2, 400)
plt.plot(x, f(x), label='f(x)')
for h in [1.0, 0.5, 0.2, 0.05]:
    m = secant_slope(h)
    y_tan = f(a) + m*(x-a)
    plt.plot(x, y_tan, label=f'h={h}')
plt.scatter([a],[f(a)], zorder=5)
plt.legend(); plt.grid(True); plt.title('할선 기울기 → 접선 기울기'); plt.show()
```

### 11.3 수치미분 정확도 비교
```python
import numpy as np

def f(x): return np.exp(x)
def fp(x): return np.exp(x)

x0 = 1.0
for h in [1e-1, 1e-2, 1e-3, 1e-4, 1e-5]:
    forward = (f(x0+h)-f(x0))/h
    central = (f(x0+h)-f(x0-h))/(2*h)
    print(h, abs(forward-fp(x0)), abs(central-fp(x0)))
```

---

## 12. 자주 하는 실수/오해

- **라디안 미사용**: 삼각함수 미분 공식은 라디안에서만 성립.
- **정의역 점검 누락**: 로그/루트/분수형에서 정의역·분모 0 주의.
- **연속성 과신**: 연속이라 해서 항상 미분 가능은 아님(뾰족점).
- **조각함수**: 접합점에서 **좌·우 도함수 동일**해야 미분 가능.
- **합성/역함수**: 연쇄법칙, 역함수 미분공식의 **조건(단사/미분가능/도함수 0 아님)** 확인.

---

## 13. 대형 예제 세트(풀이 자세)

### 예제 1) 곱·합성 혼합
$$
f(x)=x^2\sin(3x-\tfrac{\pi}{6})
$$
**풀이**: 곱+연쇄
$$
f'(x)=2x\sin(3x-\tfrac{\pi}{6})+x^2\cos(3x-\tfrac{\pi}{6})\cdot 3.
$$

### 예제 2) 몫 + 로그
$$
f(x)=\frac{\ln x}{x}\ (x>0)
$$
$$
f'(x)=\frac{(1/x)\cdot x-\ln x\cdot 1}{x^2}=\frac{1-\ln x}{x^2}.
$$

### 예제 3) 로그 미분 — 곱의 거듭제곱
$$
y=\frac{(x^2+1)^5\sqrt{x}}{e^{3x}(x-1)^2}\quad(x>0,\,x\ne 1)
$$
로그 미분:
$$
\ln y=5\ln(x^2+1)+\tfrac{1}{2}\ln x-3x-2\ln(x-1),
$$
미분 후 곱하기 $$y$$:
$$
\frac{y'}{y}=\frac{10x}{x^2+1}+\frac{1}{2x}-3-\frac{2}{x-1}
\ \Rightarrow\
y'=y\left(\frac{10x}{x^2+1}+\frac{1}{2x}-3-\frac{2}{x-1}\right).
$$

### 예제 4) 암시적 — 타원 접선기울기
$$
\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\ \Rightarrow\ \frac{2x}{a^2}+\frac{2y}{b^2}y'=0
\ \Rightarrow\
y'=-\frac{b^2}{a^2}\frac{x}{y}.
$$

### 예제 5) 역삼각함수 도함수 유도
$$
y=\arcsin x\ \Rightarrow\ \sin y=x,\ \cos y\cdot y'=1\ \Rightarrow\ y'=\frac{1}{\cos y}=\frac{1}{\sqrt{1-x^2}}.
$$

### 예제 6) 매개 — 싸이클로이드 접선
$$
x=t-\sin t,\quad y=1-\cos t
$$
$$
\frac{dy}{dx}=\frac{dy/dt}{dx/dt}=\frac{\sin t}{1-\cos t}=\cot\frac{t}{2}.
$$

### 예제 7) 극값·변곡·곡률
$$
f(x)=x^3-3x
$$
$$
f'=3x^2-3=3(x-1)(x+1),\quad f''=6x.
$$
- 임계점: $$x=\pm 1$$. 부호변화로 $$x=-1$$ 극대, $$x=1$$ 극소.
- 변곡: $$f''=0\Rightarrow x=0$$(볼록성 변화).
- 곡률: $$\displaystyle \kappa=\frac{|6x|}{(1+(3x^2-3)^2)^{3/2}}.$$

### 예제 8) 접선·법선 방정식
$$
f(x)=\ln x,\ a=1:
$$
$$
f'(x)=1/x,\ f(1)=0,\ f'(1)=1.
$$
- 접선: $$y=0+1\cdot(x-1)=x-1.$$
- 법선: $$y=0-1\cdot(x-1)=-(x-1).$$

---

## 14. 연습문제 (풀이 아이디어 포함)

1) $$\displaystyle f(x)=\sqrt{1+3x}\ \Rightarrow\ f'(x)=?$$
   *힌트*: 체인.

2) $$\displaystyle y=\arctan\!\big(\sqrt{x}\big)\ (x>0)\ \Rightarrow\ y'=?$$
   *힌트*: 연쇄 2번.

3) $$\displaystyle y=\frac{(x-2)^3}{(x+1)^2}\ \Rightarrow\ y'=?$$
   *힌트*: 몫+곱.

4) $$\displaystyle x^2+xy+y^2=3,\ \frac{dy}{dx}=?$$
   *힌트*: 암시적.

5) $$\displaystyle y=x^x\ (x>0),\ y'=?$$
   *힌트*: 로그 미분.

6) $$\displaystyle x=\cos t,\ y=\cos(2t)\ \Rightarrow\ \frac{dy}{dx}=?$$
   *힌트*: 매개.

7) $$\displaystyle f(x)=|x-1|^3,\ f'(1)\ ?$$
   *힌트*: 좌·우 미분 또는 다항 전개.

8) $$\displaystyle f(x)=\sin x+\tfrac{x}{10},\ a=\pi\ $$에서 접선 방정식?
   *힌트*: 값/기울기 대입.

9) $$\displaystyle f(x)=\ln(\sin x),\ \text{정의역? 도함수?}$$
   *힌트*: 조심: $$\sin x>0.$$

10) **수치미분**: $$f(x)=e^{-x^2}$$, $$x_0=0.5$$ 에서 전진/중앙차분 오류 비교(코드 작성).
    *힌트*: §11.3.

---

## 15. 대표 풀이 스케치

1) $$f'(x)=\dfrac{3}{2}(1+3x)^{-1/2}.$$
2) $$y'=\dfrac{1}{1+(\sqrt{x})^2}\cdot \dfrac{1}{2\sqrt{x}}=\dfrac{1}{2\sqrt{x}(1+x)}.$$
3) 몫의 법칙으로 전개:
   $$y'=\frac{3(x-2)^2(x+1)^2-(x-2)^3\cdot 2(x+1)}{(x+1)^4}.$$
4)
   $$2x+y+x\,y'+2y\,y'=0\ \Rightarrow\ y'=-\frac{2x+y}{x+2y}.$$
5) $$y'=x^x(\ln x+1).$$
6)
   $$\frac{dy}{dx}=\frac{dy/dt}{dx/dt}=\frac{-2\sin(2t)}{-\sin t}=2\cos t.$$
7) $$|x-1|^3$$ 은 매끄럽고 $$f'(x)=3|x-1|^2\cdot \operatorname{sgn}(x-1)$$,
   $$f'(1)=0$$(좌우 모두 0).
8) $$f(\pi)=0+\tfrac{\pi}{10},\ f'(\pi)=\cos\pi+\tfrac{1}{10}=-1+\tfrac{1}{10}=-\tfrac{9}{10}.$$
   접선: $$y=\tfrac{\pi}{10}-\tfrac{9}{10}(x-\pi).$$
9) 정의역: $$x\in(0,\pi)$$ 등(일반적으로 $$\sin x>0$$ 인 구간).
   $$f'(x)=\dfrac{\cos x}{\sin x}=\cot x.$$
10) 코드로 출력되는 **절대오차**를 비교해 중앙차분이 $$O(h^2)$$ 임을 확인.

---

## 16. 요약표 — 공식 & 패턴

### 16.1 미분 법칙
- 선형: $$(af+bg)'=af'+bg'$$
- 곱: $$(fg)'=f'g+fg'$$
- 몫: $$\left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^2}$$
- 연쇄: $$(f\circ g)'=f'(g)\,g'$$

### 16.2 자주 쓰는 패턴
- **로그 미분**: 곱/멱/지수의 복잡한 조합 간단화
- **암시적**: 방정식형에서 $$y'$$ 직접 구하기
- **매개**: $$\dfrac{dy}{dx}=\dfrac{y'}{x'}$$
- **선형화**: $$f(x)\approx f(a)+f'(a)(x-a)$$
- **곡률**: $$\kappa=\dfrac{|f''|}{(1+f'^2)^{3/2}}$$

---

## 17. 마무리

- 도함수는 “**순간 변화율 = 접선 기울기**”을 **함수**로 담아낸 개념입니다.
- 정의(차분비의 극한)에서 출발해 **연산 법칙/표준함수/역·암시적/로그미분/매개**로 확장하면 대부분의 실전 계산이 해결됩니다.
- **선형화·평균값정리·1/2차 판정·곡률**을 통해 그래프의 큰 윤곽(증감/극값/오목볼록/굽음)을 빠르게 파악할 수 있습니다.
- 실무/수치에서는 **중앙차분**과 **단위/스케일**에 특히 유의하세요.
