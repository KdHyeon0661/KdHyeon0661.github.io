---
layout: post
title: 미적분 - 중적분과 변수변환
date: 2025-08-12 23:20:23 +0900
category: 미적분
---
# 중적분과 변수변환(변수 치환)

핵심은 다음 네 가지다:

1. **정리(변수변환 공식)**: 변환 \(T:(u,v)\mapsto (x(u,v),y(u,v))\) 이 적당히 “좋으면”,
   \[
   \iint_{D} f(x,y)\,dx\,dy
   = \iint_{D^*} f\big(x(u,v),y(u,v)\big)\,\big|J_T(u,v)\big|\,du\,dv,
   \]
   여기서 \(J_T=\det\begin{pmatrix}x_u&x_v\\y_u&y_v\end{pmatrix}\) (2D 야코비안).

2. **영역 매핑**: \(D=T(D^*)\) 가 되도록 **경계/범위를 정확히 매핑**한다.

3. **좌표변환 패턴**: 극좌표(원·원반), 선형변환(평행사변형·타원), “쐐기/사각형→사다리꼴”류 변환 등 **형태-맞춤**.

4. **조건/함정**: 일대일(거의 전역), \(C^1\) 매끄러움, \(|J|\) 절댓값, 분할 필요(조각별 변환), 부호·방향.

---

## 2D 변수변환 정리(공식) — 증명 스케치와 해석

### 공식(2차원)

\(T:(u,v)\mapsto (x(u,v),y(u,v))\) 가 \(C^1\), 야코비안 \(J_T(u,v)\neq 0\) 이고, \(T\) 가 \(D^*\subset\mathbb{R}^2\) 를 **일대일(거의)** 로 \(D=T(D^*)\) 에 위상동형으로 매핑한다면
$$
\iint_{D} f(x,y)\,dx\,dy
=\iint_{D^*} f\!\big(x(u,v),y(u,v)\big)\,\big|\det\frac{\partial(x,y)}{\partial(u,v)}\big|\ du\,dv.
$$
- **해석**: 미소영역 \(dA\) 가 변환에서 **면적 스케일** \(|J_T|\) 만큼 늘어나거나 줄어든다.
- **절댓값** 이유: 방향(orientation) 반전 시 부호 보정.

### 증명 스케치

- 사각 격자 \(\Delta u\,\Delta v\) 를 매핑하면 **평행사변형** 면적 \(|J_T|\Delta u\Delta v\) 로 근사.
- 다중합→극한(Fubini/Tonelli)→적분으로 이행.

### 3D 일반화

\((u,v,w)\mapsto(x,y,z)\) 에서
\[
\iiint_E f(x,y,z)\,dV=\iiint_{E^*} f\circ T\ \big|\det\frac{\partial(x,y,z)}{\partial(u,v,w)}\big|\,du\,dv\,dw.
\]
(삼중적분 글에서 자세히 다룸.)

---

## 표준 좌표변환

### 극좌표(Polar)

\[
x=r\cos\theta,\quad y=r\sin\theta,\quad r\ge 0,\ \theta\in\mathbb{R},\qquad
dx\,dy = r\,dr\,d\theta.
\]
- **영역**: 원/부채꼴/원환영역에 최적.
- **함수**: \(f(x,y)=g(x^2+y^2)=g(r^2)\) 류에 최적.

#### 예제 2.1A — 단위원에서의 적분

\[
\iint_{x^2+y^2\le 1} (x^2+y^2)\,dx\,dy
=\int_{\theta=0}^{2\pi}\!\int_{r=0}^{1} (r^2)\,r\,dr\,d\theta
=2\pi\cdot\frac{1}{4}
=\frac{\pi}{2}.
\]

#### 예제 2.1B — 가우시안 2D

\[
\iint_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dx\,dy
=\int_0^{2\pi}\int_0^\infty e^{-r^2}\,r\,dr\,d\theta
=2\pi\cdot\frac{1}{2}=\pi.
\]

### 선형변환(타원·평행사변형)

\[
\begin{pmatrix}x\\y\end{pmatrix}
=
A\begin{pmatrix}u\\v\end{pmatrix}
+\begin{pmatrix}x_0\\y_0\end{pmatrix},\quad
|J_T|=|\det A|.
\]
- **타원체/타원**: 축척·회전으로 단위 원판/원으로 매핑.
- **평행사변형**: 단위 사각형 매핑으로 단순화.

#### 예제 2.2A — 평행사변형 면적

꼭짓점 \(\mathbf{a},\mathbf{a}+\mathbf{v}_1,\mathbf{a}+\mathbf{v}_2,\mathbf{a}+\mathbf{v}_1+\mathbf{v}_2\).
변환 \(x=\mathbf{a}_x+\alpha v_{1x}+\beta v_{2x}\), \(y=\mathbf{a}_y+\alpha v_{1y}+\beta v_{2y}\) \((0\le\alpha,\beta\le 1)\).
면적 \(=\big|\det[v_1\ v_2]\big|\).

#### 예제 2.2B — 타원 영역 적분

\[
\frac{x^2}{a^2}+\frac{y^2}{b^2}\le 1,\quad f(x,y)=1.
\]
치환 \(x=au, y=bv\Rightarrow u^2+v^2\le 1,\ |J|=ab\).
\[
\text{Area}=\iint_{u^2+v^2\le 1} ab\,du\,dv = ab\pi.
\]

### 직교 곡선좌표의 대표: 원통/구면(3D 확장)

- 원통: \(x=r\cos\theta,y=r\sin\theta,z=z\), \(dV=r\,dr\,d\theta\,dz\).
- 구면: \(x=\rho\sin\phi\cos\theta,\ y=\rho\sin\phi\sin\theta,\ z=\rho\cos\phi\), \(dV=\rho^2\sin\phi\,d\rho\,d\phi\,d\theta\).
(삼중적분 글 참조)

---

## 일반(비선형) 변수변환 — 패턴과 설계

### 사다리꼴형/쐐기형

경계가 \(x+y=\text{상수}\) 같은 직선(합·차 형태)일 때
\[
u=x+y,\quad v=x-y\quad(\text{또는 }u=x,\ v=x+y\ \text{등})
\]
로 직사각형으로 만드는 전략.

#### 예제 3.1A — 마름모 영역 \(|x|+|y|\le 1\) 의 면적

4영역으로 분할하거나, 변환 \(u=x+y,\ v=x-y\Rightarrow |x|+|y|\le 1\ \Leftrightarrow |u|\le 1, |v|\le 1\) (조심: 이 변환은 회전·스케일).
\(x=\frac{u+v}{2}, y=\frac{u-v}{2}\Rightarrow J=\det\begin{pmatrix}1/2&1/2\\1/2&-1/2\end{pmatrix}=-1/2\Rightarrow |J|=1/2\).
\[
\text{Area}=\iint_{|u|\le 1,\ |v|\le 1} \frac{1}{2}\,du\,dv=\frac{1}{2}\cdot 2\cdot 2=2.
\]
(기대값과 일치: 마름모의 대각선 길이 2,2 → 면적 \(=2\).)

#### 예제 3.1B — 선형 경계가 섞인 영역의 적분

영역 \(D=\{(x,y)\mid 0\le x\le 1,\ x\le y\le 2x\}\).
치환 \(u=x,\ v=y/x\Rightarrow y=uv,\ (x>0)\).
야코비안 \(J=\det\begin{pmatrix}x_u&x_v\\y_u&y_v\end{pmatrix}
=\det\begin{pmatrix}1&0\\ v&u\end{pmatrix}=u\Rightarrow |J|=u\).
영역: \(0\le u\le 1,\ 1\le v\le 2\).
\[
\iint_D f(x,y)\,dx\,dy
= \int_{u=0}^{1}\int_{v=1}^{2} f(u,uv)\,u\,dv\,du.
\]
(적절한 \(f\) 에 적용. 예: \(f\equiv 1\) 이면 면적 \(=\int_0^1\int_1^2 u\,dv\,du=\int_0^1 u\,du=1/2\).)

### 곡선 경계(포물선 등)

경계가 \(y=x^2\), \(y=2x^2\) 식이면
\[
u=y/x^2,\quad v=x \quad(\text{또는 }u=y,\ v=x^2)
\]
같은 비율형 변환으로 “직사각형”화 가능.

#### 예제 3.2A — 두 포물선 사이

\(D=\{(x,y)\mid 0\le x\le 1,\ x^2\le y\le 2x^2\}\).
치환 \(u=y/x^2\Rightarrow y=ux^2,\ v=x\).
야코비안
\[
J=\det\begin{pmatrix}x_u&x_v\\y_u&y_v\end{pmatrix}
=\det\begin{pmatrix}0&1\\ v^2&2uv\end{pmatrix}=-v^2 \Rightarrow |J|=v^2.
\]
영역: \(1\le u\le 2,\ 0\le v\le 1\).
\[
\iint_D f\,dx\,dy
=\int_{u=1}^{2}\int_{v=0}^{1} f(v,uv^2)\, v^2\,dv\,du.
\]

---

## 절차(Recipe) — 문제를 보면 이렇게 푼다

1. **영역 스케치**: 꼭짓점/경계식을 그리고, 어느 축으로 “단순”한지 본다.
2. **패턴 매칭**: 원형(극좌표), 타원/평행사변형(선형), 직선합/차(합·차 변환), 포물선 비율형 등.
3. **변환 설계**: \(u=\phi(x,y)\), \(v=\psi(x,y)\) 또는 그 역 \(x=x(u,v), y=y(u,v)\) 를 잡고 **야코비안** 계산.
4. **영역 매핑**: 경계식을 \(u,v\) 로 바꾸고 **직사각형/단순 영역**을 얻는다(필요 시 분할).
5. **적분식 변환**: \(f(x,y)\mapsto f(x(u,v),y(u,v))\), \(dx\,dy=|J|\,du\,dv\).
6. **적분 및 역검증**: 결과 수치검증(심볼릭/수치), 단위·극한 체크.

---

## 예제 종합

### 회전된 타원 적분(선형+극좌표 결합)

**문제**
회전타원
\[
\frac{(x\cos\alpha+y\sin\alpha)^2}{a^2}
+\frac{(-x\sin\alpha+y\cos\alpha)^2}{b^2}\le 1
\]
에서 \(\iint_D 1\,dx\,dy\) (면적).

**해법**
회전좌표 \((X,Y)=R(\alpha)^\top (x,y)\) 로 두면 위는 \(X^2/a^2+Y^2/b^2\le 1\).
다시 \(X=a u,\ Y=b v\Rightarrow u^2+v^2\le 1\).
전체 선형변환의 야코비안은 \(|\det(R) \cdot \det(\text{diag}(a,b))| = ab\).
따라서 면적
\[
\iint_D 1\,dx\,dy
=ab \iint_{u^2+v^2\le 1} 1\,du\,dv
=ab\pi.
\]
(회전에 면적 불변: \(|\det R|=1\).)

### 사선 경계 적분(합·차 변환)

**문제**
\(D=\{(x,y)\mid 0\le x\le 1,\ x\le y\le x+1\}\) 에서 \(\iint_D (x+2y)\,dx\,dy\).

**치환**
\(u=y-x\) (수평 띠), \(v=x\).
역: \(x=v,\ y=u+v\).
야코비안 \(J=\det\begin{pmatrix}x_u&x_v\\y_u&y_v\end{pmatrix}=\det\begin{pmatrix}0&1\\1&1\end{pmatrix}=-1\Rightarrow |J|=1\).
영역: \(0\le v\le 1,\ 0\le u\le 1\) (직사각형).
적분:
\[
\iint_D (x+2y)\,dx\,dy
=\int_{v=0}^{1}\int_{u=0}^{1} (v+2(u+v))\cdot 1\,du\,dv
=\int_0^1\int_0^1 (2u+3v)\,du\,dv
\]
\[
=\int_0^1 \left[u^2+3uv\right]_{0}^{1} dv
=\int_0^1 (1+3v)\,dv
=1+\frac{3}{2}
=\frac{5}{2}.
\]

### 극좌표로 부채꼴 적분

**문제**
\(D=\{(x,y)\mid 0\le r\le 2,\ \frac{\pi}{6}\le \theta\le \frac{\pi}{3}\}\) 에서 \(\iint_D (x^2+y^2)\,dx\,dy\).

**극좌표**
\(x^2+y^2=r^2\), \(dx\,dy=r\,dr\,d\theta\).
\[
\int_{\theta=\pi/6}^{\pi/3}\int_{r=0}^{2} r^2\cdot r\,dr\,d\theta
=\left(\int_{\pi/6}^{\pi/3} d\theta\right)\cdot \left[\frac{r^4}{4}\right]_{0}^{2}
=\Big(\frac{\pi}{3}-\frac{\pi}{6}\Big)\cdot 4
=\frac{\pi}{6}\cdot 4
=\frac{2\pi}{3}.
\]

### 포물선 두 개 사이의 적분(비선형)

**문제**
\(D=\{(x,y)\mid 0\le x\le 1,\ x^2\le y\le 3x^2\}\) 에서 \(\iint_D y\,dx\,dy\).

**치환**
\(u=y/x^2\Rightarrow y=ux^2,\ v=x\), \(J=-v^2\Rightarrow |J|=v^2\).
영역: \(1\le u\le 3,\ 0\le v\le 1\).
\[
\iint_D y\,dx\,dy
=\int_{u=1}^{3}\int_{v=0}^{1} (uv^2)\cdot v^2\,dv\,du
=\int_1^3 u\,du \cdot \int_0^1 v^4\,dv
=\frac{(3^2-1^2)}{2}\cdot\frac{1}{5}
=\frac{8}{10}
=\frac{4}{5}.
\]

---

## 조건·정밀도: 언제 “써도 되는가”

- **정칙성**: \(T\) 가 \(C^1\) (편도함수 연속) 이고, 야코비안 \(J_T\neq 0\) (거의 모든 점)이어야 한다.
- **일대일성**: \(D^*\) 의 거의 모든 점을 \(D\) 로 **한 번만** 매핑. 불가능하면 **분할**하여 조각별로 일대일 변환.
- **경계관리**: 경계가 복잡하면 이미지/원영역에 대해 **각각 범위**를 명확히 산정.
- **절댓값**: \(dx\,dy=|J|\,du\,dv\). 방향 뒤집힘을 절댓값으로 보정.
- **비정상적분**: 무한영역/특이점 있으면 **극한 정의** 및 수렴성 확인.

---

## 자주 하는 실수 체크리스트

- □ \(J_T\) 를 **계산하고 절댓값**을 붙였는가?
- □ 영역의 **범위 변환**을 정확히 했는가(특히 \(\theta\) 범위, \(r\) 하한/상한)?
- □ **일대일**인가? 아니라면 영역을 **분할**했는가?
- □ 선형변환은 \(|\det A|\) 로 면적 스케일이 변한다는 점을 썼는가?
- □ “원형 ↔ 극좌표”, “타원 ↔ 선형스케일”, “합/차 경계 ↔ \(u=x\pm y\)” 를 떠올렸는가?

---

## SymPy·NumPy 코드 — 야코비안·적분 검증

```python
import sympy as sp
import numpy as np

# ----- 1) 극좌표 야코비안 검증 -----

r, th = sp.symbols('r th', positive=True)
x = r*sp.cos(th)
y = r*sp.sin(th)
J = sp.Matrix([[sp.diff(x, r), sp.diff(x, th)],
               [sp.diff(y, r), sp.diff(y, th)]]).det()
print("polar Jacobian:", sp.simplify(J))   # r

# ∫_{unit disk} (x^2+y^2) dxdy = π/2

expr = (x**2 + y**2) * sp.Abs(J)
res = sp.integrate(sp.integrate(expr, (r, 0, 1)), (th, 0, 2*sp.pi))
print("∫(x^2+y^2) over unit disk =", sp.simplify(res))  # pi/2

# ----- 2) 선형변환으로 타원 면적 abπ -----

a, b = sp.symbols('a b', positive=True)
u, v = sp.symbols('u v', real=True)
X = a*u
Y = b*v
J_lin = sp.Matrix([[sp.diff(X, u), sp.diff(X, v)],
                   [sp.diff(Y, u), sp.diff(Y, v)]]).det()
area_unit_disk = sp.integrate(sp.integrate(sp.Abs(J_lin), (u, -1, 1)), (v, -sp.sqrt(1-u**2), sp.sqrt(1-u**2)))
# 위 줄은 직교 좌표로 쓰면 복잡하므로, 극좌표로 바꾸는 게 보통 더 좋다. 여기선 참고만.

# 타원 면적은 직결로 ab * area(unit disk) = abπ

print("Elliptic area (symbolic reasoning):", sp.simplify(a*b*sp.pi))

# ----- 3) 합/차 변환 u=y-x, v=x 의 야코비안 -----

u, v = sp.symbols('u v', real=True)
# 역치환: x=v, y=u+v

x_uv = v
y_uv = u + v
J_u = sp.Matrix([[sp.diff(x_uv, u), sp.diff(x_uv, v)],
                 [sp.diff(y_uv, u), sp.diff(y_uv, v)]]).det()
print("u=y-x, v=x  inverse Jacobian:", sp.simplify(J_u))  # -1

# ----- 4) 간단한 몬테카를로 검증: unit disk에서 ∫(x^2+y^2) dxdy ≈ π/2 -----

def mc_unit_disk_integral(n=200000, seed=0):
    rng = np.random.default_rng(seed)
    # 폴라 샘플링: r ~ sqrt(U), theta ~ U[0,2π)
    U = rng.random(n)
    r = np.sqrt(U)
    th = 2*np.pi*rng.random(n)
    x = r*np.cos(th)
    y = r*np.sin(th)
    vals = x**2 + y**2
    # 폴라 균등 샘플링이면 면적 요소는 이미 반영되어 평균이 면적 평균(=∫f/Area)
    # ∫f = Area * E[f]  with Area = π*1^2
    return np.pi * np.mean(vals)

print("MC approx of ∫(x^2+y^2) over unit disk:", mc_unit_disk_integral(), " exact:", np.pi/2)
```

**설명**
- 극좌표 야코비안 \(=r\) 를 확인.
- 단위원 적분 \(\iint (x^2+y^2)=\pi/2\) 를 심볼릭·몬테카를로로 검증.
- 선형변환의 면적 스케일이 \(|\det A|\) 임을 코드로(간접적) 확인.

---

## 비정상(Improper) 적분에서의 변수변환

무한 영역 또는 특이점이 있을 때도, 수렴만 보장되면 동일하게 적용:
- \(\mathbb{R}^2\) 전체 적분: 극좌표로 무한반경 \([0,\infty)\) 로 변환.
- 절차는 같고, **극한**과 **수렴성** 확인이 추가될 뿐.

#### 예제 9A — 2D 가우스 적분

이미 2.1B에서 \(\pi\) 로 계산.

---

## 요약 표(붙여두기)

| 상황/경계 | 권장 변환 | 야코비안 | 메모 |
|---|---|---|---|
| 원/원반/부채꼴 | \(x=r\cos\theta,y=r\sin\theta\) | \(r\) | \(r\ge 0\), 각도 범위 주의 |
| 타원 | \(x=au,y=bv\) (+회전) | \(ab\) | 회전은 \(|\det R|=1\) |
| 평행사변형 | 선형 \(x= a_0 + \alpha v_{1x}+\beta v_{2x}\), … | \(|\det[v_1\ v_2]|\) | 단위사각형 → 원영역 |
| 합/차 경계 | \(u=x\pm y\) | \(|\det|\) 계산 | 사다리꼴·쐐기형 직사각형화 |
| 포물선 다발 | \(u=y/x^2\) 등 | 식별 후 계산 | 비율형으로 직사각형화 |

---

## 연습문제(해설 스케치)

1) \(\displaystyle \iint_{x^2+y^2\le R^2} (x^2+y^2)^k\,dx\,dy\).
   → 극좌표: \(\int_0^{2\pi}\int_0^R r^{2k} r\,dr\,d\theta = 2\pi \frac{R^{2k+2}}{2k+2}\).

2) \(D=\{0\le x\le 2,\ x\le y\le x+2\}\) 에서 \(\iint_D \frac{1}{1+x+y}\,dx\,dy\).
   → \(u=y-x, v=x\) 로 직사각형: \(0\le v\le 2,\ 0\le u\le 2\). integrand \(\to \frac{1}{1+u+2v}\).
   적분은 \(\int_0^2\int_0^2 \frac{1}{1+u+2v}\,du\,dv\).

3) \(D=\{0\le x\le 1,\ x^2\le y\le 4x^2\}\) 에서 \(\iint_D \sqrt{y}\,dx\,dy\).
   → \(u=y/x^2,\ v=x\Rightarrow y=uv^2,\ |J|=v^2\).
   적분: \(\int_{u=1}^{4}\int_{v=0}^{1} \sqrt{uv^2}\, v^2\,dv\,du\).

4) 타원 \(\dfrac{x^2}{9}+\dfrac{y^2}{4}\le 1\) 에서 \(\iint_D (x^2+y^2)\,dx\,dy\).
   → \(x=3u,y=2v\Rightarrow |J|=6\). integrand \(\to 9u^2+4v^2\).
   단위원(uv-plane)에서 극좌표로 마무리.

5) 마름모 \(|x|+|y|\le a\) 에서 \(\iint_D 1\,dx\,dy\).
   → 3.1A 변형으로 \(2a^2\) (스케일링: \(a\) 배).

---

## 마무리

중적분에서 변수변환은 **영역을 단순화**하고, **함수 모양을 간결화**하는 가장 강력한 도구다.
문제를 보면 즉시,
- “원/부채꼴이면 **극좌표**”,
- “타원이면 **선형+극좌표**”,
- “합/차 경계면 **\(u=x\pm y\)**”,
- “포물선 다발이면 **비율형**”
이 떠오르도록 연습하자.
그리고 **야코비안의 절댓값**, **영역 매핑의 정확성**, **조각분할**을 반드시 점검하라.
