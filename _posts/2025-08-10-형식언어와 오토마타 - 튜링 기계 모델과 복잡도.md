---
layout: post
title: 형식언어와 오토마타 - 튜링 기계 모델과 복잡도
date: 2025-08-10 20:20:23 +0900
category: 형식언어와 오토마타
---
# 튜링 기계 모델과 복잡도

## 표준 튜링 기계: 언어 인식기 관점

### 형식 정의

$$
M=(Q,\Sigma,\Gamma,\delta,q_0,q_{\mathrm{acc}},q_{\mathrm{rej}}).
$$

- 상태 집합 $$Q$$, 입력 알파벳 $$\Sigma$$, 테이프 알파벳 $$\Gamma\ (\Sigma\subseteq\Gamma,\ \sqcup\in\Gamma)$$
- 전이 함수(결정적) $$\delta:Q\times\Gamma\to Q\times\Gamma\times\{L,R,S\}$$
- 시작 상태 $$q_0$$, 수용/거절 상태 $$q_{\mathrm{acc}},q_{\mathrm{rej}}$$
- **구성(configuration)**: “테이프 내용·헤드 위치·상태”의 삼중. 한 번의 전이가 **한 단계(step)**.

> 비결정적 TM(NTM)은 $$\delta$$가 유한 집합 값을 낸다. 수용은 **어떤** 연산 경로라도 수용에 도달하면 참.

### 승인기(인식기) vs 변환기(Transducer)

- **언어 승인기**: 입력 $$w$$에 대해 수용/거절로 종료, 인식 언어 $$L(M)=\{w\mid M \text{ 수용}\}$$.
- **변환기**: 출력 트랙(또는 출력 테이프)에 결과를 쓴다(함수 계산).

### 소형 예시 — 단항 덧셈과 팔린드롬

#### (a) 단항 덧셈 $$a^m\#a^n \mapsto a^{m+n}$$ (Transducer)

아이디어: 왼쪽 블록의 $$a$$ 하나를 지워 오른쪽 끝에 $$a$$를 추가, 더 이상 없으면 `#` 삭제 후 정지.

```text
상태: q0(스캔→#), qMove(오른쪽 끝 찾기), qBack(#로 복귀), qDone
심볼: a, #, ␣(공백)
전이(개략):
(q0,  a) -> (q0,  a, R)           # 왼쪽 a 덩어리 스킵
(q0,  #) -> (qMove, #, R)         # # 통과
(qMove,a) -> (qMove,a, R)         # 오른쪽 블록 끝으로
(qMove,␣) -> (qBack, a,  L)       # 맨 끝에 a 추가
(qBack, a) -> (qBack, a, L)
(qBack, #) -> (q0,    #, L)       # 다시 왼쪽으로
(q0,  ␣) -> (qDone, ␣, S)         # 왼쪽 블록이 비면
(qDone,#) -> (qDone, ␣, S)        # # 지우고 정지
```

#### (b) 이진 팔린드롬 인식 $$L=\{ww^R\mid w\in\{0,1\}^*\}$$

양 끝 문자를 교차 확인하며 표시(예: `x`)로 마킹해가며 중앙으로 수렴.

```text
전략:
1) 왼쪽에서 첫 미표시 심볼(0/1)을 잡아 x로 바꾸고, 같은 심볼을 오른쪽 끝에서 탐색→매칭하면 x로 마킹.
2) 실패하면 reject, 모두 마킹되면 accept.
시간 O(n^2), 공간 O(1) 추가마크(테이프 재사용).
```

---

## 복잡도 측정: 시간/공간, 클래스

### 시간/공간 함수

입력 길이 $$n$$에 대해:

- **시간**
  $$
  T_M(n)=\max_{|w|=n}\{\text{M이 } w \text{에서 쓰는 단계 수}\}.
  $$
- **공간**
  $$
  S_M(n)=\max_{|w|=n}\{\text{M이 } w \text{에서 비공백으로 쓰거나 방문한 칸 수}\}.
  $$

이로부터 **클래스**:

$$
\mathrm{TIME}(t(n))=\{L\mid \exists M:\ \forall w,\ M \text{이 } O(t(|w|)) \text{ 시간에 } L \text{을 결정}\}.
$$

$$
\mathrm{SPACE}(s(n))=\{L\mid \exists M:\ \forall w,\ M \text{이 } O(s(|w|)) \text{ 공간으로 } L \text{을 결정}\}.
$$

### 표준 클래스

$$
\mathbf{P}=\bigcup_{k\ge1}\mathrm{TIME}(n^k),\quad
\mathbf{NP}=\bigcup_{k\ge1}\mathrm{NTIME}(n^k),
$$

$$
\mathbf{PSPACE}=\bigcup_{k\ge1}\mathrm{SPACE}(n^k),\quad
\mathbf{EXPTIME}=\bigcup_{k\ge1}\mathrm{TIME}(2^{n^k}),
$$

$$
\mathbf{L}=\mathrm{SPACE}(\log n),\quad
\mathbf{NL}=\mathrm{NSPACE}(\log n).
$$

> **검증기 정의(NP)**:
> $$L\in\mathbf{NP} \iff \exists V\in\mathbf{P},\ \exists k:\ \forall x,\ x\in L\Rightarrow \exists y,\ |y|\le |x|^k,\, V(x,y)=1,\ \ x\notin L\Rightarrow \forall y,\ V(x,y)=0.$$

---

## 강건성(Cobham–Edmonds 테제): 모델 간 다항식 내 등가

**요지**: “합리적” 계산 모델들(다중테이프 TM, RAM/Word-RAM, 포인터 머신 등)은 **다항식 오버헤드**로 서로 모사된다.
따라서 “**다항시간(P)**” 구분은 모델에 **불변**.

### 대표 시뮬레이션

- **다중테이프 → 단일테이프(시간)**:
  $$t(n)$$ 시간에 멈추는 DTM은 **단일 테이프**에서 $$O(t(n)^2)$$ 시간으로 모사 가능.
- **공간 보존**:
  다중테이프의 공간 $$s(n)$$은 단일 테이프에서 $$O(s(n))$$(상수배)로 모사.
- **RAM ↔ TM**:
  워드 연산을 비트 조작으로 풀어 **다항식** 내 모사 가능.
- **Savitch 정리**:
  $$\mathrm{NSPACE}(s)\subseteq \mathrm{DSPACE}(s^2)\ (\Rightarrow \mathbf{PSPACE}=\mathbf{NPSPACE}).$$
- **Immerman–Szelepcsényi**:
  $$\mathbf{NL}=\mathbf{coNL}.$$

### 선형 가속(Linear Speedup)

많은 경우(구성 가능 전제) 임의의 $$\epsilon>0$$에 대해
$$t(n)\mapsto \epsilon t(n)+O(n)$$ 수준으로 **상수배 가속** 기계 재구성 가능.

---

## 계층 정리(Time/Space)와 포함 관계

### 계층 정리

- **Time Hierarchy**
  $$
  t_1(n)\log t_1(n)=o(t_2(n)) \Rightarrow \mathrm{TIME}(t_1)\subsetneq \mathrm{TIME}(t_2).
  $$
- **Space Hierarchy**
  $$
  s_1(n)=o(s_2(n)) \Rightarrow \mathrm{SPACE}(s_1)\subsetneq \mathrm{SPACE}(s_2).
  $$

여기서 $$t,s$$는 대개 **구성 가능(constructible)** 함수(예: $$n, n\log n, n^k, 2^n$$ 등).

### 표준 포함/분리

$$
\mathbf{L}\subseteq \mathbf{NL}\subseteq \mathbf{P}\subseteq \mathbf{NP}\subseteq \mathbf{PSPACE}\subseteq \mathbf{EXPTIME}\subseteq \mathbf{EXPSPACE}.
$$

알려진 사실:

- $$\mathbf{P}\subsetneq \mathbf{EXPTIME}$$ (시간 계층)
- $$\mathbf{L}\subsetneq \mathbf{PSPACE}$$ (공간 계층)
- $$\mathbf{NL}=\mathbf{coNL}$$, $$\mathbf{PSPACE}=\mathbf{NPSPACE}$$

열린 문제:

- $$\mathbf{P}\stackrel{?}{=}\mathbf{NP}$$, $$\mathbf{NP}\stackrel{?}{=}\mathbf{coNP}$$, $$\mathbf{L}\stackrel{?}{=}\mathbf{NL}$$.

---

## 구성 그래프 관점: 공간과 결정 가능성

길이 $$n$$ 입력에서 공간 $$s(n)$$을 쓰는 TM의 **구성** 개수는 대략

$$
|Q|\cdot |\Gamma|^{O(s(n))}\cdot O(s(n))
$$

으로 **유한**. 따라서 멤버십은 “시작 구성→수용 구성 **도달성**”으로 환원 가능.

- $$s(n)=O(\log n)$$이면 구성 수가 **다항** → 그래프 탐색으로 **다항시간** 판정 가능
  (이로부터 $$\mathbf{NL}\subseteq\mathbf{P}$$).

### Savitch 알고리즘(도달성, 공간 제곱)

```text
# 구성 그래프에서 u→v 경로 길이 ≤ 2^ℓ 존재?

Savitch-REACH(u, v, ℓ):
  if ℓ == 0:
    return (u == v) or (u→v가 한 스텝 전이)
  for 모든 mid:
    if Savitch-REACH(u, mid, ℓ-1) and Savitch-REACH(mid, v, ℓ-1):
       return true
  return false
# 공간 O(s(n)^2), 시간은 지수적 가능

```

---

## 비결정성과 클래스

- **NTIME/NSPACE**: 비결정적 자원.
- **NP의 동치 정의**: “증명서 검증(결정적 폴리시간)” ↔ “비결정적 폴리시간 수용”.
- **포함**: 구성 그래프 DFS로 증인 경로를 수색하면 공간만 다항 → $$\mathbf{NP}\subseteq \mathbf{PSPACE}$$.
- **보수 클래스**: $$\mathbf{NL}=\mathbf{coNL}$$, 그러나 $$\mathbf{NP}\stackrel{?}{=}\mathbf{coNP}$$는 미해결.

---

## 감소와 완전성(Completeness)

### 다항시간 many-one 감소

$$
A \le_m^p B \iff \exists f\in \mathbf{FP}:\ \forall x,\ x\in A \Leftrightarrow f(x)\in B.
$$

한 클래스의 “핵심 난문”들(완전 문제)은 위 감소로 서로 얽혀 있다.

### 대표

- **NP-완전**: SAT/3-SAT(Cook–Levin), CLIQUE, HAMILTONIAN, 3-COLORING, TSP(결정판) 등.
- **PSPACE-완전**: QBF(양화식 만족성), 여러 2인 완전정보 게임(일반판).
- **EXPTIME-완전**: 체스/체커(보드 크기 가변)의 승패 결정 등.

### Cook–Levin 스케치(“계산을 격자에”)

길이 $$p(n)$$ 시간에 멈추는 NTM의 계산 테이블(행=시간, 열=테이프 위치)을 **CNF** 제약으로 부호화:

- 변수: “시간 $$t$$, 위치 $$i$$에 기호/헤드/상태 $$X$$”
- 제약:
  - 한 칸엔 하나의 기호만, 한 시간엔 하나의 상태만(배타성/충족성)
  - **지역 전이**: $$2\!\sim\!3$$ 크기 윈도우로 $$t\to t+1$$의 합법성
  - 시작/수용 조건
결과: 임의의 $$L\in\mathbf{NP}$$에 대해 $$x\in L \iff \phi_x \in \mathrm{SAT}$$.

---

## 모델 변형과 성능만의 차이

- **다중테이프·다중헤드·Stay**: 표현력은 같고 복잡도는 **다항식** 범위에서만 변동.
- **양방무한/일방무한 테이프**: 다항식 내 동등.
- **오라클 TM**: 상대화 연구(장벽 이론)용.
- **RAM/Word-RAM**: 실제 알고리즘 분석의 기본이지만 TM로 다항식 내 모사 → **클래스 경계 불변**.

---

## 시간·공간 구성 가능성과 패딩 기법

- **구성 가능 함수**: “정확히 $$t(n)$$ 단계 세기” 같은 제어가 가능한 함수(계층 정리 전제).
- **패딩**: 인스턴스를 $$1^k$$ 같은 꼬리로 늘려 길이를 키워 **완전성**과 클래스 경계를 이식(예: EXP-완전 문제를 P-완전 구조로 변형).

---

## 실전 감각 — TM 복잡도를 현실로 번역

- **P의 의미**: Cobham–Edmonds 테제 → “실용적으로 가능한 범주”의 추상화(상수·차수는 무시).
- **현실 요소**: 캐시/I-O/분기예측/SIMD/NUMA/병렬성이 성능을 좌우. TM 결과는 **다항식 내 오버헤드** 보증일 뿐.
- **전략 지도**:
  1) P 문제라도 **차수/상수**가 큰 알고리즘은 피하고 **선형·$$n\log n$$** 지향.
  2) NP-완전 문제는 **근사·파라미터화·무작위화**·특수 구조(평면/트리폭)로 우회.
  3) 공간 제한 이슈면 **구성 그래프** 관점으로 설계를 바꾸고, **재귀 깊이/상태 압축**으로 $$\log n$$ or 다항 공간을 목표.

---

## 케이스 스터디 — “같은 문제, 다른 자원”

### 균형 괄호 인식

- **PDA(스택)**: 선형시간/로그 공간(스택 심볼만).
- **TM 설계**: 스택을 테이프에 부호화(푸시/팝을 우측 확장/축소) → 시간 선형, 공간 선형(입력 재사용하면 추가 공간은 $$O(\log n)$$).

```text
전략: 입력을 좌→우로 스캔하며 '('면 push, ')'면 pop. 중간에 음수되면 reject, 끝났을 때 스택이 비면 accept.
```

### 두 절반 동일성 $$L=\{ww\mid w\in\{0,1\}^*\}$$

- **NTM**: 중간 지점 $$k$$를 nondet.로 추측→양쪽을 좌/우에서 동시에 비교. 시간 $$O(n^2)$$, 공간 $$O(\log n)$$(인덱스).
- **DTM**: 왼 절반 심볼 하나를 마킹 후 오른쪽 대응을 찾고 지움(여러 패스) → 시간 $$O(n^2)$$, 공간 상수+마킹.

### 그래프 도달성(REACH)

- **NL**: 소스→타깃 경로 존재? 로그 공간에 현재 정점과 깊이 카운터만 유지.
- **coNL**: 비도달성도 로그 공간에서 증명 가능(세기 기반).

---

## 랜덤화·카운팅·비균일성(간단 지도)

- **확률 클래스**:
  $$\mathbf{RP}\subseteq \mathbf{BPP}\subseteq \mathbf{Σ_2^P}\ (\text{현대 이론에선 } \mathbf{BPP}=\mathbf{P} \text{ 가능성}).$$
- **카운팅(#P)**: 해의 **개수**를 세는 문제(예: #SAT)는 **#P-완전**.
- **비균일성 $$\mathbf{P/poly}$$**: 입력 길이마다 다른 조언(advice) → 회로 관점. $$\mathbf{NP}\subseteq \mathbf{P/poly}$$이면 **다항식 계층 붕괴**(Karp–Lipton).

---

## 실습 스타일 의사코드 모음

### NP 검증기

```text
# 언어 L의 다항시간 검증기 V

V(x, y):
  if |y| > |x|^k: return reject
  if constraints(x, y) hold in poly(|x|): return accept
  else: return reject
# L ∈ NP ⇔ ∃V s.t. x∈L ⇒ ∃y: V(x,y)=accept, x∉L ⇒ ∀y: reject

```

### 다중테이프→단일테이프 시뮬레이터(개념)

```text
# k개 트랙(가상 테이프)을 하나의 실제 테이프에 interleave
# 각 스텝: (1) 모든 헤드 위치 셀 모으기 → (2) 전이 룩업 → (3) 쓰기/헤드 이동 반영
# 시간: 원래 t(n)의 O(t(n)^2), 공간: O(s(n))

```

### Savitch-REACH (재귀 도달성)

```text
bool reach(u, v, ell):
  if ell == 0:
    return (u == v) or exists edge(u, v)
  for each mid in Configs:
    if reach(u, mid, ell-1) and reach(mid, v, ell-1):
      return true
  return false
# 호출은 ell = ⌈log dist_upper_bound⌉

```

---

## 계산 하한·트레이드오프: 공식과 직감

### 비교 정렬 하한

$$
\text{DT 높이} \ge \lceil \log_2(n!) \rceil = \Theta(n\log n).
$$

### 시간–공간 트레이드오프(예: 테이블 vs 온더플라이)

- 전개 테이블(공간 ↑) → 쿼리 시간 ↓
- 온더플라이(공간 ↓) → 계산 시간 ↑
- 일부 문제는 **Cell-probe 하한**으로 본질적 트레이드오프가 존재.

---

## 블록: 자주 쓰는 증명 스케치

### Time Hierarchy(대각화 직감)

- 시간 구성 가능 $$t_2$$에 대해 “자기 자신을 부정하는” 기계를 만들고, $$t_1\ll t_2/\log t_2$$이면 $$\mathrm{TIME}(t_1)$$로는 모사 불가.

### Space Hierarchy

- 더 작은 공간으로는 더 큰 공간 기계의 모든 구성을 탐색할 수 없음(구성 수가 지수적으로 늘기 때문).

### NL = coNL(세기 아이디어)

- 도달하는 정점 수를 로그 공간에서 단계적으로 **세어** “도달하지 않음”을 증명.

---

## 빠른 참조 표

| 축 | 내용 | 핵심 포인트 |
|---|---|---|
| 모델 | TM/RAM/다중테이프 | 다항식 내 상호 모사(강건성) |
| 시간 | $$\mathbf{P}\subsetneq\mathbf{EXPTIME}$$ | 계층 정리 |
| 공간 | $$\mathbf{L}\subsetneq\mathbf{PSPACE}$$ | 계층 정리 |
| 비결정성 | $$\mathbf{PSPACE}=\mathbf{NPSPACE}$$ | Savitch |
| 로그공간 | $$\mathbf{NL}=\mathbf{coNL}$$ | Immerman–Szelepcsényi |
| 대표 완전 | SAT, QBF, Generalized Chess | NP/PSPACE/EXPTIME-완전 |
| 실전 해석 | 캐시/I-O/병렬 | TM 복잡도는 상한/가능 지도 |

---

## 결론

- **TM 모델**은 계산 가능성의 표준, 복잡도는 **시간·공간**으로 계량.
- **강건성** 덕분에 P/NP/PSPACE 같은 큰 경계는 모델 독립.
- **계층 정리**는 자원 증가가 실제로 더 강함을 보장, Savitch/Immerman–Szelepcsényi가 공간 구도를 단단히 만든다.
- **완전성/감소**는 난문의 “허브”를 제공, 실무에서는 **근사·FPT·무작위화·I-O/캐시·병렬**로 우회/가속을 설계한다.
