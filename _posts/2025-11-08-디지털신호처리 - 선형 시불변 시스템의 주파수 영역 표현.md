---
layout: post
title: 디지털신호처리 - 선형 시불변 시스템의 주파수 영역 표현
date: 2025-11-08 19:25:23 +0900
category: 디지털신호처리
---
# 선형 시불변(LTI) 시스템의 주파수 영역 표현

## 0) 맥락과 목표
앞서 정리한 **이산 시간 신호/시스템**, **컨볼루션**, **차분 방정식**, **DTFT의 정의와 성질**을 바탕으로, 이번 글은 **LTI 시스템의 주파수 영역 표현**을 처음부터 끝까지 실전 관점으로 묶는다. 요지:

1) **주파수 응답**  
$$
H(e^{j\omega})=\sum_{n=-\infty}^{\infty}h[n]e^{-j\omega n},\qquad
h[n]=\frac{1}{2\pi}\int_{-\pi}^{\pi}H(e^{j\omega})e^{j\omega n}\,d\omega.
$$

2) **고유함수**  
$$
\mathcal{T}\{e^{j\omega n}\}=H(e^{j\omega})\,e^{j\omega n}.
$$

3) **컨볼루션 정리**  
$$
y[n]=(x*h)[n]\ \Longleftrightarrow\ Y(e^{j\omega})=X(e^{j\omega})\,H(e^{j\omega}).
$$

4) **Z-변환 연결**  
$$
H(z)=\frac{Y(z)}{X(z)}=\frac{\sum_{k=0}^{K}b_k z^{-k}}{1+\sum_{m=1}^{M}a_m z^{-m}},\qquad
H(e^{j\omega})=H(z)\big|_{z=e^{j\omega}}.
$$

5) **극/영점**이 크기·위상·안정성의 구조를 결정.

---

## 1) 주파수 영역 표현: 정의·역변환·해석

### 1.1 정의와 표기
임펄스응답 \(h[n]\)의 DTFT:
$$
H(e^{j\omega})=\sum_{n=-\infty}^{\infty}h[n]e^{-j\omega n},\quad \omega\in[-\pi,\pi],\quad H(\omega+2\pi)=H(\omega).
$$
역변환:
$$
h[n]=\frac{1}{2\pi}\int_{-\pi}^{\pi}H(e^{j\omega})e^{j\omega n}\,d\omega.
$$
Z-변환과의 연결:
$$
H(z)=\sum_{n=-\infty}^{\infty}h[n]z^{-n},\qquad H(e^{j\omega})=H(z)\big|_{z=e^{j\omega}}.
$$
ROC가 단위원을 포함하면 \(H(e^{j\omega})\)가 존재한다.

### 1.2 고유함수 성질과 정현파 정상응답
입력 \(x[n]=A\cos(\omega_0 n+\phi)\) → 출력은 **진폭/위상만 변한 같은 주파수의 정현파**:
$$
y[n]=|H(e^{j\omega_0})|\,A\cos\!\big(\omega_0 n+\phi+\angle H(e^{j\omega_0})\big).
$$

### 1.3 컨볼루션 정리(시간↔주파수)
시간영역 \(y[n]=(x*h)[n]\)이면
$$
Y(e^{j\omega})=X(e^{j\omega})\,H(e^{j\omega}).
$$
설계는 \(|H|\)와 \(\angle H\)를 목표 스펙대로 만드는 일이며, 해석은 \(X\)를 \(H\)로 가중한 결과 \(Y\)를 읽는 일이다.

#### Octave: 정의·컨볼루션 정리 수치 확인
```octave
clear; close all; clc
pkg load signal

% 임의 FIR 설계
b = fir1(63, 0.3, hamming(64)); a = 1;
N = 4096; x = randn(1, N);

% 시간영역
y_time = filter(b, a, x);

% 주파수영역 (선형 컨볼루션 맞추기 위해 zero-padding)
L = numel(x) + numel(b) - 1; Nfft = 2^nextpow2(L);
Yf = ifft( fft(x, Nfft).*fft(b, Nfft) );
y_freq = Yf(1:N);

printf("time vs freq error (norm) = %.2e\n", norm(y_time - y_freq)/norm(y_time));
```

---

## 2) 크기·위상·군지연·선형위상·최소위상

### 2.1 크기와 위상 분해
$$
H(e^{j\omega})=|H(e^{j\omega})|\,e^{j\angle H(e^{j\omega})}.
$$
- \(|H|\): 대역별 증폭/감쇠
- \(\angle H\): 파형 정렬(지연·왜곡). 위상 비선형이면 성분별 도착시점이 달라질 수 있다.

### 2.2 선형위상 FIR과 상수 군지연
대칭 FIR(\(h[n]=h[N-1-n]\))이면
$$
H(e^{j\omega})=e^{-j\omega\frac{N-1}{2}}\,A(\omega),\qquad
\tau_g(\omega)=-\frac{d}{d\omega}\angle H \equiv \frac{N-1}{2}.
$$
즉, 모든 주파수 성분이 같은 샘플 수만큼 지연된다.

#### Octave: FIR의 \(|H|\)·위상·군지연
```octave
clear; close all; clc
pkg load signal
N=101; b=fir1(N-1, 0.25, hamming(N)); a=1;
[H,w]=freqz(b,a,4096);
phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
subplot(3,1,1); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; ylabel('dB'); title('FIR |H|')
subplot(3,1,2); plot(w/pi,phi); grid on; ylabel('rad'); title('FIR phase')
subplot(3,1,3); plot(w/pi,tau); grid on; xlabel('\omega/\pi'); ylabel('samples'); title('FIR group delay ~ (N-1)/2')
```

### 2.3 최소위상·올패스·전위상 개념
- **최소위상**: 모든 영점이 단위원 **내**(\(|z_i|<1\))인 시스템. 같은 \(|H|\) 중 **군지연 최소**.
- **올패스(all-pass)**: \(|H|=1\)이고 위상만 바꾸는 시스템. 한 쌍의 극·영점이 단위원에 대해 상호 반사.
- 임의 \(H\)는 \(H_{\min}\times H_A\)로 분해 가능:
$$
H(z)=H_{\min}(z)\,H_A(z),\qquad |H_A(e^{j\omega})|=1.
$$

#### Octave: 간단한 올패스(위상 보정) 예
```octave
clear; close all; clc
pkg load signal
r=0.8; w0=0.5*pi;
% 1st-order complex-conjugate all-pass (2차)
p = r*exp(1j*w0); p2=conj(p);
b = poly([1/conj(p), 1/conj(p2)]); a = poly([p, p2]);
[H,w]=freqz(b,a,4096);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; xlabel('\omega/\pi'); ylabel('dB');
title('All-pass magnitude ~ 0 dB (phase only)')
```

---

## 3) 극/영점과 응답 구조: Z-평면 직관

### 3.1 극/영점과 단위원 거리
전달함수
$$
H(z)=\frac{B(z)}{A(z)}=\frac{\prod_i(1-z_i z^{-1})}{\prod_k(1-p_k z^{-1})}.
$$
단위원 \(z=e^{j\omega}\) 위에서:
- **영점**이 가까우면 \(|H|\)가 작아진다(감쇠).
- **극**이 가까우면 \(|H|\)가 커진다(증폭).
위상은 단위원을 따라 영점/극을 지나며 급격히 변화한다.

### 3.2 안정·인과 조건
- **BIBO 안정**: 모든 극 \(|p_k|<1\).
- **인과**: ROC가 가장 바깥 극 바깥쪽이며 단위원 포함.

#### Octave: 폴-제로 맵과 응답
```octave
clear; close all; clc
pkg load signal
w0=0.6*pi; r=0.95;
b=poly([exp(1j*w0), exp(-1j*w0)]);           % notch zeros
a=poly([r*exp(1j*w0), r*exp(-1j*w0)]);       % near-by poles
[H,w]=freqz(b,a,4096);
subplot(1,2,1)
th=linspace(0,2*pi,600); uc=exp(1j*th);
plot(real(uc),imag(uc),'k--'); hold on
plot(real(roots(b)), imag(roots(b)), 'ob', 'markerfacecolor','b');
plot(real(roots(a)), imag(roots(a)), 'xr', 'markersize',7);
axis equal; grid on; title('Pole-Zero Map'); legend('Unit circle','Zeros','Poles')
subplot(1,2,2)
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; xlabel('\omega/\pi'); ylabel('dB'); title('Magnitude response with notch')
```

---

## 4) 합성: 직렬·병렬·피드백

### 4.1 직렬(연속 필터)
$$
H_{\mathrm{series}}(e^{j\omega})=H_1(e^{j\omega})\,H_2(e^{j\omega}).
$$

### 4.2 병렬(가감)
$$
H_{\mathrm{parallel}}(e^{j\omega})=a\,H_1(e^{j\omega})+b\,H_2(e^{j\omega}).
$$

### 4.3 단일 피드백 루프(폐루프)
전방 \(G\), 피드백 \(F\):
$$
H_{\mathrm{cl}}(e^{j\omega})=\frac{G(e^{j\omega})}{1+G(e^{j\omega})F(e^{j\omega})}.
$$
위상여유/이득여유 해석은 \(|G(e^{j\omega})F(e^{j\omega})|\)의 보데/Nyquist 선도를 통해 수행(디지털은 \(\omega\in[0,\pi]\)에서 해석).

#### Octave: 직렬·피드백 합성 예
```octave
clear; close all; clc
pkg load signal

% 두 필터 직렬
b1=fir1(63, 0.4, hamming(64)); a1=1;
[b2,a2]=butter(3, 0.6);
[H1,w]=freqz(b1,a1,2048); [H2,~]=freqz(b2,a2,2048);
Hser=H1.*H2;

% 피드백: G=b2/a2, F=단순 지연 z^{-2}
F = exp(-1j*w*2);
Hcl = H2 ./ (1 + H2.*F);

subplot(2,1,1); plot(w/pi,20*log10(abs(H1)+1e-12)); hold on
plot(w/pi,20*log10(abs(H2)+1e-12)); plot(w/pi,20*log10(abs(Hser)+1e-12));
grid on; legend('|H1|','|H2|','|H1*H2|'); title('Series composition')

subplot(2,1,2); plot(w/pi,20*log10(abs(Hcl)+1e-12)); grid on
title('Closed-loop |G|/(1+GF) with F=z^{-2}')
xlabel('\omega/\pi'); ylabel('dB')
```

---

## 5) 잡음 통과: PSD 관점과 SNR

### 5.1 PSD 전파식
WSS 입력 \(x\)의 PSD \(S_x(e^{j\omega})\)가 주어지면 출력 PSD:
$$
S_y(e^{j\omega})=|H(e^{j\omega})|^2 S_x(e^{j\omega}).
$$
대역필터의 잡음 대역폭과 올바른 윈도우 보정(ENBW)로 측정–예측 일치 확인.

#### Octave: 백색잡음 통과 실험
```octave
clear; close all; clc
pkg load signal
Fs=8000; N=16384; n=0:N-1;
x=randn(1,N);                      % unit-variance white noise
b=fir1(200, 1200/(Fs/2), hamming(201)); a=1;
y=filter(b,a,x);

% Periodogram (power)
W=hanning(N)'; U=sum(W.^2)/N;
Sx=(abs(fft(x.*W)).^2)/(N*U);
Sy=(abs(fft(y.*W)).^2)/(N*U);
[H,~]=freqz(b,a,N); theory=(abs(H).^2).*Sx(:).';

f=(0:N-1)*Fs/N;
plot(f(1:N/2),10*log10(Sx(1:N/2)+1e-15)); hold on
plot(f(1:N/2),10*log10(Sy(1:N/2)+1e-15));
plot(f(1:N/2),10*log10(theory(1:N/2)+1e-15));
grid on; legend('Sx','Sy(meas)','|H|^2 Sx (theory)'); xlabel('Hz'); ylabel('dB')
title('PSD propagation through LTI')
```

---

## 6) 구현·검증 루틴(Octave): from 설계 to 신뢰

### 6.1 도구 모음
- `freqz(b,a,N)`: \(H(e^{j\omega})\) 샘플
- `impz(b,a,N)`: \(h[n]\)
- `filter(b,a,x)`: 차분식 적용
- `filtfilt(b,a,x)`: 0-위상(양방향) 필터링
- 고차 IIR은 **2차 섹션(sos)** 분해가 수치 안정적

### 6.2 자동 검증 스크립트(체크리스트)
- 안정성(극 반경), 선형/원형 컨볼루션 일치, 통과/저지 규격, 군지연 평균·변동, PSD 전파식 비교

```octave
function report = lti_selfcheck(x, b, a, Fs, spec)
  % spec: struct with fields pass_edge, stop_edge, pass_ripple_db, stop_atten_db (optional)
  report=struct();
  % stability
  p=roots(a); report.max_pole_radius=max(abs(p));
  report.is_stable=(report.max_pole_radius<1+1e-9);

  % freq response
  Nw=4096; [H,w]=freqz(b,a,Nw); mag_db=20*log10(abs(H)+1e-12);
  report.mag_db=mag_db; report.w=w;

  % conv vs filter (first-order equality check)
  N=2048; x=x(:).'; y1=filter(b,a,x);
  L=numel(x)+numel(b)-1; Nfft=2^nextpow2(L);
  y2=ifft(fft(x,Nfft).*fft(b,Nfft)); y2=y2(1:numel(x));
  report.conv_filter_relerr=norm(y1-y2)/max(1e-12,norm(y1));

  % group delay (rough)
  phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
  report.group_delay_mean=mean(tau(round(0.1*Nw):round(0.9*Nw)));
  report.group_delay_std =std(tau(round(0.1*Nw):round(0.9*Nw)));

  % spec checks if provided
  if nargin>=5 && !isempty(spec)
    idxp = find((w/pi)<=spec.pass_edge);
    idxs = find((w/pi)>=spec.stop_edge);
    report.pass_max_ripple = max(mag_db(idxp))-min(mag_db(idxp));
    report.stop_min_atten  = -max(mag_db(idxs));
    report.pass_ok = (report.pass_max_ripple <= spec.pass_ripple_db+1e-6);
    report.stop_ok = (report.stop_min_atten  >= spec.stop_atten_db-1e-6);
  end
endfunction

% 사용 예
pkg load signal
Fs=8000; x=randn(1,4096);
b=fir1(200, 1000/(Fs/2), hamming(201)); a=1;
spec=struct('pass_edge', 0.22, 'stop_edge', 0.35, 'pass_ripple_db', 1.0, 'stop_atten_db', 40);
r=lti_selfcheck(x,b,a,Fs,spec);
disp(r)
```

---

## 7) 위상여유·이득여유(디지털 관점 요약)

### 7.1 폐루프 안정성 조건(요지)
개루프 \(L(e^{j\omega})=G(e^{j\omega})F(e^{j\omega})\).  
- **이득여유(GM)**: 위상 \(-\pi\) 근방에서 \(|L|^{-1}\).  
- **위상여유(PM)**: \(|L|=1\)일 때 위상과 \(-\pi\) 간 각도.  
디지털에서는 \(\omega\in[0,\pi]\)에서 보데로 읽는다(양/음 주파수 대칭). Nyquist 해석은 \(z=e^{j\omega}\) 단위원 주위를 도는 \(L(e^{j\omega})\) 궤적으로 수행.

#### Octave: 간단 PM/GF 지표 계산(근사)
```octave
clear; close all; clc
pkg load signal
[bi,ai]=butter(3,0.4);  % G
w=linspace(0,pi,4096); [G,~]=freqz(bi,ai,w);
F=exp(-1j*w*2);        % F=z^{-2}
L=G.*F; mag=abs(L); ph=angle(L);

% unity-gain crossing
[~,k]=min(abs(mag-1));
PM = (pi - abs(ph(k)));         % rad
% at -pi phase, find gain
[~,k2]=min(abs(ph+pi));
GM = 1/mag(k2);

printf("approx PM=%.2f deg, GM=%.2f\n", PM*180/pi, GM);
```

---

## 8) 구현상의 주의: 수치 민감성·섹션화·정규화

### 8.1 Direct Form II의 취약성
고차 IIR에서 극이 단위원에 가까우면 누산기 정밀도 문제로 불안정해질 수 있다. **2차 섹션(sos)**로 분해하고 섹션별 스케일링을 적용한다.

### 8.2 정규화·오버플로 방지
- 필터 계수와 데이터 스케일을 맞춘다.
- 고정소수점이면 블록 부동 소수/스케일 감시.

#### Octave: 2차 섹션 흉내(폴/제로 쌍 분해)
```octave
clear; close all; clc
pkg load signal
[bi,ai]=cheby1(8, 1, 0.4);      % 8차 IIR
z=roots(bi); p=roots(ai);
% 간단히 켤레쌍으로 2차 섹션 구성 (실무는 안정/정밀 고려 추가 필요)
pairs = @(r) r(1:2:end);
z2=pairs(z); p2=pairs(p);
B=1; A=1;
for k=1:numel(z2)
  bsec = poly([z2(k), conj(z2(k))]);
  psec = poly([p2(k), conj(p2(k))]);
  B = conv(B, bsec);  A = conv(A, psec);
end
[H1,w]=freqz(bi,ai,4096); [H2,~]=freqz(B,A,4096);
printf("||H1-H2||/||H1||=%.2e\n", norm(H1-H2)/norm(H1));
```

---

## 9) 최소위상화(영점 반사) 데모

### 9.1 FIR의 최소위상 근사
선형위상 FIR의 영점 중 단위원 바깥(\(|z_i|>1\))을 **반사**(\(z_i \mapsto 1/z_i^*\))하면 \(|H|\)를 보존하면서 위상/군지연을 줄인다.

#### Octave: 간단 최소위상 변환(데모용)
```octave
clear; close all; clc
pkg load signal

% 대칭 FIR 설계 (선형위상)
N=63; b_lin=fir1(N-1, 0.3, hamming(N)); a=1;

% 영점 반사
z=roots(b_lin); keep = []; refl = [];
for k=1:numel(z)
  if abs(z(k))>1+1e-9
    refl(end+1)=1/conj(z(k));
  else
    keep(end+1)=z(k);
  end
end
b_min = real(poly([keep, refl]));   % 실계수화
b_min = b_min * (sum(b_lin)/sum(b_min));  % DC gain 일치

[Hlin,w]=freqz(b_lin,1,4096);
[Hmin,~]=freqz(b_min,1,4096);

subplot(2,1,1)
plot(w/pi,20*log10(abs(Hlin)+1e-12)); hold on
plot(w/pi,20*log10(abs(Hmin)+1e-12));
grid on; legend('linear-phase','minimum-phase'); title('Magnitude (nearly identical)')

subplot(2,1,2)
phi1=unwrap(angle(Hlin)); phi2=unwrap(angle(Hmin));
tau1=-gradient(phi1)./gradient(w); tau2=-gradient(phi2)./gradient(w);
plot(w/pi,tau1); hold on; plot(w/pi,tau2); grid on
legend('linear-phase','minimum-phase'); title('Group delay (minimum-phase smaller)')
xlabel('\omega/\pi'); ylabel('samples')
```

---

## 10) 실전 시나리오 통합: 설계→적용→검증

### 10.1 문제
- 오디오 스트림에서 2 kHz 톤과 고주파 잡음이 섞인 신호.
- 목표: 2 kHz notch + 저역 보정 FIR 적용, \(|H|\)·군지연·PSD 전파 검증, 시간–주파수 일치 확인.

#### Octave: end-to-end 스크립트
```octave
clear; close all; clc
pkg load signal

Fs=16000; t=(0:1/Fs:2-1/Fs);
x = sin(2*pi*440*t) + 0.6*sin(2*pi*2000*t) + 0.15*randn(size(t));

% Notch @ 2 kHz
w0=2*pi*2000/Fs; r=0.98;
b_notch=poly([exp(1j*w0),exp(-1j*w0)]); a_notch=poly([r*exp(1j*w0),r*exp(-1j*w0)]);
y1=filtfilt(b_notch,a_notch,x);

% Lowpass FIR for hiss
b_lp=fir1(200, 3000/(Fs/2), hamming(201)); a_lp=1;
y2=filtfilt(b_lp,a_lp,y1);

% H_total on DFT grid (approx)
N=4096; [Hn,w]=freqz(b_notch,a_notch,N); [Hl,~]=freqz(b_lp,a_lp,N); Htot=Hn.*Hl;

% Spectrum compare
Nfft=16384; f=(0:Nfft/2-1)*Fs/Nfft;
X=fft(x, Nfft); Y=fft(y2, Nfft);
subplot(2,1,1)
plot(f,20*log10(abs(X(1:Nfft/2))+1e-12)); hold on
plot(f,20*log10(abs(Y(1:Nfft/2))+1e-12)); grid on
legend('orig','filtered'); xlabel('Hz'); ylabel('dB'); title('Spectra')

% Convolution theorem check on a window
xw=x(1:N); Hw = Htot; Ypred = fft(xw,N).*Hw;
subplot(2,1,2)
plot(w/pi,20*log10(abs(fft(y2(1:N),N))+1e-12)); hold on
plot(w/pi,20*log10(abs(Ypred)+1e-12));
grid on; legend('y2 actual','X * Htot'); xlabel('\omega/\pi'); ylabel('dB');
```

---

## 11) 수학적 성질 요약(증명 스케치 포함)

### 11.1 선형성·시프트·변조
- 선형성: \(\mathcal{F}\{a h_1+b h_2\}=aH_1+bH_2\).
- 시프트: \(h[n-n_0]\Longleftrightarrow e^{-j\omega n_0}H(e^{j\omega})\).
- 변조: \(e^{j\omega_0 n}h[n]\Longleftrightarrow H(e^{j(\omega-\omega_0)})\).

### 11.2 컨볼루션 정리
\((x*h)[n]=\sum_k x[k]h[n-k]\)를 DTFT 정의에 대입, 지수 결합 후 합 순서 교환으로 \(XH\).

### 11.3 Parseval/Plancherel
$$
\sum_n |h[n]|^2=\frac{1}{2\pi}\int_{-\pi}^{\pi}|H(e^{j\omega})|^2\,d\omega.
$$

---

## 12) 실전 체크리스트
1. **안정성**: \(\max_k|p_k|<1\) 확인(여유 포함).  
2. **대역 스펙**: 통과 리플·저지 감쇠·전이폭 충족.  
3. **위상/군지연**: FIR은 \((N-1)/2\) 근사, IIR은 변동폭 수치화.  
4. **시간–주파수 일치**: `filter` vs FFT 곱 상대오차.  
5. **경계/지연 보정**: 오프라인은 `filtfilt`, 실시간은 프레임 지연 산정.  
6. **PSD 전파식**: \(S_y=|H|^2 S_x\) 측정–예측 교차검증.  
7. **수치 안정성**: 2차 섹션, 스케일 정규화, 고정소수점 시 모드/오버플로 체크.

---

## 13) 핵심 수식 모음
1) 주파수응답  
$$
H(e^{j\omega})=\sum_n h[n]e^{-j\omega n},\quad
h[n]=\frac{1}{2\pi}\!\int_{-\pi}^{\pi}\!H(e^{j\omega})e^{j\omega n}\,d\omega.
$$

2) 고유함수  
$$
\mathcal{T}\{e^{j\omega n}\}=H(e^{j\omega})\,e^{j\omega n}.
$$

3) 컨볼루션 정리  
$$
Y(e^{j\omega})=X(e^{j\omega})\,H(e^{j\omega}),\qquad
y[n]=(x*h)[n].
$$

4) Z-변환 연결  
$$
H(z)=\frac{B(z)}{A(z)},\quad H(e^{j\omega})=H(z)\big|_{z=e^{j\omega}}.
$$

5) 군지연  
$$
\tau_g(\omega)=-\frac{d}{d\omega}\angle H(e^{j\omega}).
$$

6) PSD 전파  
$$
S_y(e^{j\omega})=|H(e^{j\omega})|^2\,S_x(e^{j\omega}).
$$

---

## 14) 부록 A — DFT 격자에서의 \(H\) 샘플링 팁
`freqz`는 \(z=e^{j\omega}\)에서의 직접 평가다. \(h[n]\)을 FFT해도 근사 가능:
```octave
function [w, H] = H_via_fft_of_h(h, Nfft)
  if nargin<2, Nfft=16384; end
  H=fftshift(fft(h, Nfft));
  w=linspace(-pi,pi,Nfft);
endfunction

% 예
h=fir1(63,0.25,hamming(64));
[w,H]=H_via_fft_of_h(h,8192);
plot(w/pi,20*log10(abs(H)+1e-12)); grid on; xlabel('\omega/\pi'); ylabel('dB');
```

---

## 15) 부록 B — 창 보정(CG/ENBW)과 스펙트럼 일관성
실계측/시뮬레이션에서 창 \(w[n]\) 사용 시 진폭/전력 보정:
- Coherent Gain: \(\mathrm{CG}=\frac{1}{N}\sum_n w[n]\)
- ENBW(bins): \(\mathrm{ENBW}=\frac{N\sum w[n]^2}{(\sum w[n])^2}\)

```octave
function cg=coherent_gain(w), cg=sum(w)/numel(w); end
function eb=enbw_bins(w), N=numel(w); eb=N*sum(w.^2)/(sum(w)^2); end
```

---

## 결론
LTI 시스템의 주파수 영역 표현은 **DTFT/Z-변환**에 기반하고, **극/영점**이 \(|H|\)와 \(\angle H\)의 전반적 구조를 결정한다. **선형위상 FIR**은 상수 군지연으로 파형 보존이 쉬우며, **IIR**은 낮은 차수로 급격한 대역특성을 얻되 위상/수치 안정성 관리가 필요하다. 제시한 Octave 루틴으로 **안정성, 대역 규격, 위상·군지연, 시간–주파수 일치, PSD 전파**를 자동 검증하며, 필요시 **올패스·최소위상화**로 위상을 다듬어 실전 스펙을 만족시켜라.