---
layout: post
title: 미적분 - 유리함수의 적분
date: 2025-07-17 18:20:23 +0900
category: 미적분
---
# 유리함수의 적분: 부분분수법(Partial Fraction Decomposition)

> **목표**
> - 유리함수 \( \dfrac{P(x)}{Q(x)} \)의 적분을 체계적으로 푸는 법을 익힌다.
> - 분모의 인수 유형(일차/이차, 중복 유무)에 따른 **부분분수 분해 템플릿**과 **적분 공식**을 모두 정리한다.
> - 예제와 코드로 실제 계산 흐름을 익힌다.
> - 로그/아크탄젠트, 그리고 고차 거듭제곱 분모의 **재귀적 감소 공식**까지 다룬다.

---

## 유리함수와 부분분수법 개요

- **유리함수(rational function)**: 두 다항식의 비
  $$
  R(x)=\frac{P(x)}{Q(x)},\quad P,Q\in\mathbb{R}[x],\ Q(x)\neq 0.
  $$
- 적분의 기본 전략:
  1) **다항식 나눗셈**(필요 시)으로 **기약형(Proper)**으로 만든다.
  2) 분모 \(Q(x)\)를 **실수 범위**에서 인수분해한다(일차, **실수에서 기약인 이차**).
  3) 유형별 **부분분수 분해** 템플릿에 맞춰 계수를 구한다.
  4) 항목별 표준 적분 공식을 적용한다(로그/아크탄젠트/거듭제곱 감소).

---

## 워크플로(알고리즘)

1) **Improper → Proper**:
   \(\deg P \ge \deg Q\) 이면 다항식 나눗셈으로
   $$
   \frac{P(x)}{Q(x)}=S(x)+\frac{R(x)}{Q(x)},\quad \deg R<\deg Q.
   $$
   적분은 \(\int S(x)\,dx+\int \dfrac{R(x)}{Q(x)}\,dx\).

2) **인수분해**(실수계수):
   $$
   Q(x)=\prod_i (x-a_i)^{\alpha_i}\ \prod_j (x^2+p_jx+q_j)^{\beta_j},
   $$
   여기서 \(x^2+p_jx+q_j\)는 \(\Delta_j=p_j^2-4q_j<0\) (실수에서 기약).

3) **부분분수 형태 결정**:
   - 서로 다른 일차: \(\displaystyle \frac{A}{x-a}\)
   - 중복 일차: \(\displaystyle \frac{A_1}{x-a}+\frac{A_2}{(x-a)^2}+\cdots+\frac{A_n}{(x-a)^n}\)
   - 기약 이차: \(\displaystyle \frac{Ax+B}{x^2+px+q}\)
   - 중복 이차: \(\displaystyle \sum_{k=1}^n \frac{A_kx+B_k}{(x^2+px+q)^k}\)

4) **계수 결정법**(4가지 도구)
   - **대입법/치환법**: 근을 대입해 빠르게 일부 계수 결정(Heaviside cover-up; 단, 단순 일차에 잘 맞다).
   - **계수 비교**: 전개 후 \(x\)의 차수별 계수 비교.
   - **특수값 대입**: 근 외의 값, 또는 파라미터 몇 개를 고정하기 좋은 점들을 대입.
   - **선형시스템**: 미지수 많을 때 행렬로 일괄 해결.

5) **항목별 적분 공식** 적용:
   - 일차 분모 → 로그
   - 기약 이차 분모 → 로그 + 아크탄젠트(또는 아르탄하이퍼볼릭, 판별식 기호에 따라)
   - 거듭제곱 분모 → 치환/감소식(재귀)

---

## 부분분수 템플릿 모음(요약표)

| 분모 유형 | 템플릿 |
|---|---|
| \((x-a)\) | \(\displaystyle \frac{A}{x-a}\) |
| \((x-a)^n\) | \(\displaystyle \sum_{k=1}^n \frac{A_k}{(x-a)^k}\) |
| \((x^2+px+q)\) | \(\displaystyle \frac{Ax+B}{x^2+px+q}\) |
| \((x^2+px+q)^n\) | \(\displaystyle \sum_{k=1}^n \frac{A_kx+B_k}{(x^2+px+q)^k}\) |

> 실수 적분을 기준으로 하므로, 복소근은 한 쌍의 기약 이차로 묶어 위 템플릿에 포함시킨다.

---

## 항목별 **표준 적분 공식**

### 일차 인수(중복 포함)

- \(n=1\):
  $$
  \int \frac{A}{x-a}\,dx = A\ln|x-a|+C.
  $$
- \(n\ge 2\):
  $$
  \int \frac{A}{(x-a)^n}\,dx = \frac{-A}{(n-1)(x-a)^{n-1}}+C.
  $$

### 기약 이차 인수(1제곱)

분모 \(v(x)=x^2+px+q\), \(v'(x)=2x+p\), \(\Delta=4q-p^2\).

분자 선형 \(Ax+B\)를
\[
Ax+B=\alpha\,v'(x)+\beta,\quad \alpha=\frac{A}{2},\quad \beta=B-\frac{Ap}{2}
\]
로 분해하면
\[
\int \frac{Ax+B}{v(x)}\,dx
= \alpha \int \frac{v'}{v}\,dx + \beta \int \frac{dx}{v}.
\]
- 첫 항: \(\alpha\ln|v(x)|\).
- 둘째 항: 완전제곱 \(v(x)=\left(x+\tfrac{p}{2}\right)^2+\tfrac{\Delta}{4}\).

  - \(\Delta>0\) (항상 기약 이차라면 \(\Delta<0\)임에 주의!):
    \(\displaystyle \int\frac{dx}{(x+m)^2+a^2}=\frac{1}{a}\arctan\frac{x+m}{a}\).
  - 일반적으로 기약 이차면 \(\Delta=4q-p^2>0\)가 **거짓**이고 \(<0\)가 참이다. 그러므로 \(a^2=-\frac{\Delta}{4}>0\)인 형태의
    \(\displaystyle \frac{1}{(x+m)^2 - a^2}\)가 아니라 **플러스** 형태다:
    \[
    \int \frac{dx}{v(x)}=\frac{2}{\sqrt{4q-p^2}}\arctan\!\left(\frac{2x+p}{\sqrt{4q-p^2}}\right).
    \]
정리하면
$$
\boxed{
\int \frac{Ax+B}{x^2+px+q}\,dx
= \frac{A}{2}\ln\!\big(x^2+px+q\big)
+\frac{2B-Ap}{\sqrt{4q-p^2}}\ \arctan\!\frac{2x+p}{\sqrt{4q-p^2}} + C.
}
$$

> \(4q-p^2<0\) 일 때(실수에서 분해 가능)에는 \(\arctan\) 대신 \(\operatorname{artanh}\) 꼴이 나타난다. 하지만 **기약 이차** 조건은 \(4q-p^2>0\)이기 때문에 위 공식(\(\arctan\))을 쓰게 된다.

### 기약 이차의 거듭제곱 \((x^2+px+q)^n\)

핵심 아이디어:
\[
\frac{Ax+B}{v^n}=\frac{A}{2}\frac{v'}{v^n}+\frac{B-\frac{Ap}{2}}{v^n}.
\]
- 첫 항: \(u=v\) 치환으로 적분
  \[
  \int \frac{v'}{v^n}\,dx=\int u^{-n}\,du = \frac{u^{1-n}}{1-n}=\frac{1}{1-n}\frac{1}{v^{\,n-1}}\ (n\ne1).
  \]
- 둘째 항: \(\displaystyle \int \frac{dx}{v^n}\)은 **감소식** 사용.
  완전제곱 \(v=(x+m)^2+a^2\)로 두면 표준 감소식(증명은 부분적분으로 가능)
  $$
  \boxed{
  \int \frac{dx}{(x^2+a^2)^n}=
  \frac{x}{2(n-1)a^2(x^2+a^2)^{n-1}}
  +\frac{2n-3}{2(n-1)a^2}\int \frac{dx}{(x^2+a^2)^{n-1}}
  }\quad(n\ge2).
  $$
일반 \(p\ne0\)는 \(x\mapsto x+\frac{p}{2}\)로 평행이동(완전제곱) 후 위 공식을 적용한다.

---

## 계수 구하는 요령(실전 팁)

- **Cover-up(덮어쓰기) 법**: 단순 일차 인수에서 유리.
  예) \(\dfrac{7x+1}{(x-2)(x+3)}=\dfrac{A}{x-2}+\dfrac{B}{x+3}\).
  \(x=2\) 대입: \(A=\left.\dfrac{7x+1}{x+3}\right|_{x=2}=\dfrac{15}{5}=3\).
  \(x=-3\) 대입: \(B=\left.\dfrac{7x+1}{x-2}\right|_{x=-3}=\dfrac{-20}{-5}=4\).
- **계수비교**: 전개 후 동차수 계수 비교. 중복 인수/이차 인수에 안정적.
- **선형시스템**: 미지수 많을 때 깔끔. (행렬/선형대수로 풀이)
- **근처값 대입**: 근이 아니어도 \(x=0,1,-1\) 등에서 빠르게 몇 개를 결정.

---

## 예제들(정확 계산)

### 예제 1: 서로 다른 일차 인수

\[
\int \frac{3x+5}{(x+1)(x+2)}\,dx.
\]
분해:
\[
\frac{3x+5}{(x+1)(x+2)}=\frac{A}{x+1}+\frac{B}{x+2}.
\]
대입 \(x=-1\Rightarrow A=2\), \(x=-2\Rightarrow B=1\).
적분:
\[
\int \left(\frac{2}{x+1}+\frac{1}{x+2}\right)\,dx
=2\ln|x+1|+\ln|x+2|+C.
\]

---

### 예제 2: 중복 일차 인수

\[
\int \frac{5x+1}{(x-1)^2}\,dx
=\int\left(\frac{A}{x-1}+\frac{B}{(x-1)^2}\right)\,dx.
\]
통분 후 계수비교 → \(A=5,\ B=6\).
적분:
\[
5\ln|x-1|-\frac{6}{x-1}+C.
\]

---

### 예제 3: 기약 이차(1제곱)

\[
\int \frac{2x+3}{x^2+4x+13}\,dx.
\]
여기서 \(p=4,\ q=13\Rightarrow 4q-p^2=52-16=36\), \(\sqrt{4q-p^2}=6\).
공식 적용:
\[
\frac{A}{2}\ln v+\frac{2B-Ap}{\sqrt{4q-p^2}}\arctan\frac{2x+p}{\sqrt{4q-p^2}},
\]
\(A=2,\ B=3\)이므로
\[
\int \frac{2x+3}{x^2+4x+13}\,dx
=1\cdot \ln(x^2+4x+13)+\frac{6-8}{6}\arctan\frac{2x+4}{6}+C
=\ln(x^2+4x+13)-\frac{1}{3}\arctan\frac{x+2}{3}+C.
\]

---

### 예제 4: 혼합형(중복 일차 + 기약 이차)

\[
\int \frac{x^3+2x^2+3x+4}{(x-1)^2(x^2+1)}\,dx.
\]
분해 가정:
\[
\frac{x^3+2x^2+3x+4}{(x-1)^2(x^2+1)}
=\frac{A}{x-1}+\frac{B}{(x-1)^2}+\frac{Cx+D}{x^2+1}.
\]
통분·전개·계수비교 → \(\boxed{A=0,\ B=5,\ C=1,\ D=-1}\).
따라서
\[
\int \left(\frac{5}{(x-1)^2}+\frac{x-1}{x^2+1}\right)dx
= -\frac{5}{x-1}+\frac{1}{2}\ln(x^2+1)-\arctan x + C.
\]

---

### 예제 5: 기약 이차의 거듭제곱

\[
\int \frac{x+2}{(x^2+1)^2}\,dx.
\]
분자 분리:
\(\displaystyle \frac{x+2}{(x^2+1)^2}=\frac{x}{(x^2+1)^2}+\frac{2}{(x^2+1)^2}\).

- 첫 항: \(u=x^2+1\Rightarrow du=2x\,dx\),
  \[
  \int \frac{x}{(x^2+1)^2}dx=\frac{1}{2}\int u^{-2}\,du=-\frac{1}{2u}+C=-\frac{1}{2(x^2+1)}.
  \]
- 둘째 항: 감소식 또는 표준 결과
  \[
  \int \frac{dx}{(x^2+1)^2}=\frac{x}{2(x^2+1)}+\frac{1}{2}\arctan x + C.
  \]
합치면
\[
\int \frac{x+2}{(x^2+1)^2}dx
= -\frac{1}{2(x^2+1)} + 2\left[\frac{x}{2(x^2+1)}+\frac{1}{2}\arctan x\right]
= \frac{x-1}{2(x^2+1)}+\arctan x + C.
\]

---

### 예제 6: 서로 다른 차수 혼합(분모가 3차)

\[
\int \frac{x^2+1}{x^3-1}\,dx,\quad x^3-1=(x-1)(x^2+x+1).
\]
분해:
\[
\frac{x^2+1}{(x-1)(x^2+x+1)}=\frac{A}{x-1}+\frac{Bx+C}{x^2+x+1}.
\]
통분·전개·계수비교 → 예를 들어 \(A=\frac{2}{3}, B=-\frac{2}{3}, C=\frac{1}{3}\) (직접 풀어 얻는다).
적분:
\[
\int \frac{A}{x-1}\,dx = \frac{2}{3}\ln|x-1|,
\]
\[
\int \frac{Bx+C}{x^2+x+1}\,dx
= \frac{B}{2}\ln(x^2+x+1)+\frac{2C-B}{\sqrt{4\cdot1-1^2}}\arctan\frac{2x+1}{\sqrt{3}}.
\]
수치 대입으로 최종 정리 가능.

---

### 예제 7: 정적분(부호/절댓값 주의)

\[
\int_0^2 \frac{3x+5}{(x+1)(x+2)}\,dx
= \left[2\ln|x+1|+\ln|x+2|\right]_0^2
=2\ln 3+\ln 4-(2\ln 1+\ln 2)
=2\ln 3+\ln 2.
\]

---

## 고급: 감소식과 일반 공식(요약)

### \(\int \dfrac{dx}{(x^2+a^2)^n}\) 감소식

\[
\int \frac{dx}{(x^2+a^2)^n}=
\frac{x}{2(n-1)a^2(x^2+a^2)^{n-1}}
+\frac{2n-3}{2(n-1)a^2}\int \frac{dx}{(x^2+a^2)^{n-1}},\quad n\ge2.
\]

### \(\int \dfrac{Ax+B}{(x^2+px+q)^n}\) 일반 해법

- 평행이동 \(x\mapsto x+\frac{p}{2}\)로 \((x^2+a^2)\) 꼴로 만들고,
- \(Ax+B\)를 \(\alpha v'(x)+\beta\)로 분리,
- \(\int \dfrac{v'}{v^n}\)은 \(v\)-치환, \(\int \dfrac{dx}{v^n}\)은 7.1 감소식으로 처리.

---

## 실전 팁(함정 방지)

- **다항식 나눗셈 선행**: \(\deg P\ge\deg Q\)면 꼭 먼저!
- **절댓값**: \(\int \dfrac{1}{x-a}dx=\ln|x-a|\). (기약 이차는 항상 양수일 수 있어 \(|\cdot|\) 불필요한 경우가 많음. 예: \(x^2+1>0\))
- **부호/상수 정리**: 로그/아크탄젠트 앞 계수에서 실수 오기 쉽다. 분자 분해( \(\alpha v'+\beta\) )를 습관화.
- **중복 인수**: cover-up은 잘 안 통한다. 계수비교나 선형시스템으로.
- **정적분**: 구간 끝에서 로그의 정의역, 분모의 0, 무한대 등을 확인(불완전정적분 여부).

---

## 표준 템플릿 총정리

1) \(\displaystyle \int \frac{A}{x-a}\,dx = A\ln|x-a|+C\)

2) \(\displaystyle \int \frac{A}{(x-a)^n}\,dx = \frac{-A}{(n-1)(x-a)^{n-1}}+C\quad(n\ge2)\)

3) \(\displaystyle \int \frac{Ax+B}{x^2+px+q}\,dx
= \frac{A}{2}\ln(x^2+px+q)
+\frac{2B-Ap}{\sqrt{4q-p^2}}\arctan\frac{2x+p}{\sqrt{4q-p^2}}+C\)
(\(4q-p^2>0\): 기약 이차)

4) \(\displaystyle \int \frac{dx}{(x^2+a^2)^n}\) 감소식 (7.1)

5) 평행이동: \(x^2+px+q=(x+\tfrac{p}{2})^2+\tfrac{4q-p^2}{4}\)

---

## 코드 예시(심볼릭 분해/적분) — Python/SymPy

```python
# pip install sympy

import sympy as sp

x = sp.symbols('x')

# 부분분수 분해(apart) 예시

expr = (3*x + 5)/((x + 1)*(x + 2))
apart_expr = sp.apart(expr, x)         # -> 2/(x+1) + 1/(x+2)
print("apart:", apart_expr)

# 적분(integrate)

F = sp.integrate(expr, x)
print("∫ expr dx =", sp.simplify(F))

# 혼합형 예제: (x^3+2x^2+3x+4)/((x-1)^2*(x^2+1))

expr2 = (x**3 + 2*x**2 + 3*x + 4)/((x - 1)**2 * (x**2 + 1))
print("apart expr2:", sp.apart(expr2, x))
F2 = sp.integrate(expr2, x)
print("∫ expr2 dx =", sp.simplify(F2))

# 기약 이차 거듭제곱 예제

expr3 = (x + 2)/(x**2 + 1)**2
print("apart expr3:", sp.apart(expr3, x))
F3 = sp.integrate(expr3, x)
print("∫ expr3 dx =", sp.simplify(F3))

# 정적분 예제

G = sp.integrate(expr, (x, 0, 2))
print("∫_0^2 expr dx =", sp.simplify(G))
```

---

## 연습문제 + 풀이 스케치

1) \(\displaystyle \int \frac{7x+1}{(x-2)(x+3)}\,dx\)
   - Cover-up로 \(A,B\) 즉시 산출 → 로그들의 합.

2) \(\displaystyle \int \frac{2x^2+3x+5}{(x-1)^2(x^2+4)}\,dx\)
   - 템플릿: \(\dfrac{A}{x-1}+\dfrac{B}{(x-1)^2}+\dfrac{Cx+D}{x^2+4}\).
   - 계수비교 → 항목별 적분(로그, 역탄젠트, 거듭제곱 일차 항).

3) \(\displaystyle \int \frac{dx}{(x^2+6x+13)^2}\)
   - 완전제곱: \((x+3)^2+4\).
   - \(\displaystyle \int \frac{dx}{((x+3)^2+2^2)^2}\) 감소식 사용 또는 표준 결과 암기.

4) \(\displaystyle \int_{0}^{\infty} \frac{dx}{x^2+4x+5}\)
   - 완전제곱: \((x+2)^2+1\), \(\arctan\)로 수렴성 확인 → \(\big[\arctan(x+2)\big]_0^\infty\).

5) \(\displaystyle \int \frac{x}{(x^2+1)^3}\,dx\)
   - \(u=x^2+1\) 치환으로 한 번에 해결(거듭제곱 분모 패턴 연습).

---

## 마무리 요약

- 유리함수 적분은 **분모 인수 유형**별 템플릿으로 **항목화**하면 **항상** 풀린다.
- **일차** → 로그, **기약 이차** → 로그 \(+\) 아크탄젠트(완전제곱), **거듭제곱** → 치환/감소식.
- 실수 범위에서 복소근은 **기약 이차**로 묶어서 처리.
- 계수 구하기에서 **덮어쓰기법**은 빠르지만, **중복 인수/이차 인수**는 **계수비교**가 안전.
- 계산이 길어지면 SymPy 등의 **CAS**를 병행하여 검증하라.

이로써, 시험·실무 어디서든 유리함수 적분을 정확하고 빠르게 처리할 수 있는 **완전 툴킷**을 갖추게 된다.
