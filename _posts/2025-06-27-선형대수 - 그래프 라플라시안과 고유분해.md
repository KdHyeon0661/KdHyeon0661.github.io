---
layout: post
title: 선형대수 - 그래프 라플라시안과 고유분해
date: 2025-06-27 22:20:23 +0900
category: 선형대수
---
# 🌐 그래프 라플라시안과 고유분해

**그래프 라플라시안(Graph Laplacian)**은  
그래프 구조의 연결 관계를 **행렬**로 나타내는 방식 중 하나로,  
이 행렬의 **고유분해(Eigendecomposition)**는 그래프의 성질을 분석하는 데 매우 강력한 도구입니다.

그래프 기반 머신러닝, 스펙트럴 클러스터링, 노드 임베딩 등  
많은 분야에서 핵심적으로 활용됩니다.

---

## 🧩 1. 그래프 라플라시안이란?

그래프 \( G = (V, E) \)에서:

- \( V \): 정점(노드)
- \( E \): 간선(연결)

### 📘 1-1. 인접행렬 \( A \)

\[
A_{ij} = 
\begin{cases}
1 & \text{노드 } i \text{와 } j \text{가 연결됨} \\
0 & \text{그 외}
\end{cases}
\]

### 📘 1-2. 차수행렬 \( D \)

대각 행렬이며, 각 노드의 연결 수(degree)를 담음:

\[
D_{ii} = \deg(i) = \sum_j A_{ij}
\]

---

### 📘 1-3. 그래프 라플라시안 \( L \)

\[
L = D - A
\]

즉,  
- 대각 성분은 노드의 차수  
- 비대각 성분은 연결 관계에 따라 -1

---

## 🧠 2. 라플라시안의 성질

| 성질 | 설명 |
|------|------|
| 대칭 행렬 | \( L = L^T \) → 항상 실수 고유값 존재 |
| 반정수행렬 | 행의 합 = 0 → 항상 \( \lambda = 0 \) 고유값 존재 |
| 양의 반정정부호 | 모든 고유값 \( \lambda \ge 0 \) |
| 커널 차원 | 연결된 성분의 수만큼 0 고유값 발생 |

---

## 🧪 3. 고유분해: \( L = Q \Lambda Q^T \)

- \( Q \): 고유벡터들 (정규직교)
- \( \Lambda \): 고유값 대각 행렬

이 고유벡터들은 **그래프의 구조를 부드럽게 변화시키는 방향**으로 해석할 수 있음.

---

## 🔎 4. 고유값의 의미

| 고유값 \( \lambda_i \) | 의미 |
|------------------------|------|
| \( \lambda_0 = 0 \) | 항상 존재, 고유벡터는 상수 벡터 |
| \( \lambda_1 \) (Fiedler 값) | 두 번째로 작은 고유값. 그래프의 연결성 반영 |
| \( \lambda_1 \) 고유벡터 (Fiedler vector) | **스펙트럴 클러스터링**의 분할 기준 제공 |

---

## 🧭 5. 예시: 간단한 그래프

그래프:
```
0 — 1 — 2
```

\[
A =
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
,\quad
D =
\begin{bmatrix}
1 & 0 & 0 \\
0 & 2 & 0 \\
0 & 0 & 1
\end{bmatrix}
,\quad
L = D - A =
\begin{bmatrix}
1 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 1
\end{bmatrix}
\]

고유분해하면:

\[
\lambda_0 = 0, \quad \lambda_1 = 1, \quad \lambda_2 = 3
\]

→ \( \lambda_1 \)에 대응되는 고유벡터는 1번 노드를 중심으로 클러스터를 나누는 기준 역할

---

## 🧮 Python 코드 예제

```python
import numpy as np
from scipy.linalg import eigh

# 인접행렬
A = np.array([
    [0, 1, 0],
    [1, 0, 1],
    [0, 1, 0]
])

# 차수행렬
D = np.diag(np.sum(A, axis=1))

# 라플라시안
L = D - A

# 고유분해 (정렬된 고유값과 고유벡터)
eigvals, eigvecs = eigh(L)

print("고유값:", eigvals)
print("Fiedler 벡터:", eigvecs[:, 1])  # 두 번째 고유벡터
```

---

## 🧠 6. 실용적 활용: 스펙트럴 클러스터링

**Fiedler 벡터(두 번째 고유벡터)**를 사용하면  
그래프를 **자연스럽게 두 개로 나눌 수 있음**.

- 벡터 값이 0보다 큰 노드 ↔ 한 쪽 클러스터
- 벡터 값이 0보다 작은 노드 ↔ 다른 쪽 클러스터

→ 이 방식이 바로 **스펙트럴 클러스터링(Spectral Clustering)**입니다.

---

## 🛠️ 7. 변형된 라플라시안 (심화)

| 라플라시안 종류 | 정의 | 특징 |
|----------------|------|------|
| 표준 라플라시안 \( L = D - A \) | 기본 정의 | 고유값/벡터 계산 간단 |
| 정규화 라플라시안 \( L_{sym} = I - D^{-1/2} A D^{-1/2} \) | 대각선 정규화 | 스케일 불균형 보정 |
| 무향 그래프 라플라시안 | 대칭 보장 | 스펙트럼 정리 적용 가능 |

---

## ✅ 요약

| 개념 | 설명 |
|------|------|
| 라플라시안 \( L = D - A \) | 그래프의 연결 구조 표현 |
| 고유분해 \( L = Q \Lambda Q^T \) | 고유값 = 연결성 정보, 고유벡터 = 클러스터 기준 |
| Fiedler 벡터 | 두 번째 고유벡터로 노드를 분할 가능 |
| 활용 | 스펙트럴 클러스터링, 노드 임베딩, 그래프 신호 처리 등 |