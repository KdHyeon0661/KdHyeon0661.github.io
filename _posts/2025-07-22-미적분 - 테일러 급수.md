---
layout: post
title: 미적분 - 테일러 급수
date: 2025-07-22 20:20:23 +0900
category: 미적분
---
# 테일러 급수(Taylor Series) — 이론·직관·예제·코드까지 한 번에

> 목적: **정의 → 수렴 반경 → 나머지항(오차) → 실제 근사 전략 → 경계/반례 → 다변수 확장 → 코드 검증**까지 실전 친화적으로 정리합니다.
> 표기: 수식은 MathJax `$$ ... $$`를 사용합니다. 코드 예제는 Python(SymPy/Numpy) 위주입니다.

---

## 정의와 기본 아이디어

### 정의

함수 \( f \)가 점 \( a \)에서 충분히 미분 가능할 때(보통 \( C^\infty \)), **\(a\)에서의 테일러 급수**는
$$
f(x)\ \overset{formal}{=}\ \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}\,(x-a)^n.
$$

- \(P_n(x)=\displaystyle \sum_{k=0}^n \frac{f^{(k)}(a)}{k!}(x-a)^k\): **\(n\)차 테일러 다항식**
- \(R_n(x)=f(x)-P_n(x)\): **나머지항(오차)**

> ⚠️ “형식적( formal )” 표기입니다. 실제로 **이 급수가 \(f\)로 수렴하는지**는 **수렴 반경**과 함수의 **해석성(analyticity)**에 달려있습니다.

---

## 나머지항(오차)와 수렴

### 라그랑주 나머지항

\(x\)와 \(a\) 사이 어딘가의 \(c\)에 대해
$$
R_n(x)
= \frac{f^{(n+1)}(c)}{(n+1)!}\,(x-a)^{n+1}.
$$

**오차 상계**를 얻는 대표적 방법:
- 구간 \(I\)에서 \(\bigl|f^{(n+1)}(t)\bigr|\le M\)이면
  $$
  |R_n(x)| \le \frac{M}{(n+1)!}\,|x-a|^{n+1},\qquad x\in I.
  $$

### 해석성(Analyticity)과 수렴

- \(f\)가 \(a\)에서 **해석적(analytic)**이면 (즉, 어떤 반지름 \(R>0\) 내 모든 점에서 테일러 급수가 \(f\)로 수렴)
  → **테일러 급수 = 원함수**(반지름 안)
- \(C^\infty\)이지만 **비해석적**일 수 있음: 아래 반례 참고(§8.1).

---

## 수렴 반경 \(R\)과 근본 직관

### 계수로부터 \(R\) 계산(근/비 판정)

계수 \(a_n=\dfrac{f^{(n)}(a)}{n!}\)라 할 때
$$
R=\frac{1}{\limsup\limits_{n\to\infty} \sqrt[n]{|a_n|}}
\quad\text{(근판정)}
\qquad\text{또는}\qquad
R=\lim_{n\to\infty}\left|\frac{a_n}{a_{n+1}}\right|\ \ (\text{존재할 때, 비판정}).
$$

### “가장 가까운 특이점” 법칙(복소해석 직관)

실변수 함수라도 **복소평면**까지 확장했을 때 **가장 가까운 특이점(=해석적이지 않은 점)**까지의 거리 = **수렴 반경**.
- 예: \( f(x)=\dfrac{1}{1+x^2} \). 복소 특이점은 \(x=\pm i\) (원점에서 거리 1) ⇒ **원점 전개의 \(R=1\)**.

---

## 대표 전개와 반경, 오차

### 지수/삼각/로그/분모형

- 지수
  $$
  e^x=\sum_{n=0}^\infty \frac{x^n}{n!},\quad R=\infty.
  $$
- 사인/코사인
  $$
  \sin x=\sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{(2n+1)!},\quad
  \cos x=\sum_{n=0}^\infty (-1)^n\frac{x^{2n}}{(2n)!},\quad R=\infty.
  $$
- 기하급수
  $$
  \frac{1}{1-x}=\sum_{n=0}^\infty x^n,\quad |x|<1\ \ (R=1).
  $$
- 로그
  $$
  \ln(1+x)=\sum_{n=1}^\infty (-1)^{n+1}\frac{x^n}{n},\quad |x|<1,\ x>-1.
  $$
  - \(x\in(0,1)\)에서 **교대급수**이므로 **오차 \(|R_n|\le\text{다음 항}\)**.

- 아크탄젠트
  $$
  \arctan x=\sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{2n+1},\quad |x|<1,\ R=1
  $$
  (\(x=\pm i\)가 최근접 특이점).

- 이항식(루트 등)
  $$
  (1+x)^\alpha=\sum_{n=0}^\infty \binom{\alpha}{n}x^n,\quad |x|<1,\
  \binom{\alpha}{n}=\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}.
  $$

### 오차 실전 예시: \( \ln(1+x) \), \(x\in(0,0.5]\)

\(x>0\)이면 교대급수 → 부분합 \(S_n\)에 대해
$$
|\,\ln(1+x)-S_n\,|\ \le\ \frac{x^{n+1}}{n+1}.
$$
예: \(x=0.5\), 원하는 오차 \(<10^{-6}\).
- 조건: \(\dfrac{0.5^{n+1}}{n+1}<10^{-6}\)을 만족하는 최소 \(n\)을 찾으면 됨(코드 예제 §10.2).

---

## 전개점 선택과 수치 안정성 팁

- **전개점 \(a\)**는 **근사하려는 \(x\)**와 가깝게: \(|x-a|\)가 작을수록 오차 감소.
- **주기/대칭 활용**: \(\sin(x)\)를 \(a=0\) 대신 \(a=\pi\) 근처에서 근사할 때는 \(\sin(x)=\sin(\pi+(x-\pi))=-\sin(x-\pi)\)를 이용해 재중심화.
- **함수 재표현**: \(\ln x\)는 \(x\)가 1 근처가 아니라면 \(\ln x=\ln\!\bigl(\frac{x}{c}\bigr)+\ln c\)로 \(x/c\)를 1에 가깝게 만드는 **스케일링**을 사용.
- **근사와 오차 균형**: 라그랑주 나머지 상계를 쓰되, \(|f^{(n+1)}|\)의 **최대값 추정**이 쉬운 구간에서 작업.

---

## 실제 근사 전략(레시피)

### 목표 오차 \(\varepsilon\) 내 다항식 차수 \(n\) 고르기

- \(e^x\) (맥클로린, \(|x|\le T\))
  \(f^{(n)}=e^x\Rightarrow |f^{(n+1)}(c)| \le e^{T}\).
  $$
  |R_n(x)|\le \frac{e^T}{(n+1)!}|x|^{n+1}\le \varepsilon
  \ \Rightarrow\
  \text{최소 }n\text{을 팩토리얼 증가를 써서 찾음}.
  $$
- \(\ln(1+x)\) (교대, \(x\in(0,1)\))
  $$
  |R_n|\le \frac{x^{n+1}}{n+1}\le \varepsilon
  \Rightarrow n+1\ge \frac{\ln(1/\varepsilon)}{\ln(1/x)} \ \text{근사 추정}.
  $$

### Padé 근사로 보강(참고)

테일러가 높은 차수 필요할 때, **Padé**(유리함수 근사)를 사용하면 적은 차수로 광범위한 영역에서 더 정확. (여기선 개념만 언급)

---

## 예제 모음(손계산 + 검증 포인트)

### \(e^x\) (Maclaurin)

$$
e^x\approx 1+x+\frac{x^2}{2!}+\cdots+\frac{x^n}{n!},
\qquad R=\infty.
$$
- \(|x|\le 1\), \(\varepsilon=10^{-8}\)이면 대략 \(n\approx 12\sim 14\)면 충분(팩토리얼 성장).

### \(\sin x\) 5차 근사(평활 신호 근사)

$$
\sin x \approx x-\frac{x^3}{6}+\frac{x^5}{120}.
$$
- \(|x|\le 0.2\)이면 \(|R_5|\lesssim \frac{|x|^7}{5040}\)로 매우 작음.

### \(\ln(1+x)\), \(x=0.5\)에서 \(\varepsilon=10^{-6}\)

- 오차: \(|R_n|\le \dfrac{0.5^{n+1}}{n+1}<10^{-6}\).
  간단 탐색(코드 §10.2)로 \(n\) 찾기.

### \(\sqrt{1+x}\) (이항 전개, \(|x|<1\))

$$
\sqrt{1+x}=1+\frac{1}{2}x-\frac{1}{8}x^2+\frac{1}{16}x^3-\cdots
$$
- 계수 \(\binom{1/2}{n}\) 부호가 번갈며 작아져, 근사 안정적(단, \(|x|<1\)).

### \(\arctan x\) 반경과 경계

- \(R=1\) (가장 가까운 특이점 \(\pm i\)).
- \(|x|<1\)에서 교대급수: \(|R_n|\le\dfrac{|x|^{2n+3}}{2n+3}\).

### \( \dfrac{1}{1+x^2} \) — 수렴 반경과 이유

- 원점 전개는 \(R=1\). 복소 특이점 \(\pm i\)까지 거리 1.

---

## 반례와 경계: “수렴”과 “원함수 일치”는 다르다

### \(C^\infty\)지만 비해석적 함수

$$
f(x)=
\begin{cases}
e^{-1/x^2}, & x\ne 0,\\
0, & x=0.
\end{cases}
$$
- 모든 도함수 \(f^{(n)}(0)=0\) → **맥클로린 급수는 항마다 0**, 즉 **모든 \(x\)에서 0**.
- 그러나 \(x\ne 0\)에서 \(f(x)>0\).
- 결론: 테일러 급수는 전역 수렴(항상 0)이지만 **원함수와 일치하지 않음**.
  ⇒ **해석성**이 핵심(“수렴=일치”가 아님).

### 수렴은 하지만 느리게: \(\ln(1+x)\), \(x\to 1^{-}\)

- \(x=0.9\) 등에서는 많은 항 필요(다음 항 오차 규칙으로 항수 추정 필수).

---

## 다변수 테일러(Gradient/Hessian 포함)

### 1차/2차 전개

스칼라장 \(f:\mathbb{R}^n\to\mathbb{R}\), 점 \(a\) 근처에서
$$
f(a+h)
= f(a) + \nabla f(a)^\top h
+ \frac{1}{2} h^\top H_f(a)\, h
+ R_2(a,h),
$$
- \(\nabla f(a)\): 그래디언트, \(H_f(a)\): 헤시안
- 최적화에서 2차 근사는 뉴턴 방법의 이론적 기반.

### 선형화/국소 근사

- 비선형 시스템 \(x_{k+1}=g(x_k)\)를 \(x^\star\) 근처에서 선형화:
  \(g(x)\approx g(x^\star)+J_g(x^\star)(x-x^\star)\) (야코비안 \(J_g\)).

---

## 코드 예제 (검증·자동화)

> 주의: 아래 코드는 **예시**로, 실제 실행 환경에 따라 패키지 설치가 필요할 수 있습니다. 블로그엔 그대로 붙여넣기용으로 제공.

### SymPy로 테일러 전개/수렴반경 감각

```python
# Taylor / Maclaurin series with SymPy

import sympy as sp

x = sp.symbols('x')
f1 = sp.exp(x)
f2 = sp.log(1 + x)
f3 = sp.atan(x)
f4 = 1/(1 + x**2)
f5 = sp.sqrt(1 + x)

# Maclaurin up to x^8

print(sp.series(f1, x, 0, 9))
print(sp.series(f2, x, 0, 9))
print(sp.series(f3, x, 0, 9))
print(sp.series(f4, x, 0, 9))
print(sp.series(f5, x, 0, 9))
```

### \(\ln(1+x)\)에서 목표 오차로 필요한 항수 찾기

```python
import math

def n_for_log1p(x, eps=1e-6):
    """
    교대급수 오차 |R_n| <= 다음항 = x^{n+1}/(n+1)
    를 이용해 최소 n 찾기 (x in (0,1)).
    """
    assert 0 < x < 1
    n = 1
    while True:
        if (x**(n+1))/(n+1) < eps:
            return n
        n += 1

for x in [0.1, 0.5, 0.9]:
    n = n_for_log1p(x, 1e-6)
    print(f"x={x}: n={n}")
```

### 라그랑주 나머지 상계로 \(e^x\) 항수 선택

```python
import math

def n_for_exp(x, eps=1e-12, T=None):
    """
    |R_n(x)| <= e^T * |x|^{n+1} / (n+1)!
    구간 상계 T를 지정(없으면 T=|x| 근사)하여 최소 n 탐색.
    """
    if T is None:
        T = abs(x)
    n = 0
    while True:
        term = math.exp(T) * (abs(x)**(n+1)) / math.factorial(n+1)
        if term < eps:
            return n
        n += 1

for x in [0.5, 1.0, 2.0]:
    print(x, n_for_exp(x, 1e-12))
```

### 일반 함수의 \(a\) 중심 \(n\)차 테일러 다항식 작성기

```python
import sympy as sp

def taylor_poly(f, x, a, n):
    """
    f: sympy expression in x
    a: expansion center (number)
    n: degree
    """
    P = 0
    for k in range(n+1):
        dk = sp.diff(f, x, k)       # k차 미분
        dk_a = dk.subs(x, a)        # a에서 평가
        P += dk_a/sp.factorial(k) * (x - a)**k
    return sp.simplify(P)

x = sp.symbols('x')
f = sp.log(1 + x)
P5 = taylor_poly(f, x, 0, 5)
print("P5(x):", sp.expand(P5))
```

### 수렴 반경 감각(계수 근판정) — 형식적 실습

```python
import sympy as sp
n = sp.symbols('n', positive=True, integer=True)

# 예: 1/(1-x)의 계수는 모두 1 → R=1
# 여기서는 계수 수열 a_n의 n제곱근 limsup 계산을 '감각적으로' 본다.
# 실제론 복소 특이점 거리로 판단하는 것이 더 직관적.

# 아크탄젠트 계수: a_{2k+1} = (-1)^k / (2k+1), 짝수항 0
# 실습 관점에서 '근판정' 수치 실험을 하고 싶다면,
# 적당한 n 범위에서 (|a_n|)^(1/n)의 최댓값 추이를 관찰.

```

---

## 고급: 복소해석 관점과 특이점 사례

- \(f(x)=\dfrac{1}{1+x^2}\): 특이점 \(\pm i\)까지 거리 1 → 원점 전개 \(R=1\).
- \(f(x)=\ln(1+x)\): 특이점 \(x=-1\) (로그 가지점) → 원점 전개 \(R=1\).
- \(f(x)=\sqrt{1+x}\): 특이점 \(x=-1\) (분기점) → 원점 전개 \(R=1\).
- \(f(x)=\exp(x)\), \(\sin x\), \(\cos x\): 전체 함수(Entire) → \(R=\infty\).

---

## 응용: 수치해석·미분방정식·최적화

- **수치 적분/미분 근사**: 테일러 전개로 유도되는 **유한 차분(central difference)**, **가우스-저드/뉴턴-코츠** 계열 등에 핵심.
- **뉴턴 방법**: 1차 테일러 선형화 \( f(x)\approx f(a)+f'(a)(x-a) \)에서 유도.
- **ODE 해석**: Picard 반복, 멱급수 해법(특히 특이점 유형에 따라 Frobenius 전개).
- **신호처리**: 작은 왜곡/지연의 국소 근사, 위상 근사 등.

---

## 체크리스트 & 함정

- [ ] **항상**: \(|x-a|<R\) 안에서만 “테일러=원함수” (해석성 필요)
- [ ] 오차 제어: 라그랑주 나머지/교대급수 오차/최대도함수 상계
- [ ] 전개점 선택: **가까울수록** 유리, 스케일링/변수변환 적극 활용
- [ ] 특이점 거리 파악(복소 포함) → **수렴 반경 직감**
- [ ] \(C^\infty\)라도 비해석 가능(§8.1 반례 숙지)
- [ ] 큰 \(|x-a|\)에서 고차항만 늘리면 **수치 불안정**(Padé 등 고려)

---

## 심화 연습문제 (풀이 스케치 포함)

1) \(f(x)=\ln(1+x)\), \(x=0.5\), \(\varepsilon=10^{-6}\).
   **요구**: 최소 차수 \(n\)의 맥클로린 다항식으로 오차 달성.
   **힌트**: \(|R_n|\le \frac{x^{n+1}}{n+1}\). §10.2 코드로 확인.

2) \(f(x)=\dfrac{1}{1+x^2}\)을 \(a=0\)에서 전개.
   **질문**: 수렴 반경?
   **답**: \(R=1\) (복소 특이점 \(\pm i\)).

3) \(f(x)=\sqrt{1+x}\)에서 \(|x|\le 0.2\) 구간의 \(n\)차 다항 오차 상계 유도.
   **힌트**: 이항계수 크기 상계와 라그랑주 나머지 구조 활용.

4) \(f(x)=e^x\), \(|x|\le 2\), \(\varepsilon=10^{-12}\).
   **질문**: 최소 \(n\)?
   **힌트**: §10.3 코드로 탐색. 대략 \(n\approx 16\sim 20\).

5) 비해석 반례 \(f(x)=e^{-1/x^2} (x\ne 0), f(0)=0\).
   **질문**: 맥클로린 급수와 실제 함수의 관계?
   **답**: 급수는 0(전역 수렴)이나 \(x\ne 0\)에서 \(f>0\). ⇒ 비해석.

---

## 요약 표

| 주제 | 핵심 포인트 | 실전 팁 |
|---|---|---|
| 정의 | \(f(x)=\sum \frac{f^{(n)}(a)}{n!}(x-a)^n\) | 다항식으로 **국소 근사** |
| 오차 | 라그랑주 \(R_n=\frac{f^{(n+1)}(c)}{(n+1)!}(x-a)^{n+1}\) | 최대도함수 상계로 **보수적** 추정 |
| 반경 | \(R=1/\limsup \sqrt[n]{|a_n|}\) | **가까운 특이점** 거리(복소 포함) |
| 전개점 | \(|x-a|\) 작게 | 스케일링, 대칭, 주기 활용 |
| 교대 | \(\ln(1+x), \arctan x\) 등 | **다음 항**이 오차 상계 |
| 다변수 | 1·2차 테일러 + Hessian | 최적화/안정성 분석 근간 |
| 경계 | \(C^\infty\not\Rightarrow\) 해석 | 반례 \(e^{-1/x^2}\) 숙지 |

---

### 끝으로

테일러 급수는 “**국소적 구조를 전역적 근사로 펼치는 기술**”입니다.
- **어디까지 수렴하는가(반경)**, **얼마나 잘 맞는가(오차)**, **어디서 전개할까(전개점)**—이 세 가지를 항상 함께 보세요.
