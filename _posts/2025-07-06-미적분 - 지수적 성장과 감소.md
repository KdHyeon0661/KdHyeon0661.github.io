---
layout: post
title: 미적분 - 지수적 성장과 감소
date: 2025-07-06 23:20:23 +0900
category: 미적분
---
# 지수적 성장과 감소 (Exponential Growth & Decay)

## 1. 핵심 개념과 해(미분방정식)

### 1.1 지수적 변화의 정의
한 양 \(y(t)\)의 **순간 변화율**이 그 양 자체에 **비례**하면
$$
\frac{dy}{dt}=k\,y
\quad(\text{상수 }k\in\mathbb{R}).
$$
- \(k>0\): 지수적 **성장** (exponential growth)
- \(k<0\): 지수적 **감소** (exponential decay)

### 1.2 해의 유도(분리형 ODE)
$$
\frac{dy}{y}=k\,dt
\ \Rightarrow\
\int \frac{1}{y}\,dy=\int k\,dt
\ \Rightarrow\
\ln|y|=kt+C
\ \Rightarrow\
y(t)=y_0\,e^{kt},
$$
여기서 \(y_0=y(0)\).

### 1.3 단위와 해석
- \(k\)의 단위: **시간\(^{-1}\)** (예: 년\(^{-1}\), 초\(^{-1}\)).
- \(e\)-접기/늘이기 시간: \(t=1/|k|\)에서 \(y(t)=y_0 e^{\pm 1}\).

---

## 2. 연속 vs 이산(퍼센트율 변환)

### 2.1 “연 \(r\%\) 성장”의 두 해석
- **연속(compounded continuously)**: \(y(t)=y_0 e^{rt}\) (여기서 \(k=r\) [년\(^{-1}\)])
- **연 1회 이산(compounded once)**: \(y_n=y_0(1+r)^n\) (정수 \(n\)년 후)

**등가 변환**
$$
e^{k_{\text{cont}}}=1+r_{\text{disc}}
\quad\Rightarrow\quad
k_{\text{cont}}=\ln(1+r_{\text{disc}}).
$$
예) 연 5% 이산성장: \(k=\ln 1.05\approx 0.04879\,\text{yr}^{-1}\).

### 2.2 일반 주기 \(\Delta t\) 이산→연속
주기마다 배율 \(q\)라면 \(y_{n+1}=q\,y_n\Rightarrow y(t)\approx y_0\,q^{t/\Delta t}=y_0\,e^{(\ln q/\Delta t)t}\).
따라서 등가 연속률 \(k=\dfrac{\ln q}{\Delta t}\).

---

## 3. 배가시간·반감기·평균수명

### 3.1 배가시간(doubling time)
성장 \(k>0\)에서 \(y(T_2)=2y_0\Rightarrow 2=e^{kT_2}\Rightarrow
$$
T_2=\frac{\ln 2}{k}.
$$

### 3.2 반감기(half-life)
감소 \(k>0\)에서 \(y(t)=y_0 e^{-kt}\), \(y(T_{1/2})=\frac{y_0}{2}\Rightarrow
$$
T_{1/2}=\frac{\ln 2}{k}.
$$

### 3.3 e-폴딩 시간(e-folding time)
\(|k|^{-1}\): 값이 \(e\)배(성장) 또는 \(1/e\)배(감소) 되는 시간.

---

## 4. 데이터에서 모델 파라미터 추정(로그 선형화)

### 4.1 직선화
\(y(t)=y_0 e^{kt}\) 양변 로그:
$$
\ln y(t)=\ln y_0 + k\,t.
$$
즉, \((t,\ln y)\) 산점도에서 **기울기 = \(k\)**, **절편 = \(\ln y_0\)**.

### 4.2 최소제곱 직선맞춤(스케치)
관측 \((t_i,y_i)\), \(Y_i=\ln y_i\). 선형회귀로 \(\hat{k}, \widehat{\ln y_0}\) 추정.  
노이즈가 **상대오차(곱셈 노이즈)**일 때 적합.

### 4.3 예(추정)
- 관측 \(y(0)=100\), \(y(5)=180\) (연속 가정).
- \(180=100\,e^{5k}\Rightarrow k=\frac{1}{5}\ln(1.8)\approx 0.1173\,\text{yr}^{-1}\).
- 배가시간 \(T_2=\ln2/k\approx 5.91\)년.

---

## 5. 지수적 성장: 대표 응용과 예제

### 5.1 금융(연속 복리)
$$
A(t)=P e^{rt}.
$$
- 예) \(P=10{,}000\), \(r=6\%\), \(t=7\)년
  $$A=10{,}000\,e^{0.06\times 7}\approx 10{,}000\,e^{0.42}\approx 15{,}210.$$

### 5.2 인구/세포 분열
순탄생률−사망률 \(=k\) 가 상수이면 \(N(t)=N_0 e^{kt}\).  
- 예) 연 2% 성장: \(k=\ln 1.02\approx 0.01980\Rightarrow T_2\approx 35.0\)년.

### 5.3 전염(초기 지수 구간)
감염자 \(I(t)\approx I_0 e^{k t}\) (초기, 자원 제한 전). \(k\)는 전파율−제거율.  
- 초기에 로그-직선 기울기로 \(k\) 추정 가능.

---

## 6. 지수적 감소: 대표 응용과 예제

### 6.1 방사성 붕괴
$$
N(t)=N_0 e^{-\lambda t},\quad \lambda=\frac{\ln 2}{T_{1/2}}.
$$
- 예) \(T_{1/2}=30\)년 → \(\lambda=\ln2/30\approx 0.02310\,\text{yr}^{-1}\).  
  100년 후 잔량: \(N/N_0=e^{-0.02310\times 100}\approx 0.098\) (약 9.8%).

### 6.2 약동학(1구획 소거)
혈중 농도 \(C(t)=C_0 e^{-k t}\).  
- 반감기 \(T_{1/2}=\ln2/k\).  
- 적분 노출량 AUC \(=\int_0^\infty C_0 e^{-kt} dt = C_0/k\).

### 6.3 RC 회로
콘덴서 방전: \(V(t)=V_0 e^{-t/RC}\) (시정수 \(\tau=RC\)).  
충전: \(V(t)=V_\infty(1-e^{-t/\tau})\)는 **증가형 지수 접근** (변형된 지수감소).

### 6.4 뉴턴 냉각
온도 차 \(u=T-T_{\text{env}}\): \(u'=-k u\Rightarrow u(t)=u_0 e^{-k t}\).

---

## 7. 외력·유입 포함(선형 1계 ODE 변형)

### 7.1 상수 유입/소거
$$
\frac{dy}{dt}=k y + b\quad(k\neq 0).
$$
해:
$$
y(t)=\Big(y_0+\frac{b}{k}\Big)e^{k t}-\frac{b}{k}.
$$
- 감소형(\(k<0\))에서 평형 \(y^*=-b/k\)로 지수적 접근.

**예**(정수 유입 \(b>0\) + 비례 소거 \(-\lambda y\)):
$$
y'=-\lambda y + b \Rightarrow y(t)=\big(y_0-\tfrac{b}{\lambda}\big)e^{-\lambda t}+\tfrac{b}{\lambda}.
$$

### 7.2 혼합탱크(체류 시간)
부피 \(V\), 유출유량 \(Q\), 입구 농도 \(C_{\text{in}}\), 탱크 농도 \(C\):
$$
V\frac{dC}{dt}=Q(C_{\text{in}}-C)
\ \Rightarrow\
C(t)=C_{\text{in}}+\big(C_0-C_{\text{in}}\big)e^{-(Q/V)t}.
$$

---

## 8. 시간의존 성장률 \(k(t)\) (비상수)

일반해:
$$
y(t)=y_0\exp\!\Big(\int_0^t k(s)\,ds\Big).
$$
- **계절성**: \(k(t)=\bar{k}+A\cos\omega t\).
- **정책 변화**: 구간별 상수 \(k\)로 나누어 누적 적분.

**예** 구간별 성장률:  
0–3개월 \(k=0.02\,\text{mo}^{-1}\), 3–6개월 \(k=0.01\).  
6개월 후 \(y=y_0 e^{0.02\cdot 3} e^{0.01\cdot 3}\).

---

## 9. 지수 vs 로지스틱(한계 비교)

- 지수: **제약 없음**, 무한 성장/0 접근.
- 로지스틱: 수용력 \(K\) 고려
  $$
  y' = r y\Big(1-\frac{y}{K}\Big).
  $$
초기 \(y\ll K\)에서 \(y\approx y_0 e^{rt}\) (지수와 동일), 이후 포화.

---

## 10. 역문제: 시간·율·최초값 구하기

### 10.1 임계 도달 시간
목표 \(y^\*\) 달성 시간 \(t^\*\):
$$
t^\*=\frac{1}{k}\ln\frac{y^\*}{y_0}\quad(\text{성장 }k>0),
\qquad
t^\*=\frac{1}{|k|}\ln\frac{y_0}{y^\*}\quad(\text{감소 }k<0).
$$

### 10.2 초기값/율 추정
두 시점 \(t_1,t_2\) 관측:
$$
k=\frac{\ln y(t_2)-\ln y(t_1)}{t_2-t_1},\qquad
y_0=y(t_1)e^{-k t_1}.
$$

---

## 11. 수치해석: Euler, Heun, RK4 비교(간단 스니펫)

아날리틱 해가 있어도 **불균일 \(k(t)\)**, **잡음 포함 데이터 동화** 등에서는 수치적분이 필요하다.

```python
# y' = k(t) y, y(0)=y0 의 수치해석 비교: Euler, Heun(개선 오일러), RK4
import numpy as np

def k_of_t(t):
    # 예: 계절성 성장률(평균 0.1/yr, 진폭 0.05/yr, 주기 1yr)
    return 0.1 + 0.05*np.cos(2*np.pi*t)

def exact(t, y0):
    # 정확해: y = y0 * exp(∫ k(s) ds)
    # k(t) = a + b cos(2π t) → ∫ k = a t + (b/(2π)) sin(2π t)
    a, b = 0.1, 0.05
    return y0 * np.exp(a*t + (b/(2*np.pi))*np.sin(2*np.pi*t))

def euler_step(y, t, h):
    return y + h*k_of_t(t)*y

def heun_step(y, t, h):
    k1 = k_of_t(t)*y
    y_star = y + h*k1
    k2 = k_of_t(t+h)*y_star
    return y + h*0.5*(k1 + k2)

def rk4_step(y, t, h):
    k1 = k_of_t(t)*y
    k2 = k_of_t(t+h/2)*(y + h*k1/2)
    k3 = k_of_t(t+h/2)*(y + h*k2/2)
    k4 = k_of_t(t+h)*(y + h*k3)
    return y + (h/6)*(k1 + 2*k2 + 2*k3 + k4)

def integrate(step, y0=1.0, T=5.0, N=500):
    h = T/N
    t = 0.0
    ys = [y0]; ts = [0.0]
    y = y0
    for _ in range(N):
        y = step(y, t, h)
        t += h
        ys.append(y); ts.append(t)
    return np.array(ts), np.array(ys)

y0 = 1.0
ts_e, ye = integrate(euler_step, y0)
ts_h, yh = integrate(heun_step, y0)
ts_r, yr = integrate(rk4_step, y0)
ts_x = np.linspace(0, 5, 2001)
yx = exact(ts_x, y0)

# 이후: 오차(norm) 비교, 혹은 그래프(환경에 따라 matplotlib 사용)
print("Euler@T=5  ≈", ye[-1])
print("Heun @T=5  ≈", yh[-1])
print("RK4  @T=5  ≈", yr[-1])
print("Exact@T=5  ≈", yx[-1])
```

---

## 12. 실전 시나리오 예제(완전 해설)

### 예제 A. “3년마다 20%씩 증가”의 연속 성장률과 배가시간
- 이산주기 배율 \(q=1.20\), 주기 \(\Delta t=3\)년  
  등가 연속률:
  $$
  k=\frac{\ln q}{\Delta t}=\frac{\ln 1.2}{3}\approx 0.0603\,\text{yr}^{-1}.
  $$
- 배가시간:
  $$
  T_2=\frac{\ln 2}{k}\approx \frac{0.6931}{0.0603}\approx 11.5\ \text{년}.
  $$

### 예제 B. 반감기 8일인 약물의 제거상수 \(k\)와 3일 후 잔량
- \(T_{1/2}=8\)일 → \(k=\ln2/8\approx 0.08664\,\text{day}^{-1}\).
- 3일 후 잔량 비:
  $$
  \frac{y(3)}{y_0}=e^{-k\cdot 3}\approx e^{-0.2599}\approx 0.771.
  $$

### 예제 C. 혼합탱크: 깨끗한 물로 희석
- \(V=1000\ \text{L}\), \(Q=50\ \text{L/min}\), 초기 농도 \(C_0=2\ \text{g/L}\), 유입 \(C_{\text{in}}=0\).
- 해: \(C(t)=C_0 e^{-(Q/V)t}=2e^{-0.05 t}\).
- 30분 후 농도: \(2e^{-1.5}\approx 0.446\ \text{g/L}\).

### 예제 D. 금융: 연 5% APR 월복리 vs 연속복리 10년
- 월복리: \(A=P(1+0.05/12)^{120}\approx P\times 1.647009\).
- 연속복리: \(A=P e^{0.05\times 10}\approx P\times 1.648721\).
- 두 방식 차이는 미미(약 0.10%p).

### 예제 E. 시간의존률: “강화→유지→완화” 정책
- 0–2주 \(k=0.15\ \text{wk}^{-1}\), 2–6주 \(k=0\), 6–10주 \(k=-0.10\).  
- 누적: \(y(10)=y_0\,e^{0.15\cdot 2}\cdot e^{0\cdot 4}\cdot e^{-0.10\cdot 4}
= y_0\,e^{0.3-0.4}\approx 0.905\,y_0\).

---

## 13. 모델 검증·추정 코드(로그-회귀)

```python
# ln y = a + k t 선형회귀로 k, y0 추정 (가상 데이터 생성 포함)
import numpy as np

rng = np.random.default_rng(7)
k_true = 0.12       # 연속 성장률
y0_true = 150.0
t = np.linspace(0, 5, 21)  # 0~5년, 21개 포인트
y_clean = y0_true*np.exp(k_true*t)
# 상대오차 5% 로그정규 노이즈
y_obs = y_clean * np.exp(rng.normal(0.0, 0.05, size=t.size))

# 로그 선형회귀
Y = np.log(y_obs)
A = np.c_[np.ones_like(t), t]
coeff, *_ = np.linalg.lstsq(A, Y, rcond=None)
a_hat, k_hat = coeff
y0_hat = np.exp(a_hat)

print(f"true  : k={k_true:.5f}, y0={y0_true:.2f}")
print(f"estimate: k={k_hat:.5f}, y0={y0_hat:.2f}")

# 예측/잔차 체크
y_fit = y0_hat*np.exp(k_hat*t)
mape = np.mean(np.abs((y_fit - y_obs)/y_obs))*100
print(f"MAPE ≈ {mape:.2f}%")
```

---

## 14. 자주 하는 실수와 체크리스트

- [ ] **퍼센트-율 전환**: “연 5% 증가”를 \(k=0.05\)로 **그대로** 쓰면 **연속복리 가정**이다. 이산이면 \(k=\ln(1+0.05)\).  
- [ ] **시간 단위**: \(k\)의 단위를 항상 명시(년\(^{-1}\), 월\(^{-1}\), 초\(^{-1}\)). 단위 불일치 → 큰 오차.
- [ ] 로그 선형화 시 \(y\le 0\) 데이터는 직접 로그 불가(측정오차 보정·모형 재평가).
- [ ] **외력 \(b\)**가 있으면 순수 지수형이 아님(평형값 존재).  
- [ ] 초기 몇 점으로 \(k\) 추정한 뒤 전 범위에 적용하면 포화·정책변화 등 맥락을 놓칠 수 있음(구간별 \(k\) 적합).
- [ ] 반감기/배가시간은 **항상 \(\ln 2\)**가 분자에 온다(10%와 혼동 금지).
- [ ] 데이터 단위 변환 시 로그-선형 회귀의 절편 해석(초기값)이 바뀜.

---

## 15. 연습문제(풀이 스케치)

1) \(y(0)=80\), 9개월 뒤 \(y=100\) (연속). 월 단위 \(k\)와 1년 뒤 값?
- \(k=\frac{1}{9}\ln(100/80)\approx 0.0240\,\text{mo}^{-1}\).  
- 12개월 뒤 \(y=80 e^{k\cdot 12}\approx 80 e^{0.288}\approx 107.0\).

2) 반감기 18시간인 물질. 2일 후 잔량 비?
- \(k=\ln2/18\,\text{h}^{-1}\), \(t=48\)h → \(e^{-kt}\approx e^{-1.848}\approx 0.157\).

3) \(y'=-0.4\,y+5\), \(y(0)=0\). 평형과 10단위(시간) 후 값?
- 평형 \(y^*=\frac{5}{0.4}=12.5\).  
- \(y(t)=12.5(1-e^{-0.4 t})\) → \(y(10)\approx 12.5(1-e^{-4})\approx 12.3\).

4) 관측 \((t,y)=(0,50),(4,90)\). 배가시간?
- \(k=\frac{\ln(90)-\ln(50)}{4}=0.1520\) → \(T_2=\ln2/k\approx 4.56\).

5) 혼합탱크 \(V=500\ \text{L}\), \(Q=25\ \text{L/min}\), \(C_{\text{in}}=3\), \(C_0=0\). 20분 후 농도?
- \(C(t)=3(1-e^{-(Q/V)t})=3(1-e^{-1})\approx 1.896\).

---

## 16. 한눈 요약

- **모형**: \(y'=k y\Rightarrow y=y_0 e^{kt}\). \(k>0\) 성장, \(k<0\) 감소.  
- **시간지표**: \(T_2=T_{1/2}=\dfrac{\ln 2}{|k|}\), \(e\)-fold \(=1/|k|\).  
- **이산↔연속**: \(k=\dfrac{\ln q}{\Delta t}\).  
- **선형화**: \(\ln y=\ln y_0+k t\) (회귀로 \(k\) 추정).  
- **외력 포함**: \(y'=k y + b\Rightarrow y\to -b/k\) (감소형에서 평형).  
- **응용 범위**: 금융·방사성·약동학·RC·냉각·혼합탱크 등 **광범위**.

위 절차(정의→해→단위→추정→응용→수치검증)를 익히면 **지수적 성장/감소** 문제에서 모델링·해석·계산·검증을 **일관성 있게** 수행할 수 있다.