---
layout: post
title: 파이썬 심화 - 문자열과 텍스트 (3)
date: 2025-11-26 19:25:23 +0900
category: 파이썬 심화
---
# 문자열과 텍스트 (3)

파이썬에서 문자열 처리는 데이터 가공, 로그 생성, 보고서 작성, 웹 개발 등 다양한 분야에서 핵심적인 역할을 합니다. 효과적인 문자열 조작 기법을 익히면 코드의 가독성과 성능을 크게 향상시킬 수 있습니다.

## 문자열 합치기와 연결

여러 문자열을 하나로 합치는 작업은 가장 기본적이면서도 자주 사용되는 문자열 연산입니다. 다양한 방법과 각 방법의 특성에 대해 알아봅니다.

```python
# 1. '+' 연산자를 이용한 간단한 문자열 연결
name = "김철수"
greeting = "안녕하세요, " + name + "님!"
print(greeting)  # 안녕하세요, 김철수님!

# 2. join() 메서드를 이용한 효율적인 문자열 연결
# 리스트나 튜플의 요소들을 연결할 때 가장 효율적
parts = ['서울특별시', '강남구', '테헤란로', '123']
address = ' '.join(parts)
print(address)  # 서울특별시 강남구 테헤란로 123

# 다양한 구분자 활용
csv_data = ','.join(['사과', '바나나', '오렌지', '포도'])
path = '/'.join(['home', 'user', 'documents', 'report.pdf'])
lines = '\n'.join(['첫 번째 줄', '두 번째 줄', '세 번째 줄'])

# 3. 문자열 반복과 연결
separator = '-' * 50
header = '중요 알림' + '!' * 3
print(separator)
print(header)
print(separator)

# 4. 대량의 문자열 연결 시 성능 비교
import timeit

# 비효율적인 방법: + 연산자를 반복 사용
def concat_with_plus(n):
    result = ""
    for i in range(n):
        result += "문자열"
    return result

# 효율적인 방법: 리스트에 모아서 join 사용
def concat_with_join(n):
    result = []
    for i in range(n):
        result.append("문자열")
    return "".join(result)

# 성능 테스트
n = 10000
time_plus = timeit.timeit(lambda: concat_with_plus(n), number=100)
time_join = timeit.timeit(lambda: concat_with_join(n), number=100)

print(f"+ 연산자: {time_plus:.4f}초")
print(f"join() 메서드: {time_join:.4f}초")
```

## 문자열에 변수 사용하기 (문자열 포매팅)

동적인 값을 문자열에 삽입하는 방법은 여러 가지가 있으며, 각 방법은 특정 상황에 더 적합합니다.

```python
# 1. % 연산자 (구식 방법이지만 여전히 사용됨)
name = "이영희"
age = 28
score = 95.5

# 기본 사용법
message = "이름: %s, 나이: %d, 점수: %.2f" % (name, age, score)
print(message)  # 이름: 이영희, 나이: 28, 점수: 95.50

# 딕셔너리와 함께 사용
data = {'product': '노트북', 'price': 1500000, 'discount': 15}
info = "제품: %(product)s, 가격: %(price)d, 할인율: %(discount)d%%" % data
print(info)

# 2. str.format() 메서드 (Python 2.6 이상)
# 위치 기반 포매팅
template = "안녕하세요, {}님! 오늘은 {}년 {}월 {}일입니다."
formatted = template.format("홍길동", 2024, 1, 15)
print(formatted)

# 이름 기반 포매팅
report = """
회원 정보
---------
이름: {name}
나이: {age}
등급: {grade}
포인트: {points:,}점
"""

formatted_report = report.format(
    name="김철수",
    age=30,
    grade="골드",
    points=12500
)
print(formatted_report)

# 3. f-문자열 (Python 3.6+ 권장)
# 가장 현대적이고 가독성이 좋은 방법
name = "박지민"
department = "개발팀"
years = 3
projects = ["웹 서비스", "모바일 앱", "데이터 파이프라인"]

# 기본 사용
intro = f"{name}님은 {department}에서 {years}년째 근무 중입니다."
print(intro)

# 표현식 사용
price = 25000
quantity = 3
total = f"총 가격: {price * quantity:,}원 (개당 {price:,}원)"
print(total)

# 함수 호출
def get_grade(score):
    if score >= 90: return "A"
    elif score >= 80: return "B"
    elif score >= 70: return "C"
    else: return "F"

student_score = 85
result = f"학생 성적: {student_score}점 (등급: {get_grade(student_score)})"
print(result)

# 딕셔너리와 함께 사용
user = {'id': 'user123', 'name': '김민수', 'role': '관리자'}
access_msg = f"사용자 {user['name']}({user['id']})님, {user['role']} 권한으로 접속했습니다."
print(access_msg)

# 4. 템플릿 문자열 (보안이 중요한 경우)
from string import Template

# 안전한 문자열 포매팅 (사용자 입력 처리 시 유용)
template = Template('$name님의 계좌 잔액은 $balance원입니다.')
safe_message = template.substitute(name='홍길동', balance='10,000')
print(safe_message)

# 딕셔너리로 값 전달
data = {'name': '이영희', 'balance': '25,000'}
safe_message2 = template.substitute(data)
print(safe_message2)
```

## 텍스트 형식 고정하기 (정렬 및 포매팅)

텍스트를 특정 형식으로 정렬하거나 고정 너비로 표현하는 것은 보고서 생성, 로그 출력, 데이터 표시 등에서 중요합니다.

```python
# 1. 정렬 메서드
text = "Python"

print(f"좌측 정렬: '{text:<10}'")      # 'Python    '
print(f"우측 정렬: '{text:>10}'")      # '    Python'
print(f"가운데 정렬: '{text:^10}'")    # '  Python  '
print(f"가운데 정렬 (채움): '{text:*^10}'")  # '**Python**'

# 2. 숫자 형식 지정
import math

pi = math.pi
print(f"π 값: {pi}")                    # 3.141592653589793
print(f"π 값 (소수점 2자리): {pi:.2f}") # 3.14
print(f"π 값 (소수점 4자리): {pi:.4f}") # 3.1416

# 3. 다양한 숫자 포맷
number = 1234567.8912

print(f"천 단위 구분: {number:,}")           # 1,234,567.8912
print(f"소수점 2자리: {number:,.2f}")        # 1,234,567.89
print(f"퍼센트: {0.4567:.2%}")               # 45.67%
print(f"지수 표기: {number:.2e}")           # 1.23e+06
print(f"16진수: {255:x}")                   # ff
print(f"2진수: {42:b}")                     # 101010

# 4. 날짜 및 시간 형식 지정
from datetime import datetime

now = datetime.now()

print(f"기본 형식: {now}")                          # 2024-01-15 14:30:00.123456
print(f"사용자 정의: {now:%Y년 %m월 %d일 %H시 %M분}")  # 2024년 01월 15일 14시 30분
print(f"간단한 형식: {now:%y-%m-%d}")                # 24-01-15

# 5. 고정 너비 테이블 생성
headers = ["이름", "부서", "연봉", "입사일"]
employees = [
    ["김철수", "개발팀", 55000000, "2018-03-15"],
    ["이영희", "디자인팀", 48000000, "2019-07-22"],
    ["박지민", "영업팀", 52000000, "2020-01-10"],
    ["최윤호", "마케팅팀", 51000000, "2021-11-05"]
]

# 각 열의 최대 너비 계산
col_widths = [max(len(str(item)) for item in col) 
              for col in zip(headers, *employees)]

# 헤더 출력
header_row = " | ".join(f"{header:^{width}}" 
                       for header, width in zip(headers, col_widths))
print(header_row)
print("-" * len(header_row))

# 데이터 행 출력
for emp in employees:
    row = " | ".join(f"{str(item):<{width}}" 
                     for item, width in zip(emp, col_widths))
    print(row)
```

## HTML 및 XML 엔티티 처리

웹 개발이나 문서 처리 시 HTML/XML의 특수 문자를 안전하게 처리하는 방법을 알아봅니다.

```python
# 1. html 모듈을 이용한 엔티티 변환
import html

# HTML 특수 문자 이스케이프
text_with_html = '<script>alert("XSS")</script> & "특수문자"'
escaped = html.escape(text_with_html)
print("이스케이프된 HTML:")
print(escaped)  # &lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt; &amp; &quot;특수문자&quot;

# 이스케이프 해제
unescaped = html.unescape(escaped)
print("\n원본 복원:")
print(unescaped)  # <script>alert("XSS")</script> & "특수문자"

# 2. XML 엔티티 처리
import xml.sax.saxutils

xml_text = '데이터 < 10 & 데이터 > 5'
xml_escaped = xml.sax.saxutils.escape(xml_text)
print(f"\nXML 이스케이프: {xml_escaped}")  # 데이터 &lt; 10 &amp; 데이터 &gt; 5

xml_unescaped = xml.sax.saxutils.unescape(xml_escaped)
print(f"XML 언이스케이프: {xml_unescaped}")  # 데이터 < 10 & 데이터 > 5

# 3. 사용자 정의 엔티티 매핑
custom_entities = {
    '©': '&copy;',
    '®': '&reg;',
    '€': '&euro;',
    '한글': '&#xD55C;&#xAE00;'  # 유니코드 이스케이프
}

def custom_escape(text, entity_map):
    result = text
    for char, entity in entity_map.items():
        result = result.replace(char, entity)
    return result

sample = "저작권 © 2024 한글 테스트 ®"
custom_escaped = custom_escape(sample, custom_entities)
print(f"\n사용자 정의 이스케이프: {custom_escaped}")

# 4. BeautifulSoup을 이용한 HTML 파싱 및 처리
try:
    from bs4 import BeautifulSoup
    
    html_content = """
    <html>
        <body>
            <h1>제목</h1>
            <p>이것은 <strong>중요한</strong> 내용입니다. &copy; 2024</p>
            <script>alert('안녕하세요');</script>
            <a href="http://example.com">링크</a>
        </body>
    </html>
    """
    
    soup = BeautifulSoup(html_content, 'html.parser')
    
    # 스크립트 태그 제거
    for script in soup.find_all('script'):
        script.decompose()
    
    # 텍스트만 추출
    clean_text = soup.get_text()
    print("\n정제된 텍스트:")
    print(clean_text)
    
    # 특정 태그 내용 수정
    for p in soup.find_all('p'):
        p.string = "수정된 내용: " + p.get_text()
    
    print("\n수정된 HTML:")
    print(str(soup))
    
except ImportError:
    print("\nBeautifulSoup이 설치되지 않았습니다. 설치: pip install beautifulsoup4")

# 5. 실용적인 웹 텍스트 처리 예제
def prepare_web_content(content, max_length=500):
    """
    웹에 표시할 내용을 준비하는 함수:
    1. HTML 태그 제거
    2. 특수 문자 이스케이프
    3. 길이 제한
    4. 줄 바꿈 처리
    """
    # 간단한 HTML 태그 제거 (정규표현식 사용)
    import re
    text_only = re.sub(r'<[^>]+>', '', content)
    
    # HTML 이스케이프
    safe_text = html.escape(text_only)
    
    # 길이 제한
    if len(safe_text) > max_length:
        safe_text = safe_text[:max_length] + "..."
    
    # 줄바꿈을 <br> 태그로 변환
    safe_text = safe_text.replace('\n', '<br>')
    
    return safe_text

# 테스트
user_input = """안녕하세요!<script>악성코드</script>
이것은 테스트 <b>메시지</b>입니다.
"특수문자" & < > 사용 테스트
줄바꿈도 테스트합니다."""

safe_output = prepare_web_content(user_input)
print("\n안전한 웹 콘텐츠:")
print(safe_output)
```

## 결론

파이썬의 문자열 처리 기능은 매우 풍부하고 다양하며, 각 상황에 맞는 최적의 방법을 선택하는 것이 중요합니다. 문자열 연결에는 대량 데이터 처리 시 `join()` 메서드가 효율적이며, 변수 삽입에는 가독성이 뛰어난 f-문자열을 사용하는 것이 좋습니다. 텍스트 형식 고정을 통해 보기 좋은 출력물을 생성할 수 있고, HTML/XML 엔티티 처리는 웹 보안과 데이터 무결성에 필수적입니다.

이러한 문자열 처리 기술을 숙지하면 데이터 가공, 로깅, 보고서 생성, 웹 개발 등 다양한 영역에서 더 견고하고 효율적인 코드를 작성할 수 있습니다. 특히 사용자 입력을 처리하거나 외부 시스템과 데이터를 교환할 때는 적절한 이스케이프 처리를 통해 보안 취약점을 방지해야 합니다. 파이썬의 표준 라이브러리와 서드파티 라이브러리를 효과적으로 활용하면 복잡한 텍스트 처리 작업도 간결하게 구현할 수 있습니다.