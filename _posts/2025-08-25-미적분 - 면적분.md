---
layout: post
title: 미적분 - 면적분
date: 2025-08-25 22:20:23 +0900
category: 미적분
---
# 면적분(Surface Integrals)

핵심은 다음과 같다.

- **스칼라 면적분**: 곡면 위의 스칼라장 \(f\)를 \(\displaystyle \iint_{S} f\,dS\) 형태로 적분
- **벡터 면적분(플럭스)**: 벡터장 \(\mathbf F\)의 곡면을 통과하는 유량 \(\displaystyle \iint_{S} \mathbf F\cdot \mathbf n\,dS\)
- **매개화와 면소(element) \(dS\)**: \(\mathbf r(u,v)\)로 매개화하면 \(dS=\|\mathbf r_u\times \mathbf r_v\|\,du\,dv\)
- **방향(orientation)**: \(\mathbf n\)의 선택(외향/내향)이 플럭스의 부호를 결정
- **그래프/암시적/매개화 표기**와 좌표계(직교/극/구면/원통) 변환


---

## 면적분의 정의

### 스칼라장에 대한 면적분

곡면 \(S\) 위 스칼라장 \(f(x,y,z)\)의 면적분은 (면적 요소 \(dS\)를 통해)
$$
\boxed{
\iint_{S} f\,dS := \lim_{\max\Delta S_i\to 0}\sum_i f(P_i)\,\Delta S_i.
}
$$

### 벡터장에 대한 면적분(플럭스)

벡터장 \(\mathbf F=\langle P,Q,R\rangle\)와 단위법선 \(\mathbf n\)에 대해
$$
\boxed{
\iint_{S} \mathbf F\cdot \mathbf n\,dS := \lim_{\max\Delta S_i\to 0}\sum_i \mathbf F(P_i)\cdot \mathbf n(P_i)\,\Delta S_i.
}
$$
이는 **곡면을 가로지르는 유량**(flux)을 나타낸다. \(\mathbf n\)의 방향(외향/내향)에 따라 값의 부호가 바뀐다.

---

## 면적요소 \(dS\): 세 가지 표준 형태

### 매개화 표기(가장 일반적)

곡면 \(S\)가 \((u,v)\in D\subset\mathbb R^2\)로
$$
\mathbf r(u,v)=\langle x(u,v),\,y(u,v),\,z(u,v)\rangle
$$
로 매개화될 때,
$$
\mathbf r_u=\frac{\partial \mathbf r}{\partial u},\quad
\mathbf r_v=\frac{\partial \mathbf r}{\partial v},\quad
dS=\|\mathbf r_u\times \mathbf r_v\|\,du\,dv.
$$
또한 단위법선은
$$
\mathbf n=\frac{\mathbf r_u\times \mathbf r_v}{\|\mathbf r_u\times \mathbf r_v\|}\quad(\text{방향 선택 필요})
$$
이다. 따라서
$$
\iint_{S} f\,dS=\iint_{D} f(\mathbf r(u,v))\,\|\mathbf r_u\times \mathbf r_v\|\,du\,dv,
$$
$$
\iint_{S} \mathbf F\cdot \mathbf n\,dS=\iint_{D} \mathbf F(\mathbf r(u,v))\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv.
$$

### 그래프 표기 \(z=g(x,y)\)

\(S:\ z=g(x,y),\ (x,y)\in R\subset\mathbb R^2\)
일 때 법선(위로 향한 방향 선택 시)
$$
\mathbf n\,dS=\frac{\langle -g_x,\,-g_y,\,1\rangle}{\sqrt{1+g_x^2+g_y^2}}\cdot \sqrt{1+g_x^2+g_y^2}\,dx\,dy
=\langle -g_x,\,-g_y,\,1\rangle\,dx\,dy.
$$
즉,
$$
dS=\sqrt{1+g_x^2+g_y^2}\,dx\,dy,
$$
$$
\iint_{S} f\,dS=\iint_{R} f(x,y,g(x,y))\sqrt{1+g_x^2+g_y^2}\,dx\,dy,
$$
$$
\iint_{S} \mathbf F\cdot \mathbf n\,dS=\iint_{R} \mathbf F(x,y,g)\cdot\langle -g_x,-g_y,1\rangle\,dx\,dy.
$$
(아래 방향 선택 시 부호가 반전된다.)

### 암시적 표기 \(F(x,y,z)=0\)

\(\nabla F\neq 0\) 인 곳에서
$$
\mathbf n=\pm\frac{\nabla F}{\|\nabla F\|},\qquad
dS=\frac{\|\nabla F\|}{\|\nabla F\cdot \mathbf k\|}\,dx\,dy \ \text{등 좌표 선택에 따라 변환}
$$
을 사용할 수 있으나, 실전에서는 **매개화** 혹은 **그래프**가 더 계산 친화적이다.

---

## 미분기하적 관점(제1기본형식)

매개화 \(\mathbf r(u,v)\)의 **제1기본형식** 계수
$$
E=\mathbf r_u\cdot \mathbf r_u,\quad F=\mathbf r_u\cdot \mathbf r_v,\quad G=\mathbf r_v\cdot \mathbf r_v
$$
에 대해
$$
\boxed{\ dS=\sqrt{EG-F^2}\,du\,dv\ }.
$$
또한 \(\|\mathbf r_u\times \mathbf r_v\|=\sqrt{EG-F^2}\).

---

## 플럭스(벡터 면적분)의 표준 공식

### 매개화 버전

$$
\boxed{
\iint_{S}\mathbf F\cdot \mathbf n\,dS=\iint_{D}\mathbf F(\mathbf r(u,v))\cdot\big(\mathbf r_u\times \mathbf r_v\big)\,du\,dv.
}
$$
방향을 바꾸면 \(\mathbf r_v\times \mathbf r_u=-(\mathbf r_u\times\mathbf r_v)\)로 부호가 바뀐다.

### 그래프 \(z=g(x,y)\), 위쪽 법선

$$
\boxed{
\iint_{S}\mathbf F\cdot \mathbf n\,dS=\iint_{R} \mathbf F(x,y,g)\cdot\langle -g_x,-g_y,1\rangle\,dx\,dy.}
$$

---

## 좌표계별 매개화와 면소

### 구면좌표(반지름 \(R\) 구면)

\[
\mathbf r(\phi,\theta)=\langle R\sin\phi\cos\theta,\ R\sin\phi\sin\theta,\ R\cos\phi\rangle,
\]
\[
\mathbf r_\phi\times \mathbf r_\theta=R^2\sin\phi\,\hat{\mathbf n},\qquad
dS=R^2\sin\phi\,d\phi\,d\theta.
\]
구면 전체 면적: \(\displaystyle 4\pi R^2\).

### 원통좌표(반지름 \(R\) 원기둥 옆면)

\[
\mathbf r(\theta,z)=\langle R\cos\theta,\ R\sin\theta,\ z\rangle,\quad
\|\mathbf r_\theta\times \mathbf r_z\|=R,\quad dS=R\,d\theta\,dz.
\]

### 일반 곡면 표준들

- 평면: 적절한 그래프/매개화로 간단히 \(dS\) 산출
- 원환면(토러스), 나선면(helicoid), 쌍곡면 등: \(\mathbf r_u,\mathbf r_v\)로 직접 계산

---

## 예제 (스칼라 면적분)

### 예제 1: 평면 \(z=ax+by+c\) 위 \(f(x,y,z)=1\)의 면적분(즉, 면적)

그래프 \(z=g(x,y)=ax+by+c\).
\(\displaystyle dS=\sqrt{1+a^2+b^2}\,dx\,dy\).
평면 도메인 \(R\)에 대해
$$
\iint_{S} 1\,dS = \iint_{R} \sqrt{1+a^2+b^2}\,dx\,dy
= \sqrt{1+a^2+b^2}\ \mathrm{Area}(R).
$$
즉, \(S\)가 \(R\)의 **기울어진 평면**이면 면적은 기울기 계수만큼 배수.

---

### 예제 2: 포물면 \(z=x^2+y^2\), 원판 \(x^2+y^2\le a^2\) 위 \(f(x,y,z)=z\)

그래프 표기: \(g(x,y)=x^2+y^2\), \(g_x=2x,g_y=2y\).
\[
dS=\sqrt{1+4x^2+4y^2}\,dx\,dy.
\]
면적분:
\[
\iint_{S} z\,dS=\iint_{x^2+y^2\le a^2} (x^2+y^2)\sqrt{1+4x^2+4y^2}\,dx\,dy.
\]
극좌표 \(x=r\cos\theta, y=r\sin\theta\), \(r\in[0,a]\):
\[
=\int_{0}^{2\pi}\int_{0}^{a} r^2\sqrt{1+4r^2}\ r\,dr\,d\theta
=2\pi\int_{0}^{a} r^3\sqrt{1+4r^2}\,dr.
\]
치환 \(u=1+4r^2\Rightarrow du=8r\,dr\).
\[
2\pi\int_{r=0}^{a} r^3\sqrt{1+4r^2}\,dr
=2\pi\int_{u=1}^{1+4a^2} \frac{(u-1)}{8}\cdot \frac{\sqrt{u}}{8}\,du
= \frac{\pi}{32}\int_{1}^{1+4a^2} (u-1)\,u^{1/2}\,du.
\]
이 적분을 계산하면 닫힌형으로 표현 가능(원시함수로 정리). (코드로 검증 아래 참조)

---

### 예제 3: 구면 \(x^2+y^2+z^2=R^2\) 상수장 \(f\equiv c\)

구면 좌표:
\[
\iint_{S} c\,dS = c\iint_{S} dS = c\cdot 4\pi R^2.
\]

---

### 예제 4: 나선면(Helicoid) 면적분

나선면 매개화(파라미터 \(u\in[0,a], v\in[0,2\pi]\)):
\[
\mathbf r(u,v)=\langle u\cos v,\ u\sin v,\ kv\rangle.
\]
\[
\mathbf r_u=\langle \cos v,\ \sin v,\ 0\rangle,\quad
\mathbf r_v=\langle -u\sin v,\ u\cos v,\ k\rangle.
\]
\[
\|\mathbf r_u\times \mathbf r_v\|=\sqrt{u^2+k^2}.
\]
따라서
\[
\iint_{S} f\,dS=\int_{v=0}^{2\pi}\int_{u=0}^{a} f(\mathbf r(u,v))\sqrt{u^2+k^2}\,du\,dv.
\]
예컨대 \(f\equiv 1\)이면 면적은
\[
\mathrm{Area}=\int_{0}^{2\pi}\int_{0}^{a}\sqrt{u^2+k^2}\,du\,dv
=2\pi\left[\frac{u}{2}\sqrt{u^2+k^2}+\frac{k^2}{2}\ln\!\big(u+\sqrt{u^2+k^2}\big)\right]_{0}^{a}.
\]

---

## 예제 (플럭스: 벡터 면적분)

### 예제 5: 구면에서의 방사형 벡터장의 플럭스

\[
\mathbf F=\langle x,y,z\rangle,\quad S:\ x^2+y^2+z^2=R^2,\quad \mathbf n=\text{외향}.
\]
구면에서 \(\mathbf n=\frac{1}{R}\langle x,y,z\rangle\), \(dS=R^2\sin\phi\,d\phi\,d\theta\).
\[
\mathbf F\cdot \mathbf n = \langle x,y,z\rangle\cdot \frac{1}{R}\langle x,y,z\rangle=\frac{x^2+y^2+z^2}{R}=R.
\]
따라서
\[
\iint_{S} \mathbf F\cdot \mathbf n\,dS=\int_{0}^{2\pi}\int_{0}^{\pi} R\cdot R^2\sin\phi\,d\phi\,d\theta
=R^3\cdot 4\pi.
\]
**발산정리 검산**: \(\operatorname{div}\mathbf F=3\). 구 내부 체적 \(=\frac{4}{3}\pi R^3\).
\(\displaystyle \iiint \operatorname{div}\mathbf F\,dV=3\cdot\frac{4}{3}\pi R^3=4\pi R^3\) 와 일치.

---

### 예제 6: 평면 위 플럭스 (그래프 표기)

\[
S:\ z=ax+by+c,\quad \mathbf F=\langle P,Q,R\rangle.
\]
위쪽 법선 선택 시
\[
\iint_{S}\mathbf F\cdot \mathbf n\,dS
=\iint_{R} \mathbf F(x,y,g)\cdot \langle -a,-b,1\rangle\,dx\,dy.
\]
예: \(\mathbf F=\langle 0,0,1\rangle\)이면 플럭스는 \(\iint_{R} 1\,dx\,dy=\mathrm{Area}(R)\).
이는 기하적으로 “수직 투영”과 일치.

---

### 예제 7: 원기둥 옆면에서의 플럭스

원기둥 \((x^2+y^2=R^2, z\in[0,h])\), 매개화 \(\mathbf r(\theta,z)=\langle R\cos\theta,R\sin\theta,z\rangle\).
\[
\mathbf r_\theta=\langle -R\sin\theta,\ R\cos\theta,0\rangle,\quad
\mathbf r_z=\langle 0,0,1\rangle,\quad
\mathbf r_\theta\times\mathbf r_z=\langle R\cos\theta,R\sin\theta,0\rangle.
\]
외향 법선은 \(\langle \cos\theta,\sin\theta,0\rangle\).
\(\mathbf F=\langle \alpha x,\beta y,0\rangle\).
플럭스:
\[
\iint_{S}\mathbf F\cdot \mathbf n\,dS
=\int_{0}^{h}\int_{0}^{2\pi}\langle \alpha R\cos\theta,\ \beta R\sin\theta, 0\rangle
\cdot \langle R\cos\theta,\ R\sin\theta,0\rangle\,d\theta\,dz
\]
\[
=\int_{0}^{h}\int_{0}^{2\pi} R^2(\alpha\cos^2\theta+\beta\sin^2\theta)\,d\theta\,dz
=hR^2\big(\alpha\pi+\beta\pi\big)=\pi h R^2(\alpha+\beta).
\]

---

## 면적분과 발산정리·스토크스 정리의 연결

- **발산정리**:
  닫힌 곡면 \(S\)와 내부 체적 \(V\)에 대해
  $$
  \boxed{
  \iint_{S} \mathbf F\cdot \mathbf n\,dS=\iiint_{V} \operatorname{div}\mathbf F\,dV.
  }
  $$
  플럭스 계산을 체적적분으로 바꿔준다.

- **스토크스 정리**:
  경계가 \(C=\partial S\) 인 유향 곡면 \(S\)에 대해
  $$
  \boxed{
  \oint_{C} \mathbf F\cdot d\mathbf r
  =\iint_{S} (\nabla\times \mathbf F)\cdot \mathbf n\,dS.
  }
  $$
  **회전(curl)** 의 면적분을 경계 선적분으로.

---

## 자주 하는 실수와 체크리스트

- **법선 방향**: 외향/내향, 위쪽/아래쪽 선택에 따라 플럭스 부호가 바뀜
- **면소**: \(\|\mathbf r_u\times \mathbf r_v\|\) 또는 \(\sqrt{1+g_x^2+g_y^2}\) 누락 금지
- **도메인 경계**: 매개화 \((u,v)\)의 범위 정확히 설정
- **특이점**: \(\mathbf r_u\times \mathbf r_v=\mathbf 0\) (매개화 퇴화) 영역 배제
- **대칭 활용**: 구/원기둥 등에서 유효한 간소화(홀수성, 축대칭)
- **발산/스토크스 전환**: 닫힌면/경계곡선이 있으면 정리로 전환 검토

---

## 파이썬으로 검증/수치 적분 (SymPy/NumPy)

아래 코드는 상기 예제 중 일부를 심볼릭/수치로 확인한다.

### 포물면 예제(예제 2) 수치 확인

```python
import sympy as sp
r, a = sp.symbols('r a', positive=True)
theta = sp.symbols('theta', real=True)
expr = r**3*sp.sqrt(1+4*r**2)
I = sp.integrate(expr, (r, 0, a))
res = 2*sp.pi*I  # 2π ∫ r^3 sqrt(1+4 r^2) dr
sp.simplify(res)
```

### 구면 플럭스(예제 5) 심볼릭 확인

```python
R = sp.symbols('R', positive=True)
phi, th = sp.symbols('phi th', positive=True)
# F·n = R, dS = R^2 sin(phi) dphi dtheta

res_flux = sp.integrate(sp.integrate(R*R**2*sp.sin(phi), (phi, 0, sp.pi)), (th, 0, 2*sp.pi))
sp.simplify(res_flux)  # 4*pi*R**3
```

### 원기둥 옆면 플럭스(예제 7) 수치 확인

```python
alpha, beta, R, h, th, z = sp.symbols('alpha beta R h th z', positive=True)
integrand = R**2*(alpha*sp.cos(th)**2 + beta*sp.sin(th)**2)
res_flux = sp.integrate(sp.integrate(integrand, (th, 0, 2*sp.pi)), (z, 0, h))
sp.simplify(res_flux)  # pi*h*R**2*(alpha+beta)
```

---

## 응용 스냅샷

- **표면 질량/에너지**: 표면 밀도 \(\sigma(x,y,z)\)일 때 총 질량 \(M=\iint_{S}\sigma\,dS\)
- **복사/열유속**: 복사강도/열플럭스 벡터 \(\mathbf q\), 유출입량 \(\iint_{S}\mathbf q\cdot \mathbf n\,dS\)
- **유체/전자기학**: 속도장/자기장/전기장 플럭스 계산 → 발산정리/맥스웰 방정식과 연동
- **컴퓨터 그래픽/지오메트리 프로세싱**: 메쉬의 면적 합산, 노멀 기반 조명(램버시안)에서 \(\mathbf L\cdot \mathbf n\) 평균

---

## 연습문제 (해설 스케치 포함)

1) **반구면적분**: 상반구 \(x^2+y^2+z^2=R^2,\ z\ge 0\) 에서 \(f(x,y,z)=z\).
   - 스케치: 구면좌표로 \(z=R\cos\phi\), \(dS=R^2\sin\phi\,d\phi\,d\theta\), \(\phi\in[0,\pi/2]\).
     \(\displaystyle \int_{0}^{2\pi}\int_{0}^{\pi/2} R\cos\phi\cdot R^2\sin\phi\,d\phi\,d\theta
     =2\pi R^3\cdot \tfrac12 = \pi R^3\).

2) **평면 플럭스**: \(S:\ z=2x-y\), \(R:\ 0\le x\le 1,\ 0\le y\le 2\).
   \(\mathbf F=\langle 1,2,3\rangle\), 위쪽 법선.
   - 스케치: \(\langle -g_x,-g_y,1\rangle=\langle -2,1,1\rangle\),
     플럭스 \(=\iint_R \langle 1,2,3\rangle\cdot\langle -2,1,1\rangle\,dx\,dy = \iint_R ( -2+2+3)\,dx\,dy= \iint_R 3\,dx\,dy=3\cdot 2=6\).

3) **나선면 면적**: \(\mathbf r(u,v)=\langle u\cos v,u\sin v,kv\rangle\), \(u\in[0,a],v\in[0,2\pi]\).
   - 스케치: \(\mathrm{Area}=2\pi\left[\frac{u}{2}\sqrt{u^2+k^2}+\frac{k^2}{2}\ln(u+\sqrt{u^2+k^2})\right]_0^a\).

4) **방사형장 플럭스 일반화**: \(\mathbf F=\alpha\langle x,y,z\rangle\) 의 구면 플럭스.
   - 스케치: 예제 5의 \(\alpha\)배 → \(4\pi\alpha R^3\).

5) **원기둥 윗뚜껑 플럭스**: \(z=h\) 평면 원판 \(x^2+y^2\le R^2\), \(\mathbf F=\langle 0,0,z\rangle\), 위쪽 법선.
   - 스케치: \(\mathbf F\cdot \mathbf n = h\), \(\iint_S h\,dS = h\cdot \pi R^2\).

---

## 한 페이지 요약

- **스칼라 면적분**: \(\displaystyle \iint_S f\,dS\), 매개화 \(\mathbf r(u,v)\Rightarrow dS=\|\mathbf r_u\times\mathbf r_v\|\,du\,dv\).
- **플럭스(벡터 면적분)**: \(\displaystyle \iint_S \mathbf F\cdot \mathbf n\,dS\), 매개화 \(\mathbf F(\mathbf r)\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv\).
- **그래프형**: \(z=g(x,y)\Rightarrow dS=\sqrt{1+g_x^2+g_y^2}\,dx\,dy\),
  \(\mathbf F\cdot \mathbf n\,dS=\mathbf F(x,y,g)\cdot\langle -g_x,-g_y,1\rangle\,dx\,dy\).
- **좌표계**: 구면(\(R^2\sin\phi\)), 원통(\(R\)).
- **연결 정리**: 발산정리(닫힌면), 스토크스(경계-회전).
- **주의**: 방향(법선), 면소 누락 금지, 도메인/특이점, 대칭성 활용.
