---
layout: post
title: 정수론 - 연분수
date: 2025-09-15 19:25:23 +0900
category: 정수론
---
# 연분수(continued fractions) — 라마누잔 · 유한 연분수 · 무한 연분수 · 펠 방정식

> **구성 원칙**
> - 예제는 **적게** 두되 **아주 자세히** 전개한다.
> - 가능한 곳에 **증명(또는 엄밀한 증명 스케치)** 를 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.
> - 표기: 정수 집합 $$\mathbb Z$$, 자연수 $$\mathbb N=\{0,1,2,\dots\}$$, 최대공약수 $$\gcd(\cdot,\cdot)$$.
> - **단순 연분수(simple continued fraction)** 는 모든 부분분모가 양의 정수, 부분분자가 1인 표준형을 뜻한다.

---

## 0. 프롤로그 — 라마누잔과 연분수

**스리니바사 라마누잔(Srinivasa Ramanujan, 1887–1920)** 은 연분수를 **$q$-급수**(테타함수, 모듈러 형식)와 결합해 놀라운 항등식을 다수 발견했다. 대표적으로
- **로저스–라마누잔 연분수**
  $$
  R(q):=\cfrac{q^{1/5}}{1+\cfrac{q}{1+\cfrac{q^2}{1+\cfrac{q^3}{\ddots}}}}\qquad(|q|<1)
  $$
  에 대해
  $$
  R(q)=q^{1/5}\frac{(q;q^5)_\infty (q^4;q^5)_\infty}{(q^2;q^5)_\infty (q^3;q^5)_\infty},
  $$
  여기서 $$(a;q)_\infty:=\prod_{n=0}^\infty (1-aq^n).$$  
  이 정체성은 **분할(partition)** 이론의 로저스 신원(Rogers identities)과 맞물리며, 연분수가 **곱(무한곱)** 과 **급수** 사이를 연결하는 교량임을 보여 준다.

그의 연분수는 본 강의의 핵심(유·무한 연분수의 기초, 펠 방정식) 위에 서 있다. 먼저 표준 이론을 완전하게 정리한 뒤, 말미에 라마누잔의 시각을 덧붙인다.

---

## 1. 유한 연분수 — 표준형, 수렴분수, 최적근사

### 1.1 정의와 표기

정수 $$a_0\in\mathbb Z$$, 양의 정수 $$a_1,\dots,a_n\in\mathbb N$$ 에 대해
$$
[a_0;a_1,a_2,\dots,a_n]
:=a_0+\cfrac1{a_1+\cfrac1{a_2+\cfrac1{\ddots+\cfrac1{a_n}}}}
$$
을 **(단순) 유한 연분수**라 한다.

> **사실**: 모든 유리수는 **유일하게**(마지막 항 $$a_n\ge 2$$ 로 조정 시) 유한 연분수로 표현된다. 반대로 유한 연분수의 값은 항상 유리수다. (증명은 유클리드 알고리즘의 단계와 1–1 대응.)

### 1.2 수렴분수(Convergents)와 점화식

연분수의 **$k$번째 절단**을 $$[a_0;a_1,\dots,a_k]=\dfrac{p_k}{q_k}$$ 라 할 때,
$$
\begin{aligned}
p_{-2}&=0,\ \ p_{-1}=1,\qquad &p_k&=a_k p_{k-1}+p_{k-2}\quad(k\ge 0),\\
q_{-2}&=1,\ \ q_{-1}=0,\qquad &q_k&=a_k q_{k-1}+q_{k-2}\quad(k\ge 0).
\end{aligned}
$$

**행렬 표현**:
$$
\begin{pmatrix}p_k&p_{k-1}\\q_k&q_{k-1}\end{pmatrix}
=
\begin{pmatrix}a_k&1\\1&0\end{pmatrix}
\cdots
\begin{pmatrix}a_1&1\\1&0\end{pmatrix}
\begin{pmatrix}a_0&1\\1&0\end{pmatrix}.
$$

**결정식 항등식(매우 중요)**:
$$
\boxed{\ p_k q_{k-1}-p_{k-1}q_k = (-1)^{k-1}\ }.
$$
*증명*: 행렬식이 각 단계에서 $$-1$$ 이고 곱의 행렬식이 곱으로 유지됨.

> 귀결 1: $$\gcd(p_k,q_k)=1$$.  
> 귀결 2(교대적 과·미근사): $$\dfrac{p_0}{q_0},\dfrac{p_2}{q_2},\dots$$ 는 한쪽에서, $$\dfrac{p_1}{q_1},\dfrac{p_3}{q_3},\dots$$ 는 반대쪽에서 참값을 **교대로** 끼어든다(무한의 경우).

### 1.3 최적근사 정리(Best approximation)

실수 $$\alpha$$ 의 연분수 수렴분수 $$p_k/q_k$$ 는 다음을 만족:

- $$q\le q_k$$ 인 모든 기약분수 $$p/q$$ 에 대해
  $$
  \left|\alpha-\frac{p}{q}\right|
  \ge
  \left|\alpha-\frac{p_k}{q_k}\right|.
  $$
- (더 강한 형태) $$\big|\,\alpha-\dfrac{p}{q}\,\big|<\dfrac1{2q^2}$$ 이면 $$p/q$$ 는 어떤 수렴분수다. (허비츠 정리의 고전적 귀결선.)

*증명 스케치*: 결정식 항등식에서
$$
\left|\alpha-\frac{p_k}{q_k}\right|
< \frac1{a_{k+1}q_k^2}
\quad\text{및}\quad
\left|\frac{p}{q}-\frac{p_k}{q_k}\right|
=\frac{|pq_k-p_k q|}{qq_k}\ge \frac1{qq_k}.
$$
두 식을 비교해 얻는다.

### 1.4 계산 예제 — $$\dfrac{415}{93}$$ 의 연분수

유클리드 알고리즘:
$$
\begin{aligned}
415&=4\cdot 93+43,\\
93&=2\cdot 43+7,\\
43&=6\cdot 7+1,\\
7&=7\cdot 1+0.
\end{aligned}
$$
따라서
$$
\frac{415}{93}=[4;2,6,7].
$$
수렴분수들을 재귀로 계산:
$$
\frac{p_0}{q_0}=\frac{4}{1},\ 
\frac{p_1}{q_1}=\frac{4\cdot 2+1}{2\cdot 1+0}=\frac{9}{2},\ 
\frac{p_2}{q_2}=\frac{6\cdot 9+4}{6\cdot 2+1}=\frac{58}{13},\ 
\frac{p_3}{q_3}=\frac{7\cdot 58+9}{7\cdot 13+2}=\frac{415}{93}.
$$

---

## 2. 무한 연분수 — 수렴, 유일성, 대표 예들

### 2.1 정의와 기본사실

**단순 무한 연분수**
$$
[a_0;a_1,a_2,a_3,\dots],\qquad a_0\in\mathbb Z,\ a_k\in\mathbb N\ (k\ge 1).
$$
이때 부분절단 $$p_k/q_k$$ 가 수렴하면 그 극한을 연분수의 값이라 한다.

**정리(표준 사실)**  
- 단순 무한 연분수는 **항상 수렴**한다(부분분모가 1 이상이므로).  
- 그 값은 **무리수**이며, 모든 무리수는 **유일하게** 단순 무한 연분수로 표현된다.  
  (유리수는 알고리즘이 유한 단계에서 끝나므로 무한표현이 존재하지 않는다. 무리수는 나눗셈이 끝나지 않아 무한히 계속.)

### 2.2 황금비와 피보나치 — $$[1;1,1,1,\dots]$$

$$
\varphi=[1;1,1,1,\dots].
$$
정의로부터
$$
\varphi=1+\frac1\varphi\quad\Rightarrow\quad \varphi^2=\varphi+1
\quad\Rightarrow\quad \varphi=\frac{1+\sqrt5}{2}.
$$
수렴분수는
$$
1,\ \frac{2}{1},\ \frac{3}{2},\ \frac{5}{3},\ \frac{8}{5},\dots=\frac{F_{n+1}}{F_n}
$$
이고 오차는
$$
\left|\varphi-\frac{F_{n+1}}{F_n}\right|<\frac1{F_n^2}.
$$

### 2.3 제곱근의 연분수 — $$\sqrt2=[1;2,2,2,\dots]$$

표준 알고리즘(§3.1의 $$m_k,d_k,a_k$$ 재귀)으로
$$
\sqrt2=[1;\overline{2}],
$$
수렴분수
$$
1,\ \frac{3}{2},\ \frac{7}{5},\ \frac{17}{12},\ \frac{41}{29},\dots
$$
이고
$$
p_k^2-2 q_k^2 = (-1)^{k+1}
$$
가 성립한다(§4에서 펠과 연결).

### 2.4 $$e$$ 의 연분수(참고)

$$
e=[2;1,2,1,\ 1,4,1,\ 1,6,1,\ 1,8,1,\ \dots],
$$
즉 패턴 $$1,2k,1$$ 이 반복. (증명은 연속분수/적분 전개 또는 패드 근사.)

---

## 3. 이차무리수와 주기성 — 라그랑주 정리

### 3.1 라그랑주 정리(핵심)

**정리(라그랑주)**  
$$\alpha$$ 가 **이차무리수**(정수계수 이차방정식 $$A\alpha^2+B\alpha+C=0$$ 의 해, $$\alpha\notin\mathbb Q$$)이면 단순 연분수 전개가 **유한 주기**를 가진다.  
반대로, 단순 연분수가 **주기적**이면 그 값은 이차무리수다.

*아이디어*: $$\alpha=[a_0;\overline{a_1,\dots,a_\ell}]$$ 를
$$
\alpha=a_0+\cfrac1{a_1+\cfrac1{\cdots+\cfrac1{a_\ell+\cfrac1{\alpha}}}}
$$
에 대입하고 양변을 유리변형하면 $$\alpha$$ 가 2차식을 만족. 반대로 $$\sqrt D$$ 의 전개에서 **나머지쌍** $$(m_k,d_k)$$ 이 유한 가짓수이므로 결국 반복 → 주기.

### 3.2 $$\sqrt D$$ 의 전개 알고리즘(표준 재귀)

정수 제곱이 아닌 $$D>0$$ 에 대해
$$
\begin{aligned}
&m_0=0,\quad d_0=1,\quad a_0=\lfloor\sqrt D\rfloor,\\
&m_{k+1}=d_k a_k - m_k,\\
&d_{k+1}=\frac{D-m_{k+1}^2}{d_k},\\
&a_{k+1}=\left\lfloor\frac{a_0+m_{k+1}}{d_{k+1}}\right\rfloor.
\end{aligned}
$$
이때 $$a_k$$ 들은 결국 **주기** $$\ell$$ 를 갖고, 마지막 항은 항상 $$2a_0$$ 이 나타난다(대칭성 때문에).

### 3.3 예제 — $$\sqrt{14}$$

계산:
$$
\begin{array}{c|cccccc}
k & 0 & 1 & 2 & 3 & 4 & 5\\\hline
m_k & 0 & 3 & 2 & 2 & 3 & 3\\
d_k & 1 & 5 & 2 & 5 & 1 & 5\\
a_k & 3 & 1 & 2 & 1 & 6 & 1
\end{array}
$$
따라서
$$
\sqrt{14}=[3;\overline{1,2,1,6}],\quad \ell=4.
$$

수렴분수(재귀로)
$$
\frac{p_0}{q_0}=\frac{3}{1},\
\frac{p_1}{q_1}=\frac{4}{1},\
\frac{p_2}{q_2}=\frac{11}{3},\
\frac{p_3}{q_3}=\frac{15}{4},\ \dots
$$

---

## 4. 펠 방정식과 연분수

### 4.1 문제와 배경

**펠 방정식(Pell’s equation)**:
$$
x^2-Dy^2=1,\qquad D\in\mathbb N,\ D\text{ 제곱이 아님}.
$$
항상 **무한히 많은 정수해**가 존재하며, 그 중 **기본해(가장 작은 양의 $$x$$)** 로부터 전부 생성된다. (역사적으로는 브라흐마굽타–바스카라–라그랑주가 핵심 기여, “Pell” 명명은 오기.)

### 4.2 라그랑주–연분수법(결정적 연결)

$$\sqrt D=[a_0;\overline{a_1,\dots,a_\ell}]$$ 라 하자. 수렴분수 $$p_k/q_k$$ 에 대해

- **사실 1**: 어떤 $$k$$ 에서는
  $$
  p_k^2-D q_k^2=\pm 1.
  $$
- **사실 2(기본해의 위치)**:
  - $$\ell$$ 이 **짝수**면, $$k=\ell-1$$ 에서 $$p_k^2-Dq_k^2=1$$, 이때 $$(x_1,y_1)=(p_k,q_k)$$ 가 **기본해**.
  - $$\ell$$ 이 **홀수**면, $$k=2\ell-1$$ 에서 $$p_k^2-Dq_k^2=1$$ (주기 두 번), 이때 $$(x_1,y_1)=(p_k,q_k)$$ 가 기본해.

*증명 스케치*: 주기의 끝 수렴분수는 $$\sqrt D$$ 에 켤레를 취한 표현과 교차항이 사라지는 대칭성을 갖는다. 결정식 항등식과 $$\sqrt D$$ 의 2차정체성을 함께 쓰면 부호가 $$(-1)^\ell$$ 로 결정된다.

### 4.3 예제 1 — $$D=2$$

$$
\sqrt2=[1;\overline{2}],\ \ell=1\ (\text{홀수}).
$$
따라서 $$k=2\ell-1=1$$ 에서
$$
\frac{p_1}{q_1}
=[1;2]_{\text{절단}}
=\frac{3}{2}\quad\Rightarrow\quad 3^2-2\cdot 2^2=1.
$$
기본해 $$(3,2)$$. 모든 해는
$$
x+y\sqrt2=(3+2\sqrt2)^n\ (n\ge 1)
$$
로부터 얻는다.

### 4.4 예제 2 — $$D=3$$

$$
\sqrt3=[1;\overline{1,2}],\ \ell=2\ (\text{짝수}).
$$
따라서 $$k=\ell-1=1$$ 에서
$$
\frac{p_1}{q_1}=[1;1]=\frac{2}{1}\quad\Rightarrow\quad 2^2-3\cdot 1^2=1.
$$
기본해 $$(2,1)$$. 일반해 $$x+y\sqrt3=(2+\sqrt3)^n$$.

### 4.5 예제 3 — $$D=14$$

§3.3에서 $$\sqrt{14}=[3;\overline{1,2,1,6}]$$, $$\ell=4$$(짝수).  
$$k=\ell-1=3$$ 에서
$$
\frac{p_3}{q_3}=\frac{15}{4}\quad\Rightarrow\quad 15^2-14\cdot 4^2=225-224=1.
$$
기본해 $$(15,4)$$. 일반해 $$x+y\sqrt{14}=(15+4\sqrt{14})^n$$.

> **팁**: $$D=61$$ 같은 경우 기본해가 **매우 큼**($$x_1=1766319049,\ y_1=226153980$$). 하지만 연분수 알고리즘은 여전히 다항(자릿수 기준) 시간에 구해 준다.

---

## 5. 무한 연분수의 수렴성 — 간단 기준과 일반형

### 5.1 단순 연분수의 수렴

$$a_k\ge 1$$ 이면 절단값이 교대로 단조수렴하여(§1.2 결정식 항등식 이용) **항상 수렴**한다.  
오차는
$$
\left|\alpha-\frac{p_k}{q_k}\right|<\frac1{a_{k+1}q_k^2}\le \frac1{q_k^2}.
$$

### 5.2 일반 연분수(자코비/슈틸치스형)

보다 일반적으로
$$
b_0+\cfrac{a_1}{b_1+\cfrac{a_2}{b_2+\cfrac{a_3}{\ddots}}}
$$
꼴도 다루며, **워피츠키(Worpitzky)** 류의 수렴 정리가 있다(예: $$|a_n|\le \tfrac14$$, $$b_n\equiv 1$$ 이면 수렴 등). 본 문서에서는 단순형을 중심으로 한다.

---

## 6. 연분수와 유클리드 알고리즘 — 구현 관점

### 6.1 유리수 → 연분수

유리수 $$\dfrac{p}{q}$$, $$q>0$$ 에 대해
1) $$a_0=\left\lfloor \dfrac{p}{q}\right\rfloor$$, 나머지 $$r_1=p-a_0 q$$.
2) $$\dfrac{p}{q}=a_0+\dfrac{1}{\dfrac{q}{r_1}}$$. 다음 단계 $$a_1=\left\lfloor \dfrac{q}{r_1}\right\rfloor$$, 나머지 $$r_2=q-a_1 r_1$$.
3) 나머지가 0이 될 때까지 반복.

이는 정확히 **유클리드 알고리즘**과 동일한 나눗셈열이다.

### 6.2 연분수 → 유리수(수렴분수 재귀)

**재귀 공식**(§1.2)을 그대로 구현하면 역변환(절단값 계산)이 된다.

```python
# [a0; a1, ..., an] -> (p_n, q_n)
def convergent(a):
    p2, p1 = 0, 1     # p_{-2}, p_{-1}
    q2, q1 = 1, 0     # q_{-2}, q_{-1}
    for ak in a:      # a = [a0, a1, ..., an]
        p0 = ak*p1 + p2
        q0 = ak*q1 + q2
        p2, p1 = p1, p0
        q2, q1 = q1, q0
    return (p1, q1)
```

### 6.3 $$\sqrt D$$ 연분수와 펠 해 구하기(요약 알고리즘)

1) §3.2의 $$(m_k,d_k,a_k)$$ 재귀로 $$[a_0;\overline{a_1,\dots,a_\ell}]$$ 을 얻는다.  
2) $$\ell$$ 짝/홀에 따라 $$k=\ell-1$$ 또는 $$k=2\ell-1$$ 를 선택.  
3) 수렴분수 $$p_k/q_k$$ 가 기본해.

---

## 7. 라마누잔의 연분수 — $q$-연분수의 세계(스케치)

### 7.1 로저스–라마누잔 연분수

정의(§0):
$$
R(q)=\cfrac{q^{1/5}}{1+\cfrac{q}{1+\cfrac{q^2}{1+\cfrac{q^3}{\ddots}}}},\qquad |q|<1.
$$
그는 놀랍게도 이를 **무한곱**으로 표현:
$$
R(q)=q^{1/5}\frac{(q;q^5)_\infty (q^4;q^5)_\infty}{(q^2;q^5)_\infty (q^3;q^5)_\infty}.
$$
*아이디어*: 로저스 신원, 부분 분수 전개, 기본 변환(five-term) 등을 이용한 $q$-급수 변형.

**성질(일부)**:
- $$q\mapsto q^5$$ 의 변환과 **모듈러성** 유사 성질을 보이며, 특수점에서 **대수적 값**을 갖는다(복소해석/모듈러 형식 맥락).
- 분할함수 $$p(n)$$ 과 깊게 엮이며, 연분수가 **정수론적 생성함수**로도 강력함을 보여 준다.

### 7.2 다른 라마누잔 연분수들

- **람베르트형**의 일반화, **슈틸치스형** $q$-연분수 등.  
- 테타함수 $$\theta(q)$$ 와 결합되어 “신기한 상수”들의 고정밀 계산을 가능케 한다(라마누잔–하디의 원주율 공식들도 같은 정서).

> **요지**: 라마누잔은 “연분수 ↔ 무한곱 ↔ 모듈러 함수”의 **3각 연계**를 개척, 오늘날 계산수론/조합수론/모듈러형식의 표준도구군을 예견했다.

---

## 8. 더 깊은 성질 — 오차 경계와 도엣체(二次体) 관점(스케치)

- **오차 경계**  
  $$
  \left|\alpha-\frac{p_k}{q_k}\right|
  <\frac1{a_{k+1}q_k^2}
  \le \frac1{q_k^2}.
  $$
  특히 $$\alpha=\varphi$$ 일 때 $$a_{k+1}=1$$ 이어서 **최악의 경우**에 해당하며 상수 $$\tfrac1{\sqrt5}$$ 가 최적임(허비츠 정리).

- **도엣체 $$\mathbb Q(\sqrt D)$$ 와 단위(unit)**  
  펠 방정식의 해 $$x+y\sqrt D$$ 는 **단위군** $$\mathcal O_{\mathbb Q(\sqrt D)}^\times$$ 의 양의 부분에 해당. 기본해는 바로 **기본단위**. 연분수의 주기가 길수록 기본단위가 크다.

---

## 9. 예제 모음(적게, 그러나 끝까지)

### 9.1 $$\sqrt{23}$$ 의 전개와 펠

짧게만 정리(알려진 결과):
$$
\sqrt{23}=[4;\overline{1,3,1,8}],\ \ell=4.
$$
수렴분수들 중 $$k=3$$ 에서
$$
\frac{p_3}{q_3}=[4;1,3,1]=\frac{24}{5}\quad\Rightarrow\quad 24^2-23\cdot 5^2=576-575=1,
$$
기본해 $$(24,5)$$.

### 9.2 최적근사 실감 — $$\pi$$

$$
\pi=[3;7,15,1,292,\dots]
$$
초기 수렴분수
$$
\frac{22}{7},\ \frac{333}{106},\ \frac{355}{113},\dots
$$
특히 $$\dfrac{355}{113}$$ 은
$$
\left|\pi-\frac{355}{113}\right|<10^{-7}
$$
로 극히 정밀하다(“밀률(密率)”이 큰 $$a_k=292$$ 덕분).

---

## 10. 요약 카드

1) **유한 연분수**: 유리수와 1–1 대응. 수렴분수 $$p_k/q_k$$ 는
   $$
   p_k=a_k p_{k-1}+p_{k-2},\ \ q_k=a_k q_{k-1}+q_{k-2},\ \ p_k q_{k-1}-p_{k-1}q_k=(-1)^{k-1}.
   $$
   **최적근사** 성질과 오차경계 $$<1/(a_{k+1}q_k^2)$$.

2) **무한 연분수**: 모든 무리수는 유일한 단순 연분수 전개를 갖고, 단순형은 항상 수렴.  
   대표 예: $$\varphi=[1;\overline{1}],\ \sqrt2=[1;\overline{2}]$$.

3) **라그랑주 정리**: 이차무리수 ↔ **주기적** 연분수.  
   $$\sqrt D$$ 의 전개는 $$m_k,d_k,a_k$$ 재귀로 효율적으로 구함.

4) **펠 방정식**: $$x^2-Dy^2=1$$ 의 **기본해**는 $$\sqrt D$$ 연분수의 수렴분수에서 **주기 길이**에 따라 바로 얻는다. 모든 해는 $$(x+y\sqrt D)^n$$.

5) **라마누잔**: $q$-연분수(특히 **로저스–라마누잔 연분수**)로 연분수–무한곱–모듈러함수의 **삼각 연결**을 전개.

> **메시지**: 연분수는 “유클리드 알고리즘의 정밀한 기록”이자, **최적근사**와 **이차체 단위**까지 꿰는 보편언어다. 라마누잔은 거기에 **모듈러성**을 접목해 전혀 다른 세계(무한곱·테타함수)와 잇는 다리를 놓았다.
