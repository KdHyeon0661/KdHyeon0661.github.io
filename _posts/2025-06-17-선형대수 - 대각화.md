---
layout: post
title: 선형대수 - 대각화
date: 2025-06-17 21:20:23 +0900
category: 선형대수
---
# 대각화(Diagonalization)

> **한 줄 핵심**
> 정방행렬 \(A\)가 **서로 독립인 고유벡터를 \(n\)개** 가지면
> \(A = P D P^{-1}\) (유사변환)로 **대각화**할 수 있다.
> 여기서 \(D=\mathrm{diag}(\lambda_1,\dots,\lambda_n)\), \(P=[\vec v_1~\cdots~\vec v_n]\).

---

## 로드맵

1. **개념/정의** — 대각화의 의미, 왜 쓰는가
2. **필요충분조건** — 언제 가능한가(다중도, 최소다항식 관점 포함)
3. **절차** — 고유값→고유벡터→\(P,D\) 구성→검증
4. **응용** — \(A^k\), \(f(A)\), \(e^{At}\), 선형점화/마르코프/안정성
5. **실전 팁** — 대칭행렬, 결함행렬, 수치이슈
6. **완전 예제** — 손계산 & NumPy/SymPy 코드
7. **체크리스트 & 연습문제**

---

## 대각화란?

정방행렬 \(A\in\mathbb{F}^{n\times n}\) (보통 \(\mathbb{F}=\mathbb{R},\mathbb{C}\))에 대해
\[
\boxed{A = P D P^{-1}}
\]
가 성립할 때 **대각화 가능(diagonalizable)**이라고 한다.

- \(D=\mathrm{diag}(\lambda_1,\ldots,\lambda_n)\): **대각행렬**(고유값이 대각을 이룸)
- \(P=[\vec v_1~\cdots~\vec v_n]\): **고유벡터 행렬**(열벡터가 각각 \(\lambda_i\)의 고유벡터)
- \(P^{-1}\): 역행렬(고유벡터들이 선형독립이어야 함)

### 왜 유용한가?

- **거듭제곱**: \(A^k = P D^k P^{-1}\) (대각은 각 원소만 \(k\)제곱)
- **행렬함수**: \(f(A)=P\,f(D)\,P^{-1}\) (지수/로그/삼각함수 등)
- **해석 용이**: 축/모드별로 완전히 분리 → 동역학/안정성 분석에 핵심

---

## 대각화의 조건 (필요충분)

### 고전적 조건

\[
\boxed{\text{고유벡터가 선형독립인 것을 \(n\)개 확보} \iff \text{대각화 가능}}
\]

- **충분조건**: 고유값이 **모두 서로 다르면**(단순 고유값 \(n\)개) 자동으로 대각화 가능.
- **반례**: 고유값 중복이어도 고유벡터가 충분하면 대각화 가능(대칭행렬이 대표).

### 다중도 관점

- **대수적 다중도** \(m_a(\lambda)\): 특성다항식에서 \((\lambda-\lambda_i)\)의 지수
- **기하학적 다중도** \(m_g(\lambda)=\dim \ker(A-\lambda I)\): 고유공간의 차원
- 항상 \(1\le m_g(\lambda)\le m_a(\lambda)\).
- **필요충분조건**: 모든 \(\lambda\)에 대해 \(m_g(\lambda)=m_a(\lambda)\)이면 대각화 가능.

### 최소다항식 관점(이론 좋아하는 분을 위해)

- \(A\)의 **최소다항식** \(m_A(t)\)가 **중복근 없이 선형인자들의 곱**이면 대각화 가능.
  (즉, \(m_A(t)=\prod_i (t-\lambda_i)\) with all exponents 1)

### 특수 케이스

- **실대칭/허미티안**: 항상 대각화 가능(심지어 **직교/유니터리** 대각화)
  \[
  A=A^\top\Rightarrow \exists\,Q\ \text{s.t. } A=Q\Lambda Q^\top,\ Q^\top Q=I
  \]

---

## 대각화 절차 (실무 루틴)

1) **고유값** \(\lambda_i\)를 \(\det(A-\lambda I)=0\)에서 구함
2) 각 \(\lambda_i\)에 대해 **고유벡터** \(\vec v\neq 0\)를 \((A-\lambda_i I)\vec v=\vec 0\)로 풂
3) **열로 쌓아** \(P=[\vec v_1~\cdots~\vec v_n]\) 구성
4) **대각행렬** \(D=\mathrm{diag}(\lambda_1,\ldots,\lambda_n)\)
5) 검증: \(P\)가 가역(열독립)인지 확인 후 \(A \stackrel{?}{=} P D P^{-1}\)

> **팁**: 수치계산에서는 \(P^{-1}\) 대신 `solve(P, ·)`로 선형시스템을 푸는 식으로 안정성을 높인다.

---

## 응용 하이라이트

### 거듭제곱 \(A^k\)

\[
A^k=P D^k P^{-1},\quad D^k=\mathrm{diag}(\lambda_1^k,\ldots,\lambda_n^k).
\]
- \(|\lambda_i|<1\)이면 해당 모드는 \(k\to\infty\)에 0으로 감쇄.
- \(|\lambda_i|>1\) 모드는 지수적으로 성장.

### 행렬함수 \(f(A)\)

\[
f(A)=P\,f(D)\,P^{-1},\quad f(D)=\mathrm{diag}\big(f(\lambda_i)\big).
\]
- **지수행렬** \(e^{At}\): 선형 ODE \(\dot x=Ax\)의 해 \(x(t)=e^{At}x(0)\) 계산의 핵심.

### 선형 점화/마르코프/안정성

- **점화** \(x_{k+1}=Ax_k\): 스펙트럼 위치로 장기거동(수렴/발산/진동) 판정.
- **마르코프 연쇄** \(P\): \(\lambda=1\)의 왼고유벡터가 정상분포.
- **안정성**: 연속시간 \(\dot x=Ax\)는 \(\Re(\lambda_i)<0\)이면 원점 안정.

---

## 실전 팁 (수치/이론)

- **대칭/허미티안**: `eigh`(실수) / `eigvalsh`(희소) 사용 → 직교 고유기저, 수치적으로 최상.
- **결함행렬(전단 등)**: 대각화 불가, **조르당 표준형** 필요.
- **근접 결함(고유값이 거의 중복)**: 고유벡터 수치불안정 → 정규직교화(예: QR)로 완화.
- **정렬**: 라이브러리 고유값/벡터 **순서는 보장 안 됨** → 필요 시 크기/실수부 등 기준 정렬.
- **검증**: \(\|A - P D P^{-1}\|\) 잔차 확인.

---

## 손계산 예제 + 해설

### 예제 A — 서로 다른 고유값 (즉시 대각화)

\[
A=\begin{bmatrix}2&1\\1&2\end{bmatrix}
\]
1) 특성다항식
\[
\det(A-\lambda I)=(2-\lambda)^2-1=\lambda^2-4\lambda+3=(\lambda-1)(\lambda-3).
\]
2) 고유벡터
- \(\lambda=3\): \((A-3I)\vec v=0\Rightarrow x=y\Rightarrow \vec v_1=[1,1]^\top\)
- \(\lambda=1\): \((A-I)\vec v=0\Rightarrow x=-y\Rightarrow \vec v_2=[1,-1]^\top\)
3) 구성
\[
P=\begin{bmatrix}1&1\\1&-1\end{bmatrix},\quad D=\begin{bmatrix}3&0\\0&1\end{bmatrix}.
\]
⇒ \(A=PDP^{-1}\) (대각화 완료)

> **응용**: \(A^k=P\mathrm{diag}(3^k,1^k)P^{-1}\) — \(k\) 커지면 \(\lambda=3\) 모드 지배.

---

### 예제 B — 중복 고유값이지만 대각화 가능한 경우(대칭)

\[
B=\begin{bmatrix}4&2\\2&4\end{bmatrix}
\]
- \(\chi_B(\lambda)=(\lambda-6)(\lambda-2)\), 서로 다른 고유값 → 당연히 대각화 가능.
(대칭이면 고유벡터 **직교**까지 성립)

---

### 예제 C — **대각화 불가(결함)**: 전단행렬

\[
S=\begin{bmatrix}1&1\\0&1\end{bmatrix},\quad \chi_S(\lambda)=(1-\lambda)^2.
\]
- \(\lambda=1\)의 **기하학적 다중도** \(m_g=1\) (고유벡터 방향 1개뿐)
- 대수 \(m_a=2\)이지만 \(m_g<m_a\) → **대각화 불가**, 조르당 블록 필요.

---

### 예제 D — 3×3, 상삼각 (쉬운 판독)

\[
T=\begin{bmatrix}1&2&0\\0&1&0\\0&0&3\end{bmatrix}
\]
- 고유값은 대각 \(\{1,1,3\}\).
- \(\lambda=1\)에 대해 고유벡터가 2개 확보되면 대각화 가능, 아니면 불가(케이스별 계산 필요).

---

## 파이썬 실전

### NumPy — 대각화 재구성/검증

```python
import numpy as np

A = np.array([[2., 1.],
              [1., 2.]])

# 고유값/고유벡터(열)

w, P = np.linalg.eig(A)           # w: [3., 1.] (순서는 환경에 따라 다를 수 있음)
D = np.diag(w)

# A ≈ P D P^{-1} 검증

A_rec = P @ D @ np.linalg.inv(P)
print("복원 오차 ||A - P D P^{-1}||:", np.linalg.norm(A - A_rec))

# 거듭제곱 예시: A^10

D10 = np.diag(w**10)
A10 = P @ D10 @ np.linalg.inv(P)
print("A^10:\n", A10)
```

### SymPy — 상징적(기호) 대각화 & 판정

```python
import sympy as sp
A = sp.Matrix([[2, 1],
               [1, 2]])

# 특성다항식, 고유쌍

λ = sp.symbols('λ')
print("char poly:", sp.factor(A.charpoly(λ).as_expr()))
print("eigenvals:", A.eigenvals())     # {3:1, 1:1}

# 대각화 가능 여부 & 실제 분해

print("is diagonalizable?:", A.is_diagonalizable())
P, D = A.diagonalize()                  # A = P D P^{-1}
print("P:\n", P)
print("D:\n", D)
```

### 대칭행렬은 `eigh`로 (정규직교 보장)

```python
import numpy as np

B = np.array([[4., 2.],
              [2., 4.]])  # 대칭

w, Q = np.linalg.eigh(B)   # Q: 직교행렬, Q.T @ Q = I
Λ = np.diag(w)
B_rec = Q @ Λ @ Q.T
print("직교대각화 복원오차:", np.linalg.norm(B - B_rec))
print("Q^T Q - I:", np.linalg.norm(Q.T @ Q - np.eye(2)))
```

### 대각화 불가 사례 관찰

```python
import numpy as np
S = np.array([[1., 1.],
              [0., 1.]])
w, V = np.linalg.eig(S)
print("고유값:", w)        # [1., 1.]
print("rank(S - I):", np.linalg.matrix_rank(S - np.eye(2)))  # 1
print("기하 다중도:", 2 - np.linalg.matrix_rank(S - np.eye(2)))  # 1 -> 대각화 불가
```

---

## 자주 하는 실수 & 실무 체크리스트

- **중복 고유값 = 대각화 가능**은 아님 → 반드시 **고유공간 차원** 확인.
- 수치환경에서 고유값이 **아주 가까우면**(근접중복) 고유벡터가 불안정 → 정규직교화/재검증.
- `eig`의 **정렬 불확정** → 필요 시 기준(값/실수부/크기)으로 **재정렬**.
- 검증은 \(\|A-PDP^{-1}\|\) **잔차**로.
- 대칭/허미티안은 **정규직교 기저**가 가능 → `eigh` 사용이 최선.

---

## 대각화의 확장: 조르당/함수계산

- **대각화 불가** 시에도 조르당 정규형 \(A=VJV^{-1}\)으로
  \(f(A)=V f(J) V^{-1}\) 계산 가능(초등다항식/블록 별 미분항 포함).
- 실무에선 조르당보다 **슈어 분해/실슈어(준상삼각)**로 안정적으로 \(f(A)\)를 처리.

---

## 요약 표

| 항목 | 핵심 |
|---|---|
| 정의 | \(A=PDP^{-1}\) (유사변환으로 대각행렬) |
| 필요충분 | 모든 \(\lambda\)에 대해 \(m_g(\lambda)=m_a(\lambda)\) |
| 충분조건 | 서로 다른 고유값 \(n\)개 |
| 특수 | 대칭/허미티안은 직교(유니터리) 대각화 가능 |
| 응용 | \(A^k\), \(e^{At}\), \(f(A)\), 동역학/마르코프 |
| 실패 | 결함행렬(전단 등) → 조르당 필요 |

---

## 연습 문제

1) \(A=\begin{bmatrix}4&-1\\2&1\end{bmatrix}\). 고유값/벡터를 구해 대각화 가능성 판정, \(A^{10}\)를 \(P D^{10} P^{-1}\)로 표현.
2) \(S=\begin{bmatrix}1&1\\0&1\end{bmatrix}\)에 대해 \(m_a,m_g\)를 계산해 대각화 불가능을 보이고, 조르당 블록 형태를 적어라.
3) 대칭 \(B=\begin{bmatrix}3&2&0\\2&3&0\\0&0&1\end{bmatrix}\)를 직교대각화하고 \(B^{1/2}\)를 구하라.
4) \(\dot x=Ax\), \(A\)가 대각화 가능할 때 해 \(x(t)\)를 고유쌍을 이용해 일반해로 전개하라.

---

### 마무리 한 줄

> 대각화는 **좌표계를 고유벡터로 바꿔** 문제를 축별로 분리하는 기술이다.
> 조건을 점검하고(다중도/대칭성), 되면 쓰고 안 되면 **조르당/슈어**로 간다.
