---
layout: post
title: 디지털신호처리 - 이산 시간 푸리에 변환
date: 2025-11-08 18:25:23 +0900
category: 디지털신호처리
---
# 이산 시간 푸리에 변환(DTFT)과 그 성질

## 1) DTFT 정의·역변환·주기성·수렴

### 1.1 정의와 표기
길이 무한 이산 신호 \(x[n]\)의 DTFT:
$$
X(e^{j\omega}) \;\triangleq\; \sum_{n=-\infty}^{\infty} x[n]\;e^{-j\omega n},\qquad \omega\in\mathbb{R}.
$$
**주기성**:
$$
X(e^{j(\omega+2\pi)}) = X(e^{j\omega}).
$$

### 1.2 역변환(정규화)
적절한 수렴 조건 하에서
$$
x[n] = \frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j\omega})\,e^{j\omega n}\,d\omega.
$$

### 1.3 수렴(충분 조건)과 해석적 주의
- **절대수렴**: \(\sum_n |x[n]|<\infty\)이면 모든 \(\omega\)에서 절대수렴, \(X\)는 연속.  
- **제곱합 가능**: \(\sum_n |x[n]|^2<\infty\)이면 \(X\in L^2[-\pi,\pi]\) (에너지 신호), Parseval/Plancherel 성립.  
- **분포적 해석**: \(x[n]=1\) 등은 분포(임펄스 열)로 해석. 예:  
  \(x[n]=1 \Rightarrow X(e^{j\omega}) = 2\pi \sum_{k\in\mathbb{Z}}\delta(\omega-2\pi k)\).

### 1.4 직교성과 Parseval(미리보기)
$$
\sum_{n=-\infty}^{\infty}|x[n]|^2
= \frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2\,d\omega.
$$

---

## 2) 대표 신호의 DTFT (직관 확보)

### 2.1 단위 임펄스 \(\delta[n]\)
$$
\delta[n] \Longleftrightarrow X(e^{j\omega})=1.
$$

### 2.2 지연 임펄스 \(\delta[n-n_0]\)
$$
\delta[n-n_0] \Longleftrightarrow X(e^{j\omega})=e^{-j\omega n_0}.
$$

### 2.3 유한 상자(직사창) 평균
$$
x[n] = \frac{1}{M}\,\mathbf{1}_{\{0\le n<M\}}
\Longleftrightarrow
X(e^{j\omega}) = \frac{1}{M}\frac{\sin(\omega M/2)}{\sin(\omega/2)}e^{-j\omega(M-1)/2}.
$$
메인로브 폭–사이드로브 레벨의 트레이드오프(누설 핵심 사례).

### 2.4 기하급수 \(a^n u[n]\) (\(|a|<1\))
Z-변환 \(X(z)=\frac{1}{1-a z^{-1}}\)에서 \(z=e^{j\omega}\):
$$
X(e^{j\omega}) = \frac{1}{1-a e^{-j\omega}}.
$$
ROC: \(|z|>|a|\). 단위원 포함 \(\Leftrightarrow |a|<1\).

### 2.5 코사인/사인
$$
\cos(\omega_0 n) = \frac{1}{2}\big(e^{j\omega_0 n}+e^{-j\omega_0 n}\big)
\Rightarrow
X = \pi\{\delta(\omega-\omega_0)+\delta(\omega+\omega_0)\}
$$
(무한 관찰·분포적). 유한 관찰에서는 Dirichlet 커널로 퍼진다.

#### 실습: 대표 신호 DTFT 근사(FFT 샘플)
```octave
clear; close all; clc
pkg load signal

function [w, X] = dtft_via_fft(x, Nfft)
  if size(x,1) > 1, x = x.'; end
  if nargin < 2, Nfft = 16384; end
  X  = fftshift(fft(x, Nfft));
  w  = linspace(-pi, pi, Nfft);
endfunction

N=129; n=-(N-1)/2:(N-1)/2;

% 1) delta
x = (n==0);
[w, X] = dtft_via_fft(x, 8192);
subplot(2,2,1); plot(w, abs(X)); grid on; title('|DTFT| of delta (approx)');

% 2) box (rect window)
M=31; x = (n>=0 & n<M)/M;
[w, X] = dtft_via_fft(x, 8192);
subplot(2,2,2); plot(w, 20*log10(abs(X)+1e-12)); grid on; title('Rect window spectrum [dB]');

% 3) a^n u[n]
a=0.8; x = (n>=0).*(a.^n);
[w, X] = dtft_via_fft(x, 8192);
subplot(2,2,3); plot(w, abs(X)); grid on; title('|DTFT| of a^n u[n], a=0.8');

% 4) cosine
w0=pi/4; x = cos(w0*n);
[w, X] = dtft_via_fft(x, 8192);
subplot(2,2,4); plot(w, abs(X)); grid on; title('|DTFT| of cos(\omega_0 n) (windowed)');
```

---

## 3) DTFT의 기본 성질(시간/주파수 조작 법칙)

### 3.1 선형성
$$
\mathcal{F}\{a x[n] + b v[n]\} = a X(e^{j\omega}) + b V(e^{j\omega}).
$$

### 3.2 시간 시프트 ↔ 선형 위상
$$
x[n-n_0] \Longleftrightarrow e^{-j\omega n_0} X(e^{j\omega}).
$$
시간 지연은 주파수에서 선형 위상.

### 3.3 주파수 시프트(변조)
$$
e^{j\omega_0 n}\,x[n] \Longleftrightarrow X(e^{j(\omega-\omega_0)}).
$$
시간에서 지수 곱은 스펙트럼 이동.

### 3.4 컨볼루션·곱셈 정리
시간 컨볼루션:
$$
(x*h)[n] \Longleftrightarrow X(e^{j\omega})\,H(e^{j\omega}).
$$
시간 곱:
$$
x[n]\,h[n]\Longleftrightarrow \frac{1}{2\pi}\!\!\int_{-\pi}^{\pi}\!\! X(e^{j\theta})\,H(e^{j(\omega-\theta)})\,d\theta.
$$

### 3.5 시간 가중(미분 유사 성질)
$$
n\,x[n] \Longleftrightarrow j\,\frac{d}{d\omega}X(e^{j\omega}).
$$

### 3.6 공액·짝/홀 대칭
- \(x^*[n] \Longleftrightarrow X^*(e^{-j\omega})\).  
- \(x[n]\in\mathbb{R}\Rightarrow X(e^{-j\omega})=X^*(e^{j\omega})\) (켤레 짝대칭).  
- 짝성분 \(x_e[n]\) ↔ \(X\)의 실수부, 홀성분 \(x_o[n]\) ↔ 허수부.

### 3.7 Parseval/Plancherel
$$
\sum_{n} x[n]\,y^*[n] = \frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j\omega})\,Y^*(e^{j\omega})\,d\omega.
$$

#### 실습: 성질 검증(시프트, 변조, 컨볼루션 정리)
```octave
clear; close all; clc
pkg load signal

function [w, X] = dtft_via_fft(x, Nfft)
  if size(x,1)>1, x=x.'; end
  X = fftshift(fft(x, Nfft));
  w = linspace(-pi, pi, Nfft);
endfunction

N=257; n=-(N-1)/2:(N-1)/2;
x = hamming(81)'; x = [x, zeros(1, N-numel(x))];
x = circshift(x, [0, floor((N-81)/2)]);
[w, X] = dtft_via_fft(x, 8192);

% 시간 시프트
n0=7; xs = circshift(x, [0, n0]); [~, Xs] = dtft_via_fft(xs, 8192);
phase = exp(-1j*w*n0);
err_shift = norm(Xs - X.*phase)/norm(X); printf("time shift error = %.2e\n", err_shift);

% 변조
w0=0.4*pi; xm = x .* exp(1j*w0*(0:numel(x)-1));
[~, Xm] = dtft_via_fft(xm, 8192);
[~,kX]=max(abs(X)); [~,kM]=max(abs(Xm));
dw = w(kM)-w(kX); printf("peak shift ≈ %.3f (w0=%.3f)\n", dw, w0);

% 컨볼루션 정리
h = fir1(32, 0.3);
y = conv(x, h, 'same');
[~, H]  = dtft_via_fft(h, 8192);
[~, Y]  = dtft_via_fft(y, 8192);
err_conv = norm(Y - X.*H)/norm(Y); printf("convolution theorem error = %.2e\n", err_conv);
```

---

## 4) DTFT ↔ Z-변환, DFT/FFT, 주기신호(푸리에 급수)

### 4.1 Z-변환과 DTFT
Z-변환 \(X(z)=\sum_n x[n] z^{-n}\). DTFT는 단위원에서의 평가:
$$
X(e^{j\omega}) = X(z)\big|_{z=e^{j\omega}}.
$$
ROC가 단위원을 포함해야 DTFT가 존재(에너지 신호 등 예외는 \(L^2\)의미에서 해석).

### 4.2 DFT/FFT—샘플링·주기화
길이 \(N\) DFT:
$$
X[k] = \sum_{n=0}^{N-1} x[n]\,e^{-j\frac{2\pi}{N}kn},\qquad \omega_k=\frac{2\pi k}{N}.
$$
DFT는 DTFT를 격자 \(\{\omega_k\}\)에서 샘플링한 것(단, 시간-주기 연장/원형 컨볼루션 효과가 동반됨).

- **제로패딩**: 보간 향상(시각화·피크 위치), 실제 분해능 \(\Delta f\!\!=\!F_s/N\) 개선은 아님.  
- **윈도잉**: 누설 억제(사이드로브↓, 메인로브↑).

### 4.3 주기 신호와 푸리에 급수
주기 \(N_0\) 신호는
$$
X(e^{j\omega}) = 2\pi \sum_{m\in\mathbb{Z}} c_m \,\delta\!\left(\omega - \frac{2\pi m}{N_0}\right),
$$
\(c_m\)는 푸리에 급수 계수. DFT는 이 라인 스펙트럼을 유한 창으로 관찰한 결과.

#### 실습: DFT 샘플이 DTFT를 따르는 모습(제로패딩 비교)
```octave
clear; close all; clc
Fs=8000; f0=1000;
N=256; n=0:N-1; x=cos(2*pi*f0/Fs*n);
N1=256; N2=4096;
X1=fft(x, N1); X2=fft(x, N2);
f1=(0:N1-1)*Fs/N1; f2=(0:N2-1)*Fs/N2;
subplot(2,1,1); stem(f1(1:N1/2), abs(X1(1:N1/2)), '.'); grid on; title('DFT N=256');
subplot(2,1,2); plot(f2(1:N2/2), abs(X2(1:N2/2))); grid on; title('Zero-padded N=4096 (visual refinement)');
```

---

## 5) 성질의 증명 스케치(핵심 몇 가지)

### 5.1 시프트
$$
\sum_n x[n-n_0] e^{-j\omega n}
= \sum_m x[m] e^{-j\omega (m+n_0)}
= e^{-j\omega n_0}\sum_m x[m] e^{-j\omega m}.
$$

### 5.2 변조
\(\tilde{x}[n]=e^{j\omega_0 n}x[n]\)면
$$
\sum_n \tilde{x}[n] e^{-j\omega n]
= \sum_n x[n] e^{-j(\omega-\omega_0)n}
= X(e^{j(\omega-\omega_0)}).
$$

### 5.3 컨볼루션 정리
정의 대입 후 합 순서 교환.

### 5.4 Parseval
직교성
$$
\frac{1}{2\pi}\int_{-\pi}^{\pi}e^{j\omega (n-m)}\,d\omega=\delta[n-m]
$$
을 이용해 도출.

---

## 6) 수치 근사와 실무 이슈: 누설·해상도·창·보정

### 6.1 누설(Leakage)
격자에 정렬되지 않은 주파수 성분은 Dirichlet 커널로 퍼짐.  
완화: 창( Hann/Hamming/Blackman/Flat-top 등 ), 관찰 길이 조절, 주파수 정렬.

### 6.2 해상도(능분해) vs 제로패딩
해상도 \(\Delta f=F_s/N\). 제로패딩은 **보간**일 뿐, 서로 가까운 두 성분 분리 능력 자체는 개선되지 않는다.

### 6.3 창의 선택과 보정(일관 진폭/전력)
- **Coherent Gain (CG)**: \(\mathrm{CG}=\frac{1}{N}\sum_n w[n]\).  
- **ENBW**: \(\mathrm{ENBW}=\frac{N\sum w[n]^2}{(\sum w[n])^2}\) (bins).  
- 진폭/전력 스펙트럼의 절대 보정을 위해 CG/ENBW 사용.

#### 실습: 누설과 창 비교 + CG/ENBW 계산
```octave
clear; close all; clc
pkg load signal

function cg = coherent_gain(w)
  N=numel(w); cg = sum(w)/N;
endfunction

function enbw = enbw_bins(w)
  N=numel(w); enbw = N*sum(w.^2)/(sum(w)^2);
endfunction

Fs=1000; N=1024; n=(0:N-1)'; f0=100.5;
x=sin(2*pi*f0/Fs*n);  % 격자 비정렬

W = {rectwin(N), hanning(N), hamming(N), blackman(N)};
L = {'Rect','Hann','Hamm','Blackman'};
f = (0:N-1)*Fs/N;

for i=1:numel(W)
  w=W{i}; cg=coherent_gain(w); eb=enbw_bins(w);
  X=fft(x.*w);
  subplot(numel(W),1,i);
  plot(f(1:N/2), 20*log10((2/N)*abs(X(1:N/2))/cg + 1e-12)); xlim([0,300]); ylim([-120,10]);
  grid on; title(sprintf('%s | CG=%.3f, ENBW=%.2f bins', L{i}, cg, eb));
end
```

---

## 7) DTFT와 LTI 시스템 주파수 응답

### 7.1 \(H(e^{j\omega})\) 정의와 고유함수
임펄스응답 \(h[n]\)의 DTFT:
$$
H(e^{j\omega}) = \sum_{n} h[n] e^{-j\omega n}.
$$
복소지수는 LTI 고유함수:
$$
\mathcal{T}\{e^{j\omega n}\} = H(e^{j\omega})\,e^{j\omega n}.
$$

### 7.2 FIR/IIR 예와 군지연
- 선형위상 FIR(홀수 길이 \(N\))의 군지연은 \((N-1)/2\) 상수.  
- IIR은 일반적으로 주파수 의존 지연.

#### 실습: FIR/IIR의 \(|H|\)·위상·군지연
```octave
clear; close all; clc
pkg load signal

% FIR
N=101; b=fir1(N-1, 0.3, hamming(N)); a=1;
[Hf, wf] = freqz(b,a, 4096); 
phi_f = unwrap(angle(Hf));
tau_f = -gradient(phi_f)./gradient(wf);

% IIR
[bi, ai] = butter(4, 0.3);
[Hi, wi] = freqz(bi, ai, 4096);
phi_i = unwrap(angle(Hi));
tau_i = -gradient(phi_i)./gradient(wi);

subplot(2,2,1); plot(wf/pi, 20*log10(abs(Hf)+1e-12)); grid on; title('FIR |H|');
subplot(2,2,2); plot(wi/pi, 20*log10(abs(Hi)+1e-12)); grid on; title('IIR |H|');
subplot(2,2,3); plot(wf/pi, tau_f); grid on; title('FIR group delay');
subplot(2,2,4); plot(wi/pi, tau_i); grid on; title('IIR group delay');
```

---

## 8) 고급 성질: 차분·누산·반전·모멘트

### 8.1 차분(디지털 미분)과 누산(디지털 적분)
- 1차 차분 \(y[n]=x[n]-x[n-1]\):
  $$
  Y(e^{j\omega}) = X(e^{j\omega})\big(1 - e^{-j\omega}\big)
  = X \cdot e^{-j\omega/2}\cdot \big(2j\sin(\tfrac{\omega}{2})\big).
  $$
  DC 억제(영점 \(\omega=0\)).  
- 누산기 \(y[n]=\sum_{k=-\infty}^{n}x[k]\)의 주파수응답(형식적으로)
  $$
  H(e^{j\omega})=\frac{1}{1-e^{-j\omega}}
  $$
  (DC 근방 큰 이득, BIBO 안정 아님).

### 8.2 시간 반전·짝/홀
- \(x[-n] \Longleftrightarrow X(e^{-j\omega})\).  
- 실수 짝신호 ↔ 스펙트럼 실수 짝대칭, 홀신호 ↔ 순허수 홀대칭.

### 8.3 모멘트-도함수 연결
$$
n\,x[n] \Longleftrightarrow j\,\frac{d}{d\omega}X(e^{j\omega}), \quad
n^2 x[n] \Longleftrightarrow -\frac{d^2}{d\omega^2}X(e^{j\omega})
$$

#### 실습: 차분기/누산기 스펙트럼
```octave
clear; close all; clc
[Hd, w]=freqz([1 -1], 1, 4096);          % FIR diff
[Hi, ~]=freqz(1, [1 -1], 4096);          % IIR integrator
plot(w/pi, 20*log10(abs(Hd)+1e-12)); hold on
plot(w/pi, 20*log10(abs(Hi)+1e-12));
grid on; legend('Differentiator','Integrator');
xlabel('\omega/\pi'); ylabel('dB');
```

---

## 9) DTFT의 수치 구현 팁(Octave)

### 9.1 “진짜” DTFT vs FFT 근사
DTFT는 연속 \(\omega\). 수치에선 큰 \(N_{\text{fft}}\)로 FFT 후 `fftshift`를 통해 \(-\pi..\pi\) 샘플로 해석.  
짧은 신호에는 직접합을 구현해 기준선으로 사용.

### 9.2 STFT(참고)
시간 변화 스펙트럼은 STFT로 분석(별도 글).

### 9.3 스케일·정렬
- 주파수 정렬 \(f_0=m\frac{F_s}{N}\)일 때 라인 스펙트럼이 깨끗함.  
- 창의 CG/ENBW로 진폭/전력 보정.

#### 실습: DTFT 직접합 유틸
```octave
function [w, X] = dtft_exact(x, wmin, wmax, M)
  if nargin<2, wmin=-pi; end
  if nargin<3, wmax= pi; end
  if nargin<4, M=8192; end
  if size(x,1)>1, x=x.'; end
  n = 0:(numel(x)-1);
  w = linspace(wmin, wmax, M);
  X = zeros(1, M);
  for k=1:M
    X(k) = sum( x .* exp(-1j*w(k)*n) );
  end
endfunction

% 사용 예
x=[1 2 3 2 1];
[w, X] = dtft_exact(x, -pi, pi, 4096);
plot(w, 20*log10(abs(X)+1e-12)); grid on; xlabel('\omega'); ylabel('dB');
```

---

## 10) DTFT–DFT 스케일링과 Parseval·Plancherel(실무 캘리브레이션)

### 10.1 DFT 스케일
DFT 정의를 \(X[k]=\sum_{n=0}^{N-1}x[n]e^{-j2\pi kn/N}\), 역변환을 \(x[n]=\frac{1}{N}\sum_k X[k]e^{j2\pi kn/N}\)로 잡으면,
$$
\sum_{n=0}^{N-1}|x[n]|^2 = \frac{1}{N}\sum_{k=0}^{N-1}|X[k]|^2.
$$

### 10.2 창을 곱했을 때의 크기 보정
창 \(w[n]\)을 곱하고 DFT 하면, 톤 진폭을 정확히 복원하려면 CG로 나눠준다.

#### 실습: Parseval 및 창 보정
```octave
clear; close all; clc
N=2048; x=randn(1,N);
X=fft(x); lhs=sum(abs(x).^2); rhs=(1/N)*sum(abs(X).^2);
printf("Parseval error = %.2e\n", abs(lhs-rhs));

% 창 보정
pkg load signal
f0=123.45; Fs=1000; n=0:N-1; s=0.7*sin(2*pi*f0/Fs*n);
w=hanning(N)'; cg=sum(w)/N;
S=fft(s.*w);
[~,k]=max(abs(S(1:N/2)));
amp_est = (2/N)*abs(S(k))/cg;     % 단일측(0..Fs/2) 진폭 추정
printf("true amp=0.7, estimated ≈ %.4f\n", amp_est);
```

---

## 11) 상호상관·자기상관과 스펙트럼(이산 Wiener–Khinchin)

### 11.1 자기상관의 DTFT
정상 에너지 신호 \(x\)의 자기상관 \(r_{xx}[m]=\sum_n x[n]x^*[n-m]\). DTFT는 전력 스펙트럼 밀도:
$$
S_{xx}(e^{j\omega})=\sum_m r_{xx}[m]e^{-j\omega m}
= |X(e^{j\omega})|^2.
$$
유한 관찰에선 **페리오도그램** 등 추정기가 사용된다.

#### 실습: 페리오도그램 vs 이론
```octave
clear; close all; clc
pkg load signal
Fs=1000; N=4096; n=0:N-1;
x = sin(2*pi*120/Fs*n) + 0.5*randn(size(n));
[pxx, w]=periodogram(x, hamming(N), N, Fs, 'power');
plot(w,10*log10(pxx+1e-15)); grid on; xlabel('Hz'); ylabel('dB');
title('Periodogram (Hamming)');
```

---

## 12) DTFT와 이상 필터·분수 지연

### 12.1 이상 저역통과 필터
이상 LPF의 주파수응답 \(H(e^{j\omega})=\mathbf{1}_{|\omega|<\omega_c}\)의 임펄스응답은 sinc:
$$
h[n]=\frac{1}{2\pi}\int_{-\omega_c}^{\omega_c} e^{j\omega n} d\omega
=\frac{\sin(\omega_c n)}{\pi n}.
$$
비실현(비유한 지지·비인과). 창으로 절단해 FIR로 근사.

### 12.2 분수 지연(Linear Phase)
순수 지연 \(e^{-j\omega D}\)의 IFT는 \(\delta[n-D]\)(분포적). 비정수 \(D\)는 이상적으로 실현 불가 → 대칭 FIR로 근사.

#### 실습: 분수 지연 FIR 근사
```octave
clear; close all; clc
D=3.7; L=81; n=-(L-1)/2:(L-1)/2;
h = sinc(n - D);                      % 비정규화 sinc(n)=sin(pi n)/(pi n)
w = hamming(L)'; h = h.*w; h = h/sum(h);
x=[1 zeros(1,400)]; x(50)=1;          % 두 임펄스
y=conv(x,h,'same');
plot([x(:), y(:)]); grid on; legend('x','fractional-delayed');
```

---

## 13) 종합 실습: “정의→성질→시스템” 일괄 검증

### 13.1 시나리오
- 신호: \(x[n]=\cos(0.3\pi n)+0.6\cos(0.55\pi n+\pi/6)+0.1w[n]\)  
- 필터: \(0.55\pi\) 부근 notch → 저역 보정  
- 목표: DTFT 스펙트럼 전/후 비교, 컨볼루션 정리 수치 확인, 군지연 관찰

#### 실습 코드
```octave
clear; close all; clc
pkg load signal

Fs = 1;                       % 정규화 샘플 주파수
N  = 4096; n  = 0:N-1;
x  = cos(0.3*pi*n) + 0.6*cos(0.55*pi*n + pi/6) + 0.1*randn(size(n));

% Notch near 0.55*pi
w0 = 0.55*pi; r=0.98;
b = poly([exp(1j*w0), exp(-1j*w0)]);
a = poly([r*exp(1j*w0), r*exp(-1j*w0)]);
y = filtfilt(b,a,x);

% DTFT 근사(FFT)
Nfft = 16384; f = linspace(0, Fs/2, Nfft/2);
X = fft(x, Nfft); Y = fft(y, Nfft);

subplot(2,1,1);
plot(f, 20*log10(abs(X(1:Nfft/2))+1e-12)); hold on
plot(f, 20*log10(abs(Y(1:Nfft/2))+1e-12));
grid on; legend('orig','notch filtered'); xlabel('normalized freq'); ylabel('dB');

% 컨볼루션 정리: Y ≈ X * H (주파수 곱)
[h_imp,~]=impz(b,a,2048);
H = fft(h_imp, Nfft);
Yf = X .* H;
subplot(2,1,2);
plot(f, 20*log10(abs(Y(1:Nfft/2))+1e-12)); hold on
plot(f, 20*log10(abs(Yf(1:Nfft/2))+1e-12));
grid on; legend('y actual','X*H (freq product)'); xlabel('normalized freq'); ylabel('dB');

printf("relative error (freq-domain product) = %.2e\n", norm(Y - Yf)/norm(Y));
```

---

## 14) 추가 주제(간단 메모)
- **Poisson 합 공식**: 연속-이산 푸리에 변환의 다리.  
- **Gibbs 현상**: 불연속의 고리플—창 선택과 스무딩으로 제어.  
- **실수 신호의 스펙트럼**: 양/음 주파수 켤레쌍—한쪽만 그려도 충분(단, 위상 주의).  
- **위상 처리**: `unwrap`으로 \(2\pi\) 점프 제거, 군지연 계산.

---

## 15) 핵심 수식 모음
1) **정의/역변환/주기성**  
$$
X(e^{j\omega}) = \sum_n x[n]e^{-j\omega n},\quad
x[n]=\frac{1}{2\pi}\int_{-\pi}^{\pi}X(e^{j\omega})e^{j\omega n}d\omega,\quad
X(\omega+2\pi)=X(\omega).
$$

2) **시프트/변조**  
$$
x[n-n_0]\Longleftrightarrow e^{-j\omega n_0}X(\omega),\qquad
e^{j\omega_0 n}x[n]\Longleftrightarrow X(\omega-\omega_0).
$$

3) **컨볼루션/곱셈**  
$$
(x*h)[n]\Longleftrightarrow X(\omega)H(\omega),\quad
x[n]h[n]\Longleftrightarrow \frac{1}{2\pi}\int X(\theta)H(\omega-\theta)d\theta.
$$

4) **미분 유사 성질**  
$$
n\,x[n]\Longleftrightarrow j\frac{d}{d\omega}X(\omega).
$$

5) **대칭/공액**  
$$
x^*[n]\Longleftrightarrow X^*(e^{-j\omega}),\quad x\in\mathbb{R}\Rightarrow X(-\omega)=X^*(\omega).
$$

6) **Parseval/Plancherel**  
$$
\sum_n |x[n]|^2 = \frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2\,d\omega.
$$

7) **Z-변환·DFT 연결**  
$$
X(e^{j\omega})=X(z)\big|_{z=e^{j\omega}},\qquad X[k]\approx X(e^{j\omega_k}),\ \omega_k=2\pi k/N.
$$

---

## 16) 체크리스트(실무 관점)
- **수렴/ROC**: Z-변환 관점에서 단위원 포함 여부 확인.  
- **윈도잉/제로패딩**: 누설 제어와 보간의 역할을 구분.  
- **스펙트럼 보정**: CG/ENBW로 진폭/전력 일관화.  
- **주파수 축 표기**: \(\omega/\pi\), rad/sample, Hz(샘플링 주파수 포함) 명시.  
- **검증**: 임펄스·스텝·치르프·화이트노이즈로 \(H\) 확인, 컨볼루션 정리/Parseval 교차검증.