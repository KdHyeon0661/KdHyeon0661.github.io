---
layout: post
title: 정보통신기사 - 단말 · 주요 블록
date: 2025-08-21 21:25:23 +0900
category: 정보통신기사
---
# 단말 · 주요 블록: ADC/DAC · 클록 · 인터페이스 총정리

## 0. 큰 그림 한 장

- **ADC/DAC**는 **아날로그–디지털 경계**. 목표 대역/분해능/스퓨리어스 요건에 맞게 **아키텍처(SAR/파이프라인/ΔΣ/플래시)** 선택.
- **클록**은 **지터와 위상소음**이 변환기 SNR/ENOB를 **직격**. 클록 청정도(PLL, 클록 트리) 설계가 핵심.
- **인터페이스**는 **대역·지터·EMI·전력**과 직결. 저속 컨트롤(SPI/I²C), 중속(LVDS/CMOS 병렬), 고속(JESD204B/C, MIPI, CML/SerDes).
- **보레일아웃/전원/基準(Reference)**: LDO/필터/그라운드 분리/리턴 경로/차동 규칙 → 변환기 성능을 결정.

---

## 1. ADC Fundamentals — 원리, 지표, 아키텍처

### 1.1 양자화와 이상 SNR/ENOB
- 풀스케일 $V_\text{FS}$, 해상도 $N$비트 → **LSB**  
  $$
  \Delta = \frac{V_\text{FS}}{2^N}
  $$
- **양자화 잡음 전력**(균등 분포 가정): $\sigma_q^2=\Delta^2/12$.  
- **이상 SNR**(풀스케일 사인 입력 기준):
  $$
  \mathrm{SNR_{ideal}} = 6.02N + 1.76\ \text{dB}
  $$
- **SINAD**(SNR+왜곡 포함)로부터 **ENOB**:
  $$
  \mathrm{ENOB} = \frac{\mathrm{SINAD_{dB}}-1.76}{6.02}
  $$
  (스펙시트의 **ENOB vs 입력주파수** 곡선을 꼭 확인)

### 1.2 지터가 만드는 SNR 한계 (아퍼처 지터)
- 입력 주파수 $f_\text{in}$, 샘플링 시간 지터 표준편차 $\sigma_t$ → **지터 제한 SNR**:
  $$
  \mathrm{SNR_{jitter}} \approx -20\log_{10}\!\big(2\pi f_\text{in}\sigma_t\big)\quad(\text{dB})
  $$
- 전체 SNR은 **잡음 전력 합**으로 결합(근사):
  $$
  \frac{1}{\mathrm{SNR}_\text{tot,lin}} \approx
  \frac{1}{\mathrm{SNR}_\text{ideal,lin}}+
  \frac{1}{\mathrm{SNR}_\text{jitter,lin}}+
  \frac{1}{\mathrm{SNR}_\text{thermal,lin}}+\cdots
  $$
  → 고주파 입력일수록 **클록 지터**가 지배적.

**예 1)** $f_\text{in}=20\,\text{MHz}$, $\sigma_t=200\,\text{fs}$:  
$2\pi f\sigma_t=2\pi\cdot2\e7\cdot2\e{-13}\approx 0.0251$ → $\mathrm{SNR_{jitter}}\approx 32.0\,\text{dB}$ (**ENOB≈5비트**)  
→ 이 주파수 대역에서는 12비트 성능을 내려면 **수십 fs** 수준 지터 필요.

### 1.3 주요 비선형/스퓨리어스 지표
- **DNL**(미분 비선형): 코드 폭 편차. **DNL ≤ 1 LSB** → **모노토닉**.  
- **INL**(적분 비선형): 이상 선형에 대한 누적 편차.  
- **SFDR**: 최대 스퓨리어스 대비 파워.  
- **THD**: 고조파 합 전력. **SINAD** $= 10\log_{10}\big(\frac{P_\text{signal}}{P_\text{noise+dist}}\big)$.

### 1.4 아키텍처 선택 가이드
- **SAR**: 8–18비트, 몇 MSPS~수십 MSPS, 저전력/저지연, **프론트엔드 RC 드라이브/소스 임피던스** 중요.
- **파이프라인**: 12–18비트, 수십~수백 MSPS, IF/GSPS급 일부, **라티시클록/보정** 필요.
- **ΔΣ(ΣΔ)**: 16–24비트, kSPS~수MSPS(**오버샘플·노이즈셰이핑**), 저주파/정밀계측·오디오.
- **플래시/하이브리드**: 매우 고속(>GSPS), 해상도 낮음(6–8비트), T&M/레이더.

### 1.5 입력 드라이브 & 안티앨리어싱
- **샘플드-홀드 커패시터** $C_s$ + 스위치 → $R_sC_s$ 시간상수로 **샘플 동안 정착(settling)** 필요.
- **소스 임피던스**는 작게, **버퍼 앰프**(THD 저하, 대역 충분) + **RC/공진**로 링잉 억제.
- **안티앨리어싱 필터**: $f_s/2$ 넘어가는 신호 에너지 억제. 1–2차 RC 또는 액티브/LC.

---

## 2. DAC Fundamentals — 원리, 지표, 필터링

### 2.1 기본
- **코드→전압/전류** 변환. **R-2R**, **세그먼티드(상위 Thermometer + 하위 R-2R)**, **ΔΣ DAC** 등.
- **ZOH(Zero-Order Hold)** 출력 → **사인크(sinc)** 형태의 주파수 응답:
  $$
  H_\text{ZOH}(f)=\mathrm{sinc}(\pi fT_s)=\frac{\sin(\pi fT_s)}{\pi fT_s}
  $$
  → 고주파에서 **드룹** 발생 ⇒ **재구성 필터**로 평탄화.

### 2.2 DAC 지표
- **DNL/INL, SFDR, THD, SINAD**는 ADC와 동일 개념.  
- **글리치 에너지**: 대규모 코드 전환 시 스위칭 불균형 → 넓은 대역 스퓨리어스.  
- **모노토닉**: DNL<1 LSB 보장. 고정밀(메트롤로지)에서 중요.

### 2.3 출력 필터 & 드라이브
- **재구성(저역통과)**: 통과대역 리플/위상, 차단 경사, DAC ZOH 드룹 보정.  
- **전류 출력 DAC** → **트랜스임피던스 앰프(TIA)** 또는 부담 저항 + 버퍼.

---

## 3. 클록 · PLL · 지터 · 위상소음

### 3.1 지터와 변환기
- **ADC**: 입력이 고주파일수록 $\mathrm{SNR_{jitter}}$ 지배.  
- **DAC**: 지터는 위상변조 → **SSB 페이즈 노이즈**로 나타나 **SFDR/SNR** 열화.

### 3.2 위상소음 ↔ 지터 근사
- **SSB 위상소음** $L(f)$ [dBc/Hz]를 적분해 **RMS 지터** 근사:
  $$
  \sigma_t \approx \frac{1}{2\pi f_0}\sqrt{2\int_{f_1}^{f_2}10^{L(f)/10}\,df}
  $$
  (대역/오실레이터/PLL 의존. 실무는 **데이터시트의 RMS 지터** 값을 직접 사용)

### 3.3 PLL/클록 트리
- **저지터 XO/TCXO/OCXO** → **PLL 클록 분배기** → **저지터 버퍼(LVDS/CML)** → **ADC/DAC**.  
- **Jitter Cleaning PLL**: 참고원 위상소음을 필터링/멀티플라이(루프BW 선택).  
- **분배**: 차동(LVDS/CML) 권장, **대칭 라우팅**(스큐 최소화), **크로스토크/리턴 경로** 확보.

### 3.4 실무 숫자 감
- 수십 MHz 입력에서 **12–14비트 SNR**을 유지하려면 **클록 지터 수십 fs_rms** 수준.  
- 수백 MHz IF/GSPS에서는 **수~수십 fs**가 사실상 필수.

---

## 4. 디지털 인터페이스 — 제어/데이터/고속링크

### 4.1 저속 컨트롤: I²C / SPI
- **I²C**: 오픈드레인, 풀업 필요, **스트레치/멀티마스터**, 주소 7/10bit.  
  - 상승시간 $t_r=0.8473 R_\text{pullup} C_\text{bus}$ 근사 → 속도/부하에 맞춰 저항 선택.  
- **SPI**: **CPOL/CPHA**(모드 0/1/2/3), 단방향/풀듀플렉스, **SCLK·MOSI·MISO·CS**.  
  - 지연·스큐·레벨시프팅(1.8↔3.3V) 유의.

### 4.2 중속 병렬: CMOS/TTL, LVDS
- **병렬 CMOS**: 많은 핀, 스큐/그라운드 바운스, EMI 위험. 트라이스테이트/온도보상/드라이브 세팅 관리.
- **LVDS**: 차동 350 mVpp, 100 Ω 종단, 노이즈 내성·EMI 우수. 데이터+클록 또는 **소스동기화**(데이터-스톱비트/프레이밍).

### 4.3 고속 직렬: JESD204B/C (ADC/DAC 전용)
- **JESD204B**: 8b/10b 인코딩, 최대 수 Gb/s/레인, **Subclass 1**(SYSREF)로 **Deterministic Latency**.  
- **JESD204C**: 64b/66b, 효율↑, 속도↑(최대 32 Gb/s급).  
- **레인 수 계산**(간단 근사):
  $$
  R_\text{lane} \ge
  \frac{N_\text{bits} \times N_\text{channels} \times f_s \times OH}{N_\text{lanes}}
  $$
  - $OH$: 인코딩/프레임 오버헤드(8b/10b → 1.25, 64b/66b → 1.03125 근사).
  - 일부 디바이스는 **샘플 패킹**/컨트롤비트로 추가 오버헤드.

**예 2)** **14-bit, 2채널, 250 MSPS**, JESD204B(8b/10b), 레인 속도 목표 ≤ 5 Gb/s:  
필요 원시 데이터율 = $14\times2\times 250\text{M} = 7\,\text{Gb/s}$.  
오버헤드 1.25 → 8.75 Gb/s. **2레인**이면 4.375 Gb/s/레인 → 가능(여유). **1레인**은 8.75 Gb/s → B 규격 한계 근접.

### 4.4 모바일/영상: MIPI D-PHY/C-PHY, CSI-2/DSI
- **D-PHY**(차동 쌍, LP/HS 모드) vs **C-PHY**(3-wire 120° 위상) — 효율/핀수 트레이드오프.  
- **CSI-2/DSI** 프로토콜: 프레임/패킷/에러보정(HS-Trail 등 타이밍) — 레이아웃 규칙 중요.

### 4.5 기타 고속: CML/SerDes(PCIe/USB/ETH PHY)
- **CML**: 고속 차동, 종단 일관성/AC-커플링/콤몬모드 관리.  
- **채널 이퀄**(CTLE/DFE), **프리엠퍼시스** 설정으로 아이 다이어그램 여유 확보.

---

## 5. 전원 · 기준 · 레이아웃 — “보·레이아웃이 성능이다”

### 5.1 기준전압(Reference) & PSRR
- ADC/DAC **레퍼런스**는 노이즈/드리프트가 SNR/INL 직접 결정.  
- **로우노이즈 LDO + RC/LC 필터**로 레퍼런스/클록 전원 분리.  
- **PSRR** 그래프 확인(저주파/고주파), 필요한 주파수에서 여유 확보.

### 5.2 접지/리턴 경로
- **아날로그/디지털 그라운드 분리 + 1점 결합**(현대엔 단일 GND에 **영리한 영역 분리**가 주류).  
- **차동쌍 리턴 경로 연속성**(GND 슬릿 금지), **비아 스티칭** 제공.

### 5.3 라우팅 규칙(핵심)
- **클록/참조/아날로그 입력**은 **가장 짧고, 가장 깨끗하게**.  
- **차동쌍**: 임피던스/간격 일정, 길이 매칭, 크로스오버 최소.  
- **JESD/MIPI**: 규격의 **스큐/지터/아이 마진**과 **AC 커플링 캐패시터 값** 준수.

---

## 6. 실무 예제 모음

### 예제 A — “20 MHz IF를 14-bit SAR로 샘플링” (안티앨리어싱 & 지터)
- 목표: $f_s=80\,\text{MSPS}$, $f_\text{IF}=20\,\text{MHz}$, 14-bit ($\mathrm{SNR_{ideal}}\approx 86\,\text{dB}$).  
- **지터 요구**: $\mathrm{SNR_{jitter}}\ge 86\,\text{dB}$ →  
  $$
  86 = -20\log_{10}(2\pi\cdot 20\text{M}\cdot\sigma_t)
  \Rightarrow 2\pi f \sigma_t \le 5.01\e{-5} \Rightarrow
  \sigma_t \le \frac{5.01\e{-5}}{2\pi\cdot 20\text{M}} \approx 39\ \text{fs}
  $$
  → **클록 지터 ≤ 40 fs_rms**급 요구.
- **프론트엔드**: SAR 입력 샘플캐패시터 $C_s$ 가정 20 pF → 목표 정착 0.1%면 $t_s\ge 7\tau$.  
  샘플 윈도 4 ns면 $\tau\le 0.57\,\text{ns}$ → $R_s\le \tau/C_s \approx 28.5\,\Omega$.  
  → 버퍼 앰프/저임피던스 소스 필요, **1–2차 RC**로 링잉 억제.

### 예제 B — “16-bit ΔΣ로 48 kS/s 오디오” (OSR/필터)
- 이상 SNR(16-bit): 98 dB. ΔΣ 2차 + OSR=128 → 노이즈셰이핑 이득으로 16-bit 충분.  
- **재클록 분배**: 오디오 클록(12.288 MHz) 지터 수 ps로 충분(입력 $f$가 낮음).

### 예제 C — “JESD204B 링크 레인 수 산정”
- 12-bit, 4채널, $f_s=250$ MSPS, **Subclass-1(Deterministic Latency)**.  
  원시률 $=12\times 4\times 250\text{M}=12\,\text{Gb/s}$. 8b/10b → 15 Gb/s.  
  레인 목표 5 Gb/s → **3레인** 필요(실제는 정수 레인 → 3 또는 4). **3레인**이면 5 Gb/s/레인 정확히 맞추기(헤더/멀티프레임 오버헤드 고려 시 **4레인**이 안전).

### 예제 D — “DAC 재구성 필터”
- 16-bit DAC, $f_s=200$ MSPS, 베이스밴드 0–20 MHz, 통과리플 ≤ 0.2 dB, 차단 30 MHz @ ≥ 60 dB.  
  → **5차 이하 체비셰프/엘립틱** 수동 LC 가능(소형 어려움 시 액티브 다단). **ZOH 드룹** 보정 포함 시 이퀄라이저 소폭 추가.

---

## 7. Python 미니 계산기

> **(1)** 지터로 인한 SNR, **(2)** JESD 레인 속도, **(3)** ENOB↔SINAD 변환

```python
import math

def snr_jitter_db(fin_hz, jitter_rms_s):
    x = 2*math.pi*fin_hz*jitter_rms_s
    return -20*math.log10(x)

def enob_from_sinad_db(sinad_db):
    return (sinad_db - 1.76)/6.02

def sinad_from_enob_db(enob):
    return 6.02*enob + 1.76

def jesd_lane_rate_gbps(bits, chans, fs_hz, lanes, coding='8b10b'):
    oh = 1.25 if coding.lower()=='8b10b' else 66/64  # 64b66b
    data = bits*chans*fs_hz
    return data*oh/lanes/1e9

# 예시
print("SNR_jitter @20MHz, 40fs:", round(snr_jitter_db(20e6, 40e-15), 2), "dB")
print("Lane rate (14b,2ch,250MSPS,2 lanes,8b10b):", round(jesd_lane_rate_gbps(14,2,250e6,2,'8b10b'),3), "Gb/s/lane")
print("ENOB@SINAD=72dB:", round(enob_from_sinad_db(72),2), "bits")
```

---

## 8. 체크리스트(설계 단계별)

**요구정의**
- [ ] 대역/동적범위/스퓨리어스(ACLK, ACPR, SFDR, THD, SINAD/ENOB)  
- [ ] 샘플율/지연/전력/온도/비용

**변환기 선택**
- [ ] 아키텍처(SAR/파이프라인/ΔΣ/플래시)  
- [ ] 입력/출력 버퍼, 참조, 입력커먼모드/범위

**클록**
- [ ] SNR_jitter 계산 → **필요 지터** 산출  
- [ ] PLL/클록버퍼/분배(차동, 스큐/지터)  
- [ ] 위상소음/적분 지터 데이터 확인

**인터페이스**
- [ ] 대역/레인/인코딩(JESD 8b10b/64b66b)  
- [ ] 스큐/아이/AC 커플링/종단  
- [ ] 컨트롤(I²C/SPI) 주소/전압/속도

**전원/레이아웃**
- [ ] LDO/필터링(클록/레퍼런스 분리), 디커플링 채움  
- [ ] GND 전략(리턴 경로, 비아 스티칭), 차동쌍 임피던스  
- [ ] 온도/열경로

**검증**
- [ ] FFT(SNR/SFDR/SINAD), 코드 스윕(INL/DNL)  
- [ ] 클록 지터 측정, TIE/위상소음  
- [ ] 링크 버퍼/리커버리, 프레임 동기(JESD SYSREF)

---

## 9. 자주 하는 실수 / 디버깅 팁

- **클록 파워/그라운드** 혼선 → 지터 급증 → ENOB 급락. → 전원 분리/필터 재점검.  
- **SAR 소스 임피던스 과다** → 샘플 시간 내 정착 실패 → THD↑. → 버퍼 추가/RC 조정.  
- **LVDS 종단 누락/값 오류** → 아이 폐쇄/EMI↑. → 100 Ω 차동 종단 필수.  
- **JESD SYSREF 품질저하/스큐** → Deterministic Latency 실패. → **Subclass-1** 타이밍 재점검.  
- **DAC 글리치** → 스파이크/스퓨리어스. → 세그먼티드 구조 선택/스위칭 타이밍 튜닝/필터.

---

## 10. 연습문제(풀이 포함)

### Q1. 12-bit ADC 이상 SNR은?
**풀이**: $6.02N+1.76=6.02\times12+1.76=\mathbf{74.0\,dB}$.

### Q2. 입력 10 MHz에서 $\sigma_t=100$ fs일 때 $\mathrm{SNR_{jitter}}$?
**풀이**: $2\pi\cdot10^7\cdot1\e{-13}=0.006283$ → $-20\log_{10}(0.006283)=\mathbf{44.0\,dB}$.

### Q3. JESD204C(64b/66b)로 16-bit, 4채널, 250 MSPS, 2레인. 레인 속도?
**풀이**: 원시 16×4×250M=16 Gb/s, 오버헤드 66/64≈1.03125 → 16.5 Gb/s.  
2레인 → 8.25 Gb/s/레인 (**가능**, C 규격 내).

### Q4. 14-bit ADC에서 SINAD=70 dB. ENOB?
**풀이**: $(70-1.76)/6.02=\mathbf{11.32\,bits}$.

### Q5. SAR 입력 샘플 창 3 ns, $C_s=15$ pF, 정착 0.1% 목표($7\tau$). 허용 $R_s$?
**풀이**: $\tau\le 3/7=0.429$ ns → $R_s\le \tau/C_s=0.429\text{ns}/15\text{pF}=\mathbf{28.6\,\Omega}$.

### Q6. DAC의 ZOH 드룹을 보정하는 방법 2가지?
**풀이**: (1) 재구성 필터로 **프리-이퀄라이즈**, (2) **디지털 프리엠퍼시스**(주파수 도메인 이득 보정).

---

## 11. 빠른 암기표

- **ADC 이상 SNR**: $6.02N+1.76$ dB, **ENOB** $=(\mathrm{SINAD}-1.76)/6.02$  
- **지터 제한 SNR**: $-20\log_{10}(2\pi f_\text{in}\sigma_t)$  
- **SAR ↔ 소스임피던스/정착**, **파이프라인 ↔ 고속/SFDR**, **ΔΣ ↔ 정밀/저속**  
- **JESD 레인율** $\approx \dfrac{N_\text{bit}\,N_\text{ch}\,f_s\times OH}{N_\text{lanes}}$  
- **LVDS**: 100 Ω 종단, 차동 350 mVpp, EMI/지터에 강함  
- **클록**: fs급 지터 → 고주파 ENOB 치명적, PLL/분배 청정도 최우선

---

## 12. 마무리

- 변환기 성능은 **클록 지터·입력 드라이브·전원/레이아웃**의 함수입니다. 스펙시트 숫자만 보고 결정하지 말고,  
  **SNR_jitter 계산 → 프론트엔드 정착 → 인터페이스 레인율/아이**까지 **연쇄적으로** 검증하세요.  
- 실무에서는 **FFT 기반 성능 검증**, **클록 위상소음/지터 측정**, **JESD Deterministic Latency** 검증이 필수 코스입니다.
