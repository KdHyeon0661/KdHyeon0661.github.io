---
layout: post
title: 미적분 - 자연로그함수
date: 2025-07-06 20:20:23 +0900
category: 미적분
---
# 자연로그함수 (Natural Logarithmic Function)

## 정의와 등가적 관점

- **역함수 정의**: 자연로그는 지수함수 \(e^x\)의 역함수
  $$
  y=\ln x \quad\Longleftrightarrow\quad x=e^{\,y},\qquad x>0.
  $$
- **적분 정의**(기하적): 단위원점 \((1,1)\)에서 시작해 **쌍곡선** \(y=\frac1t\) 아래 면적
  $$
  \boxed{\ \ln x=\displaystyle\int_{1}^{x}\frac{1}{t}\,dt\ }\quad(x>0).
  $$
  이 정의로부터 \(\ln\)의 연속성, 미분가능성, 성질(곱셈→덧셈)이 자연스럽게 나온다.
- **극한 정의**(지수의 연속성 기반):
  $$
  \ln x=\lim_{n\to\infty}n\bigl(x^{1/n}-1\bigr),\qquad
  e=\lim_{n\to\infty}\left(1+\frac1n\right)^{\!n}.
  $$

---

## 기본 성질(도메인·단조·연속·미분가능)

- **정의역**: \(x>0\), **치역**: \((-\infty,\infty)\)
- **단조 증가**: \(x_1<x_2\Rightarrow \ln x_1<\ln x_2\)
- **연속·미분가능**: \((0,\infty)\)에서 무한번 미분가능
- **도함수**:
  $$
  \boxed{\ \frac{d}{dx}\ln x=\frac{1}{x}\ } \quad(x>0),\qquad
  \frac{d^2}{dx^2}\ln x=-\frac{1}{x^2}<0\ \Rightarrow\ \text{오목(Concave)}.
  $$
  일반 합성형: \(f(x)>0\)라면
  $$
  \frac{d}{dx}\ln f(x)=\frac{f'(x)}{f(x)}.
  $$

---

## 로그의 법칙(대수적 성질)

모두 \(a,b>0\), \(r\in\mathbb{R}\)에서 성립.
$$
\ln(ab)=\ln a+\ln b,\qquad
\ln\!\left(\frac{a}{b}\right)=\ln a-\ln b,\qquad
\ln(a^r)=r\,\ln a,\qquad
\ln 1=0,\ \ln e=1.
$$
**밑 변환**: \(\log_a x=\dfrac{\ln x}{\ln a}\ (a>0,\ a\neq1)\).

> **주의**: \(\ln(a+b)\neq \ln a+\ln b\). 합을 로그 안으로 분해할 수 없다.

---

## 그래프 해석 포인트

- 세로 점근선 \(x=0\), \(\ \lim_{x\to0^+}\ln x=-\infty\), \(\ \lim_{x\to\infty}\ln x=\infty\)
- 기준점 \((1,0)\) 통과, 접선 기울기 \(1\) (즉, \(\ln x\approx x-1\) @ \(x\approx 1\))
- 오목함(두 점을 잇는 현 아래로 그래프)

---

## 미분과 “로그 미분(log-differentiation)”

- **기본**: \(\dfrac{d}{dx}\ln x=\dfrac1x\), \(\dfrac{d}{dx}\ln|x|=\dfrac1x\ (x\neq0)\)
- **합성**: \(\dfrac{d}{dx}\ln f(x)=\dfrac{f'(x)}{f(x)}\)
- **곱의 미분을 로그로 단순화**:
  - \(y=\prod_{k}f_k(x)\Rightarrow \ln y=\sum_k \ln f_k\Rightarrow \dfrac{y'}{y}=\sum_k \dfrac{f_k'}{f_k}\)
- **응용 예**: \(y=x^x\ (x>0)\)
  - \(\ln y=x\ln x\Rightarrow \dfrac{y'}{y}=\ln x+1\Rightarrow \boxed{y'=x^x(\ln x+1)}\)

---

## 적분: 표준형과 테크닉

- \(\displaystyle \int \frac{1}{x}\,dx=\ln|x|+C\)
- \(\displaystyle \int \ln x\,dx= x\ln x-x+C\)
- \(\displaystyle \int x^p\ln x\,dx=\frac{x^{p+1}}{p+1}\Bigl(\ln x-\frac{1}{p+1}\Bigr)+C\quad(p\neq-1)\)
- 선형변환: \(\displaystyle \int \ln(ax+b)\,dx=(ax+b)\bigl(\ln(ax+b)-1\bigr)\frac{1}{a}+C\)

**부적분 예**(수렴값):
- \(\displaystyle \int_0^1 \ln x\,dx=\bigl[x\ln x-x\bigr]_0^1=-1\)
- \(\displaystyle \int_0^1 \frac{-\ln(1-x)}{x}\,dx=\sum_{n\ge1}\frac{1}{n^2}=\frac{\pi^2}{6}\)
  (급수 전개 \( -\ln(1-x)=\sum_{n\ge1}\frac{x^n}{n}\), 항별적분)

고급: \(\displaystyle \int_0^\infty e^{-x}\ln x\,dx=-\gamma\) (오일러–마스케로니 상수 \(\gamma\)).

---

## 급수 전개·근사·Padé

- **테일러(맥클로린)**: \(|x|<1\)
  $$
  \boxed{\ \ln(1+x)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{x^n}{n}\ } \quad(-1<x\le1,\ x\neq -1).
  $$
  수렴은 느리지만, 교대급수 오차는 첫 누락항 절댓값 이하.
- **대칭형**: \(x=\dfrac{y-1}{y+1}\Rightarrow y=\dfrac{1+x}{1-x}\) 를 쓰면
  $$
  \ln y=2\!\left(x+\frac{x^3}{3}+\frac{x^5}{5}+\cdots\right),
  $$
  \(y\) 가 1 근처에서 빠르게 수렴(체비셰프 근사에 유리).
- **수치안정**: \(\ln(1+x)\) 는 \(|x|\ll 1\)에서 **소실(취소)**이 크므로 `log1p(x)`(내부 보정) 사용 권장.
- **Padé 근사**(예): \(\ln(1+x)\approx \dfrac{2x(3+ x)}{6+4x+x^2}\) (근방 정밀 개선).

---

## 부등식·볼록성 도구

- 오목성의 접선 위배:
  $$
  \boxed{\ \ln x\le x-1\ } \quad(x>0),\ \text{평등 @ }x=1.
  $$
- 정현평균 부등식의 로그형:
  $$
  \boxed{\ \ln x\ \ge\ \frac{2(x-1)}{x+1}\ } \quad(x>0).
  $$
- **옌센(Jensen)**(오목): \(\ln\bigl(\sum p_i x_i\bigr)\ge \sum p_i\ln x_i\)
  \(\Rightarrow\) 지수화하면 **AM \(\ge\) GM**: \(\ \dfrac{1}{n}\sum x_i\ge\bigl(\prod x_i\bigr)^{1/n}\).
- **호분할(Mean Value)**: \(\exists\,c\in(a,b)\) with \(\displaystyle \ln b-\ln a=\frac{b-a}{c}\).

---

## 극한·평형 근사

- \(\ln(1+x)\sim x\) (\(x\to0\)) → 작은 변화의 **상대량** 근사
- \(x^x=e^{x\ln x}\to 1\) (\(x\to0^+\)) (왜냐면 \(x\ln x\to 0\))
- \(\displaystyle \lim_{x\to\infty}\frac{\ln x}{x^p}=0\) (모든 \(p>0\)) → 다항보다 느림
- \(\displaystyle \lim_{x\to 0^+} x\ln x=0\) → 엔트로피 경계 등에서 자주 등장

---

## 다변수에서의 로그

\(f(\mathbf{x})>0\)이면
$$
\nabla\ln f(\mathbf{x})=\frac{\nabla f(\mathbf{x})}{f(\mathbf{x})},\qquad
\nabla^2\ln f=\frac{\nabla^2 f}{f}-\frac{\nabla f\,\nabla f^{\!\top}}{f^2}.
$$
- \(\ln\) 자체는 \(x>0\)에서 **오목**.
- 조합 \(x\mapsto \ln(\mathbf{a}^\top \mathbf{x})\) (양의 영역)는 오목 → **로그-우도**, **Convex/Concave 분석**에 핵심.

---

## “지수 ↔ 로그”로 푸는 방정식·최적화

- \(a^{g(x)}=b\Rightarrow g(x)=\dfrac{\ln b}{\ln a}\)
- 곱의 극대화 \(\prod_i x_i\) ↔ 로그 합의 극대화 \(\sum_i \ln x_i\) (단조성 덕분)

---

## 정보이론·통계·금융에서의 \(\ln\)

- **엔트로피**: \(H(p)=-\sum_i p_i\ln p_i\) (밑이 2면 비트 단위)
- **KL 발산**: \(D_{\mathrm{KL}}(p\|q)=\sum_i p_i\ln\frac{p_i}{q_i}\ge 0\)
- **로그우도**: \(\ell(\theta)=\sum_i \ln p_\theta(x_i)\), 미분이 곱보다 쉬워 최적화에 표준
- **연속복리/수익률**: \(A=Pe^{rt}\Rightarrow r=\dfrac{1}{t}\ln\!\frac{A}{P}\)
- **수치안정 LSE**: \(\log\sum_i e^{z_i}=m+\ln\sum_i e^{z_i-m}\) with \(m=\max_i z_i\)

---

## 파이썬 예제

### 근사 + 수치 비교

```python
import numpy as np

def ln_integral(x, n=1_000_000):
    # ∫_1^x 1/t dt 를 사다리꼴로 근사
    if x <= 0:
        raise ValueError("x must be positive")
    a, b = 1.0, float(x)
    if a == b:
        return 0.0
    xs = np.linspace(a, b, n+1)
    vals = 1.0/xs
    h = (b-a)/n
    return h*(0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

xs = [0.5, 1.0, 2.0, 10.0]
for x in xs:
    approx = ln_integral(x, n=200_000)
    print(f"x={x}, integral≈{approx:.8f}, numpy={np.log(x):.8f}, err={approx-np.log(x):.2e}")
```

### 작은 \(x\)에서 `log1p` vs 직접 \(\ln(1+x)\)

```python
import numpy as np

def naive_ln1p(x):
    return np.log(1.0 + x)

xs = [1e-8, 1e-10, -1e-10]
for x in xs:
    print(x, "naive:", naive_ln1p(x), "log1p:", np.log1p(x), "diff:", naive_ln1p(x)-np.log1p(x))
```

### 구하기 ( \(e^y=a\) 풀기 )

```python
import numpy as np

def ln_newton(a, iters=20):
    if a <= 0: raise ValueError("a>0")
    # 초기치: 로그2 분해로 크기 맞추기
    m, e = np.frexp(a)   # a = m*2^e, m∈[0.5,1)
    y = (e*np.log(2)) + np.log(m)  # 대충 괜찮은 초기값
    for _ in range(iters):
        y -= (np.exp(y) - a)/np.exp(y)  # f(y)=e^y-a, f' = e^y
    return y

for a in [0.3, 1.0, 2.0, 100]:
    print(a, ln_newton(a), np.log(a))
```

### 로그-우도/LogSumExp 안정화

```python
import numpy as np

def logsumexp(z):
    m = np.max(z)
    return m + np.log(np.sum(np.exp(z - m)))

z = np.array([1000, 999, 998])  # 직접 exp → overflow
print("stable LSE:", logsumexp(z))
```

---

## 연습문제(해설 스케치)

1) 미분: \(\dfrac{d}{dx}\ln(3x^2+1)\)
   \(\displaystyle \frac{6x}{3x^2+1}\)

2) 적분: \(\displaystyle \int \frac{2x}{x^2+1}\,dx\)
   치환 \(u=x^2+1\Rightarrow \ln|u|+C=\ln(x^2+1)+C\)

3) 부등식 증명: \(\ln x\le x-1\ (x>0)\)
   \(g(x)=x-1-\ln x,\ g'(x)=1-\frac1x\), \(x=1\)에서 최솟값 0.

4) 극한: \(\displaystyle \lim_{x\to 0}\frac{\ln(1+x)}{x}=1\)
   테일러 또는 로피탈.

5) 로그 미분: \(y=(x^2+1)^{\sqrt{x}}\ (x>0)\)
   \(\ln y=\sqrt{x}\ln(x^2+1)\Rightarrow \dfrac{y'}{y}=\dfrac{1}{2\sqrt{x}}\ln(x^2+1)+\sqrt{x}\cdot \dfrac{2x}{x^2+1}\).
   \(y'=\) 위 식 \(\times y\).

6) 부적분: \(\displaystyle \int_0^1 x^{p-1}\ln x\,dx\) (\(p>0\))
   \(\dfrac{d}{dp}\int_0^1 x^{p-1}dx = \dfrac{d}{dp}\frac{1}{p}=-\frac{1}{p^2}\).

---

## 한눈 요약

- \(\ln x\)는 \(e^x\)의 **역함수**이자, \(\displaystyle \int_1^x \frac{1}{t}dt\) 로 정의 가능.
- **미분** \(\frac{1}{x}\), **오목성**으로 \(\ln x\le x-1\), AM\(\ge\)GM 등 수많은 부등식의 원천.
- **적분**과 **치환**에서 표준 무기: \(\int \frac{1}{x},\ \int \ln x\), \(\ln(ax+b)\) 등.
- **급수/수치**: \(\ln(1+x)\) 급수, `log1p`, LogSumExp는 실무 필수.
- **응용**: 로그우도·엔트로피·KL·연속복리—로그는 곱을 덧셈으로 바꾸는 “모델의 언어”다.
