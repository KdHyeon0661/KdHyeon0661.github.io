---
layout: post
title: 정수론 - 소수와 연관된 큰 그림
date: 2025-09-15 20:25:23 +0900
category: 정수론
---
# 소수와 연관된 큰 그림 — 하디·딕슨·에르되시, 소수성 검사와 인수분해, 원거리 동전 던지기, 소수정리와 제타 함수

> **작성 원칙**
> - 예제는 **적게** 두되 **아주 자세히** 전개한다.
> - 가능한 곳에 **증명(또는 엄밀한 증명 스케치)** 를 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.
> - 표기: $$\mathbb{N},\mathbb{Z},\gcd(\cdot,\cdot)$$, 소수 집합을 $$\mathcal{P}$$, 소수계산함수는 \(\pi(x)=\#\{p\le x: p\in\mathcal{P}\}\).

---

## 0. 인물 스케치 — 하디, 딕슨, 에르되시

- **G. H. Hardy (1877–1947)**: 라마누잔과의 협업, 리틀우드와의 공동 연구로 해석적 정수론을 비약적으로 전진. **리만 제타 함수**의 비자명 영점이 **임계선 \(\Re s=\tfrac12\)** 위에 **무한히 많다**는 사실(1914)을 증명. 확률적 수론(하디–라마누잔의 “정규 차수”), 원소수정리의 체계화 등으로 현대 소수 연구의 문법을 만들었다.

- **John D. Dixon (1939–2016)**: **Dixon의 인수분해법**(1981, “random squares”)을 제안. 이는 “작은 소수에 매끄럽게 분해되는 잔여”를 수집해 **합동한 제곱의 쌍** \(X^2\equiv Y^2\pmod N\) 을 만든 뒤 \(\gcd(X\pm Y,N)\)로 인수를 뽑아내는 방법. 이후 **사분체 체(sieve)** 계열(Quadratic Sieve, Number Field Sieve)의 아이디어적 조상 역할.

- **Paul Erdős (1913–1996)**: 조합·확률·정수론 전반을 가로지른 20세기 거두. 특히 **Selberg와 함께** 1949년에 **“해석학 없는” 원소수정리(소수정리) 증명**을 내놓아(“elementary proof”) 기존의 제타 함수 기반 증명과 다른 길을 제시했다. 소수의 분포, 가짓수 추정, 조합적 기법을 정수론에 체계적으로 이식.

---

## 1. 소수성 검사(primality test) vs 인수분해(factoring)

### 1.1 문제 구분과 복잡도 단서
- **소수성 검사**: 입력 \(n\) 이 소수인지 합성인지 **결정**.
  - 현대: **AKS**(2002)로 **다항시간 결정 알고리즘** 존재가 확립. 실무는 **확률적** Miller–Rabin, 또는 **ECPP**(준실용적 증명형).
- **인수분해**: 합성 \(n\) 을 \(n=p_1^{e_1}\cdots p_k^{e_k}\) 로 **분해**.
  - 고전 계산모형에서 **아무도 다항시간 알고리즘을 모르며**, 양자모형에서는 **Shor**가 다항시간 알고리즘(1994)을 제안.

> **핵심 교훈**: “소수인지”는 빠르게 알 수 있어도, “인수는 무엇인가”는 (고전적으로) 훨씬 어려운 문제다.

---

### 1.2 페르마 시험과 유사소수
**페르마의 소정리**: \(\gcd(a,n)=1\)이면
$$
a^{n-1}\equiv 1\pmod n\quad\text{(소수 \(n\)일 때)}.
$$
이 역은 거짓. \(a^{n-1}\equiv 1\)인데 **합성**인 \(n\)을 **(밑 \(a\)에 대한) 페르마 유사소수**라 한다. **카마이클 수**(예: \(561=3\cdot 11\cdot 17\))는 **모든** \(a\) (단, \(\gcd(a,n)=1\))에 대해 동치가 성립한다.

- **간단 예(페르마로 합성 판정)**: \(n=21\), \(a=2\). \(n-1=20\).
  \(2^{20}\equiv 1\pmod{21}\) 인지 보기보다, **Miller–Rabin**으로 더 강하게 가자.

---

### 1.3 Miller–Rabin(강한 소수성 테스트; 확률적)
\(n-1=2^s d\) (\(d\) 홀수)로 쓰고 임의의 밑 \(a\) (\(1<a<n-1\))에 대해
$$
a^d\not\equiv 1\pmod n\quad\text{이고}\quad
a^{2^r d}\not\equiv -1\pmod n\ (0\le r<s)
$$
이면 **합성**임을 선언. (그렇지 않으면 “통과”). 합성수의 통과 확률은 밑 하나당 \(\le \tfrac14\). 독립 밑 \(t\)개로 반복하면 오류 \(\le 4^{-t}\).

- **짧은 예**: \(n=21\), \(n-1=20=2^2\cdot 5\), \(a=2\).
  \(2^5\equiv 32\equiv 11\pmod{21}\) (왜냐면 \(32-21=11\)).
  제곱 사슬: \(11^2=121\equiv 121-105=16\), 다음 \(16^2=256\equiv 256-252=4\).
  중간에 \(-1\equiv 20\pmod{21}\)이 한 번도 나오지 않았고 처음 값도 \(1\)이 아니므로 **합성 판정 성공**.

> 실무: 64비트 이하는 소수의 소수 밑(2,3,5,7,11,13,17 등)만으로도 **결정적**(오류 0) 커버가 가능하도록 알려져 있다.

---

### 1.4 AKS 소수성 검사(개요)
모든 \(a\le O(\log^c n)\) 에 대해
$$
(x-a)^n\equiv x^n-a \pmod{(n,\ x^r-1)}
$$
을 검사하는 다항시간 알고리즘(세부는 정교한 수론/대수 기법). **이론적 돌파구**이지만, 구현 성능은 Miller–Rabin/ECPP 등 실용 알고리즘에 미치지 못한다.

---

### 1.5 “소수임을 증명” — Lucas/Proth/ECPP (개념)
- **Lucas**류: \(n-1\)의 인수 정보를 활용해, 적당한 \(a\) 에 대해 \(a^{n-1}\equiv 1\)이면서 모든 소인수 \(q\mid n-1\)에 대해 \(a^{(n-1)/q}\not\equiv 1\)이면 **소수**.
- **Proth**: \(n=k\cdot 2^m+1\) (Proth 수)에 특화된 빠른 판정.
- **ECPP**: 타원곡선 이론을 써 **증명서**를 만들고 검증한다(매우 실용적).

---

## 2. 인수분해 알고리즘 — 고전에서 현대까지

### 2.1 나눗셈·바퀴·작은 최적화
시도 나눗셈은 \(\le \sqrt{n}\) 범위에서 소수만 시도. “바퀴” 최적화(6k±1 등)로 일부 건너뛰기 가능하지만, 큰 수에는 비현실적.

---

### 2.2 Pollard의 \(\rho\) (순환·충돌 탐지)
무작위 유사 수열 \(x_{k+1}=f(x_k)\bmod n\) (보통 \(f(x)=x^2+c\))을 만들고
$$
d_k=\gcd(|x_{2k}-x_k|,\,n)
$$
를 반복 계산하면 흔히 빠르게 **비자명 인수**가 나온다 (\(1<d_k<n\)이면 성공). **토끼–거북이**(Floyd)로 메모리 상수.

> \(\rho\)는 “우연히” \(\bmod p\)에서의 주기가 \(\bmod q\)와 **어긋난다**는 사실을 이용.

---

### 2.3 Pollard의 \(p-1\) — 매끄러운 \(p-1\)에 효율
소수 \(p\mid n\) 이고, \(p-1\)이 작은 소수들로만 곱분해(“\(B\)-smooth”)될 때, 적당한 \(M=\mathrm{lcm}(1,2,\dots,B)\)에 대해 \(a^M\equiv 1\pmod p\)이므로
$$
\gcd(a^M-1,\ n)=p
$$
가 잘 나온다.

- **예(손으로 가능한 간단 케이스)**: \(N=299=13\cdot 23\). \(13-1=12\)는 매우 smooth.
  \(B=5\Rightarrow M=\mathrm{lcm}(1,\dots,5)=60\). \(a=2\)로 시도.
  거듭제곱을 차근차근 계산:
  \[
  2^{10}\equiv 127,\
  2^{20}\equiv 127^2\equiv 16129\equiv -17\equiv 282,\
  2^{40}\equiv 282^2\equiv 79524\equiv 289,
  \]
  \[
  2^{60}\equiv 2^{40}\cdot 2^{20}\equiv 289\cdot 282\equiv 81498\equiv 170\pmod{299}.
  \]
  따라서
  \[
  g=\gcd(2^{60}-1,\ 299)=\gcd(169,\ 299)=13.
  \]
  **성공**.

---

### 2.4 Dixon의 인수분해법 — “무작위 제곱”의 철학
핵심은 **작은 소수들에 대해 매끄러운(smooth)** 값들을 모아 **짝수 지수**로 맞추면, 어떤 집합의 곱이 **완전제곱**이 되어
$$
X^2\equiv Y^2\pmod N \quad\Longrightarrow\quad \gcd(X\pm Y,\ N)
$$
로 인수 추출이 가능하다는 것.

1) **기본 소수 집합(팩터 베이스)** \(B=\{2,3,5,\dots\}\) 정함.
2) “무작위” \(x\) 를 골라 \(x^2\bmod N\) 를 \(B\)-smooth로 소인수분해.
3) 지수 벡터를 \(\mathbb{F}_2\) 에서 선형대수 → 비자명 커널을 구해 지수의 **짝수 합** 조합을 얻는다.
4) 그 조합의 \(x\) 들을 곱해 \(X\) 를, 잔여의 기반 소수 지수 절반을 취해 \(Y\) 를 만든다.

- **작은 수로 완전 전개 예: \(N=299=13\cdot 23\)**
  \(\sqrt{299}\approx 17.29\). \(x=18\)부터 살펴본다.

  \(\bullet\) \(x=18\): \(18^2=324\equiv 25=5^2\) (**완전제곱**).
  \(\bullet\) \(x=25\): \(25^2=625\equiv 27=3^3\).
  \(\bullet\) \(x=29\): \(29^2=841\equiv 243=3^5\).

  이제 \(x=25\)와 \(x=29\)를 곱하면 잔여가 \(3^{3+5}=3^8=(3^4)^2\) 로 **제곱**이 된다.
  \[
  (25\cdot 29)^2 \equiv (3^4)^2\pmod{299}.
  \]
  수치화:
  \[
  25\cdot 29=725\equiv 127\ (\bmod 299),\quad 3^4=81.
  \]
  따라서
  \[
  X=127,\ Y=81,\quad X^2\equiv Y^2\pmod{299}.
  \]
  인수 회수:
  \[
  \gcd(X-Y,\ 299)=\gcd(46,\ 299)=23,\quad \gcd(X+Y,\ 299)=\gcd(208,\ 299)=13.
  \]
  **완전 성공**.

> **Quadratic Sieve(QS)** 는 Dixon을 체(sieve)로 가속화(많은 \(x\)에서 동시에 smooth 검출). **Number Field Sieve(NFS)** 는 현재 일반 정수 인수분해의 최강(아주 큰 \(N\)에서).

---

## 3. 인수분해의 응용 — “원거리 동전 던지기(coin flipping by telephone)”

**문제**: 두 당사자 \(A,B\)가 물리적으로 떨어져 있을 때, 공정한 동전 던지기(한 번에 1/2씩)를 하고 싶다. **누구도 결과를 조작할 수 없어야** 하며, 사전에 **신뢰할 제3자**도 없다.

### 3.1 Blum의 구상(1981; 제곱 잔여 기반 약속/공개)
- \(A\)는 **Blum 정수** \(n=pq\) (두 소수 \(p\equiv q\equiv 3\pmod 4\))를 만든다(공개는 \(n\)만).
- **약속(commit)**: \(A\)가 비트 \(b\in\{0,1\}\)를 정하고 랜덤 \(r\) (\(\gcd(r,n)=1\)) 선택. 또한 **자코비 기호가 \(+1\)이지만 제곱잔여가 아닌** \(a\)를 잡는다(예: \(a\equiv -1\pmod n\)).
  - \(b=0\): \(y\equiv r^2\pmod n\) 전송(“square”).
  - \(b=1\): \(y\equiv a\,r^2\pmod n\) 전송(“non-square with Jacobi \(+1\)”).
- **성질**: \(n\)의 **인수분해를 모르면** \(y\)가 위 **두 경우 중 어느 것인지 구별하기 어려움**(제곱 잔여 문제). 즉 \(A\)의 비트가 **잘 숨겨짐(숨김성)**. 반면, \(A\)는 **나중에** \(r\)을 공개하여 \(y/r^2\equiv 1\) 혹은 \(a\) 임을 입증(결속성).

- **동전 던지기**: \(B\)는 \(b'\in\{0,1\}\)을 **추측**해서 \(A\)에게 보낸다. \(A\)는 \(r\)과 \(b\)를 공개(**open**).
  - \(B\)는 \(y\stackrel{?}{\equiv} r^2\) 또는 \(y\stackrel{?}{\equiv} a r^2\)를 검사하고, 자코비 \(\left(\frac{y}{n}\right)=+1\)도 확인.
  - 최종 결과는, 예컨대 \(b\oplus b'\)로 약속.

> **공정성**: \(B\)는 \(n\)을 모르면 \(b\)를 **사전 추측** 이상으로 알아낼 수 없음(\(\approx 1/2\)).
> **조작 방지**: \(A\)가 \(b\)를 바꾸려면 \(y\)를 **제곱↔비제곱**으로 뒤집어야 하는데, 이는 사실상 **인수분해 능력**과 동치.

### 3.2 장난감 수로 보는 한 사이클
- \(n=77=7\cdot 11\) (둘 다 \(3\bmod 4\) → Blum).
- \(a\equiv -1\equiv 76\pmod{77}\) 은 자코비 \((76/7)=(-1/7)=-1\), \((76/11)=(-1/11)=-1\) → 곱은 \(+1\), **제곱은 아님**.
- \(A\)가 \(b=1\)을 택하고 \(r=12\) (서로소) 선택. \(r^2=144\equiv 67\).
  \(y\equiv a r^2\equiv 76\cdot 67\equiv -67\equiv 10\pmod{77}\). \(A\)는 \(y=10\) 전송.
- \(B\)는 \(10\)만 보고는 **제곱인지 아닌지** 판단 곤란(자코비는 \(+1\)).
- \(B\)가 임의 추측 \(b'=0\)을 보낸 뒤, \(A\)가 \((b=1,r=12)\) 공개.
  검증: \(y r^{-2}\equiv a\) 인지 확인(역원은 \(\bmod 77\)에서 계산 가능) → 성립.

> **교훈**: 인수분해의 어려움은 **암호학의 공정성**(원거리 무작위)에도 직접 쓰인다. (연결: **비트 커밋먼트**, **BBS 난수기**, **RSA** 등.)

---

## 4. 소수정리(PNT)와 리만 제타 함수

### 4.1 리만 제타와 오일러 곱
\(\Re s>1\)에서
$$
\zeta(s)=\sum_{n=1}^\infty \frac1{n^s}
=\prod_{p\in\mathcal{P}} \frac{1}{1-p^{-s}}.
$$
곱의 로그를 취하면 소수의 분포가 \(\zeta\)의 특이점 구조와 직결됨을 본다.

> **즉시 귀결**: \(\sum_p \frac1p=\infty\) (소수의 역수 합은 발산) — 오일러의 고전 증명.

### 4.2 PNT의 형태들
- 표준형:
  $$
  \boxed{\ \pi(x)\sim \frac{x}{\log x}\quad(x\to\infty)\ }.
  $$
- 더 정밀한 형태: \(\operatorname{Li}(x)\sim \pi(x)\), \(\theta(x)=\sum_{p\le x}\log p\sim x\), \(\psi(x)=\sum_{n\le x}\Lambda(n)\sim x\).

### 4.3 제타 함수 기반 스케치(하다마르–드 라 발레 푸생, 1896)
핵심은 \(\zeta(s)\)가 **\(\Re s=1\) 위에서 영점이 없다**는 사실(“non-vanishing on \(\Re s=1\)”).
그로부터 \(\log\zeta(s)\)를 적분변형하고 **복소해석**과 **페롱 공식** 류 장치로 \(\psi(x)\sim x\)를 끌어낸다 → \(\pi(x)\)로 환산.

- **리만 가설(RH)**: 모든 비자명 영점은 \(\Re s=\tfrac12\)에 놓인다. 성립하면
  $$
  \pi(x)=\mathrm{Li}(x)+O\!\big(\sqrt x\log x\big)
  $$
  같은 최적급 오차가 나온다. (현재는 미해결.)

### 4.4 에르되시–셀베르그의 “초등” 증명(1949; 구조)
해석함수론 없이, **체비셰프 함수의 세제곱 항등식**, **소인수 분해에 대한 평균적 성질**, **조합적 적분 불등식** 등으로 \(\psi(x)\sim x\)를 추론한다. “초등”이라 해도 복잡한 조합/불등식 기교가 필요.

---

### 4.5 간단 수치(근사와 실제)
- \(\pi(10^3)=168\), \(\frac{10^3}{\log 10^3}\approx \frac{1000}{6.9078}\approx 144.76\) (상당히 정확).
- \(\pi(10^6)=78{,}498\), \(\frac{10^6}{\log 10^6}\approx 72{,}382\), \(\operatorname{Li}(10^6)\approx 78{,}628\) (더 정확).

> **메시지**: \(x/\log x\)는 거칠게, \(\mathrm{Li}(x)\)는 훨씬 정밀하게 맞는다. RH는 “얼마나 정확한가”를 지배.

---

## 5. 한데 묶기 — 소수성 검사·인수분해·암호·소수정리의 상호작용

1) **검사 vs 분해**: AKS로 **결정**은 다항시간. **분해**는 (고전) 미지. **암호**(RSA 등)는 이 간극을 이용.
2) **인수분해 기법**: Pollard \(\rho\)/\(p-1\), **Dixon**, **QS**, **NFS** → 실무/대회/암호해킹의 표준.
3) **암호 응용**: **원거리 동전 던지기**, **비트 커밋**, **BBS 난수** 등은 “제곱 잔여 vs 인수분해”의 어려움에 기대.
4) **분포 이론**: **소수정리**는 “소수가 얼마나 자주 나오는가”의 본질. 하디는 **임계선 영점 무한성**, 에르되시는 **초등 증명**로 양대 산맥.

---

## 6. 알고리즘 요약(의사코드)

### 6.1 Miller–Rabin(한 밑)
```
MR(n, a):
    if n % 2 == 0: return (n == 2)
    write n-1 = 2^s * d with d odd
    x = pow_mod(a, d, n)
    if x == 1 or x == n-1: return "probably prime"
    repeat s-1 times:
        x = (x*x) mod n
        if x == n-1: return "probably prime"
    return "composite"
```

### 6.2 Pollard ρ(f(x)=x^2+c)
```
rho(n, c):
    if n % 2 == 0: return 2
    f(x) = (x*x + c) mod n
    x = 2; y = 2; d = 1
    while d == 1:
        x = f(x)
        y = f(f(y))
        d = gcd(abs(x - y), n)
    if d == n: return "fail, change c"
    return d
```

### 6.3 Dixon(개요; 관계 수집 → GF(2) 선형연립)
```
dixon(N, B):
    choose factor base P = {primes <= B}
    relations = []
    x = ceil(sqrt(N))
    while not enough relations:
        v = (x*x) mod N
        if v is P-smooth:
            relations.append((x, factor_exponents_mod2(v, P)))
        x += 1
    find nontrivial subset S with XOR of exponent vectors == 0
    X = product(x_i for (x_i, _) in S) mod N
    Y = product(prod(p_j^((e_ij)/2)) over j) mod N
    g = gcd(X - Y, N)
    if 1 < g < N: return g
    else: try different subset
```

---

## 7. 추가 예제·연습

1) **Miller–Rabin으로 341 검사**: \(341=11\cdot 31\). 페르마 \(a=2\)는 속지만, 적절한 밑(예: \(a=3\))에서 강한 테스트로 **합성**이 드러남(직접 지수사슬 계산).
2) **Pollard \(p-1\)로 \(N=10403=101\cdot 103\)**: \(101-1=100\) smooth. \(M=\mathrm{lcm}(1,\dots,10)=2520\). \(a=2\)로 \(2^M\!\!\!\pmod N\)을 계산해 \(\gcd(2^M-1,N)\)을 취하면 보통 \(101\)을 회수.
3) **Dixon의 매끄러움 경험**: \(N=493=17\cdot 29\), \(x\)를 23~40대에서 훑으며 \(B=5\)나 \(7\)에 대해 smooth 잔여를 모아 커널 벡터를 한 번 찾아보자.
4) **소수정리 근사**: \(x=10^8\)에서 \(x/\log x\)와 \(\mathrm{Li}(x)\) 비교(참값 \(\pi(10^8)=5{,}761{,}455\)). 어느 쪽이 더 근접한가?
5) **원거리 동전 던지기 변형**: \(a\)로 \(-1\) 대신 **자코비 \(+1\)의 비제곱**(예: 블럼 정수에서 2) 선택 시 검증식은 어떻게 바뀌는가?

---

## 8. 맺음말

- 하디는 **분석적 도구**로 소수의 내밀한 구조(임계선 영점)를 밝혔고, 에르되시는 **조합·확률**로 소수정리를 “해석 없이” 증명했다.
- 딕슨은 “**매끄러운 수의 선형대수**”라는 현대 인수분해의 철학을 열어 **사분체/수체 체**로 이어졌다.
- 소수성 검사와 인수분해의 **난이도 격차**가 현대 암호의 뼈대이며, 그 어려움은 **원거리 공정성(coin flipping)** 같은 분산 프로토콜까지 지탱한다.
- 마지막으로, 소수정리와 제타 함수는 “소수가 얼마나 자주 나타나는가”를 지배하는 **대서사시**. 그 오차항의 극치는 여전히 **리만 가설**이 쥐고 있다.

> **요지**: 소수는 “판정–분해–암호–분포”의 네 축을 관통하며, 역사·이론·알고리즘이 서로를 밀고 당기며 진화해 왔다. 이 글의 알고리즘·항등식·프로토콜을 작은 수로 직접 실행해 보라 — 정의들이 **손끝에서** 살아난다.
