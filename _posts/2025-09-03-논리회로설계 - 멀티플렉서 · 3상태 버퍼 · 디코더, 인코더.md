---
layout: post
title: 논리회로설계 - 멀티플렉서 · 3상태 버퍼 · 디코더, 인코더
date: 2025-09-03 19:25:23 +0900
category: 논리회로설계
---
# 멀티플렉서(MUX) · 3상태 버퍼(Three-State Buffer) · 디코더/인코더(Decoder/Encoder) 완전 정리

> 표기: \(+\)=OR, \(\cdot\) 또는 생략=AND, \(\overline{X}\)=NOT \(X\), \(X' \equiv \overline{X}\).  
> 목표: **기능·진리표·수식**, **구현·확장·연결**, **해저드/타이밍 주의점**까지 빠짐없이 설명합니다.

---

## 1) 멀티플렉서(Multiplexer)

### 1.1 개념과 용도
- **정의:** 여러 데이터 입력 중 **하나**를 선택해 **한 개의 출력**으로 전달하는 선택 스위치.  
- **형식:** \(2^k\!:\!1\) MUX (데이터 입력 \(2^k\)개, 선택선 \(k\)개, 출력 1개).  
- **응용:** 데이터 경로 선택, **샤논 전개** 기반 **임의 논리 구현**, 버스 멀티플렉싱, LUT(=MUX 트리) 등.

### 1.2 2:1, 4:1 기본 수식과 진리표
- **2:1 MUX** (입력 \(D_0,D_1\), 선택 \(S\), 출력 \(Y\))
  \[
  Y=\overline{S}\,D_0 + S\,D_1
  \]
```
S | D1 D0 || Y
--+--------++-
0 |  x D0  || D0
1 |  D1 x  || D1
```
- **4:1 MUX** (선택 \(S_1S_0\))
  \[
  Y=\overline{S_1}\overline{S_0}D_0+\overline{S_1}S_0D_1+S_1\overline{S_0}D_2+S_1S_0D_3
  \]

### 1.3 샤논 전개(Shannon Expansion)로 임의 함수 구현
\[
F(x,\mathbf{u})=x\cdot F|_{x=1} + \overline{x}\cdot F|_{x=0}
\]
- **실무 요령:** 선택선으로 \(x\)를 쓰고, **데이터 입력**에 \(F|_{x=0}, F|_{x=1}\)를 넣으면 **2:1 MUX=F**.  
- 변수 2개면 **4:1**, 3개면 **8:1** MUX로 확장(나머지 변수는 데이터 입력의 상수/식으로 배치).

### 1.4 계층화/확장
- **트리 구성:** 8:1 = 4:1 두 개 + 2:1 한 개(선택선 분할: 하위→상위).  
- **팬인 제한 대응:** 큰 MUX를 **작은 MUX 트리**로 나눠 **지연 균형** 확보.

### 1.5 MUX vs 디멀티플렉서(DeMUX)
- **DeMUX:** 입력 1개를 선택선으로 **여러 출력 중 1개**로 보냄(=디코더+게이트).  
- **쌍대 관계:** 디코더/인코더와 함께 주소/데이터 라우팅에 상호 변환 가능.

### 1.6 해저드/타이밍 주의
- 선택선/데이터의 **경로 지연 불균형**은 짧은 글리치 유발 가능.  
- **등록기(레지스터) 경계**로 동기화, 또는 **MUX 내부 경로 지연 균형**(버퍼, 게이트 분해)로 완화.

---

## 2) 3상태 버퍼(Three-State Buffer, Tri-State)

### 2.1 개념
- 출력 상태가 **0, 1, 고임피던스 \(Z\)** 의 **3가지**.  
- **출력 Enable(OE)** 로 구동/비구동 제어 → **하나의 버스 선로를 여러 소스가 공유**.

### 2.2 진리표(Active-High OE 예)
```
입력(A) OE | 출력(Y)
-----------+--------
 0     0   |   Z
 1     0   |   Z
 0     1   |   0
 1     1   |   1
```
- **Active-Low OE** 는 OE에 버블이 붙고, 0일 때 구동.

### 2.3 버스 설계와 안전
- **단 한 장치만** 동시에 OE=1이 되도록 설계(주소 디코더/중재 로직).  
- **버스 충돌 금지:** 두 장치가 서로 다른 값으로 구동하면 **과전류·손상**.  
- **리소스:** **버스 키퍼(weak keeper)** 또는 풀업/풀다운으로 **공중부양** 방지.  
- **타이밍:** 구동 해제(Z)→다른 소스 구동 사이 **버스 릴리즈 시간** 확보(`t_dis`, `t_en`).  
- **테크 주의:** 내부 버스가 많은 **FPGA**는 보통 **진짜 Tri-State 금지**(룩업 테이블/멀티플렉서로 대체).

### 2.4 Tri-State로 MUX 만들기(Decoder + 3-상태)
- 4:1 MUX 구현 절차:
  1) **2:4 디코더**로 \(S_1S_0\) → **one-hot** \(E_0..E_3\).  
  2) 각 데이터 \(D_i\)를 **3상태 버퍼**로 구동, **OE=E_i**.  
  3) 4개의 버퍼 출력은 **공통 버스**에 합선. (항상 **동시에 1개만 활성**)
- 장점: 배선 간결, 고팬아웃 소스에 유리. 단점: **버스 충돌/타이밍** 관리 필요.

---

## 3) 디코더(Decoder)

### 3.1 개념/형식
- 입력 \(n\)비트 **이진 코드** → **\(2^n\)개의 one-hot 출력**(하나만 1).  
- 기호: \(n\!\to\!2^n\) (예: 3→8, 4→16). **Enable(EN)** 핀 제공이 일반적.  
- **Active-High/Low** 출력 버전이 존재(출력에 버블 유무).

### 3.2 진리표·수식(3→8, Active-High)
- 입력 \(A,B,C\) (MSB→LSB), 출력 \(Y_0..Y_7\)
```
ABC | Y7 Y6 Y5 Y4 Y3 Y2 Y1 Y0
----+-------------------------
000 | 0  0  0  0  0  0  0  1
001 | 0  0  0  0  0  0  1  0
010 | 0  0  0  0  0  1  0  0
011 | 0  0  0  0  1  0  0  0
100 | 0  0  0  1  0  0  0  0
101 | 0  0  1  0  0  0  0  0
110 | 0  1  0  0  0  0  0  0
111 | 1  0  0  0  0  0  0  0
```
- 수식(예): \(Y_5=A\overline{B}C,\;Y_0=\overline{A}\,\overline{B}\,\overline{C}\).  
- EN이 있으면 **EN=0 → 모든 출력 0(또는 1, active-low형)**.

### 3.3 확장/캐스케이드
- **4→16** = **2:4 프리디코더** + **4개의 2→4** or **두 개 3→8 + EN 로직**.  
- **메모리/레지스터 선택**: 상위 비트로 **블록 EN**, 하위 비트로 **워드 선택**.

### 3.4 디코더로 임의 함수 구현(Decoder + OR)
- \(F=\sum m(I)\) 이면, \(I\)에 해당하는 **디코더 출력**들을 **OR** → **SOP 직접 구현**.
  - **Active-Low 디코더**라면 **NOR**로 바로 합산(NOR–NOR 구조).

### 3.5 해저드/타이밍
- 입력 전이가 **두 출력의 순간 중복**을 만들 수 있음(글리치).  
- EN으로 **출력 래칭 전 비활성**, 또는 출력 OR단에 **관성 지연/등록기**로 완화.

---

## 4) 인코더(Encoder) & 우선순위 인코더(Priority Encoder)

### 4.1 기본 인코더(2^n→n)
- **전제:** 입력은 **one-hot**(동시에 하나만 1).  
- 예) **8→3 인코더**: 입력 \(D_7..D_0\), 출력 \(A_2A_1A_0\)
  \[
  A_2=D_4+D_5+D_6+D_7,\quad
  A_1=D_2+D_3+D_6+D_7,\quad
  A_0=D_1+D_3+D_5+D_7
  \]
- 문제: **복수 입력이 1**이면 **모호**. → **우선순위 인코더** 필요.

### 4.2 우선순위 인코더(예: 8→3 + 유효 플래그 \(V\))
- **정의:** 가장 높은 인덱스 입력을 **우선**해 그 **번호**를 출력.  
- **마스킹(블로킹) 논리**로 하위 입력을 무시:
  \[
  \begin{aligned}
  V &= D_7+\cdots+D_0 \\
  A_2 &= D_7 + D_6 + D_5 + D_4 \\
  A_1 &= D_7 + D_6 + (D_3+\!D_2)\cdot \overline{(D_7+\!D_6+\!D_5+\!D_4)} \\
  A_0 &= D_7 + (D_5\cdot \overline{D_7}) + (D_3\cdot \overline{D_7+\!D_6+\!D_5+\!D_4})
         + (D_1\cdot \overline{D_7+\!D_6+\!D_5+\!D_4+\!D_3+\!D_2})
  \end{aligned}
  \]
- **출력 유효 \(V\)** 로 “입력 없음(모두 0)” 탐지.  
- **동시 다중 1**도 **정의된 동작**(가장 높은 비트만 반영).

### 4.3 실무 포인트
- **글리치**: 입력 OR/마스킹 트리의 지연 차로 순간 잘못된 코드 가능 → **출력 레지스터**/동기화 권장.  
- **키보드/인터럽트**: 스택형 우선순위 인코더로 **그룹·하위그룹** 단위로 구성.

---

## 5) 서로의 구현 관계와 구조적 관점

### 5.1 MUX ↔ 디코더/3상태
- **디코더 + 3상태 버퍼** = **MUX** (버스 합선).  
- **디코더 + OR/NOR** = **임의 SOP/POS**.  
- **MUX 트리** = **샤논 전개** = **LUT**(FPGA 내부 구성이 사실상 MUX).

### 5.2 PLA/PLD와의 연결 고리(개요)
- **PLA/PAL/CPLD/FPGA**:  
  - **PLA**: 디코더(또는 제품항 배열) + **공유 OR** → **다중 출력**을 효율적으로 구현.  
  - **FPGA LUT**: **MUX 트리**로 구현된 테이블 → **어떤 4~6변수 함수도 1싸이클**.  
  - 외부 버스 인터페이스는 **3상태/OE** 로 메모리/IO 선택.

---

## 6) 타이밍·전력·신뢰성 주의사항

1. **버스 충돌 금지:** 3상태 병렬 연결 시 항상 **하나만 OE=1**. **디코더 one-hot** + **상호배타 보장**.  
2. **릴리즈/인에이블 시간:** Z↔구동 전환 시 **겹침/공백** 없도록 여유 시간 확보.  
3. **글리치 억제:** MUX/인코더/디코더는 **재수렴 경로**가 많음 → **해저드-프리 커버**·**출력 래칭** 적용.  
4. **팬아웃/부하:** 디코더 출력은 다수 게이트/버스를 몰아줄 수 있음 → **버퍼링**.  
5. **전력:** 3상태 버스는 정적전력↓(미구동 시)이나, **버스 키퍼**가 **약한 전류** 소모.  
6. **FPGA 주의:** 내부 3상태 미지원 → **MUX로 변환**됨. Synthesis 옵션 확인.

---

## 7) 설계 예제(끝까지 전개)

### 7.1 3변수 함수의 4:1 MUX 구현
- 목표: \(F(A,B,C)=\sum m(1,2,6,7)\).  
- **선택선** \(S_1S_0=AB\), **데이터 입력** \(D_i=F|_{AB=i}\):
  - \(AB=00\): \(F=C\)의 일부? → m(1) 해당 X → \(D_0=0\)  
  - \(AB=01\): 인덱스 2,3 → \(D_1=\overline{C}+C\) 중 m(2)만 1 → \(D_1=\overline{C}\)  
  - \(AB=10\): 인덱스 4,5 → 없음 → \(D_2=0\)  
  - \(AB=11\): 인덱스 6,7 → 항상 1 → \(D_3=1\)  
- 최종:
  \[
  F=\text{MUX}_{S_1S_0}(D_3\!=\!1,\,D_2\!=\!0,\,D_1\!=\!\overline{C},\,D_0\!=\!0)
  \]

### 7.2 4→16 디코더로 메모리 칩 선택(Active-Low)
- 입력 주소 상위 4비트 \(A_{15:12}\) → 출력 \(\overline{CS_0}\sim\overline{CS_{15}}\).  
- **한 칩 선택 시** 해당 \(\overline{CS}\)만 0, 나머지 1.  
- 타이밍: 주소 전환 시 **짧은 두 칩 동시선택** 방지 위해 **출력 래칭** 또는 **EN 동기화**.

### 7.3 8→3 우선순위 인코더(상위 우선, Active-High)
- 출력 유효 \(V=\bigvee_{i=0}^8 D_i\).  
- 출력 비트 식은 §4.2 마스킹 식을 사용.  
- **검증:** 여러 입력 1일 때 **가장 높은 비트**의 코드가 나오는지 시뮬로 확인.

### 7.4 Tri-State MUX로 외부 버스 구동
- 두 장치 \(X,Y\) 가 데이터 버스 D[7:0]을 공유:
  - \(\overline{OE_X} = \overline{\text{SEL}_X}\), \(\overline{OE_Y} = \overline{\text{SEL}_Y}\), **SEL은 상호배타**.  
  - **버스 키퍼** 삽입, 전환 시 **Z 공백 시간** 보장.

---

## 8) 연습문제(원하면 해설 제공)

1) **4:1 MUX** 하나로 \(F(A,B,C)=A\overline{B}+BC\) 를 구현하라(선택선/데이터 값을 제시).  
2) **3→8 디코더**와 **3상태 버퍼**로 **8:1 MUX** 를 구성하고 타이밍 제약(`t_en`,`t_dis`)을 표로 적어라.  
3) **8→3 우선순위 인코더**의 출력 식을 **마스킹 없는 OR 식**과 **마스킹 버전**으로 각각 제시하고, “\(D_6=1, D_5=1\)”에서의 차이를 설명하라.  
4) **Active-Low 4→16 디코더** 두 개로 **5→32** 를 구성하는 캐스케이드 연결(EN 로직 포함)을 그려라.  
5) **FPGA에서의 내부 3상태 금지** 이유를 설명하고, 같은 기능을 **MUX/LUT**로 대체하는 합성 결과를 요약하라.

---

## 9) 포켓 요약
- **MUX:** 선택선으로 한 입력만 통과(샤논 전개로 임의 함수 구현).  
- **3상태:** 0/1/Z, 버스 공유. **충돌 금지**·OE 타이밍 필수.  
- **디코더:** 이진→one-hot, SOP/POS 구현의 기반, 메모리 선택/주소 해독.  
- **인코더:** one-hot→이진, **우선순위형**으로 다중 1 처리.  
- **관계:** 디코더+3상태 = MUX, 디코더+OR/NOR = 임의 논리, MUX 트리 = LUT.