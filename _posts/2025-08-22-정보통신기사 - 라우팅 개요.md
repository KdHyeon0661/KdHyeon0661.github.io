---
layout: post
title: 정보통신기사 - 라우팅 개요
date: 2025-08-22 16:25:23 +0900
category: 정보통신기사
---
# 라우팅 개요: 정적/동적 특징 총정리

## 0. 큰 그림: RIB·FIB·경로선택 파이프라인

- **RIB(Routing Information Base)**: 정적/동적/연결 경로가 **후보**로 모이는 테이블(컨트롤 플레인).
- **FIB(Forwarding Information Base)**: RIB에서 **선정된** 경로가 하드웨어(CEF/ASIC)에 **전달**된 테이블(데이터 플레인).
- **경로 선택(일반화)**
  1) **Longest Prefix Match(가장 긴 프리픽스)**
  2) **Administrative Distance(AD, 신뢰도)**
  3) **Metric(코스트/지표)**
  4) **ECMP(동일 비용 다중경로)** 해시/로드밸런싱

> **핵심**: **길이가 긴 프리픽스**가 항상 우선! 그 다음에 **AD**, 마지막에 **Metric**.

---

## 1. Administrative Distance(대표값; Cisco 기준)

| 소스 | AD |
|---|---:|
| Connected | **0** |
| Static (직접 next-hop) | **1** |
| eBGP | **20** |
| EIGRP (Internal) | **90** |
| OSPF | **110** |
| IS-IS | **115** |
| RIP | **120** |
| EIGRP (External) | **170** |
| iBGP | **200** |
| Floating Static(예: AD 250) | **가변** |

> 벤더마다 “Preference” 값이 다를 수 있음. 시험/IOS 기준은 위 표를 기억.

---

## 2. 정적 라우팅(Static Routing)

### 2.1 기본형/기본경로
```bash
# Cisco IOS
ip route 192.168.20.0 255.255.255.0 10.0.0.2
ip route 0.0.0.0 0.0.0.0 203.0.113.1   # Default route

# Junos
set routing-options static route 192.168.20.0/24 next-hop 10.0.0.2
set routing-options static route 0.0.0.0/0 next-hop 203.0.113.1
```
- **장점**: 간단/예측 가능/CPU 부담 최소/보안적(경로가 고정).
- **단점**: 링크/토폴로지 변화에 **수동 대응**(확장성/수렴성 ↓).

### 2.2 플로팅 정적(Floating Static)
- 동적/기본경로가 **사라질 때만** 백업으로 뜨게 **AD를 높게** 설정.
```bash
ip route 0.0.0.0 0.0.0.0 198.51.100.1 250   # AD 250 → 백업
```

### 2.3 정적 + 트래킹(IP SLA/Tracked Object)
- **다음 홉 생존/원격 목적지 핑**을 트래킹 → 실패 시 **정적 경로 자동 제거**.
```bash
ip sla 1
 icmp-echo 8.8.8.8 source-interface GigabitEthernet0/0
 frequency 5
ip sla schedule 1 life forever start-time now

track 1 ip sla 1 reachability
ip route 0.0.0.0 0.0.0.0 203.0.113.1 track 1
ip route 0.0.0.0 0.0.0.0 198.51.100.1 250      # 백업
```

### 2.4 재귀 정적/인터페이스 지정
- **재귀**: `ip route x.x.x.x y.y.y.y next-hop` (다음 홉 라우팅 필요)
- **직접 연결 인터페이스 지정**: 포인트투포인트/IPv6에서 유용.
```bash
ipv6 route 2001:db8:20::/64 Gig0/0 fe80::1
```

### 2.5 활용 포인트
- **엣지 단순 경계**, **작은 브랜치**, **디폴트 온리(Stub)**, **요약 전용 경로**.

---

## 3. 동적 라우팅 개요

| 분류 | 대표 | 알고리즘 | Metric 예 | 특징 |
|---|---|---|---|---|
| 거리 벡터 | **RIP** | 벨만-포드 | 홉수 | 단순, **수렴 느림**, 루프 방지 기법 필요 |
| 링크 상태 | **OSPF/IS-IS** | **SPF(Dijkstra)** | 대역폭 기반 코스트 등 | **빠른 수렴**, 영역/계층화 |
| 하이브리드 | **EIGRP** | DUAL | 대역폭+지연(+신뢰도/로드) | 빠름, 벤더 종속성 역사 |
| 경로 벡터 | **BGP** | Path-Vector | 속성/정책 기반 | **인터넷/AS간**, 정책 라우팅 |

> **거리 벡터**: “이 네트워크까지 **몇 홉**?”
> **링크 상태**: 전체 토폴로지 DB를 **각자** 가지며 **SPF 계산**.
> **경로 벡터**: **AS_PATH** 등 정책 속성으로 경로 결정.

---

## 4. RIP (RIPv2/RIPng)

- **Metric**: 홉수(최대 15, 16=무한) → 대규모/고속 환경 부적합.
- **타이머(기본)**: 업데이트 30s, 무효 180s, 홀드다운 180s, 플러시 240s.
- **루프 억제**: **스플릿 호라이즌**, **포이즌 리버스**, **홀드다운**.
- **버전**:
  - **RIPv1**: 클래스풀, 인증/서브넷/멀티캐스트 미흡(역사).
  - **RIPv2**: 클래스리스(CIDR), 멀티캐스트 224.0.0.9, MD5 인증 지원.
  - **RIPng**: IPv6, 멀티캐스트 ff02::9.

```bash
# Cisco RIPv2
router rip
 version 2
 network 10.0.0.0
 passive-interface default
 no passive-interface Gig0/0
 ip rip authentication mode md5
 ip rip authentication key-chain KC

# RIPng
ipv6 router rip R6
 interface Gig0/0
  ipv6 rip R6 enable
```

---

## 5. OSPF (v2/v3)

### 5.1 기본 개념
- **영역(Area)**, **ABR/ASBR**, **LSA** 타입, **SPF** 계산.
- **코스트**: $\displaystyle \text{Cost}=\left\lfloor \frac{\text{Ref BW}}{\text{Intf BW}} \right\rfloor$ (기본 Ref=100Mbps; 현대는 10G 이상 반영 위해 **`auto-cost reference-bandwidth`** 조정 권장).
- **DR/BDR**: 브로드캐스트/멀티액세스 망에서 **Adjacency 수 감소**.

### 5.2 LSA/경로 유형
- **다이렉트(Intra-Area)**, **Inter-Area**(ABR 경유), **External**(ASBR 재분배, **E1/E2**).
  - **E2**: 기본(외부 코스트만), **E1**: 내부 코스트 **누적**.

### 5.3 스텁 변형
- **Stub**(E1/E2 차단, 디폴트 주입), **Totally Stubby**(Inter도 차단), **NSSA**(Type-7 → Type-5 변환).

### 5.4 타이머/상태
- **Hello/Dead**(예: 10/40s), **상태**: Down → Init → 2-Way → ExStart → Exchange → Loading → Full.

```bash
# OSPFv2
router ospf 1
 router-id 1.1.1.1
 network 10.0.12.0 0.0.0.255 area 0
 network 10.0.23.0 0.0.0.255 area 1
 passive-interface default
 no passive-interface Gig0/0
 auto-cost reference-bandwidth 100000   # 100Gbps 기준

# 스텁 예시
area 1 stub no-summary  # Totally Stubby(Cisco)
# 디폴트 주입
router ospf 1
 default-information originate always

# OSPFv3
ipv6 router ospf 10
 router-id 2.2.2.2
interface Gig0/0
 ipv6 ospf 10 area 0
```

---

## 6. IS-IS (L1/L2)

- **클래스리스**, IP에 독립적(OSI CLNS 기반), **TLV** 확장성.
- **레벨**: **L1(인트라-Area)**, **L2(인터-Area)**, 또는 **L1-L2**.
- **주소**: **NET**(AFI+Area ID+System ID+NSEL).
- **Metric**: 넓은 메트릭(wide metrics) 사용 권장, 요약 및 레벨 경계 설계 용이.

```bash
#
router isis CORE
 net 49.0001.0000.0000.0001.00
 is-type level-2-only
 interface Gig0/0/0/0
  point-to-point
  address-family ipv4 unicast
   metric 10
```

---

## 7. EIGRP (Enhanced IGRP)

- **알고리즘**: **DUAL**(루프프리 경로 보장), **FS(Feasible Successor)** 백업 경로.
- **메트릭(기본 K1=K3=1; K2=K4=K5=0)**
$$
\text{Metric} = 256 \cdot \left(\frac{10^7}{\min(BW)} + \frac{\sum \text{Delay}}{10}\right)
$$
- **Feasibility Condition**: 이웃의 **RD(Reported Distance) < FD(Feasible Distance)** → FS로 채택 가능.
- **Unequal-cost Load-balancing**: **variance**.
- **EIGRP Stub**: 엣지 트래픽/쿼리 차단(요약/연결/정적만 광고).

```bash
router eigrp 100
 network 10.0.0.0 0.0.255.255
 eigrp stub connected static
 variance 2
```

---

## 8. BGP (Path-Vector)

### 8.1 역할
- **eBGP/iBGP**, **인터넷/AS간 라우팅 표준**.
- **Best Path**: 정책 기반(Weight/Local-Pref/AS-PATH/Origin/ MED/ eBGP>iBGP/IGP cost to next-hop/Router-ID …).
- **iBGP 풀메시** → **Route Reflector**로 확장.
- **필수는 필터/정책**: prefix-list/route-map/community.

### 8.2 미니 구성
```bash
router bgp 65001
 bgp log-neighbor-changes
 neighbor 203.0.113.2 remote-as 65002     # eBGP
 neighbor 203.0.113.2 ebgp-multihop 2
 !
 address-family ipv4
  network 203.0.113.0 mask 255.255.255.0
  neighbor 203.0.113.2 activate
  neighbor 203.0.113.2 route-map OUT out
!
route-map OUT permit 10
 set community 65001:100 additive
 set local-preference 200
```

### 8.3 기본 경로 주입
```bash
router bgp 65001
 address-family ipv4
  default-information originate   # 또는 IOS별 'neighbor ... default-originate'
```

---

## 9. 요약(Summarization)과 재분배(Redistribution)

### 9.1 요약
- **OSPF**: **ABR**(Area간), **ASBR**(외부)에서 수행.
- **EIGRP**: 인터페이스 단위 요약, **자동 요약(off)**.
- **BGP**: `aggregate-address`(AS-path attr 조합/AS_SET 옵션).

### 9.2 재분배
- **External/Seed Metric** 필수 지정(프로토콜마다 기본치 다름).
- **루프 방지**: 태그(Tag)와 **필터 규칙**으로 **역재분배 금지**.
- **AD/Preference** 차로 “원래 프로토콜 경로”가 우선되도록 설계.

```bash
# OSPF ← EIGRP 재분배 예
router ospf 1
 redistribute eigrp 100 subnets metric 10 metric-type 1
!
router eigrp 100
 redistribute ospf 1 metric 10000 100 255 1 1500 route-map FROM_OSPF
!
route-map FROM_OSPF permit 10
 set tag 1001
```

---

## 10. 고가용성/빠른 수렴

- **BFD(Bidirectional Forwarding Detection)**: **수~수십 ms** 수준의 링크/세션 탐지 → OSPF/IS-IS/EIGRP/BGP 연동.
- **OSPF/IS-IS FRR/LFA**: 사전계산된 대체 경로로 **로컬 패스트 리라우트**.
- **NSF/Graceful Restart**: 컨트롤 플레인 재시작 동안 포워딩 유지.
- **타이머 튜닝**: Hello/Dead, SPF Throttle, BGP Keepalive/Hold.

---

## 11. IPv6 라우팅 포인트

- **링크-로컬**(fe80::/10)이 **다음 홉**으로 자주 사용(인터페이스 지정 필수).
- **RIPng/OSPFv3/IS-IS MT/Single-Topology**: v6 전용 또는 듀얼-스택 운용.
- **BGP**: `address-family ipv6 unicast`, **Next-Hop v6**.
- **RA/SLAAC vs Static**: 서버/라우터는 보통 **정적 v6 주소 + RA 처리 정책**.

```bash
# IPv6 기본/정적
ipv6 route ::/0 2001:db8:1::1
# OSPFv3 재분배
ipv6 router ospf 10
 redistribute connected metric 10
```

---

## 12. 보안/위생(Best Practices)

- **Passive-interface**: 엣지/접속망에서 **라우팅 업데이트 차단**.
- **인증**: RIP MD5, OSPF MD5/OSPFv3 IPsec, IS-IS HMAC-MD5/SHA, **BGP TCP-MD5/TCP-AO**, GTSM(TTL=255).
- **필터**: prefix-list/route-map, **Bogon/사설 경로 차단**.
- **BGP**: **max-prefix**(세션 보호), **RTBH/Communities** 정책 엄수.
- **uRPF**(L3 에지): 소스 포착/스푸핑 완화(라우팅 비대칭 환경 주의).

---

## 13. 트러블슈팅(실무 루틴)

1) **레이어 확인**: 인터페이스 up/down? ARP/ND?
2) **RIB/FIB 확인**: `show ip route`, `show ip cef`.
3) **프로토콜 상태**: `show ip ospf neighbor`, `show ip bgp sum`, `show clns is-neighbors`, `show ip eigrp neighbors`, `show ip protocols`.
4) **경로 선택 충돌**: **Longest**→**AD**→**Metric** 순서로 원인 추적.
5) **재분배 루프/블랙홀**: 태그/필터 미설정? 요약 경계?
6) **Asymmetry**: ECMP/정책/BGP MED/Local-Pref → **방화벽 상태기반**과 충돌.
7) **해시/ECMP**: `per-flow`/`per-packet` 차이, 세션 분산 불균형.

**Wireshark/CLI 팁**
```
traceroute 8.8.8.8 source 203.0.113.10
ping 203.0.113.1 repeat 5 timeout 1
show ip route 192.0.2.0 255.255.255.0 longer-prefixes
debug ip packet detail   # (운영망 주의)
```

---

## 14. 수식/미니 계산기(개념)

### 14.1 OSPF 코스트
$$
\text{Cost}=\left\lfloor \frac{\text{Ref}}{\text{BW}}\right\rfloor,\quad
\text{Ref}=10^8\ (\mathrm{bps,\ 기본})
$$
- 1G 링크(10^9): Cost=0? → **1**로 클램프 or ref 조정 필요 → `auto-cost reference-bandwidth 100000`.

### 14.2 EIGRP 메트릭(기본 K)
$$
M=256\cdot\left(\frac{10^7}{\min BW} + \frac{\sum \text{Delay}}{10}\right)
$$
- BW(Kbps), Delay(μs) 합.

### 14.3 경로선택 요약
$$
\text{Best} = \arg\max(\text{PrefixLen}) \Rightarrow \min(\text{AD}) \Rightarrow \min(\text{Metric})
$$

---

## 15. 구성 예시: 소규모 브랜치 설계

### 시나리오
- **R1(본사)**—MPLS/Metro—**R2(브랜치)**
- 브랜치 내부는 **정적 + 추적 디폴트**, 백업 LTE는 **플로팅 정적**.
- 코어는 **OSPF Area 0**, 외부 인터넷 경로는 **eBGP**.

```bash
# R2
ip sla 10
 icmp-echo 10.0.0.1 source-interface Gig0/0
 frequency 5
ip sla schedule 10 life forever start-time now
track 10 ip sla 10 reachability

ip route 0.0.0.0 0.0.0.0 10.0.12.1 track 10
ip route 0.0.0.0 0.0.0.0 192.0.2.1 250    # LTE 백업

router ospf 100
 network 172.16.10.0 0.0.0.255 area 10
 area 10 stub
```
- **의도**: WAN 메인 다운 시 **정적 디폴트**가 제거되고 **플로팅**이 활성화. OSPF는 내부만.

---

## 16. 체크리스트(설계/운영)

- [ ] **토폴로지 규모/요구**에 맞는 프로토콜 선택(RIP≪EIGRP/OSPF/IS-IS≪BGP).
- [ ] **요약** 지점과 **재분배** 정책(태그/필터/Seed Metric) 정의.
- [ ] **AD/Preference** 확인(원래 경로가 우선되게).
- [ ] **BFD/FRR** 등 빠른 수렴 옵션 검토.
- [ ] **타이머** 튜닝은 신중(과도 단축은 플랩/CPU↑).
- [ ] **보안**: 인증, passive-if, prefix 필터, BGP max-prefix/GTSM.
- [ ] **문서화**: IP 플랜, 요약/재분배/정책, 다이어그램, 실패 시나리오.
- [ ] **모니터링**: 경로 변화, BGP 상태, SPF 시간, 플랩 감지.

---

## 17. 자주 틀리는 포인트(정오표)

1) **Longest Prefix** 우선 → AD/Metric보다 **먼저**.
2) **플로팅 정적**은 **AD**를 **올린다**(낮추는 게 아님).
3) OSPF **Ref BW** 미조정 시 1G/10G가 같은 코스트가 될 수 있음.
4) **재분배 루프**: 태그/필터 없이 **상호 재분배**하면 **루프/증폭**.
5) **EIGRP variance**는 **Feasible** 경로에만 적용(FC 불만족 링크엔 X).
6) **BGP**는 “가장 짧은 경로”가 아니라 **정책/속성** 우선(Local-Pref, AS-Path 등).
7) OSPF **NSSA**에서 Type-7 ↔ Type-5 변환은 **ABR**가 담당.

---

## 18. 연습문제(풀이 포함)

**Q1.** 동일 목적지에 `/24` 정적(AD 1)과 OSPF 경로가 존재. 동시에 `/25` OSPF 경로도 존재한다. 실제 포워딩은?
**A.** **Longest Prefix** → `/25` OSPF 경로 사용(AD 비교는 **동일 프리픽스**끼리만).

**Q2.** OSPF에서 1G/10G가 동일 코스트로 보이면 어떻게 조정?
**A.** `auto-cost reference-bandwidth 100000` 등으로 **Ref BW** 상향.

**Q3.** RIPv2에서 루프 방지 2가지만 쓰라.
**A.** **Split Horizon**, **Poison Reverse**(+ Holddown).

**Q4.** EIGRP에서 FS가 되려면 어떤 조건?
**A.** 이웃의 **Reported Distance < 내 Feasible Distance**.

**Q5.** OSPF E1 vs E2 차이는?
**A.** **E2**는 외부코스트만, **E1**은 내부코스트를 **누적**.

**Q6.** BGP Best Path에서 내부 트래픽 유도를 위해 AS 내부에서 우선 조정할 속성은?
**A.** **Local-Preference**(대역 내 전역적).

**Q7.** 정적 디폴트가 항상 살아있는데 상단 ISP가 죽어도 트래픽이 유실된다. 개선?
**A.** **IP SLA + track**으로 원격 가용성 연동 or **BFD**/**BGP**로 상태 반영.

**Q8.** 서로 다른 IGP 간 재분배 시 주의할 2가지?
**A.** **Seed Metric 설정**, **루프 방지(태그/필터)**.

---

## 19. 압축 암기표(시험 직전 14줄)

1) **RIB→FIB**, **Longest → AD → Metric → ECMP**
2) AD: **Connected 0, Static 1, eBGP 20, EIGRP 90, OSPF 110, RIP 120, iBGP 200**
3) **정적/플로팅/트래킹(IP SLA)**
4) 거리벡터=RIP(홉, 16=∞), 링크상태=OSPF/IS-IS(SPF)
5) EIGRP=DUAL/FS/variance, 하이브리드
6) BGP=정책(Local-Pref, AS-Path, MED, Weight)
7) OSPF 코스트=Ref/BW (Ref 조정!)
8) OSPF 영역/Stub/NSSA, DR/BDR, E1/E2
9) 요약: ABR/ASBR, EIGRP 인터페이스 요약
10) 재분배: **Seed Metric**, **Tag/Filter**로 루프 방지
11) BFD/FRR로 **빠른 수렴**
12) IPv6: 링크-로컬 next-hop, OSPFv3/BGPv6
13) 보안: 인증/Passive, BGP GTSM/MD5, max-prefix
14) 트러블슈팅: `show ip route`, 프로토콜별 neighbor/DB, traceroute

---

## 20. 마무리

- **작은/안정 구간**은 **정적 + 트래킹/플로팅**으로 단순/탄탄하게.
- **변화/확장 구간**은 **동적(IGP)**로, **AS 경계/정책**은 **BGP**로.
- **요약/재분배/AD/Metric**의 **조합 원리**만 정확히 잡으면, 대부분의 라우팅 시나리오를 **예측 가능**하게 설계/디버깅할 수 있습니다.
