---
layout: post
title: 미적분 - 정적분 계산법
date: 2025-06-28 23:20:23 +0900
category: 미적분
---
# 정적분 계산법 (Techniques of Definite Integration)

정적분은 구간 $$[a,b]$$ 에서 함수 $$f(x)$$ 의 **누적량/면적**을 구하는 연산이다.
핵심 원리(미적분학의 기본 정리, FTC Part 2): 원시함수 $$F' = f$$ 이면
$$
\int_a^b f(x)\,dx = F(b)-F(a).
$$

---

## 0. 전체 로드맵

1) 기본: **원시함수 → 끝점 대입**
2) **치환**과 **부분적분**
3) **대칭성**, **절댓값 분할**
4) **삼각함수 적분**(항등식/Weierstrass)
5) **삼각치환**(루트-이차식)
6) **부분분수**(유리함수)
7) **파라미터 미분(Leibniz)**
8) **좌표/축 변환**(극좌표/매개변수)
9) **부적분**과 수렴 판정
10) **감소식(환원식) 공식**과 반복 부분적분
11) **특수 적분**(가우스/Beta/Gamma)
12) **수치적분**(Trapezoid/Simpson)
13) **전략 트리 & 함정 체크리스트**
14) **대형 실전 예제 모음** + **파이썬 검증 코드**

---

## 1. 기본: 원시함수 → 끝점 대입 (FTC Part 2)

**루틴**
1) $$F'(x)=f(x)$$ 인 $$F$$ 를 구한다.
2) $$F(b)-F(a)$$ 를 계산한다.

**예 1**
$$
\int_{1}^{3} x^2\,dx
=\Big[\tfrac13 x^3\Big]_{1}^{3}
=\tfrac{27}{3}-\tfrac{1}{3}
=\tfrac{26}{3}.
$$

> 팁: 다항/지수/삼각/로그/역삼각은 **원시함수암기**로 속도 상승.

---

## 2. 치환적분 (Substitution)

복합함수/연쇄 구조를 **변수 치환**으로 단순화:
$$
\int_{a}^{b} f\big(g(x)\big)\,g'(x)\,dx
=\int_{g(a)}^{g(b)} f(u)\,du
\quad(u=g(x)).
$$

**예 2**
$$
\int_{0}^{2} x\sqrt{x^2+1}\,dx.
$$
치환 $$u=x^2+1,\ du=2x\,dx\Rightarrow x\,dx=\tfrac12\,du,$$
경계 $$x=0\mapsto u=1,\ x=2\mapsto u=5$$:
$$
\frac12\int_{1}^{5} u^{1/2}\,du
=\frac12\cdot\Big[\tfrac{2}{3}u^{3/2}\Big]_{1}^{5}
=\frac{1}{3}\big(5^{3/2}-1\big).
$$

**예 3 (교묘한 치환)**
$$
\int_{0}^{\pi/2}\frac{dx}{1+\sin x}.
$$
곱셈 유리화: $$\frac{1-\sin x}{1-\sin^2 x}=\frac{1-\sin x}{\cos^2 x}
=\sec^2 x-\sec x\tan x.$$
따라서
$$
\int_0^{\pi/2}\big(\sec^2 x-\sec x\tan x\big)\,dx
=\big[\tan x-\sec x\big]_0^{\pi/2}
=(+\infty - +\infty)\ \text{형태 주의}.
$$
직접 경계 극한을 분리:
$$
\lim_{b\uparrow \pi/2} \big(\tan b-\sec b\big) - (\tan 0-\sec 0)
=\lim_{b\uparrow \pi/2}\frac{\sin b -1}{\cos b} + 1
= -1+1=0.
$$
(유리화 치환이 경계에서 **상쇄**됨을 확인해야 한다.)

> 함정: **구간도 함께** 바꿔야 함. 치환 후 **부호**와 **경계 극한**을 점검.

---

## 3. 부분적분 (Integration by Parts)

곱을 분해한다(곱의 미분의 역):
$$
\int_{a}^{b} u\,dv = \big[uv\big]_{a}^{b}-\int_{a}^{b} v\,du.
$$

**선정 요령(LIATE)**: Logarithm → Inverse trig → Algebraic → Trig → Exponential 순으로 주로 **u**를 고른다.

**예 4**
$$
\int_{0}^{1} x e^x\,dx
=\big[x e^x\big]_0^1-\int_{0}^{1} e^x\,dx
=(e-0)-(e-1)=1.
$$

**예 5 (반복 부분적분)**
$$
\int_{0}^{\infty} x e^{-ax}\,dx\quad(a>0).
$$
한 번 부분적분하면 $$\int_0^\infty e^{-ax}dx=\tfrac1a$$ 로 귀결:
$$
\int_{0}^{\infty} x e^{-ax}dx=\frac{1}{a^2}.
$$

---

## 4. 절댓값/부호 분할

부호 바뀌는 점에서 분할:
$$
\int_{-2}^{2}|x|\,dx
=\int_{-2}^{0}(-x)\,dx+\int_{0}^{2}x\,dx
=2+2=4.
$$

**예 6**
$$
\int_{-\pi}^{\pi} |\sin x|\,dx
=2\int_{0}^{\pi} \sin x\,dx
=4.
$$

---

## 5. 대칭성(짝/홀)과 주기성

| 조건 | 결과 |
|---|---|
| $$f(-x)=f(x)$$ (짝수) | $$\displaystyle\int_{-a}^{a} f(x)\,dx=2\int_{0}^{a} f(x)\,dx$$ |
| $$f(-x)=-f(x)$$ (홀수) | $$\displaystyle\int_{-a}^{a} f(x)\,dx=0$$ |

**예 7**
$$
\int_{-2}^{2} x^2\,dx
=2\int_{0}^{2} x^2\,dx
=\tfrac{16}{3}.
$$

**예 8 (평행 대칭 트릭)**
$$
\int_{0}^{a} f(x)\,dx=\int_{0}^{a} f(a-x)\,dx.
$$
따라서
$$
\int_{0}^{a}\frac{dx}{1+\exp(x)}
=\int_{0}^{a}\frac{dx}{1+\exp(a-x)}
=\int_{0}^{a}\frac{dx}{1+e^{a}e^{-x}}.
$$
두 식을 더하면
$$
\int_0^a\Big(\frac{1}{1+e^x}+\frac{1}{1+e^a e^{-x}}\Big)\,dx
=\int_0^a 1\,dx = a
$$
이므로 원적분은 $$a/2$$.

---

## 6. 삼각함수 적분(항등식, 거듭제곱, Weierstrass)

### 6.1 거듭제곱 적분
- $$\int \sin^m x \cos^n x\,dx$$:
  홀수 지수 하나 있으면 **남겨놓고 나머지 변환**.
  짝짝이면 **반각/배각**으로 변환.

**예 9**
$$
\int_{0}^{\pi/2}\sin^3 x\cos^2 x\,dx
=\int_{0}^{\pi/2}(1-\cos^2 x)\sin x\cos^2 x\,dx
$$
치환 $$u=\cos x,\,du=-\sin x\,dx$$ 로 정적분화.

### 6.2 합차/배각/반각
$$
\sin^2 x=\frac{1-\cos 2x}{2},\quad
\cos^2 x=\frac{1+\cos 2x}{2},\quad
\sin a\sin b=\frac{\cos(a-b)-\cos(a+b)}{2},\ \ldots
$$

### 6.3 Weierstrass 치환
$$t=\tan\frac{x}{2},\quad
\sin x=\frac{2t}{1+t^2},\quad
\cos x=\frac{1-t^2}{1+t^2},\quad
dx=\frac{2\,dt}{1+t^2}.
$$
삼각적분을 **유리함수적분**으로 변환(정적분이면 경계도 $$t$$ 로 변환).

---

## 7. 삼각치환 (루트-이차식)

루트 안 **이차식**엔 삼각치환이 강력:

- $$\sqrt{a^2-x^2}:\ x=a\sin\theta,\quad dx=a\cos\theta\,d\theta.$$
- $$\sqrt{a^2+x^2}:\ x=a\tan\theta,\quad dx=a\sec^2\theta\,d\theta.$$
- $$\sqrt{x^2-a^2}:\ x=a\sec\theta,\quad dx=a\sec\theta\tan\theta\,d\theta.$$

**예 10 (반원 면적)**
$$
\int_{0}^{a} \sqrt{a^2-x^2}\,dx=\frac{\pi a^2}{4}.
$$
(삼각치환이나 기하학으로 즉시.)

**예 11 (경계가 각도로 바뀌는 경우)**
$$
\int_{0}^{1}\frac{dx}{\sqrt{1-x^2}}
=\big[\arcsin x\big]_0^1=\frac{\pi}{2}.
$$

---

## 8. 부분분수 (Partial Fractions)

유리함수는 분모 인수분해 후 항등식 맞추기(정적분은 **경계 정의역**과 **부적분 여부** 주의).

### 8.1 단순 선형 인수
$$
\frac{A}{x-a}+\frac{B}{x-b}.
$$

### 8.2 중근
$$
\frac{A}{(x-a)}+\frac{B}{(x-a)^2}+\cdots.
$$

### 8.3 기약 이차 인수
$$
\frac{Ax+B}{x^2+px+q}.
$$

**예 12**
$$
\int_{0}^{1}\frac{2x+3}{x^2+3x+2}\,dx
=\int_{0}^{1}\Big(\frac{1}{x+1}+\frac{1}{x+2}\Big)\,dx
=\big[\ln(x+1)+\ln(x+2)\big]_0^{1}
=\ln 3.
$$

> 팁: 부적분이면 반드시 **극한** 정의로 계산(§9).

---

## 9. 파라미터 미분/적분 하 미분 (Leibniz)

적분 내부에 **파라미터**가 있으면 미분하여 폐형을 얻는다(지배수렴 등 정칙 조건 필요).

**예 13**
$$
I(\alpha)=\int_{0}^{1} x^\alpha \ln x\,dx,\ \alpha>-1.
$$
먼저 $$J(\alpha)=\int_{0}^{1}x^\alpha dx=\frac{1}{\alpha+1}$$,
미분:
$$
I(\alpha)=J'(\alpha)=-\frac{1}{(\alpha+1)^2}.
$$

**예 14 (Feynman Trick)**
$$
K(a)=\int_{0}^{\infty} e^{-ax}\sin x\,dx,\ a>0.
$$
표준 결과 $$K(a)=\frac{1}{1+a^2}$$ 를, 또는
$$
K'(a)=-\int_0^\infty x e^{-ax}\sin x\,dx
$$
로 만들어 라플라스-푸리에 표와 연결.

---

## 10. 좌표/축 변환 (y-적분, 극좌표, 매개변수)

- $$x=f(y)$$ 가 간단한 경우: $$\int f(y)\,dy$$ 로 전환.
- **극좌표**: 원형/방사 대칭 영역
  $$
  \iint_R f(x,y)\,dA
  =\int_{\theta_1}^{\theta_2}\int_{r_1(\theta)}^{r_2(\theta)}
  f(r\cos\theta,r\sin\theta)\,r\,dr\,d\theta.
  $$
- **직교 변환**: $$u=ax+by,\ v=cx+dy$$, 야코비안으로 면적 요소 변환.

**예 15 (가우스 적분 §11로 연결)**
$$
\int_{-\infty}^{\infty} e^{-x^2}\,dx
=\sqrt{\pi},
$$
는 이중적분+극좌표로 계산.

---

## 11. 부적분(Improper Integrals)과 수렴 판정

경계/내부 특이점 또는 무한구간:
$$
\int_{a}^{b} f(x)\,dx
=\lim_{\varepsilon\to 0^+}\int_{a+\varepsilon}^{b} f(x)\,dx,\quad
\int_{a}^{\infty} f(x)\,dx
=\lim_{R\to\infty}\int_{a}^{R} f(x)\,dx.
$$

**대표 수렴 기준**
- $$\displaystyle \int_{1}^{\infty} \frac{dx}{x^p}$$ 은 $$p>1$$ 수렴, $$p\le 1$$ 발산.
- **비교판정**: $$0\le f\le g$$, $$\int g$$ 수렴 ⇒ $$\int f$$ 수렴.
- **극한비교**: $$\lim_{x\to\infty}\frac{f(x)}{g(x)}=L\in(0,\infty)$$ 이면 같은 판정.

**예 16**
$$
\int_{1}^{\infty}\frac{\ln x}{x^2}\,dx
=\big[-\tfrac{\ln x}{x}\big]_{1}^{\infty}
-\int_{1}^{\infty}\big(-\tfrac{1}{x}\cdot\tfrac{1}{x}\big)\,dx
=0-(-1)=1.
$$

**예 17 (경계 특이점)**
$$
\int_{0}^{1}\frac{dx}{\sqrt{x}}
=\lim_{\varepsilon\downarrow 0}\int_{\varepsilon}^{1}x^{-1/2}dx
=\lim_{\varepsilon\downarrow 0} \big[2\sqrt{x}\big]_{\varepsilon}^{1}
=2.
$$

---

## 12. 감소식(환원식) 공식과 반복 부분적분

### 12.1 삼각 거듭제곱 환원식
$$
I_n=\int_{0}^{\pi/2}\sin^n x\,dx
=\frac{n-1}{n}\,I_{n-2},\quad I_0=\frac{\pi}{2},\ I_1=1.
$$
따라서 짝/홀에 대해 닫힌형.

**예 18**
$$
\int_{0}^{\pi/2}\sin^4 x\,dx
=\frac{3}{4}\cdot\frac{1}{2}\cdot\frac{\pi}{2}
=\frac{3\pi}{16}.
$$

### 12.2 지수-다항 반복
$$
\int x^n e^{ax}\,dx
$$
는 부분적분 반복으로 $$x^n$$ 차수를 단계별로 낮춰 환원.

---

## 13. 특수 적분(가우스/Beta/Gamma)

### 13.1 가우스 적분
$$
\int_{-\infty}^{\infty} e^{-x^2}\,dx=\sqrt{\pi}.
$$
**스케일링**: $$\int_{-\infty}^{\infty} e^{-ax^2}\,dx=\sqrt{\frac{\pi}{a}},\ a>0.$$

### 13.2 Beta/Gamma
$$
B(p,q)=\int_0^1 x^{p-1}(1-x)^{q-1}\,dx=\frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}.
$$
삼각형대칭 형태
$$
\int_0^{\pi/2}\sin^{p-1}x\,\cos^{q-1}x\,dx=\frac12 B\!\left(\frac{p}{2},\frac{q}{2}\right).
$$
**예 19**
$$
\int_{0}^{\pi/2}\sin^{m}x\,dx
=\frac{\sqrt{\pi}\,\Gamma\!\big(\frac{m+1}{2}\big)}{2\,\Gamma\!\big(\frac{m}{2}+1\big)}.
$$

---

## 14. 수치적분 (Trapezoid/Simpson) + 오차

**사다리꼴(균등 분할, 간격 $$h$$, 노드 $$n+1$$)**
$$
\int_{a}^{b} f(x)\,dx \approx
\frac{h}{2}\Big(f(x_0)+2\sum_{k=1}^{n-1}f(x_k)+f(x_n)\Big),\quad
E_T=-\frac{(b-a)h^2}{12}f''(\xi).
$$

**심프슨(짝수 분할수)**
$$
\int_{a}^{b} f(x)\,dx \approx
\frac{h}{3}\Big(f(x_0)+4\sum_{\text{홀}}f(x_k)+2\sum_{\text{짝}}f(x_k)+f(x_n)\Big),\quad
E_S=-\frac{(b-a)h^4}{180}f^{(4)}(\xi).
$$

> 팁: 매끄러우면 **심프슨**. 급격 변화·특이점 근방은 **비균등 분할** 또는 **치환**으로 완화.

---

## 15. 전략 트리 & 함정 체크리스트

### 15.1 전략 트리
1) **원시함수 직공** 가능한가? (다항/지수/삼각/로그/역삼각)
2) **치환**으로 연쇄가 풀리나?
3) **부분적분**으로 곱이 분해되나?
4) **유리함수**면 **부분분수** 시도?
5) 루트-이차식이면 **삼각치환**?
6) **대칭/절댓값 분할/주기성**으로 단순화?
7) 무한구간/특이점 ⇒ **부적분+비교**?
8) 닫힌형 어려움 ⇒ **수치적분**.

### 15.2 함정 체크
- [ ] 치환 시 **하한·상한 변환** 잊지 않기.
- [ ] **절댓값**은 분할 또는 부호 반전.
- [ ] **부적분**은 반드시 **극한 정의**.
- [ ] 분모 0/로그 정의역 주의.
- [ ] 반복 부분적분/환원식은 **초깃값** 확인.
- [ ] 유리화/삼각치환 후 **경계 상쇄/역치환** 정확히.

---

## 16. 대형 실전 예제 모음(풀이 포함)

### 예 20 — 대칭성+치환 혼합
$$
I=\int_{0}^{\pi}\frac{dx}{1+\sin x}.
$$
유리화: $$\frac{1-\sin x}{\cos^2 x}=\sec^2 x-\sec x\tan x.$$
분할적분:
$$
I=\int_0^\pi \sec^2 x\,dx - \int_0^\pi \sec x\tan x\,dx.
$$
개별 항은 무한대로 발산하므로, **원래 적분**에서는 두 항이 정확히 상쇄됨을 경계에서 확인해야 한다.
보다 안전한 접근: $$x\mapsto \pi-x$$ 치환으로 $$I=\int_0^\pi \frac{dx}{1+\sin(\pi-x)}=\int_0^\pi \frac{dx}{1+\sin x}$$ 동일.
정석은 **정의역 분할**과 **극한**:
$$
\int_0^{\pi}=\lim_{\varepsilon\downarrow 0}\left(\int_0^{\frac{\pi}{2}-\varepsilon}+\int_{\frac{\pi}{2}+\varepsilon}^{\pi}\right)\frac{dx}{1+\sin x}
= \pi - 2.
$$
(계산은 유리화 후 원시함수의 **경계 극한**으로 확인 가능.)

### 예 21 — 삼각치환
$$
\int_{0}^{3} \frac{x^2\,dx}{\sqrt{9-x^2}}
$$
치환 $$x=3\sin\theta,\ dx=3\cos\theta\,d\theta,\ \sqrt{9-x^2}=3\cos\theta$$,
경계 $$x=0\mapsto \theta=0,\ x=3\mapsto \theta=\pi/2$$:
$$
\int_0^{\pi/2} \frac{9\sin^2\theta\cdot 3\cos\theta}{3\cos\theta}\,d\theta
=9\int_0^{\pi/2}\sin^2\theta\,d\theta
=9\cdot\frac{\pi}{4}.
$$

### 예 22 — 부분분수(부적분 포함)
$$
\int_{0}^{1}\frac{dx}{x(x+1)}
=\lim_{\varepsilon\downarrow 0}\int_{\varepsilon}^{1}\Big(\frac{1}{x}-\frac{1}{x+1}\Big)\,dx
=\lim_{\varepsilon\downarrow 0}\big(\ln 1-\ln \varepsilon-\ln 2+\ln(1+\varepsilon)\big)
=+\infty.
$$

### 예 23 — 환원식
$$
I_n=\int_{0}^{\pi/2}\sin^n x\,dx,\quad I_n=\frac{n-1}{n}I_{n-2}.
$$
$$
I_6=\frac{5}{6}\cdot\frac{3}{4}\cdot\frac{1}{2}\cdot\frac{\pi}{2}=\frac{5\pi}{32}.
$$

### 예 24 — Beta/Gamma 활용
$$
\int_{0}^{1} x^{p-1}(1-x)^{q-1}\,dx=B(p,q)
=\frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}.
$$
$$
\int_{0}^{\pi/2}\sin^{m}x\,dx
=\frac{1}{2}\,B\!\left(\frac{m+1}{2},\frac{1}{2}\right).
$$

### 예 25 — 파라미터 미분
$$
I(a)=\int_{0}^{\infty}\frac{e^{-ax}-e^{-bx}}{x}\,dx,\quad a,b>0.
$$
미분하면
$$
I'(a)=\int_0^\infty -e^{-ax}\,dx=-\frac1a,\quad
I'(b)=\frac1b.
$$
적분하면
$$
I(a)= -\ln a + C,\quad
I(b)= \ln b + C'.
$$
원래 정의로 $$I(a)=\ln\frac{b}{a}.$$

---

## 17. 파이썬으로 수치 검증

### 17.1 예 2 검증
```python
import numpy as np

f = lambda x: x*np.sqrt(x**2+1)
xs = np.linspace(0, 2, 20001)
area_trap = np.trapz(f(xs), xs)
closed = (1/3)*(5**1.5 - 1)
print("수치:", area_trap, "폐형:", closed)
```

### 17.2 부적분(경계 특이) 안전 적분
```python
import numpy as np

def safe_integral(fun, a, b, eps=1e-6, N=200000):
    # 경계 특이: (a+eps, b-eps)에서 수치적분
    xs = np.linspace(a+eps, b-eps, N)
    return np.trapz(fun(xs), xs)

g = lambda x: 1/np.sqrt(x)  # ∫_0^1
print("근사:", safe_integral(g, 0.0, 1.0), "이론:", 2.0)
```

### 17.3 삼각 환원식 수치 체크
```python
import numpy as np

def I(n):
    x = np.linspace(0, np.pi/2, 500000)
    return np.trapz(np.sin(x)**n, x)

for n in [2,4,6]:
    print(n, I(n))
```

---

## 18. 한눈 요약

- **FTC**: 원시함수의 끝점 차로 정적분 계산.
- **치환/부분적분/부분분수/삼각치환**: 1차 무기.
- **대칭·절댓값·주기성**: 구조를 단순화.
- **부적분**: 극한 정의 + 비교/환원.
- **Beta/Gamma/가우스**: 특수 적분의 표준 해법.
- **수치적분**: 닫힌형이 어렵거나 특이점이 있는 경우 실전 대안.
- 풀이 전 **전략 트리**로 기법을 매칭, 풀이 중 **함정 체크**로 실수 예방.
