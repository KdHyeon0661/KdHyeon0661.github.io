---
layout: post
title: 정보보안기사 - part 1 기출
date: 2025-11-06 14:25:23 +0900
category: 정보보안기사
---
# 정보보안기사 실기 — **기출 포인트 정리 & 예상문제(실무형) 모음**

## 0) 한 눈에 보는 포인트 맵 (최근 경향 요약)

- **시스템 보안**: 계정/권한(리눅스 `PAM/SSH`, 윈도우 `GPO/이벤트`), 서비스 하드닝(`/tmp noexec`, SELinux/AppArmor, WDAC/AppLocker)  
- **네트워크/패킷**: TLS 구성(1.2/1.3만), 보안 헤더, L4/7 흐름 분석, 흔한 공격 징후(SYN/UDP flood 지표)  
- **웹/응용**: 입력검증/Prepared Statement, 인증/세션, `CSP/HSTS`, 업로드/리다이렉트/파일노출, 기본 디렉터리 차단  
- **취약점 진단**: `nmap` 식별 → `httpx/nuclei` 저위험 확인 → 결과 해석과 오탐 제거, **보고서 작성**  
- **로그/감사**: Windows(4624/4625/4688/4719/1102, 4103/4104), Linux(auditd/journald), 중앙집중(WEF/rsyslog)  
- **암호/접근통제**: PW 정책(12/복잡/역사/잠금), `faillock`/`pwquality`, 윈도우 FGPP, MFA 접점  
- **클라우드/IAM**: 최소권한 정책, 보안 그룹(기본거부), 오브젝트 스토리지 공개 차단  
- **보안관리/법규**: ISMS-P 통제 맵핑, 위험도 산정, 증빙 중심 보고서

수식(리스크 산정의 기본 틀):
$$
\text{Risk} = \text{Likelihood}(P) \times \text{Impact}(I)
$$

---

# 1. **기출 포인트 압축 정리 (섹션별 핵심 문항)**

### 1.1 시스템(리눅스/유닉스)
- PAM 암호 정책: `/etc/security/pwquality.conf` (minlen/credit), `faillock`(deny/unlock_time)  
- SSH 하드닝: `PermitRootLogin no`, `PasswordAuthentication no`, `AllowUsers`, 강한 KEX/Cipher/MAC  
- 파일시스템: `/tmp noexec`, `nodev`, `nosuid`, umask, 권한/소유자  
- SELinux/AppArmor: 서비스별 `type` 라벨링, 네트워크 허용 boolean

**암기 스니펫**  
```bash
# /etc/ssh/sshd_config 핵심
Protocol 2
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
AllowUsers admin@10.10.0.0/16
```

### 1.2 시스템(Windows)
- PW/잠금: `net accounts`, 도메인 환경은 GPO/FGPP  
- 고급 감사: Logon/Account/Policy/ProcessCreation, PowerShell(4103/4104)  
- 로깅 포워딩: WEF Collector/Subscription  
- 응용제어: AppLocker/WDAC 개념, 감사→강제

**암기 스니펫**  
```powershell
# 로컬 비밀번호/잠금 요약
net accounts /minpwlen:12 /maxpwage:90 /minpwage:1 /uniquepw:24 /lockoutthreshold:5 /lockoutduration:15 /lockoutwindow:15
```

### 1.3 네트워크/웹
- TLS: 1.2/1.3 강제, 취약 스위트 제거, 인증서 체인  
- 보안 헤더: HSTS/CSP/XFO/XCTO/RP/PP  
- 리버스 프록시 기본: 업스트림 내부 바인딩, 로그 JSON, `client_max_body_size` 제한  
- 디렉터리 인덱싱 차단, 업로드 확장자/경로 통제

**암기 스니펫(Nginx)**  
```nginx
ssl_protocols TLSv1.2 TLSv1.3;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header Content-Security-Policy "default-src 'self'";
```

### 1.4 취약점 진단/모의해킹
- 스캐닝 흐름: 범위/ROE → nmap → 서비스/웹 식별 → nuclei(저위험) → 결과 해석/오탐 제거 → 권고/보고  
- 안전 스위치: `-T3 --max-retries 2`, `-rl`, `-etags exploit`  
- 보고서: 증거(요청/응답/버전/캡처) + 영향 + 권고 + 재현 절차

### 1.5 로그/감사/포렌식
- Windows 이벤트 ID 맵(4624/4625/4688/4719/1102/4104)  
- Linux `auditd` 키워드: `auth_change/sudo_edit/ssh_conf/exec`  
- 중앙집중: WEF/rsyslog(6514/TLS)/저장 정책

---

# 2. **예상문제 세트 (실기형) — 12세트**  
> 각 세트: **문제 → 요구사항 → 제공자료 → 정답 예(명령/설정) → 채점기준** 순

---

## 세트 1) 리눅스 암호/잠금 정책 구현

**문제**: 다음 요구를 만족하도록 서버의 암호/잠금 정책을 설정하고 검증 스크린샷을 제출하라.  
- 최소 길이 12, 대/소/숫자/특수 1자 이상, 반복 3회 제한  
- 5회 실패 시 15분 잠금, 관찰 창 15분  
- 최대 사용기간 90일, 최소 1일, 만료 14일 전 경고

**정답 예**  
```bash
# 1) 기본값
sudo sed -i 's/^PASS_MAX_DAYS.*/PASS_MAX_DAYS 90/' /etc/login.defs
sudo sed -i 's/^PASS_MIN_DAYS.*/PASS_MIN_DAYS 1/' /etc/login.defs
sudo sed -i 's/^PASS_WARN_AGE.*/PASS_WARN_AGE 14/' /etc/login.defs

# 2) pwquality
sudo tee /etc/security/pwquality.conf <<'EOF'
minlen = 12
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1
maxrepeat = 3
dictcheck = 1
EOF

# 3) faillock (배포판별 PAM 포함 위치 상이)
sudo authselect select sssd with-faillock --force || true
sudo tee /etc/security/faillock.conf <<'EOF'
deny=5
unlock_time=900
fail_interval=900
EOF

# 4) 사용자 적용 확인
sudo chage -l devuser
faillock --user devuser
```

**채점기준(20점)**  
- `pwquality.conf` 항목 정확(8) / `faillock` 값(6) / `login.defs`(4) / 검증결과 캡처(2)

---

## 세트 2) SSH 하드닝 & 화이트리스트

**문제**: SSH를 **키 인증만 허용**, **root 로그인 금지**, `10.10.0.0/16`의 `admin/devops`만 로그인 허용.

**정답 예**  
```bash
sudo cp /etc/ssh/sshd_config{,.bak}
sudo tee /etc/ssh/sshd_config <<'EOF'
Protocol 2
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
KexAlgorithms curve25519-sha256@libssh.org
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
AllowUsers admin@10.10.0.0/16 devops@10.10.0.0/16
EOF
sudo systemctl reload sshd
```

**채점(15점)**  
- root 금지(3) / PW 인증 끄기(3) / AllowUsers(4) / 강한 알고리즘(3) / 재기동/검증(2)

---

## 세트 3) `/tmp noexec` 및 커널 네트워크 하드닝

**문제**: `/tmp` 실행 금지, redirect/tcp_syncookies 등 기본 네트워크 하드닝.

**정답 예**  
```bash
echo "tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev,mode=1777 0 0" | sudo tee -a /etc/fstab
sudo mount -o remount /tmp

sudo tee /etc/sysctl.d/99-hardening.conf <<'EOF'
net.ipv4.conf.all.rp_filter=1
net.ipv4.conf.default.rp_filter=1
net.ipv4.conf.all.accept_redirects=0
net.ipv4.conf.default.accept_redirects=0
net.ipv4.tcp_syncookies=1
net.ipv4.icmp_echo_ignore_broadcasts=1
fs.protected_hardlinks=1
fs.protected_symlinks=1
EOF
sudo sysctl --system
```

**채점(10점)**  
- `/tmp noexec`(5) / sysctl 핵심(5)

---

## 세트 4) Windows PW/잠금/감사 정책 일괄 적용

**문제**: 로컬 보안 정책으로 아래를 적용하고 이벤트 로깅을 활성화하라.  
- PW 12자/90일/역사24/최소1일, 잠금5회/15분  
- 고급 감사(Logon/Account/Policy/ProcessCreation) + 명령줄/PS 로깅

**정답 예**  
```powershell
# PW/잠금
net accounts /minpwlen:12 /maxpwage:90 /minpwage:1 /uniquepw:24 /lockoutthreshold:5 /lockoutduration:15 /lockoutwindow:15

# Advanced Audit
$subs = "Logon","Account Logon","Account Management","Policy Change","Detailed Tracking","Object Access","Privilege Use"
$subs | % { auditpol /set /category:$_ /success:enable /failure:enable }

# Process cmdline + PowerShell logging
New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Name "ProcessCreationIncludeCmdLine_Enabled" -Type DWord -Value 1

$base="HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell"
New-Item "$base\ScriptBlockLogging" -Force | Out-Null
Set-ItemProperty "$base\ScriptBlockLogging" -Name EnableScriptBlockLogging -Type DWord -Value 1
New-Item "$base\ModuleLogging\ModuleNames" -Force | Out-Null
Set-ItemProperty "$base\ModuleLogging" -Name EnableModuleLogging -Type DWord -Value 1
New-ItemProperty "$base\ModuleLogging\ModuleNames" -Name "*" -PropertyType String -Value "*" -Force | Out-Null
```

**채점(20점)**  
- `net accounts`(6) / `auditpol`(6) / cmdline 로깅(4) / PS 로깅(4)

---

## 세트 5) Nginx TLS/보안 헤더/업스트림 내부화

**문제**: 다음 요구 맞게 리버스 프록시를 구성하라.  
- TLS 1.2/1.3만, HSTS/CSP/XFO/XCTO/RP/PP 헤더  
- 업스트림은 `127.0.0.1:8080`, `client_max_body_size 10m`, JSON 로그

**정답 예**  
```nginx
server {
  listen 443 ssl http2;
  server_name lab.example.com;

  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers HIGH:!aNULL:!MD5:!RC4;
  ssl_certificate     /etc/letsencrypt/live/lab.example.com/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/lab.example.com/privkey.pem;

  add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
  add_header Content-Security-Policy "default-src 'self'";
  add_header X-Frame-Options "DENY";
  add_header X-Content-Type-Options "nosniff";
  add_header Referrer-Policy "strict-origin-when-cross-origin";
  add_header Permissions-Policy "geolocation=(), microphone=(), camera=()";

  client_max_body_size 10m;

  location / {
    proxy_pass http://127.0.0.1:8080;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header X-Forwarded-Proto https;
  }

  access_log /var/log/nginx/access_json.log json;
}
log_format json escape=json
  '{ "time":"$time_iso8601","remote":"$remote_addr","request":"$request","status":$status,"bytes":$body_bytes_sent,"ua":"$http_user_agent","upstream":"$upstream_addr","rt":$request_time }';
```

**채점(15점)**  
- TLS(3) / 헤더(6) / 업스트림/바디 사이즈(3) / JSON 로그(3)

---

## 세트 6) TLS 취약 스위트/프로토콜 진단 & 권고

**문제**: 대상 `lab.example.com:443`에서 TLS 1.0/1.1 허용 여부, 취약 스위트 존재 여부를 확인하고 **권고문** 작성.  
**정답 예(명령/요지)**  
```bash
# 1) TLS 1.0/1.1 강제 시도
echo | openssl s_client -connect lab.example.com:443 -tls1
echo | openssl s_client -connect lab.example.com:443 -tls1_1
# 실패(Handshake failure)면 안전

# 2) 스위트 열람(개요)
nmap --script ssl-enum-ciphers -p 443 lab.example.com -oN out/ssl.txt
```
**권고 요지**: TLS1.2/1.3만 허용, `HIGH:!aNULL:!MD5:!RC4`, HSTS 적용, 재검증은 `openssl` 시도 실패 + SSL Labs A 등급.

**채점(10점)**  
- 검증 명령(5) / 권고 핵심(5)

---

## 세트 7) 보안 헤더 미적용 진단 & 수정

**문제**: `curl -I` 결과에서 HSTS/CSP/XFO/XCTO 미적용을 확인하고 Nginx 수정안 제시.  
**정답 예**  
```bash
curl -sI https://lab.example.com | egrep -i 'strict-transport|content-security|x-frame-options|x-content-type-options|referrer-policy|permissions-policy'
# 출력 없다면 미적용 → 세트 5 설정으로 보완
```
**채점(8점)**  
- 진단(3) / 수정안 구체성(5)

---

## 세트 8) 웹 민감 경로 노출 차단

**문제**: `/backup/`에서 리스트 노출(`Index of`) 확인됨. 차단 구성 제시.  
**정답 예**  
```nginx
location /backup/ { deny all; return 403; }
# 또는
autoindex off;
```
**채점(7점)**  
- 정책(deny/403) 또는 `autoindex off`(각 4/3)

---

## 세트 9) 취약점 스캔(저위험) 결과 해석 & 오탐 제거

**문제**: 다음 도구로 스캔하고 **오탐 제거 근거**를 제시하라(운영 금지/랩만).  
- `nmap -sV -sC`, `httpx -json`, `nuclei -severity low,medium -etags exploit`

**정답 예(핵심)**  
```bash
nmap -sV -sC -Pn lab.example.com -oX out/nmap.xml
httpx -status-code -title -tech-detect -json -o out/http.json < targets.txt
nuclei -rl 20 -l http_targets.txt -severity low,medium -etags exploit -o out/nuclei.txt
```
- 오탐 판정 예: 취약 버전처럼 보이나 **백포트 패치** 확인(배포판 CVE 제거 공지), WAF가 차단하여 **서버 도달 불가** 등.

**채점(12점)**  
- 안전 스위치 사용(4) / 결과 요약(4) / 오탐 근거(4)

---

## 세트 10) Windows 이벤트 헌팅(4104/4688/1102)

**문제**: 최근 24h 동안 `-enc` PowerShell 실행과 로그 삭제(1102) 이벤트를 추출하라.  
**정답 예**  
```powershell
$start=(Get-Date).AddDays(-1)

# 4104 ScriptBlock -enc
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; StartTime=$start} |
? { $_.Message -match "-enc" -or $_.Message -match "FromBase64String" } |
Select TimeCreated,Message

# 4688 Process Creation -enc
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4688; StartTime=$start} |
? { $_.Message -match " -enc " } | Select TimeCreated,Message

# 1102 로그 지움
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=1102; StartTime=$start} |
Select TimeCreated,Message
```
**채점(12점)**  
- 4104(4) / 4688(4) / 1102(4)

---

## 세트 11) Linux auditd 규칙 작성 & 검증

**문제**: `/etc/passwd`, `/etc/shadow`, `/etc/ssh/sshd_config` 변경 감시 + `execve` 추적 규칙을 작성하고 최근 변경 이벤트를 조회.  
**정답 예**  
```text
# /etc/audit/rules.d/hard.rules
-w /etc/passwd -p wa -k auth_change
-w /etc/shadow -p wa -k auth_change
-w /etc/ssh/sshd_config -p wa -k ssh_conf
-a always,exit -F arch=b64 -S execve -k exec
-a always,exit -F arch=b32 -S execve -k exec
```
```bash
sudo augenrules --load && sudo systemctl restart auditd
sudo ausearch -k auth_change | tail
sudo aureport -au -i | tail
```
**채점(10점)**  
- 규칙 정확(6) / 검증 명령(4)

---

## 세트 12) **보고서 작성 과제(핵심)** — “취약 구성 3종 개선 제안”

**문제**: 다음 세 발견사항에 대해 **증거/영향/권고/재현** 양식의 **간략 보고서**를 작성하라.  
1) TLS1.0 허용  
2) 보안 헤더 미적용  
3) `/backup/` 인덱스 노출

**모범 양식(요지)**  
```markdown
### F-1 TLS1.0 허용 (High)
- 증거: `openssl -tls1` 성공 (응답 캡처 첨부)
- 영향: 구형 클라이언트 협상에 따른 기밀성 저하, 규제 미준수 위험
- 권고: TLS 1.2/1.3만 허용, 스위트 'HIGH:!aNULL:!MD5:!RC4', HSTS 적용
- 재현: openssl 재시도 실패 여부 확인 + SSL Labs A

### F-2 보안 헤더 미적용 (Medium)
- 증거: `curl -I` 결과 HSTS/CSP/XFO/XCTO 없음
- 권고: Nginx 추가 헤더 적용 (설정 스니펫 첨부)
- 재현: curl로 헤더 확인, 브라우저 콘솔 CSP 위반 없음

### F-3 디렉터리 인덱싱 (Medium)
- 증거: `/backup/`에서 'Index of' 노출
- 권고: `location /backup/ { deny all; return 403; }` 또는 `autoindex off`
- 재현: 403/404 응답 확인
```

**채점(20점)**  
- 증거 명확성(6) / 권고의 구체성(8) / 재현 가능성(4) / 형식 준수(2)

---

# 3. **스피드 암기 노트 (정답 키 포맷)**

- 리눅스 PW/잠금: `pwquality`(minlen/credit), `faillock`(deny/unlock/fail_interval), `chage(90/1/14)`  
- SSH: `PermitRootLogin no`, `PasswordAuthentication no`, `AllowUsers`, 강한 KEX/Cipher/MAC  
- FS/커널: `/tmp noexec`, `rp_filter=1`, `accept_redirects=0`, `tcp_syncookies=1`  
- 윈도우 PW/잠금: `net accounts ... /uniquepw:24 /lockoutthreshold:5 /lockoutduration:15 /lockoutwindow:15`  
- 감사: 4624/4625/4688/4719/1102, PS(4103/4104), cmdline 로깅 레지스트리  
- 웹: TLS1.2/1.3, 보안 헤더(HSTS/CSP/XFO/XCTO/RP/PP), 파일 인덱싱 차단  
- 스캔: `nmap -sV -sC`, `httpx`, `nuclei -severity low,medium -etags exploit`  
- 보고: **증거 → 영향 → 권고 → 재현**

---

# 4. **보너스 실습(추가)**

### A) osquery로 비정상 리스닝 포트 식별
```sql
SELECT p.name, l.port, l.address, p.cmdline
FROM listening_ports l JOIN processes p ON l.pid=p.pid
WHERE l.address != '127.0.0.1' AND l.port NOT IN (22,80,443,5432,3306);
```

### B) Ansible 한 번에 배포(리눅스 하드닝 요약)
```yaml
- hosts: all
  become: true
  tasks:
    - lineinfile: { path: /etc/login.defs, regexp: '^PASS_MAX_DAYS', line: 'PASS_MAX_DAYS 90' }
    - copy:
        dest: /etc/security/pwquality.conf
        content: |
          minlen = 12
          dcredit = -1
          ucredit = -1
          lcredit = -1
          ocredit = -1
          maxrepeat = 3
    - copy:
        dest: /etc/ssh/sshd_config
        content: |
          Protocol 2
          PermitRootLogin no
          PasswordAuthentication no
          PubkeyAuthentication yes
      notify: [Reload sshd]
  handlers:
    - name: Reload sshd
      service: { name: sshd, state: reloaded }
```

---

# 5. **자주 틀리는 포인트 (오답노트)**

- `faillock` 적용 후 PAM 스택 위치 오류 → **잠금 동작 X**  
- 윈도우 로깅: 이벤트 채널은 켰지만 **명령줄/PS 로깅 레지스트리 누락**  
- Nginx 헤더: `always` 빠져 HSTS가 30x 응답에서 누락  
- 취약점 스캔: 고위험 템플릿 포함해 **익스플로잇 전송**(운영 금지)  
- 보고서: 증거 스크린샷 없이 **개념만** 기술 → 감점

---

# 6. **미니 모의고사 (핵심 10문 60분)**

1) (서술) 리눅스에서 **암호 정책(길이/복잡성)과 잠금**을 각각 어떤 파일/방법으로 구현하는가? 설정 키를 적으시오.  
2) (실습) `sshd_config`로 root 금지/키인증 전용/허용 사용자 제한 구성 후 재기동 명령까지 적으시오.  
3) (서술) `/tmp noexec`가 막는 공격 유형과 부작용(필요 시 예외) 2가지를 쓰시오.  
4) (실습) 윈도우 로컬에서 **비밀번호/잠금**과 **고급 감사 + 명령줄/PS 로깅** 명령을 쓰시오.  
5) (해석) `openssl -tls1` 결과 `handshake failure`의 의미를 기술하시오.  
6) (실습) 보안 헤더 5종(HSTS/CSP/XFO/XCTO/RP) Nginx 설정 스니펫을 쓰시오.  
7) (실습) `nmap -sV -sC`와 `nuclei -severity low,medium -etags exploit` 목적 차이를 설명하고 안전상 이점 2가지를 쓰시오.  
8) (실습) Event ID 4104/4688/1102 각각의 의미를 서술하고, 지난 24시간 검색 PowerShell 스니펫을 쓰시오.  
9) (실습) auditd로 `/etc/shadow` 변경 감시 규칙과 검증 명령 1개씩 쓰시오.  
10) (서술) 보고서의 **증거/영향/권고/재현** 4요소가 왜 중요한지 한 줄씩 요약하시오.

**모범 키(요지)**: 본문 각 세트의 정답 예 참고.

---

## 7. 답안 양식 템플릿(제출형)

```markdown
# [과제명] 답안

## 1) 변경 전/후 설정
- 파일: /etc/ssh/sshd_config
- 변경 전: (캡처/생략 가능)
- 변경 후: (코드 블록 첨부)

## 2) 검증 결과
- 명령/이벤트 캡처: (스크린샷/로그)

## 3) 리스크/영향
- (한 줄 요약)

## 4) 권고/운영 주의
- (롤백 경로, 성능/부작용 등)
```

---

# 마무리 요약

- 실기는 **현장형 문서화 역량**이 핵심입니다.  
- “**정책을 구현 → 증거로 검증 → 안전한 권고와 재현**”의 3단 구성을 모든 문제에 적용하세요.  
- 본 문서의 **세트형 문제**로 손을 익힌 뒤, 자신만의 **명령/설정/스크린샷 라이브러리**를 만들어두면 고득점에 유리합니다.
