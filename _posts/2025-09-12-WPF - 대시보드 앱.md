---
layout: post
title: WPF - ëŒ€ì‹œë³´ë“œ ì•±
date: 2025-09-12 18:25:23 +0900
category: WPF
---
# ğŸ“Š WPF **ëŒ€ì‹œë³´ë“œ ì•±** (MVVM + OxyPlot) ì™„ì „ ê°€ì´ë“œ
*(í”„ë¡œì íŠ¸ êµ¬ì¡° â†’ NuGet/ì„¤ì • â†’ ê¸°ë³¸ ì°¨íŠ¸(Line/Bar/Pie) â†’ ë¼ì´ë¸Œ ì—…ë°ì´íŠ¸(ì‹¤ì‹œê°„) â†’ ë³µìˆ˜ ì¶•/í˜¼í•© ì‹œë¦¬ì¦ˆ â†’ íˆ´íŒ/ì¤Œ/íŒ¬/ì„ íƒ â†’ ì£¼ì„/ì•ŒëŒ â†’ ë°ì´í„° ì†ŒìŠ¤(íŒŒì¼/REST) â†’ ì„±ëŠ¥ ìµœì í™” â†’ ë‹¤í¬ í…Œë§ˆ â†’ ë‚´ë³´ë‚´ê¸°(PNG/PDF/SVG) â†’ í…ŒìŠ¤íŠ¸/ë°°í¬ê¹Œì§€ â€œëˆ„ë½ ì—†ì´â€)*

> ëŒ€ìƒ: **.NET 6~8 WPF**.
> ì°¨íŠ¸ ì—”ì§„: **OxyPlot** (`OxyPlot.Core`, `OxyPlot.Wpf`).
> íŒ¨í„´: **MVVM** (CommunityToolkit.Mvvm).
> ê¸€ ëê¹Œì§€ ë”°ë¼ í•˜ë©´ â€œí”„ë¡œê¸‰â€ ëŒ€ì‹œë³´ë“œê°€ ì™„ì„±ë©ë‹ˆë‹¤.

---

## 0. ì™„ì„± í™”ë©´ ê°œìš”

- ì¢Œì¸¡ ìƒë‹¨: **KPI ì¹´ë“œ**(ì˜¤ëŠ˜ ë§¤ì¶œ, ì „ì¼ ëŒ€ë¹„ %, ì£¼ë¬¸ ìˆ˜, ì˜¤ë¥˜ ìˆ˜)
- ì¤‘ì•™: **ì‹œê°„ ì‹œê³„ì—´(Line/Area)** â€” ë‹¹ì¼/ì „ì¼ ë§¤ì¶œ ë¹„êµ, ë§ˆìš°ìŠ¤ íŠ¸ë˜ì»¤(íˆ´íŒ)
- ìš°ì¸¡: **ë²”ì£¼ ë³„ ë§¤ì¶œ(Bar)** + **ì œí’ˆ Top N(Pie/Donut)**
- í•˜ë‹¨: **ì‹¤ì‹œê°„ ì§€í‘œ**(CPU/ìš”ì²­/sec) â€” 1ì´ˆ ê°„ê²© ì—…ë°ì´íŠ¸, ìŠ¤í¬ë¡¤ ì—†ëŠ” ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜
- ì¸í„°ë™ì…˜: ë²”ë¡€ í† ê¸€, ì¤Œ/íŒ¬, í´ë¦­ ì‹œ ìƒì„¸ ì˜ì—­ ë“œë¦´ë‹¤ìš´(Annotation)

---

## 1. ìƒˆ í”„ë¡œì íŠ¸ & íŒ¨í‚¤ì§€

```bash
dotnet new wpf -n Dashboard.App
cd Dashboard.App
dotnet add package CommunityToolkit.Mvvm
dotnet add package OxyPlot.Core
dotnet add package OxyPlot.Wpf
dotnet add package Microsoft.Extensions.Hosting
dotnet add package Microsoft.Extensions.DependencyInjection
```

`csproj` ê¸°ë³¸:
```xml
<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net8.0-windows</TargetFramework>
    <UseWPF>true</UseWPF>
  </PropertyGroup>
</Project>
```

---

## 2. ì†”ë£¨ì…˜ êµ¬ì¡°(ê°„ë‹¨)

```
Dashboard.App/
  Views/ MainWindow.xaml
  ViewModels/ MainViewModel.cs, CardsViewModel.cs, SalesChartViewModel.cs ...
  Models/ Kpi.cs, SalesPoint.cs, CategorySales.cs ...
  Services/ IDataService.cs, MockDataService.cs, LiveTicker.cs
  Themes/ Colors.xaml, OxyTheme.cs
  Utils/ Debounce.cs, ObservableRangeCollection.cs
  App.xaml, App.xaml.cs
```

---

## 3. ëª¨ë¸ & ê°€ì§œ ë°ì´í„° ì„œë¹„ìŠ¤

### 3.1 ëª¨ë¸
```csharp
// Models/Kpi.cs
public sealed record Kpi(string Name, double Value, string Unit, double DeltaPercent);

// Models/SalesPoint.cs
public sealed record SalesPoint(DateTime Time, double Amount);

// Models/CategorySales.cs
public sealed record CategorySales(string Category, double Amount);

// Models/ProductShare.cs
public sealed record ProductShare(string Product, double Share);
```

### 3.2 ë°ì´í„° ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤
```csharp
// Services/IDataService.cs
public interface IDataService
{
    Task<IReadOnlyList<Kpi>> GetKpisAsync(DateTime date, CancellationToken ct = default);
    Task<IReadOnlyList<SalesPoint>> GetSalesSeriesAsync(DateTime date, CancellationToken ct = default);
    Task<IReadOnlyList<CategorySales>> GetCategorySalesAsync(DateTime date, CancellationToken ct = default);
    Task<IReadOnlyList<ProductShare>> GetTopProductsAsync(DateTime date, int topN, CancellationToken ct = default);

    // ì‹¤ì‹œê°„: ì´ˆë‹¹ ìš”ì²­ ìˆ˜ ê°™ì€ ë©”íŠ¸ë¦­
    IAsyncEnumerable<(DateTime t, double value)> SubscribeRealtimeAsync(string metric, CancellationToken ct = default);
}
```

### 3.3 ëª©(Mock) ì„œë¹„ìŠ¤
```csharp
// Services/MockDataService.cs
public sealed class MockDataService : IDataService
{
    private static readonly string[] Cats = ["Food", "Electronics", "Books", "Clothes", "Beauty", "Sports"];
    private static readonly string[] Products = Enumerable.Range(1, 12).Select(i => $"P{i:00}").ToArray();
    private readonly Random _rand = new(1234);

    public Task<IReadOnlyList<Kpi>> GetKpisAsync(DateTime date, CancellationToken ct = default)
    {
        var kpis = new[]
        {
            new Kpi("ë§¤ì¶œ", Next(80_000, 120_000), "â‚©", Next(-5, 12)),
            new Kpi("ì£¼ë¬¸", Next(900, 1500), "ê±´", Next(-8, 10)),
            new Kpi("ê³ ê°", Next(600, 1000), "ëª…", Next(-6, 9)),
            new Kpi("í™˜ë¶ˆ", Next(10, 40), "ê±´", Next(-3, 6))
        };
        return Task.FromResult<IReadOnlyList<Kpi>>(kpis);
    }

    public Task<IReadOnlyList<SalesPoint>> GetSalesSeriesAsync(DateTime date, CancellationToken ct = default)
    {
        var open = date.Date; // 00:00
        var list = new List<SalesPoint>(24);
        double baseVal = Next(1500, 4000);
        for (int h = 0; h < 24; h++)
        {
            var noise = Math.Sin(h * Math.PI / 12) * 1500 + _rand.Next(-300, 300);
            list.Add(new SalesPoint(open.AddHours(h), Math.Max(0, baseVal + noise)));
        }
        return Task.FromResult<IReadOnlyList<SalesPoint>>(list);
    }

    public Task<IReadOnlyList<CategorySales>> GetCategorySalesAsync(DateTime date, CancellationToken ct = default)
    {
        var list = Cats.Select(c => new CategorySales(c, Next(5000, 25000))).ToList();
        return Task.FromResult<IReadOnlyList<CategorySales>>(list);
    }

    public Task<IReadOnlyList<ProductShare>> GetTopProductsAsync(DateTime date, int topN, CancellationToken ct = default)
    {
        var samples = Products.Select(p => new ProductShare(p, Next(1, 10))).OrderByDescending(x => x.Share).Take(topN).ToList();
        var total = samples.Sum(x => x.Share);
        return Task.FromResult<IReadOnlyList<ProductShare>>(samples.Select(x => x with { Share = x.Share / total }).ToList());
    }

    public async IAsyncEnumerable<(DateTime t, double value)> SubscribeRealtimeAsync(string metric, [System.Runtime.CompilerServices.EnumeratorCancellation] CancellationToken ct = default)
    {
        double val = 100;
        while (!ct.IsCancellationRequested)
        {
            await Task.Delay(1000, ct);
            val = Math.Clamp(val + _rand.NextDouble() * 20 - 10, 30, 200);
            yield return (DateTime.Now, val);
        }
    }

    private double Next(int a, int b) => _rand.Next(a, b);
}
```

---

## 4. MVVM ë¼ˆëŒ€

### 4.1 App ë¶€íŠ¸ìŠ¤íŠ¸ë©
```csharp
// App.xaml.cs
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

public partial class App : Application
{
    public static IHost HostApp { get; } = Host.CreateDefaultBuilder()
        .ConfigureServices(s =>
        {
            s.AddSingleton<IDataService, MockDataService>();
            s.AddSingleton<MainViewModel>();
        })
        .Build();

    protected override async void OnStartup(StartupEventArgs e)
    {
        await HostApp.StartAsync();
        var vm = HostApp.Services.GetRequiredService<MainViewModel>();
        new MainWindow { DataContext = vm }.Show();
        base.OnStartup(e);
    }

    protected override async void OnExit(ExitEventArgs e)
    {
        await HostApp.StopAsync();
        HostApp.Dispose();
        base.OnExit(e);
    }
}
```

### 4.2 ê³µìš© ì»¬ë ‰ì…˜
```csharp
// Utils/ObservableRangeCollection.cs
public class ObservableRangeCollection<T> : ObservableCollection<T>
{
    public void ReplaceRange(IEnumerable<T> items)
    {
        this.Items.Clear();
        foreach (var it in items) this.Items.Add(it);
        this.OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));
    }
}
```

---

## 5. ë·°ëª¨ë¸: KPI + ì°¨íŠ¸(ì‹œê³„ì—´/ë§‰ëŒ€/íŒŒì´) + ì‹¤ì‹œê°„

> OxyPlotì€ MVVMì— ì˜ ë§ìŠµë‹ˆë‹¤. í•µì‹¬: **`PlotModel`ì„ ViewModelì—ì„œ ì¡°ë¦½**í•˜ê³  XAMLì—ì„œ `PlotView.Model`ì— ë°”ì¸ë”©.

```csharp
// ViewModels/MainViewModel.cs
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using OxyPlot;
using OxyPlot.Axes;
using OxyPlot.Series;

public partial class MainViewModel : ObservableObject
{
    private readonly IDataService _data;
    private readonly CancellationTokenSource _cts = new();

    // KPI
    public ObservableRangeCollection<Kpi> Kpis { get; } = new();

    // PlotModels
    [ObservableProperty] private PlotModel? salesModel;      // ì‹œê³„ì—´
    [ObservableProperty] private PlotModel? categoryModel;   // ë§‰ëŒ€
    [ObservableProperty] private PlotModel? productModel;    // íŒŒì´/ë„ë„›
    [ObservableProperty] private PlotModel? realtimeModel;   // ì‹¤ì‹œê°„

    public DateTime SelectedDate { get; set; } = DateTime.Today;

    public MainViewModel(IDataService data) => _data = data;

    [RelayCommand]
    public async Task LoadAsync()
    {
        await LoadKpisAsync();
        await BuildSalesChartAsync();
        await BuildCategoryChartAsync();
        await BuildProductChartAsync();
        await BuildRealtimeChartAsync(); // êµ¬ë… ì‹œì‘
    }

    private async Task LoadKpisAsync()
    {
        var k = await _data.GetKpisAsync(SelectedDate);
        Kpis.ReplaceRange(k);
    }

    // 5.1 ì‹œê³„ì—´: ì˜¤ëŠ˜ vs ì „ì¼, íŠ¸ë˜ì»¤ + ì˜ì—­ ì±„ìš°ê¸°
    private async Task BuildSalesChartAsync()
    {
        var today = await _data.GetSalesSeriesAsync(SelectedDate);
        var yesterday = await _data.GetSalesSeriesAsync(SelectedDate.AddDays(-1));

        var pm = new PlotModel { Title = "ì‹œê°„ëŒ€ë³„ ë§¤ì¶œ (ì˜¤ëŠ˜ vs ì „ì¼)" };
        pm.Axes.Add(new DateTimeAxis
        {
            Position = AxisPosition.Bottom,
            StringFormat = "HH:mm",
            IntervalType = DateTimeIntervalType.Hours,
            MinorIntervalType = DateTimeIntervalType.Minutes,
            Title = "ì‹œê°"
        });
        pm.Axes.Add(new LinearAxis
        {
            Position = AxisPosition.Left,
            Title = "â‚©",
            StringFormat = "#,0"
        });

        // ì „ì¼: ì ì„ 
        var s1 = new AreaSeries
        {
            Title = "ì „ì¼",
            Color = OxyColors.SkyBlue.ChangeAlpha(120),
            StrokeThickness = 2,
            LineStyle = LineStyle.Dot
        };
        foreach (var p in yesterday)
            s1.Points.Add(DateTimeAxis.CreateDataPoint(p.Time, p.Amount));

        // ì˜¤ëŠ˜: ì‹¤ì„ 
        var s2 = new AreaSeries
        {
            Title = "ì˜¤ëŠ˜",
            Color = OxyColor.FromRgb(37, 99, 235).ChangeAlpha(100),
            StrokeThickness = 2
        };
        foreach (var p in today)
            s2.Points.Add(DateTimeAxis.CreateDataPoint(p.Time, p.Amount));

        // íŠ¸ë˜ì»¤(íˆ´íŒ)
        s2.TrackerFormatString = "ì‹œê°„: {2:HH:mm}\në§¤ì¶œ: {4:#,0} â‚©";
        s1.TrackerFormatString = "ì‹œê°„: {2:HH:mm}\në§¤ì¶œ: {4:#,0} â‚©";

        pm.Series.Add(s1);
        pm.Series.Add(s2);
        pm.IsLegendVisible = true;
        SalesModel = pm;
    }

    // 5.2 ë²”ì£¼ ë§‰ëŒ€: ë°ì´í„° ë ˆì´ë¸”
    private async Task BuildCategoryChartAsync()
    {
        var cats = await _data.GetCategorySalesAsync(SelectedDate);
        var pm = new PlotModel { Title = "ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ" };

        var catAxis = new CategoryAxis { Position = AxisPosition.Left }; // ê°€ë¡œí˜• ë°”
        catAxis.Labels.AddRange(cats.Select(c => c.Category));
        pm.Axes.Add(catAxis);

        var valAxis = new LinearAxis
        {
            Position = AxisPosition.Bottom,
            StringFormat = "#,0",
            Title = "â‚©"
        };
        pm.Axes.Add(valAxis);

        var bar = new BarSeries
        {
            LabelPlacement = LabelPlacement.Outside,
            LabelFormatString = "{0:#,0}"
        };
        foreach (var c in cats)
            bar.Items.Add(new BarItem(c.Amount));

        pm.Series.Add(bar);
        CategoryModel = pm;
    }

    // 5.3 íŒŒì´/ë„ë„›: Top-N
    private async Task BuildProductChartAsync()
    {
        var top = await _data.GetTopProductsAsync(SelectedDate, 6);
        var pm = new PlotModel { Title = "Top ì œí’ˆ ì ìœ ìœ¨" };
        var pie = new OxyPlot.Series.PieSeries
        {
            StrokeThickness = 0.5,
            AngleSpan = 360,
            StartAngle = 0,
            InsideLabelPosition = 0.7, // ë„ë„› íš¨ê³¼
            InnerDiameter = 0.4
        };
        foreach (var p in top)
            pie.Slices.Add(new OxyPlot.Series.PieSlice(p.Product, p.Share) { Label = $"{p.Product} ({p.Share:P0})" });

        pm.Series.Add(pie);
        ProductModel = pm;
    }

    // 5.4 ì‹¤ì‹œê°„: 1ì´ˆ ê°„ê²©, ìµœëŒ€ í¬ì¸íŠ¸ ì œí•œ + ìŠ¤í¬ë¡¤
    private async Task BuildRealtimeChartAsync()
    {
        var pm = new PlotModel { Title = "ìš”ì²­/ì´ˆ (ì‹¤ì‹œê°„)" };
        var x = new DateTimeAxis { Position = AxisPosition.Bottom, StringFormat = "HH:mm:ss" };
        var y = new LinearAxis { Position = AxisPosition.Left, Title = "RPS" };
        pm.Axes.Add(x); pm.Axes.Add(y);

        var line = new LineSeries { Title = "RPS", StrokeThickness = 2 };
        pm.Series.Add(line);

        RealtimeModel = pm;

        _ = Task.Run(async () =>
        {
            const int MaxPoints = 120; // 2ë¶„
            await foreach (var (t, v) in _data.SubscribeRealtimeAsync("rps", _cts.Token))
            {
                // OxyPlotì€ UI ìŠ¤ë ˆë“œ ìƒí˜¸ì‘ìš©ì´ ì•ˆì „. VMì—ì„œ ë™ê¸°í™” í•„ìš” ì‹œ Dispatcher ì‚¬ìš©.
                Application.Current.Dispatcher.Invoke(() =>
                {
                    line.Points.Add(DateTimeAxis.CreateDataPoint(t, v));
                    if (line.Points.Count > MaxPoints) line.Points.RemoveAt(0);

                    // Xì¶• ì‹œì•¼ë¥¼ ìµœê·¼ìœ¼ë¡œ
                    if (RealtimeModel is { } m && m.Axes[0] is DateTimeAxis dx)
                    {
                        var max = DateTimeAxis.ToDouble(t);
                        dx.Zoom(max - 0.02, max); // ìµœê·¼ ìˆ˜ ì´ˆ ë²”ìœ„
                    }
                    RealtimeModel?.InvalidatePlot(true);
                });
            }
        });
    }
}
```

---

## 6. View (XAML): ê·¸ë¦¬ë“œ ë°°ì¹˜ + PlotView ë°”ì¸ë”©

`MainWindow.xaml`
```xml
<Window x:Class="Dashboard.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:oxy="http://oxyplot.org/wpf"
        Title="Dashboard" Width="1200" Height="800"
        Loaded="{Binding LoadCommand}">
    <Grid Margin="12" >
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="1.2*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- KPI ì¹´ë“œ ì˜ì—­ -->
        <ItemsControl Grid.Row="0" Grid.ColumnSpan="2" ItemsSource="{Binding Kpis}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Rows="1"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate DataType="{x:Type m:Kpi}">
                    <Border Margin="6" Padding="12" Background="#0F172A" CornerRadius="10">
                        <StackPanel>
                            <TextBlock Text="{Binding Name}" Foreground="#A3A3A3"/>
                            <TextBlock Text="{Binding Value, StringFormat={}{0:#,0}}" FontSize="28" FontWeight="SemiBold" Foreground="White"/>
                            <TextBlock Text="{Binding DeltaPercent, StringFormat={}{0:+0.0%;-0.0%}}" Foreground="#60D38B"/>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- ì‹œê°„ ì‹œê³„ì—´ -->
        <oxy:PlotView Grid.Row="1" Grid.Column="0" Margin="6"
                      Model="{Binding SalesModel}" />

        <!-- ë§‰ëŒ€ + íŒŒì´ ìŠ¤íƒ -->
        <Grid Grid.Row="1" Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <oxy:PlotView Grid.Row="0" Margin="6" Model="{Binding CategoryModel}" />
            <oxy:PlotView Grid.Row="1" Margin="6" Model="{Binding ProductModel}" />
        </Grid>

        <!-- ì‹¤ì‹œê°„ -->
        <oxy:PlotView Grid.Row="2" Grid.ColumnSpan="2" Margin="6"
                      Model="{Binding RealtimeModel}" />
    </Grid>
</Window>
```

> `oxy:PlotView` ë°”ì¸ë”©ì€ **`PlotModel`** ì°¸ì¡°ë§Œ ìˆìœ¼ë©´ MVVMìœ¼ë¡œ ê¹”ë”í•©ë‹ˆë‹¤.
> í…Œë§ˆ/ìƒ‰ìƒ/í°íŠ¸ëŠ” PlotModel/Series/Axesì—ì„œ ì œì–´í•˜ê±°ë‚˜ ì „ì²´ í…Œë§ˆ í´ë˜ìŠ¤ë¡œ ì¼ê´„ ì ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤(ì•„ë˜ Â§10).

---

## 7. ê³ ê¸‰ ì£¼ì œ â‘  â€” **ìƒí˜¸ì‘ìš©/íŠ¸ë˜ì»¤/ì¤Œ/íŒ¬/ë²”ë¡€/ì„ íƒ/ë“œë¦´ë‹¤ìš´**

### 7.1 íŠ¸ë˜ì»¤(íˆ´íŒ) ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ
```csharp
lineSeries.TrackerFormatString = "ì‹œê°: {2:HH:mm}\nê°’: {4:0.##}";
```

### 7.2 ì¤Œ/íŒ¬ ë™ì‘
- ë§ˆìš°ìŠ¤ íœ : ì¤Œ
- ë§ˆìš°ìŠ¤ ë“œë˜ê·¸: íŒ¬
- Shift + ë“œë˜ê·¸: ì‚¬ê°í˜• ì¤Œ
- ë”ë¸”í´ë¦­: ë¦¬ì…‹(ê¸°ë³¸ ë™ì‘)
- ì¶•ë³„ ë§ˆìš°ìŠ¤ ì œìŠ¤ì²˜ëŠ” ì¶• ì†ì„±ìœ¼ë¡œ ì„¸ë°€ ì¡°ì • ê°€ëŠ¥(`IsZoomEnabled`, `IsPanEnabled`)

### 7.3 ë²”ë¡€ í† ê¸€
```csharp
plotModel.IsLegendVisible = true;
plotModel.LegendPlacement = LegendPlacement.Outside;
plotModel.LegendPosition = LegendPosition.RightTop;
```
ì‚¬ìš©ì ì •ì˜ â€œì‹œë¦¬ì¦ˆ ON/OFFâ€ ë²„íŠ¼ì„ Viewì— ë‘ê³  ì‹œë¦¬ì¦ˆì˜ `IsVisible`ì„ í† ê¸€ í›„ `InvalidatePlot(true)` í˜¸ì¶œ.

### 7.4 ë°ì´í„° í¬ì¸íŠ¸ í´ë¦­ â†’ ì£¼ì„ í‘œì‹œ(ë“œë¦´ë‹¤ìš´)
```csharp
pm.MouseDown += (s, e) =>
{
    var series = pm.Series.OfType<LineSeries>().FirstOrDefault();
    if (series is null) return;
    var hit = series.GetNearestPoint(e.Position, false);
    if (hit != null)
    {
        pm.Annotations.Clear();
        pm.Annotations.Add(new LineAnnotation
        {
            Type = LineAnnotationType.Vertical,
            X = hit.DataPoint.X,
            Color = OxyColors.OrangeRed,
            Text = DateTimeAxis.ToDateTime(hit.DataPoint.X).ToString("HH:mm")
        });
        pm.InvalidatePlot(false);
        e.Handled = true;
    }
};
```

---

## 8. ê³ ê¸‰ ì£¼ì œ â‘¡ â€” **ë³µìˆ˜ ì¶•/í˜¼í•© ì‹œë¦¬ì¦ˆ/ë³´ì¡° Yì¶•**

ì˜ˆ: ë§¤ì¶œ(â‚©) + ì£¼ë¬¸ìˆ˜(ê±´)ë¥¼ í•˜ë‚˜ì˜ ì°¨íŠ¸ì— í‘œí˜„ (ì„œë¡œ ë‹¨ìœ„ê°€ ë‹¤ë¦„ â†’ ë³´ì¡°ì¶• ì´ìš©)

```csharp
var pm = new PlotModel { Title = "ë§¤ì¶œ & ì£¼ë¬¸ìˆ˜(ë³´ì¡°ì¶•)" };
var x = new DateTimeAxis { Position = AxisPosition.Bottom, StringFormat = "HH:mm" };
var yLeft = new LinearAxis { Position = AxisPosition.Left, Title = "â‚©", Key = "LeftY" };
var yRight = new LinearAxis { Position = AxisPosition.Right, Title = "ê±´ìˆ˜", Key = "RightY" };
pm.Axes.Add(x); pm.Axes.Add(yLeft); pm.Axes.Add(yRight);

var sales = new LineSeries { Title = "ë§¤ì¶œ", YAxisKey = "LeftY", Color = OxyColors.SteelBlue };
var orders = new ColumnSeries { Title = "ì£¼ë¬¸", YAxisKey = "RightY", FillColor = OxyColors.Orange.ChangeAlpha(160) };

// ë°ì´í„° ì±„ì›€
// sales.Points.Add(DateTimeAxis.CreateDataPoint(...));
// orders.Items.Add(new ColumnItem(value, categoryIndex));
pm.Series.Add(sales);
pm.Series.Add(orders);
```

> ë§‰ëŒ€/ì„  í˜¼í•© ì‹œ **`ColumnSeries`ëŠ” ì¹´í…Œê³ ë¦¬ ì¶•**ì´ ê¸°ë³¸ì¸ë°, ì‹œê°„ì¶•ê³¼ í˜¼ìš©í•˜ë ¤ë©´ `LinearBarSeries`/`StemSeries` ë“±ì„ ê³ ë ¤í•˜ê±°ë‚˜, ì£¼ë¬¸ì„ `LineSeries`ë¡œ ë³€í™˜í•˜ì—¬ ê²¹ì¹˜ëŠ” ë°©ì‹ì„ íƒí•©ë‹ˆë‹¤(ê°„ë‹¨/ê°€ë…ì„± â†‘).

---

## 9. ë°ì´í„° ì†ŒìŠ¤ ì—°ë™(íŒŒì¼/REST) + **ë¹„ë™ê¸°Â·ë°°ì¹˜ ì—…ë°ì´íŠ¸**

### 9.1 CSV/JSON íŒŒì¼ ë¡œë”©
```csharp
var lines = await File.ReadAllLinesAsync(path, ct);
var points = lines.Skip(1)
                  .Select(l => l.Split(','))
                  .Select(a => new SalesPoint(DateTime.Parse(a[0]), double.Parse(a[1])))
                  .ToList();
```

### 9.2 REST API
```csharp
using var http = new HttpClient();
var json = await http.GetStringAsync("https://api.example.com/sales?date=2025-10-25", ct);
var series = JsonSerializer.Deserialize<List<SalesPoint>>(json, new JsonSerializerOptions{ PropertyNamingPolicy = JsonNamingPolicy.CamelCase });
```

> I/OëŠ” **ìˆœìˆ˜ ë¹„ë™ê¸°**ë¡œ, **ì‹œë¦¬ì¦ˆ ì±„ìš°ê¸°/`InvalidatePlot`** ëŠ” **UI ìŠ¤ë ˆë“œì—ì„œ í•œ ë²ˆì—**.
> í•­ëª©ë³„ `BeginInvoke` ë‚¨ë°œ ê¸ˆì§€ â†’ `Task.WhenAll()`ë¡œ ë°ì´í„°ë¥¼ ëª¨ì•„ **ë°°ì¹˜ ë°˜ì˜**í•˜ì„¸ìš”.

---

## 10. í…Œë§ˆ/ìƒ‰ìƒ â€” **ë‹¤í¬ ëª¨ë“œ** & ì»¬ëŸ¬ íŒ”ë ˆíŠ¸

### 10.1 ë‹¤í¬ í…Œë§ˆ ìœ í‹¸
```csharp
public static class OxyTheme
{
    public static void ApplyDark(PlotModel m)
    {
        m.TextColor = OxyColors.White;
        m.PlotAreaBorderColor = OxyColor.FromRgb(55,55,55);
        m.LegendTextColor = OxyColors.White;
        m.LegendBackground = OxyColor.FromAColor(220, OxyColors.Black);
        foreach (var axis in m.Axes)
        {
            axis.AxislineColor = OxyColors.Gray;
            axis.MajorGridlineColor = OxyColor.FromRgb(45,45,45);
            axis.MinorGridlineColor = OxyColor.FromRgb(35,35,35);
            axis.TitleColor = OxyColors.White;
            axis.TextColor = OxyColors.White;
        }
    }
}
```

ì‚¬ìš©:
```csharp
var pm = new PlotModel { Title = "..." };
OxyTheme.ApplyDark(pm);
```

### 10.2 íŒ”ë ˆíŠ¸
```csharp
var palette = OxyPalettes.Hot(20); // ë‚´ì¥ íŒ”ë ˆíŠ¸(Heatmap ë“±)
```

---

## 11. ë‚´ë³´ë‚´ê¸°(Export): PNG/PDF/SVG

```csharp
// PNG
using OxyPlot.ImageSharp;
await using var s = File.Create("chart.png");
PngExporter.Export(SalesModel, s, 1200, 600, OxyColors.Transparent);

// PDF
using OxyPlot.SkiaSharp;
await using var sp = File.Create("chart.pdf");
var pdf = new PdfExporter { Width = 1200, Height = 600 };
pdf.Export(SalesModel, sp);

// SVG
await using var ss = File.Create("chart.svg");
var svg = new SvgExporter { Width = 1200, Height = 600, IsDocument = true };
svg.Export(SalesModel, ss);
```

> **íŒ**: ë¦¬í¬íŠ¸/ë©”ì¼ ìë™ ìƒì„±ì— ìœ ìš©. Export ì „ **ë°°ê²½/í°íŠ¸**ë¥¼ ë¬¸ì„œìš©ìœ¼ë¡œ ì‚´ì§ ì¡°ì •.

---

## 12. ì„±ëŠ¥ ìµœì í™”

1) **í¬ì¸íŠ¸ ì œí•œ**
   - ì‹¤ì‹œê°„: `MaximumPoints` ìœ ì‚¬ ì²˜ë¦¬(ì§ì ‘ `RemoveAt(0)`), ìµœê·¼ Nê°œë§Œ ìœ ì§€
   - ëŒ€ìš©ëŸ‰ ì‹œ `Decimator` íŒ¨í„´(ê°„ê²©ë§ˆë‹¤ ìµœëŒ€/ìµœì†Œë§Œ í‘œì‹œ) ì ìš©
2) **InvalidatePlot ë¹ˆë„** ìµœì†Œí™”
   - ì—¬ëŸ¬ ì‹œë¦¬ì¦ˆ ì—…ë°ì´íŠ¸ í›„ **í•œ ë²ˆë§Œ í˜¸ì¶œ**
3) **íˆ´íŒ/íŠ¸ë˜ì»¤** ê³„ì‚° ë¹„ìš©
   - ë§¤ìš° ë§ì€ í¬ì¸íŠ¸ì—ì„œëŠ” íŠ¸ë˜ì»¤ êº¼ë‘ê±°ë‚˜ ë‹¨ìˆœ í˜•ì‹
4) **ì¶• ìë™ ìŠ¤ì¼€ì¼** â†’ í•„ìš” ì‹œ ëª…ì‹œì  ë²”ìœ„/ì¤Œìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ë°©ì§€
5) **íˆíŠ¸í…ŒìŠ¤íŠ¸**
   - ì„ íƒ ê¸°ëŠ¥ì´ ê³¼í•˜ë©´ ë¹„ìš© â†‘. í•„ìš”í•œ ì‹œë¦¬ì¦ˆì—ë§Œ ì¼œê¸°
6) **UI ê°€ìƒí™”**
   - ì°¨íŠ¸ ì™¸ ë¦¬ìŠ¤íŠ¸/í…Œì´ë¸”ì€ `VirtualizingStackPanel` í•„ìˆ˜
7) **ì´ë¯¸ì§€/ë¸ŒëŸ¬ì‹œ**ëŠ” Freezable `Freeze()` (WPF ë Œë” ìµœì í™”)

ìƒ˜í”Œ(ë°°ì¹˜ ê°±ì‹ ):
```csharp
SalesModel?.SuspendUpdates();
try
{
    // ì—¬ëŸ¬ ì‹œë¦¬ì¦ˆ/í¬ì¸íŠ¸ ê°±ì‹ 
}
finally
{
    SalesModel?.InvalidatePlot(true); // í•œ ë²ˆë§Œ
}
```

---

## 13. QA/í…ŒìŠ¤íŠ¸

- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**:
  - ViewModelì—ì„œ `PlotModel.Series.Count`, `Axes.Count`, `Title`, ì‹œë¦¬ì¦ˆ í¬ì¸íŠ¸ ê°œìˆ˜ ê²€ì¦
  - ì‹¤ì‹œê°„ êµ¬ë…ì€ **ê°€ì§œ IAsyncEnumerable**ë¡œ 3~5ìƒ˜í”Œë§Œ ì£¼ê³  Invalidate í˜¸ì¶œ ì—¬ë¶€ í™•ì¸
- **ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸**: Export â†’ íŒŒì¼ í•´ì‹œ ë¹„êµ(í”½ì…€ í…ŒìŠ¤íŠ¸ëŠ” í™˜ê²½ ì˜í–¥ìœ¼ë¡œ ëŠìŠ¨í•˜ê²Œ)

ì˜ˆ:
```csharp
[Fact]
public async Task SalesModel_Should_Have_TwoSeries()
{
    var vm = new MainViewModel(new MockDataService());
    await vm.LoadAsync();
    vm.SalesModel.Series.Should().HaveCount(2);
    vm.SalesModel.Axes.Should().HaveCount(2);
}
```

---

## 14. ì‚¬ìš©ì ê²½í—˜(UX) í–¥ìƒ í¬ì¸íŠ¸

- íˆ´ë°”: **ë‚ ì§œ ë²”ìœ„ í”„ë¦¬ì…‹(ì˜¤ëŠ˜/7ì¼/30ì¼)**, Export ë²„íŠ¼
- ë²”ë¡€ í´ë¦­ìœ¼ë¡œ **ì‹œë¦¬ì¦ˆ On/Off** (IsVisible í† ê¸€)
- **Annotation**ìœ¼ë¡œ ì„ê³„ì¹˜/ëª©í‘œì¹˜ í‘œì‹œ(LineAnnotation/RectangleAnnotation)
- **Drilldown**: íŠ¹ì • êµ¬ê°„ ë“œë˜ê·¸ í›„ ì»¨í…ìŠ¤íŠ¸ ì°½(ìƒì„¸ ë¦¬ìŠ¤íŠ¸/ë¡œê·¸ ì—°ê²°)
- ìŠ¤í¬ë¡¤ ì¤‘ **`BitmapScalingMode=LowQuality`** â†’ ì •ì§€ ì‹œ High

---

## 15. ë°°í¬/í™˜ê²½

- **Self-contained**(win-x64/arm64)ë¡œ ë°°í¬í•˜ë©´ ëŸ°íƒ€ì„ ì„¤ì¹˜ ì—†ì´ ë™ì‘
- **ReadyToRun**ë¡œ ì²« ì‹¤í–‰ ì„±ëŠ¥ ê°œì„ 
- ClickOnce/MSIXë¡œ ìë™ ì—…ë°ì´íŠ¸ ì±„ë„ ìš´ì˜ ê°€ëŠ¥(ì‚¬ë‚´ë§ ê¶Œì¥)

`csproj` ë°œì·Œ:
```xml
<PropertyGroup>
  <SelfContained>true</SelfContained>
  <RuntimeIdentifier>win-x64</RuntimeIdentifier>
  <PublishSingleFile>true</PublishSingleFile>
  <PublishReadyToRun>true</PublishReadyToRun>
</PropertyGroup>
```

---

## 16. ë¬¸ì œ í•´ê²°(FAQ)

| ì´ìŠˆ | ì›ì¸ | í•´ê²° |
|---|---|---|
| íŠ¸ë˜ì»¤ê°€ ëŠë¦¼ | í¬ì¸íŠ¸ ê³¼ë‹¤ | í¬ì¸íŠ¸ ì œí•œ/ë””ì‹œë©”ì´ì…˜, ë‹¨ìˆœ TrackerFormat |
| ì‹¤ì‹œê°„ì—ì„œ í”„ë ˆì„ ë“œë | Invalidate í˜¸ì¶œ ë‚¨ë°œ | **SuspendUpdates â†’ Invalidate 1íšŒ** |
| ë§‰ëŒ€/ì‹œê°„ì¶• í˜¼í•© ê¹¨ì§ | Series/Axis í˜¸í™˜ | `ColumnSeries` ëŒ€ì‹  `LineSeries/StemSeries` ê³ ë ¤, ì¹´í…Œê³ ë¦¬ì¶• ë¶„ë¦¬ |
| Export í°íŠ¸/ë°°ê²½ ë‹¤ë¦„ | Exporter ê¸°ë³¸ê°’ | Export ì „ ìƒ‰ìƒ/í°íŠ¸ ëª…ì‹œ, ë°°ê²½ íˆ¬ëª…/í°ìƒ‰ ê²°ì • |
| ë‹¤í¬ ëª¨ë“œ ê¸€ì”¨ íë¦¼ | ì¶•/ê²©ì/í…ìŠ¤íŠ¸ ëŒ€ë¹„ ë¶€ì¡± | `TextColor/Axisline/Gridlines` ëª…ì‹œ, íŒ”ë ˆíŠ¸ ì¬ì •ì˜ |

---

## 17. í™•ì¥ ì•„ì´ë””ì–´

- **HeatMapSeries** ë¡œ ì‹œê°„Ã—ì¹´í…Œê³ ë¦¬ ë°€ë„
- **CandleStickSeries** ë¡œ ì‹œì„¸í˜• ëŒ€ì‹œë³´ë“œ
- ì—¬ëŸ¬ íƒ­/ë ˆì´ì•„ì›ƒ í”„ë¦¬ì…‹(ì„¸ê·¸ë¨¼íŠ¸ë³„ KPI)
- **ì•Œë¦¼**: ì„ê³„ê°’ ì´ˆê³¼ ì‹œ í† ìŠ¤íŠ¸/ì´ë©”ì¼
- **ë°ì´í„° ì†ŒìŠ¤**: gRPC/SignalR ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼

---

## ì „ì²´ ìš”ì•½

- **MVVM + OxyPlot**ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ ë•Œ í•µì‹¬ì€:
  1) **PlotModel**ì„ ViewModelì—ì„œ ì¡°ë¦½í•˜ê³ ,
  2) ë°ì´í„°ëŠ” **ë¹„ë™ê¸° ë³‘ë ¬ + ë°°ì¹˜ ë°˜ì˜**,
  3) ì‹¤ì‹œê°„ì€ **í¬ì¸íŠ¸ ì œí•œ + ìë™ ìŠ¤í¬ë¡¤**,
  4) í…Œë§ˆ/UX/ë‚´ë³´ë‚´ê¸°ë¡œ **ìš´ì˜ í’ˆì§ˆ**ì„ ì™„ì„±.
