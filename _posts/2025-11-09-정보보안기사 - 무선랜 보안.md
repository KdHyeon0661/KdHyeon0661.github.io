---
layout: post
title: 정보보안기사 - 무선랜 보안
date: 2025-11-09 23:25:23 +0900
category: 정보보안기사
---
# SECTION 04 네트워크 기본 학습 — 15. 무선랜(Wireless LAN) 보안

## 1. 보안 지형 개요 — 왜 Wi-Fi는 어렵나
- **무선 매체**: 접근 장벽이 낮다(전파 범위 내 누구나 수신).
- **이기종 단말**: 구형(802.11n/레거시)과 신형(6/6E/7)이 공존 → 호환성·하위호환 이슈.
- **프로토콜·암호·관리 프레임**: 802.11i(보안), 802.11w(PMF), 802.11r/k/v(로밍), WPA2/3, 802.1X/EAP 등 **다층**.
- **최근 권고**: 공개망은 **OWE(Enhanced Open)** 로 암호화, 개인망은 **WPA3-SAE**, 기업망은 **WPA3-Enterprise(EAP-TLS 우선)**, 관리 프레임은 **PMF(=MFP)** **필수**. OWE는 RFC 8110로 표준화(무인증 암호화), WPA3는 Wi-Fi Alliance가 도입·의무화(특히 Wi-Fi 7에서는 WPA3 필수)로 정착 중이다.

---

## 2. 위협 모델 — 대표 공격과 대응 포인트(요약)
| 범주 | 대표 공격 | 핵심 원인 | 주 대응(요지) |
|---|---|---|---|
| 암호·인증 | 약한 PSK 추측, 사전대입(패스프레이즈 취약) | 낮은 엔트로피(숫자·짧은 길이) | **WPA3-SAE**, 길이≥16·문자군 혼합, **EAP-TLS** |
| 프로토콜 | KRACK(Key Reinstallation) | 4-Way Handshake 재전송 처리 취약 | 최신 패치, PMF 의무, 재전송 방어 지침 준수  |
| 프로토콜(신규) | Dragonblood(WPA3 초기 구현 취약) | SAE/EAP-pwd 구현 결함 | 펌웨어 업데이트, 세팅 가이드 준수  |
| 관리 프레임 | Deauth/Disassoc 스푸핑 | 비보호 관리 프레임 | **802.11w PMF 필수**(Required) |
| 인프라 | Evil Twin/가짜 AP | SSID 재사용·개방형 | **OWE/802.1X**, WIDS/WIPS, 사용자 교육 |
| 평면 분리 | 내부자 측면 이동 | 같은 SSID/브리지 | **동적 VLAN/롤 기반 ACL**, 멀티-SSID 설계 |
| 운영 | 인증서·RADIUS 부실 | 자체 CA·만료·CRL 미흡 | PKI 수명주기, OCSP/CRL, 자동 발급(SCEP/EST) |

---

## 3. 보안 빌딩 블록 — 표준/모드/암호
### 3.1 암호화·무결성
- **CCMP(AES-128)**: WPA2 기본.
- **GCMP-128/256**: WPA3에서 성능·보안 개선(하드웨어 가속 흔함).
- **PMF(802.11w)**: 관리 프레임 보호. **Required** 권장(Transition/Optional은 공격에 취약).

### 3.2 접속 모드
- **WPA2-Personal(PSK)**: 편리하나 키 공유·탈취 리스크.
- **WPA3-Personal(SAE)**: **암호지식 증명(PAKE)** 기반 핸드셰이크(드래곤플라이). 오프라인 사전대입 저항성↑. 초기 구현 취약은 패치로 해결.
- **WPA2/3-Enterprise(802.1X/EAP)**: RADIUS 연동, **EAP-TLS(인증서 기반) 권장**.
- **OWE(Enhanced Open)**: 공개망에서 **암호화만** 제공(무인증). RFC 8110 규정.

### 3.3 로밍/운영 보조
- **802.11r(FT)**: Fast Transition(키 마이그레이션) — 보안 모드와 정합 필요(FT-SAE/FT-EAP).
- **802.11k/v**: 리소스·네트워크 지원(스티어링).

---

## 4. 수학·메커니즘 한눈에 보기
### 4.1 PSK 엔트로피 직관
- 가능한 문자군 크기 \(N\), 길이 \(L\)일 때 **탐색 공간**은 \(N^L\), **엔트로피**는
  $$ H = \log_2(N^L) = L \cdot \log_2 N \ (\text{bits}). $$
  예: 영문소문자(26)만 10자 → \(H\approx 10\cdot \log_2 26\approx 47.0\) bits (불충분).

### 4.2 WPA2-PSK 파생(요지)
- PMK = PBKDF2-HMAC-SHA1(패스프레이즈, SSID, 4096회, 256bit).
  ⇒ **SSID 의존**(사전대입 시 사전/레인보우 테이블에 영향) — 길고 임의성이 높을수록 유리.

### 4.3 WPA3-SAE(개념)
- 양 당사자가 **동등**(Equals)으로 공유 비밀의 존재를 증명(비공개 패스워드 자체는 노출 X).
- 올바른 구현과 적절한 파라미터 선택 시 **오프라인 추측** 저항성이 강하다(초기 구현 취약 ‘Dragonblood’는 패치·구성으로 완화).

### 4.4 OWE
- AP–단말 간 **비인증 DH 교환**으로 **세션 고유 키** 생성 → 4-Way Handshake로 데이터 키 확정. 공개망에서도 **프라이버시 보호**(스니핑 난이도↑).

---

## 5. 설계 원칙 — SSID·세그먼트·정책
1) **SSID 역할 분리**
   - **CORP**: WPA3-Enterprise(EAP-TLS, PMF=Required, FT-EAP).
   - **BYOD**: WPA3-Enterprise(EAP-TTLS/PEAP→장기적 EAP-TLS 전환), 디바이스 등록 포털.
   - **GUEST**: OWE(Enhanced Open) + 게스트 포털(레이어3 인증), 인터넷 전용 VLAN.
   - **IoT/OT**: PPSK/DPPSK(디바이스별 다른 PSK) 또는 EAP-TLS(가능 시), L3/L4 마이크로세그멘트.
2) **동적 VLAN/롤 기반 정책**(RADIUS 속성) — 동일 SSID에서도 **부서·위험도별** 격리.
3) **PMF=Required 기본값** — 구형 단말 호환 필요 시 **게스트만 Transition**.
4) **로밍**: 음성/실시간 트래픽은 802.11r/k/v 조합으로 끊김 최소화(FT-EAP/FT-SAE와 정합).

---

## 6. 실전 구성(랩) — hostapd + FreeRADIUS + wpa_supplicant
> 아래는 **방어/구성** 목적의 **미니멀 재현** 예시다. 실서비스는 벤더 가이드와 보안 정책에 맞게 확장·하드닝한다.

### 6.1 AP(소프트 AP) — WPA3-SAE + PMF=Required
```ini
# /etc/hostapd/hostapd.conf (WPA3-Personal)
interface=wlan0
driver=nl80211
ssid=LAB-WPA3
hw_mode=a
channel=36
ieee80211n=1
ieee80211ac=1
ieee80211ax=1

wpa=2
wpa_key_mgmt=SAE
rsn_pairwise=CCMP
ieee80211w=2            # PMF Required (0:off, 1:optional, 2:required)
sae_pwe=2               # H2E 우선
sae_groups=19 20 21     # 추천 그룹(플랫폼 가이드 참조)

# SAE 패스프레이즈(랩용) - 운영은 길이>=16, 임의 생성기 사용
wpa_passphrase=UseALongRandomPassphraseHere
```

### 6.2 AP — OWE(Enhanced Open) SSID 추가
```ini
# /etc/hostapd/hostapd_owe.conf (병행 운영)
interface=wlan0
driver=nl80211
ssid=LAB-OWE
hw_mode=a
channel=36

wpa=2
wpa_key_mgmt=OWE
rsn_pairwise=CCMP
ieee80211w=2           # PMF Required with OWE 권장
```
> OWE는 **공개망 프라이버시 보호**를 제공(무인증·암호화). Wi-Fi Enhanced Open의 구현 기반이다.

### 6.3 RADIUS — EAP-TLS(권장)
**FreeRADIUS** 최소 구성(랩):
```conf
# /etc/freeradius/3.0/mods-enabled/eap
eap {
  default_eap_type = tls
  tls-config tls-common {
    private_key_file = /etc/raddb/certs/server.key
    certificate_file = /etc/raddb/certs/server.crt
    ca_file = /etc/raddb/certs/ca.crt
    dh_file = /etc/ssl/certs/dhparam.pem
    require_client_cert = yes
  }
}
```
```conf
# /etc/freeradius/3.0/sites-enabled/default (발췌)
authorize {
  eap
}
authenticate {
  eap
}
post-auth {
  # 동적 VLAN/롤 부여 예
  update reply {
    Tunnel-Type := VLAN
    Tunnel-Medium-Type := IEEE-802
    Tunnel-Private-Group-Id := "120"   # 부서별/위험도별
  }
}
```
> NIST SP 800-153는 **표준화된 보안 구성·모니터링**과 **수명주기 관리**를 권고한다. EAP-TLS는 자격 증명 탈취·재사용 리스크를 크게 줄인다.

### 6.4 컨트롤러/엔터프라이즈 AP 벤더 가이드(참고)
- **WPA3 사용, PMF=Required, 6/6E/7 세대 단말**: 벤더들은 **Wi-Fi 7에서 WPA3 필수** 명시(배포 가이드).

### 6.5 클라이언트 — wpa_supplicant(EAP-TLS, FT-EAP)
```ini
# /etc/wpa_supplicant/wpa_supplicant.conf
ctrl_interface=/run/wpa_supplicant
ap_scan=1

network={
  ssid="CORP-8021X"
  key_mgmt=FT-EAP WPA-EAP     # FT(11r) + EAP
  pairwise=CCMP
  proto=RSN
  ieee80211w=2                # PMF Required
  eap=TLS
  identity="alice@corp.example"
  ca_cert="/etc/ssl/certs/ca.crt"
  client_cert="/etc/ssl/certs/alice.crt"
  private_key="/etc/ssl/private/alice.key"
  private_key_passwd="***"
}
```

### 6.6 (선택) 공개 SSID를 OWE로 전환한 뒤 포털 인증
- L2는 OWE로 암호화·프라이버시 제공, L3에서 포털/토큰으로 **식별·정책** 적용.

---

## 7. 운영·모니터링 — WIDS/WIPS·로그·지표
### 7.1 지표
- **보안 지표**: PMF 협상율, SAE 실패/성공 비율, EAP-TLS 성공·실패 코드, 인증서 만료 임박.
- **품질 지표**: 재시도율, SNR/퍼포먼스, 로밍 소요(FT 성공률), M3/M4 재전송(KRACK 대비).

### 7.2 이벤트·로그 예(개념)
```text
AP[ap-1]: PMF-negotiated=Required, sta=aa:bb:cc:... (OK)
RADIUS: EAP-TLS Success, user=alice, vlan=120
WIDS: Deauth frames surge detected on SSID=GUEST (blocked by PMF)
```

### 7.3 탐지 규칙(컨트롤러/WIDS)
- **가짜 AP/Evil Twin**: 동일 SSID 다른 BSSID·암호 모드 상이 → 경보.
- **관리 프레임 공격**: Deauth/Disassoc 비정상 급증 → PMF 미지원 단말 식별·차단.
- **동일 단말 다중 위치**: RSSI/타임차 기반 이상치 탐지.

> KRACK/Dragonblood는 **패치·펌웨어·설정**으로 완화된다. 운영팀은 **주요 CVE·벤더 공지**를 정기 점검하라.

---

## 8. 성능·호환·보안 트레이드오프
- **PMF=Required**: 구형 단말 일부 미지원 → 게스트에 한해 Transition 고려.
- **WPA3-SAE**: 일부 구형 OS/드라이버 호환 이슈 → **WPA2/WPA3 전이 모드(혼합)**는 공격면 증가 → 가급적 **SSID 분리**.
- **FT(11r)**: 음성·로밍 품질↑, 단 호환성 테스트 필수.

---

## 9. 운영 체크리스트(핵심)
**설계/사전**
- [ ] SSID 역할 분리(CORP/BYOD/GUEST/IoT), **PMF=Required** 기본
- [ ] **WPA3-SAE** 또는 **EAP-TLS** 채택, OWE로 공개망 보호
- [ ] RADIUS 고가용성, 동적 VLAN/롤 기반 정책
- [ ] 인증서 수명주기(발급·회수·갱신·OCSP/CRL), 자동 등록(SCEP/EST/MDM)
- [ ] 802.11r/k/v 로밍 검증(음성/실시간)
- [ ] 펌웨어·드라이버 **정기 패치**(KRACK/Dragonblood 등)

**배포/운영**
- [ ] PMF 협상율, SAE/EAP 실패 사유 대시보드
- [ ] WIDS/WIPS 룰(Deauth/Disassoc surge, Evil Twin)
- [ ] 로그 상시 수집(SIEM 연계), 인증서 만료 경보
- [ ] 게스트/IoT 네트워크 **인터넷 전용**·동적 ACL

**감사/개선**
- [ ] 연 1회 **무선 보안 점검**(정책/구성/펌웨어), 상시 취약 이슈 트래킹
- [ ] 로밍/성능·보안 상충 시 **분리 SSID** 또는 정책 재배치

---

## 10. 실무 예제 — “기업 CORP SSID 전환 계획”
1) **현황**: WPA2-PSK 단일 SSID, 내부망과 평면 공유.
2) **목표**: **WPA3-Enterprise(EAP-TLS)** + **동적 VLAN** + **PMF Required**.
3) **단계**
   - (A) PKI 준비(내부 CA, 중간CA, RADIUS 인증서, 단말 배포)
   - (B) SSID 분리: `CORP-8021X`(EAP-TLS), `GUEST-OWE`(포털)
   - (C) RADIUS 정책: 부서별 VLAN/ACL, 관리자 롤, IoT는 별도 SSID
   - (D) 파일럿 → 호환성(FT, 6/6E) 검증 → 전사 확대
   - (E) 구 PSK SSID 제거 및 **PPSK/DPPSK**로 IoT만 예외

---

## 11. 문제 해결 가이드(간단)
- **연결 실패(EAP-TLS)**: 인증서 체인·KeyUsage·EKU(Server/ClientAuth) 확인, 시간 동기화.
- **SAE 인증 지연**: 그룹·H2E 설정 정합, 단말 드라이버 업데이트.
- **PMF로 인한 미연결**: 구 단말 전용 SSID(격리) 제공 또는 교체 계획.
- **로밍 끊김**: FT 활성/정합, 11k/v 스티어링, 채널 계획·전력 최적화.

---

## 12. (교육용) 자동 점검 스크립트 스니펫
```bash
#!/usr/bin/env bash
# wifi_sec_audit.sh — AP/컨트롤러에서 보안 설정 핵심 확인(개념)
set -euo pipefail
echo "[*] Checking WPA mode / PMF / 802.11r ..."
# 예: 벤더 CLI/REST에서 JSON 가져와 jq 로 점검 (의사코드)
# curl -s http://controller/api/ssid | jq '.[] | {ssid, wpaMode, pmf, ft, owe}'
# 출력: ssid, WPA3 여부, PMF Required, FT-xxx 정합, OWE 여부 등
```

---

## 13. 예상문제(실무/필답)
1) **WPA3-SAE, WPA3-Enterprise, OWE**의 **인증/암호화 방식**과 적용 시나리오를 비교하라. (힌트: SAE=PAKE, EAP-TLS=PKI, OWE=무인증 암호화)
2) **PMF(802.11w)**가 방어하는 공격과 운영 시 유의점(호환성)을 서술하라.
3) **KRACK**의 원인(핸드셰이크 재전송 처리)과 오늘날의 완화 수단을 조합하라(패치·PMF·모니터링).
4) **Dragonblood**가 지적한 WPA3 구현 이슈의 본질과 현재 권고를 서술하라(업데이트·가이드 준수).
5) **게스트 네트워크**를 OWE로 전환할 때의 이점과 한계(무인증, L3 포털 필요)를 설명하라.

---

## 14. 참고(표준/가이드)
- **RFC 8110(OWE)** — 무인증 암호화 정의.
- **NIST SP 800-153** — WLAN 보안 구성·모니터링 지침(수명주기).
- **KRACK/CERT VU#228519** — WPA(2) 키 재설치 취약 개요.
- **WPA3 배포 가이드(벤더)** — Wi-Fi 7과 WPA3 요구사항, FT-SAE/FT-EAP 정합.

---

## 15. 결론
- 오늘날 무선 보안의 **정석 조합**은 **WPA3 + PMF + 802.1X(EAP-TLS)**(기업), **OWE**(공개망), **SAE**(가정/소규모)다.
- **SSID 역할 분리·동적 정책·WIDS/WIPS**가 **운영 리스크**를 낮춘다.
- 정기 **펌웨어·드라이버 패치**, **인증서 수명주기**, **지표 기반 모니터링**이 **실전 내성**을 결정한다.
