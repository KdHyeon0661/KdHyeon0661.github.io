---
layout: post
title: 미적분 - 반복적분
date: 2025-08-12 21:20:23 +0900
category: 미적분
---
# 이중적분(Double Integral)

## 정의와 기하적 의미

스칼라장 \(f(x,y)\)와 평면영역 \(D\subset \mathbb{R}^2\)에 대해, **이중적분**은
$$
\iint_D f(x,y)\,dA
$$
로 표기한다. 여기서 \(dA\)는 면적 미소요소(보통 \(dx\,dy\) 또는 \(dy\,dx\))를 의미한다.

- **기하적 의미**
  - \(f(x,y)\ge 0\): \(z=f(x,y)\) 그래프 아래의 **부피(volume)**.
  - \(f\equiv 1\): 영역 \(D\)의 **면적**.

적분 가능성(리만/르베그)은 본 문서 범위를 넘어가지만, 통상 **유계의 연속 함수는 유계 영역에서 적분 가능**하다고 생각하면 충분하다.

---

## 반복적분과 Fubini 정리: 계산의 표준 루틴

### 반복적분(Iterated Integral)

직사각형 영역 \(R=[a,b]\times[c,d]\)에서
$$
\iint_R f(x,y)\,dA
=\int_a^b\int_c^d f(x,y)\,dy\,dx
=\int_c^d\int_a^b f(x,y)\,dx\,dy.
$$

일반 영역 \(D\)에서도 **적절한 기술**로 반복적분 형태를 만든다:

- **x-단순 영역**(vertical simple):
  $$
  D=\{(x,y)\mid a\le x\le b,\ \phi_1(x)\le y\le \phi_2(x)\}
  $$
  이면
  $$
  \iint_D f\,dA = \int_{x=a}^{b}\left(\int_{y=\phi_1(x)}^{\phi_2(x)} f(x,y)\,dy\right) dx.
  $$

- **y-단순 영역**(horizontal simple):
  $$
  D=\{(x,y)\mid c\le y\le d,\ \psi_1(y)\le x\le \psi_2(y)\}
  $$
  이면
  $$
  \iint_D f\,dA = \int_{y=c}^{d}\left(\int_{x=\psi_1(y)}^{\psi_2(y)} f(x,y)\,dx\right) dy.
  $$

### Fubini 정리(핵심)

적분 가능한 \(f\)에 대해
$$
\iint_D f\,dA
=\int \!\!\int f(x,y)\,dx\,dy
=\int \!\!\int f(x,y)\,dy\,dx
$$
이 **동일**하다(적분 조건과 측도론적 가정 하에). 실전에서는 **더 쉬운 순서를 선택**한다.

---

## 영역 분류와 경계 해석: “그림→식” 변환

1) **직사각형**: \([a,b]\times[c,d]\).
2) **삼각형**: 두 직선/곡선으로 y를 x의 함수로, 또는 x를 y의 함수로.
3) **사다리꼴/쐐기형**: 위아래(또는 좌우) 경계가 함수로 표현 가능.
4) **원판/환형/부채꼴**: **극좌표**가 자연스럽다.
5) **교차영역**: 예) 두 곡선 \(y=y_1(x)\), \(y=y_2(x)\)로 둘러싸인 영역. 교점부터 찾고 분할.
6) **분할 필요 영역**: 하나의 반복적분으로 표현 어렵다면 영역을 \(D=D_1\cup D_2\)로 나눠 각각 적분.

> 핵심: **그림을 먼저 정확히 그린 후**, 상·하(혹은 좌·우) 경계를 **연속 함수**로 표현.

---

## 기본 예제 — 면적·부피 계산

### 면적: \(f\equiv 1\)

**예제 A**: 포물선 \(y=x^2\)와 직선 \(y=2x\)로 둘러싸인 영역 면적.

- 교점: \(x^2=2x\Rightarrow x(x-2)=0\Rightarrow x=0,2\).
- 위쪽 \(y=2x\), 아래쪽 \(y=x^2\) → x-단순.
  $$
  \text{Area}=\int_{0}^{2}\int_{x^2}^{2x} 1\,dy\,dx
  =\int_0^2 [y]_{y=x^2}^{2x} dx
  =\int_0^2 (2x-x^2)\,dx
  =\left[x^2-\frac{x^3}{3}\right]_0^2
  =4-\frac{8}{3}=\frac{4}{3}.
  $$

### 부피: \(f(x,y)\ge 0\)

**예제 B**: 영역 \(0\le x\le 1\), \(0\le y\le x\)에서 \(f(x,y)=x+y\).
$$
\iint_D (x+y)\,dA = \int_{x=0}^{1}\int_{y=0}^{x}(x+y)\,dy\,dx
= \int_0^1 \left[x y + \frac{y^2}{2}\right]_{0}^{x} dx
= \int_0^1 \left(x^2 + \frac{x^2}{2}\right)dx
= \frac{3}{2}\int_0^1 x^2\,dx
= \frac{3}{2}\cdot \frac{1}{3}=\frac{1}{2}.
$$

---

## 적분 순서 바꾸기: 경계 재기술 훈련

**예제 C**: \(D=\{(x,y)\mid 0\le y\le 1,\ y^2\le x\le y\}\)에서 \(\iint_D 1\,dA\).

- 현재는 **y-단순**: \(\int_{y=0}^{1}\int_{x=y^2}^{y}1\,dx\,dy\).
- 순서를 바꾸려면 \(x\)의 범위: \(x\in[0,1]\) (왜냐하면 \(x\le y \le 1\), 그리고 \(x\ge y^2\Rightarrow y\le \sqrt{x}\)).
  각 \(x\)에 대해 \(y\)는 \(y^2\le x\)와 \(x\le y\)를 동시에 만족 → \(y\in [x,\sqrt{x}]\), 단 \(0\le x\le 1\)에서 \(x\le \sqrt{x}\)가 성립하는 구간은 \(x\in[0,1]\).
- 결과:
  $$
  \iint_D 1\,dA=\int_{x=0}^{1}\int_{y=x}^{\sqrt{x}}1\,dy\,dx
  =\int_0^1 (\sqrt{x}-x)\,dx
  = \left[\frac{2}{3}x^{3/2}-\frac{x^2}{2}\right]_0^1
  = \frac{2}{3}-\frac{1}{2}=\frac{1}{6}.
  $$

---

## 변환: 원형 영역의 표준무기

### 변환식과 야코비안

$$
x=r\cos\theta,\quad y=r\sin\theta,\quad dA=dx\,dy=r\,dr\,d\theta.
$$

### 원판·부채꼴·환형 예제

**예제 D**: 원판 \(x^2+y^2\le a^2\)에서 \(f(x,y)=x^2+y^2\)의 이중적분.
- 극좌표: \(x^2+y^2=r^2\). 영역: \(0\le r\le a\), \(0\le \theta\le 2\pi\).
  $$
  \iint_D (x^2+y^2)\,dA=\int_0^{2\pi}\int_0^{a} r^2 \cdot (r\,dr\,d\theta)
  =\int_0^{2\pi}\int_0^a r^3\,dr\,d\theta
  =2\pi\cdot \frac{a^4}{4}=\frac{\pi a^4}{2}.
  $$

**예제 E**: 환형 \(b\le r \le a\)에서 \(f\equiv 1\)의 면적.
$$
\text{Area}=\int_0^{2\pi}\int_{r=b}^{a} 1\cdot r\,dr\,d\theta
=2\pi\left[\frac{r^2}{2}\right]_b^a
=\pi(a^2-b^2).
$$

**예제 F(부채꼴)**: \(0\le r\le \cos\theta\), \(-\pi/2\le \theta\le \pi/2\)에서 \(f\equiv 1\).
$$
\text{Area}=\int_{-\pi/2}^{\pi/2}\int_{0}^{\cos\theta} r\,dr\,d\theta
=\int_{-\pi/2}^{\pi/2} \frac{(\cos\theta)^2}{2} d\theta
=\frac12\int_{-\pi/2}^{\pi/2}\frac{1+\cos 2\theta}{2}\,d\theta
=\frac{1}{4}\left[\theta+\frac{\sin 2\theta}{2}\right]_{-\pi/2}^{\pi/2}
=\frac{\pi}{4}.
$$

---

## 일반 좌표변환과 야코비안(중요)

### 일반 정리(2D)

변환 \(T:(u,v)\mapsto (x(u,v),y(u,v))\)가 **가역적·미분가능**이고 야코비안
$$
J_T(u,v)=\det
\begin{pmatrix}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v}\\[4pt]
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
\end{pmatrix}
\neq 0
$$
이면
$$
\iint_D f(x,y)\,dx\,dy
=\iint_{D^\*} f(x(u,v),y(u,v))\,|J_T(u,v)|\,du\,dv.
$$

### 표준 예제(등각형 변환 아님, 선형 스케일)

**예제 G**: 타원 \(\frac{x^2}{a^2}+\frac{y^2}{b^2}\le 1\)의 면적.
- 변환: \(x=au,\ y=bv\). 그러면 \(u^2+v^2\le 1\) → 단위원판.
- 야코비안: \(|J|=\left|\det\begin{pmatrix}a&0\\0&b\end{pmatrix}\right|=ab\).
- 면적:
  $$
  \iint_{x^2/a^2+y^2/b^2\le 1} 1\,dx\,dy
  =\iint_{u^2+v^2\le 1} 1\cdot |J|\,du\,dv
  =ab\cdot (\text{단위원판 면적})=ab\cdot\pi.
  $$

**예제 H(평행변형)**: \(x=u+v,\ y=u-v\).
\(|J|=\left|\det\begin{pmatrix}1&1\\1&-1\end{pmatrix}\right|=|-2|=2\).
사각형을 45° 회전/늘림으로 변환해 적분 단순화가 가능.

---

## 이중적분의 물리적 응용

### 질량, 무게중심(중심)

밀도 \(\rho(x,y)\)인 얇은 판에서 총 질량 \(M\):
$$
M=\iint_D \rho(x,y)\,dA.
$$
**무게중심** \((\bar{x},\bar{y})\):
$$
\bar{x}=\frac{1}{M}\iint_D x\,\rho(x,y)\,dA,\qquad
\bar{y}=\frac{1}{M}\iint_D y\,\rho(x,y)\,dA.
$$

**예제 I**: 반원판 \(x^2+y^2\le R^2\), \(y\ge 0\), 균등밀도 \(\rho_0\).
- 질량: \(M=\rho_0\cdot \frac{1}{2}\pi R^2\).
- 대칭으로 \(\bar{x}=0\).
- \(\bar{y}=\dfrac{1}{M}\iint_D y\,\rho_0\,dA = \dfrac{\rho_0}{M}\iint_D y\,dA\).
  극좌표 \(y=r\sin\theta\), \(0\le r\le R\), \(0\le \theta\le \pi\)의 **상반**은 \([0,\pi]\)이지만 반원 상반은 \([0,\pi]\) 중 \(y\ge 0\)은 그대로이고, 관례상 \([0,\pi]\) 사용 가능(대칭으로 동일). 더 간단히 상반에서 \([0,\pi]\)로 적분하면
  $$
  \iint y\,dA=\int_{0}^{\pi}\int_{0}^{R} (r\sin\theta)\cdot r\,dr\,d\theta
  =\int_0^\pi \sin\theta\,d\theta\cdot \int_0^R r^2\,dr
  =2\cdot \frac{R^3}{3}=\frac{2R^3}{3}.
  $$
  따라서
  $$
  \bar{y}=\frac{\rho_0\cdot \frac{2R^3}{3}}{\rho_0\cdot \frac{1}{2}\pi R^2}
  =\frac{4R}{3\pi}.
  $$
  고전 결과 \(\bar{y}=\frac{4R}{3\pi}\)를 얻는다.

### 관성모멘트(요약)

원점에 대한 관성모멘트 \(I_O=\iint_D r^2\,\rho\,dA\) 등. 좌표변환으로 자주 단순화.

---

## 이중적분

영역이 무한하거나, \(f\)가 특이점을 가질 때 **극한**으로 정의한다.

- 무한 영역 예: \(\iint_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dA\).
  극좌표로 변환:
  $$
  \int_0^{2\pi}\int_0^\infty e^{-r^2} r\,dr\,d\theta
  =2\pi\cdot \frac{1}{2}=\pi,
  $$
  즉 \(\iint_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dA=\pi\).
  (유명한 가우스 적분 \(\int_{-\infty}^{\infty}e^{-x^2}\,dx=\sqrt{\pi}\)의 2D 버전)

---

## 계산 숙련: 표준 형태 및 항등식

- **짝·홀 대칭**: 적분 영역/함수의 대칭으로 적분값을 0 또는 두 배로 단순화.
- **삼각함수 항등식**: 극좌표에서 \(x=r\cos\theta, y=r\sin\theta\), \(x^2+y^2=r^2\), \(\cos^2\theta=\frac{1+\cos2\theta}{2}\), 등.
- **루트가 있는 원형 경계**: 극좌표 또는 타원형 변환이 필수.

---

## 수치적분(직사각형 격자형 근사): 간단 도구

이중적분의 수치근사는 **Riemann sum**, **사다리꼴/심프슨 2D** 등으로 구현 가능하다.

```python
# 직사각형 [ax,bx]x[ay,by]에서 2D 사다리꼴(간단 버전)

import numpy as np

def trapz2(f, ax, bx, ay, by, nx=200, ny=200):
    xs = np.linspace(ax, bx, nx)
    ys = np.linspace(ay, by, ny)
    hx = (bx - ax)/(nx - 1)
    hy = (by - ay)/(ny - 1)
    # 가중치(1D 사다리꼴)
    wx = np.ones(nx); wx[0] = wx[-1] = 0.5
    wy = np.ones(ny); wy[0] = wy[-1] = 0.5
    val = 0.0
    for i, x in enumerate(xs):
        for j, y in enumerate(ys):
            val += wx[i] * wy[j] * f(x, y)
    return val * hx * hy

# dy dx = 1/2 (앞서 예제 B)

f = lambda x,y: x + y
est = trapz2(f, 0.0, 1.0, 0.0, 1.0, nx=600, ny=600)  # 주의: 이건 사각형 전체.
# y <= x 조건을 반영하려면 영역 마스크 필요. 아래는 마스크 적용 예시.

def trapz2_with_mask(f, ax, bx, ay, by, mask, nx=400, ny=400):
    xs = np.linspace(ax, bx, nx)
    ys = np.linspace(ay, by, ny)
    hx = (bx - ax)/(nx - 1)
    hy = (by - ay)/(ny - 1)
    wx = np.ones(nx); wx[0] = wx[-1] = 0.5
    wy = np.ones(ny); wy[0] = wy[-1] = 0.5
    val = 0.0
    for i, x in enumerate(xs):
        for j, y in enumerate(ys):
            if mask(x,y):
                val += wx[i] * wy[j] * f(x, y)
    return val * hx * hy

mask_tri = lambda x,y: (0.0 <= x <= 1.0) and (0.0 <= y <= x)
est_tri = trapz2_with_mask(f, 0.0, 1.0, 0.0, 1.0, mask_tri, nx=600, ny=600)
print("삼각형 영역 근사:", est_tri, "  실제:", 0.5)
```

**메시지**: 실제로는 SciPy의 `dblquad`, 혹은 사상(변수변환) + 정규 격자 등을 많이 활용한다.

---

## 고급: 적분 순서 변경이 “해결책”이 되는 케이스

**예제 J**: \(\displaystyle \iint_D \frac{1}{1+xy}\,dA\), \(D=\{(x,y)\mid 0\le y\le 1,\ 0\le x\le y\}\).
\(y\)가 상한/하한에 **동시에** 등장해 직접적분이 거칠면 순서를 바꾼다:
- 원래 \(0\le x\le y\le 1\) → y-단순: \(\int_{y=0}^1 \int_{x=0}^y \frac{1}{1+xy}\,dx\,dy\).
- 순서 바꾸면 \(0\le x\le 1\), \(x\le y\le 1\):
  $$
  \int_{x=0}^1 \int_{y=x}^1 \frac{1}{1+xy}\,dy\,dx.
  $$
  내부 적분에서 \(u=1+xy\) 치환(혹은 로그 항 등장)을 유리하게 만들 수 있다.
  $$
  \int_{y=x}^1 \frac{1}{1+xy}\,dy = \frac{1}{x}\ln\frac{1+x}{1+x^2},\quad (x>0),
  $$
  경계 \(x\to 0\)은 극한으로 처리. 외적분은 로그-항의 표준형으로 수렴한다.
  요점: **순서를 바꾸면 구조가 단순해지는 경우가 많다**.

---

## 영역 분할: 한 번에 안 되면 나눠서 한다

**예제 K**: 곡선 \(y=x^2\)와 \(y=2-x\)로 둘러싸인 영역의 면적.
교점: \(x^2=2-x\Rightarrow x^2+x-2=0\Rightarrow x=1,-2\).
영역은 \(x\in[-2,1]\)에서 위아래가 바뀌는 지점이 있을 수 있으므로, 구간을 나눠야 한다.
면적:
$$
\int_{-2}^1 \big[(2-x) - x^2\big]\,dx
= \left[2x - \frac{x^2}{2} - \frac{x^3}{3}\right]_{-2}^1
= \cdots
$$
(계산 생략) 핵심은 **분할 후 각 구간에서 “위-아래”가 명확**해야 한다.

---

## 선행 주제와의 연결

- **반복적분**: 이중적분을 **두 번의 일변수 적분**으로 계산한다는 관점(계산 실기).
- **방향도함수·그래디언트**: 밀도/잠재함수의 거동 해석에 주로 사용.
- **접평면·전미분**: 좌표변환의 정당화(야코비안은 국소 선형근사에서 면적 스케일).
- **삼각치환**: 루트 형태가 있는 경우, 극좌표/일반 변환과 함께 간접적으로 응용.
- **라그랑주 승수**: 주어진 면적 제약에서의 최적화 등, 이중적분으로 나오는 목적함수의 제약최적화.

---

## 추가 예제(풀이 포함)

### 삼각형에서 다항식

\(D=\{(x,y)\mid 0\le y\le 1,\ 0\le x\le 1-y\}\)에서 \(f(x,y)=x+2y\).
$$
\iint_D (x+2y)\,dA
=\int_{y=0}^{1}\int_{x=0}^{1-y} (x+2y)\,dx\,dy
=\int_0^1 \left[\frac{x^2}{2}+2yx\right]_{0}^{1-y} dy
=\int_0^1 \left[\frac{(1-y)^2}{2}+2y(1-y)\right] dy.
$$
정리하면
$$
=\int_0^1 \left[\frac{1-2y+y^2}{2}+2y-2y^2\right] dy
=\int_0^1 \left[\frac{1}{2} - y + \frac{y^2}{2} + 2y - 2y^2\right] dy
=\int_0^1 \left[\frac{1}{2} + y - \frac{3}{2}y^2\right] dy
$$
$$
=\left[\frac{y}{2} + \frac{y^2}{2} - \frac{1}{2}\cdot \frac{y^3}{1}\right]_0^1
=\frac{1}{2}+\frac{1}{2}-\frac{1}{2}=\frac{1}{2}.
$$

### 극좌표가 답인 경우

\(D:\ x^2+y^2\le 1\)에서 \(f(x,y)=e^{-(x^2+y^2)}\).
$$
\iint_D e^{-(x^2+y^2)}\,dA
=\int_0^{2\pi}\int_0^1 e^{-r^2} r\,dr\,d\theta
=2\pi\cdot \left[-\frac{1}{2}e^{-r^2}\right]_0^1
=\pi(1-e^{-1}).
$$

### 일반 변환(전형)

\(D:\ \frac{x^2}{4}+\frac{y^2}{9}\le 1\), \(f\equiv 1\) → 면적 \(\pi ab=\pi\cdot 2\cdot 3=6\pi\).

---

## 간단한 자동화 검증(SymPy)

```python
import sympy as sp

x, y, a, b = sp.symbols('x y a b', positive=True, real=True)

# 예제 A: area between y=2x and y=x^2, x in [0,2]

area = sp.integrate(2*x - x**2, (x, 0, 2))  # inner integral of 1 dy
print("Area A:", sp.simplify(area))  # 4/3

# 예제 D: polar integral of r^2 over disk r<=a

r, th = sp.symbols('r th', positive=True, real=True)
expr = sp.integrate(sp.integrate(r**2 * r, (r, 0, a)), (th, 0, 2*sp.pi))
print("∬_disk r^2 dA:", sp.simplify(expr))  # pi a^4 / 2

# 예제 I: semicircle centroid y-bar = 4R/(3π)

R = sp.symbols('R', positive=True, real=True)
mass = sp.Rational(1,2)*sp.pi*R**2  # density=1
yint = sp.integrate(sp.integrate(r*sp.sin(th)*r, (r,0,R)), (th, 0, sp.pi))
ybar = sp.simplify(yint/mass)
print("ybar(semi-disc):", ybar)  # 4R/(3π)
```

---

## 자주 하는 실수와 체크리스트

- □ **영역 스케치**를 생략하지 말 것. 교점·경계의 상하(좌우) 관계를 먼저 확정.
- □ 반복적분에서 **내적분의 경계**가 \(x\) 또는 \(y\)의 **함수**인지 확인.
- □ 순서 변경 시 **새 경계**를 정확히 도출(그림에 직선/곡선으로 투영).
- □ 원형/부채꼴/환형은 **극좌표**로 가는 게 보통 최선. \(dA=r\,dr\,d\theta\) 잊지 말 것.
- □ 일반 변환은 **야코비안** \(|J|\)를 반드시 포함.
- □ 비정상 적분은 **극한**으로 정의하고 수렴성 판단.
- □ 대칭성(짝/홀, 회전대칭 등)을 적극 활용해 계산량을 줄일 것.

---

## 한 페이지 요약

- 이중적분은 **면적 미소**를 누적하는 연산. \(f\equiv 1\)이면 면적.
- **반복적분**으로 바꿔서 계산; **Fubini**가 순서교환을 정당화.
- 영역을 **x-단순/ y-단순**으로 기술하거나, 필요 시 **분할**.
- 원형류 영역은 **극좌표**(또는 선형 스케일 변환).
- 일반 좌표변환은 **야코비안** 필수.
- 물리량(질량·무게중심·관성모멘트)은 이중적분의 전형적 응용.
- 수치해석(격자 근사)으로 검증/추정 가능.

---

# 연습문제(권장)

1) \(D=\{(x,y)\mid 0\le x\le 1,\ 0\le y\le x^2\}\)에서 \(\iint_D (x+3y)\,dA\).
2) \(D:\ x^2+y^2\le 4\)에서 \(\iint_D \sqrt{x^2+y^2}\,dA\).
3) \(D:\ 0\le y\le 1,\ y\le x\le 1\)에서 \(\iint_D \frac{1}{1+x^2}\,dA\) (순서 교환이 효율적).
4) 타원 \(\frac{x^2}{9}+\frac{y^2}{4}\le 1\) 면적.
5) 반원판 \(x^2+y^2\le R^2\), \(y\ge 0\), \(\rho(x,y)=1+y\). 질량과 무게중심.
6) \(\iint_{\mathbb{R}^2} e^{-(x^2+y^2)}\,dA\)의 수렴 확인.

---

## 마무리

이중적분은 **영역의 기하**와 **함수의 구조**를 동시에 읽어내는 기술이다.
정석은
1) **영역 스케치 → 반복적분 경계 설계**,
2) **순서 교환/분할**로 단순화,
3) **극좌표/일반변환 + 야코비안**으로 구조적 단순화,
4) 필요 시 **수치적분**으로 검증 의 루틴이다.
