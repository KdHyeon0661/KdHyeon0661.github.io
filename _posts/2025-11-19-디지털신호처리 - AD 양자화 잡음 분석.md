---
layout: post
title: 디지털신호처리 - A/D 양자화 잡음 분석
date: 2025-11-19 22:25:23 +0900
category: 디지털신호처리
---
# 영향과 A/D 양자화 잡음 분석

## 큰 그림: “유한 정밀도”가 들어오는 두 지점

디지털 필터 시스템에서 유한 정밀도/반올림 문제는 크게 두 군데에서 발생한다.

1. **A/D(입력) 양자화**
   - 아날로그 → 디지털 변환 시 샘플 값이 **B비트 격자**로 강제 투영된다.
   - 시스템 관점에서 “입력에 양자화 잡음이 더해진 것”과 동치로 모델링 가능.

2. **디지털 필터 내부 연산의 반올림**
   - 곱셈기, 가산기, 누산기, 지연 레지스터 등에서 **매 연산마다 반올림/절단**이 발생.
   - FIR은 내부 잡음이 대체로 안정적/선형적으로 누적되는 반면,
   - IIR은 피드백 때문에 내부 잡음이 **재귀적으로 재순환**하여 더 까다롭다.

따라서 “A/D 양자화 잡음 → 필터가 그 잡음을 어떻게 처리하는가”와 “필터 내부의 반올림 잡음”을 **분리해서** 이해해야 한다.

---

## A/D 균일 양자화기의 정의

### 미드트레드/미드라이즈 양자화기

스텝(LSB) 크기가 \( \Delta \)인 **균일(uniform) 양자화**에서

- **미드트레드(mid-tread)**
  \[
  Q_{\text{mt}}(x)=\Delta\cdot\left\lfloor \frac{x}{\Delta}+\frac{1}{2}\right\rfloor
  \]
  - 0 부근에 **레벨 0**이 존재 → 작은 신호에서 “데드존” 형성.

- **미드라이즈(mid-rise)**
  \[
  Q_{\text{mr}}(x)=\Delta\cdot\left(\left\lfloor \frac{x}{\Delta}\right\rfloor+\frac{1}{2}\right)
  \]
  - 0 레벨이 없고 임계가 0을 가른다.

양자화 오차(에러)는 항상
\[
e(x)=Q(x)-x
\]
로 정의한다.

### 풀스케일과 스텝 크기

입력 범위가 \([-X_{\max},\,X_{\max}]\)이고 비트 수가 \(B\)이면
균일 양자화 스텝은
\[
\Delta=\frac{2X_{\max}}{2^B}.
\]

실무에서 “**풀스케일 매핑이 맞지 않으면** 분석이 무너진다.”
예: ADC 풀스케일이 2 Vpp인데 실제 입력이 3 Vpp라면, 잡음이 아니라 **큰 비선형 왜곡(포화)** 가 우세해진다.

---

## 양자화 오차의 확률 모델

### 균일 잡음 모델(“white, uniform, uncorrelated”)

입력 신호가 충분히 복잡하거나(다톤, 잡음, 음성 등)
양자화 레벨을 “많이” 가로지르면
양자화 에러를 다음처럼 근사한다.

\[
e \sim \mathcal{U}\!\left(-\frac{\Delta}{2},\,\frac{\Delta}{2}\right),
\quad
\mathbb{E}[e]=0,
\quad
\sigma_e^2=\mathrm{Var}(e)=\frac{\Delta^2}{12}.
\]

이 모델은 A/D 잡음 분석의 핵심 출발점이다.

### 사인파 입력에서의 이론 SNR

풀스케일 사인파 \(x[n]=A\sin(\cdot)\)에서 \(A=X_{\max}\)이면
\[
P_s=\frac{A^2}{2},\qquad
P_e\approx \frac{\Delta^2}{12}.
\]

따라서
\[
\mathrm{SNR}
\approx 10\log_{10}\frac{P_s}{P_e}
=10\log_{10}\frac{6A^2}{\Delta^2}
\approx 6.02B+1.76~\mathrm{dB}.
\]
이 식은 이상적(thermal/aperture/clock jitter 무시)인 양자화 SNR의 표준 결과다.

### ENOB(유효 비트수)

실측 SNR로부터 “양자화만 있었다면 몇 비트와 같은가?”를 환산한 것이 ENOB이다.

\[
\mathrm{ENOB}= \frac{\mathrm{SNR}_{\mathrm{meas}}-1.76}{6.02}.
\]

현대 고성능 ADC(특히 ΣΔ 구조)는 **오버샘플링 + 노이즈 셰이핑**으로
대역 내 SNR/ENOB를 크게 끌어올린다.

---

## 양자화 잡음의 스펙트럼 관점

### 잡음 전력 스펙트럼 밀도(PSD)

균일·백색 잡음 모델이 맞으면,
양자화 잡음은 대역 전체에 평탄한 PSD를 가진다.

정규화 주파수 \(\omega\in[-\pi,\pi]\)에서

- 총 잡음 파워: \(\sigma_e^2=\Delta^2/12\)
- PSD는 대략
  \[
  S_e(e^{j\omega})\approx \frac{\Delta^2}{12}\cdot\frac{1}{2\pi}.
  \]

즉, “**잡음은 입력 신호와 무상관이며, 주파수에 대해 거의 평탄**”하다는 뜻이다.

### 오버샘플링(OSR)의 이득

샘플링률을 \( \mathrm{OSR} \)배 올리고,
이후 이상적인 저역통과 + 디시메이션을 하면
대역 내 잡음은 대략 \(1/\mathrm{OSR}\)로 줄어든다.

- SNR 향상:
  \[
  \Delta\mathrm{SNR}\approx 10\log_{10}(\mathrm{OSR})
  \]
- ΣΔ(노이즈 셰이핑)까지 쓰면 훨씬 “더 가파르게” 줄어든다.

---

## A/D 양자화 잡음이 디지털 필터를 통과할 때

디지털 필터가 LTI라면,
입력 신호를
\[
x[n]=s[n]+e[n]
\]
으로 쓸 수 있다. (\(s[n]\): 원 신호, \(e[n]\): 양자화 잡음)

출력은 선형성이므로
\[
y[n]=H\{s[n]\}+H\{e[n]\}=y_s[n]+y_e[n].
\]

즉, **필터는 잡음을 “입력 신호처럼” 처리**한다.

### 출력 잡음 파워의 일반식

입력 잡음이 백색이고 PSD가 \(S_e\)일 때
출력 잡음 PSD는
\[
S_{y_e}(e^{j\omega})=|H(e^{j\omega})|^2 S_e(e^{j\omega}).
\]

출력 잡음 파워:
\[
\sigma_{y_e}^2
=\frac{1}{2\pi}\int_{-\pi}^{\pi} |H(e^{j\omega})|^2 S_e(e^{j\omega})\,d\omega.
\]

백색잡음이면 \(S_e\)가 상수이므로
\[
\sigma_{y_e}^2 = \sigma_e^2 \cdot G_H,
\quad
G_H \equiv \frac{1}{2\pi}\int_{-\pi}^{\pi} |H(e^{j\omega})|^2 d\omega.
\]

여기서 \(G_H\)가 **잡음 이득(noise gain)** 이다.

### FIR에서의 잡음 이득

FIR 임펄스 응답이 \(h[0],\dots,h[M]\)이면
\[
G_H = \sum_{k=0}^{M} h[k]^2.
\]

따라서 FIR은

- 잡음이 **유한한 선형 결합**으로만 통과하고
- \(G_H\)를 통해 출력 잡음이 “얼마나 커지는지” 정확히 계산 가능하며
- 항상 안정(BIBO)이라 출력 잡음도 유한이다.

### IIR에서의 잡음 이득

IIR은 임펄스 응답 \(h[n]\)이 무한이므로
\[
G_H = \sum_{n=0}^{\infty} h[n]^2
\]
가 되며, 안정한 경우에만 수렴한다.

- 극점이 단위원 안에 가까울수록 \(h[n]\)이 천천히 감쇠 → **G_H가 커짐**
- 따라서 IIR은 같은 주파수 응답이라도 **잡음 증폭이 더 민감**할 수 있다.

---

## “필터 내부 반올림 잡음”의 모델

이제 A/D 잡음과 별개로,
필터 내부에서 발생하는 반올림/절단이 만들어내는 잡음을 보자.

### 유니트 라운드오프(unit roundoff)

고정소수점 \(B\)비트(부호 포함, 소수부 \(F\)비트)라면
LSB 크기를
\[
u = 2^{-F}
\]
라고 둔다.

“최근접 반올림(round-to-nearest)”을 쓰면
각 연산 결과는 실제값에 **균일한 라운딩 에러**가 더해진 것으로 근사:

\[
\epsilon \sim \mathcal{U}\!\left(-\frac{u}{2},\frac{u}{2}\right),
\quad
\mathbb{E}[\epsilon]=0,
\quad
\sigma_{\epsilon}^2=\frac{u^2}{12}.
\]

절단(truncation, floor)이라면 에러가 \([0,u)\) 쪽으로 치우쳐
**바이어스(DC drift)** 가 생길 수 있다.

### 곱셈기/가산기에서의 잡음 소스

예: FIR 1단 tap에서

1. 곱셈
   \[
   p_k[n]=b_k x[n-k] + \epsilon_{m,k}[n]
   \]
2. 덧셈/누산
   \[
   y[n]=\sum_{k} p_k[n] + \epsilon_{a}[n]
   \]

여기서 \(\epsilon_{m,k}\), \(\epsilon_a\) 들이 **독립 백색잡음**이라면
출력 잡음 파워는 “각 잡음이 필터를 거쳐 증폭된 합”으로 계산된다.

### FIR 내부 반올림 잡음의 출력 파워

FIR direct form에서 **각 곱셈기 출력이 한 번씩 반올림**된다고 하자.

- 곱셈기 잡음 분산: \(\sigma_{\epsilon}^2=u^2/12\)
- tap이 \(M+1\)개라면 잡음 소스도 \(M+1\)개
- 이 잡음이 이후 **부분 FIR**을 거쳐 출력으로 간다.

결과적으로 FIR 내부 라운딩 잡음 출력 파워는

\[
\sigma_{y,\mathrm{round}}^2
= \sigma_{\epsilon}^2 \sum_{k=0}^{M} \left(\sum_{m=k}^{M} h[m]^2\right)
\]

같은 형태로 나타나며,
대략적 직관은

- tap 수가 늘수록 **잡음이 선형적으로 증가**
- 계수 에너지( \( \sum h^2 \) )가 클수록 증가

이다.

### IIR 내부 반올림 잡음의 위험

IIR은 피드백이 있으므로,

- 내부 라운딩 잡음이 **출력으로 나갔다가 다시 입력으로 되먹임**
- 잡음이 “필터의 poles”에 의해 크게 증폭될 수 있음
- 극점이 단위원에 근접하면 내부 잡음이 계속 순환
- 고정소수점에서는 **limit cycle**(무입력에서도 출력이 진동)까지 발생 가능

따라서 IIR은

1. **SOS(바이쿼드) 캐스케이드**
2. **DF-II Transposed 같은 구조**
3. **스케일링(내부 노드 동적범위 제어)**
4. **라운딩(최근접) 우선**
5. **포화(saturation) 연산**

을 병행하는 것이 표준이다.

---

## GNU Octave 실험 1 — 이상적 A/D 양자화 잡음 SNR 검증

### 유니폼 미드트레드 양자화 함수

```octave
function y = q_mid_tread(x, Delta)
  y = Delta * round(x / Delta);
end
```

### SNR 측정 실험

```octave
clear; close all; clc

Fs = 48000;
N  = Fs;                 % 1초
n  = 0:N-1; t = n/Fs;

B    = 10;
Xmax = 1;
Delta = 2*Xmax/(2^B);

f0 = 997.3;              % 비정합 주파수(스펙트럼 누설 회피용)
x  = 0.999*Xmax*sin(2*pi*f0*t);

y  = q_mid_tread(x, Delta);
e  = y - x;

Ps = mean(x.^2);
Pe = mean(e.^2);

SNR_meas = 10*log10(Ps/Pe);
SNR_theo = 6.02*B + 1.76;

fprintf("Measured SNR = %.2f dB\n", SNR_meas);
fprintf("Theoretical SNR ≈ %.2f dB\n", SNR_theo);
```

- 측정치가 이론 근처로 나오면 “균일 백색 모델”이 꽤 잘 맞는 경우다.
- 사인파가 너무 정합 주파수면(FFT bin에 딱 맞으면) 에러가 상관되어 THD 스파이크가 커질 수 있으니
  **비정합 주파수**가 실험에 유리하다.

---

## GNU Octave 실험 2 — FIR이 A/D 잡음을 어떻게 처리하는가

### FIR 저역통과 설계

```octave
clear; close all; clc; pkg load signal

Fs = 48000;
fc = 4000;               % 컷오프 4 kHz
M  = 63;                 % 차수 63 (탭 64개)

b = fir1(M, fc/(Fs/2), hamming(M+1));   % 윈도우법 FIR

[H,w] = freqz(b,1,4096);
figure; plot(w/pi, 20*log10(abs(H)));
xlabel("Normalized freq (×pi)"); ylabel("Magnitude (dB)");
title("FIR LPF magnitude");
grid on
```

### 잡음 전파 측정

```octave
clear; close all; clc; pkg load signal

Fs = 48000; N=Fs;
n=0:N-1; t=n/Fs;

% 신호 + 잡음
x_sig = 0.6*sin(2*pi*1000*t) + 0.2*sin(2*pi*12000*t);

B=10; Xmax=1; Delta=2*Xmax/(2^B);
xq = q_mid_tread(x_sig, Delta);
e_in = xq - x_sig;              % A/D 잡음

% FIR LPF
M=63; fc=4000;
b = fir1(M, fc/(Fs/2), hamming(M+1));
yq = filter(b,1,xq);
ys = filter(b,1,x_sig);

e_out = yq - ys;

fprintf("Input noise var  = %.3e\n", var(e_in));
fprintf("Output noise var = %.3e\n", var(e_out));

% 잡음이 얼마나 줄었는지(대역외 잡음 제거) 확인
fprintf("Noise gain (meas) = %.3f\n", var(e_out)/var(e_in));
```

저역통과 FIR은

- 신호 대역(저주파)에서는 잡음을 거의 그대로 통과시키되
- 대역 외(high-freq) 잡음을 강하게 감쇠시켜
  **출력 잡음이 입력보다 줄어들 수도 있다.**

---

## GNU Octave 실험 3 — FIR 내부 라운딩 잡음

이번에는 A/D가 아니라 **필터 내부에서 매 연산마다 라운딩**을 흉내 낸다.

### 고정소수점 라운딩 함수(Q-format)

```octave
function y = q_frac(x, F)
  % F: 소수부 비트수
  scale = 2^F;
  y = round(x*scale)/scale;
end
```

### FIR 내부 라운딩 시뮬레이터

```octave
function y = fir_fixed_round(b, x, F)
  M = length(b)-1;
  x_delay = zeros(1, M);
  y = zeros(size(x));

  for n=1:length(x)
    taps = [x(n), x_delay];

    acc = 0;
    for k=0:M
      prod = q_frac(b(k+1)*taps(k+1), F);  % 곱셈 후 라운딩
      acc  = q_frac(acc + prod, F);        % 누산 후 라운딩
    end
    y(n)=acc;

    if M>0
      x_delay(2:end)=x_delay(1:end-1);
      x_delay(1)=x(n);
    end
  end
end
```

### 실험

```octave
clear; close all; clc; pkg load signal

Fs=48000; N=Fs/2; n=0:N-1; t=n/Fs;
x = 0.7*sin(2*pi*1000*t) + 0.2*randn(size(t));

M=63; fc=4000;
b = fir1(M, fc/(Fs/2), hamming(M+1));

y_float = filter(b,1,x);             % 이상적 float
F = 12;                              % 소수부 12비트 고정소수
y_fix   = fir_fixed_round(b, x, F);

e_round = y_fix - y_float;

fprintf("Roundoff noise var = %.3e\n", var(e_round));
fprintf("SNR due to roundoff = %.2f dB\n", ...
        10*log10(var(y_float)/var(e_round)));
```

- \(F\)를 낮추면 라운딩 잡음이 커지고 SNR이 떨어진다.
- FIR의 경우 \(F\)와 tap 수로 잡음이 비교적 예측 가능하게 변한다.

---

## GNU Octave 실험 4 — IIR 내부 라운딩, limit cycle 감지

### 설계

```octave
clear; close all; clc; pkg load signal

Fs=48000;
[b,a] = butter(4, 4000/(Fs/2));   % 4차 Butterworth LPF
[sos,g] = tf2sos(b,a);            % SOS 분해
```

### 고정소수 SOS 실행기(DF-II-T)

```octave
function y = sos_df2t_fixed(sos, g, x, F)
  y = zeros(size(x));
  scale = 2^F;

  for s=1:rows(sos)
    b0=sos(s,1); b1=sos(s,2); b2=sos(s,3);
    a0=sos(s,4); a1=sos(s,5); a2=sos(s,6);
    w1=0; w2=0;

    xin = x;
    xout = zeros(size(x));

    for n=1:length(x)
      w0 = xin(n) - a1*w1 - a2*w2;
      w0 = round(w0*scale)/scale;

      y0 = b0*w0 + b1*w1 + b2*w2;
      y0 = round(y0*scale)/scale;

      w2=w1; w1=w0;
      xout(n)=y0;
    end
    x = xout;            % 다음 섹션 입력
  end

  y = g*xout;
end
```

### 무입력 limit cycle 테스트

```octave
clear; close all; clc; pkg load signal

Fs=48000; N=20000;
x = zeros(1,N);              % 무입력
x(1)=1e-3;                   % 아주 작은 초기 충격

[b,a] = butter(4, 4000/(Fs/2));
[sos,g] = tf2sos(b,a);

F=10;                        % 일부러 낮은 정밀도
y_fix = sos_df2t_fixed(sos,g,x,F);

figure; plot(y_fix);
title("IIR fixed-point response (limit cycle check)");
xlabel("n"); ylabel("y[n]");
grid on
```

- \(F\)가 충분히 낮으면, 입력이 0이어도 출력이 0으로 죽지 않고
  **작은 진동이 남는 limit cycle**을 볼 수 있다.
- SOS+DF-II-T를 써도 **정밀도가 너무 낮으면** 문제가 생긴다 → 이것이 IIR의 핵심 난점.

---

## 실무 체크리스트(반올림/양자화 잡음 관점)

1. **ADC 풀스케일 매핑**
   - 과부하 왜곡이 생기면 SNR 분석이 의미 없다.
2. **라운딩은 “최근접(round-to-nearest)” 우선**
   - truncation은 바이어스/드리프트/limit cycle 위험 증가.
3. **IIR은 SOS로 쪼개고 스케일링**
   - 내부 노드의 동적범위를 낮춰 overflow와 라운딩 잡음을 동시에 줄인다.
4. **포화(saturation) 연산**
   - wrap-around는 극점이 바뀐 것처럼 동작하며 불안정/limit cycle을 악화시킨다.
5. **잡음 이득 \(G_H\) 계산**
   - FIR: \(\sum h^2\)
   - IIR: \(\sum h[n]^2\) (안정할 때만)
6. **오버샘플링/노이즈 셰이핑**
   - A/D 대역 내 잡음이 문제라면 구조적 해결책이다.
7. **검증 지표**
   - SNR, THD+N, 잡음 PSD, corr(x,e), overload rate, limit-cycle 유무.

---

## 연습문제(예제 문제 + 풀이)

### 이상적 A/D SNR 계산

\(B=12\), \(X_{\max}=1\)인 균일 미드트레드 ADC에서
(1) \(\Delta\)를 구하고
(2) 이론 SNR을 구하라.

**풀이**

(1)
\[
\Delta=\frac{2X_{\max}}{2^B}
= \frac{2}{4096}
= 4.8828125\times 10^{-4}.
\]

(2)
\[
\mathrm{SNR}\approx 6.02B+1.76
=6.02\times 12+1.76
=74.0~\mathrm{dB}(근사).
\]
이 결과는 표준 양자화 SNR 식에서 바로 나온다.

---

### Octave로 SNR 측정

문제 1의 ADC를 사용해 풀스케일 사인파를 양자화하고 실측 SNR을 구해
이론값과 비교하라.

**풀이 코드**

```octave
clear; clc
Fs=48000; N=Fs; n=0:N-1; t=n/Fs;

B=12; Xmax=1; Delta=2*Xmax/(2^B);
f0=997.3;
x = 0.999*Xmax*sin(2*pi*f0*t);

y = q_mid_tread(x, Delta);
e = y - x;

SNR_meas = 10*log10(mean(x.^2)/mean(e.^2));
SNR_theo = 6.02*B + 1.76;
fprintf("Measured=%.2f dB | Theory=%.2f dB\n", SNR_meas, SNR_theo);
```

---

### FIR 잡음 이득 계산

FIR 계수가
\[
h=[0.2,\ 0.2,\ 0.2,\ 0.2,\ 0.2]
\]
(길이 5 이동평균)일 때 잡음 이득 \(G_H\)를 구하라.

**풀이**

\[
G_H=\sum_{k=0}^{4} h[k]^2
= 5\times (0.2)^2
=5\times 0.04
=0.20.
\]

즉, 입력 백색잡음 파워가 \(\sigma_e^2\)라면
\[
\sigma_{y_e}^2=0.2\,\sigma_e^2
\]
로 **출력 잡음이 줄어든다**(저역통과의 전형적 효과).

---

### FIR 내부 라운딩 SNR vs F

§8의 FIR 내부 라운딩 실험에서
\(F=8,10,12,14\)일 때 라운딩 잡음 SNR을 비교하라.

**풀이 코드**

```octave
clear; clc; pkg load signal
Fs=48000; N=Fs/2; n=0:N-1; t=n/Fs;
x = 0.7*sin(2*pi*1000*t) + 0.2*randn(size(t));

M=63; fc=4000;
b = fir1(M, fc/(Fs/2), hamming(M+1));
y_float = filter(b,1,x);

for F=[8 10 12 14]
  y_fix = fir_fixed_round(b,x,F);
  e_round = y_fix - y_float;
  SNRr = 10*log10(var(y_float)/var(e_round));
  fprintf("F=%2d -> roundoff SNR=%.2f dB\n", F, SNRr);
end
```

결과에서 \(F\)가 2비트 늘 때마다 SNR이 대략 12 dB 근방씩 좋아지는 경향을 확인할 수 있다(필터·신호에 따라 약간 변동).

---

### IIR limit cycle 유무 판정

§9 실험에서 \(F=8,10,12\)로 바꿔
무입력 상태에서 limit cycle이 사라지는 임계 \(F\)를 찾아라.

**풀이 힌트**

- 같은 코드에서 \(F\)만 바꿔 `plot(y_fix)`를 관찰한다.
- limit cycle은 “잡음처럼 보이는 작은 진동이 장시간 지속”되는 형태다.
- 안정한 필터라도 **정밀도가 낮으면** 한정 주기 진동이 남을 수 있다.

---

### 오버샘플링 SNR 향상 측정

\(B=8\) ADC에서 OSR=1,2,4,8로 오버샘플링 후
박스카 저역통과+디시메이션을 하면
SNR이 어떻게 변하는지 측정하라.

**풀이 코드**

```octave
clear; clc

B=8; Xmax=1; Delta=2*Xmax/(2^B);
OSR_list=[1 2 4 8];

for OSR=OSR_list
  Fs=48000*OSR; N=Fs; n=0:N-1; t=n/Fs; f0=1000.3;
  x = 0.9*sin(2*pi*f0*t);

  y = q_mid_tread(x, Delta);
  e = y-x;

  R=OSR; b=ones(1,R)/R;
  elp = filter(b,1,e);
  ed  = elp(1:R:end);

  xdec = x(1:R:end);

  SNR = 10*log10(mean(xdec.^2)/mean(ed.^2));
  fprintf("OSR=%d -> SNR≈%.2f dB\n", OSR, SNR);
end
```

이론적으로 OSR이 2배면 SNR이 약 3 dB 좋아지는 “log(OSR)” 경향을 확인할 수 있다.

---

### truncation vs rounding 바이어스 비교

다음 두 양자화를 구현해
작은 DC 입력에서 평균 바이어스를 비교하라.

- truncation: \(Q_t(x)=\Delta\lfloor x/\Delta \rfloor\)
- rounding: \(Q_r(x)=\Delta\mathrm{round}(x/\Delta)\)

**풀이 코드**

```octave
function y = q_trunc(x, Delta)
  y = Delta * floor(x/Delta);
end

clear; clc
Delta=1/64;
dc = 0.3*Delta;
x = dc + 1e-6*randn(1,200000);

yt = q_trunc(x, Delta);
yr = q_mid_tread(x, Delta);

fprintf("mean bias trunc=%.3e\n", mean(yt-x));
fprintf("mean bias round=%.3e\n", mean(yr-x));
```

- truncation은 평균이 한쪽으로 치우쳐 바이어스가 더 크다.
- rounding은 평균이 0에 더 가까워진다.

---

## 결론

A/D 양자화 잡음은
\[
\sigma_e^2=\frac{\Delta^2}{12}, \quad
\mathrm{SNR}\approx 6.02B+1.76~\mathrm{dB}
\]
라는 “간단한 근사”로 시작하지만,
그 잡음이 **디지털 필터를 통과하며 어떻게 변형되는지**까지 연결하면
설계의 핵심 레버들이 보인다.

- **FIR**: 잡음 이득이 \(\sum h^2\)로 깔끔하게 계산되고 안정적.
- **IIR**: 피드백이 내부 라운딩 잡음까지 증폭 가능 → SOS/스케일링/라운딩/포화가 필수.
- **현대 ADC**: 오버샘플링·노이즈 셰이핑으로 대역 내 잡음 자체를 구조적으로 낮춘다.

이 글의 Octave 코드들을 직접 실행·변형하면서
“이론식 → 측정치 → 구조적 결정”이 자연스럽게 이어지는 감각을 잡는 것이 핵심이다.
