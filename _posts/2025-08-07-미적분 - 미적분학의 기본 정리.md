---
layout: post
title: 미적분 - 미적분학의 기본 정리
date: 2025-08-07 15:20:23 +0900
category: 미적분
---
# 미적분학의 기본 정리 (Fundamental Theorem of Calculus, FTC) — 완전 정리와 예제

> **핵심 요약**  
> - **제1기본정리(FTC1)**: 누적면적 함수 \( F(x)=\displaystyle\int_{a}^{x} f(t)\,dt \)는 \(F'(x)=f(x)\) (적어도 \(f\)가 그 점에서 연속이면).  
> - **제2기본정리(FTC2)**: \(\displaystyle\int_{a}^{b} f(x)\,dx = F(b)-F(a)\) (여기서 \(F\)는 \(f\)의 아무 원시함수).

---

## 0) 직관과 큰 그림

- **누적면적 함수** \(F(x)\)를 생각하자. \(x\)가 조금 증가하면 새로 쌓이는 면적은 대략 \(f(x)\cdot \Delta x\).  
  → 증가율 \(\dfrac{F(x+\Delta x)-F(x)}{\Delta x}\)는 \(\Delta x\to 0\)에서 \(f(x)\)로 수렴.  
- 반대로 한 구간의 총 누적량(면적)은 **원시함수의 값 차**로 주어진다.

---

## 1) 제1기본정리 (FTC Part 1)

### 정리(표준형)
\(f\)가 \([a,b]\)에서 연속일 때
$$
F(x) \;=\; \int_{a}^{x} f(t)\,dt
$$
는 \([a,b]\)에서 연속, \((a,b)\)에서 미분 가능이며
$$
F'(x)=f(x).
$$

### 증명 아이디어(해석적 스케치)
증명의 핵심은 차분 몫을 다음처럼 쪼개는 것:
$$
\frac{F(x+h)-F(x)}{h}
=\frac{1}{h}\int_{x}^{x+h} f(t)\,dt.
$$
연속함수 \(f\)는 구간 \([x,x+h]\)에서 거의 상수처럼 보인다(평균값정리 또는 극한의 직관).  
따라서 위 식은 \(h\to 0\)에서 \(f(x)\)로 수렴한다.

### 중요 확장(불연속 허용)
- \(f\)가 **리만 적분 가능**이면 \(F(x)=\int_{a}^{x} f(t)\,dt\)는 **절대연속(AC)**이고,  
  \(F'(x)=f(x)\)가 **거의 모든 점(a.e.)**에서 성립한다(레베그 관점).  
- 실전에서는 “**연속점에서는 \(F'(x)=f(x)\)**”로 기억하면 충분하다.

### 예제 A (기본)
$$
f(t)=\cos t,\qquad F(x)=\int_{0}^{x}\cos t\,dt=\sin x
\ \Rightarrow\ F'(x)=\cos x=f(x).
$$

### 예제 B (가변 상한, 체인룰 포함)
아래와 같은 \(G\)에 대해:
$$
G(x)=\int_{1}^{x^2}\ln t\,dt.
$$
\(F(u)=\int_{1}^{u}\ln t\,dt\)라 두면 \(G(x)=F(x^2)\). 체인룰로
$$
G'(x)=F'(x^2)\cdot 2x=\ln(x^2)\cdot 2x=4x\ln x\quad(x>0).
$$
(\(x<0\)일 때는 \(\ln(x^2)=2\ln|x|\)를 써서 동일 결론)

---

## 2) 제2기본정리 (FTC Part 2)

### 정리(뉴턴–라이프니츠 공식)
\(f\)가 \([a,b]\)에서 연속이고 \(F\)가 \(f\)의 원시함수(\(F'=f\))이면
$$
\int_{a}^{b} f(x)\,dx=F(b)-F(a).
$$

### 증명 아이디어
분할–상한/하한합(리만합)의 극한과 원시함수의 평균값정리/망분할 정교화로 얻는다.  
핵심은 “미분과 적분의 역관계”를 엄밀화했다는 점.

### 실전 효용
복잡한 면적/누적량 적분을 **원시함수**만 알면 빠르게 계산 가능.

### 예제 C
$$
\int_{1}^{3} 2x\,dx = \big[x^2\big]_{1}^{3} = 9-1=8.
$$

---

## 3) “가변 하한/상한 + 매개변수” — **라이프니츠 미분법칙**

함수 \(a(x),b(x)\)가 미분 가능하고 \(f(x,t)\)가 적당히 매끈하면
$$
\frac{d}{dx}\,\int_{a(x)}^{b(x)} f(x,t)\,dt
= f\big(x,b(x)\big)\,b'(x)-f\big(x,a(x)\big)\,a'(x)\;+\;\int_{a(x)}^{b(x)} \frac{\partial f}{\partial x}(x,t)\,dt.
$$

- **상한/하한이 상수**이면 경계항 한쪽만 남는다.
- **\(f\)**가 \(x\)에 의존하지 않으면 마지막 항(\(\partial f/\partial x\) 적분)은 0.

### 예제 D (경계도 \(x\)에 의존, integrand도 \(x\) 의존)
$$
H(x)=\int_{\sin x}^{x^2}\,\big(t^3 + x\,t\big)\,dt.
$$
여기서 \(f(x,t)=t^3+x\,t\), \(a(x)=\sin x\), \(b(x)=x^2\).  
\(\partial f/\partial x = t\). 라이프니츠 법칙에 의해
$$
\begin{aligned}
H'(x)
&= f\big(x, x^2\big)\cdot (2x)\;-\;f\big(x,\sin x\big)\cdot (\cos x)\;+\;\int_{\sin x}^{x^2} t\,dt\\
&= \big((x^2)^3 + x\cdot x^2\big)\cdot 2x\;-\;\big((\sin x)^3 + x\sin x\big)\cos x\;+\;\frac{1}{2}\big(x^4 - \sin^2 x\big).
\end{aligned}
$$

---

## 4) FTC가 뒷받침하는 두 ‘기술’ — **치환 적분**과 **부분적분**

### 4.1 치환 적분(변수변환)
\(u=g(x)\)가 미분 가능, \(f\)가 연속이면
$$
\int_{x=a}^{x=b} f\big(g(x)\big)\,g'(x)\,dx = \int_{u=g(a)}^{u=g(b)} f(u)\,du.
$$
- **증명 스케치**: \(F'(u)=f(u)\)인 \(F\)를 생각. \(F(g(x))'\!=f(g(x))g'(x)\).  
  FTC2로 \(\int_a^b f(g(x))g'(x)\,dx = F(g(b))-F(g(a))\).

### 4.2 부분적분(적분의 곱의 미분 공식)
\(u=u(x), v=v(x)\)가 미분 가능이면
$$
\int_a^b u\,dv = \big[uv\big]_a^b - \int_a^b v\,du.
$$
- **증명 스케치**: \((uv)' = u'v + uv'\)에 FTC2 적용.

---

## 5) 평균값 정리(적분형)과 부등식

- **적분의 평균값 정리(MVT for integrals)**:  
  \(f\)가 \([a,b]\)에서 연속이면 \(\exists c\in(a,b)\) s.t.
  $$
  \int_{a}^{b} f(x)\,dx = f(c)\,(b-a).
  $$
- **적분 부등식**: \(m\le f(x)\le M\Rightarrow m(b-a)\le \int_a^b f \le M(b-a)\).  
  즉, \(\dfrac{1}{b-a}\int_a^b f\)는 \([m,M]\)에 있다.

---

## 6) 조건과 함정(실전 체크리스트)

1. **연속성**:  
   - FTC1의 미분 등식은 **연속점에서** 확실. (불연속점에선 \(F'\)가 없을 수 있음)  
   - FTC2는 구간 연속이면 그대로 적용.
2. **부호와 절댓값**:  
   - 정적분은 **부호 있는 누적량**, 면적 자체는 \(\int |f|\)로 계산.  
3. **변경되는 경계**:  
   - \(\int_{g(x)}^{h(x)} f(t)\,dt\)의 미분은 **경계의 미분**이 곱으로 붙는다(라이프니츠).
4. **기준점(하한)의 이동**:  
   - \(F_c(x)=\int_{c}^{x} f\)는 \(c\)에 따라 **상수만** 달라진다. (원시함수의 불정정 상수)
5. **대칭 이용**:  
   - 짝/홀 함수의 \([-a,a]\) 적분: 홀은 0, 짝은 \(2\int_{0}^{a}\).

---

## 7) 풀이 예제 모음

### 예제 1 — 기본형 미분
$$
F(x)=\int_{2}^{x} \sqrt{1+t^4}\,dt
\quad\Rightarrow\quad
F'(x)=\sqrt{1+x^4}.
$$

### 예제 2 — 상한이 \(x^3\)(체인룰)
$$
G(x)=\int_{2}^{x^3} \sqrt{1+t^4}\,dt
\Rightarrow
G'(x)=\sqrt{1+(x^3)^4}\cdot 3x^2=3x^2\sqrt{1+x^{12}}.
$$

### 예제 3 — 구간 적분(FTC2)
$$
\int_{0}^{\pi} \sin x\,dx = [-\cos x]_{0}^{\pi} = (-\cos\pi)-(-\cos 0)=2.
$$

### 예제 4 — 부분적분 유도
$$
\int x e^x\,dx
\overset{\text{IBP}}{=}
x e^x - \int 1\cdot e^x\,dx
= x e^x - e^x + C.
$$

### 예제 5 — 라이프니츠(경계·매개변수 모두)
$$
H(x)=\int_{\ln x}^{x^2}\big(\,t^2 + x\,\sin t\,\big)\,dt.
$$
\(\partial f/\partial x = \sin t\).  
따라서
$$
\begin{aligned}
H'(x)
&= \big( (x^2)^2 + x\sin(x^2) \big)\cdot (2x) 
- \big( (\ln x)^2 + x\sin(\ln x) \big)\cdot \frac{1}{x}\\
&\quad + \int_{\ln x}^{x^2} \sin t\,dt\\
&= 2x^5 + 2x^2\sin(x^2) - \frac{(\ln x)^2}{x} - \sin(\ln x) + \big[-\cos t\big]_{\ln x}^{x^2}\\
&= 2x^5 + 2x^2\sin(x^2) - \frac{(\ln x)^2}{x} - \sin(\ln x) + \big(-\cos(x^2)+\cos(\ln x)\big).
\end{aligned}
$$

### 예제 6 — 불연속점 주의(FTC1의 적용범위)
$$
f(x)=\begin{cases}
1,&x>0\\
0,&x\le 0
\end{cases},\quad F(x)=\int_{-1}^{x} f(t)\,dt
=\max\{0,x\}+1\ \text{(형태상)}.
$$
- \(x>0\): \(F'(x)=1=f(x)\)  
- \(x<0\): \(F'(x)=0=f(x)\)  
- \(x=0\): \(F\)는 **미분 불가**(좌우기울기 다름), \(f\) 불연속점.

---

## 8) 시각화·수치 예제 코드 (Python)

> 아래 코드는 교육용 예시. 실제 실행에는 `numpy`, `matplotlib`, `sympy`가 필요합니다.

### 8.1 FTC1 수치 확인: \(F'(x)\approx f(x)\)
```python
import numpy as np
import matplotlib.pyplot as plt

# f(t) = e^{-t^2}, F(x) = ∫_0^x f(t) dt
def f(t): return np.exp(-t**2)

# 수치적분(사다리꼴)로 F(x) 근사
def F(xs):
    vals = np.zeros_like(xs, dtype=float)
    for i, x in enumerate(xs):
        ts = np.linspace(0, x, 2001)
        vals[i] = np.trapz(f(ts), ts)
    return vals

xs = np.linspace(-2, 2, 121)
Fx = F(xs)

# F'(x) ≈ 전진/중심차분
dx = xs[1] - xs[0]
Fprime = np.gradient(Fx, dx)

plt.plot(xs, Fprime, label="Numerical F'(x)")
plt.plot(xs, f(xs), '--', label='f(x) = exp(-x^2)')
plt.legend(); plt.grid(True); plt.title("FTC1: F'(x) ≈ f(x)")
plt.show()
```

### 8.2 라이프니츠 법칙 확인 (심볼릭)
```python
import sympy as sp

x, t = sp.symbols('x t', positive=True)
f = t**2 + x*sp.sin(t)
a = sp.log(x)
b = x**2

H = sp.integrate(f, (t, a, b))
dH = sp.diff(H, x)

# Leibniz RHS
rhs = f.subs(t, b)*sp.diff(b, x) - f.subs(t, a)*sp.diff(a, x) + sp.integrate(sp.diff(f, x), (t, a, b))
print(sp.simplify(dH - rhs))  # 0이면 일치
```

---

## 9) 실전 문제풀이 루틴

1. **형태 인식**:  
   - 단순 \(\displaystyle \int_a^x f\)의 미분? → FTC1.  
   - \(\displaystyle \int_{g(x)}^{h(x)}\) 형태? → 라이프니츠.  
   - 단순한 정적분? → FTC2(원시함수) + 치환/부분적분.
2. **경계와 부호**:  
   - 상한<하한이면 부호 반전: \(\int_b^a = -\int_a^b\).  
   - 대칭·홀짝 활용으로 계산 단순화.
3. **연속성 체크**:  
   - 미분(FTC1) 시 불연속점에서의 주의.  
   - 적분(FTC2)은 구간 연속이면 표준 적용.
4. **검증**:  
   - 결과를 미분해 원 integrand가 나오는지 확인(치환/부분적분 후 권장).

---

## 10) 요약 표

| 구분 | 내용 | 코멘트 |
|---|---|---|
| **FTC1** | \(F(x)=\displaystyle\int_a^x f(t)\,dt \Rightarrow F'(x)=f(x)\) | \(f\) 연속점에서 확실, 일반론으론 a.e. 성립 |
| **FTC2** | \(\displaystyle\int_a^b f = F(b)-F(a)\) | \(F'=f\)인 원시함수 아무거나 |
| **치환** | \(\displaystyle\int f(g)g' = \int f\) | FTC+체인룰의 직접 결과 |
| **부분적분** | \(\displaystyle\int u\,dv = uv - \int v\,du\) | 곱의 미분 공식 + FTC |
| **라이프니츠** | \(\dfrac{d}{dx}\!\int_{a(x)}^{b(x)} f(x,t)\,dt\) 공식 | 경계 미분 + \(\partial/\partial x\) 적분 |

---

### 맺음말
미적분학의 기본 정리는 **미분(순간 변화)**과 **적분(누적 변화)**를 단단히 연결해,  
복잡해 보이는 문제를 **원시함수의 차** 또는 **미분 한 번**으로 바꿔준다.  
실전에서는 **FTC1/2 + 치환/부분적분 + 라이프니츠** 조합으로 거의 모든 “기본 미적분”을 제압할 수 있다.