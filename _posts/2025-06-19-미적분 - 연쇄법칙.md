---
layout: post
title: 미적분 - 연쇄법칙
date: 2025-06-19 19:20:23 +0900
category: 미적분
---
# 연쇄법칙 (Chain Rule)

합성함수 $$y=f(g(x))$$ 를 미분하려면 **연쇄법칙**이 필수입니다.  
핵심 문장은 단 한 줄:
$$
\boxed{\displaystyle \frac{d}{dx}\,f\!\big(g(x)\big)=f'\!\big(g(x)\big)\cdot g'(x)}
$$
(모든 수식은 $$\cdots$$, 코드는 ```로 감쌉니다.)

---

## ✅ 1) 직관과 해석

- 흐름: $$x \xrightarrow{\,g\,} u=g(x)\xrightarrow{\,f\,} y=f(u)$$  
- 작은 변화 $$\Delta x$$ 가 $$\Delta u\approx g'(x)\Delta x$$ 를 만들고,  
  다시 $$\Delta y\approx f'(u)\Delta u \approx f'(g(x))\,g'(x)\,\Delta x$$.  
- 그래서 순간 변화율은 곱으로 연결됩니다.

---

## ✅ 2) 기본 형태 (단변수)

외부 함수 $$f$$, 내부 함수 $$g$$ 가 모두 미분 가능하면
$$
\frac{d}{dx}f(g(x))=f'(g(x))\,g'(x).
$$

**기억법**: “**밖을 미분한 뒤, 안을 곱한다.**” (Outside then multiply by inside derivative)

---

## ✅ 3) 표준 예제 풀이

### 예제 1: $$y=\sin(x^2)$$
- 외부: $$f(u)=\sin u\Rightarrow f'(u)=\cos u$$  
- 내부: $$g(x)=x^2\Rightarrow g'(x)=2x$$  
- 결과:
  $$
  y'=\cos(x^2)\cdot 2x.
  $$

### 예제 2: $$y=\sqrt{3x+1}=(3x+1)^{1/2}$$
$$
y'=\tfrac12(3x+1)^{-1/2}\cdot 3=\frac{3}{2\sqrt{3x+1}}.
$$

### 예제 3: $$y=e^{\tan x}$$
$$
y'=e^{\tan x}\cdot \sec^2 x.
$$

### 예제 4: $$y=\ln(\cos x)$$
$$
y'=\frac{1}{\cos x}\cdot(-\sin x)=-\tan x.
$$

---

## ✅ 4) 다단계(중첩) 합성

합성이 여러 겹이면 **연쇄법칙을 반복**합니다.

### 예제 5: $$y=\sin^3 x=(\sin x)^3$$
- $$y=(u)^3,\ u=\sin x$$  
- $$\dfrac{dy}{du}=3u^2,\ \dfrac{du}{dx}=\cos x$$  
- 결과:
  $$
  y'=3(\sin x)^2\cos x=\sin(2x)\sin x.
  $$

### 예제 6: $$y=\cos\!\big(\sqrt{1+x^2}\big)$$
- $$u=\sqrt{1+x^2},\quad y=\cos u$$  
- $$y'=-\sin u\cdot u',\quad u'=\frac{1}{2}(1+x^2)^{-1/2}\cdot 2x=\frac{x}{\sqrt{1+x^2}}$$  
- 결과:
  $$
  y'=-\sin\!\big(\sqrt{1+x^2}\big)\cdot\frac{x}{\sqrt{1+x^2}}.
  $$

---

## ✅ 5) 곱·몫과 함께 쓰기

연쇄법칙은 곱/몫과 자주 결합됩니다.

### 예제 7 (곱): $$y=x\,\cos(x^2)$$
$$
y'=1\cdot\cos(x^2)+x\cdot\big(-\sin(x^2)\cdot 2x\big)
=\cos(x^2)-2x^2\sin(x^2).
$$

### 예제 8 (몫): $$y=\dfrac{\sin(3x)}{x^2+1}$$
$$
y'=\frac{\ 3\cos(3x)\,(x^2+1)-\sin(3x)\cdot 2x\ }{(x^2+1)^2}.
$$

---

## ✅ 6) 로그 미분과 연쇄법칙

**목적**: 곱/거듭제곱/복잡한 합성에서 구조를 단순화.

### 예제 9: $$y=\big(\sin x\big)^{\!\sqrt{x}}\ (x>0)$$
- 양변 로그:
  $$
  \ln y=\sqrt{x}\,\ln(\sin x).
  $$
- 미분:
  $$
  \frac{y'}{y}=\frac{1}{2\sqrt{x}}\ln(\sin x)+\sqrt{x}\cdot\frac{\cos x}{\sin x}.
  $$
- 정리:
  $$
  y'=\big(\sin x\big)^{\!\sqrt{x}}\!\left(\frac{\ln(\sin x)}{2\sqrt{x}}+\sqrt{x}\cot x\right).
  $$

---

## ✅ 7) 역함수/암시적 미분과의 연결

### 7.1 역함수
$$
y=f^{-1}(x)\ \Rightarrow\ (f^{-1})'(x)=\frac{1}{f'(f^{-1}(x))}.
$$
**연쇄법칙**으로 $$f(f^{-1}(x))=x$$ 를 미분해 얻습니다.

### 7.2 암시적 미분
$$
F(x,y)=0\ \Rightarrow\ \frac{dy}{dx}=-\frac{F_x}{F_y}.
$$
여기서도 $$y=y(x)$$ 로 보고 **연쇄법칙**을 적용합니다.

---

## ✅ 8) 다변수 연쇄법칙(선택)

$$
z=f(x,y),\quad x=x(t),\ y=y(t)\ \Rightarrow\
\frac{dz}{dt}=f_x\,\frac{dx}{dt}+f_y\,\frac{dy}{dt}.
$$

일반형(벡터 표시):
$$
\frac{d}{dt}f(\mathbf{u}(t))=\nabla f(\mathbf{u}(t))\cdot \mathbf{u}'(t).
$$

---

## ✅ 9) 시각화 코드 (직접 확인)

```python
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-2*np.pi, 2*np.pi, 600)
y = np.sin(x**2)
dy = 2*x * np.cos(x**2)  # chain rule

plt.plot(x, y, label='y = sin(x^2)')
plt.plot(x, dy, '--', label="y' = 2x·cos(x^2)")
plt.title('합성함수와 도함수 (Chain Rule)')
plt.legend(); plt.grid(True); plt.show()
```

---

## ✅ 10) 자주 하는 실수 체크리스트

- [ ] **연쇄 곱**을 빠뜨리지 않았는가? (예: $$\sin(g(x))'=\cos(g(x))\,g'(x)$$)  
- [ ] **정의역**을 확인했는가? (예: $$\ln(\cos x)$$ 는 $$\cos x>0$$ 에서만 실수값)  
- [ ] 곱/몫/합성과 **순서**를 혼동하지 않았는가?  
- [ ] **여러 겹 합성**은 단계별로 명확히 변수 치환했는가?  
- [ ] 로그 미분 후 **원래 함수 곱하기**를 잊지 않았는가?

---

## ✅ 11) 연습문제 (짧은 해설)

1) $$y=\cos(5x^2-3x)$$  
   ⇒ $$y'=-\sin(5x^2-3x)\cdot(10x-3).$$

2) $$y=\sqrt{1+\sin(2x)}$$  
   ⇒ $$y'=\frac{1}{2\sqrt{1+\sin(2x)}}\cdot(2\cos(2x))=\frac{\cos(2x)}{\sqrt{1+\sin(2x)}}.$$

3) $$y=\ln\!\big((x^2+1)^3\big)$$  
   ⇒ $$y'=\frac{1}{(x^2+1)^3}\cdot 3(x^2+1)^2\cdot 2x=\frac{6x}{x^2+1}.$$

4) $$y=e^{\,x\sin x}$$  
   ⇒ $$y'=e^{\,x\sin x}\cdot(\sin x+x\cos x).$$

5) $$y=\dfrac{\tan(3x)}{\sqrt{x}}$$  
   ⇒ 곱/연쇄/몫 결합:
   $$
   y'=\frac{3\sec^2(3x)\sqrt{x}-\tan(3x)\cdot\frac{1}{2\sqrt{x}}}{x}.
   $$
   (또는 $$x^{-1/2}\tan(3x)$$ 로 보고 곱의 미분)

---

## 요약

- **한 줄 공식**: $$\dfrac{d}{dx}f(g(x))=f'(g(x))\,g'(x)$$  
- **전략**: 겉(외부) 미분 → 값은 **그대로 대입** → **내부 도함수 곱**  
- 곱·몫·로그 미분·암시적/역함수 미분에서도 **연쇄법칙이 중심**입니다.  
- 복잡해 보이면 **치환 변수**(예: $$u=g(x)$$)로 단계별로 푸세요.