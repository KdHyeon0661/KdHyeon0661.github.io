---
layout: post
title: 이산수학 - 함수
date: 2025-05-21 19:20:23 +0900
category: 이산수학
---
# 함수(Function)란 무엇인가?

## 한눈에 보기(로드맵)

- 함수는 **관계**의 특수한 경우: 각각의 입력에 **정확히 하나**의 출력을 대응.
- 핵심 용어: **정의역** $$\mathrm{dom}(f)$$, **공역** $$\mathrm{cod}(f)$$, **치역**(이미지) $$\mathrm{im}(f)=f(A)$$, **원상**(프리이미지) $$f^{-1}(S)$$.
- 유형: **단사/전사/전단사**, **전사 ⇔ 치역=공역**, **역함수**는 전단사일 때만 함수로서 존재.
- 합성은 결합적, 항등함수가 단위 원소. 단사/전사 성질은 합성에 대해 잘 **보존/전달**된다.
- 유한집합에 대해 함수 개수는 $$|B|^{|A|}$$, 전단사 개수는 $$|A|!$$(정의역=공역 크기 같을 때).

---

## 함수의 형식적 정의와 관계 관점

**정의.** 집합 $$A,B$$ 에 대해, **함수** $$f:A\to B$$ 는 다음 두 조건을 만족하는 **이항 관계** $$G\subseteq A\times B$$ 이다.

1) **존재성:** 모든 $$a\in A$$ 에 대해 $$\exists b\in B: (a,b)\in G$$.
2) **유일성:** $$a\in A$$ 에 대해 $$ (a,b_1),(a,b_2)\in G \Rightarrow b_1=b_2$$.

보통 함수 자체를 그 **그래프** $$G=\{(a,f(a))\mid a\in A\}$$ 로 동일시한다.

- 정의역: $$\mathrm{dom}(f)=A$$
- 공역: $$\mathrm{cod}(f)=B$$
- 치역(이미지): $$\mathrm{im}(f)=f(A)=\{f(a)\mid a\in A\}\subseteq B$$

**함수의 동등성:** $$f=g \iff (\forall a\in A)\ f(a)=g(a)$$ (외연성 원리).

**예시.**
```text
f: ℤ → ℤ,  f(x)=2x+1
g: ℤ → ℤ,  g(x)=x^2
h: {1,2,3} → {A,B},  h(1)=A, h(2)=B, h(3)=A
```
- 여러 입력이 같은 출력으로 가는 것은 허용(유일성은 **출력의 유일성**, **입력의 유일성**이 아님).
- 하나의 입력에 두 개 이상의 출력이 대응되면 **함수가 아니다**.

---

## 기본 용어와 표기

**이미지/원상(프리이미지).** $$S\subseteq A, T\subseteq B$$ 에 대해
$$
f(S)=\{f(x)\mid x\in S\}\subseteq B,\qquad
f^{-1}(T)=\{x\in A\mid f(x)\in T\}\subseteq A.
$$
- **원상**은 항상 정의되며, **항상** 다음 분배 법칙을 만족:
  $$
  f^{-1}(T_1\cup T_2)=f^{-1}(T_1)\cup f^{-1}(T_2),\quad
  f^{-1}(T_1\cap T_2)=f^{-1}(T_1)\cap f^{-1}(T_2),\quad
  f^{-1}(T^c)=\big(f^{-1}(T)\big)^c.
  $$
  *증명(첫째)*: $$x\in f^{-1}(T_1\cup T_2)\iff f(x)\in T_1\cup T_2\iff f(x)\in T_1\ \text{or}\ f(x)\in T_2\iff x\in f^{-1}(T_1)\ \text{or}\ x\in f^{-1}(T_2).$$

- 반면 **이미지**는 일반적으로
  $$
  f(S_1\cap S_2)\subseteq f(S_1)\cap f(S_2)
  $$
  이며 등호가 항상 성립하지는 않는다(반례: 상수함수).

**섬유(피버/fiber).** $$b\in B$$ 에 대한 원상 $$f^{-1}(\{b\})$$ 를 **섬유**라 부른다.

---

## 함수의 예시와 비예시

**예시 1.**
$$
f:\{1,2,3\}\to\{A,B,C\},\quad f(1)=A,\ f(2)=B,\ f(3)=A.
$$
- 허용: 서로 다른 입력이 같은 출력(A)에 매핑.

**비예시.**
$$
R=\{(2,1),(2,3)\}\subseteq\mathbb{N}\times\mathbb{N}.
$$
- 2가 두 출력을 갖는다. **함수 아님**.

---

## 함수의 유형

### 단사(Injective)

$$
(\forall a_1\ne a_2)\ f(a_1)\ne f(a_2)\quad\text{또는}\quad f(a_1)=f(a_2)\Rightarrow a_1=a_2.
$$
예: $$f(x)=2x$$ (정수→정수) 는 단사.

### 전사(Surjective)

$$
\mathrm{im}(f)=B \quad(\text{모든 } b\in B \text{에 대해 } \exists a\in A: f(a)=b).
$$
예: $$f:\mathbb{R}\to[0,\infty),\ f(x)=x^2$$ 는 **공역을** $$[0,\infty)$$ 로 잡으면 전사.

### 전단사(Bijective)

단사이면서 전사. **역함수** $$f^{-1}:B\to A$$ 가 존재:
$$
f^{-1}(f(x))=x,\quad f(f^{-1}(y))=y.
$$

### 기타 성질(이산 관점에서 자주 등장)

- **상수함수**: $$f(x)=c$$. 전사가 되려면 공역이 한 점 집합.
- **항등함수** $$\mathrm{id}_A:A\to A,\ \mathrm{id}_A(x)=x$$.
- **멱등**: $$f(f(x))=f(x)$$.
- **대칭( involution )**: $$f(f(x))=x$$ ⇒ 자동으로 전단사.
- **단조성**(순서가 있는 집합에서): $$x\le y\Rightarrow f(x)\le f(y)$$ 등.

---

## 합성과 항등, 성질의 전달

**합성.** $$f:A\to B,\ g:B\to C,\ (g\circ f)(x)=g(f(x))$$
- **결합법칙**: $$h\circ(g\circ f)=(h\circ g)\circ f$$.
- **항등의 단위성**: $$f\circ \mathrm{id}_A=f=\mathrm{id}_B\circ f$$.
- **성질 전달**
  - $$g\circ f$$ 가 **단사** ⇒ $$f$$ 가 단사(왼쪽 소거 가능).
    *스케치*: $$f(a_1)=f(a_2)\Rightarrow g(f(a_1))=g(f(a_2)) \Rightarrow a_1=a_2.$$
  - $$g\circ f$$ 가 **전사** ⇒ $$g$$ 가 전사(오른쪽 소거 가능).
  - **단사의 합성은 단사**, **전사의 합성은 전사**, **전단사의 합성은 전단사**.

**좌/우역함수.**
- **좌역함수**: $$\ell:B\to A,\ \ell\circ f=\mathrm{id}_A \Rightarrow f$$ 단사.
- **우역함수**: $$r:B\to A,\ f\circ r=\mathrm{id}_B \Rightarrow f$$ 전사.
- 좌/우역함수가 모두 존재하면 **유일한 역함수**로 일치한다.

---

## 역함수와 역관계

- 전단사 $$f$$ 에서만 **역함수** $$f^{-1}:B\to A$$ 가 실제로 **함수**.
- 임의의 관계로서의 **역관계** $$f^{\small\text{rel}\,-1}=\{(b,a)\mid (a,b)\in f\}$$ 는 항상 정의되지만, 함수가 되려면 $$f$$ 가 단사여야 하고(수평 선 검정), 전사여야 공역 전체로 정의된다.

**예시.**
$$
f(x)=2x+1:\mathbb{Z}\to\mathbb{Z}\ \text{전단사},\quad f^{-1}(y)=\frac{y-1}{2}.
$$
$$
g(x)=x^2:\mathbb{R}\to\mathbb{R}\ \text{전단사 아님},\ \text{역함수 없음.}
$$
단, 공역을 $$[0,\infty)$$ 로 제한하고 정의역을 $$[0,\infty)$$ 로 제한하면 전단사로 만들어 역함수 $$\sqrt{\cdot}$$ 확보 가능.

---

## 이미지/원상에 대한 법칙과 반례

- **원상 분배법칙(항상 등호)**:
  $$
  f^{-1}(T_1\cup T_2)=f^{-1}(T_1)\cup f^{-1}(T_2),\quad
  f^{-1}(T_1\cap T_2)=f^{-1}(T_1)\cap f^{-1}(T_2),\quad
  f^{-1}(T^c)=\big(f^{-1}(T)\big)^c.
  $$
- **이미지에 대한 포괄관계**:
  $$
  f(S_1\cap S_2)\subseteq f(S_1)\cap f(S_2),\quad
  f(S_1\cup S_2)= f(S_1)\cup f(S_2).
  $$
  첫 등식은 일반적으로 **진포함**일 수 있음.
  *반례*: 상수함수 $$f(x)=0$$ 에서 좌변은 $$\{0\}$$ 또는 공집합, 우변은 항상 $$\{0\}$$.

---

## 함수의 개수와 카디널리티 (유한 집합)

집합 $$|A|=m,\ |B|=n$$ 일 때
- **모든 함수** $$A\to B$$ 의 개수: $$n^m$$.
- **단사** 개수( $$m\le n$$ ): $$n\cdot(n-1)\cdots (n-m+1)=\dfrac{n!}{(n-m)!}$$.
- **전단사(순열)** 개수( $$m=n$$ ): $$n!$$.
- **전사** 개수( $$m\ge n$$ ): $$n!\, S(m,n)$$ (둘째종 스털링 수).

**비둘기집 원리(중요).** $$m>|B|=n$$ 이면 $$f:A\to B$$ 는 **단사 불가**.
$$m<n$$ 이면 전사 불가.

---

## 잘 정의됨(well-definedness)과 몫집합 위의 함수

**문제.** 등가류를 원소로 하는 몫집합 $$A/{\sim}$$ 에 함수
$$
\bar f: A/{\sim}\ \to C,\quad \bar f([x])=\Phi(x)
$$
를 정의할 때, **대표자 선택**에 의존하지 않아야 한다:
$$
x\sim y \Rightarrow \Phi(x)=\Phi(y).
$$

**예시 1(잘 정의됨).** $$\mathbb{Z}_n=\mathbb{Z}/{\equiv n}$$ 에서
$$
\bar f([x]_n)=[ax]_n
$$
은 항상 잘 정의(곱셈이 합동에 대해 호환).

**예시 2(잘 정의되지 않음).**
$$
\bar g([x]_n)=\text{“x의 최상위 10진수 자리”}
$$
는 대표자 선택에 따라 값이 달라질 수 있어 잘 정의되지 않는다.

---

## 제한·확장·부분함수

- **제한** $$f|_S:S\to B,\ f|_S(x)=f(x)\ (S\subseteq A)$$.
- **확장** $$\tilde f:T\to B,\ A\subseteq T,\ \tilde f|_A=f$$.
- **부분함수(Partial)**: 모든 입력에 값을 줄 필요는 없는 함수류.
  전통적 이산수학에서는 **전함수(total)** 를 기본으로 하나, 실제 프로그래밍에서는 예외/미정의가 빈번하여 부분함수 모델도 중요.

---

## 지시함수와 부분집합의 대응

어떤 우주 $$U$$ 에 대해 부분집합 $$A\subseteq U$$ 는 지시함수
$$
\mathbf{1}_A:U\to\{0,1\},\quad
\mathbf{1}_A(x)=\begin{cases}1&(x\in A)\\ 0&(x\notin A)\end{cases}
$$
와 일대일 대응한다.
집합 연산은 함수 연산으로 변환:
$$
\mathbf{1}_{A\cap B}=\min(\mathbf{1}_A,\mathbf{1}_B),\quad
\mathbf{1}_{A\cup B}=\max(\mathbf{1}_A,\mathbf{1}_B),\quad
\mathbf{1}_{A^c}=1-\mathbf{1}_A.
$$

---

## 실전 시나리오(정확성·설계 포인트)

- **해시 함수**: $$h: \text{키공간}\to\{0,\dots,m-1\}$$ 은 보통 단사 불가(출력공간이 작음). 충돌을 관리해야 한다.
- **암호 변환**: 원칙적으로 전단사(키가 고정되면 평문↔암호문 1:1) 구조가 바람직하다.
- **DB 키 매핑**: 기본키는 단사; 외래키는 전사성 요구와 연결될 수 있다(참조 무결성).
- **컴파일러**: 토큰 → 토큰종류는 전사(여러 토큰이 같은 종류), AST 노드 ↔ 소스 위치는 일반적으로 단사/전사 아님.

---

## 파이썬 실습

### 합성·역함수·단사/전사 판정

```python
from collections import defaultdict
from itertools import product

def compose(f, g):
    # (g ◦ f)(x) = g[f[x]]
    return {x: g[f[x]] for x in f if f[x] in g}

def is_injective(f):
    # f: dict A->B, total on its keys
    seen = {}
    for a, b in f.items():
        if b in seen and seen[b] != a:
            return False
        seen[b] = a
    return True

def is_surjective(f, codomain):
    return set(f.values()) == set(codomain)

def inverse_if_bijective(f, domain, codomain):
    if not (is_injective(f) and is_surjective(f, codomain) and set(f.keys()) == set(domain)):
        return None
    return {b: a for a, b in f.items()}

# 예시: 전단사

A = {1,2,3}
B = {'a','b','c'}
f = {1:'a', 2:'b', 3:'c'}
print(is_injective(f), is_surjective(f, B))  # True True
print(inverse_if_bijective(f, A, B))         # {'a':1, 'b':2, 'c':3}
```

### 이미지/원상 계산과 법칙 검증

```python
def image_of_subset(f, S):
    return {f[x] for x in S if x in f}

def preimage_of_subset(f, T):
    return {x for x, y in f.items() if y in T}

A = {1,2,3,4}
B = {'A','B'}
g = {1:'A', 2:'B', 3:'A', 4:'A'}
S1, S2 = {1,2}, {2,3}
T1, T2 = {'A'}, {'B'}

# 이미지 법칙

lhs = image_of_subset(g, S1 & S2)
rhs = image_of_subset(g, S1) & image_of_subset(g, S2)
print(lhs, rhs, lhs.issubset(rhs))  # 항상 ⊆

# 원상 분배

lhs1 = preimage_of_subset(g, T1 | T2)
rhs1 = preimage_of_subset(g, T1) | preimage_of_subset(g, T2)
print(lhs1 == rhs1)  # True
```

### 유한 집합에서 함수/단사/전사 개수

```python
from math import factorial
from functools import lru_cache

def num_functions(m, n):      # |A|=m, |B|=n
    return n**m

def num_injections(m, n):
    if m > n: return 0
    res = 1
    for k in range(n, n-m, -1):
        res *= k
    return res

def num_bijections(n):
    return factorial(n)

@lru_cache(None)
def stirling2(n, k):
    if n == k == 0: return 1
    if n == 0 or k == 0: return 0
    return k*stirling2(n-1,k) + stirling2(n-1,k-1)

def num_surjections(n, k):    # |A|=n, |B|=k
    if n < k: return 0
    return factorial(k) * stirling2(n, k)

print(num_functions(3, 2))      # 8
print(num_injections(3, 5))     # 60
print(num_bijections(4))        # 24
print(num_surjections(5, 2))    # 30
```

### 등가류 위의 함수가 **잘 정의**되었는지 테스트(모듈러 예시)

```python
def well_defined_mod(a, n, trials=100):
    # f([x]_n) = [a*x]_n
    # 임의의 동치 대표 x,y with x≡y (mod n) 에 대해 f([x])==f([y]) 인지 확인
    import random
    for _ in range(trials):
        x = random.randint(-1000, 1000)
        k = random.randint(-10, 10)
        y = x + k*n
        if (a*x - a*y) % n != 0:
            return False
    return True

print(well_defined_mod(a=7, n=12))  # True
```

---

## 자주 하는 실수와 체크리스트

- **치역 vs 공역 혼동**: 전사는 **치역=공역** 일 때. 치역은 공역의 부분집합일 수 있다.
- **역함수 남발**: 전단사가 아니면 역함수는 **관계**로만 존재할 뿐, 함수가 아닐 수 있다.
- **이미지 교집합 등호**: $$f(S_1\cap S_2)=f(S_1)\cap f(S_2)$$ 는 일반적으로 거짓.
- **비둘기집 원리 망각**: $$|A|>|B|$$ 에서 단사 불가.
- **공역 설계**: 응용에서 공역을 적절히 좁히거나 넓혀 **전사/전단사** 성질을 의도적으로 맞춰 역함수나 해석을 단순화.

---

## 연습문제(풀이 스케치 포함)

1) $$f:\mathbb{Z}\to\mathbb{Z},\ f(x)=3x-2$$ 가 단사임을 증명하라.
   *스케치*: $$f(a_1)=f(a_2)\Rightarrow 3a_1-2=3a_2-2\Rightarrow a_1=a_2.$$

2) $$g:\mathbb{R}\to[0,\infty),\ g(x)=x^2$$ 가 전사임을 보이고, 전단사가 되도록 **정의역**을 제한하라.
   *해*: 정의역을 $$[0,\infty)$$ 로 제한하면 전단사, 역함수 $$\sqrt{\cdot}$$.

3) $$f(A\cap B)\subseteq f(A)\cap f(B)$$ 의 반례를 들어 등호가 깨짐을 보이라.
   *반례*: 상수함수.

4) 유한집합 $$|A|=m, |B|=n$$ 에 대해 **전사** 함수 개수 $$n!\,S(m,n)$$ 를 조합적으로 설명하라.
   *스케치*: 원상 분할(스털링 수) 후 라벨링.

5) 좌역함수/우역함수의 존재가 각각 단사/전사를 함의함을 증명하라.
   *스케치*: $$\ell\circ f=\mathrm{id}_A$$ 이면 좌소거 가능. $$f\circ r=\mathrm{id}_B$$ 이면 임의 $$b\in B$$ 에 대해 $$b=f(r(b))$$.

6) 몫집합 $$\mathbb{Z}_n$$ 에서 $$\bar f([x])=[ax+b]$$ 가 잘 정의되려면 어떤 조건이 필요한가?
   *스케치*: 곱셈은 항상 호환, 상수항도 무관하므로 잘 정의. 역함수는 $$\gcd(a,n)=1$$ 일 때에만 존재.

---

## 요약

- 함수는 **입력마다 유일한 출력**을 대응하는 관계.
- **단사/전사/전단사**와 **합성/항등/역함수**가 함수론의 골격.
- **원상 분배법칙**은 항상 등호, 이미지 관련 등식은 주의.
- 유한집합에서는 함수/단사/전사/전단사 **개수 공식**으로 조합적 계산이 가능.
- 몫집합에서의 함수는 **잘 정의됨**이 핵심 체크 포인트.
- 실전(해시·암호·DB)에서도 함수 성질을 의식해 **정의역/공역 설계**를 하면 구조가 단순해지고, 역변환/검증이 용이해진다.
