---
layout: post
title: CSS - 크로스 브라우징
date: 2025-05-16 20:20:23 +0900
category: CSS
---
# 팁

## 최소 지원 정책(템플릿)

아래 표는 팀 합의 초안으로 바로 복사해 프로젝트 `README`에 넣어라.

| 층 | 브라우저 | 최소 버전 | 목표 |
|---|---|---|---|
| Core (필수) | Chrome/Edge(Blink), Firefox(Gecko), Safari(WebKit), iOS Safari | 최근 2~3 메이저 | 기능 온전, 레이아웃 안정, 접근성 준수 |
| Graceful (우회) | 구형 Android WebView, 구형 Samsung Internet | 최신-2 | 기능 제한 허용, 폴백 제공 |
| Out-of-scope | IE | 종료 | 접근 가능한 HTML, 단순 콘텐츠만 표시 가능해도 OK |

`browserslist` 예시:

```
last 2 chrome versions
last 2 firefox versions
last 2 edge versions
last 2 safari versions
iOS >= 14
Android >= 9
```

`package.json`에 포함:

```json
{
  "browserslist": [
    "last 2 chrome versions",
    "last 2 firefox versions",
    "last 2 edge versions",
    "last 2 safari versions",
    "iOS >= 14",
    "Android >= 9"
  ]
}
```

---

## 아키텍처 원칙

1) **표준 우선 + 점진 향상(Progressive Enhancement)**
- 기본 HTML 시맨틱, 접근 가능한 폼/네비게이션 → CSS/JS로 향상.
- 기능 감지(@supports, feature detection)로 신기능 사용 후 폴백 제공.

2) **빌드 파이프라인 자동화**
- Autoprefixer(접두사), Babel(ES 변환), Polyfill(필수 API) 자동 적용.

3) **논리 속성(Logical Properties) 우선**
- 국제화/RTL 대응을 위해 `margin-inline`, `padding-block`, `inset-inline` 등 사용.

4) **성능과 안정성 우선**
- transform/opacity 기반 애니메이션, layout thrashing 방지, 이미지 포맷 폴백.

5) **접근성은 기능과 동급**
- 포커스 링 보장, 명도 대비, 키보드/터치/스크린리더 경로 확인.

---

## HTML 기본: 시맨틱 + 접근성

### 시맨틱 구조

```html
<header role="banner"></header>
<nav aria-label="주 탐색"></nav>
<main id="content"></main>
<footer role="contentinfo"></footer>
```

- 스크린리더/검색/자동화 도구가 일관되게 해석.

### 폼 기본 + 폴백

```html
<form novalidate>
  <label for="email">이메일</label>
  <input id="email" name="email" type="email" required inputmode="email" autocomplete="email" />
  <small class="hint" id="emailHint">예: name@example.com</small>
  <button type="submit">제출</button>
</form>
```

- 구형 브라우저에서 `type=email`은 텍스트처럼 동작 → 서버/JS 검증 폴백 필요.
- 모바일 키패드 최적화: `inputmode`, `autocomplete` 지정.

---

## CSS: Reset/Normalize, 접두사, 논리 속성, 폴백

### 초기화

```css
/* 간결 리셋 */
* { box-sizing: border-box; }
html, body { margin: 0; padding: 0; }
img, video { max-width: 100%; height: auto; display: block; }
```

또는 Normalize.css를 포함해 기본 스타일 편차를 보정.

### Autoprefixer

```bash
npm i -D postcss autoprefixer postcss-cli
```

`postcss.config.js`:

```js
module.exports = {
  plugins: [require('autoprefixer')]
};
```

빌드:

```bash
postcss src/main.css -o dist/main.css
```

### 논리 속성으로 국제화/플립 대응

```css
.card {
  padding-block: 1rem;
  padding-inline: 1rem;
  border-inline-start: 4px solid var(--brand);
}
```

`LTR/RTL`에 따라 자동으로 좌우가 뒤바뀐다.

### 신기능 + 폴백(@supports)

```css
/* aspect-ratio 지원 시 */
@supports (aspect-ratio: 16 / 9) {
  .thumb { aspect-ratio: 16 / 9; object-fit: cover; }
}

/* 폴백: padding-bottom hack */
@supports not (aspect-ratio: 16 / 9) {
  .thumb {
    position: relative;
  }
  .thumb::before {
    content: "";
    display: block;
    padding-bottom: 56.25%;
  }
  .thumb > img {
    position: absolute; inset: 0;
    width: 100%; height: 100%; object-fit: cover;
  }
}
```

### iOS Safari의 100vh 이슈

```css
.hero {
  height: 100vh;        /* 기본 */
  height: 100dvh;       /* 신형 동적 뷰포트 */
  min-height: -webkit-fill-available; /* 구형 iOS 보정 */
}
```

부가적으로 JS 보정(필요 시):

```js
const setHero = () => {
  document.documentElement.style.setProperty(
    '--vh',
    `${window.innerHeight * 0.01}px`
  );
};
window.addEventListener('resize', setHero);
setHero();

/* CSS */
.hero { height: calc(var(--vh, 1vh) * 100); }
```

### Position: sticky + overflow 조합 버그 회피

- 조상에 `overflow: hidden/auto`가 있으면 `sticky`가 동작하지 않을 수 있음 → 해당 조상에 `overflow: visible` 혹은 레이아웃 재구성.

---

## JS: 트랜스파일, 폴리필, 이벤트 모델, 퍼포먼스

### Babel + Polyfill

```bash
npm i -D @babel/core @babel/cli @babel/preset-env core-js
```

`.babelrc`:

```json
{
  "presets": [
    ["@babel/preset-env", {
      "useBuiltIns": "usage",
      "corejs": "3.38"
    }]
  ]
}
```

- **useBuiltIns: usage** → 코드에 쓰인 기능만 폴리필 자동 주입.

### module/nomodule 패턴

```html
<script type="module" src="/app.mjs"></script>
<script nomodule src="/app.legacy.js" defer></script>
```

- 최신 브라우저는 ES Modules, 구형은 번들된 ES5 사용.

### 이벤트 호환: 터치/포인터/스크롤

```js
// 패시브 리스너로 스크롤 성능 개선
window.addEventListener('scroll', onScroll, { passive: true });

// 포인터 이벤트(마우스/펜/터치 통합)
el.addEventListener('pointerdown', onPointerDown);

// 터치 반응 개선
el.style.touchAction = 'manipulation';
```

- iOS에서 300ms 지연 문제는 대부분 해소되었지만 `touch-action` 지정은 여전히 유용.

### 필수 API 폴리필 후보

- `fetch`, `Promise`, `URL`, `IntersectionObserver`, `ResizeObserver`
- `Intl`(날짜/숫자 포매팅), `WeakRef`(선택)

간편 로딩:

```html
<script src="https://polyfill.io/v3/polyfill.min.js?features=default%2CIntersectionObserver"></script>
```

---

## 미디어/폰트/이미지 포맷 폴백

### 이미지

```html
<picture>
  <source type="image/avif" srcset="/img/hero.avif">
  <source type="image/webp" srcset="/img/hero.webp">
  <img src="/img/hero.jpg" width="1200" height="675" alt="히어로 이미지" loading="lazy" decoding="async">
</picture>
```

- AVIF/WebP 지원 시 우선 사용, 미지원이면 JPG 폴백.

### 비디오

```html
<video controls playsinline preload="metadata" poster="/poster.jpg">
  <source src="/movie.webm" type="video/webm">
  <source src="/movie.mp4" type="video/mp4">
  브라우저가 비디오를 지원하지 않습니다.
</video>
```

- 모바일 자동재생 정책: `muted` + `playsinline` 조건 충족 필요.

### 웹폰트

```css
@font-face{
  font-family: "Inter Var";
  src: url("/fonts/Inter-Variable.woff2") format("woff2-variations");
  font-weight: 100 900;
  font-display: swap;
}
:root { --font-sans: "Inter Var", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
body { font-family: var(--font-sans); }
```

- `font-display: swap`으로 FOUT 최소화. 시스템 폰트 스택 폴백 제공.

---

## 폼/입력 컨트롤 차이와 폴백

### HTML5 입력 타입

```html
<input type="date" />
<input type="time" />
<input type="color" />
```

- Safari/Firefox의 UI 차이가 큼. **접근 가능한 레이블/설명** 제공.
- 구형 브라우저에서 일반 텍스트로 동작 → 서버/JS로 보조.

### 파일/드래그앤드롭

- 브라우저마다 드롭존/미리보기 정책 차이 → `accept`/`multiple`/`size` 체크 JS로 통일.

### 자동 완성/패스워드 관리자

- `autocomplete` 명세 값 사용: `"username"`, `"current-password"`, `"one-time-code"` 등.

---

## 반응형/뷰포트/안전영역

### Viewport 메타

```html
<meta name="viewport" content="width=device-width, initial-scale=1">
```

- 이 설정이 없으면 모바일에서 축소 렌더링.

### iOS 안전영역

```css
.header {
  padding-top: max(1rem, env(safe-area-inset-top));
}
```

- 노치/홈 인디케이터 영역과 충돌 방지.

### 스크롤 스냅 + 폴백

```css
@supports (scroll-snap-type: x mandatory) {
  .carousel {
    scroll-snap-type: x mandatory;
    overflow-x: auto;
  }
  .slide { scroll-snap-align: start; }
}
```

- 미지원 브라우저는 단순 스크롤 UX로 동작.

---

## 다크모드/접근성 선호도

### 다크 모드 감지

```css
@media (prefers-color-scheme: dark) {
  :root { --surface: #0f1115; --text: #e5e7eb; }
}
```

### 동작 감소 선호

```css
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}
```

### 포커스 가시성

```css
:where(a, button, input, [role="button"]) :focus-visible {
  outline: 2px solid #6366f1; outline-offset: 2px;
}
```

- `outline: none` 금지. 시력/키보드 사용자를 위해 반드시 표시.

---

## 기능 감지/폴백 패턴 요약

### CSS @supports

```css
@supports (position: sticky) { .toc { position: sticky; top: 1rem; } }
@supports not (position: sticky) { .toc { position: static; } }
```

### JS 기능 감지

```js
const canShare = !!(navigator.share);
if (canShare) {
  shareBtn.addEventListener('click', () => navigator.share({ title: '문서', url: location.href }));
} else {
  shareBtn.addEventListener('click', () => copyToClipboard(location.href));
}
```

---

## 흔한 브라우저별 이슈 해결집(쿠크북)

| 증상 | 원인/브라우저 | 해결 |
|---|---|---|
| `100vh`가 화면보다 큼/작음 | iOS Safari 주소창 가변 | `100dvh`/`-webkit-fill-available`/JS `--vh` 보정 |
| `position: sticky` 작동 안 함 | Safari/크로스 | 조상 `overflow` 제거, `top` 지정, `transform` 부모 확인 |
| Flex 아이템 축소 이상 | Safari | 아이템에 `min-width: 0;` 추가 |
| `backdrop-filter` 불일치 | Safari만 강함 | `@supports`로 보정, 반투명 배경 폴백 |
| `:focus` 스타일 불일치 | 브라우저별 기본 차 | `:focus-visible` 기반 커스텀 링 제공 |
| 입력 컨트롤 스타일링 제한 | WebKit/Firefox 차 | 컨테이너 래핑 + 커스텀 UI, 네이티브는 최소한 유지 |
| 파일/미디어 자동재생 안 됨 | 모바일 정책 | `muted`+`playsinline`+사용자 제스처 요구 |
| 스크롤 튕김/바운스 | iOS | `overscroll-behavior`/`-webkit-overflow-scrolling: touch` 조합 점검 |
| 스크롤 고정 모달 배경 움직임 | 모바일 | `body { overflow:hidden }` + 스크롤 위치 잠금/복원 스크립트 |

모달 스크롤 잠금 예시:

```js
let scrollY = 0;
function lockBody() {
  scrollY = window.scrollY;
  document.body.style.position = 'fixed';
  document.body.style.inset = `-${scrollY}px 0 0 0`;
  document.body.style.width = '100%';
}
function unlockBody() {
  document.body.style.position = '';
  document.body.style.inset = '';
  window.scrollTo(0, scrollY);
}
```

---

## 자동화: 테스트와 린트

### 크로스 환경 테스트

- 로컬: Chrome DevTools(디바이스 모드), Firefox Responsive Design Mode
- 클라우드: BrowserStack/LambdaTest로 iOS/Android/데스크톱 실기 테스트

### 정적 검사

- ESLint/Stylelint로 구문/관례 통일
- Lighthouse로 접근성/성능/SEO 검수

---

## 예제: 카드 그리드(폴백 포함)

```html
<section class="cards">
  <article class="card">
    <img class="card__thumb" src="/img/1.jpg" alt="샘플 1">
    <h3 class="card__title">제목</h3>
    <p class="card__desc">간단 설명.</p>
  </article>
  <!-- 반복 -->
</section>
```

```css
.cards { display: grid; gap: 1rem; }
@supports (grid-template-columns: subgrid) {
  /* 신기능 예시가 필요한 경우에만 */
}
@supports (display: grid) {
  .cards { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); }
}
@supports not (display: grid) {
  .cards { display: flex; flex-wrap: wrap; margin: -0.5rem; }
  .card { width: 240px; margin: 0.5rem; flex: 1 0 240px; }
}
.card { background: var(--surface, #fff); border: 1px solid #e5e7eb; border-radius: .5rem; overflow: hidden; }
@supports (aspect-ratio: 16 / 9) {
  .card__thumb { width: 100%; aspect-ratio: 16 / 9; object-fit: cover; display: block; }
}
@supports not (aspect-ratio: 16 / 9) {
  .card__thumb { display: block; width: 100%; height: auto; }
  .card__thumb-wrap { position: relative; }
}
.card__title { font: 600 1rem/1.4 system-ui, sans-serif; margin: .75rem 1rem 0; color: #111827; }
.card__desc { margin: .5rem 1rem 1rem; color: #4b5563; }
```

---

## 예제: 안전한 헤더(스티키/모바일/노치)

```html
<header class="site-header">
  <div class="inner">
    <a class="brand" href="/">Brand</a>
    <nav class="nav">
      <a href="/docs">Docs</a>
      <a href="/pricing">Pricing</a>
      <a href="/about">About</a>
    </nav>
  </div>
</header>
```

```css
.site-header {
  position: sticky; top: 0;
  background: color-mix(in oklab, white 70%, transparent);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid #e5e7eb;
  padding-top: max(.5rem, env(safe-area-inset-top));
}
@supports not (backdrop-filter: blur(1px)) {
  .site-header { background: rgba(255,255,255,.9); }
}
.inner { display: flex; align-items: center; justify-content: space-between; height: 56px; padding-inline: 1rem; }
.brand { font-weight: 700; color: #111827; text-decoration: none; }
.nav a { color: #374151; text-decoration: none; padding: .25rem .5rem; }
.nav a:focus-visible { outline: 2px solid #6366f1; outline-offset: 2px; }
```

---

## 빌드 파이프라인: 한 번에 정리

### PostCSS + Autoprefixer + CSSnano

```bash
npm i -D postcss autoprefixer cssnano
```

`postcss.config.js`:

```js
module.exports = {
  plugins: {
    autoprefixer: {},
    cssnano: process.env.NODE_ENV === 'production' ? { preset: 'default' } : false
  }
};
```

### Vite 예시

```bash
npm i -D vite @vitejs/plugin-legacy
```

`vite.config.js`:

```js
import legacy from '@vitejs/plugin-legacy';
export default {
  plugins: [
    legacy({
      targets: ['defaults', 'iOS >= 14', 'Android >= 9'],
      additionalLegacyPolyfills: ['regenerator-runtime/runtime']
    })
  ]
};
```

---

## 최종 체크리스트(런치 전)

- 콘텐츠/내비게이션: 키보드만으로 주요 경로가 reachable 인가?
- 폼: 라벨/힌트/오류 메시지 스크린리더로 읽히는가?
- 브레이크포인트: 모바일/태블릿/데스크톱에서 레이아웃 붕괴 없음?
- iOS Safari: 100vh/스크롤/포커스/입력 확대 문제 없는가?
- 안드로이드 Chrome: 웹뷰/탭 바 충돌, 폰트 렌더링 문제 없는가?
- 성능: LCP 이미지 포맷/크기/지연 로딩, 폰트 `swap` 적용?
- 다크모드/모션감소: 각 미디어쿼리 적용 확인?
- 오류/폴백: @supports/feature detection 경로가 실제로 동작하는가?
- Analytics/Consent/3rd-party 스크립트: 블로킹 없이 지연 로드?

---

## 결론

크로스 브라우징은 **특정 브라우저 맞추기**가 아니라, **신뢰 가능한 기본 경험을 모든 환경에서 보장**하고 **지원하는 곳에선 더 좋은 경험**을 얹는 일이다.
표준 우선, 기능 감지, 자동화 빌드, 접근성, 성능을 축으로 설계하면—브라우저 차이는 더 이상 장애가 아니라 제약 조건이 된다.

---

## 참고

- Can I Use — 기능별 지원 현황
- MDN Compatibility Tables — 표준 문서와 예제
- Autoprefixer, Babel, polyfill.io — 호환 자동화 툴
- BrowserStack/LambdaTest — 실기/클라우드 테스트
