---
layout: post
title: 미적분 - 로피탈의 법칙
date: 2025-08-02 21:20:23 +0900
category: 미적분
---
# 로피탈의 법칙 (L'Hôpital's Rule)

## 1. 정식 진술(가장 많이 쓰는 형태)

점 \(a\in\mathbb{R}\cup\{\pm\infty\}\) 근방에서 미분 가능한 함수 \(f,g\)에 대해,
- \(\displaystyle \lim_{x\to a} f(x)=\lim_{x\to a} g(x)=0\) **또는** \(\displaystyle \lim_{x\to a} |f(x)|=\lim_{x\to a} |g(x)|=\infty\),
- \(g'(x)\neq 0\) (punctured neighborhood에서),
- \(\displaystyle \lim_{x\to a}\frac{f'(x)}{g'(x)}\) **이 존재(유한 또는 \(\pm\infty\))**하면,

\[
\boxed{\;\lim_{x\to a}\frac{f(x)}{g(x)}=\lim_{x\to a}\frac{f'(x)}{g'(x)}\;}
\]

> **한쪽 극한(좌/우)** 및 **무한대 \(a=\pm\infty\)** 에 대해서도 동일하게 성립합니다.

---

## 2. 적용 전 체크리스트 (실전용)

1) **형태 확인**: \(\frac{0}{0}\) 또는 \(\frac{\infty}{\infty}\) 인가?  
2) **미분 가능**: 해당 근방(뚫린 근방)에서 \(f,g\) 미분 가능, \(g'\neq 0\)?  
3) **반복 적용**: 한 번으로 안 풀리면 여러 번 가능(고차 미분).  
4) **대안 고려**: 테일러 전개/표준 극한이 더 간단할 수 있음.  
5) **좌·우 극한**: 방향에 따라 부호가 달라질 수 있으니 필요 시 **양측** 확인.

---

## 3. 기본 예제 (0/0)

### 예제 3.1  \(\displaystyle \lim_{x\to 0}\frac{\sin x}{x}\)
- 0/0, \(f'=\cos x, g'=1\Rightarrow \lim=\cos 0=1\).

### 예제 3.2  \(\displaystyle \lim_{x\to 0}\frac{1-\cos x}{x^2}\)
- 0/0, 1회 적용 \(\to \frac{\sin x}{2x}\) 여전히 0/0  
- 2회 적용 \(\to \frac{\cos x}{2}\Rightarrow \frac12\).

### 예제 3.3  \(\displaystyle \lim_{x\to 0}\frac{e^x-1-x}{x^2}\)
- 0/0, 1회: \(\frac{e^x-1}{2x}\) (0/0)  
- 2회: \(\frac{e^x}{2}\Rightarrow \frac12\).

### 예제 3.4  \(\displaystyle \lim_{x\to 0}\frac{\ln(1+x)}{x}\)
- 0/0, \(\frac{1/(1+x)}{1}\to 1\).

---

## 4. 기본 예제 (∞/∞)

### 예제 4.1  \(\displaystyle \lim_{x\to\infty}\frac{x}{e^x}\)
- ∞/∞, 1회: \(\frac{1}{e^x}\to 0\).

### 예제 4.2  \(\displaystyle \lim_{x\to\infty}\frac{\ln x}{x}\)
- ∞/∞, \(\frac{1/x}{1}\to 0\).

### 예제 4.3  \(\displaystyle \lim_{x\to\infty}\frac{x^n}{e^x}=0\) (모든 고정 \(n\in\mathbb{N}\))
- \(n\)번 반복 적용하면 분자는 상수, 분모는 여전히 \(e^x\) → 0.

### 예제 4.4  \(\displaystyle \lim_{x\to\infty}\frac{x^\alpha}{(\ln x)^\beta}=\infty\) (모든 \(\alpha>0\), 고정 \(\beta\))
- 반복 적용으로 \(\ln x\)는 느리게 성장 → 다항식이 우세.

---

## 5. 변형이 필요한 불정형

로피탈 직접 불가이므로 **형태 변경 후 적용**.

### 5.1 \(0\cdot\infty\)
- 곱을 몫으로 변형: \(\;f\cdot g=\frac{f}{1/g}\) 또는 \(\frac{g}{1/f}\).

**예제** \(\displaystyle \lim_{x\to 0^+} x\ln x\)
- \(x\to0^+\Rightarrow x\ln x = \frac{\ln x}{1/x}\) (∞/∞)  
- 로피탈: \(\frac{1/x}{-1/x^2} = -x\to 0\). ⇒ **0**

### 5.2 \(\infty-\infty\)
- **유리화** 또는 **통분**.

**예제** \(\displaystyle \lim_{x\to\infty}\left(\sqrt{x^2+x}-x\right)\)
- 유리화: \(\frac{x}{\sqrt{x^2+x}+x}\to \frac12\).

**예제** \(\displaystyle \lim_{x\to\infty}\big(\ln(x+1)-\ln x\big)=\lim\ln\!\left(1+\frac1x\right)=0\).

### 5.3 지수형 \(1^\infty,\;0^0,\;\infty^0\)
- \(y=f(x)^{g(x)}\)이면 \(\ln y = g(x)\ln f(x)\)로 바꿔 **곱→몫** 형태 후 로피탈.

**예제(1^∞)** \(\displaystyle \lim_{x\to 0}\left(1+x\right)^{1/x}\)
- \(\ln y=\frac{\ln(1+x)}{x}\to 1\Rightarrow y\to e\).

**예제(0^0)** \(\displaystyle \lim_{x\to 0^+} x^x\)
- \(\ln y=x\ln x\to 0\Rightarrow y\to 1\).

---

## 6. 고급 예제 (반복 적용·계수 비교)

### 6.1 \(\displaystyle \lim_{x\to 0}\frac{1-\cos(ax)}{1-\cos(bx)}\)  (\(a,b\neq 0\))
- 테일러: \(1-\cos(ax)\sim \frac{a^2x^2}{2}\), \(1-\cos(bx)\sim \frac{b^2x^2}{2}\)  
  \(\Rightarrow \frac{a^2}{b^2}\).
- 로피탈 2회 적용으로도 동일 결과.

### 6.2 \(\displaystyle \lim_{x\to 0}\frac{\tan x - x}{x^3}\)
- 테일러: \(\tan x = x + \frac{x^3}{3}+O(x^5)\Rightarrow \frac{1}{3}\).
- 로피탈 3회 적용해도 \(\frac13\).

### 6.3 \(\displaystyle \lim_{x\to 0}\frac{\ln(\cos x)}{x^2}\)
- 테일러: \(\cos x=1-\frac{x^2}{2}+O(x^4)\Rightarrow \ln(\cos x)\sim -\frac{x^2}{2}\)  
  \(\Rightarrow -\frac12\).
- 로피탈 2회 적용 동일.

### 6.4 \(\displaystyle \lim_{x\to\infty}\frac{\sqrt{x^2+ax}-x}{1/x}\)  (\(a\in\mathbb{R}\))
- 유리화: \(\frac{\sqrt{x^2+ax}-x}{1/x} = \frac{ax}{\sqrt{x^2+ax}+x}\cdot x \to \frac{a}{2}\cdot\infty \)처럼 보이지만  
  정확히는 \(\sqrt{x^2+ax}=x\sqrt{1+a/x}\sim x\left(1+\frac{a}{2x}\right)\Rightarrow\) 전체 극한은 \(\frac{a}{2}\).

---

## 7. 좌·우극한, 끝점·무한대 버전

- **한쪽 로피탈**: \(x\to a^+\) 또는 \(x\to a^-\) 에 대해 동일하게 적용 가능.  
- **무한대에서**: \(x\to\infty\) 또는 \(-\infty\)도 조건만 맞으면 동일.

**예제(좌우 부호 차이)** \(\displaystyle \lim_{x\to 0^\pm}\frac{|x|}{x}\)  
- 로피탈 불가(형태가 0/0이 아님, 미분 불능). 좌극한 \(-1\), 우극한 \(+1\) ⇒ 전체 극한 **존재하지 않음**.

---

## 8. 자주 나오는 함정 · 반례 포인트

1) **형태 미확인**: 0/0 또는 ∞/∞가 아니면 적용 불가.  
2) **미분 불능/ \(g'=0\)**: 근방에서 \(g'=0\)이 되면 가정 위반.  
3) **한 번 적용 후 형태 변화**: 한 번 적용했는데 더 이상 0/0, ∞/∞가 아니면 **중단**하고 직접 극한 계산.  
4) **변곡형·진동형**: \(\sin(1/x)\)류는 분자/분모가 0 또는 ∞로 **같이** 가지 않으면 로피탈 대상이 아님.  
5) **테일러가 더 빠름**: 삼각함수·로그·지수는 근방 전개로 단번에 해결되는 경우가 많음.

---

## 9. 테일러 전개 — 로피탈의 강력한 대안

- \(\sin x = x-\frac{x^3}{6}+O(x^5)\)  
- \(\cos x = 1-\frac{x^2}{2}+\frac{x^4}{24}+O(x^6)\)  
- \(e^x = 1+x+\frac{x^2}{2}+\frac{x^3}{6}+O(x^4)\)  
- \(\ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}+O(x^4)\)

> **팁**: “분자·분모가 몇 차까지 0이 되는가?”를 보는 **소거 차수 비교**가 빠르고 안전합니다.

---

## 10. 연습문제 (해설 포함)

### (1) \(\displaystyle \lim_{x\to 0}\frac{\sin(2x)-2\sin x}{x^3}\)
- 전개: \(\sin(2x)=2x-\frac{(2x)^3}{6}+O(x^5)=2x-\frac{4}{3}x^3+O(x^5)\)  
  \(\sin x = x-\frac{x^3}{6}+O(x^5)\)  
  분자 \(= (2x-\frac{4}{3}x^3) -2(x-\frac{x^3}{6}) + O(x^5)= -x^3 + O(x^5)\).  
  \(\Rightarrow\) 극한 \(-1\).

### (2) \(\displaystyle \lim_{x\to 0^+} x^{\sin x}\)
- \(\ln y = \sin x \ln x \sim x\ln x \to 0\Rightarrow y\to 1\).

### (3) \(\displaystyle \lim_{x\to 0}\frac{\ln(1+ax)-\ln(1+bx)}{x}\)  (\(a,b\in\mathbb{R}\))
- 로피탈: \(\frac{\frac{a}{1+ax}-\frac{b}{1+bx}}{1}\to a-b\).

### (4) \(\displaystyle \lim_{x\to\infty} \frac{\sqrt{x^2+3x+2}-x}{\ln x}\)
- 유리화: \(\frac{3x+2}{\big(\sqrt{x^2+3x+2}+x\big)\ln x} \sim \frac{3x}{(2x)\ln x}=\frac{3}{2\ln x}\to 0\).

### (5) \(\displaystyle \lim_{x\to 0}\frac{e^{x}-1-\frac{x^2}{2}-x}{x^3}\)
- 정리: \(e^{x}-1-x-\frac{x^2}{2} = \frac{x^3}{6}+O(x^4)\Rightarrow \frac{1}{6}\).

---

## 11. 파이썬 수치 검증 스니펫 (선택 실행)

```python
# mpmath로 로피탈 예제 수치 검증
import mpmath as mp

def lim(f, a, side='both'):
    for k in [1,2,3,4,5,6]:
        h = mp.mpf('1e-{}'.format(k))
        if a == mp.inf:
            xs = [10**k, 10**(k+1)]
        elif side == 'right':
            xs = [a+h, a+h/10, a+h/100]
        elif side == 'left':
            xs = [a-h, a-h/10, a-h/100]
        else:
            xs = [a+h, a-h]
        print(k, [f(x) for x in xs])

# 예: (1 - cos x)/x^2 -> 1/2
f = lambda x: (1-mp.cos(x))/(x**2)
lim(f, 0, side='both')

# 예: (ln(1+x))/x -> 1
g = lambda x: mp.log(1+x)/x
lim(g, 0, side='right')

# 예: x*ln x -> 0 (x->0+)
h = lambda x: x*mp.log(x)
lim(h, 0, side='right')
```

> 수치 검증은 **스텝 크기**에 민감합니다. **다중 스케일**로 확인하세요.

---

## 12. 요약표 (무기고)

| 형태 | 전형 예 | 변형/해결 | 비고 |
|---|---|---|---|
| \(0/0\) | \(\frac{\sin x}{x}\) | 로피탈/테일러 | 가장 흔함 |
| \(\infty/\infty\) | \(\frac{\ln x}{x}\) | 로피탈/성장률 비교 | 무한대 버전 |
| \(0\cdot\infty\) | \(x\ln x\) | \(\frac{\ln x}{1/x}\) 등 | 몫으로 변환 |
| \(\infty-\infty\) | \(\sqrt{x^2+x}-x\) | 유리화/통분 | 구조적 정리 |
| \(1^\infty\) | \((1+x)^{1/x}\) | 로그 취해 로피탈 | \(e\) 도출 |
| \(0^0\) | \(x^x\) | 로그 후 \(x\ln x\) | \(1\) 도출 |
| \(\infty^0\) | \(x^{1/x}\) | \(\ln y=\frac{\ln x}{x}\to 0\) | \(1\) 도출 |

---

## 13. 마무리 코멘트
- **로피탈의 법칙은 강력하지만 ‘형태·가정’**을 반드시 확인하세요.  
- **테일러 전개**가 더 빠른 경우가 많습니다(특히 삼각/로그/지수).  
- 좌/우극한이나 무한대에서의 적용, 변형 불정형 처리(유리화/로그 변환)까지 익히면 실전 문제 대부분을 커버할 수 있습니다.