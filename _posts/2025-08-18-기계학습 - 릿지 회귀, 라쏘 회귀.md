---
layout: post
title: ê¸°ê³„í•™ìŠµ - ë¦¿ì§€ íšŒê·€, ë¼ì˜ íšŒê·€
date: 2025-08-18 18:25:23 +0900
category: ê¸°ê³„í•™ìŠµ
---
# ë¦¿ì§€ íšŒê·€(Ridge Regression) / ë¼ì˜ íšŒê·€(Lasso Regression)

**ë¦¿ì§€ íšŒê·€**ì™€ **ë¼ì˜ íšŒê·€**ëŠ” **ì„ í˜• íšŒê·€(Linear Regression)** ëª¨ë¸ì— **ì •ê·œí™”(Regularization)**ë¥¼ ì ìš©í•˜ì—¬  
ê³¼ì í•©(Overfitting)ì„ ë°©ì§€í•˜ê³  ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.

---

## 1. ì •ê·œí™”(Regularization) ê°œë…

### (1) ì™œ í•„ìš”í•œê°€?
- ì„ í˜• íšŒê·€ëŠ” í•™ìŠµ ë°ì´í„°ì— ê³¼ë„í•˜ê²Œ ë§ì¶°ì ¸ì„œ **ê³¼ì í•©**ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ.
- íŠ¹íˆ **íŠ¹ì„±(Feature)** ìˆ˜ê°€ ë§ê±°ë‚˜ **ë‹¤ì¤‘ê³µì„ ì„±(Multicollinearity)**ì´ ì¡´ì¬í•˜ë©´ ê°€ì¤‘ì¹˜ ê°’ì´ ë¶ˆì•ˆì •í•˜ê²Œ ì»¤ì§.
- **ì •ê·œí™”**ëŠ” ê°€ì¤‘ì¹˜ì˜ í¬ê¸°ë¥¼ ì œí•œí•˜ì—¬ ëª¨ë¸ ë³µì¡ë„ë¥¼ ì¤„ì´ê³ , ì¼ë°˜í™” ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚´.

---

### (2) ì •ê·œí™” ë°©ì‹
1. **L2 ì •ê·œí™”** â†’ ë¦¿ì§€ íšŒê·€(Ridge Regression)
2. **L1 ì •ê·œí™”** â†’ ë¼ì˜ íšŒê·€(Lasso Regression)
3. **L1 + L2 í˜¼í•©** â†’ ì—˜ë¼ìŠ¤í‹±ë„·(Elastic Net)

---

## 2. ë¦¿ì§€ íšŒê·€ (Ridge Regression)

### (1) ìˆ˜ì‹
ì„ í˜• íšŒê·€ì˜ MSE ì†ì‹¤ í•¨ìˆ˜ì— L2 íŒ¨ë„í‹° í•­ì„ ì¶”ê°€:
$$
\min_w \left[ \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2 + \lambda \sum_{j=1}^p w_j^2 \right]
$$
- \(\lambda\) (ì •ê·œí™” íŒŒë¼ë¯¸í„°): ê·œì œ ê°•ë„ ì¡°ì ˆ
  - \(\lambda \to 0\) â†’ ì¼ë°˜ ì„ í˜• íšŒê·€ì™€ ë™ì¼
  - \(\lambda \to \infty\) â†’ ê°€ì¤‘ì¹˜ê°€ 0ì— ê°€ê¹Œì›Œì§
- L2 ì •ê·œí™”ëŠ” **ê°€ì¤‘ì¹˜ë¥¼ ì‘ê²Œ ë§Œë“¤ì§€ë§Œ ì™„ì „íˆ 0ìœ¼ë¡œ ë§Œë“¤ì§€ëŠ” ì•ŠìŒ**.

---

### (2) íŠ¹ì§•
- ë‹¤ì¤‘ê³µì„ ì„± ë¬¸ì œ ì™„í™”
- ëª¨ë“  íŠ¹ì„±ì´ ì¡°ê¸ˆì”© ì˜í–¥ì„ ë¯¸ì¹¨
- íŠ¹ì„± ì„ íƒ ê¸°ëŠ¥ ì—†ìŒ (ê°€ì¤‘ì¹˜ê°€ 0ì´ ë˜ì§€ ì•ŠìŒ)

---

## 3. ë¼ì˜ íšŒê·€ (Lasso Regression)

### (1) ìˆ˜ì‹
ì„ í˜• íšŒê·€ì˜ MSE ì†ì‹¤ í•¨ìˆ˜ì— L1 íŒ¨ë„í‹° í•­ì„ ì¶”ê°€:
$$
\min_w \left[ \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2 + \lambda \sum_{j=1}^p |w_j| \right]
$$
- L1 ì •ê·œí™”ëŠ” **ê°€ì¤‘ì¹˜ë¥¼ ì™„ì „íˆ 0ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŒ** â†’ íŠ¹ì„± ì„ íƒ(Feature Selection) ê¸°ëŠ¥

---

### (2) íŠ¹ì§•
- ë¶ˆí•„ìš”í•œ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ì–´ ìë™ ë³€ìˆ˜ ì„ íƒ
- ê³ ì°¨ì› ë°ì´í„°ì…‹ì—ì„œ ìœ ìš©
- í•˜ì§€ë§Œ íŠ¹ì„± ìˆ˜ê°€ ë§ì€ ê²½ìš°, ì„±ëŠ¥ì´ ë¦¿ì§€ë³´ë‹¤ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ

---

## 4. ë¦¿ì§€ vs ë¼ì˜ ë¹„êµ

| êµ¬ë¶„ | ë¦¿ì§€ íšŒê·€ | ë¼ì˜ íšŒê·€ |
|------|-----------|-----------|
| ì •ê·œí™” ì¢…ë¥˜ | L2 (ê°€ì¤‘ì¹˜ ì œê³±) | L1 (ê°€ì¤‘ì¹˜ ì ˆëŒ“ê°’) |
| ê°€ì¤‘ì¹˜ 0 ê°€ëŠ¥ ì—¬ë¶€ | ë¶ˆê°€ëŠ¥ | ê°€ëŠ¥ |
| íŠ¹ì„± ì„ íƒ ê¸°ëŠ¥ | ì—†ìŒ | ìˆìŒ |
| ë‹¤ì¤‘ê³µì„ ì„± ì²˜ë¦¬ | ì˜ ì²˜ë¦¬ | ë³€ìˆ˜ ì œê±° ê°€ëŠ¥ |
| í•´ì„ ê°€ëŠ¥ì„± | ë‚®ìŒ | ë†’ìŒ (ë³€ìˆ˜ ì¤„ì´ë¯€ë¡œ) |

---

## 5. ì—˜ë¼ìŠ¤í‹±ë„· (Elastic Net)
- L1ê³¼ L2ë¥¼ ëª¨ë‘ ì ìš©:
$$
\min_w \left[ MSE + \lambda_1 \sum |w_j| + \lambda_2 \sum w_j^2 \right]
$$
- Lassoì˜ ë³€ìˆ˜ ì„ íƒ ê¸°ëŠ¥ê³¼ Ridgeì˜ ì•ˆì •ì„±ì„ ê²°í•©

---

## 6. íŒŒì´ì¬ ì˜ˆì œ
```python
import numpy as np
from sklearn.linear_model import Ridge, Lasso
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error

# ë°ì´í„° ìƒì„±
np.random.seed(0)
X = np.random.randn(100, 5)
y = X @ np.array([1.5, 0, -3, 0, 2]) + np.random.randn(100) * 0.5

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

# Ridge íšŒê·€
ridge = Ridge(alpha=1.0)
ridge.fit(X_train, y_train)
y_pred_ridge = ridge.predict(X_test)

# Lasso íšŒê·€
lasso = Lasso(alpha=0.1)
lasso.fit(X_train, y_train)
y_pred_lasso = lasso.predict(X_test)

print("Ridge íšŒê·€ MSE:", mean_squared_error(y_test, y_pred_ridge))
print("Lasso íšŒê·€ MSE:", mean_squared_error(y_test, y_pred_lasso))
print("Ridge ê°€ì¤‘ì¹˜:", ridge.coef_)
print("Lasso ê°€ì¤‘ì¹˜:", lasso.coef_)
```

---

## 7. í™œìš© ì˜ˆì‹œ
- **Ridge íšŒê·€**:
  - ë³€ìˆ˜ë“¤ì´ ëª¨ë‘ ì˜ë¯¸ ìˆë‹¤ê³  íŒë‹¨ë  ë•Œ
  - ë‹¤ì¤‘ê³µì„ ì„± ë¬¸ì œ í•´ê²°ì´ í•„ìš”í•  ë•Œ
- **Lasso íšŒê·€**:
  - ë³€ìˆ˜ ì„ íƒì´ í•„ìš”í•œ ê²½ìš°
  - ê³ ì°¨ì› í¬ì†Œ ë°ì´í„°(ì˜ˆ: í…ìŠ¤íŠ¸ ë²¡í„°í™” ë°ì´í„°)

---

## ğŸ“Œ ì •ë¦¬
- ë¦¿ì§€ íšŒê·€: L2 ì •ê·œí™” â†’ ëª¨ë“  ê°€ì¤‘ì¹˜ ì¶•ì†Œ, ë³€ìˆ˜ ì„ íƒ ì—†ìŒ
- ë¼ì˜ íšŒê·€: L1 ì •ê·œí™” â†’ ì¼ë¶€ ê°€ì¤‘ì¹˜ 0, ë³€ìˆ˜ ì„ íƒ ê°€ëŠ¥
- ë‘ ë°©ë²• ëª¨ë‘ ê³¼ì í•© ë°©ì§€ì™€ ëª¨ë¸ ì¼ë°˜í™” í–¥ìƒì— ê¸°ì—¬
- ì—˜ë¼ìŠ¤í‹±ë„·ì€ ë‘ ë°©ì‹ì˜ ì¥ì ì„ ê²°í•©