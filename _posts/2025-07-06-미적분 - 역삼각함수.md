---
layout: post
title: 미적분 - 역삼각함수
date: 2025-07-06 19:20:23 +0900
category: 미적분
---
# 역삼각함수 (Inverse Trigonometric Functions)

## 1. 왜 “역삼각함수”가 필요한가?

삼각함수는 **주기** 때문에 그대로는 일대일이 아니다.  
그래서 **정의역(Principal domain)** 을 제한해 **주값(principal value)** 을 갖는 역함수를 정의한다.

- 예: \(y=\sin x\) 는 \(2\pi\)-주기. 그러나 \(x\in\left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right]\) 로 제한하면 단조 증가 → 역함수 \(\arcsin\) 정의 가능.

---

## 2. 표준 정의(주값)와 치역

| 기호 | 정의 | 정의역 | 치역(주값 범위) | 단조성 |
|---|---|---|---|---|
| \(\arcsin x\) | \(\sin y=x\) | \([-1,1]\) | \(\left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right]\) | 증가 |
| \(\arccos x\) | \(\cos y=x\) | \([-1,1]\) | \([0,\pi]\) | 감소 |
| \(\arctan x\) | \(\tan y=x\) | \(\mathbb{R}\) | \(\left(-\tfrac{\pi}{2},\tfrac{\pi}{2}\right)\) | 증가 |
| \(\arccot x\) | \(\cot y=x\) | \(\mathbb{R}\) | \((0,\pi)\) | 감소 |
| \(\arcsec x\) | \(\sec y=x\) | \((-\infty,-1]\cup[1,\infty)\) | \([0,\pi]\setminus\{\tfrac{\pi}{2}\}\) | 증가(각 구간) |
| \(\arccsc x\) | \(\csc y=x\) | \((-\infty,-1]\cup[1,\infty)\) | \(\left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right]\setminus\{0\}\) | 감소(각 구간) |

> 주값은 단 하나의 대표 각을 돌려준다. 일반해는 **주기**를 더해 생성한다(아래 §11).

---

## 3. 기본 성질(대칭·상보)

- 홀짝성  
  \[
  \arcsin(-x)=-\arcsin x,\quad
  \arctan(-x)=-\arctan x,\quad
  \arccos(-x)=\pi-\arccos x.
  \]
- 상보관계  
  \[
  \arcsin x+\arccos x=\frac{\pi}{2},\qquad
  \arctan x+\arccot x=\frac{\pi}{2}.
  \]
- 역삼각↔삼각 합성  
  \[
  \sin(\arcsin x)=x,\quad
  \cos(\arccos x)=x,\quad
  \tan(\arctan x)=x.
  \]
  \[
  \cos(\arcsin x)=\sqrt{1-x^2}\ \ (|x|\le 1),\qquad
  \sin(\arccos x)=\sqrt{1-x^2}.
  \]
  부호는 치역에 의해 정해진다(예: \(\arcsin x\in[-\pi/2,\pi/2]\) → \(\cos\ge 0\)).

---

## 4. 미분 공식(연쇄법칙 포함)

연쇄법칙 형태가 실전에서 가장 유용하다.

- \[
  \frac{d}{dx}\arcsin u(x)=\frac{u'(x)}{\sqrt{1-u(x)^2}}\quad(|u|<1).
  \]
- \[
  \frac{d}{dx}\arccos u(x)=-\frac{u'(x)}{\sqrt{1-u(x)^2}}.
  \]
- \[
  \frac{d}{dx}\arctan u(x)=\frac{u'(x)}{1+u(x)^2}.
  \]
- \[
  \frac{d}{dx}\arcsec u(x)=\frac{u'(x)}{|u(x)|\sqrt{u(x)^2-1}}\quad(|u|>1),
  \]
  \[
  \frac{d}{dx}\arccsc u(x)=-\frac{u'(x)}{|u(x)|\sqrt{u(x)^2-1}}.
  \]

두 번째 미분 예: \(\dfrac{d^2}{dx^2}\arcsin x=\dfrac{x}{(1-x^2)^{3/2}}\) (끝점에서 발산).

---

## 5. 적분 표준형(암기 지점)

- \[
  \int \frac{dx}{\sqrt{a^2-x^2}}=\arcsin\!\frac{x}{a}+C,\qquad (a>0)
  \]
- \[
  \int \frac{dx}{a^2+x^2}=\frac{1}{a}\arctan\!\frac{x}{a}+C,\qquad (a>0)
  \]
- \[
  \int \frac{dx}{|x|\sqrt{x^2-a^2}}=\frac{1}{a}\arcsec\!\frac{|x|}{a}+C=\operatorname{arcosh}\!\frac{|x|}{a}+C.
  \]

치환으로 자주 쓰는 3종 세트(삼각치환):

| 근호 형태 | 치환 | 비고 |
|---|---|---|
| \(\sqrt{a^2-x^2}\) | \(x=a\sin\theta\) | \(\theta\in[-\pi/2,\pi/2]\) |
| \(\sqrt{a^2+x^2}\) | \(x=a\tan\theta\) | \(\theta\in(-\pi/2,\pi/2)\) |
| \(\sqrt{x^2-a^2}\) | \(x=a\sec\theta\) | \(\theta\in[0,\pi]\setminus\{\pi/2\}\) |

---

## 6. 대체 표현(해석·계산 유리)

- \[
  \arcsin x=\arctan\!\frac{x}{\sqrt{1-x^2}},\quad |x|<1.
  \]
- \[
  \arccos x=\arctan\!\frac{\sqrt{1-x^2}}{x}\quad(\text{사분면 보정 필요}).
  \]
- 안정적(수치) 표현  
  \[
  \arcsin x=2\arctan\!\frac{x}{1+\sqrt{1-x^2}},\quad
  \arccos x=2\arctan\!\frac{\sqrt{1-x^2}}{1+x}.
  \]
  작은 \(x\) 근방에서 오차 축소에 유리.

- 합성(각도 덧셈)  
  \[
  \arctan u+\arctan v=\arctan\!\frac{u+v}{1-uv}\ \ (\text{사분면 보정: } \mathrm{atan2}).
  \]
  \[
  \arcsin u+\arcsin v=\arcsin\!\big(u\sqrt{1-v^2}+v\sqrt{1-u^2}\big)\ (\text{범위·보정 유의}).
  \]

---

## 7. 단조성·볼록성·끝점 거동

- \(\arcsin,\arctan\) 은 증가, \(\arccos\) 는 감소.
- \(\arctan x\) 는 \(x\to\pm\infty\) 에서 수평 점근선 \(\pm \tfrac{\pi}{2}\).
- \(\arcsin x\) 는 \(x\to\pm 1\) 에서 기울기 \(\to\infty\) (미분 발산).

---

## 8. 예제 풀이

### 예제 1. 미분: \(\dfrac{d}{dx}\arcsin(2x)\)
\[
\frac{2}{\sqrt{1-4x^2}}.
\]

### 예제 2. 정적분: \(\displaystyle \int\frac{1}{\sqrt{1-x^2}}\,dx\)
\[
\arcsin x+C.
\]

### 예제 3. 치환적분: \(\displaystyle \int_0^{2} \frac{x}{\sqrt{x^2+1}}\,dx\)
치환 \(u=x^2+1,\,du=2x\,dx\Rightarrow\)
\[
=\frac12\int_{1}^{5}\frac{1}{\sqrt{u}}\,du
=\left[\sqrt{u}\right]_{1}^{5}
=\sqrt{5}-1.
\]
(역삼각이 직접 나오진 않지만, 같은 계열의 루트-분수형)

### 예제 4. 역삼각 적분: \(\displaystyle \int \frac{dx}{x^2+4}\)
\[
\frac{1}{2}\arctan\!\frac{x}{2}+C.
\]

### 예제 5. 역삼각·삼각 합성 단순화  
\(\cos(\arcsin x)=\sqrt{1-x^2}\) (치역상 \(\ge 0\)).  
\(\sin(\arccos x)=\sqrt{1-x^2}\).  
\(\tan(\arcsin x)=\dfrac{x}{\sqrt{1-x^2}}\).

### 예제 6. 방정식 풀기  
\(\sin\theta=\tfrac34\) 의 **주값** \(\theta_0=\arcsin(\tfrac34)\in[-\tfrac{\pi}{2},\tfrac{\pi}{2}]\).  
일반해: \(\theta=\theta_0+2k\pi\) 또는 \(\theta=\pi-\theta_0+2k\pi\), \(k\in\mathbb{Z}\).

### 예제 7. 합성의 주값 주의  
\(\arcsin(\sin x)\) 는 **항상** \(x\) 가 아니다.  
\[
\arcsin(\sin x)=
\begin{cases}
x,& x\in\left[-\tfrac{\pi}{2},\tfrac{\pi}{2}\right],\\[4pt]
\pi-x,& x\in\left[\tfrac{\pi}{2},\tfrac{3\pi}{2}\right],\\[2pt]
-x-\pi,& x\in\left[-\tfrac{3\pi}{2},-\tfrac{\pi}{2}\right],\ \text{등 주기적 반복}.
\end{cases}
\]

---

## 9. 수치 확인(파이썬)

```python
# 수치미분으로 d/dx arcsin(x) = 1/sqrt(1-x^2) 검증
import numpy as np

def num_deriv(f, x, h=1e-7):
    return (f(x+h)-f(x-h))/(2*h)

xs = np.linspace(-0.9, 0.9, 7)
f = np.arcsin
lhs = [num_deriv(f, x) for x in xs]
rhs = [1/np.sqrt(1-x*x) for x in xs]

print("x:", np.round(xs, 3))
print("수치미분:", np.round(lhs, 6))
print("이론값  :", np.round(rhs, 6))
```

실행하면 두 값이 잘 일치한다(끝점 \(\pm 1\) 근처에서는 수치적으로 민감).

---

## 10. 삼각치환과 역삼각함수의 연계(실전 적분 루틴)

- \(\int \sqrt{a^2-x^2}\,dx\) 류: \(x=a\sin\theta\) → \(\theta=\arcsin(x/a)\) 복원.
- \(\int \frac{1}{\sqrt{a^2-x^2}}\,dx\): 바로 \(\arcsin(x/a)\).
- \(\int \frac{1}{a^2+x^2}\,dx\): \(\frac{1}{a}\arctan(x/a)\).
- \(\int \frac{1}{x\sqrt{x^2-a^2}}\,dx\): \(\frac{1}{a}\arcsec(|x|/a)\) 또는 \(\operatorname{arcosh}(|x|/a)\).

예:  
\[
\int \frac{dx}{\sqrt{9-x^2}}=\arcsin\!\frac{x}{3}+C,\quad
\int \frac{dx}{x^2+9}=\frac{1}{3}\arctan\!\frac{x}{3}+C.
\]

---

## 11. 일반해(주기)와 ATAN2

- **일반해 예**  
  \(\cos\theta=\alpha\) 의 해는 \(\theta=\pm\arccos\alpha+2k\pi\).
- **사분면 보정**  
  두 실수 \((y,x)\) 에서 각도는 \(\theta=\operatorname{atan2}(y,x)\) 를 사용.  
  이는 \(\arctan(y/x)\) 의 사분면 모호성을 제거한다(특히 \(x\le 0\) 일 때).

---

## 12. 급수 전개(해석·근사)

- \(\displaystyle \arctan x=\sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{2n+1}\quad(|x|\le 1,\ x\ne \pm 1 \text{ 경계 수렴 느림}).\)
- \(\displaystyle \arcsin x=\sum_{n=0}^\infty \frac{(2n)!}{4^n(n!)^2}\frac{x^{2n+1}}{2n+1}\quad(|x|\le 1).\)

응용: 마친(Machin)형 \(\displaystyle \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}\).

---

## 13. 실전 응용 스냅샷

- **삼각측량/기하**: 변과 높이로 각 구하기 → \(\theta=\arctan(\text{대/밑})\).
- **로봇공학/역기구학**: 관절 각도 복원 시 \(\operatorname{atan2}\) 사용해 사분면 확정.
- **신호처리**: 복소 스펙트럼 위상 \(\phi=\operatorname{atan2}(\Im,\Re)\), 위상언랩(unwrapping) 필요.
- **항공/항법**: 코스 각 및 방위각 계산(사분면·자기북/진북 보정).

---

## 14. 흔한 함정 체크리스트

- [ ] **주값 범위** 확인(예: \(\arccos\in[0,\pi]\)).  
- [ ] \(\arcsin(\sin x)\) 등 **합성은 주값으로 접힘**(항상 \(x\) 가 아님).  
- [ ] 미분 시 **연쇄법칙**과 **정의역**(\(|u|<1\) 등) 점검.  
- [ ] 적분에서 **삼각치환 후 역치환** 시 사분면·부호 주의.  
- [ ] 수치계산: \(|x|>1\) 이면 \(\arcsin, \arccos\) 는 실수 정의 안 됨 → 입력을 \([-1,1]\) 로 클램프.  
- [ ] \(\arctan\) 은 사분면 정보가 사라진다 → 각도는 가급적 \(\operatorname{atan2}\) 사용.

---

## 15. 연습문제 (해설 스케치 포함)

1) 미분: \(\dfrac{d}{dx}\big[\arccos(3x-1)\big]\)  
\[
-\frac{3}{\sqrt{1-(3x-1)^2}}.
\]

2) 치환적분: \(\displaystyle \int \frac{dx}{\sqrt{16-x^2}}\)  
\[
\arcsin\!\frac{x}{4}+C.
\]

3) 정적분: \(\displaystyle \int_{0}^{1} \frac{dx}{1+x^2}\)  
\[
[\arctan x]_0^1=\frac{\pi}{4}.
\]

4) 단순화: \(\cos(\arctan t)\)  
삼각형에서 \(\tan\theta=t=\frac{\text{대}}{\text{밑}}\Rightarrow\) 빗변 \(\sqrt{1+t^2}\).  
\(\cos\theta=\frac{1}{\sqrt{1+t^2}}\Rightarrow \cos(\arctan t)=\dfrac{1}{\sqrt{1+t^2}}.\)

5) 항등식: \(\arcsin x=\arctan\!\dfrac{x}{\sqrt{1-x^2}}\) 증명  
\(\theta=\arcsin x\Rightarrow \sin\theta=x,\ \cos\theta=\sqrt{1-x^2}\Rightarrow \tan\theta=\dfrac{x}{\sqrt{1-x^2}}\Rightarrow \theta=\arctan(\cdot)\).

---

## 16. 한눈 정리

- 역삼각함수는 **주값 범위** 위에서 정의된 역함수.  
- 미분·적분 표준형은 **암기 가치가 높다**(특히 \(\arcsin, \arctan\)).  
- 삼각치환 ↔ 역삼각 복원은 적분에서 핵심 루틴.  
- 합성·대체표현(특히 \(\arcsin\leftrightarrow\arctan\))은 계산·수치안정에 유용.  
- 각도 계산은 가급적 \(\operatorname{atan2}\) 로 사분면을 보존한다.