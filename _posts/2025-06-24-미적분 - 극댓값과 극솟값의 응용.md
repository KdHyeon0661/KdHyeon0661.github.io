---
layout: post
title: 미적분 - 극댓값과 극솟값의 응용
date: 2025-06-24 21:20:23 +0900
category: 미적분
---
# 극댓값과 극솟값의 응용 (Applications of Local Maxima and Minima)

## 0. 로드맵 & 체크리스트

1) **모델링**: 최적화 대상(넓이, 길이, 비용, 이익, 에너지…)을 정확히 스칼라 함수 \( f \)로 만든다.
2) **정의역(제약)**: 변수 범위·등식/부등식 제약, 경계/꼭짓점 포함 여부를 명확히 한다.
3) **임계점(critical points)**: \( f'(x)=0 \)(일변수), \( \nabla f(\mathbf{x})=\mathbf{0} \)(다변수) 해를 찾는다.
4) **판정**: 부호 변화, 2차 도함수·헤시안(Hessian)로 극대/극소/안장점 판정.
5) **경계/코너**: 關鍵! 경계/모서리에서 최댓/최솟값이 나오는 경우가 매우 많다.
6) **검산**: 닫힌구간이면 **Weierstrass 정리**에 따라 최대·최소 존재. 수치/그래프 검산으로 실수 방지.

---

## 1. 일변수 최적화 — 1차·2차 미분 판정

### 1.1 임계점과 1차 도함수 부호 변화
- 임계점: \( f'(c)=0 \) 또는 정의 안 됨.
- \( f' \)가 \( c \)에서 **좌(+)/우(-)**로 바뀌면 극댓값, **좌(-)/우(+)**로 바뀌면 극솟값.

### 1.2 2차 도함수 판정
- \( f'(c)=0 \), \( f''(c)>0 \Rightarrow \) **극솟값**, \( f''(c)<0 \Rightarrow \) **극댓값**.
- \( f''(c)=0 \Rightarrow \) 불충분 ⇒ 고차 미분이나 부호변화 직접 확인.

### 1.3 대표 반례
- \( f(x)=x^{1/3} \): \( f'(0)=\infty \)로 0에서 미분 불능, 극값 아님.
- \( f(x)=x^3 \): \( f'(0)=0 \)이지만 **변곡점**이지 극값 아님(좌(-)→우(+), 그러나 기울기 0).

---

## 2. 기하 응용 ① — 울타리(강가)로 최대 넓이

**문제**: 울타리 총 길이 100 m, 한 변은 강가라 울타리 불필요. 직사각형의 최대 넓이?
**모델링**: 가로 \( x \), 세로 \( y \), 제약 \( x+2y=100 \Rightarrow y=\frac{100-x}{2} \).
**목표**: \( A(x)=x y = x\frac{100-x}{2} \).

**풀이**
$$
A(x)=\frac{100x-x^2}{2},\quad
A'(x)=\frac{100-2x}{2}=0 \Rightarrow x=50,\ y=25.
$$

**결론**: 최댓 넓이 \( A_{\max}=50\times 25=1250 \,\text{m}^2 \).

**코드 검산**
```python
# 울타리 최대 넓이 검산
import numpy as np
xs = np.linspace(0,100,10001)
A  = xs*(100-xs)/2
xs[A.argmax()], A.max()   # (50.0, 1250.0)
```

---

## 3. 기하 응용 ② — x축 위 점까지의 거리합 최소

**문제**: \(A(0,0), B(4,2)\), x축 위 점 \(P(x,0)\)에 대해 \(AP+PB\) 최소.
**모델링**:
$$
D(x)=\sqrt{x^2}+\sqrt{(x-4)^2+2^2}=|x|+\sqrt{(x-4)^2+4}.
$$
x축 대칭(반사)법으로 \(B(4,2)\)를 x축에 반사해 \(B'(4,-2)\).
그러면 \(AP+PB\) 최소는 곡선이 아니라 **직선 \(AB'\)**와 x축 교점 \(P\)를 택할 때. 직선 \(AB'\) 방정식을 구하면 \(x= \dfrac{(0-(-2))\cdot 0 +(4-0)\cdot 0}{(4-0)}\) 같은 형식으로 혼동되기 쉬움.
정석은 **미분법** 또는 **기하적으로**: 원래 점들에서 x축까지의 경로 최단은 반사로 직선화. 직선 \(A(0,0)\)–\(B'(4,-2)\)의 방정식:
기울기 \(m=\frac{-2-0}{4-0}=-\frac12\). 점기울기식 \(y=-\frac12 x\). x축(y=0)와의 교점은 \(x=0\)이므로 \(P=(0,0)\)?
이건 \(A\)가 이미 x축 위라 \(A\) 자체가 교점입니다. **거리합 최소는 \(P=A\)**.
**직관**: \(A\)에서 출발해 x축 위 점을 경유하여 \(B\)로 갈 때, \(A\) 자체(원점)를 택하는 게 가장 짧습니다.

> 동일 유형의 **반사 최단거리 문제**는 “두 점에서 **한 직선**까지의 거리합”에서 특히 유용합니다. 문제에 따라 반사선의 교점이 내부가 아닐 수 있어 **경계 판정**을 꼭 해야 합니다.

---

## 4. 기하 응용 ③ — 정사각형 내부 직사각형의 최대 넓이 (대각선 접촉형)

**문제 개형**: 한 변이 \(a\)인 정사각형에서, **대각선에 내접**하는 축평행 직사각형의 최대 넓이.
좌하단을 원점, 정사각형을 \([0,a]\times[0,a]\), 대각선 \(y=a-x\).
직사각형을 \([0,x]\times[0,y]\)로 두고 **우상단 꼭짓점이 대각선 위**라면 \(y=a-x\).
넓이 \(A(x)=x(a-x)=ax-x^2\) → **정사각형의 축평행 내접 직사각형 최대는 \(x=a/2\)**에서 발생,
\(A_{\max}=\frac{a^2}{4}\).

> 대각선에 “접한다”는 조건을 축평행 직사각형(한 꼭짓점만 대각선)으로 해석.
> 회전 허용(임의 기울기 직사각형)은 최대가 **정사각형 자체**로 가거나 다른 최적화가 필요.

---

## 5. 일변수 — 폐구간 방법(경계 포함 필수)

**정리(Extreme Value Theorem)**: 연속 \( f \)가 닫힌구간 \([a,b]\)에서 최대/최소를 갖는다.
**절차**: (i) \(f'(x)=0\) 해(내부 임계점) (ii) 경계 \(a,b\). 이 세트에서 최대·최소를 비교.

**예제**: \( f(x)=x\sqrt{10-x}\) on \([0,10]\)
도함수로 내부 임계점 구하고 \(x=0,10\) 포함 비교.

**간단 검산 코드**
```python
import numpy as np
f  = lambda x: x*np.sqrt(10-x)
xs = np.linspace(0,10,20001)
xs[f(xs).argmax()], f(xs).max(), xs[f(xs).argmin()], f(xs).min()
```

---

## 6. 다변수 최적화 — 그래디언트·헤시안

### 6.1 임계점
- \( \nabla f(\mathbf{x}^\*)=\mathbf{0} \) (또는 존재하지 않음).
- 대칭 헤시안 \( H=\nabla^2 f \)의 고유값으로 판정:
  - \( H \succ 0 \) (양의 정부호) → **국소 극솟값**
  - \( H \prec 0 \) (음의 정부호) → **국소 극댓값**
  - 부호 섞임 → **안장점**

### 6.2 예제 — 타원형 접합
\( f(x,y)=x^2+4y^2-4x-8y \).
\( \nabla f=(2x-4,\,8y-8)=\mathbf{0} \Rightarrow (x,y)=(2,1) \).
\( H=\begin{pmatrix}2&0\\0&8\end{pmatrix}\succ 0 \Rightarrow \) **국소(=전역) 최소**.
최솟값 \( f(2,1)=4+4-8-8=-8 \).

**SymPy 검산**
```python
import sympy as sp
x,y = sp.symbols('x y', real=True)
f = x**2 + 4*y**2 - 4*x - 8*y
sp.hessian(f, (x,y)).eigenvals(), sp.solve([sp.diff(f,x), sp.diff(f,y)], [x,y]), f.subs({x:2,y:1})
```

---

## 7. 제약 최적화 — 라그랑주 승수 & KKT

### 7.1 등식제약: Lagrange Multipliers
**문제**: \( g(\mathbf{x})=c \) 제약 하에서 \( f(\mathbf{x}) \) 극값.
**조건**: \( \nabla f = \lambda \nabla g \) 와 \( g(\mathbf{x})=c \).

**예제 — 최대 체적**
제약 \( x+y+z=6 \)에서 \( V=xyz \) 최대(양수).
라그랑주:
\(\partial_x: yz=\lambda\), \(\partial_y: xz=\lambda\), \(\partial_z: xy=\lambda \Rightarrow x=y=z\).
제약으로 \(3x=6 \Rightarrow x=y=z=2\).
최대 \( V=8 \) (대칭성 + AM-GM로도 확인).

**SymPy**
```python
x,y,z,lam = sp.symbols('x y z lam', real=True, positive=True)
f = x*y*z
g = x+y+z-6
sol = sp.solve([
    sp.diff(f,x)-lam*sp.diff(g,x),
    sp.diff(f,y)-lam*sp.diff(g,y),
    sp.diff(f,z)-lam*sp.diff(g,z),
    g
], [x,y,z,lam], dict=True)
sol
```

### 7.2 부등식제약: KKT(필요조건)
\[
\min f(\mathbf{x})\ \text{s.t.}\ g_i(\mathbf{x})\le 0,\ h_j(\mathbf{x})=0.
\]
정칙성 하에서 **정상성** \( \nabla f+\sum \mu_i\nabla g_i+\sum \lambda_j\nabla h_j=0 \),
**보충슬랙** \( \mu_i g_i=0 \), \( \mu_i\ge 0 \), 제약 충족.
실전에서는 **활성 제약(active set)**를 추정/탐색하여 경계해를 판별.

**작은 예**: \( \min x^2+y^2\) s.t. \( x+y\ge 2\).
원점이 최솟값이지만 제약에 의해 허용 안 됨 → 경계 \( x+y=2\) 위에서 최소.
라그랑주 적용하면 \( x=y=1 \)로 최소 \(=2\).

---

## 8. 경제 응용 — 이윤극대화 & MR=MC

**수요** \( p(q)=a-bq \) (\(a,b>0\)), **비용** \( C(q)=c q + d \) (단위변수 \(c<a\))
**이윤** \( \pi(q)=p(q)q - C(q)=(a-bq)q - cq - d = aq - bq^2 - cq - d \).
미분: \( \pi'(q)=a-2bq - c \Rightarrow q^\*=\dfrac{a-c}{2b} \).
2차 미분 \( \pi''(q)=-2b<0 \Rightarrow \) 극대.
**MR=MC**: 한계수입 \( a-2bq \), 한계비용 \( c \). 교점이 위 해.

**검산**
```python
a,b,c,d = 10, 1, 2, 3
q = sp.symbols('q', real=True, nonnegative=True)
pi = (a-b*q)*q - (c*q + d)
sp.simplify(sp.diff(pi,q)), sp.solve(sp.diff(pi,q), q)[0], sp.diff(pi,q,2)
```

---

## 9. 물리 응용 — 최소 에너지/최단거리(변분 초입 개념)

- **스넬의 법칙**도 결국 “시간 최소(페르마의 원리)”에서 출발 → 매질별 속도 반영 시 \(\sin\theta/n\) 일정.
- **브라키스토크론**(낙하시간 최소 곡선)은 사이클로이드(변분법). 여기선 아이디어만: **국소적** 최소가 아니라 **함수공간 전체**에서 최소를 찾는 문제.

---

## 10. 공학 응용 — 박스 포장 최적화(무덮개)

**문제**: \( L\times W \) 판에서 네 귀퉁이 정사각형 \(x\)를 잘라 접어 상자 만들기(뚜껑 없음). 체적 최대 \(V(x)=x(L-2x)(W-2x)\), 단 \( 0<x<\min(L,W)/2\).

**예제**: \( L=30, W=20 \).
\( V'(x)=0\) 풀면 내부 임계점. 경계 \(x=0,10\) 포함 비교.

**검산 코드**
```python
L,W = 30,20
x = sp.symbols('x', real=True)
V = x*(L-2*x)*(W-2*x)
sp.factor(sp.diff(V,x))
float(sp.nsolve(sp.diff(V,x), 2.0))  # 초기값 2.0 부근 근
# 경계 포함 비교
cand = [0, W/2] + [float(sp.nsolve(sp.diff(V,x), 2.0))]
[(t, float(V.subs(x,t))) for t in cand]
```

---

## 11. 해석학적 도구 — 볼록성(Convexity)과 전역해

- \( f \)가 **볼록(convex)**이고 정의역이 볼록집합이면, 모든 국소극솟값은 **전역** 극솟값.
- \( \nabla^2 f(\mathbf{x}) \succeq 0 \) (헤시안 반정부호)면 **볼록 함수**.
- 선형/2차 최적화(제약 포함)는 강력한 이론·알고리즘(심플렉스, 내부점) 보유.

---

## 12. 수치 최적화 — 뉴턴/선탐색/그리드 검산

- **뉴턴법**: \( x_{k+1}=x_k - \dfrac{f'(x_k)}{f''(x_k)} \) (근접·볼록 시 빠름).
- **선탐색(line search)**: 다변수에서 방향 \(d\)를 정한 뒤 \( \min_{\alpha>0} f(x+\alpha d)\).
- **그리드/무차별 검산**: 모델 실수 잡는 데 매우 유용(경계·다봉형).

**예제 — 간단 뉴턴**
```python
def newton(f, fp, fpp, x0, it=20):
    x = x0
    for _ in range(it):
        x -= fp(x)/fpp(x)
    return x

f  = lambda x: -(x*(100-x)/2) # 넓이의 음수(최소화 = 넓이 최대화)
fp = lambda x: -(50 - x)
fpp= lambda x: -1
newton(f, fp, fpp, x0=10)  # -> 50 근방 수렴
```

---

## 13. 부등식·평균으로 빠르게 최적값 추정 (AM-GM 등)

- **AM-GM**: \( x,y>0 \Rightarrow \dfrac{x+y}{2} \ge \sqrt{xy} \) (등호: \(x=y\)).
  예: \( x+y=\text{const} \)에서 \( xy \) 최대는 \( x=y \).
- **코시-슈바르츠**: \( (\sum a_i b_i)^2 \le (\sum a_i^2)(\sum b_i^2) \).
  자주 **상계/하계**로 사용.

**예제**: \(x+y+z=6\)에서 \(xyz\) 최대 → \(x=y=z=2\) (라그랑주와 동일 결과).

---

## 14. 흔한 함정 & 디버깅 루틴

- **도함수 해를 찾고 끝** X → **경계/코너** 비교 필수.
- **허용범위 밖 임계점** 제외.
- **평탄 구간**(도함수 0이 연속 구간)에서는 **모든 점**이 극값 후보가 아님 — 경계 확인.
- **차원 축소**: 제약으로 변수 수를 먼저 줄이면 간단해짐.
- **대칭성**: 종종 정답이 \(x=y=z\) 같은 대칭형.
- **수치 검산**: 간단한 스윕/그리드로 식 오류를 즉시 잡을 수 있음.

---

## 15. 종합 예제 — “예산 제약 광고 집행” (다변수+경계)

**문제**: 플랫폼 A/B에 예산 \(B\) 배분. 클릭수 기대 \( f(x,y)=\alpha\sqrt{x}+\beta\sqrt{y} \) (체감수익),
제약 \( x+y=B, x,y\ge 0 \).
라그랑주:
\[
\max_{x+y=B} \alpha\sqrt{x}+\beta\sqrt{y}
\Rightarrow \partial_x: \frac{\alpha}{2\sqrt{x}}=\lambda,\ \partial_y:\frac{\beta}{2\sqrt{y}}=\lambda \Rightarrow
\frac{\alpha}{\sqrt{x}}=\frac{\beta}{\sqrt{y}} \Rightarrow \frac{x}{y}=\left(\frac{\alpha}{\beta}\right)^2.
\]
제약으로 \( x^\*=\dfrac{\alpha^2}{\alpha^2+\beta^2}B,\ y^\*=\dfrac{\beta^2}{\alpha^2+\beta^2}B \).
경계 \(x=0\) 또는 \(y=0\)는 \(\alpha=0\) 또는 \(\beta=0\) 같은 특이 경우 아니면 열등.

**코드 검산**
```python
import numpy as np
def clicks(x, B, a, b):
    y = B-x
    return a*np.sqrt(max(x,0)) + b*np.sqrt(max(y,0))
B,a,b = 100, 3.0, 1.0
xs = np.linspace(0,B,10001)
xs[xs.argmax()] if False else None
opt_x = (a*a)/(a*a + b*b) * B
opt_y = B - opt_x
opt_x, opt_y, clicks(opt_x, B, a, b), clicks(0,B,a,b), clicks(B,B,a,b)
```

---

## 16. 미니 실습 세트(직접 풀어 보기)

1) \( f(x)=x^4-4x^2 \)의 극값 분류, 전역 최대/최소(없을 수 있음) 토론.
2) \( \max\ A=xy \) s.t. \(2x+3y=60,\ x,y\ge 0\) (라그랑주 vs AM-GM 비교).
3) \( f(x,y)=x^3-3xy^2 \)의 임계점·헤시안·안장점 위치.
4) 박스 문제: \(L=40,W=30\)에서 무덮개 체적 최댓값(수치+해석).
5) MR=MC: \(p(q)=20-0.1q,\ C(q)=5q+50\). \(q^\*,\ \pi(q^\*)\) 계산.

---

## 17. 요약 표

| 범주 | 핵심 포인트 |
|---|---|
| 일변수 | \(f'(x)=0\) + 부호변화/2차 도함수, **경계 비교** |
| 다변수 | \(\nabla f=\mathbf{0}\), 헤시안 고유값으로 판정 |
| 등식제약 | 라그랑주 \( \nabla f=\lambda \nabla g \) |
| 부등식제약 | KKT(정상성+보충슬랙+제약) |
| 볼록성 | 볼록이면 국소=전역 최소, 해의 유일성 용이 |
| 응용 | 경제(MR=MC), 기하(넓이/거리), 공학(패키징) |
| 수치 | 뉴턴·선탐색·그리드 검산으로 모델 오류 방지 |

---

## 부록 A. SymPy 한 번에 맛보기(간단 레퍼런스)

```python
import sympy as sp
# 1. 일변수 극값
x = sp.symbols('x', real=True)
f = x*(100-x)/2
crit = sp.solve(sp.diff(f,x), x)        # 임계점
sec  = sp.diff(f,x,2).subs(x, crit[0])  # 2차 도함수
crit, sec, f.subs(x,crit[0])

# 2. 다변수 + 헤시안
x,y = sp.symbols('x y', real=True)
g = x**2 + 4*y**2 - 4*x - 8*y
sp.solve([sp.diff(g,x), sp.diff(g,y)], [x,y])
sp.hessian(g,(x,y)).eigenvals()

# 3. 라그랑주 승수
x,y,lam = sp.symbols('x y lam', real=True)
f = x*y
h = 2*x + 3*y - 60
sol = sp.solve([
    sp.diff(f,x) - lam*sp.diff(h,x),
    sp.diff(f,y) - lam*sp.diff(h,y),
    h
], [x,y,lam], dict=True)
sol, f.subs(sol[0])
```

---

### 마무리
극댓값/극솟값 문제의 80%는 **(i) 올바른 모델링 + (ii) 임계점/경계의 철저 비교 + (iii) 간단한 수치 검산**으로 해결됩니다.
더 깊이 가고 싶다면 **볼록최적화, 이차계획법(QP), KKT 정칙성, 라인서치·신뢰영역 Newton, 변분법** 등으로 확장하세요.
