---
layout: post
title: 미적분 - 극댓값과 극솟값의 응용
date: 2025-06-24 21:20:23 +0900
category: 미적분
---
# 극댓값·극솟값과 최적화 (Single/Multivariable Optimization, with proofs & code-ready examples)

극댓값/극솟값은 **최적화**의 언어다. 비용·이익·거리·시간·재료·면적… 대부분의 “최적” 문제는 **어떤 함수를 최대/최소**로 만드는 문제로 환원된다.  

---

## ✅ 0) 용어·정리 한 장 요약

- **국소 극댓값/극솟값**: 어떤 점 $$x^\*$$ 의 근방에서 $$f(x^\*)\ge f(x)$$(극대) 또는 $$\le$$(극소).  
- **절대(전역) 극값**: 정의역 전체에서의 최대/최소.  
- **임계점(critical point)**: $$f'(x)=0$$ 또는 미분 불능(코너 등).  
- **페르마 정리**: 미분 가능하고 극값이면 $$f'(x^\*)=0$$.  
- **극값 존재 정리(EVT)**: **연속** + **닫힌 유계 구간** ⇒ 절대 극값 존재.  
- **1차 판정**: $$f'$$ 부호변화( $$-\to +$$ 극소, $$+\to -$$ 극대 ).  
- **2차 판정**: $$f''(c)>0$$ 극소, $$f''(c)<0$$ 극대, $$=0$$이면 불충분.  
- **다변수 정상점**: $$\nabla f(\mathbf{x})=\mathbf{0}$$.  
- **헤시안 판정**: 양의/음의 정부호 ⇒ 극소/극대, 부정부호 ⇒ 안장.  
- **라그랑주 승수**: 제약 $$g=\mathbf{0}$$ 에서 $$\nabla f=\sum \lambda_i \nabla g_i$$.  
- **볼록성**: 볼록함수 + 볼록영역 ⇒ **모든 국소 극소가 전역 최소**.

---

## ✅ 1) 단변수 최적화 — 개념과 절차

### 1.1 기본 절차 (닫힌 구간 $$[a,b]$$ 가정)
1) **모델링**: 목적량을 $$f(x)$$ 로 수식화.  
2) **정의역/제약**: 물리적 제약(길이, 면적, 음수 불가 등) 반영.  
3) **임계점**: $$f'(x)=0$$ 과 미분 불능점 계산.  
4) **판정**: 1차 부호 변화 또는 2차 도함수로 극대/극소 성격 판정.  
5) **경계 비교**: $$x=a,b$$ 포함 비교해 **절대 극값** 결정.

> **열린 구간**이면 경계 없음. 발산/무한대/정의역 밖 점은 제외.

### 1.2 1차/2차 판정 미세 규칙
- **1차 판정**:  
  $$f'$$ 가 $$-\to+$$ 바뀌면 극소, $$+\to-$$ 바뀌면 극대, **변화 없으면** 극값 아님.
- **2차 판정**:  
  $$f''(c)>0$$(볼록) ⇒ 극소, $$f''(c)<0$$(오목) ⇒ 극대, $$=0$$이면 상위차 도함수/그래프 확인.

---

## ✅ 2) 단변수 대표 예제 (상세 풀이)

### 예제 A — 정사각형 대각선에 접하는 직사각형의 최대 넓이
한 변 길이 10인 정사각형에서 대각선에 한 변이 접하도록 하는 직사각형의 넓이 최대.

**모델링(대칭 좌표)**:  
$$A(x)=4x\sqrt{50-x^2},\quad 0<x<\sqrt{50}.$$

**미분**:  
$$
A'(x)=\frac{4(50-2x^2)}{\sqrt{50-x^2}}=0 \Rightarrow x=5.
$$

**최대값**:  
$$
A_{\max}=4\cdot 5\cdot \sqrt{25}=100,\qquad A''(5)<0\ \Rightarrow\ \text{극대}.
$$

---

### 예제 B — 강가 울타리(세 변만 울타리) 면적 최대
총 울타리 100 m. 가로 $$x$$, 세로 $$y$$, 강가 변은 울타리 없음.

**제약**: $$x+2y=100 \Rightarrow y=\frac{100-x}{2}.$$  
**목적**: $$A(x)=x y=\frac{100x-x^2}{2}.$$

**임계점**:  
$$
A'(x)=\frac{100-2x}{2}=0\Rightarrow x=50,\ y=25,\ A_{\max}=1250.
$$

---

### 예제 C — x축 위 점까지의 거리 합 최소 (반사법)
$$A(0,0),\ B(4,2)$$, x축 위 점 $$P(x,0)$$.

**거리 합**:  
$$
D(x)=|x|+\sqrt{(x-4)^2+4}.
$$

부호 구간별 미분 부호를 보면 **최소는 꺾임점** $$x=0$$:  
$$D_{\min}=\sqrt{20}.$$

**반사법 직관**: $$B'(4,-2)$$ 로 반사 후 직선 $$AB'$$ 가 x축과 만나는 점이 최적.  
$$AB'$$: $$y=-\tfrac12 x$$ ⇒ 교점 $$x=0$$.

---

### 예제 D — AM–GM으로 즉시 최적
양수 $$x>0$$, 상수 $$c>0$$ 에서  
$$
f(x)=x+\frac{c}{x}\ \ge\ 2\sqrt{c}\quad (\text{AM–GM}).
$$
평형 $$x=\sqrt{c}$$ 에서 최소.

> 빠른 **비미분** 최적화 테크닉: AM–GM, Cauchy–Schwarz, Jensen 등.

---

## ✅ 3) 고전 구조 최적화 (공학/디자인)

### (1) 뚜껑 없는 상자 최대 부피
한 변 $$L$$ 판재, 꼭짓점에서 정사각형 $$t$$ 잘라 접음.

$$
V(t)=t(L-2t)^2,\quad 0<t<\frac{L}{2},\quad
V'(t)=(L-2t)(L-6t)=0.
$$
최적 $$t=\frac{L}{6}$$,  
$$V_{\max}=\frac{L^3}{54}.$$

---

### (2) 고정 체적 원기둥 표면적 최소
체적 $$V=\pi r^2h$$, 표면적 $$S=2\pi r^2+2\pi r h$$.

$$
h=\frac{V}{\pi r^2}\Rightarrow
S(r)=2\pi r^2+\frac{2V}{r},\quad
S'(r)=4\pi r-\frac{2V}{r^2}=0.
$$
해 $$h=2r$$ (높이=지름).

---

### (3) 재료비 가중(벽/천장 단가 상이)
바닥/옆면/상면 단가를 $$c_b,c_s,c_t$$ 로 두면  
목적 $$c_b \cdot \text{바닥면적}+c_t\cdot \text{상면}+c_s\cdot \text{옆면적}$$ 을 **제약(부피)** 하에 최소화.  
라그랑주 승수로 일반형 도출(아래 다변수 제약 최적화 참고).

---

## ✅ 4) 다변수 무제약 최적화

### 4.1 정상점과 헤시안
정상점: $$\nabla f(\mathbf{x})=\mathbf{0}.$$

헤시안 $$H(\mathbf{x})=\nabla^2 f(\mathbf{x})$$ 의 정부호성으로 판정:
- **양의 정부호** ⇒ 국소 극소  
- **음의 정부호** ⇒ 국소 극대  
- **부정부호** ⇒ 안장

**실무 판정 (2×2)**:  
$$
H=\begin{pmatrix} f_{xx} & f_{xy}\\ f_{yx} & f_{yy}\end{pmatrix},\ 
\det H>0,\ f_{xx}>0\Rightarrow \text{극소};\quad
\det H>0,\ f_{xx}<0\Rightarrow \text{극대};\ 
\det H<0\Rightarrow \text{안장}.
$$
(고차원은 **주요소행렬식(leading principal minors)** 로 Sylvester 판정 사용)

### 4.2 예 — 이차식의 극값
$$
f(x,y)=x^2+y^2+xy-6x-2y+10.
$$
정상점:  
$$
\partial_x f=2x+y-6=0,\quad \partial_y f=x+2y-2=0
\Rightarrow (x,y)=(2,0).
$$
헤시안  
$$
H=\begin{pmatrix}2&1\\1&2\end{pmatrix}\ \ (\det=3>0, f_{xx}=2>0)
$$
⇒ **국소 극소**.

---

## ✅ 5) 등식 제약 최적화 — 라그랑주 승수

제약 $$g(x,y)=0$$ 에서  
$$
\nabla f=\lambda \nabla g,\quad g=0.
$$

### 예 — 원 위에서 선형함수 최대/최소
$$
\max/\min\ f(x,y)=3x+y\quad\text{s.t.}\quad x^2+y^2=1.
$$
$$
(3,1)=\lambda(2x,2y),\ x^2+y^2=1
\Rightarrow (x,y)=\left(\frac{3}{\sqrt{10}},\frac{1}{\sqrt{10}}\right)\ (\max),
\ \left(-\frac{3}{\sqrt{10}},-\frac{1}{\sqrt{10}}\right)\ (\min).
$$

> **다중 제약**: $$\nabla f=\sum_i \lambda_i \nabla g_i$$.  
> **부등식 제약**은 KKT 조건(활성 제약/여러 승수)로 일반화.

---

## ✅ 6) 경계/코너를 포함한 절대 극값 찾기

- **닫힌 영역**: 내부 **정상점** + **경계**(매개화 또는 한 차수 축소) + **코너(교점)** 비교.  
- **미분 불능점**(절댓값/노름/최대연산 등)도 후보에 포함.

**미니 예**:  
$$\min\ f(x,y)=|x|+|y|\ \text{ s.t. } x^2+y^2=1.$$
대칭성으로 축 교차점 $$\{(\pm1,0),(0,\pm1)\}$$ 후보 → 최소는 $$\min 1,1=1.$$

---

## ✅ 7) 볼록성으로 전역 최소 보장

- **볼록함수**:  
  $$f(\theta x+(1-\theta)y)\le \theta f(x)+(1-\theta)f(y),\ 0\le\theta\le1.$$
- **결론**: 볼록 영역에서 볼록 $$f$$ 의 **모든 국소 극소는 전역 최소**.  
- **예**: Ridge( $$\lambda\|w\|_2^2$$ ), Lasso( $$\lambda\|w\|_1$$ ) + **볼록 손실**(MSE, 로지스틱) ⇒ 전역 최소.

---

## ✅ 8) 수치 최적화 스냅샷 (코드 포함)

### 8.1 뉴턴 방법(1D)
$$
x_{k+1}=x_k-\frac{f'(x_k)}{f''(x_k)}\quad(\text{근방에서 이차수렴}).
$$

```python
# 1D Newton's method for finding a stationary point
def newton_optimize(f1, f2, x0, iters=20, tol=1e-10):
    x = x0
    for _ in range(iters):
        g, h = f1(x), f2(x)
        if abs(h) < 1e-12: break  # Hessian 0 근처 방지
        step = g / h
        x_new = x - step
        if abs(x_new - x) < tol: 
            return x_new
        x = x_new
    return x

# f(x)=x^3-6x^2+9x  → f'와 f'' 정의
f1 = lambda x: 3*x**2 - 12*x + 9
f2 = lambda x: 6*x - 12
print(newton_optimize(f1, f2, x0=0.0))  # ~1.0 (극대)
print(newton_optimize(f1, f2, x0=5.0))  # ~3.0 (극소)
```

### 8.2 기울기 하강법(2D) — 등고선 시각용
```python
import numpy as np

def grad_f(xy):
    x, y = xy
    # f(x,y)=x^2+y^2+xy-6x-2y+10
    return np.array([2*x + y - 6, x + 2*y - 2])

def gd(xy0, alpha=0.1, steps=100):
    xy = np.array(xy0, dtype=float)
    path = [xy.copy()]
    for _ in range(steps):
        xy -= alpha * grad_f(xy)
        path.append(xy.copy())
    return np.array(path)

path = gd([0,0], alpha=0.2, steps=50)
print(path[-1])  # (2,0) 근방 수렴
```

> 시각화 팁: 동일 그리드에 **등고선(contour)** + **이동 경로**를 점/선으로 그리면 수렴 직관이 좋다.

---

## ✅ 9) “모델링 → 판정 → 경계비교” 실전 레시피

1) **변수 설정**(최소한의 자유도)  
2) **모든 제약을 수식화**(등식/부등식)  
3) **목적함수**를 명확히 정의(단위·해석 가능성 체크)  
4) **미분/정상점** 계산(1D: $$f'$$, nD: $$\nabla f$$)  
5) **판정**(1·2차/헤시안/볼록성)  
6) **경계/코너**를 별도 문제로 풀어 **비교**  
7) **물리적 타당성**(음수·제약 위반 제거), **민감도**(파라미터 변화) 확인

---

## ✅ 10) 추가 예제 모음 (풀이 포함)

### (1) 사다리 문제(직교 경계에 끼운 막대의 최단 길이)
폭 $$a,b$$ 복도 직각 코너를 돌릴 수 있는 사다리 최대 길이 $$L$$.  
표준 모델:  
$$
L(\theta)=\frac{a}{\sin\theta}+\frac{b}{\cos\theta},\ \ 0<\theta<\frac{\pi}{2}.
$$
미분하여 최소값을 찾으면  
$$
L_{\min}=(a^{2/3}+b^{2/3})^{3/2}.
$$
(유도는 연습)

---

### (2) 두 구간 평균거리 최소(스니퍼 문제 변형)
점 $$P(x,0)$$ 에서 두 점 $$A(0,a), B(d,-b)$$ 까지 거리합 최소는  
**반사법**으로 $$B$$ 를 x축에 반사하여 직선 $$AB'$$ 와 x축 교점.

---

### (3) 세금/가격의 이익최적 (MR=MC)
수요 $$p(q)=\alpha-\beta q$$, 비용 $$C(q)=c q$$.  
이익 $$\Pi(q)=p(q)q-C(q)=(\alpha-\beta q)q - c q$$.  
$$
\Pi'(q)=\alpha - 2\beta q - c=0\Rightarrow q^\*=\frac{\alpha-c}{2\beta},\quad
p^\*=\alpha-\beta q^\*=\frac{\alpha+c}{2}.
$$
(선형 수요·선형 비용의 교과서 해)

---

### (4) 경계 포함 극값 — 다각형 영역
삼각형 영역에서 $$f(x,y)=x-y$$ 의 최소/최대는 **정점**에서 발생(선형 목적 + 다면체 제약 ⇒ 심플렉스 직관).

---

## ✅ 11) 자주 하는 실수 체크리스트

- [ ] **정의역/제약**을 빠뜨림(음수 길이, 범위 벗어난 $$x$$ 등).  
- [ ] **경계/코너** 비교 누락(닫힌 구간/유계 폐집합).  
- [ ] **미분 불능점**(절댓값/노름 등) 후보에서 배제.  
- [ ] 2차 판정에서 $$f''=0$$ 인데 극값이라 단정(불충분).  
- [ ] 다변수에서 **헤시안** 없이 직감으로 판정(안전하지 않음).  
- [ ] 라그랑주 승수에서 **제약식 대입/정상점 후보 정리** 미흡.

---

## ✅ 12) 시각화 코드 (1D/2D 그래프)

### 12.1 단변수: 극대/극소와 도함수 부호
```python
import numpy as np
import matplotlib.pyplot as plt

# f(x) = x^3 - 6x^2 + 9x
x = np.linspace(-1, 5, 400)
f = x**3 - 6*x**2 + 9*x
fp = 3*x**2 - 12*x + 9

plt.plot(x, f, label='f(x)')
plt.plot(x, fp, linestyle='--', label="f'(x)")
plt.axhline(0, linewidth=1)
plt.title('극대/극소와 도함수 부호')
plt.legend(); plt.grid(True); plt.show()
```

### 12.2 다변수: 등고선 + 경사하강 경로
```python
import numpy as np
import matplotlib.pyplot as plt

def f(x, y):
    return x**2 + y**2 + x*y - 6*x - 2*y + 10

# grid
xs = np.linspace(-1, 4, 200)
ys = np.linspace(-2, 2, 200)
X, Y = np.meshgrid(xs, ys)
Z = f(X, Y)

# GD path (from section 8.2)
def grad_f(xy):
    x, y = xy
    return np.array([2*x + y - 6, x + 2*y - 2])

def gd(xy0, alpha=0.2, steps=25):
    xy = np.array(xy0, float)
    path = [xy.copy()]
    for _ in range(steps):
        xy -= alpha * grad_f(xy)
        path.append(xy.copy())
    return np.array(path)

path = gd([0, 0], alpha=0.2, steps=25)

plt.contour(X, Y, Z, levels=20)
plt.plot(path[:,0], path[:,1], marker='o', linestyle='-')
plt.title('등고선과 경사하강 경로 (→ (2,0))')
plt.xlabel('x'); plt.ylabel('y'); plt.grid(True); plt.axis('equal'); plt.show()
```

---

## ✅ 13) 연습문제 (해설 스케치)

1) $$f(x)=x^3-6x^2+9x$$ 의 극값과 종류  
   - $$f'(x)=3(x-1)(x-3)$$, 부호표로 $$x=1$$ **극대**, $$x=3$$ **극소**.

2) $$A=x(12-2x)$$ 최대  
   - $$A'(x)=12-4x=0\Rightarrow x=3,\ A_{\max}=27.$$

3) 원 $$x^2+y^2=1$$ 에서 $$f(x,y)=x^2+3y^2$$ 최소/최대  
   - 라그랑주: $$\nabla f=\lambda \nabla g= \lambda(2x,2y)$$ ⇒  
     $$x=\lambda x,\ 3y=\lambda y$$ ⇒ (i) $$x\ne0\Rightarrow \lambda=1$$, (ii) $$y\ne0\Rightarrow \lambda=3$$.  
   - 후보: $$(\pm1,0)\Rightarrow f=1,\ (0,\pm1)\Rightarrow f=3.$$  
   - **최소**: 1, **최대**: 3.

4) 사다리 길이 최소 값 유도  
   - $$L(\theta)=\frac{a}{\sin\theta}+\frac{b}{\cos\theta}$$ 미분 → $$L'(\theta)=0$$ ⇒  
     $$a\cos^3\theta=b\sin^3\theta \Rightarrow \tan\theta=(a/b)^{1/3},\ \ L_{\min}=(a^{2/3}+b^{2/3})^{3/2}.$$

5) 볼록 최적화: $$\min_x \ \frac{1}{2}\|Ax-b\|_2^2+\lambda\|x\|_1$$ (라소)  
   - 볼록+폐집합 ⇒ 전역해 존재, 국소해=전역해. KKT로 서브그래디언트 조건 확인.

---

## 🔚 요약 정리

- **단변수**: 임계점(=0/미분불능) + **경계** 비교 ⇒ 절대 극값.  
- **다변수**: $$\nabla f=0$$, **헤시안**으로 성격 판정, 제약은 **라그랑주 승수**.  
- **볼록성**이 보이면 전역 최소 보장, 미분 없이도 **AM–GM** 등으로 빠르게 판단 가능.  
- 실무 루틴: **모델링 → 미분/정상점 → 판정(1·2차/헤시안/볼록) → 경계/코너 비교 → 현실성 필터**.

> **Tip**: 복잡할수록 “변수 치환(자유도 축소) → 대칭/스케일 분석 → 경계 매개화 → 수치검증(뉴턴/그라디언트)” 순서를 습관화하라.