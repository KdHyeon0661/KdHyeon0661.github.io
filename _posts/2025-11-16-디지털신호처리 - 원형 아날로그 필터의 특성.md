---
layout: post
title: 디지털신호처리 - 원형 아날로그 필터의 특성
date: 2025-11-16 22:25:23 +0900
category: 디지털신호처리
---
# 원형 아날로그 필터의 특성

## 1. 왜 “원형 아날로그 필터(protoype)”인가?

디지털 IIR 필터 설계의 고전적 흐름은 거의 항상 다음과 같다.

1. **디지털 스펙** 정리

   - 샘플링 주파수  
     $$F_s$$
   - 통과대역 끝 주파수  
     $$\omega_p\ (\text{디지털})$$ 또는  
     $$F_p\ (\text{Hz})$$
   - 저지대역 시작 주파수  
     $$\omega_s$$ 또는  
     $$F_s'$$
   - 허용 통과대역 리플  
     $$A_p\ [\mathrm{dB}]$$
   - 필요한 저지대역 감쇠  
     $$A_s\ [\mathrm{dB}]$$

2. **아날로그 영역으로 맵핑**

   - bilinear 변환을 사용하면, 디지털 주파수 \(\omega\)와 아날로그 주파수 \(\Omega\) 사이에 **비선형 매핑**이 생긴다.

     $$ 
     s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}, \qquad
     \Omega = \frac{2}{T} \tan\left(\frac{\omega}{2}\right)
     $$

   - 디지털에서 지정된 \(\omega_p, \omega_s\)를 **prewarping** 해서 아날로그 \(\Omega_p, \Omega_s\)로 변환한다.

3. **원형 아날로그 저역통과 필터 설계**

   여기서 말하는 “원형 아날로그 필터”가 등장한다.

   - 먼저 **정규화된 아날로그 저역통과 프로토타입**을 설계한다.
   - 예: Butterworth, Chebyshev, Elliptic, Bessel 등.

   일반적인 형태:

   $$
   H_p(s) = \frac{K}{\prod_{k=1}^{N} (s - p_k)}
   $$

   또는 크기 제곱 응답으로:

   $$
   |H_p(j\Omega)|^2 = \frac{1}{1 + \varepsilon^2 F^2(\Omega / \Omega_c)}
   $$

   - \(\Omega_c\): 기준 cutoff (보통 \(\Omega_c = 1\)로 두고 정규화)
   - \(F(\cdot)\): 필터 family에 따라 달라지는 함수
   - \(\varepsilon\): 리플/감쇠를 제어하는 파라미터

4. **필요하다면 저역통과→고역통과/대역통과/대역저지 변환**

   - LP→HP:  
     $$ s \to \frac{\Omega_c^2}{s} $$
   - LP→BP:  
     $$ s \to \frac{s^2 + \Omega_0^2}{B s} $$
     (중심 주파수 \(\Omega_0\), 대역폭 \(B\))
   - LP→BS:  
     $$ s \to \frac{B s}{s^2 + \Omega_0^2} $$

5. **bilinear 변환으로 디지털 필터로 변환**

   - \( s \to \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}} \)
   - 결과로 얻어지는 디지털 전송함수 \(H(z)\)의 계수 \(\{b_k\},\{a_k\}\)를 사용해 IIR 필터를 구현한다.

정리하면, **“원형 아날로그 필터”**는 디지털 설계를 위해

- 저역통과 기준
- \(\Omega\) 축 기준
- 표준화된 수식

으로 정의해 둔 **기준 모형**이다.  
이 기준 모형에서 각 family의 특성을 이해해두면, 디지털 설계에서 왜 Butterworth를 선택했는지, 왜 Elliptic이 차수가 가장 낮은지, 왜 Bessel은 급격한 roll-off 대신 시간 응답을 택하는지 등 전체 그림이 명확해진다.

---

## 2. 원형 저역통과 프로토타입의 기본 정의

### 2.1 정규화 기준

많은 교과서에서는 **컷오프 주파수 \(\Omega_c = 1\)** rad/s인 **정규화 아날로그 저역통과 필터**로 정의한다.

- 필터 차수: \(N\)
- 정규화 주파수 변수:  
  $$ \Omega' = \frac{\Omega}{\Omega_c} $$  
  정규화 후에는 \(\Omega_c = 1\) 이므로 \(\Omega' = \Omega\) 처럼 쓴다.

예를 들어, Butterworth 필터의 경우 크기 제곱 응답을

$$
|H(j\Omega)|^2 = \frac{1}{1 + \Omega^{2N}}
$$

로 두고 (여기서 \(\Omega_c = 1\)),  
나중에 원하는 실제 아날로그 컷오프 \(\Omega_c'\) 를 주고

$$
\Omega \to \frac{\Omega}{\Omega_c'}
\quad\Rightarrow\quad
s \to \frac{s}{\Omega_c'}
$$

와 같은 스케일 변환으로 실제 필터를 얻는다.

### 2.2 스펙 정의 (아날로그 기준)

원형 아날로그 저역통과에서의 전형적인 설계 스펙:

- 통과대역 최대 주파수: \(\Omega_p\) (rad/s)
- 저지대역 시작 주파수: \(\Omega_s\) (rad/s)
- 통과대역 허용 리플: \(A_p\) dB
- 저지대역 요구 감쇠: \(A_s\) dB

이때 보통 다음과 같은 조건을 둔다.

- 통과대역 내에서( \(|\Omega| \le \Omega_p\) )

  $$
  |H(j\Omega)| \ge 10^{-A_p/20}
  $$

- 저지대역에서( \(|\Omega| \ge \Omega_s\) )

  $$
  |H(j\Omega)| \le 10^{-A_s/20}
  $$

이 스펙을 만족하는 **최소 차수 \(N\)** 와 **컷오프 주파수 \(\Omega_c\)** 를 family별 공식으로부터 구한다.

---

## 3. Butterworth 원형 아날로그 필터

### 3.1 크기 응답 특성 (maximally flat)

Butterworth 필터는 **통과대역에서 최대한 평탄한(maximally flat) 크기 응답**을 갖도록 설계된 필터이다.

정규화 형태 (\(\Omega_c = 1\)):

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \Omega^{2N}}
$$

여기서

- \(\Omega = 0\) 에서 \(|H(j0)| = 1\)
- \(\Omega = 1\) 에서  
  $$ |H(j1)|^2 = \frac{1}{2} $$  
  즉, 컷오프 \(\Omega_c\) 에서 \(-3\) dB (정확히는 Butterworth 기준일 때) 지점.

**“Maximally flat”**의 의미:

- \(\Omega = 0\) 근처의 \(|H(j\Omega)|\)의 Taylor 전개에서,  
  \(0\)차부터 \(2N-1\)차까지 도함수가 모두 0이 되도록 설계된다.
- 즉, 통과대역 초기 구간이 **가장 부드럽고 평탄**하게 시작되도록 하는 조건.

### 3.2 스펙에서 차수 \(N\) 결정

스펙:

- 통과대역: \(|\Omega| \le \Omega_p\), 허용 리플 \(A_p\) dB
- 저지대역: \(|\Omega| \ge \Omega_s\), 요구 감쇠 \(A_s\) dB

Butterworth에서 크기 제곱은

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \left(\frac{\Omega}{\Omega_c}\right)^{2N}}
$$

\(\Omega = \Omega_p\) 에서 통과대역 리플 조건:

$$
|H(j\Omega_p)|^2
\ge
10^{-A_p/10}
$$

즉,

$$
\frac{1}{1 + \left(\frac{\Omega_p}{\Omega_c}\right)^{2N}}
\ge
10^{-A_p/10}
$$

저지대역 조건:

$$
|H(j\Omega_s)|^2
\le
10^{-A_s/10}
\quad\Rightarrow\quad
\frac{1}{1 + \left(\frac{\Omega_s}{\Omega_c}\right)^{2N}}
\le
10^{-A_s/10}
$$

이를 정리하면 차수 \(N\)에 대한 부등식을 얻고, 최소 \(N\)을 구할 수 있다.

표준 공식 형태:

$$
N
\ge
\frac{
\log_{10}\left( \frac{10^{A_s/10} - 1}{10^{A_p/10} - 1} \right)
}{
2 \log_{10} \left( \frac{\Omega_s}{\Omega_p} \right)
}
$$

따라서 실제 설계에서는

$$
N = \left\lceil
\frac{
\log_{10}\left( \frac{10^{A_s/10} - 1}{10^{A_p/10} - 1} \right)
}{
2 \log_{10} \left( \frac{\Omega_s}{\Omega_p} \right)
}
\right\rceil
$$

로 차수를 결정한다.

컷오프 \(\Omega_c\)는 통과대역 조건을 만족하도록 결정:

$$
\Omega_c
=
\Omega_p
\left(
10^{A_p/10}-1
\right)^{-1/(2N)}
$$

또는 저지대역 쪽에서도 같은 \(\Omega_c\)가 나오도록 맞추는 방식으로.

### 3.3 s-평면 극점 분포

정규화된 Butterworth \(N\)차 프로토타입의 극점은

$$
p_k = \Omega_c e^{j\left( \frac{\pi}{2} + \frac{(2k+1)\pi}{2N} \right)},\quad
k=0,1,\dots,N-1
$$

- \(|p_k| = \Omega_c\)  
  → 반지름 \(\Omega_c\) 인 원 위에 균등하게 배치.
- 좌반평면(LHP)에만 존재 (실제 전송함수는 안정해야 하므로).

텍스트 그림으로 표시하면:

```text
         Im{s}
          |
      o   |   o
          |
  o       |       o
----------+-----------> Re{s}
  o       |       o
          |
      o   |   o
          |
```

- 동심원 위에 대칭적인 위치에 극점들이 분포한다 (N에 따라 밀도만 달라짐).

### 3.4 GNU Octave: 아날로그 Butterworth 원형 필터 응답

GNU Octave signal 패키지의 `butter`는 MATLAB과 마찬가지로 `'s'` 옵션을 사용해 **아날로그 필터**를 설계할 수 있다.

예: 5차 Butterworth 저역통과, 컷오프 \(\Omega_c = 2\pi \cdot 1000\) rad/s (즉, 1 kHz)

```octave
pkg load signal;
clear; close all; clc;

N = 5;                % 차수
Fc = 1000;            % Hz
Omega_c = 2*pi*Fc;    % rad/s

% 아날로그 Butterworth 원형 필터 설계
[b, a] = butter(N, Omega_c, "s");

% 아날로그 주파수 축 (log space)
w = logspace(1, 5, 1000);   % 10~1e5 rad/s
H = freqs(b, a, w);         % 아날로그 주파수 응답

figure;
subplot(3,1,1);
semilogx(w/(2*pi), 20*log10(abs(H)+eps));
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title(sprintf('Analog Butterworth LPF (N=%d, Fc=1kHz)', N));
ylim([-80 5]);

subplot(3,1,2);
semilogx(w/(2*pi), unwrap(angle(H)));
grid on;
xlabel('Frequency (Hz)');
ylabel('Phase (rad)');
title('Phase response');

% 군지연 (수치 미분)
dw = diff(w);
dphi = diff(unwrap(angle(H)));
tau_g = - dphi ./ dw;  % group delay [s] (대략적인 근사)

subplot(3,1,3);
semilogx(w(1:end-1)/(2*pi), tau_g);
grid on;
xlabel('Frequency (Hz)');
ylabel('Group delay (s)');
title('Approx. group delay (Butterworth)');
```

- 위 그래프를 보면
  - **크기 응답**: 통과대역은 매우 평탄, 전이대역 이후 점점 줄어드는 monotonic 형태.
  - **위상 응답**과 **군지연**: FIR 선형위상처럼 평평하지 않고, 주파수에 따라 변하는 비선형.

---

## 4. Chebyshev I 원형 아날로그 필터 (통과대역 등리플)

### 4.1 Chebyshev 다항식과 크기 응답

Chebyshev I 필터는 *통과대역*에서 등리플(equiripple) 특성을 갖는다.

정규화 아날로그 저역통과 형태에서 크기 제곱 응답:

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \varepsilon^2 T_N^2\left( \frac{\Omega}{\Omega_c} \right)}
$$

- \(T_N(x)\): N차 Chebyshev 다항식

  $$
  T_N(x) = \cos(N \arccos x), \quad |x| \le 1
  $$

- \(\varepsilon\): 통과대역 리플을 제어하는 파라미터

통과대역에서 \(|\Omega| \le \Omega_p\) 라고 하면, \(\frac{\Omega_p}{\Omega_c} \le 1\) 이고 이 구간에서 \(T_N(x)\)는 \([-1,1]\) 범위의 진동을 한다. 따라서

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \varepsilon^2 T_N^2(\cdot)}
$$

은 통과대역 안에서 **“등리플”**이 된다.

통과대역에서 최소 크기:

$$
|H|_{\min} = \frac{1}{\sqrt{1 + \varepsilon^2}}
$$

따라서 통과대역 리플 \(A_p\)는

$$
A_p = -20 \log_{10} |H|_{\min}
    = 10 \log_{10}(1 + \varepsilon^2)
$$

즉,

$$
\varepsilon = \sqrt{10^{A_p/10} - 1}
$$

### 4.2 차수 \(N\) 공식

Chebyshev I도 스펙 \((\Omega_p, \Omega_s, A_p, A_s)\)에서 아래와 같은 형태의 공식으로 차수를 구한다.

저지대역에서 \(|\Omega|\ge\Omega_s\) 일 때 \(|H(j\Omega_s)|^2 \le 10^{-A_s/10}\)를 만족하려면:

$$
\frac{1}{1 + \varepsilon^2 T_N^2\left(\frac{\Omega_s}{\Omega_c}\right)}
\le
10^{-A_s/10}
$$

이를 정리하면

$$
\varepsilon^2 T_N^2\left(\frac{\Omega_s}{\Omega_c}\right)
\ge
10^{A_s/10} - 1
$$

Chebyshev 다항식의 정의를 이용해, 결국 다음과 같은 형태의 차수 공식이 얻어진다.

$$
N
\ge
\frac{
\cosh^{-1}\left(
\sqrt{
\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}
}
\right)
}{
\cosh^{-1}\left( \frac{\Omega_s}{\Omega_p} \right)
}
$$

- 여기서 \(\Omega_p\) 와 \(\Omega_s\) 는 아날로그 축 (rad/s)에서의 주변 값.
- 실무에서는 위 식으로 \(N\) 을 구하고, **올림(\(\lceil\cdot\rceil\))** 처리한다.

### 4.3 GNU Octave: 아날로그 Chebyshev I 원형 필터 응답

GNU Octave에서 아날로그 Chebyshev I 저역통과를 설계하려면 `cheby1`에 `"s"` 옵션을 사용한다.

예: 아날로그 저역통과, \(\Omega_p = 2\pi \cdot 1000\) rad/s, \(A_p = 1\) dB, 차수 \(N = 5\)

```octave
pkg load signal;
clear; close all; clc;

N  = 5;
Ap = 1;                % dB passband ripple
Fp = 1000;             % Hz
Omega_p = 2*pi*Fp;     % rad/s

[b, a] = cheby1(N, Ap, Omega_p, "s");  % 아날로그 LPF

w = logspace(1, 5, 1000);
H = freqs(b, a, w);

figure;
subplot(2,1,1);
semilogx(w/(2*pi), 20*log10(abs(H)+eps));
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title(sprintf('Analog Chebyshev I LPF (N=%d, Fp=%g Hz, Ap=%g dB)', N, Fp, Ap));
ylim([-80 5]);

subplot(2,1,2);
semilogx(w/(2*pi), unwrap(angle(H)));
grid on;
xlabel('Frequency (Hz)');
ylabel('Phase (rad)');
title('Phase response');
```

- Butterworth와 달리 **통과대역에 리플**이 있는 것을 확인할 수 있다.
- 같은 스펙에서 Butterworth보다 **차수가 작게 나오는** 경향이 있다.

---

## 5. Chebyshev II 원형 필터 (저지대역 등리플)

### 5.1 개념

Chebyshev II 필터는 Chebyshev I와 반대로:

- **통과대역**: 모노토닉 (리플 없음)
- **저지대역**: 등리플

크기 응답 제곱은

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \frac{1}{\varepsilon^2 T_N^2\left( \frac{\Omega_c}{\Omega} \right)}}
$$

- \(\varepsilon\): 저지대역 리플의 크기를 결정.
- 설계 시에는 저지대역 감쇠 \(A_s\)를 통해 \(\varepsilon\)이 정해지고,
- 통과대역 조건으로 차수 \(N\)과 \(\Omega_c\)를 맞춘다.

### 5.2 GNU Octave: 아날로그 Chebyshev II 예제

예: 차수 \(N=5\), 저지대역 감쇠 \(A_s=60\) dB, 저지대역 시작 \(\Omega_s = 2\pi\cdot 2000\) rad/s

```octave
pkg load signal;
clear; close all; clc;

N  = 5;
As = 60;               % dB stopband attenuation
Fs = 2000;             % Hz (stopband begins)
Omega_s = 2*pi*Fs;

[b, a] = cheby2(N, As, Omega_s, "s");   % 아날로그 LPF 형태에서의 Chebyshev II

w = logspace(1, 5, 1000);
H = freqs(b, a, w);

figure;
semilogx(w/(2*pi), 20*log10(abs(H)+eps));
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title(sprintf('Analog Chebyshev II LPF (N=%d, As=%g dB, Fs=%g Hz)', N, As, Fs));
ylim([-100 5]);
```

Chebyshev II의 장단점:

- 장점:
  - 통과대역에서 리플 없음 (Butterworth처럼 평탄).
  - Chebyshev I와 달리 **저지대역이 등리플**이라 매우 빠른 감쇠.
- 단점:
  - 저지대역 등리플은 스펙트럼 분석에서 스퓨리어스가 일정 수준 이상 남는다.
  - 설계가 다소 복잡.

---

## 6. Elliptic(=Cauer) 원형 필터 (통과·저지대역 모두 등리플)

### 6.1 개념

Elliptic(또는 Cauer) 필터는 **통과대역과 저지대역 모두에서 등리플**을 허용하는 대신,  
동일 스펙에서 **가장 낮은 차수**로 달성 가능한 필터다.

크기 제곱 응답은 **Rational Chebyshev 함수**를 통해 표현된다.

$$
|H(j\Omega)|^2
=
\frac{1}{1 + \varepsilon^2 R_N^2\left(\frac{\Omega}{\Omega_c}\right)}
$$

- \(R_N(\cdot)\): rational Chebyshev 함수 (Jacobian elliptic 함수 기반).
- \(\varepsilon\): 통과대역 리플 설정.
- 저지대역 리플/감쇠는 추가 파라미터로 조절.

스펙:

- 통과대역 \(|\Omega|\le\Omega_p\) 에서 최대 리플: \(A_p\) dB
- 저지대역 \(|\Omega|\ge\Omega_s\) 에서 리플/감쇠: \(A_s\) dB

Elliptic 필터는 이 두 조건을 동시에 만족하면서 **차수 \(N\)** 를 최소로 만드는 특성을 가진다.

### 6.2 GNU Octave: 아날로그 Elliptic 예제

예: \(\Omega_p = 2\pi\cdot 1000\) rad/s, \(\Omega_s = 2\pi\cdot 2000\) rad/s, \(A_p = 1\) dB, \(A_s=60\) dB

```octave
pkg load signal;
clear; close all; clc;

Fp = 1000;   % passband edge (Hz)
Fs1 = 2000;  % stopband edge (Hz)
Ap = 1;      % passband ripple (dB)
As = 60;     % stopband attenuation (dB)

Omega_p = 2*pi*Fp;
Omega_s = 2*pi*Fs1;

% ellipord/ellip 은 통상 디지털용이지만,
% 여기서는 아날로그 주파수에 대해 사용하는 예를 보여준다.
% (GNU Octave 버전에 따라 사용법을 확인해야 한다.)

% 간단히 차수 N을 가정하고, 아날로그 LPF 설계:
N = 5;   % 실제로는 ellipord를 통해 구할 수 있다.
[b, a] = ellip(N, Ap, As, Omega_p, "s");

w = logspace(1, 5, 1000);
H = freqs(b, a, w);

figure;
semilogx(w/(2*pi), 20*log10(abs(H)+eps));
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title(sprintf('Analog Elliptic LPF (N=%d, Fp=%g Hz, Fs=%g Hz, Ap=%g dB, As=%g dB)', ...
              N, Fp, Fs1, Ap, As));
ylim([-100 5]);
```

Elliptic 필터의 특징:

- 가장 **급격한 roll-off**: 같은 \(A_p, A_s, \Omega_p, \Omega_s\) 스펙일 때 차수 \(N\)이 가장 작다.
- 통과·저지대역 모두 등리플 → 스펙트럼에서 균일한 ripple.
- 위상/군지연은 상당히 비선형 → 시간 영역 파형 왜곡이 커질 수 있다.

---

## 7. Bessel 원형 필터 (군지연 최적화)

### 7.1 개념

Bessel 필터는 크기 응답이 아닌 **군지연(group delay)** 에 최적화된 필터이다.

- 목표: 저주파수 영역에서 **군지연이 최대한 상수** (flat) → **파형 보존**.
- 크기 응답은 Butterworth보다도 더 **완만**한 roll-off.

전송함수는 Bessel 폴리노미얼을 기반으로 한다.

정규화된 Bessel 저역통과 필터의 전송함수는

$$
H(s) = \frac{\theta_N(0)}{\theta_N(s/\Omega_c)}
$$

- \(\theta_N(s)\): N차 Bessel 폴리노미얼.

군지연:

$$
\tau_g(\Omega) = -\frac{d}{d\Omega} \angle H(j\Omega)
$$

이 저역에서 거의 일정하게 유지되도록 설계된다.

### 7.2 시간 응답 관점

- 계단 입력(step input)에 대한 응답이 **overshoot/undershoot가 거의 없고**,  
  과도 응답이 부드럽다.
- 따라서 **데이터/신호의 파형을 최대한 보전해야 하는 응용**에 유리하다.
  - 측정 시스템, 계측, 데이터 전송에서의 파형 충실도 확보 등.

### 7.3 GNU Octave: Bessel 아날로그 응답 (직접 구현 예)

GNU Octave에서 Bessel 필터는 `besselap` 같은 함수가 버전에 따라 없을 수도 있으므로,  
여기서는 **준비된 Bessel 폴리노미얼 계수**를 예로 들어 `freqs`로 응답을 보는 방식의 데모만 보여준다.

예: 4차 Bessel 저역통과 (정규화 \(\Omega_c=1\))에 해당하는 대표적인 분모 계수는 문헌에 표 형태로 제공된다. 예를 들어 한 표준 형태에서는

$$
A(s) = s^4 + 2.6131 s^3 + 3.4142 s^2 + 2.6131 s + 1
$$

와 같은 식이 등장한다 (정확한 계수는 사용하는 정규화 규약에 따라 약간 달라질 수 있다).

이를 사용해 \(H(s) = 1/A(s)\)로 두고 응답을 확인해보자.

```octave
clear; close all; clc;

% 예: 정규화 4차 Bessel 저역통과 (예시 계수)
a = [1 2.6131 3.4142 2.6131 1];  % 분모 계수
b = [1];                         % 분자 (DC gain 1)

w = logspace(-1, 2, 1000);       % rad/s (0.1 ~ 100)
H = freqs(b, a, w);

% 크기 응답
figure;
subplot(3,1,1);
semilogx(w, 20*log10(abs(H)+eps));
grid on;
xlabel('Analog rad/s');
ylabel('Magnitude (dB)');
title('Example 4th-order Bessel LPF (normalized)');

% 위상
subplot(3,1,2);
semilogx(w, unwrap(angle(H)));
grid on;
xlabel('Analog rad/s');
ylabel('Phase (rad)');
title('Phase response');

% 군지연 근사
dw = diff(w);
dphi = diff(unwrap(angle(H)));
tau_g = -dphi ./ dw;

subplot(3,1,3);
semilogx(w(1:end-1), tau_g);
grid on;
xlabel('Analog rad/s');
ylabel('Group delay (s, normalized)');
title('Approx. group delay (Bessel)');
```

- 저주파수 영역에서 군지연 곡선이 Butterworth 등 다른 필터보다 **더 평탄**한 것이 Bessel 필터의 특징이다.

---

## 8. 원형 아날로그 필터의 주파수 변환 (LP↔HP↔BP↔BS)

원형 아날로그 필터는 보통 **저역통과(LPF) 기준**으로 정의된다.  
실제 응용에서는 고역통과/대역통과/대역저지 필터가 필요하므로, 다음과 같은 **s-변환**을 사용한다.

### 8.1 저역통과 → 저역통과 (스케일링)

원형 필터가

$$
H_p(s) = H_\text{norm}\left(\frac{s}{\Omega_c}\right)
$$

형태로 주어질 때,

- 원하는 실제 컷오프 \(\Omega_c'\) 에 맞추려면

  $$
  s \to \frac{s}{k}, \quad k = \frac{\Omega_c'}{\Omega_c}
  $$

즉,

$$
H_{\text{LP}}(s) = H_\text{norm}\left(\frac{s}{\Omega_c'}\right)
$$

### 8.2 저역통과 → 고역통과 (LP→HP)

LPF를 HPF로 변환할 때는

$$
s \to \frac{\Omega_c^2}{s}
$$

- \(\Omega_c\): 원하는 HPF 컷오프.

원형 필터 \(H_p(s)\)를 변환하면

$$
H_{\text{HP}}(s) = H_p\left( \frac{\Omega_c^2}{s} \right)
$$

예를 들어, Butterworth 5차 LPF의 분모가

$$
A(s) = s^5 + a_4 s^4 + \dots + a_0
$$

라면, HPF로 변환 시에는

$$
A_{\text{HP}}(s) = s^5 A\left( \frac{\Omega_c^2}{s} \right)
$$

형태가 된다 (정규화 과정 포함).

### 8.3 저역통과 → 대역통과 (LP→BP)

해당 변환:

$$
s \to \frac{s^2 + \Omega_0^2}{B s}
$$

- \(\Omega_0\): 중심 주파수
- \(B = \Omega_2 - \Omega_1\): 대역폭

LPF의 차수 \(N\)은 BP 변환 후 **2N**차가 된다.

### 8.4 저역통과 → 대역저지 (LP→BS)

해당 변환:

$$
s \to \frac{B s}{s^2 + \Omega_0^2}
$$

- 마찬가지로 차수는 2N차가 된다.

---

## 9. 원형 아날로그 필터 → 디지털 IIR (bilinear 변환)

아날로그 원형 필터를 디지털 IIR 필터로 옮길 때, 가장 널리 쓰이는 방법이 **bilinear 변환**이다.

### 9.1 bilinear 변환 정의

디지털 \(z\)-변수와 아날로그 \(s\)-변수 사이의 관계:

$$
s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}
$$

또는

$$
z = \frac{1 + \frac{sT}{2}}{1 - \frac{sT}{2}}
$$

- \(T = 1/F_s\): 샘플링 주기.

이 변환의 특징:

1. 아날로그 **좌반평면(LHP)** 를 디지털 **단위원 내부**로 1:1 매핑.
2. 아날로그 전체 주파수축 \(-\infty < \Omega < \infty\) 를 디지털 주파수축 \(-\pi < \omega < \pi\) 에 매핑.
3. 주파수 축에 **비선형 왜곡(warping)**이 생긴다.

### 9.2 주파수 warping과 prewarping

아날로그 각주파수 \(\Omega\)와 디지털 각주파수 \(\omega\) 사이의 관계는

$$
\Omega = \frac{2}{T} \tan\left( \frac{\omega}{2} \right)
$$

따라서, 디지털 영역에서 원하는 컷오프 \(\omega_c\)를 정확히 반영하려면, 아날로그 설계 시 **prewarping**을 수행한다.

원하는 디지털 컷오프 \(\omega_c\)에 대해:

$$
\Omega_c = \frac{2}{T} \tan\left( \frac{\omega_c}{2} \right)
$$

이 \(\Omega_c\)를 이용해 **원형 아날로그 필터를 설계**한 뒤 bilinear 변환하면, 디지털에서 정확히 \(\omega_c\) 위치에 컷오프가 온다.

---

## 10. GNU Octave: Butterworth 아날로그 프로토타입 → 디지털 IIR 설계 예

마지막으로, 지금까지의 내용을 하나로 묶는 간단한 설계 예제를 보자.

- 샘플링:  
  $$F_s = 48\,\mathrm{kHz}$$
- 디지털 스펙:
  - 통과대역 끝: \(F_p = 4\,\mathrm{kHz}\)
  - 저지대역 시작: \(F_s' = 8\,\mathrm{kHz}\)
  - 통과대역 리플: \(A_p = 1\,\mathrm{dB}\)
  - 저지대역 감쇠: \(A_s = 60\,\mathrm{dB}\)

### 10.1 전체 흐름 요약

1. 디지털 스펙 \((F_p, F_s', A_p, A_s)\) 설정
2. prewarping으로 \(\Omega_p, \Omega_s\) 계산
3. Butterworth 원형 아날로그 설계 공식으로 \(N, \Omega_c\) 결정
4. 원형 아날로그 Butterworth 필터 \(H_p(s)\) 설계
5. bilinear 변환으로 디지털 필터 \(H(z)\) 얻기
6. `freqz`로 디지털 응답 확인

### 10.2 Octave 코드 (직접 prewarping + bilinear 구현)

```octave
pkg load signal;
clear; close all; clc;

Fs   = 48000;      % 샘플링 주파수 [Hz]
Fp   = 4000;       % 디지털 통과대역 끝 [Hz]
Fs1  = 8000;       % 디지털 저지대역 시작 [Hz]
Ap   = 1;          % 통과대역 리플 [dB]
As   = 60;         % 저지대역 감쇠 [dB]

T    = 1/Fs;
wp   = 2*pi*Fp / Fs * pi;   % 디지털 각주파수 (0~pi) ... (약간 과한 표현이라 아래에서 바로 tan 사용)
ws   = 2*pi*Fs1 / Fs * pi;  % 단순 예시용, 실제로는 2*pi*(Fp/Fs) 형태로 정의하면 된다.

% 디지털 각주파수(0~pi)를 정확히 쓰면:
omega_p = 2*pi*Fp/Fs;   % 0~2*pi
omega_s = 2*pi*Fs1/Fs;

% Prewarping: 디지털 컷오프 -> 아날로그 컷오프
Omega_p = (2/T) * tan(omega_p/2);
Omega_s = (2/T) * tan(omega_s/2);

printf("Prewarped Omegas: Omega_p=%g rad/s, Omega_s=%g rad/s\n", Omega_p, Omega_s);

% 1) Butterworth 차수 계산 (아날로그 스펙 기준)
Ep = sqrt(10^(Ap/10) - 1);
Es = sqrt(10^(As/10) - 1);

N_exact = log10(Es/Ep) / (2*log10(Omega_s/Omega_p));
N = ceil(N_exact);
printf("Butterworth order: N_exact=%.3f, N=%d\n", N_exact, N);

% 2) 컷오프 Omega_c 구하기 (passband 기준)
Omega_c = Omega_p / ( (10^(Ap/10)-1)^(1/(2*N)) );

printf("Analog cutoff Omega_c = %g rad/s (≈ %g Hz)\n", Omega_c, Omega_c/(2*pi));

% 3) 아날로그 Butterworth 프로토타입 설계
[b_a, a_a] = butter(N, Omega_c, "s");  % 아날로그 저역통과

% 4) bilinear 변환으로 디지털 계수 얻기
%    Octave의 bilinear 함수를 사용 (signal 패키지)
[bd, ad] = bilinear(b_a, a_a, Fs);

% 5) 디지털 응답 확인
[H_z, w] = freqz(bd, ad, 4096);
f = w/(2*pi)*Fs;

figure;
subplot(2,1,1);
plot(f, 20*log10(abs(H_z)+eps));
grid on;
xlabel('Frequency (Hz)');
ylabel('Magnitude (dB)');
title(sprintf('Digital IIR LPF from analog Butterworth prototype (N=%d)', N));
xlim([0 20000]);
ylim([-100 5]);

subplot(2,1,2);
plot(f, unwrap(angle(H_z)));
grid on;
xlabel('Frequency (Hz)');
ylabel('Phase (rad)');
title('Digital phase response');
```

> 주의: 위 코드에서 prewarping 부분은 설명을 위해 풀어서 썼다. 실제 구현에서는 디지털 정규화 주파수(0~1 범위)로 계산한 뒤 `buttord/butter`에 바로 넘기는 방식이 더 간단하다.  
> 여기서는 “**원형 아날로그 프로토타입 → prewarping → bilinear**” 흐름을 수학적으로 보이기 위해 직접 구현했다.

---

## 11. 정리

이 글에서는 **원형 아날로그 필터의 특성**을 중심으로 다음 내용을 정리했다.

1. **원형 아날로그 필터(analog prototype)의 역할**

   - 디지털 IIR 설계에서, 모든 복잡한 스펙을 **표준화된 아날로그 저역통과 필터**로 모아둔 “기준 모형” 역할.
   - 스펙은 \((\Omega_p, \Omega_s, A_p, A_s)\) 로 요약.

2. **대표적인 원형 저역통과 필터 family와 특징**

   | 필터 유형    | 통과대역 | 저지대역 | 전이대역 | 군지연/시간응답 특징 |
   |--------------|----------|----------|----------|----------------------|
   | Butterworth  | 평탄     | 평탄     | 중간     | 중간, overshoot 보통 |
   | Chebyshev I  | 등리플   | 평탄     | 빠름     | 약간 비선형          |
   | Chebyshev II | 평탄     | 등리플   | 빠름     | 약간 비선형          |
   | Elliptic     | 등리플   | 등리플   | 가장 빠름| 위상·군지연 가장 비선형 |
   | Bessel       | 거의 평탄 | 완만     | 가장 느림| 군지연 평탄, 파형 보존 |

3. **각 family의 수학적 특성**

   - Butterworth: 
     - 크기 제곱:  
       $$ |H(j\Omega)|^2 = \frac{1}{1 + (\Omega/\Omega_c)^{2N}} $$
     - 극점: \(|p_k| = \Omega_c\), 좌반평면 원 위에 균일 분포.
   - Chebyshev I: 
     - 통과대역 등리플, Chebyshev 다항식 \(T_N\).
   - Chebyshev II:
     - 저지대역 등리플, 통과대역 평탄.
   - Elliptic:
     - 통과·저지대역 모두 등리플, Rational Chebyshev 함수 사용 → 최소 차수.
   - Bessel:
     - Bessel 폴리노미얼 기반, 군지연(flat)에 최적화.

4. **s-변환과 bilinear 변환**

   - LP 원형을 HP/BP/BS로 변환하는 \(s\)-치환.
   - 아날로그에서 디지털로 옮길 때 bilinear 변환을 사용하고,  
     주파수 warping을 보정하기 위해 prewarping을 적용.

5. **GNU Octave 코드 예제**

   - `butter`, `cheby1`, `cheby2`, `ellip`의 `"s"` 옵션으로 아날로그 프로토타입 설계.
   - `freqs`로 아날로그 크기/위상/군지연 확인.
   - `bilinear`로 디지털 계수 변환 → `freqz`로 디지털 응답 확인.