---
layout: post
title: 미적분 - 극좌표계에서의 곡선의 길이와 면적
date: 2025-07-17 20:25:23 +0900
category: 미적분
---
# 극좌표계에서의 곡선의 길이와 면적

## 극좌표 복습 및 좌표 변환

한 점을
$$
(r,\ \theta)\qquad (r\ge 0,\ \theta\in\mathbb{R})
$$
로 나타낸다. 표현의 중복성(동일점 표현)은
$$
(r,\theta)\sim(r,\theta+2\pi k)\sim(-r,\theta+\pi)\qquad(k\in\mathbb{Z})
$$
임에 주의한다.

직교↔극 변환:
$$
x=r\cos\theta,\quad y=r\sin\theta,\qquad
r=\sqrt{x^2+y^2},\quad \theta=\operatorname{atan2}(y,x).
$$

---

## — 유도와 해석

### 유도

극좌표에서 각도 \(\theta\)가 미소량 \(d\theta\)만큼 변할 때, 부채꼴(호 길이 \(r\,d\theta\), 반지름 \(r\))의 미소 면적은
$$
dA=\frac12 r^2\,d\theta.
$$
따라서 \(\theta_1\le\theta\le\theta_2\)에서
$$
A=\frac12\int_{\theta_1}^{\theta_2} \bigl(r(\theta)\bigr)^2\,d\theta.
$$

### 두 곡선 사이 면적

바깥 곡선 \(r_{\text{out}}(\theta)\ge r_{\text{in}}(\theta)\ge 0\)라면
$$
A=\frac12\int_{\theta_1}^{\theta_2}\left(r_{\text{out}}(\theta)^2-r_{\text{in}}(\theta)^2\right)d\theta.
$$

### 자주 틀리는 포인트

- **구간 선택**: 실제로 그려지는 최소 구간(잎 하나, 루프 하나)을 먼저 파악.
- **음의 \(r\)**: \((-r,\theta)\equiv(r,\theta+\pi)\). 면적 적분 자체는 \(r^2\)라 양수지만, **이중 작도(두 번 그리기)**를 피하려면 구간을 쪼개 정확한 범위를 써야 한다.
- **교점 각도**: \(r_1(\theta)=r_2(\theta)\)뿐 아니라 \(r_1(\theta)=-r_2(\theta)\)와 \(\theta\mapsto\theta\pm\pi\) 변환까지 확인.

---

## 공식 \(L=\int\sqrt{r^2+(r')^2}\,d\theta\) — 유도와 해석

극곡선 \(r=r(\theta)\)에 대해
$$
x=r\cos\theta,\qquad y=r\sin\theta.
$$
미분하면
$$
\frac{dx}{d\theta}=r'\cos\theta-r\sin\theta,\qquad
\frac{dy}{d\theta}=r'\sin\theta+r\cos\theta.
$$
따라서 길이 요소
$$
ds=\sqrt{\left(\frac{dx}{d\theta}\right)^2+\left(\frac{dy}{d\theta}\right)^2}\,d\theta
=\sqrt{\,r^2+(r')^2\,}\,d\theta,
$$
총 길이는
$$
L=\int_{\theta_1}^{\theta_2}\sqrt{\,r(\theta)^2+\bigl(r'(\theta)\bigr)^2\,}\ d\theta.
$$

> **절댓값 주의**: 제곱근은 항상 양수이므로 절댓값을 고려할 필요는 없지만, 폐곡선 전체 길이를 구할 때 구간을 잘못 잡으면 일부가 누락되거나 중복될 수 있다.

---

## 대표 예제 — 면적

### 예제 4-1. 반원 영역

주어진 예:
$$
r=\sqrt{\cos(2\theta)},\qquad \theta\in\left[-\frac{\pi}{4},\frac{\pi}{4}\right]
$$
면적
$$
A=\frac12\int_{-\pi/4}^{\pi/4}\cos(2\theta)\,d\theta
=\frac12\cdot \left[\frac{\sin(2\theta)}{2}\right]_{-\pi/4}^{\pi/4}
=\frac12.
$$

### 예제 4-2. 원 \(r=a\)

$$
A=\frac12\int_{0}^{2\pi}a^2\,d\theta=\pi a^2.
$$

### 한 잎 면적

홀수 \(n\)에서 한 잎은 길이 \(\frac{\pi}{n}\)의 대칭 구간. 면적
$$
A_{\text{petal}}=\frac12\int_{-\pi/(2n)}^{\pi/(2n)} a^2\cos^2(n\theta)\,d\theta
=\frac{a^2}{4}\int_{-\pi/(2n)}^{\pi/(2n)}\left(1+\cos(2n\theta)\right)\,d\theta
=\frac{\pi a^2}{4n}.
$$
(짝수 \(n\)이면 잎이 \(2n\)개이므로 전체면적은 \(\frac{\pi a^2}{2}\).)

### 전체 면적

$$
A=\frac12\int_{0}^{2\pi} a^2(1+\cos\theta)^2\,d\theta
=\frac{a^2}{2}\int_{0}^{2\pi}\left(1+2\cos\theta+\cos^2\theta\right)\,d\theta
=\frac{a^2}{2}\left(2\pi+0+\pi\right)=\frac{3\pi a^2}{2}.
$$

### 예제 4-5. 두 곡선 사이 면적 \(r=2\)와 \(r=\cos\theta\), \(0\le\theta\le\frac{\pi}{2}\)

$$
A=\frac12\int_{0}^{\pi/2}\bigl(2^2-\cos^2\theta\bigr)\,d\theta
=\frac12\left(4\cdot\frac{\pi}{2}-\int_{0}^{\pi/2}\cos^2\theta\,d\theta\right)
=\frac12\left(2\pi-\frac{\pi}{4}\right)
=\frac{7\pi}{8}.
$$

---

## 대표 예제 — 호길이

### 예제 5-1. 원 \(r=a\)

\(r'=0\) 이므로
$$
L=\int_{0}^{2\pi}\sqrt{a^2}\,d\theta=2\pi a.
$$

### 예제 5-2. 아르키메데스 나선 \(r=a\theta\), \(0\le\theta\le 2\pi\)

\(r'=a\). 따라서
$$
L=a\int_{0}^{2\pi}\sqrt{\theta^2+1}\,d\theta
=\frac{a}{2}\Bigl[\ \theta\sqrt{\theta^2+1}+\operatorname{asinh}\theta\ \Bigr]_{0}^{2\pi}.
$$

### 전체 둘레

\(r'= -a\sin\theta\). 그러면
$$
r^2+(r')^2=a^2\bigl((1+\cos\theta)^2+\sin^2\theta\bigr)=2a^2(1+\cos\theta)=4a^2\cos^2\frac{\theta}{2}.
$$
따라서
$$
L=\int_{0}^{2\pi} 2a\left|\cos\frac{\theta}{2}\right|\,d\theta
=4a\int_{0}^{\pi}|\cos u|\,du=4a\cdot 2=8a.
$$
(여기서 \(u=\theta/2\). 절댓값으로 반주기 대칭 처리.)

---

## 실전 절차

1) **교점 찾기**
   \(\theta\)에 대해 \(r_1(\theta)=r_2(\theta)\)를 풀고, 필요하면 \(r_1(\theta)=-r_2(\theta)\)와 \(\theta\pm\pi\) 치환까지 확인.

2) **실제로 그려지는 최소 구간 파악**
   장미면 잎 하나, 리마송은 외부/내부 루프 각각의 \(\theta\) 범위를 먼저 잡는다.

3) **음의 \(r\) 처리**
   \(r<0\)이면 \((r,\theta)\)가 \((|r|,\theta+\pi)\)로 그려진다. 이로 인한 **중복 작도**가 없는지 점검하고 필요시 구간 분할.

4) **면적은 \(r^2\)**
   부호 영향이 사라지지만, **중복 포함(두 번 채색)**을 막기 위해 구간을 재조정한다.

5) **길이는 \(\sqrt{r^2+(r')^2}\)**
   제곱근 덕분에 양수지만, 역시 구간 중복 여부 확인.

---

## 이중적분 관점(야코비안)으로 본 면적 공식의 정당화

극→직교 변환의 야코비안은
$$
\left|\frac{\partial(x,y)}{\partial(r,\theta)}\right|=r.
$$
따라서 면적소 \(dA=r\,dr\,d\theta\). 영역 \(0\le r\le R(\theta)\)이면
$$
A=\iint dA=\int_{\theta_1}^{\theta_2}\int_{0}^{R(\theta)} r\,dr\,d\theta
=\int_{\theta_1}^{\theta_2}\left[\frac{r^2}{2}\right]_{0}^{R(\theta)} d\theta
=\frac12\int_{\theta_1}^{\theta_2} R(\theta)^2\,d\theta.
$$
앞서의 부채꼴 유도와 일치한다.

---

## 검산 루틴과 수치 안정성

- **대칭 검산**: 짝/홀, \(\theta\mapsto -\theta\), \(\theta\mapsto\theta+\pi\) 대칭으로 적분 범위를 절반으로 줄인 뒤 2배하는 방식으로 결과를 맞춰본다.
- **단위 검산**: 원 \(r=a\)로 공식 자체를 검산(\(A=\pi a^2,\ L=2\pi a\)).
- **수치적분**: \(\int\sqrt{\theta^2+1}\,d\theta\) 등은 `mpmath.quad`로 확인.
- **분할 적분**: 코사인/사인 절댓값이 등장하는 길이 적분은 부호가 바뀌는 점에서 구간 분할.

---

## 실습 코드 (SymPy/NumPy/Matplotlib)

> 코드 셀은 문서 검증 및 시각화용 예시다. 실제 블로그에서는 캡션과 함께 결과 스크린샷/플롯 이미지를 삽입하면 좋다.

### 좌표 변환과 면적·길이 유틸

```python
import numpy as np
import mpmath as mp

def polar2cart(r, th):
    return r*np.cos(th), r*np.sin(th)

def area_polar(r_func, th1, th2):
    f = lambda th: 0.5*(r_func(th)**2)
    return mp.quad(f, [th1, th2])

def length_polar(r_func, dr_func, th1, th2, split_points=()):
    # 분할점(절댓값/루트 내부 변화 등)을 반영해 구간분할 수치적분
    pts = [th1] + sorted([p for p in split_points if th1 < p < th2]) + [th2]
    total = mp.mpf('0')
    g = lambda th: mp.sqrt(r_func(th)**2 + dr_func(th)**2)
    for a, b in zip(pts[:-1], pts[1:]):
        total += mp.quad(g, [a, b])
    return total
```

### 면적 예제 — \(r=2\)와 \(r=\cos\theta\), \(0\le\theta\le\frac{\pi}{2}\)

```python
A_num = area_polar(lambda th: 2.0, 0, np.pi/2) - area_polar(lambda th: np.cos(th), 0, np.pi/2)
print("수치 면적:", A_num)  # 이론값 7π/8 ≈ 2.748893...
```

### 길이 예제 — 카디오이드 \(r=a(1+\cos\theta)\)

```python
a = 2.0
r  = lambda th: a*(1.0 + np.cos(th))
dr = lambda th: -a*np.sin(th)

# cos(th/2)의 부호가 바뀌는 지점 th=π에서 분할

L_num = length_polar(r, dr, 0, 2*np.pi, split_points=(np.pi,))
print("수치 길이:", L_num, "이론:", 8*a)
```

### 플롯 — 극좌표 곡선과 면적 채우기(참고)

```python
import matplotlib.pyplot as plt

th = np.linspace(0, 2*np.pi, 2000)
a = 2.0
r_cardi = a*(1.0 + np.cos(th))

plt.figure()
ax = plt.subplot(111, projection='polar')
ax.plot(th, r_cardi, lw=2)
ax.fill_between(th, 0, r_cardi, alpha=0.2)
ax.set_title("Cardioid: r = a(1 + cos θ)")
plt.show()
```

---

## 빠른 요약(치트시트)

- 면적(외곽 \(r(\theta)\)):
  $$
  A=\frac12\int_{\theta_1}^{\theta_2} r(\theta)^2\,d\theta.
  $$
- 두 곡선 사이:
  $$
  A=\frac12\int (r_{\text{out}}^2-r_{\text{in}}^2)\,d\theta.
  $$
- 호길이:
  $$
  L=\int\sqrt{r^2+(r')^2}\,d\theta.
  $$
- 자주 쓰는 결과:
  - 원 \(r=a\): \(A=\pi a^2,\ L=2\pi a\)
  - 카디오이드 \(r=a(1+\cos\theta)\): \(A=\frac{3\pi a^2}{2},\ L=8a\)
  - 장미 \(r=a\cos(n\theta)\) 한 잎 면적: \(\displaystyle \frac{\pi a^2}{4n}\)

---

## 연습 문제(해설 아이디어 포함)

1) \(r=2a\cos\theta\)가 만드는 원(중심 \((a,0)\), 반지름 \(a\))의 면적을 극좌표 적분으로 증명하라.
   해: \(\theta\in[-\pi/2,\pi/2]\)에서 \(A=\frac12\int (2a\cos\theta)^2 d\theta=\pi a^2\).

2) \(r=a(1-\cos\theta)\)의 내부 루프 면적을 구하라.
   해: 루프 구간 \(\theta\in[\pi/3,5\pi/3]\) (또는 대칭 구간)을 찾아 같은 공식 적용.

3) \(r=a\theta\)에서 \([0,2\pi]\) 호길이를 닫힌형으로 써라.
   해: \(\int\sqrt{\theta^2+1}\,d\theta=\frac12\left(\theta\sqrt{\theta^2+1}+\operatorname{asinh}\theta\right)\).

---

## 마무리

면적은 “부채꼴 합”으로, 길이는 “파라미터화된 직교미분 길이”로 이해하면 공식이 자연스럽게 나온다. 실전에서는 **교점·구간·음의 \(r\)** 세 가지를 먼저 정리하고 적분을 시작하면 실수가 급감한다. 마지막으로, 대칭성과 표준 곡선의 정답(원·카디오이드·장미)을 암기해 두면 빠른 검산이 가능하다.
