---
layout: post
title: 미적분 - 음함수의 미분법
date: 2025-06-19 21:20:23 +0900
category: 미적분
---
# 음함수의 미분법 (Implicit Differentiation)

명시적 함수 $$y=f(x)$$ 대신, $$x$$ 와 $$y$$ 가 **하나의 방정식**으로 묶여 있는 형태
$$
F(x,y)=0
$$
를 **음함수(implicit function)**라 합니다. 이때도 $$y=y(x)$$ 로 간주하고 **연쇄법칙**을 적용하면 미분이 가능합니다.  
(모든 수식은 $$\cdots$$, 코드는 ``` 로 감쌉니다.)

---

## ✅ 1) 핵심 원리(공식)

- 모든 **\(y\)** 는 사실상 **\(y(x)\)** 이므로, $$\dfrac{d}{dx}y = \dfrac{dy}{dx}$$ 를 붙입니다.
- 일반형 $$F(x,y)=0$$ 을 $$x$$ 로 미분하면
  $$
  F_x(x,y)+F_y(x,y)\,\frac{dy}{dx}=0 \quad\Rightarrow\quad
  \boxed{\displaystyle \frac{dy}{dx}=-\frac{F_x}{F_y}}\quad(F_y\ne 0).
  $$
  여기서 $$F_x=\dfrac{\partial F}{\partial x},\ F_y=\dfrac{\partial F}{\partial y}.$$

> **수직 접선**: $$F_y=0,\ F_x\neq 0$$ 이면 $$\dfrac{dy}{dx}$$ 가 정의되지 않아 수직 접선.  
> 이때는 **역으로** $$\dfrac{dx}{dy}=-\dfrac{F_y}{F_x}$$ 를 쓰면 기울기 분석이 쉬움.

---

## ✅ 2) 기본 예제

### 예제 1 — 원: $$x^2+y^2=1$$
$$
2x+2y\,\frac{dy}{dx}=0 \ \Rightarrow\ 
\boxed{\frac{dy}{dx}=-\frac{x}{y}}.
$$
- **수평 접선**: $$\dfrac{dy}{dx}=0\Rightarrow x=0 \Rightarrow (0,\pm1).$$  
- **수직 접선**: 분모 $$y=0\Rightarrow (\pm1,0).$$

### 예제 2 — 혼합항: $$xy+\sin y=x^2$$
양변을 $$x$$ 로 미분:
$$
x\frac{dy}{dx}+y+\cos y\frac{dy}{dx}=2x
\ \Rightarrow\
\boxed{\frac{dy}{dx}=\frac{2x-y}{x+\cos y}}.
$$

### 예제 3 — 로그 포함: $$x^2+\ln y=0\ (y>0)$$
$$
2x+\frac{1}{y}\frac{dy}{dx}=0 \Rightarrow
\boxed{\frac{dy}{dx}=-2xy}.
$$

---

## ✅ 3) 일반형으로 빠르게 푸는 법

$$F(x,y)=0$$ 에서
$$
\boxed{\frac{dy}{dx}=-\frac{F_x}{F_y}}\quad(F_y\neq 0).
$$

**예**: $$F(x,y)=x^3+y^3-3xy.$$
- $$F_x=3x^2-3y,\quad F_y=3y^2-3x.$$
- $$
\frac{dy}{dx}=-\frac{3x^2-3y}{3y^2-3x}
= -\,\frac{x^2-y}{y^2-x}.
$$

---

## ✅ 4) 고차 도함수(2차, 곡률 등)

1차 도함수 $$y'=\dfrac{dy}{dx}$$ 를 얻은 뒤, **다시 암시적으로** 미분합니다.

### 예 — 원에서 2차 미분
$$
x^2+y^2=1 \Rightarrow y'=-\frac{x}{y}.
$$
다시 미분(곱/몫 규칙 + 연쇄법칙):
$$
y''=\frac{d}{dx}\!\left(-\frac{x}{y}\right)
= -\,\frac{y - x\,y'}{y^2}
= -\,\frac{y + \frac{x^2}{y}}{y^2}
= -\,\frac{x^2+y^2}{y^3}
= -\,\frac{1}{y^3}.
$$
(마지막 등호는 $$x^2+y^2=1$$ 사용.)

---

## ✅ 5) 접선·법선 구하기

점 $$(x_0,y_0)$$ 이 곡선 위에 있을 때:
- **접선 기울기**: $$m=y'(x_0)=\left.-\dfrac{F_x}{F_y}\right|_{(x_0,y_0)}.$$
- **접선**: $$y-y_0=m(x-x_0).$$
- **법선**: $$y-y_0=-\dfrac{1}{m}(x-x_0)\ (m\neq 0).$$

**예**: $$x^2+y^2=1,\ (x_0,y_0)=\big(\frac{\sqrt2}{2},\frac{\sqrt2}{2}\big).$$  
기울기 $$m=-x_0/y_0=-1$$, 접선 $$y-y_0=-1(x-x_0)\Rightarrow y=-x+\sqrt2.$$

---

## ✅ 6) 역함수 미분과의 연결

$$F(x,y)=0$$ 을 $$y=f(x)$$ 로 풀 수 있다면
$$
\frac{dy}{dx}=-\frac{F_x}{F_y},
$$
반대로 $$x=g(y)$$ 로 보면
$$
\frac{dx}{dy}=-\frac{F_y}{F_x},\qquad 
\frac{dy}{dx}=\left(\frac{dx}{dy}\right)^{-1}.
$$
**Implicit Function Theorem**(암함수 정리): $$F_y(x_0,y_0)\ne 0$$ 이면 국소적으로 $$y=f(x)$$ 존재.

---

## ✅ 7) 삼각/지수/로그가 섞인 예제

### (A) $$\sin(xy)=x+y$$
미분:
$$
\cos(xy)\,(x\,y'+y)+(-1)=1
\quad\Rightarrow\quad
\boxed{y'=\frac{1+\cos(xy)\,y}{\cos(xy)\,x}}.
$$
(정의역에서 $$\cos(xy)\,x\neq 0$$ 확인)

### (B) $$e^{x+y}=x^2-y$$
미분:
$$
e^{x+y}(1+y')=2x-y' \ \Rightarrow\
y'\big(e^{x+y}+1\big)=2x-e^{x+y}
$$
$$
\Rightarrow\quad
\boxed{y'=\frac{2x-e^{x+y}}{e^{x+y}+1}}.
$$

### (C) $$x^y=2$$ (로그 미분이 편리)
양변 로그:
$$
y\ln x=\ln 2\ \Rightarrow\ 
y'=\frac{d}{dx}\left(\frac{\ln 2}{\ln x}\right)
= -\,\frac{\ln 2}{(\ln x)^2}\cdot\frac{1}{x}.
$$

---

## ✅ 8) 수평/수직 접선 판정

- **수평 접선**: $$y'=0 \ \Leftrightarrow\ F_x=0,\ F_y\ne 0.$$  
- **수직 접선**: $$y' \text{ 미정} \ \Leftrightarrow\ F_y=0,\ F_x\ne 0.$$  
- **특이점 후보**: $$F_x=F_y=0$$ → 뾰족점/교차/자체접촉 가능 → 고차 도함수나 파라메트릭(호장) 길이로 정밀 판정.

---

## ✅ 9) 고급: 2차 도함수의 일반형

$$F(x,y)=0$$ 에서 $$y'=-F_x/F_y$$. 한 번 더 미분하면
$$
y''= -\,\frac{F_{xx}+2F_{xy}y'+F_{yy}(y')^2}{F_y}
\quad\text{(단, }F_y\ne 0\text{)}.
$$
> 유도: 몫 규칙과 연쇄법칙을 체계적으로 적용.

---

## ✅ 10) 그래프 시각화(원)

```python
import numpy as np
import matplotlib.pyplot as plt

theta = np.linspace(0, 2*np.pi, 600)
x = np.cos(theta)
y = np.sin(theta)

plt.plot(x, y, label='x^2 + y^2 = 1')
plt.title('음함수 예시: 원')
plt.xlabel('x'); plt.ylabel('y')
plt.axis('equal'); plt.grid(True); plt.legend(); plt.show()
```

---

## ✅ 11) 자주 하는 실수 체크리스트

- [ ] $$\dfrac{d}{dx}(y)=y'$$, $$\dfrac{d}{dx}(y^n)=n y^{n-1}y'$$ 를 **잊지 않기**.  
- [ ] 곱/합성에 연쇄법칙 누락(예: $$\sin y \to \cos y\cdot y'$$).  
- [ ] 정의역/분모 0 확인(수직 접선, 미정 형태).  
- [ ] 고차 도함수에서 **이전 결과를 대입**해 정리.  
- [ ] 특이점( $$F_x=F_y=0$$ )에서는 1차 공식만으로 판단 불가.

---

## ✅ 12) 연습문제 (간단 해설)

1) $$x^3+y^3=6xy$$ 에서 $$y'$$  
   - $$F_x=3x^2-6y,\ F_y=3y^2-6x\Rightarrow
   \boxed{y'=-\dfrac{3x^2-6y}{3y^2-6x}}.$$

2) $$\ln(x+y)=x-y$$ 에서 $$y'$$ (정의역: $$x+y>0$$)  
   - 미분: $$\dfrac{1}{x+y}(1+y')=1-y'$$  
   - 정리:
     $$
     \boxed{y'=\frac{x+y-1}{x+y+1}}.
     $$

3) $$x^2y+y^2x=1$$ 에서 원점 근처의 수평/수직 접선 여부  
   - $$F_x=2xy+y^2,\ F_y=x^2+2xy.$$
   - 원점에서는 $$F_x=F_y=0$$ → **특이점**(둘 다 0) → 고차 분석 필요.

---

## 요약

- **한 줄 공식**: $$\displaystyle \frac{dy}{dx}=-\frac{F_x}{F_y}\ (F_y\ne 0).$$  
- **도구**: 연쇄법칙, 곱/몫, 로그 미분을 **음함수 맥락**에 그대로 적용.  
- **분석**: 수평/수직 접선은 $$F_x, F_y$$ 로 즉시 판정, **특이점**은 고차 도함수/국소 해석으로 보강.  
- **활용**: 접선/법선, 곡률, 역함수/스위치 변수, 복잡한 관계식의 민감도 분석까지 폭넓게 사용.