---
layout: post
title: 미적분 - 음함수의 미분법
date: 2025-06-19 21:20:23 +0900
category: 미적분
---
# 음함수의 미분법 (Implicit Differentiation)

명시적 함수 $$y=f(x)$$ 대신 $$x,y$$ 가 **하나의 방정식**으로 연결된
$$
F(x,y)=0
$$
형태를 **음함수(implicit function)** 라고 부릅니다. 이때도 $$y=y(x)$$ 로 간주하고 **연쇄법칙**을 적용하면 미분이 가능합니다.  

---

## ✅ 1) 핵심 원리(결론부터)

$$F(x,y)=0$$ 을 $$x$$ 에 대해 미분하면
$$
F_x(x,y)+F_y(x,y)\,\frac{dy}{dx}=0
\quad\Longrightarrow\quad
\boxed{\displaystyle \frac{dy}{dx}=-\,\frac{F_x}{F_y}}\quad(F_y\neq 0).
$$

- 여기서 $$F_x=\dfrac{\partial F}{\partial x},\ F_y=\dfrac{\partial F}{\partial y}$$ 입니다.
- **수직 접선**: $$F_y=0,\ F_x\neq 0$$ 이면 기울기( $$dy/dx$$ )가 정의되지 않아 수직.
- 반대로 $$\dfrac{dx}{dy}=-\dfrac{F_y}{F_x}$$ 로 다루면 수직/수평 판정이 쉽습니다.

---

## ✅ 2) 왜 이 공식이 나오나? (연쇄법칙 한 줄 증명)

모든 $$y$$ 는 사실상 $$y(x)$$ 이므로, $$\dfrac{d}{dx}y=y'$$, $$\dfrac{d}{dx}[\phi(y)]=\phi'(y)\,y'$$ 입니다.  
따라서
$$
\frac{d}{dx}F(x,y(x))
=F_x(x,y)+F_y(x,y)\,y'=0
\ \Rightarrow\ 
y'=-\frac{F_x}{F_y}.
$$

---

## ✅ 3) 계산 루틴(실전 알고리즘)

1) **방정식 정리**: $$F(x,y)=0$$ 꼴로 통일.  
2) **양변 $$x$$-미분**: 합/곱/합성(연쇄법칙) 적용.  
3) **$$y'$$ 항 모으기**: $$\cdots + (\text{계수})\cdot y' = \text{다른 항}$$.  
4) **해결**: $$y'$$ 를 고립시켜 정리.  
5) (선택) **특정 점** $$(x_0,y_0)$$ 을 대입해 기울기 수치값 산출.  
6) (심화) **한 번 더 미분**해 $$y''$$, 곡률/접선/법선 등을 구함.

---

## ✅ 4) 기본 예제(난이도 단계별)

### 예제 1 — 원: $$x^2+y^2=1$$
미분: $$2x+2y\,y'=0 \ \Rightarrow\ \boxed{y'=-\dfrac{x}{y}}.$$
- **수평**: $$y'=0\Rightarrow x=0\Rightarrow (0,\pm 1).$$
- **수직**: 분모 $$y=0\Rightarrow (\pm 1,0).$$

---

### 예제 2 — 혼합항: $$xy+\sin y=x^2$$
미분:
$$
x\,y'+y+\cos y\,y'=2x
\ \Rightarrow\
y'(x+\cos y)=2x-y
\ \Rightarrow\
\boxed{y'=\dfrac{2x-y}{x+\cos y}}.
$$

---

### 예제 3 — 로그 포함: $$x^2+\ln y=0\ (y>0)$$
미분: $$2x+\dfrac{1}{y}\,y'=0 \ \Rightarrow\ \boxed{y'=-2xy}.$$

---

### 예제 4 — 일반형 바로 쓰기
$$
F(x,y)=x^3+y^3-3xy \Rightarrow
F_x=3x^2-3y,\quad F_y=3y^2-3x.
$$
따라서
$$
\boxed{y'=-\dfrac{F_x}{F_y}=-\,\frac{3x^2-3y}{3y^2-3x}
=-\,\frac{x^2-y}{\,y^2-x\,}}.
$$

---

## ✅ 5) 역함수 미분과의 연결(아크사인 예)

역함수 $$y=\arcsin x$$ 는 $$\sin y=x$$ 로 정의됩니다. 미분하면
$$
\cos y\cdot y'=1
\ \Rightarrow\
y'=\frac{1}{\cos y}=\frac{1}{\sqrt{1-\sin^2 y}}
=\boxed{\frac{1}{\sqrt{1-x^2}}}\quad(|x|<1).
$$

> **포인트**: 역함수 미분은 “원래 함수 식을 **암시적으로 미분**”하는 표준 패턴입니다.

---

## ✅ 6) 수평/수직 접선 & 특이점 판정

- **수평 접선**: $$y'=0 \iff F_x=0,\ F_y\neq 0.$$
- **수직 접선**: $$y'$$ 미정 $$\iff F_y=0,\ F_x\neq 0.$$
- **특이점 후보**: $$F_x=F_y=0$$ → 뾰족점/교차/자체접촉 가능.  
  이때는 고차 항 분석(테일러 전개, 파라메트릭화 등) 필요.

---

## ✅ 7) 2차 도함수(곡률까지 보기)

1차 결과 $$y'=-F_x/F_y$$ 를 **다시** 미분합니다. 체계적으로 정리하면
$$
\boxed{\displaystyle
y''= -\,\frac{F_{xx}+2\,F_{xy}\,y'+F_{yy}\,(y')^{2}}{F_y}
}\qquad(F_y\neq 0).
$$

### 예 — 원 $$x^2+y^2=1$$
- 1차: $$y'=-x/y.$$
- 2차: 위 공식을 쓰거나 직접 미분하여
  $$
  y''=-\,\frac{x^2+y^2}{y^3}=-\,\frac{1}{y^3}
  $$
  (마지막에 $$x^2+y^2=1$$ 사용).

---

## ✅ 8) 기하 해석: 법선·접선·그래디언트

- $$F_x+F_y y'=0 \iff \nabla F(x,y)\cdot(1,y')=0$$.  
  즉 **접선 방향벡터** $$(1,y')$$ 와 **법선벡터** $$\nabla F=(F_x,F_y)$$ 는 수직.
- 점 $$(x_0,y_0)$$ 에서
  - **접선**: $$y-y_0=y'(x_0)(x-x_0).$$
  - **법선**: $$y-y_0=-\dfrac{1}{y'(x_0)}(x-x_0)$$ (단, $$y'\neq 0$$).  
    또는 법선의 **벡터형**: $$F_x(x_0,y_0)(x-x_0)+F_y(x_0,y_0)(y-y_0)=0.$$

---

## ✅ 9) 유명 곡선에 적용

### (A) 데카르트의 포섬(Folium of Descartes)
$$
x^3+y^3=3a\,x y\quad(a>0).
$$
미분:
$$
3x^2+3y^2 y'=3a(y+x y').
$$
정리:
$$
y'(3y^2-3a x)=3a y-3x^2
\ \Rightarrow\
\boxed{y'=\frac{a y-x^2}{\,y^2-a x\,}}.
$$
- 원점 $$(0,0)$$ 은 $$F_x=F_y=0$$ 인 **특이점** (루프/자체접촉 분석 대상).

---

### (B) 베르누이의 레무니스케이트
$$
(x^2+y^2)^2=2a^2(x^2-y^2).
$$
미분:
$$
2(x^2+y^2)\cdot(2x+2y\,y')=4a^2(x- y\,y').
$$
정리하여
$$
y'=\frac{2a^2- (x^2+y^2)\,2}{(x^2+y^2)\,2y + 2a^2\,y/x}\quad\text{(중간 단계 생략 가능)}
$$
실전에서는 **일단 기울기식**만 얻고, 점을 대입해 수치 기울기를 계산합니다.

---

### (C) 카시니 타원
$$
(x^2+y^2)^2-2c^2(x^2-y^2)=a^4-c^4.
$$
절차는 (B)와 동일. **대칭성**(축 대칭)을 사용하면 수평/수직 접선의 위치를 빠르게 판별 가능.

---

## ✅ 10) 로그 미분 혼합형(지수에 변수 포함)

### (A) $$x^y=2$$
양변 로그:
$$
y\ln x=\ln 2
\ \Rightarrow\
y'=\frac{d}{dx}\!\left(\frac{\ln 2}{\ln x}\right)
=-\,\frac{\ln 2}{(\ln x)^2}\cdot\frac{1}{x}.
$$

### (B) $$x^y+y^x=C$$ 같은 혼합식
각 항에 로그 미분/음함수 미분을 **각각 적용**해 더한 뒤 $$y'$$ 를 정리합니다.

---

## ✅ 11) 극좌표·파라메트릭과의 연결

- 극좌표 곡선 $$r=r(\theta)$$ 를 **직교 좌표**로 바꾸면
  $$
  x=r\cos\theta,\quad y=r\sin\theta,
  $$
  그리고 파라메트릭 미분 $$\dfrac{dy}{dx}=\dfrac{dy/d\theta}{dx/d\theta}$$ 로 기울기 계산.  
  (직접 $$F(x,y)=0$$ 형태로 바꿔 음함수 미분을 써도 동일 결론.)
- 파라메트릭 $$x(t),y(t)$$ 는
  $$
  \frac{dy}{dx}=\frac{y'(t)}{x'(t)}\quad(x'\neq 0),
  $$
  **특이점**에서는 최저 비영차 도함수로 방향 판정(커스프).

---

## ✅ 12) 시스템(두 식으로 정의된 음함수)

$$
\begin{cases}
F(x,y)=0\\
G(x,y)=0
\end{cases}
$$
두 곡선의 **교점 궤적**에서 $$\dfrac{dy}{dx}$$ 는 야코비안을 이용해
$$
\boxed{
\frac{dy}{dx}
= -\,\frac{
\begin{vmatrix}
F_x & F_y\\
G_x & G_y
\end{vmatrix}_{\text{에서 }F,G=0}
}{
\begin{vmatrix}
F_y & F_y\\
G_y & G_y
\end{vmatrix}
}
}
\quad\text{보다는}\quad
\text{보통 }F_x+F_y y'=0,\ G_x+G_y y'=0\text{를 풀어 }y'\text{를 구함.}
$$
실전 계산은 **두 식을 각각 미분**해 연립 1차 방정식으로 $$y'$$ 를 해결합니다.

---

## ✅ 13) 곡률(선택): 암시적 곡선의 곡률 공식

암시적 곡선에서 곡률 $$\kappa$$ 는
$$
\kappa=\frac{|y''|}{\big(1+(y')^2\big)^{3/2}},
$$
여기서 $$y',y''$$ 는 위의 음함수 미분 공식으로 계산.

---

## ✅ 14) 그래프 시각화 코드 예시

> 주의: 아래 코드는 **개념 확인용**이며, 접선 기울기는 암시적으로 계산해 점에 대입합니다.

### (A) 원과 접선
```python
import numpy as np
import matplotlib.pyplot as plt

# 원: x^2 + y^2 = 1
theta = np.linspace(0, 2*np.pi, 800)
x = np.cos(theta)
y = np.sin(theta)

# 접선 점 (sqrt(2)/2, sqrt(2)/2)
x0 = np.sqrt(2)/2
y0 = np.sqrt(2)/2

# 음함수 미분: y' = -x/y
m = -x0 / y0

X = np.linspace(-1.5, 1.5, 200)
Y = m*(X - x0) + y0

plt.plot(x, y, label='x^2 + y^2 = 1')
plt.plot(X, Y, linestyle='--', label='tangent at (√2/2, √2/2)')
plt.scatter([x0], [y0])
plt.axis('equal'); plt.grid(True); plt.legend(); plt.title('Circle & Tangent')
plt.show()
```

### (B) 포섬의 접선(임의 점)
```python
import numpy as np
import matplotlib.pyplot as plt

# Folium of Descartes: x^3 + y^3 = 3a x y
a = 1.0
t = np.linspace(-2, 2, 1000)

# 파라메트릭 표현(표준): x = 3at/(1+t^3), y = 3at^2/(1+t^3)
x = 3*a*t/(1+t**3)
y = 3*a*t**2/(1+t**3)

# 특정 t0에서의 점과 기울기
t0 = 0.8
x0 = 3*a*t0/(1+t0**3)
y0 = 3*a*t0**2/(1+t0**3)

# 암시적 미분에서 얻은 기울기: y' = (a y - x^2) / (y^2 - a x)
m = (a*y0 - x0**2) / (y0**2 - a*x0)

X = np.linspace(x0-1, x0+1, 200)
Y = m*(X - x0) + y0

plt.plot(x, y, label='Folium (a=1)')
plt.plot(X, Y, linestyle='--', label=f'Tangent at t={t0:.2f}')
plt.scatter([x0], [y0])
plt.axis('equal'); plt.grid(True); plt.legend(); plt.title('Folium & Tangent')
plt.show()
```

---

## ✅ 15) 자주 하는 실수 체크리스트

- [ ] **연쇄법칙 누락**: $$\dfrac{d}{dx}[\sin y]=\cos y\cdot y'$$, $$\dfrac{d}{dx}[y^n]=n y^{n-1}y'$$.  
- [ ] **분모 0**: $$y'=-F_x/F_y$$ 사용 시 $$F_y=0$$ 인지 반드시 확인.  
- [ ] **특이점 착각**: $$F_x=F_y=0$$ 인 점은 1차 미분만으로 판정 불가(고차 분석 필요).  
- [ ] **정의역**: $$\ln y,\ \sqrt{y},\ 1/y$$ 등은 $$y$$ 의 범위 제약 확인.  
- [ ] **대칭 활용**: 심플한 수평/수직 접선은 대칭(축/원점)으로 **빠르게** 판정 가능.  
- [ ] **고차 미분**: 2차 도함수 공식에 **1차 결과를 대입**해 정리.

---

## ✅ 16) 연습문제(해설 스케치 포함)

1) $$x^3+y^3=6xy$$ 에서 $$y'$$  
   - $$F_x=3x^2-6y,\ F_y=3y^2-6x\Rightarrow
     \boxed{y'=-\dfrac{3x^2-6y}{3y^2-6x}}.$$

2) $$\ln(x+y)=x-y\ (x+y>0)$$ 에서 $$y'$$  
   - 미분: $$\dfrac{1}{x+y}(1+y')=1-y'$$  
   - 정리: $$\boxed{y'=\dfrac{x+y-1}{x+y+1}}.$$

3) $$\sin(xy)=x+y$$ 에서 $$y'$$  
   - 미분: $$\cos(xy)\,(x\,y'+y)=1+y'$$  
   - 정리: $$y'(\cos(xy)\,x-1)=1-\cos(xy)\,y$$  
   - $$\boxed{y'=\dfrac{1-\cos(xy)\,y}{\cos(xy)\,x-1}}.$$

4) $$e^{x+y}=x^2-y$$ 에서 $$y'$$  
   - $$e^{x+y}(1+y')=2x-y'$$  
   - $$\boxed{y'=\dfrac{2x-e^{x+y}}{e^{x+y}+1}}.$$

5) 원 $$x^2+y^2=1$$ 의 2차 도함수 $$y''$$  
   - 스케치: $$y'=-x/y\ \Rightarrow\ y''=-1/y^3.$$

6) $$x^2y+y^2x=1$$ 의 원점 근처 접선 분류  
   - $$F_x=2xy+y^2,\ F_y=x^2+2xy$$ → $$F_x(0,0)=F_y(0,0)=0$$ → **특이점**, 고차 판정 필요.

7) $$x^y=2$$ 에서 $$y'$$  
   - 로그 미분: $$y'=-\dfrac{\ln 2}{x(\ln x)^2}.$$

---

## ✅ 17) 한 페이지 요약

- **한 줄**: $$\displaystyle \frac{dy}{dx}=-\,\frac{F_x}{F_y}\ (F_y\neq 0).$$  
- **수평/수직**: $$F_x=0 \Rightarrow y'=0$$, $$F_y=0\Rightarrow$$ 수직.  
- **2차**: $$\displaystyle y''= -\,\frac{F_{xx}+2F_{xy}y'+F_{yy}(y')^2}{F_y}.$$  
- **법선**: $$\nabla F$$ 가 법선, $$\nabla F\cdot(1,y')=0$$.  
- **역함수**: 원함수 식을 암시적으로 미분하면 역함수 도함수 회복.  
- **특이점**: $$F_x=F_y=0$$ 에서는 고차/파라메트릭 분석.

---

## 마무리

음함수 미분은 **연쇄법칙을 방정식 전체에 적용**하는 기술입니다.  
정리된 공식을 기억하되, **정의역/특이점/수평·수직 접선**을 함께 점검하면 실전에서 막힘이 없습니다.  
필요하면 2차 미분과 곡률까지 확장해 **기하학적 성질**을 해석하세요.