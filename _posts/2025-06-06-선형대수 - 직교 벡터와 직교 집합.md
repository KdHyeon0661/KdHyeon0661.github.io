---
layout: post
title: 선형대수 - 직교 벡터와 직교 집합
date: 2025-06-06 21:20:23 +0900
category: 선형대수
---
# 직교 벡터와 직교 집합

> **핵심 요약**  
> 두 벡터 \(u,v\)가 **직교** ↔ 내적 \(u\cdot v=0\).  
> 직교 **집합**은 벡터들이 서로 모두 직교하는 집합이며(영벡터 제외) **항상 선형독립**이다.  
> 정규직교(orthonormal) 기저에서는 좌표가 단순히 **내적 한 번**으로 떨어지고, 투영·거리·최소제곱이 깔끔해진다.

---

## 1. 기본 정의와 직관

### 1.1 직교(Orthogonality)
두 벡터 \(u,v \in \mathbb{R}^n\)에 대하여
\[
\boxed{u\cdot v = \sum_{i=1}^n u_i v_i = 0 \;\;\Longleftrightarrow\;\; u \perp v}
\]
- 기하학적 의미: 각도 \(\theta\)에 대해 \(u\cdot v=\|u\|\|v\|\cos\theta\); \(u\cdot v=0\Rightarrow \theta=90^\circ\).

### 1.2 직교 집합 / 정규 직교 집합
- **직교 집합**: \(\{v_1,\dots,v_k\}\)가 모든 \(i\neq j\)에 대해 \(v_i\cdot v_j=0\).
- **정규 직교 집합(Orthonormal)**: 위에 더해 \(\|v_i\|=1\) (모든 \(i\)).

---

## 2. 중요한 성질 (증명 스케치 포함)

### 2.1 직교 집합 ⇒ 선형독립(영벡터 없음 가정)
\[
\sum_{i=1}^k \alpha_i v_i = 0 \ \Rightarrow\ 
v_j\cdot\Big(\sum_i \alpha_i v_i\Big) = \sum_i \alpha_i (v_j\cdot v_i) = \alpha_j \|v_j\|^2 = 0
\]
\(\|v_j\|^2>0\) 이므로 \(\alpha_j=0\). 모든 \(j\)에 대해 성립 → 선형독립.

### 2.2 피타고라스 정리(직교 분해)
\(u\perp v\)이면
\[
\|u+v\|^2 = \|u\|^2 + \|v\|^2
\]
(교차항 \(2u\cdot v=0\)).

### 2.3 정규 직교 기저에서의 좌표
정규직교 \(\{u_1,\dots,u_k\}\)가 부분공간 \(W\)의 기저이면, \(w\in W\)는
\[
\boxed{w=\sum_{i=1}^k (w\cdot u_i) u_i}
\]
(계수 = 단순 내적). 일반 기저는 선형연립 필요하지만, **정규직교**는 내적 한 번으로 좌표가 끝난다.

---

## 3. 직교보완(Orthogonal Complement)와 기본 4공간

### 3.1 정의
부분공간 \(W\subseteq \mathbb{R}^n\)에 대해
\[
W^\perp=\{x\in\mathbb{R}^n \mid x\cdot w=0\ \forall w\in W\}
\]
- \(W\cap W^\perp=\{0\},\quad (W^\perp)^\perp=\overline{W}\) (유클리드 공간에선 닫힘).
- \(\dim W + \dim W^\perp = n\).

### 3.2 행렬과의 연계(기본 4공간 정리)
\(A\in\mathbb{R}^{m\times n}\)일 때
\[
\mathrm{Row}(A) = (\mathrm{Null}(A))^\perp,\quad
\mathrm{Col}(A) = (\mathrm{Null}(A^\top))^\perp
\]
- 행공간과 영공간, 열공간과 \(A^\top\)의 영공간이 서로 직교보완 관계.

---

## 4. 투영(Projection), 거리, 최소제곱과 직교성

### 4.1 한 벡터 위 투영
\[
\mathrm{proj}_u(v)=\frac{v\cdot u}{u\cdot u}\,u,\quad 
v = \underbrace{\mathrm{proj}_u(v)}_{\parallel u} + \underbrace{(v-\mathrm{proj}_u(v))}_{\perp u}
\]
잔차 \(r=v-\mathrm{proj}_u(v)\)는 \(u\)에 직교.

### 4.2 부분공간 \(W=\mathrm{span}\{u_1,\dots,u_k\}\) (정규직교 기저)로의 투영
\[
\mathrm{proj}_W(v)=\sum_{i=1}^k (v\cdot u_i)\,u_i,\quad
P=\sum_{i=1}^k u_i u_i^\top = QQ^\top\ (Q=[u_1\ \cdots\ u_k])
\]
- \(P\)는 **대칭**(\(P^\top=P\))이고 **멱등**(\(P^2=P\)).

### 4.3 거리와 최소제곱
- \(d(v,W)=\|v-\mathrm{proj}_W(v)\|\).
- 과잉결정 \(Ax\approx b\)의 해 \(x^\*\)는 \(\mathrm{Col}(A)\)에의 직교투영으로 유도:  
  \(r=b-Ax^\*\perp \mathrm{Col}(A)\Rightarrow A^\top r=0\Rightarrow A^\top A x^\* = A^\top b\) (정규방정식).  
  **QR**에서 \(A=QR\Rightarrow Rx^\*=Q^\top b\).

---

## 5. 직교행렬(Orthogonal Matrix): 회전·반사

### 5.1 정의와 성질
\[
Q^\top Q=I \;\Longleftrightarrow\; Q^{-1}=Q^\top
\]
- 열벡터(또는 행벡터)가 정규직교.
- \(\|Qx\|=\|x\|\), 각도 보존(등거리 변환).
- \(\det Q=\pm 1\): \(+1\) 회전, \(-1\) 반사(뒤집힘) 포함.

### 5.2 예
- 2D 회전 \(R(\theta)=\begin{bmatrix}\cos\theta&-\sin\theta\\ \sin\theta&\cos\theta\end{bmatrix}\).
- 축 반사 \(\mathrm{diag}(1,\dots,1,-1)\) (한 축 뒤집힘).

---

## 6. 손계산 예제

### 6.1 2D 직교 예제
\[
u=\begin{bmatrix}1\\2\end{bmatrix},\quad
v=\begin{bmatrix}2\\-1\end{bmatrix}\quad\Rightarrow\quad
u\cdot v = 1\cdot 2 + 2\cdot(-1)=0\;\Rightarrow\;u\perp v
\]
- \(w=\begin{bmatrix}3\\4\end{bmatrix}\)를 \(u\)로 분해:
\[
\mathrm{proj}_u(w)=\frac{w\cdot u}{u\cdot u}u=\frac{3\cdot 1 + 4\cdot 2}{1^2+2^2}\,u=\frac{11}{5}u
\]
잔차 \(w-\mathrm{proj}_u(w)\)는 \(u\)에 직교, 거리 \(=\big\|w-\mathrm{proj}_u(w)\big\|\).

### 6.2 3D 평면 투영(정규직교 기저 사용)
\[
u_1=\frac{1}{\sqrt2}\!\begin{bmatrix}1\\1\\0\end{bmatrix},\quad
u_2=\frac{1}{\sqrt2}\!\begin{bmatrix}1\\-1\\0\end{bmatrix}
\]
평면 \(W=\mathrm{span}\{u_1,u_2\}\)은 \(z=0\) 평면.  
\(v=\begin{bmatrix}2\\1\\3\end{bmatrix}\)의 투영:
\[
\mathrm{proj}_W(v)=(v\cdot u_1)u_1+(v\cdot u_2)u_2
\]
계산하면 \(\mathrm{proj}_W(v)=[2\;1\;0]^\top\), 거리는 \(|3|\) (법선 \([0,0,1]\) 방향 성분).

### 6.3 직교보완 찾기(선의 직교보완=평면)
\(W=\mathrm{span}\{a\},\ a\neq 0\). 그러면
\[
W^\perp=\{x\in\mathbb{R}^3\mid a\cdot x=0\}
\]
예: \(a=[1,2,3]^\top\)이면 \(x\)가 \(x_1+2x_2+3x_3=0\)을 만족하는 평면.

---

## 7. Python 실습 (NumPy/SymPy)

> **주의**: 수치오차로 “정확한 0” 대신 \(10^{-15}\) 근방이 나올 수 있으니, **허용오차**를 두고 판단하세요.

```python
import numpy as np

def is_orthogonal(u, v, tol=1e-12):
    return abs(np.dot(u, v)) < tol

# 7.1 직교 확인
u = np.array([1., 2.])
v = np.array([2., -1.])
print("u·v =", np.dot(u, v), "→ orthogonal?", is_orthogonal(u, v))

# 7.2 정규직교 집합(단위행렬 열벡터)
Q = np.eye(3)
print("Q^T Q =\n", Q.T @ Q)  # 항등행렬
print("orthonormal columns?", np.allclose(Q.T @ Q, np.eye(3)))

# 7.3 벡터를 직교 분해: v = proj_u(v) + residual ⟂ u
def proj_u(v, u):
    return (np.dot(v, u) / np.dot(u, u)) * u

w = np.array([3., 4.])
p = proj_u(w, u)
r = w - p
print("projection:", p, "residual:", r, "⊥?", is_orthogonal(r, u))

# 7.4 평면(정규직교 기저)로의 투영: P = Q Q^T
u1 = np.array([1., 1., 0.]); u1 = u1/np.linalg.norm(u1)
u2 = np.array([1.,-1., 0.]); u2 = u2/np.linalg.norm(u2)
Q2 = np.column_stack([u1, u2])         # (3x2)
P = Q2 @ Q2.T                           # (3x3) projector
v3 = np.array([2., 1., 3.])
pv = P @ v3
print("proj to plane:", pv)
print("residual ⟂ plane?", np.allclose(Q2.T @ (v3 - pv), 0, atol=1e-12))

# 7.5 직교행렬 예: 2D 회전
theta = np.deg2rad(30)
R = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])
print("R^T R =\n", R.T @ R, "det(R) =", np.linalg.det(R))
x = np.array([5., 0.])
print("||Rx|| == ||x|| ?", np.allclose(np.linalg.norm(R@x), np.linalg.norm(x)))
```

### 7.6 직교보완(Null space)로 구하기 — SymPy
행렬 \(A\)의 **열공간**과 \(A^\top\)의 **영공간**은 직교보완. 예시로 \(\mathrm{Null}(A^\top)\)을 구한다.

```python
from sympy import Matrix

A = Matrix([[1, 0, 1],
            [0, 1, 1]])  # (2x3)
# Null(A^T) = vectors z s.t. A^T z = 0  ⇒ Col(A)^\perp
N = Matrix(A.T).nullspace()
print("basis of Null(A^T):", N)  # Col(A) 직교보완의 기저
```

---

## 8. 실전 시나리오

- **컴퓨터 그래픽스**: 직교행렬(회전)로 모델을 회전시켜도 길이·각도가 보존 → 왜곡 없이 포즈만 바뀐다. 반사(Det<0)는 좌우 뒤집힘.  
- **신호처리**: 특정 주파수 기저(정규직교)로 투영해 원하는 성분만 남기고(필터링), 나머지는 잔차로 제거.  
- **머신러닝(최소제곱)**: \(Ax\approx b\)에서 잔차 \(r=b-Ax^\*)\)가 \(\mathrm{Col}(A)\)에 직교하도록 \(x^\*\)를 찾는다(정규방정식/QR).  
- **수치안정성**: 정규직교 기저는 조건수가 좋아, 좌표 계산·투영·회귀해가 안정적.

---

## 9. 자주 하는 실수 & 체크리스트

1. **영벡터 포함**한 “직교 집합” → 선형독립 결론이 깨짐(영벡터는 어떤 벡터와도 직교).  
2. **정규화 누락**: “직교”와 “정규직교” 혼동 → 좌표 추출시 오차.  
3. **수치판정에서 0 비교**: 부동소수점 환경선 \(|u\cdot v|<\varepsilon\)로 판단할 것.  
4. **프로젝터 성질 미체크**: \(P^2=P,\ P^\top=P\)가 깨지면 구현 오류.  
5. **직교행렬 판정 미흡**: \(Q^\top Q\approx I\)와 \(|\det Q|\approx 1\) 둘 다 살필 것.

---

## 10. 핵심 정리표

| 개념 | 정의/조건 | 즉시 결과 |
|---|---|---|
| 직교 \(u\perp v\) | \(u\cdot v=0\) | 피타고라스 \(\|u+v\|^2=\|u\|^2+\|v\|^2\) |
| 직교 집합 | \(v_i\cdot v_j=0\ (i\ne j)\) | (영벡터 제외) **선형독립** |
| 정규직교 집합 | 직교 + \(\|v_i\|=1\) | 좌표 = **내적 한 번** |
| 투영(정규직교) | \(\mathrm{proj}_W(v)=\sum (v\cdot u_i)u_i\) | 잔차 \(\perp W\), 거리 \(\|v-\mathrm{proj}_W(v)\|\) |
| 프로젝터 | \(P=QQ^\top\) | \(P^2=P,\ P^\top=P\) |
| 직교보완 | \(W^\perp=\{x:x\cdot w=0\ \forall w\}\) | \(\dim W + \dim W^\perp=n\) |
| 직교행렬 | \(Q^\top Q=I\) | \(\|Qx\|=\|x\|\), \(\det Q=\pm 1\) |

---

## 11. 마무리 요약(TL;DR)

- **직교/정규직교**는 계산을 극단적으로 단순화한다(좌표·투영·거리·최소제곱).  
- **직교 집합**(영벡터 제외)은 **항상 선형독립**이고, 정규직교면 좌표가 내적 한 번으로 끝난다.  
- **직교보완**과 **프로젝터**(대칭·멱등)는 선형시스템/최소제곱의 구조를 한눈에 보여준다.  
- **직교행렬**은 길이·각도 보존(회전/반사). 실전 구현에선 **허용오차**와 **성질검사**가 필수.

---
```python
# 보너스: 한 번에 묶은 작은 실험 함수
import numpy as np

def demo_orthogonality():
    u = np.array([1., 2.]); v = np.array([2., -1.])
    print("u·v =", np.dot(u, v), "(~0 => orthogonal)")

    # Orthonormal basis in R^3 (plane z=0)
    u1 = np.array([1., 1., 0.]); u1 /= np.linalg.norm(u1)
    u2 = np.array([1.,-1., 0.]); u2 /= np.linalg.norm(u2)
    Q = np.column_stack([u1, u2])
    P = Q @ Q.T
    x = np.array([2., 1., 3.])
    px = P @ x
    r  = x - px
    print("proj(x) =", px, " residual ⟂ plane?", np.allclose(Q.T @ r, 0, atol=1e-12))

    # Orthogonal matrix test
    theta = np.deg2rad(30)
    R = np.array([[np.cos(theta), -np.sin(theta)],
                  [np.sin(theta),  np.cos(theta)]])
    print("R^T R ~ I ?", np.allclose(R.T @ R, np.eye(2)))
    print("det(R) ~ 1 ?", abs(np.linalg.det(R)-1) < 1e-12)

demo_orthogonality()
```