---
layout: post
title: TCPIP - 라우팅 프로토콜
date: 2025-08-30 21:25:23 +0900
category: TCPIP
---
# TCP/IP 라우팅 프로토콜 (게이트웨이 프로토콜)

## 주요 라우팅 프로토콜 개념 개요: 아키텍처, 프로토콜 유형, 알고리즘 및 메트릭

라우팅 프로토콜은 네트워크에서 데이터 패킷이 출발지에서 목적지까지 최적의 경로를 찾아 이동할 수 있도록 라우터들 간에 경로 정보를 교환하는 규칙 체계입니다. 이러한 프로토콜들은 네트워크의 확장성, 안정성, 효율성을 보장하는 핵심 인프라입니다.

### 라우팅 프로토텍처 분류

#### 자율 시스템 개념
```
인터넷 구조:
┌─────────────────┐   ┌─────────────────┐
│ 자율 시스템 A   │   │ 자율 시스템 B   │
│ (ISP, 대기업)   │   │ (다른 조직)     │
│ Interior        │   │ Interior        │
│ Routing         │   │ Routing         │
└────────┬────────┘   └────────┬────────┘
         │                      │
         └──────────────────────┘
               Exterior Routing
               (AS 간 연결)
```

**자율 시스템(Autonomous System, AS)**: 단일 관리 주체 하에 운영되는 라우터와 네트워크의 집합
- **AS 번호**: 16비트(1-64511: 공인, 64512-65535: 사설) 또는 32비트 확장

#### 내부 vs 외부 게이트웨이 프로토콜

**내부 게이트웨이 프로토콜 (IGP)**
- 동일 AS 내부에서 사용
- 예: RIP, OSPF, EIGRP, IS-IS
- 목표: 빠른 수렴, 효율적 자원 활용

**외부 게이트웨이 프로토콜 (EGP)**
- 서로 다른 AS 간 연결에 사용
- 예: BGP (Border Gateway Protocol)
- 목표: 정책 기반 라우팅, 보안, 안정성

### 라우팅 알고리즘 유형

#### 1. 거리 벡터 알고리즘
- 각 라우터가 이웃 라우터에게 자신의 전체 라우팅 테이블 주기적 전송
- "벨만-포드 알고리즘" 기반
- 특징: 단순함, 대역폭 소비 많음, 느린 수렴
- 예: RIP, IGRP

#### 2. 링크 상태 알고리즘
- 각 라우터가 네트워크 전체 토폴로지 맵 구성
- 최단 경로 우선 알고리즘(다익스트라) 사용
- 특징: 빠른 수렴, 토폴로지 변화에 민감
- 예: OSPF, IS-IS

#### 3. 경로 벡터 알고리즘
- BGP에서 사용
- 경로 자체를 벡터로 전파
- 정책 기반 의사결정 가능

### 라우팅 메트릭 (비용 지표)
메트릭은 경로의 "비용"을 측정하여 최적 경로 선택의 기준이 됩니다:

**일반적인 메트릭 요소:**
1. **홉 카운트**: 경로상의 라우터 수
2. **대역폭**: 링크의 용량
3. **지연**: 패킷 전송 소요 시간
4. **신뢰성**: 링크 오류율
5. **부하**: 링크 사용량
6. **MTU**: 최대 전송 단위
7. **비용**: 운영 비용

```
예: 복합 메트릭 계산
경로 A: 대역폭 100Mbps, 지연 10ms, 홉 3
경로 B: 대역폭 10Mbps, 지연 5ms, 홉 2
→ 애플리케이션 요구사항에 따라 다른 경로 선택 가능
```

## TCP/IP 내부 라우팅 프로토콜

내부 라우팅 프로토콜들은 조직 내부 네트워크에서 효율적인 경로 선택을 담당합니다.

**주요 IGP 프로토콜 계보:**
```
초기: RIP (1988) → 제한적
    ↓
개선: IGRP (Cisco 전용, 1986) → EIGRP (1992)  
    ↓
개방형 표준: OSPF (1989) → OSPFv2, OSPFv3
    ↓
통신사용: IS-IS (1990) → 확장성 우수
```

## TCP/IP 라우팅 정보 프로토콜 (RIP, RIP-2 및 RIPng)

### RIP 기본 원리와 일반 동작

RIP는 가장 오래되고 단순한 거리 벡터 라우팅 프로토콜로, 소규모 네트워크에서 널리 사용됩니다.

#### RIP 개요, 역사, 표준 및 버전
- **초기 개발**: 1960년대 Xerox 네트워크 시스템용
- **표준화**: 1988년 RFC 1058 (RIPv1)
- **개선**: 1993년 RFC 2453 (RIPv2)
- **IPv6 지원**: 1997년 RFC 2080 (RIPng)

**RIP의 설계 철학:**
- **KISS 원칙**: 단순함 유지
- **15홉 제한**: 무한 계수 문제 방지
- **30초 업데이트**: 주기적 전체 테이블 전송
- **UDP 520 포트**: 연결 없는 전송

### RIP 경로 결정 알고리즘과 메트릭

#### 벨만-포드 알고리즘 기반
```
각 라우터 R은:
1. 인접 라우터로부터 거리 벡터 수신
2. 수신된 벡터에 +1 (자신의 홉 추가)
3. 기존 경로보다 좋은 경로 발견 시 테이블 갱신
4. 180초 동안 업데이트 없으면 경로 무효화
```

**메트릭 계산:**
```
경로 메트릭 = 수신 메트릭 + 1 (출발지에서 다음 홉까지)

라우터 A → 라우터 B → 목적지 네트워크
A의 관점: B가 "목적지까지 3홉" 보고 → A는 "목적지까지 4홉"으로 기록
```

**무한 계수 문제와 해결:**
```
문제: A→B→C→A 루프 발생 시 메트릭 무한 증가
해결책: 
1. 15홉 제한 (16 = 무한대)
2. Split Horizon (경로를 배운 인터페이스로 재전송 금지)
3. Route Poisoning (무효 경로를 16으로 명시적 표시)
4. Hold-down Timer (일정 시간 동안 경로 변경 억제)
```

### RIP 일반 동작, 메시징 및 타이머

#### RIP 메시지 교환 주기
```
라우터 A               라우터 B               라우터 C
   │                      │                      │
   │──30초 주기───────────│                      │
   │   전체 테이블 전송   │                      │  
   │                      │                      │
   │                      │───30초 후───────────│
   │                      │   전체 테이블 전송   │
   │                      │                      │
```

#### 핵심 타이머들
1. **업데이트 타이머**: 30초 (전체 라우팅 테이블 브로드캐스트)
2. **무효 타이머**: 180초 (경로 업데이트 없을 시 무효화)
3. **플러시 타이머**: 240초 (무효 경로 테이블에서 삭제)
4. **홀드다운 타이머**: 180초 (불안정한 경로 변경 억제)

#### 트리거 업데이트
토폴로지 변화 발생 시 즉시 업데이트 전송:
```
네트워크 장애 발생
라우터 A: 인접 링크 다운 감지
        ↓
즉시 업데이트 전송 (30초 기다리지 않음)
        ↓
이웃 라우터들 빠르게 수렴
```

### RIP 프로토콜 제한사항과 문제점

#### 주요 한계들
1. **15홉 제한**: 대규모 네트워크 부적합
   ```
   인터넷: 수십 홉 경로 일반적
   RIP: 16홉 이상 불가능
   ```

2. **고정 메트릭**: 홉 카운트만 고려
   ```
   고속 1홉 vs 저속 2홉 경로
   RIP: 항상 1홉 선택 (대역폭 무시)
   ```

3. **대역폭 낭비**: 30초마다 전체 테이블 브로드캐스트
   ```
   100개 경로 라우터 × 100개 이웃 → 상당한 오버헤드
   ```

4. **느린 수렴**: 최대 180초 소요
   ```
   장애 발생 → 인접 라우터 감지(30초) → 전파(30초×홉수)
   패킷 손실 가능성 높음
   ```

5. **라우팅 루프**: 수렴 중 임시 루프 발생 가능

### RIP 알고리즘 문제 해결을 위한 특수 기능들

#### Split Horizon (수평 분할)
```
라우터 A → 라우터 B: "네트워크 X는 내게 있어"
라우터 B는 A에게 네트워크 X에 대한 정보를 재전송하지 않음
→ 루프 방지
```

#### Poison Reverse (독 역방향)
```
Split Horizon의 변형:
라우터 B가 A에게 네트워크 X를 "무한대(16)"로 명시적 보고
→ 더 빠른 수렴
```

#### Route Poisoning (경로 독화)
```
장애 감지 시 즉시 해당 경로를 16(무한대)로 표시
이웃 라우터들이 즉시 무효화 인지
```

**RIP 수렴 과정 예시:**
```
초기: A-B-C-D 연결
A→D: 경로 A-B-C-D (3홉)

B-C 링크 장애:
1. C가 B-C 링크 독화(16) → B에 전송
2. B가 경로 무효화, A에 독 역방향(16) 전송
3. A가 대체 경로 탐색 (있는 경우)
4. 180초 후 무효 경로 삭제
```

## RIP 버전별 메시지 형식과 기능

### RIP 버전 1 메시지 형식

RIPv1은 클래스풀(classful) 라우팅만 지원하는 기본 버전입니다.

```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Command (1)  |  Version (1)  |          must be zero         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Address Family Identifier (2) |          must be zero         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        IPv4 Address                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        must be zero                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        must be zero                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Metric                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            ...                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**필드 설명:**
- **Command**: 1=요청, 2=응답, 3/4=폐기됨, 5=폴링 요청
- **Version**: 1 (RIPv1)
- **Address Family**: IPv4=2
- **IPv4 Address**: 목적지 네트워크 주소
- **Metric**: 1-16 (홉 수)

**RIPv1 제한사항:**
1. **브로드캐스트 전송**: 255.255.255.255로 전송
2. **서브넷 마스크 없음**: 클래스 기본 마스크만 사용
3. **인증 없음**: 보안 취약
4. **VLSM 미지원**: 동일 클래스 내 동일 서브넷 마스크 필요

### RIP 버전 2 메시지 형식과 기능

RIPv2는 현대 네트워크 요구사항을 반영한 개선 버전입니다.

```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Command (1)  |  Version (2)  |          must be zero         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Address Family Identifier (2) |         Route Tag (0)         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         IPv4 Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Subnet Mask                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Next Hop                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Metric                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**RIPv2의 주요 향상 기능:**

1. **서브넷 마스크 지원**: VLSM 및 CIDR 라우팅 가능
   ```
   192.168.1.0/24와 192.168.2.0/26를 구분하여 전송
   ```

2. **다음 홉 명시**: 최적의 다음 홉 주소 지정 가능
   ```
   경로 A-B-C-D에서 B가 C에게 "D로 가려면 E를 통해" 지시
   ```

3. **멀티캐스트 전송**: 224.0.0.9로 전송 (RIP 라우터만 수신)
   ```
   브로드캐스트 대신 멀티캐스트 → 호스트 부하 감소
   ```

4. **간단한 인증**: 평문 암호 지원
   ```
   인증 유형=2, 16바이트 암호
   (제한적 보안, MD5는 확장으로 추가)
   ```

5. **라우트 태그**: 외부 경로 식별 가능
   ```
   BGP에서 재분배된 경로 표시
   ```

### RIPng ("RIPv6") 메시지 형식과 기능

RIPng는 IPv6를 지원하기 위한 RIP 확장입니다.

```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Command (1)  |  Version (1)  |        must be zero           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Route Table Entry 1                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            ...                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Route Table Entry N                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**라우트 테이블 엔트리 (128비트):**
```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         IPv6 Prefix (128비트) - 첫 16바이트                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   IPv6 Prefix 계속 (다음 16바이트)                            |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Route Tag             |   Prefix Length  |    Metric   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**RIPng의 특징:**

1. **IPv6 주소 지원**: 128비트 주소 완전 지원
   ```
   기존: 32비트 IPv4 주소
   RIPng: 128비트 IPv6 주소 + 프리픽스 길이
   ```

2. **UDP 포트 변경**: 521 포트 사용
   ```
   RIP(v1/v2): UDP 520
   RIPng: UDP 521
   ```

3. **링크-로컬 주소 사용**: FE80::/10 범위에서 통신
   ```
   멀티캐스트 주소: FF02::9 (모든 RIPng 라우터)
   ```

4. **Nexthop 필드 분리**: 별도의 Nexthop 엔트리로 구현
   ```
   일반 엔트리 뒤에 특수 Nexthop 엔트리 추가 가능
   ```

5. **확장성 향상**: 여러 엔트리를 하나의 패킷에 포함 가능
   ```
   MTU 제한 내에서 최대한 많은 경로 정보 전송
   ```

## 결론

RIP 프로토콜은 라우팅 프로토콜 발전사에서 중요한 이정표를 제공합니다. 1980년대의 단순한 거리 벡터 프로토콜에서 시작하여 RIPv2의 클래스리스 라우팅 지원을 거쳐, RIPng의 IPv6 완전 지원에 이르기까지, RIP는 네트워크 환경 변화에 적응하며 지속적으로 진화해 왔습니다.

RIP의 가장 큰 강점은 단순성과 구현 용이성에 있습니다. 소규모 네트워크나 엣지 라우터에서 여전히 유용하게 사용되며, 라우팅 개념을 이해하기 위한 교육적 가치도 높습니다. Split Horizon, Route Poisoning, Hold-down Timer 같은 메커니즘들은 거리 벡터 프로토콜의 고전적인 문제들에 대한 우아한 해결책을 보여줍니다.

그러나 RIP의 근본적인 한계—15홉 제한, 느린 수렴, 대역폭 비효율성—는 대규모 현대 네트워크에서의 사용을 제한합니다. 오늘날 기업 네트워크에서는 OSPF나 EIGRP가, 서비스 제공자 네트워크에서는 IS-IS가 더 선호되는 선택지입니다. 이러한 프로토콜들은 링크 상태 알고리즘을 사용하여 빠른 수렴, 계층적 설계, 다양한 메트릭 지원을 제공합니다.

RIPng는 IPv6 전환기에 과도기적 역할을 하고 있지만, OSPFv3나 EIGRP for IPv6에 비해 기능적 제한이 많습니다. 그럼에도 불구하고, 기존 RIP 인프라를 가진 조직에게는 친숙한 인터페이스와 낮은 학습 곡선을 제공하는 매력적 옵션입니다.

라우팅 프로토콜 선택은 네트워크 크기, 복잡성, 성능 요구사항, 관리 전문성, 벤더 종속성 등 여러 요소를 종합적으로 고려해야 합니다. RIP는 특정 환경에서 여전히 가치 있는 도구이지만, 네트워크 설계자는 그 한계를 인지하고 필요시 더 발전된 프로토콜로의 전환을 준비해야 합니다.

궁극적으로, RIP의 진정한 유산은 라우팅 프로토콜 설계의 기본 원칙을 정립한 데 있습니다. 오늘날의 복잡한 라우팅 프로토콜들도 여전히 RIP에서 시작된 기본 개념들—경로 메트릭, 주기적 업데이트, 루프 방지 메커니즘—위에 구축되어 있습니다. 이러한 역사적 관점에서 RIP를 이해하는 것은 현대 네트워킹 기술의 발전을 더 깊이 있게 파악하는 데 도움이 됩니다.