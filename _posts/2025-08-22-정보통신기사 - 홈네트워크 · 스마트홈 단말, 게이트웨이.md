---
layout: post
title: 정보통신기사 - 홈네트워크 · 스마트홈 단말, 게이트웨이
date: 2025-08-22 11:25:23 +0900
category: 정보통신기사
---
# 홈네트워크 · 스마트홈 단말/게이트웨이 총정리

## 0. 큰 그림: “스마트홈 = 이종 무선 + IP + 자동화 엔진”

- 집 안에는 **서로 다른 무선/유선**(Wi-Fi, Zigbee, Thread, Z-Wave, BLE, Ethernet/PoE)이 **혼재**합니다.
- **게이트웨이/허브**가 이들을 **IP 네트워크**로 모아주고, **자동화 엔진**(예: 로컬 허브/앱/클라우드)이 동작 규칙을 실행.
- **보안/안정성**의 핵심은:  
  1) **망 분리(VLAN/방화벽)**, 2) **표준 스택(예: Matter) 우선**, 3) **전력·무선 간섭 관리**, 4) **오프라인 동작(로컬 퍼스트)**.

---

## 1. 물리/무선 매체 한눈에

### 1.1 유선(Ethernet/PoE/전력선)
- **Ethernet**: 100M/1G/2.5G/10G. 벽면 포트 및 스위치 연결.  
- **PoE**: AP/카메라/허브 전원 공급(802.3af 15.4W, at 30W, bt 60/90W).  
- **PLC(전력선 통신)**: 콘센트만으로 확장(간섭/보안·속도 한계, 가능하면 보조 용도).

### 1.2 Wi-Fi (2.4/5/6 GHz)
- 장점: **IP 직접**, 고대역폭(카메라/스피커), 보편적.  
- 단점: **전력소모↑**, 2.4GHz 혼잡.  
- **권장**: IoT는 2.4 GHz 20 MHz 채널, 멀티미디어는 5/6 GHz.

### 1.3 802.15.4 계열: **Zigbee / Thread**
- **물리**: 2.4 GHz(국제), 일부 지역 Sub-GHz 채널.  
- **Zigbee**: 자체 네트워크 레이어/애플리케이션 클러스터. **코디네이터**·라우터·엔드디바이스.  
- **Thread**: 6LoWPAN + IPv6 메시. **보더 라우터(Border Router)**로 IP 세계에 직접 연결.

### 1.4 **Z-Wave**(Sub-GHz, 지역별 주파수)
- **장점**: 간섭 적음, 벽 투과 유리, 도어록/스위치에 강세.  
- **단점**: 주파수 지역 종속/생태계 규모가 Zigbee/Thread보다 작을 수 있음.

### 1.5 **BLE / BLE Mesh**
- 저전력 근거리, **프록시/게이트웨이** 통해 IP 연동. 존재감지/버튼/비콘에 강함.

### 1.6 기타(옵션)
- **UWB**(실내 정밀 위치), **Wi-Fi HaLow(11ah)**(거리↑ 전력↓), **LoRa/LPWAN**(초저속 장거리 센서).

---

## 2. 프로토콜/스택: 애플리케이션 계층부터 보안까지

### 2.1 **Matter**(공용 상위 표준; 애플/구글/삼성 등 참여)
- **목표**: 브랜드/무선 상관없이 **상호운용**.  
- **전송**: IP 기반(TCP/UDP, IPv6 우선), **Wi-Fi / Thread** 위에서 동작.  
- **파브릭(Fabric)**·**디바이스 인증/페어링**·**PASE/CASE 세션**·**ACL** 등 보안 내장(세부는 생태계 문서 참조).  
- **게이트웨이 역할**: Thread ↔ Ethernet/Wi-Fi IP 경계(보더 라우터) + 컨트롤러(앱/허브).

### 2.2 **Zigbee**
- **클러스터 라이브러리(ZCL)**로 기능 표준화(온도측정, 스위치, 조명 등).  
- **네트워크 키/링크 키**로 보안, 채널은 2.4 GHz 11~26 (Wi-Fi 1/6/11과 간섭 고려).

### 2.3 **Z-Wave**
- **S2 보안**(ECDH), **노드 ID/네트워크 키**. **라우팅 메시**. 도어록/스위치에 널리 쓰임.

### 2.4 **Thread**
- 6LoWPAN(헤더압축) + **메시 라우팅(MLE)**, **보더 라우터**가 **mDNS/서비스 디스커버리**를 IP에 브릿징.  
- 각 노드가 **IPv6 주소**를 가져 **직접적**으로 주소 지정 가능.

### 2.5 **HomeKit(HAP)**, **MQTT/CoAP**
- **HAP**: 엔드-투-엔드 보안/페어링, 애플 생태계.  
- **MQTT**: 경량 Pub/Sub(브로커 필요), **로컬 자동화**에 유리.  
- **CoAP**: UDP 기반 REST-like(관찰/리소스), 저전력 장치와 궁합.

---

## 3. 게이트웨이/허브 아키텍처

### 3.1 역할
- **프로토콜 브리지**: Zigbee/Z-Wave/BLE ↔ IP(MQTT/HTTP/Matter).  
- **Thread 보더 라우터**: 802.15.4 메시를 IPv6/IP 세계에 연결.  
- **자동화 엔진**: 트리거/조건/액션 실행(스케줄/센서/위치/음성).  
- **OTA/디바이스 관리**: 펌웨어 업데이트·장치 인증/등록.

### 3.2 토폴로지
- **코디네이터/컨트롤러 1차–N 라우터 메시**(Zigbee/Z-Wave).  
- **별도 허브**(예: Hue 브리지) vs **통합 게이트웨이**(멀티라디오 + 로컬 엔진).  
- **엣지 우선(로컬)**: 인터넷 불가 시에도 핵심 자동화 유지. **클라우드 보조**(원격 접근/AI).

### 3.3 게이트웨이 하드웨어 고려
- **SoC 성능**(암호화/트랜스코딩/자동화 스크립트),  
- **라디오 동시성**(2.4 Wi-Fi vs 802.15.4 간섭 최소화: **안테나 이격**·채널 계획),  
- **스토리지**(로그/녹화), **PoE**(랙/천장 설치), **UPS**(정전 대비).

---

## 4. 홈 LAN 설계: **망 분리·방화벽·발견 프로토콜**

### 4.1 VLAN/SSIDs 세그멘테이션
- **예시 구조**  
  - **LAN(신뢰)**: PC/노트북/개인기기  
  - **IoT VLAN**: 센서/조명/플러그(인터넷은 필요 서비스만 허용)  
  - **CCTV VLAN**: 카메라·NVR(외부 차단/관리 스테이션만 허용)  
  - **GUEST SSID**: 인터넷 전용, 내부 차단
- **방화벽 룰 핵심**  
  - IoT → 인터넷: **NTP**, 벤더 업데이트 호스트, MQTT 브로커(로컬)만  
  - IoT → LAN: **차단**(예외: 브로커/허브 IP)  
  - LAN → IoT: 허브/관리 앱 → 장치 **허용**  
  - CCTV → NVR: 허용, 외부 전송 차단

### 4.2 서비스 디스커버리(mDNS/SSDP)와 VLAN
- **문제**: 발견 프로토콜은 **브로드캐스트/멀티캐스트** 기반 → VLAN 간 단절.  
- **대응**: **mDNS 리피터/리플렉터**, **IGMP 스누핑/프록시**, 허브가 **프록시** 역할 수행.  
- **Matter/Thread**: 보더 라우터가 mDNS/서비스 브릿징 수행.

### 4.3 Wi-Fi 설계 팁
- 2.4 GHz: **20 MHz 채널**, **1/6/11** 재사용.  
- 5 GHz: 40/80 MHz는 혼잡도 고려. **DFS** 운용 시 레이다 이벤트 대비.  
- 6 GHz(있다면): **WPA3** 필수, 혼잡도 낮음(고대역 기기 전용).  
- **로밍**: 802.11k/v/r, **밴드 스티어링**(IoT는 고정 2.4 권장), **Tx 파워 균형**.

---

## 5. 간섭/채널 계획: 2.4 GHz에서의 **공존**

- **Zigbee/Thread 채널**(11~26)은 **Wi-Fi 1/6/11**과 겹칩니다.  
  - **권장**: Wi-Fi 1(2412 MHz) 사용 시 Zigbee 채널 **15/20/25** 인근 고려(환경 스캔 후 결정).  
  - **AP와 802.15.4 동시 사용** 시 **안테나 이격(>30–50 cm)** 및 **출력 밸런스**로 수신 과포화 방지.
- **전자레인지/무선전화/아기모니터** 등 2.4 간섭원 주의.

---

## 6. 전력: **PoE 예산** & **배터리 수명**

### 6.1 PoE 파워 예산
- **공급능력**: 스위치 총 PoE Budget(예: 150 W).  
- **소비**: 장치별 클래스/실소모 합 + 케이블 손실(길이·AWG).  
- **여유**: **20–30%** 권장.

**예)** 8포트 PoE 스위치(총 150 W)  
- AP 2대 × 13 W = 26 W  
- 카메라 4대 × 9 W = 36 W  
- 허브 1대 × 6 W = 6 W  
- 도어벨 1대 × 10 W = 10 W  
- **합계 78 W** → 충분(여유 72 W)

### 6.2 배터리 수명 계산(저전력 센서)
- 평균 전류 $I_\text{avg}$  
$$
I_\text{avg} = D\cdot I_\text{tx} + (1-D)\cdot I_\text{sleep}
$$
- 예상 수명(시간)  
$$
T \approx \frac{C_\mathrm{mAh}}{I_\text{avg}[\mathrm{mA}]}
$$
- **예)** CR2450(600 mAh), 송신 15 mA × 10 ms/분, 슬립 3 µA  
  - 듀티 $D = \frac{0.01}{60}\approx 1.67\cdot10^{-4}$  
  - $I_\text{avg}\approx 1.67\cdot10^{-4}\cdot 15\text{mA} + 0.003\text{mA}\approx 0.0055\text{ mA}$  
  - 수명 $\approx 600/0.0055\approx 109,000\text{ h}\approx 12.4\text{ 년}$ *(셀/환경/노화로 실제는 더 낮음, 보수적으로 3–5년 가정)*

---

## 7. 자동화 로직: 트리거/조건/액션

### 7.1 설계 원칙
- **로컬 우선**: 인터넷 불가 시에도 동작(문·조명·경보).  
- **상태 머신**: “집/외출/취침/모드” 기반으로 규칙 단순화.  
- **휴먼 팩터**: 수동 개입(스위치/버튼) **항상 가능**(오토와 충돌 방지).  
- **우선순위**: 경보/안전 > 조명 > 편의 > 로그/알림.

### 7.2 예시: **일몰 조명 + 존재감지 + 수면모드**
```yaml
# pseudo: 홈 자동화 엔진 예시
automation:
  - alias: '일몰-귀가 조명'
    trigger: 
      - platform: sun
        event: sunset
    condition:
      - condition: state
        entity_id: person.me
        state: 'home'
    action:
      - service: light.turn_on
        target: { entity_id: light.entry }
        data: { brightness_pct: 60, color_temp: 370 }
      - service: climate.set_temperature
        target: { entity_id: climate.living }
        data: { temperature: 22 }

  - alias: '수면모드'
    trigger:
      - platform: time
        at: '23:30'
    action:
      - service: scene.turn_on
        target: { entity_id: scene.night }
      - service: lock.lock
        target: { entity_id: lock.frontdoor }
      - service: media_player.turn_off
        target: { entity_id: group.tv_audio }
```

### 7.3 예시: **누수 감지 → 메인밸브 차단 + 경보**
```yaml
- alias: '누수-비상차단'
  trigger: 
    - platform: state
      entity_id: binary_sensor.leak_kitchen
      to: 'on'
  action:
    - service: switch.turn_off
      target: { entity_id: switch.main_valve }
    - service: notify.mobile
      data: { message: '주방 누수 감지! 메인밸브 차단' }
    - service: siren.turn_on
      target: { entity_id: siren.hallway }
```

---

## 8. 보안: 집 안은 **내부망**이 아니다

- **Wi-Fi**: **WPA3**(가능하면), AP/관리자 비밀번호 강력, **WPS 비활성**.  
- **망 분리**: IoT VLAN의 **인터넷 접근 최소화**, **동서 트래픽 차단**(IoT↔LAN).  
- **디바이스 보안**: 페어링 시 **고유 키/인증절차** 확인, **디폴트 암호 변경**.  
- **업데이트**: 허브/게이트웨이/장치의 **OTA 주기적**(자동 or 정기 점검).  
- **로그/모니터링**: 허브 이벤트, 방화벽 로그, **이상 트래픽 알림**.  
- **문/자물쇠/경보**: **로컬 제어 가능**·오프라인/정전 대비(키/물리 스위치/UPS).

---

## 9. 신뢰성/품질

- **메시 노드 배치**: 콘센트형 라우터(상시 전원)로 **메시 백본**을 촘촘하게.  
- **채널 스캔**: 설치 전 **Wi-Fi/802.15.4 스펙트럼** 확인 → 채널 고정.  
- **지터/지연**: 음성/벨·인터컴은 **로컬 라우팅**(인터넷 의존 X).  
- **오염원**: 금속 케이스·거울·강한 EMI 주변 설치 지양. AP·허브 **열 관리**.

---

## 10. 구축 사례

### 10.1 원룸/소형(30–50㎡)
- **AP 1대(2.4/5)**, **허브 일체형(멀티라디오)**, 조명 4~6, 스위치 2, 도어락 1, 센서 6(온습/문/모션/연기), IR 블래스터 1.  
- **세그먼트**: Guest SSID, IoT VLAN, LAN.  
- **자동화**: 일몰 조명/존재 감지/IR 냉난방/수면 모드.  
- **PoE**: 필요 없음 or 소형 인젝터(도어벨/카메라 1).

### 10.2 다층 주택(150–250㎡)
- **메시 AP 2–3대**(유선 백홀 권장), **Thread 보더 라우터** 1–2, **Zigbee 코디네이터** 1, **Z-Wave**(도어락), **PoE 스위치**(AP/카메라).  
- **세그먼트**: LAN / IoT / CCTV / Guest (각 SSID).  
- **자동화**: 층별 조명·모드, 누수·연기 경보, 외출 시 전체 전원 오프(필수 유지 전원 제외).

---

## 11. 방화벽 룰 예시(개념)

```bash
# IoT VLAN = 192.168.50.0/24, Hub(Controller)=192.168.10.10, MQTT=192.168.10.20
# 1. IoT -> LAN 기본 차단
deny from 192.168.50.0/24 to 192.168.10.0/24 any

# 2. IoT -> Hub/MQTT 허용
allow from 192.168.50.0/24 to 192.168.10.10 tcp 443
allow from 192.168.50.0/24 to 192.168.10.20 tcp 1883

# 3. IoT -> Internet 최소 허용
allow from 192.168.50.0/24 to any udp 123
allow from 192.168.50.0/24 to vendor.ota.domains tls 443

# 4. mDNS 프록시/리플렉터 장비에서만 멀티캐스트 허용
allow from 224.0.0.251 to 192.168.10.10/32 udp 5353
deny  from 192.168.50.0/24 to 224.0.0.0/4 any
```

---

## 12. Python 미니 계산기(학습용)

```python
# 1. PoE 예산 검증
devices = {
    "AP1": 13, "AP2": 13,
    "Cam1": 9, "Cam2": 9, "Cam3": 9, "Cam4": 9,
    "Hub": 6, "Doorbell": 10
}
poe_budget = 150
total = sum(devices.values())
headroom = poe_budget - total
print("PoE total:", total, "W | headroom:", headroom, "W")

# 2. 배터리 수명
def battery_life_hours(cap_mAh, Itx_mA=15, tx_ms_per_min=10, sleep_uA=3):
    D = (tx_ms_per_min/1000)/60.0
    Iavg_mA = D*Itx_mA + (sleep_uA/1000.0)
    return cap_mAh / Iavg_mA

print("CR2450 est hours:", round(battery_life_hours(600), 0))

# 3. 2.4GHz FSPL vs 거리
import math
def fspl_db(d_m, f_MHz=2400):
    return 32.44 + 20*math.log10(f_MHz) + 20*math.log10(d_m/1000)
for d in [5,10,15]:
    print(d,"m FSPL:", round(fspl_db(d),1),"dB")
```

---

## 13. 자주 겪는 문제 & 해결

1) **장치 페어링 실패**  
   - 원인: 채널 혼잡/보안키 문제/중복 허브.  
   - 해결: 허브 한 개만 **페어링 모드**, 채널 고정·근접, 이전 네트워크 키 초기화.

2) **Wi-Fi IoT 재연결 불안정**  
   - 원인: 2.4/5 GHz SSID 이름 동일, 밴드스티어링 충돌.  
   - 해결: **IoT 전용 2.4 SSID** 분리, 20 MHz 고정, 802.11r/k/v 끔(기기에 따라).

3) **Zigbee 라우팅 부실(구석 센서 간헐 끊김)**  
   - 원인: 라우터(상시전원) 부족.  
   - 해결: **콘센트형 리피터** 2–3개 추가, 메시 깊이 최소화.

4) **도어락 지연/실패**  
   - 원인: 금속문 차폐/배터리 약/채널 혼선.  
   - 해결: **Sub-GHz(Z-Wave)** 우선 검토, 근처 라우터 추가, 배터리 확인.

5) **mDNS 기반 기기 검색 실패(VLAN)**  
   - 해결: **mDNS 리플렉터/프록시** 구성, 허브가 브릿지하도록 설정.

6) **카메라 대역폭 과다**  
   - 해결: VBR 제한, FPS/해상도 조정, **CCTV VLAN** 분리, NVR 로컬 녹화.

---

## 14. 퀵 체크리스트

- [ ] **세그먼트**: LAN / IoT / CCTV / Guest 분리, **방화벽 룰** 작성  
- [ ] **무선**: 2.4(20 MHz)·5/6 GHz 채널 계획, 802.15.4 채널 고정  
- [ ] **게이트웨이**: 멀티라디오 허브 + **Thread BR**, 로컬 자동화 엔진  
- [ ] **보안**: WPA3, 디폴트 암호 변경, OTA 계획, 로컬 우선  
- [ ] **전력**: PoE 예산 20–30% 여유, 배터리 장치 수명 가늠  
- [ ] **신뢰성**: 메시 라우터 충분히, UPS/정전 대비  
- [ ] **발견**: mDNS/SSDP 프록시, 스마트티비/캐스트 장치 통제  
- [ ] **로그/모니터링**: 허브 이벤트, 방화벽, 실패 알림

---

## 15. 시험/실무 포인트 요약(암기 15줄)

1) **Matter** = IP 상호운용(주로 **Wi-Fi/Thread**), **Thread**는 **IPv6 메시 + 보더 라우터**.  
2) **Zigbee**/**Z-Wave** = 비-IP 메시, 허브/코디네이터 필요.  
3) 2.4 GHz 공존: **Wi-Fi 1/6/11** ↔ **Zigbee 채널 15/20/25** 등으로 분리.  
4) **VLAN/방화벽**으로 IoT를 **격리**, 허브/브로커만 예외.  
5) **mDNS/SSDP**는 브로드캐스트/멀티캐스트 → **리플렉터/프록시** 필요.  
6) **PoE**: 총 Budget − 합소비 ≥ **20% 여유**, 케이블 길이/규격 고려.  
7) 배터리 수명 = **용량/평균전류**, 평균전류는 **듀티/슬립**이 지배.  
8) **로컬 우선 자동화**: 일몰/존재/안전(누수/연기/잠금) → 인터넷 불가 시에도 작동.  
9) 도어락/열림센서 등 **Sub-GHz** 고려(벽 투과/전력/안정성).  
10) Wi-Fi IoT는 2.4 GHz **20 MHz**, 고정 채널·밴드 스티어링 주의.  
11) **Zigbee 메시**는 **상시전원 라우터 수**가 품질을 좌우.  
12) **업데이트/키 관리**는 보안의 절반. 디폴트 암호 제거.  
13) 카메라/스트리밍은 **CCTV VLAN + NVR 로컬**.  
14) 음성/벨/인터컴은 **로컬 라우팅**으로 지연 최소화.  
15) 장애 시: **스펙트럼 스캔 → 채널/전력 → 메시 라우터 추가 → 로그/패킷** 순.

---

## 16. 연습문제(풀이 포함)

**Q1.** 2.4 GHz에서 Wi-Fi CH1을 쓰는 환경. Zigbee 채널은 무엇을 우선 고려할까?  
**A.** **15/20/25** 인근(현장 스캔 후 결정)으로 **대역 분리**.

**Q2.** PoE 예산 120 W, AP×2(13 W), 카메라×6(9 W), 허브×1(6 W). 여유는?  
**A.** $13×2 + 9×6 + 6 = 26 + 54 + 6 = 86$ W, 여유 **34 W**(괜찮음).

**Q3.** IoT VLAN에서 허용해야 할 최소 아웃바운드 트래픽 2가지는?  
**A.** **NTP(UDP 123)**, **OTA 업데이트 호스트**(필요 시 벤더 도메인/443). (로컬 브로커/허브는 내부 예외)

**Q4.** 배터리 센서가 분당 10 ms 송신(15 mA), 슬립 3 µA, 1000 mAh 셀. 대략 수명?  
**A.** $I_\text{avg}\approx 0.0055$ mA → $1000/0.0055 ≈ 181,818$ h ≈ **20.8년** *(현실은 온도/부하로 감소; 5–7년 기대)*.

**Q5.** Thread의 “보더 라우터” 기능은 무엇인가?  
**A.** **802.15.4 메시 네트워크를 IPv6/IP 네트워크에 브릿징**하여, 노드가 **직접 IP 주소**로 접근 가능케 함.

**Q6.** mDNS가 VLAN 경계를 넘지 못해 캐스트 장치가 안 보인다. 해결 방법 2가지?  
**A.** **mDNS 리플렉터/프록시** 구성, 또는 허브가 **애플리케이션 프록시**로 디스커버리 중계.

---

## 17. 마무리

스마트홈은 **무선이 다르고, 보안 요구가 다르고, 전력 조건이 다른** 장치들의 **협주**입니다.  
핵심은 **표준 스택(Matter/Thread)**을 중심으로 **망 분리/보안/전력/간섭**을 관리하고,  
**로컬 우선 자동화**로 **안정성**을 확보하는 것. 위의 체크리스트와 예제를 **그대로 베이스라인**으로 삼아 시작하시면,  
작은 원룸부터 다층 주택까지 깔끔하고 튼튼한 시스템을 꾸릴 수 있습니다.
