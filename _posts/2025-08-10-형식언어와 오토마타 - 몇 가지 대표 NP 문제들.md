---
layout: post
title: 형식언어와 오토마타 - 몇 가지 대표 NP 문제들
date: 2025-08-10 23:20:23 +0900
category: 형식언어와 오토마타
---
# 몇 가지 대표 **NP 문제들**

## 0. 예열: NP·NP-완전 개관

### 0.1 정의와 직관
- **NP**: “**예(Yes)** 인스턴스는 다항시간에 **검증** 가능한 **증명서(증인)** 가 있는 결정 문제들의 집합”.
- **NP-완전**: (i) NP에 속하고, (ii) **모든 NP 문제**에서 다항시간 **many-one 변환**으로 귀속되는 문제.

$$
\text{SAT}\ \text{가 NP-완전 (Cook–Levin)} \Rightarrow
\forall X\in \text{NP}\ \exists f:\ X \le_m \text{SAT}.
$$

### 0.2 감수(감소)·근사·파라미터화의 세 관점
- **감소**: “A가 어려우면, **A를 B로 바꿔** B도 어렵다” (정확성/근사 유지형 **L-reduction, AP-reduction** 등도 활용).
- **근사(Approximation)**: 정확해결이 어려우면, **비율 보장**으로 우회(예: TSP 1.5-근사).
- **파라미터화(FPT)**: 입력의 작은 구조(파라미터 \(k\), 트리폭 tw 등)에 **지수**를 몰아넣고 전체는 **다항**으로.

---

## 1. SAT / 3-SAT

### 1.1 문제 정의
- **SAT**: 부울식 \(\phi\)가 **만족** 가능한가?
- **3-SAT**: 각 절(clause)이 **3 리터럴**로 제한된 SAT.

### 1.2 왜 어려운가(감소의 허브)
- **Cook–Levin**: 임의 NP 계산을 **CNF**로 암호화(시간×공간 격자 → **로컬 제약**으로).
- 3-SAT는 SAT에서 **표준 가젯**으로 줄인다(큰 절을 3개 절의 연결로 분해).

### 1.3 실무 알고리즘(정확)
- **DPLL/CDCL**: 단항 전파(UP), 갈라치기, **학습 절(learned clause)**, 재시작, VSIDS/LSIDS, SAT-inprocessing.

```text
# DPLL 스니펫
DPLL(φ):
  φ := UnitPropagate(φ);  if φ has empty clause: return UNSAT
  if all variables assigned: return SAT
  x := pick_variable()
  return DPLL(φ∧x) or DPLL(φ∧¬x)
```

- **2-SAT**는 강연결성으로 **선형시간**(Implication graph + SCC).
- **Horn-SAT**도 **선형시간**(전방 추론).

### 1.4 MAX-SAT / 변형
- **MAX-SAT**: 만족되는 절 최대화. 단순 랜덤(또는 LP/라운딩)으로 **1/2-근사**, 가중치/2-SAT 변형은 더 강한 보장.

---

## 2. CLIQUE · INDEPENDENT SET · VERTEX COVER

### 2.1 정의
- **CLIQUE(G,k)**: \(k\) 크기 이상의 완전 부분그래프가 있는가?
- **IND. SET(G,k)**: 서로 인접하지 않는 정점 \(k\)개가 있는가?
- **VERTEX COVER(G,k)**: 모든 간선을 덮는 정점 집합 크기 \(\le k\)가 있는가?

$$
S\subseteq V \text{ 독립} \iff V\setminus S \text{ 가 커버},\quad
\text{CLIQUE}(G,k)\iff \text{IND.SET}(\overline{G},k).
$$

### 2.2 왜 어려운가(감소 스케치)
- **3-SAT → CLIQUE**: 절마다 **k 레이어**를 만들고, 레이어 간 **모순(상보 리터럴) 금지** 간선만 유지.
- 동치로 **Independent-Set**, 보완으로 **Vertex-Cover** NP-완전 귀속.

### 2.3 근사/파라미터
- **Vertex-Cover 2-근사**(최대 매칭 기반 혹은 LP half-integrality).

```text
Approx-VC(G):
  M := any maximal matching
  C := {양 끝점 전부}
  return C   # |C| ≤ 2·OPT
```

- **VC의 FPT**: \(O(1.27^k + kn)\) 등(분기 규칙/크라운 감소/NT 분해), **2k 정점 커널**(Nemhauser–Trotter).
- **Clique/IndSet**: 일반 그래프에서는 **상수 근사 불가**, 파라미터화도 **W[1]-완전**.

- **특수 그래프**: 이분 그래프 VC는 **정확**(Kőnig: 최대 매칭 = 최소 커버), 트리폭/끈폭 작으면 DP로 FPT.

---

## 3. HAMILTONIAN PATH/CYCLE

### 3.1 정의
모든 정점을 **정확히 한 번** 지나는 경로/사이클 존재?

### 3.2 난이도
- **NP-완전**: 3-SAT에서 **가젯 그래프**(변수/절/선택 경로)로 감소.
- **충분조건**(필요X): Dirac(최소차수 \(\ge n/2\)), Ore(임의 비인접 \(u,v\)에 \(\deg u + \deg v \ge n\)).

### 3.3 알고리즘
- **DP on subsets**(TSP Held–Karp)로 **정확** 판정 가능하나 \(O(n^2 2^n)\).
- **파라미터**: 트리폭 tw가 작으면 **\(O(c^{\text{tw}}\cdot n)\)** DP.

---

## 4. TSP (결정판)

### 4.1 정의
완전 그래프와 거리 \(d\), 한 바퀴 순회 길이 \(\le B\)가 존재?

### 4.2 난이도/근사
- **NP-완전**(HAM-CYCLE에서 변형).
- **일반 TSP**: 삼각 부등식 없으면 **상수 근사 불가**.
- **Metric TSP**: **Christofides 1.5-근사**
  (MST → 홀수차 정점에 대해 최소 퍼펙트 매칭 → Euler화 → 쇼트컷).

### 4.3 정확 알고리즘: Held–Karp DP

```text
# V={1..n}, dist 대칭 metric
DP[ {1}, 1 ] := 0
for S ⊆ V with 1∈S, |S|≥2:
  for j ∈ S, j≠1:
    DP[S][j] := min_{i∈S\{j}} DP[S\{j}][i] + dist(i,j)
ans := min_{j≠1} DP[V][j] + dist(j,1)
# 시간 O(n^2 2^n), 공간 O(n 2^n)
```

- **Euclidean TSP**: **PTAS**(격자 분할/동적분할, Arora–Mitchell; 아이디어만 언급).

---

## 5. SUBSET-SUM · PARTITION · 0/1-KNAPSACK

### 5.1 정의/난이도
- **Subset-Sum**: 합이 정확히 \(T\)인 부분집합? (**NP-완전**)
- **Partition**: 합을 반으로 쪼개기? (**NP-완전**)
- **0/1-Knapsack(결정)**: 가치 \(\ge B\), 무게 \(\le W\)? (**NP-완전**)

### 5.2 의사다항식/근사
- **의사다항식 DP**: 수치 상한 \(U\)에 대해 \(O(nU)\).
- **FPTAS**: Knapsack(가치 스케일링), Subset-Sum/Partition(리스트-트림 + 스케일).

```text
# Subset-Sum (리스트-트림)
SubsetSum_FPTAS(A, T, ε):
  L := {0}
  for x in A:
    L := merge_sort(L ∪ {ℓ+x | ℓ∈L})
    L := trim(L, δ=ε/(2|A|))     # 연속 값 중 (1+δ) 비율 내 중복 삭제
    L := {ℓ∈L | ℓ ≤ T}
  return max L
```

- **Meet-in-the-Middle**: \(O(2^{n/2})\)로 Subset-Sum 정확.

---

## 6. GRAPH COLORING

### 6.1 정의·난이도
- **k-COLORING**: 인접 정점 다른 색으로 **k색칠** 가능한가?
  \(k\ge3\)는 **NP-완전**. **Chromatic Number**(최소 색 수)는 더 어렵다.

### 6.2 알고리즘/근사
- **2-COLORING**(이분 판정) **선형시간**(BFS/DFS).
- **근사**: 일반 그래프 최소 색수는 \(n^{1-\varepsilon}\) 이내 근사 **불가**(표준 가정).
- **FPT**: 파라미터 \(k\)로 \(O(k^n)\) 단순분기보다, **트리폭 tw** 작으면 색칠 DP.

```text
# 2-Coloring (BFS)
TwoColor(G):
  color[v]:=UNCOLORED
  for each v:
    if color[v]=UNCOLORED:
      color[v]:=RED; Q:=[v]
      while Q:
        u:=pop(Q)
        for w∈N(u):
          if color[w]=UNCOLORED: color[w]:=opp(color[u]); push w
          elif color[w]=color[u]: return NOT BIPARTITE
  return BIPARTITE
```

---

## 7. SET COVER · HITTING SET

### 7.1 정의·난이도
- **Set-Cover**: 우주 \(U\), 부분집합 \(\mathcal S\). 최소 개수로 \(U\)를 덮는 \(\mathcal C\subseteq\mathcal S\)?
- **Hitting-Set**: 모든 집합을 **때리는** 최소 원소 집합?

둘 다 **NP-완전**, 서로 **쌍대**.

### 7.2 근사
- **탐욕(가성비 최대)**로 \((1+\ln |U|)\)-근사.

```text
Greedy-SetCover(U, S):
  C := ∅
  while U ≠ ∅:
    pick T∈S maximizing |T∩U| / cost(T)   # 균일비용이면 |T∩U|만
    C := C ∪ {T}
    U := U \ T
  return C
```

- **하한**: \((1-o(1))\ln n\)보다 좋은 근사 **불가**(P≠NP 가정).
- **d-Set-Cover**(각 집합 크기 ≤ d): **d-근사** 가능.
- **파라미터**: 우주 크기/해 크기 \(k\) 기준 **커널/브랜칭** 다수(하지만 Hitting-Set(k)은 보통 **W[2]-완전**).

---

## 8. MAX-CUT (보너스: 고전 근사)

- **정의**: 간선 가중치 합이 최대가 되도록 **두 부분**으로 나누기.
- **근사**: **0.878…** (Goemans–Williamson, SDP + 무작위 하이퍼플레인 라운딩).
- **정확**: NP-완전, 플라나/트리폭 작은 경우 DP로 FPT.

---

## 9. FEEDBACK VERTEX SET (FVS)

- **정의**: 모든 사이클을 깨는 최소 정점 집합?
- **난이도**: NP-완전.
- **근사**: 다항 **상수 근사**(2-근사 알려짐).
- **FPT**: \(O(c^k \cdot n^{O(1)})\) 다수, 커널화(크라운, 감소 규칙).
  트리/포레스트에선 0, 유향 그래프에서는 변형(Feedback Arc/Vertex) 난이도 상승.

---

## 10. DOMINATING SET

- **정의**: 각 정점이 자기 혹은 이웃 중 하나에 의해 **지배**되도록 하는 최소 정점 집합?
- **난이도**: NP-완전, 일반 그래프 **\(\ln n\)** 근사 하한.
- **파라미터**: 일반 그래프 **W[2]-완전**(k-파라미터).
  **평면/소등급 그래프**에선 Baker 분할로 **PTAS**.

---

## 11. 전형 **감소 사슬** 요약

\[
\text{3-SAT} \;\Rightarrow\; \text{CLIQUE} \;\Leftrightarrow\; \text{IND.SET} \;\Rightarrow\; \text{VERTEX-COVER}
\]
\[
\text{3-SAT} \;\Rightarrow\; \text{HAM-PATH/CYCLE} \;\Rightarrow\; \text{TSP(decision)}
\]
\[
\text{3-SAT} \;\Rightarrow\; \text{COLORING (k\ge 3)}, \quad
\text{PCP} \Rightarrow \text{근사 불가능성(SET-COVER/CLIQUE/CHROMATIC 등)}
\]

**가젯 설계 팁**:
- **변수 가젯**: True/False **서로 배타**인 두 경로/구성.
- **절 가젯**: 최소 하나의 리터럴 선택 시 **통과 가능**.
- **일관성 가젯**: 변수 선택이 절 가젯에서 **상보**를 막도록 간선/가중치/용량을 배치.

---

## 12. 미니 실습 — 각 문제별 “손으로 돌려보기”

### 12.1 Vertex-Cover 2-근사 (작은 그래프)
```
G: V={1,2,3,4}, E={(1,2),(2,3),(3,4)}
Maximal matching M = {(1,2),(3,4)}
C = {1,2,3,4}  # 2·OPT 이하, 실제 OPT=2(정점 2,3)
```

### 12.2 Set-Cover 탐욕
```
U={1..6}
S1={1,2,3}, S2={2,4}, S3={3,5}, S4={4,5,6}, S5={6}
1) pick S1 (3개 커버) → 남은 {4,5,6,2 제외?} 실제 남은 {4,5,6}
2) pick S4 → 남은 ∅ → C={S1,S4}
```

### 12.3 Subset-Sum 리스트-트림
```
A=[3,7,12,19], T=22
L0={0}
x=3 → L={0,3}
x=7 → L={0,3,7,10} → trim≈{0,7,10} (비슷한 값 제거)
x=12→ L={0,7,10,12,19,22} → 22 발견 ⇒ YES
```

---

## 13. 파라미터화(한 장 요약)

| 문제 | 전형 파라미터 | 결과/아이디어 |
|---|---|---|
| Vertex-Cover | k | FPT, 커널(≤2k 정점), 분기/크라운/NT |
| Feedback Vertex Set | k | FPT, 다양한 감소/분기 |
| Dominating Set | k | **W[2]-완전** (일반), Planar에서는 PTAS |
| Clique/IndSet | k | **W[1]-완전** |
| SAT | #변수 m | \(O(2^m)\) 브루트포스; 구조적 파라미터(트리폭)로 FPT |
| TSP/Hamiltonian | tw | 트리폭 기반 DP로 FPT |
| Set-Cover | |U|, k | 커널/브랜칭, 하지만 HS(k) 보통 W[2] |

**트리폭 DP 패턴**: 가방(bag) 단위로 **부분해 상태**를 저장, 엣지/노드 introduce/forget에서 전이.

---

## 14. 근사(한 장 요약)

| 문제 | 알고리즘 | 보장 |
|---|---|---|
| Metric TSP | Christofides | 1.5 |
| Set-Cover | Greedy | \(1+\ln n\) |
| Vertex-Cover | Matching/LP | 2 |
| Max-Cut | SDP 라운딩 | 0.878… |
| Knapsack | FPTAS | \(1+\varepsilon\) |
| d-Set-Cover | Greedy | d |

**주의**: CLIQUE/Chromatic 등은 **강한 근사 불가능성**(PCP/UGC 맥락) — 상수 근사도 불가.

---

## 15. 감수(감소) 레시피 — 실전 체크리스트

1) **출발**: 3-SAT/SAT, CLIQUE, VC 같은 **표준 허브**를 선택
2) **가젯 설계**: 변수/절/일관성의 **로컬 제약**으로 “예↔예, 아니오↔아니오” 보장
3) **크기 보존**: 다항 시간/크기 유지, 경우에 따라 **gap-preserving**(근사 하한 목적)
4) **검산**: 한 방향(⇒) 충분, 역방향(⇐)도 세심히 — **가짜 해**가 생기지 않게 막기
5) **특수 제약**: 평면성/차수 제한/가중치 비율 등 **부가 조건**도 가젯에서 보존

---

## 16. 간단 의사코드 모음

### 16.1 CDCL(매우 요약)
```text
CDCL(φ):
  while True:
    s := BCP(φ)                 # unit propagation
    if conflict(s):
       if at decision level 0: return UNSAT
       clause := Analyze-Conflict()
       Backjump()
       Learn(clause); Continue
    if all assigned: return SAT
    Decide()
```

### 16.2 VC FPT(분기 스케치)
```text
VC(G,k):
  if |E|=0: return YES
  pick edge (u,v)
  return VC(G-{u}, k-1) or VC(G-{v}, k-1)   # 분기 2^k
```

### 16.3 Set-Cover LP 라운딩(균일 비용)
```text
LP:
  minimize ∑ x_S  s.t. ∑_{S∋e} x_S ≥ 1 (∀e), x_S ≥ 0
Rounding:
  pick S with x_S ≥ 1/β (β tuned by analysis), add to cover, remove covered elements, repeat
```

---

## 17. 자주 받는 질문(FAQ)

**Q. 2-SAT은 쉬운데 3-SAT은 왜 어려운가요?**
A. 2-SAT은 **함의 그래프**에서 모순이 **SCC**로 드러난다. 3-SAT은 그 구조가 깨져 **로컬→전역** 제약으로 증폭.

**Q. “P=NP?”랑 근사/파라미터랑 무슨 관계?**
A. P=NP면 다 정확히 다항시간. P≠NP면 **근사/파라미터**가 **유의미한 우회**. PCP는 근사 하한을, W-계층은 파라미터 난이도를 그려준다.

**Q. 실무에선 SAT가 잘 풀린다는데?**
A. **구조적 규칙성**(스파스/산업 구조)과 **공격적 프리프로세싱/학습** 덕분. 최악 사례는 여전히 지수.

---

## 18. 미니 연습 문제 (스스로 손으로 확인)

1) 3-SAT 인스턴스에서 **CLIQUE** 가젯을 구축하고, 클리크 크기 \(k\)를 명시하라.
2) 간단한 Metric TSP 6정점 예를 만들어 **Christofides** 절차를 손으로 수행하라.
3) 정점 8개 그래프를 만들고 **Vertex-Cover 2-근사**의 해와 **매칭 크기**를 비교하라.
4) **Set-Cover Greedy**의 선택 순서를 추적하고 \(\ln n\) 분석의 핵심 불평등(조화수)을 재현하라.

---

## 19. 결론

- **SAT/3-SAT**는 **NP-완전의 관문**.
- **그래프 중심 3대장**(CLIQUE/IndSet/VC), **순회/색칠**, **부분집합 최적화**(Knapsack/Subset-Sum/Set-Cover)가
  감수/근사/파라미터의 **교과서 사례**다.
- 정답주의만으론 막히는 벽을, **근사/의사다항식/FPT/특수구조**가 **실전 경로**로 만들어 준다.

---

### 부록 A. 심화 키워드 지도
- **감소**: Karp 21문제, L-reduction, AP-reduction, gap-introducing
- **근사**: LP/SDP 라운딩, 메트릭/삼각 부등식, 지역탐색, 구간/기하 PTAS
- **FPT**: 커널화(크라운, NT, 모듈성), 트리폭/패스폭 DP, 색지수/도수제한, 분기경계

### 부록 B. 기호 요약
- \(n=|V|\), \(m=|E|\), \(\Delta\)=최대차수, tw=트리폭
- OPT=최적값, APX비=근사비율, PTAS/FPTAS
