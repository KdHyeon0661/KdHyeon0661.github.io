---
layout: post
title: 정수론 - 수론 함수
date: 2025-09-09 20:25:23 +0900
category: 정수론
---
# 수론 함수 — 약수의 합·개수, 뫼비우스 역공식, 최대정수함수(바닥함수)와 달력 응용

> **작성 원칙**  
> - 예제는 **적게**, 그러나 **아주 자세히** 다룬다.  
> - 핵심 정리에는 **증명(또는 증명 스케치)** 를 포함한다.  
> - 모든 수식은 $$\ldots$$ 로 표기한다.  
> - 표기: $$\mathbb{Z}_{\ge 1}$$ 은 양의 정수, $$d\mid n$$ 은 “$$d$$ 가 $$n$$ 을 나눈다”를 뜻한다.

---

## 0. 준비: 곱셈적 함수와 디리클레 합성곱

### 0.1 곱셈적 함수와 완전곱셈적 함수
산술함수(정수에서 복소수로 가는 함수) $$f:\mathbb{Z}_{\ge1}\to\mathbb{C}$$ 가
$$
\gcd(m,n)=1\ \Rightarrow\ f(mn)=f(m)f(n)
$$
이면 **곱셈적(multiplicative)**, 모든 $$m,n$$ 에 대해 성립하면 **완전곱셈적(fully multiplicative)**라 한다.

### 0.2 디리클레 합성곱(Dirichlet convolution)
$$
(f*g)(n):=\sum_{d\mid n} f(d)\,g\!\left(\frac{n}{d}\right).
$$
항등원은 $$\varepsilon(n)$$ (단위함수: $$\varepsilon(1)=1,\ \varepsilon(n>1)=0$$). 상수함수 $$\mathbf{1}(n)\equiv 1$$, 항등함수 $$\mathrm{id}(n)=n$$ 을 자주 쓴다.

> **사실**: $$f,g$$ 가 곱셈적이면 $$f*g$$ 도 곱셈적.

---

## 1. 약수의 **개수** $$\tau(n)$$ 과 **합** $$\sigma(n)$$

### 1.1 정의와 소수멱 공식
- **약수의 개수 함수** $$\tau(n):=\sum_{d\mid n}1.$$
- **약수의 합 함수** $$\sigma(n):=\sum_{d\mid n} d.$$

$$n=\prod_{i=1}^{k} p_i^{\alpha_i}$$ (소수분해)라면
$$
\tau(n)=\prod_{i=1}^{k} (\alpha_i+1),\qquad
\sigma(n)=\prod_{i=1}^{k}\frac{p_i^{\alpha_i+1}-1}{p_i-1}.
$$

**증명.** (1) 각 소수 $$p_i$$ 에 대해 가능한 지수는 $$0,1,\dots,\alpha_i$$ 이고 서로 독립 → 곱의 원리로 $$\tau$$ 공식을 얻는다.  
(2) 약수의 합은 각 소수에 대해 $$1+p_i+\dots+p_i^{\alpha_i}=\frac{p_i^{\alpha_i+1}-1}{p_i-1}$$ 의 곱으로 분해된다. □

### 1.2 곱셈성과 합성곱 표현
$$
\tau=\mathbf{1}*\mathbf{1},\qquad \sigma=\mathrm{id}*\mathbf{1}.
$$
**증명.** 정의에서 바로 계산:
$$
(\mathbf{1}*\mathbf{1})(n)=\sum_{d\mid n}1=\tau(n),\quad
(\mathrm{id}*\mathbf{1})(n)=\sum_{d\mid n} d=\sigma(n). \ \Box
$$
따라서 $$\tau,\sigma$$ 는 **곱셈적**.

### 1.3 디리클레 급수(참고)
$$
\sum_{n\ge1}\frac{\tau(n)}{n^s}=\zeta(s)^2,\qquad
\sum_{n\ge1}\frac{\sigma(n)}{n^s}=\zeta(s)\zeta(s-1)\quad (\Re s>2).
$$
(합성곱과 $$\zeta(s)=\sum n^{-s}$$ 를 이용.)  

### 1.4 예제 1 (하나를 깊게) — $$n=3600$$
소인수분해: $$3600=2^4\cdot 3^2\cdot 5^2$$.  
$$
\tau(3600)=(4+1)(2+1)(2+1)=45.
$$
$$
\sigma(3600)=\frac{2^5-1}{1}\cdot\frac{3^3-1}{2}\cdot\frac{5^3-1}{4}
=31\cdot 13\cdot 31 = 12493.
$$
> **체크 포인트**: 결과는 **유일 소수분해** 덕에 모호하지 않다.

---

## 2. 뫼비우스 함수와 **뫼비우스 역공식**

### 2.1 뫼비우스 함수 $$\mu(n)$$
정의:
- $$\mu(1)=1$$.
- $$n$$ 에 제곱 인수가 있으면 $$\mu(n)=0$$.
- 그렇지 않으면, $$n$$ 의 서로 다른 소인수의 개수를 $$\omega(n)$$ 라 하여 $$\mu(n)=(-1)^{\omega(n)}$$.

**성질.** (i) $$\mu$$ 는 **곱셈적**. (ii) **기본 항등식**
$$
\mu * \mathbf{1}=\varepsilon
\quad\Longleftrightarrow\quad
\sum_{d\mid n}\mu(d)=\begin{cases}1,&n=1\\0,&n>1\end{cases}.
$$
**증명 스케치.** 소수멱 $$p^k$$ 에서 직접 확인(제곱이 개입하면 0), 곱셈성으로 일반화. □

### 2.2 뫼비우스 **역공식**(Dirichlet 역연산)
$$
F(n)=\sum_{d\mid n} f(d) \quad\Longleftrightarrow\quad
f(n)=\sum_{d\mid n} \mu(d)\,F\!\left(\frac{n}{d}\right).
$$
**증명.** $$F=f*\mathbf{1}$$ 이면 양변에 $$\mu$$ 를 합성곱:
$$
F*\mu=(f*\mathbf{1})*\mu=f*(\mathbf{1}*\mu)=f*(\varepsilon)=f.\ \Box
$$

### 2.3 표준 응용: **오일러의 $$\varphi$$ 함수 복원**
사실
$$
\sum_{d\mid n} \varphi(d)=n \quad(\star)
$$
가 잘 알려져 있다(서로소 잔여계의 크기를 주기성으로 합치면 된다).

**역공식으로** $$(\star)$$ 를 풀면
$$
\varphi(n)=\sum_{d\mid n}\mu(d)\,\frac{n}{d}
=n\sum_{d\mid n}\frac{\mu(d)}{d}.
$$
또는 소수분해로
$$
\varphi\!\left(\prod p_i^{\alpha_i}\right)=\prod p_i^{\alpha_i}\left(1-\frac1{p_i}\right).
$$

### 2.4 예제 2 (하나를 깊게) — $$\varphi(3600)$$
$$
3600=2^4\cdot 3^2\cdot 5^2 \Rightarrow
\varphi(3600)=3600\!\left(1-\frac12\right)\!\left(1-\frac13\right)\!\left(1-\frac15\right)
=3600\cdot \frac12\cdot\frac23\cdot\frac45=960.
$$
검산: $$\varphi$$ 는 곱셈적이라
$$
\varphi(2^4)=2^4-2^3=8,\quad \varphi(3^2)=9-3=6,\quad \varphi(5^2)=25-5=20,
$$
곱하면 $$8\cdot 6\cdot 20=960$$.

---

## 3. 최대정수함수(바닥함수) $$\lfloor x\rfloor$$ 와 **약수함수의 부분합**

### 3.1 정의와 기본 성질
$$
\lfloor x\rfloor := \max\{n\in\mathbb{Z}:\ n\le x\}.
$$
- 정수 분해: $$x=\lfloor x\rfloor+\{x\}$$ (단, $$\{x\}\in[0,1)$$).  
- **바닥-대칭 공식**: 정수가 아닌 $$x$$ 에 대해 $$\lfloor x\rfloor+\lfloor -x\rfloor=-1$$, 정수일 때는 $$0$$.  
- **단조성**: $$x\le y\Rightarrow \lfloor x\rfloor\le\lfloor y\rfloor$$.

### 3.2 하이퍼볼릭 분해: $$\sum_{n\le N}\tau(n)$$
핵심 정체성:
$$
\boxed{\ \sum_{n\le N}\tau(n)=\sum_{d\le N}\Big\lfloor\frac{N}{d}\Big\rfloor\ } \qquad (N\in\mathbb{Z}_{\ge1}).
$$

**증명.** 좌변은 **격자점 카운트**: $$\tau(n)=\#\{(a,b)\in\mathbb{Z}_{\ge1}^2:\ ab=n\}$$,  
따라서
$$
\sum_{n\le N}\tau(n)=\#\{(a,b)\in\mathbb{Z}_{\ge1}^2:\ ab\le N\}
=\sum_{a\le N}\#\{b\le N/a\}
=\sum_{a\le N}\Big\lfloor\frac{N}{a}\Big\rfloor.
$$
지표를 $$d=a$$ 로 바꾸면 된다. □

### 3.3 $$\sum_{n\le N}\sigma(n)$$ 의 바닥함수 표현
동일한 꼼수로
$$
\boxed{\ \sum_{n\le N}\sigma(n)=\sum_{d\le N} d\,\Big\lfloor\frac{N}{d}\Big\rfloor\ }.
$$
**증명.**
$$
\sum_{n\le N}\sigma(n)=\sum_{n\le N}\sum_{d\mid n} d
=\sum_{d\le N}\ \sum_{\substack{n\le N\\ d\mid n}} d
=\sum_{d\le N} d\cdot \#\{k\le N/d\}
=\sum_{d\le N} d\,\Big\lfloor\frac{N}{d}\Big\rfloor.
$$
□

### 3.4 예제 3 (하나를 깊게) — $$N=10$$ 에서의 합
- $$\sum_{n\le 10}\tau(n) = \sum_{d=1}^{10}\lfloor 10/d\rfloor
=10+5+3+2+2+1+1+1+1+1=27.$$
직접 세어도 동일(분해쌍 나열).  
- $$\sum_{n\le 10}\sigma(n) = \sum_{d=1}^{10} d\lfloor 10/d\rfloor
=1\cdot 10+2\cdot 5+3\cdot 3+4\cdot 2+5\cdot 2+6\cdot1+7\cdot1+8\cdot1+9\cdot1+10\cdot1
=10+10+9+8+10+6+7+8+9+10=87.$$

> **메시지**: 바닥함수는 **약수함수의 부분합**을 다룰 때 필수 도구다(하이퍼볼라 방법의 출발점).

---

## 4. 달력에의 응용 — 바닥함수·모듈러·가산공식

달력 연산은 “**총일수의 정수 나눗셈**”과 “**나머지(요일)**”로 정리된다. 바닥함수는 합성 카운팅을 깨끗하게 만들어 준다.

### 4.1 윤년(Leap year) 개수: $$\lfloor\cdot\rfloor$$ 로 표현
그레고리력 규칙(간단화):  
- **윤년**: 4의 배수이되, 세기년(100의 배수)은 제외, 단 400의 배수는 다시 윤년.

연도 $$1$$ 부터 $$Y$$ 까지의 **윤년 수**:
$$
L(Y)=\Big\lfloor\frac{Y}{4}\Big\rfloor-\Big\lfloor\frac{Y}{100}\Big\rfloor+\Big\lfloor\frac{Y}{400}\Big\rfloor.
$$
**증명.** 포함배제: 4의 배수 개수에서 100의 배수(세기년) 빼고 400의 배수(세기년 중 예외) 더한다. □

> 이로부터 임의 날짜까지의 **총일수**를 계산한 다음, $$\bmod 7$$ 로 요일을 얻는다.

### 4.2 Zeller–Gauss형 요일 공식(바닥함수 버전)
양력(그레고리력)에서 날짜 $$(Y,M,D)$$ (단, **1–2월은 이전 해의 13–14월로 간주**)에 대해
$$
h \equiv D + \Big\lfloor\frac{13(M+1)}{5}\Big\rfloor + K + \Big\lfloor\frac{K}{4}\Big\rfloor + \Big\lfloor\frac{J}{4}\Big\rfloor + 5J \pmod 7,
$$
여기서 $$Y=100J+K$$ (세기 $$J$$, 해의 하위 두 자리 $$K$$). 관례에 따라 $$h=0,1,\dots,6$$ 이 특정 요일(토–금 등)에 대응한다.

**증명 스케치.** 그레고리식 **연-월 보정**과 **윤년 보정**을 합친 총일수의 선형식에서 시작하여, 모듈러 7 동치류로 가감 정리 후 바닥함수 항으로 정리하면 위 형태가 된다(여러 교재 참조 가능). □

### 4.3 특정 요일의 **월별 출현 횟수**
임의의 달(길이 $$L$$일), 해당 달의 **1일의 요일 오프셋**을 $$s\in\{0,\dots,6\}$$ (예: 월요일이면 1 등)라 하자. **요일 $$w$$ 가 월 내 등장 횟수**는
$$
N_w=\left\lfloor \frac{L-(w-s\bmod 7)+6}{7}\right\rfloor.
$$
**증명.** $$d\equiv s\pmod 7$$ 인 날짜가 1일이고, 요일 $$w$$ 는 $$d\equiv w\pmod 7$$ 인 날짜들이다. 시작 간격을 고려하면 등차수열 길이의 정수 나눗셈 공식으로 귀결. □

### 4.4 예제 4 (하나만, 자세히) — **윤년 카운트와 요일**
- **윤년 수**: 1년부터 2400년까지의 윤년 수는
$$
L(2400)=\Big\lfloor\frac{2400}{4}\Big\rfloor-\Big\lfloor\frac{2400}{100}\Big\rfloor+\Big\lfloor\frac{2400}{400}\Big\rfloor
=600-24+6=582.
$$
- **한 달에서 특정 요일 횟수**: 길이 $$L=31$$, 1일이 수요일(예: $$s=3$$)인 달에서 금요일($$w=5$$)의 수는
$$
N_5=\left\lfloor \frac{31-(5-3)+6}{7}\right\rfloor=\left\lfloor \frac{31-2+6}{7}\right\rfloor=\left\lfloor \frac{35}{7}\right\rfloor=5.
$$
즉 **그 달에는 금요일이 5번** 있다.

---

## 5. 더 깊은 연결: 역공식·부분합·달력

- **역공식의 직관**: “누적합을 알면, **뫼비우스**로 원함수를 되살린다.”  
  예: $$F(n)=\sum_{d\mid n}f(d) \Rightarrow f=F*\mu$$.
- **바닥함수와 부분합**: $$\sum_{n\le N}\tau(n),\ \sum_{n\le N}\sigma(n)$$ 이 **정수 나눗셈**으로 바뀐다.  
- **달력**: 같은 원리—총일수의 정수 나눗셈과 나머지(요일), 윤년은 포함배제 → **바닥함수**로 표현.

---

## 6. 연습(풀이 스케치 포함, 소수 예제)

1) **곱셈성 확인**  
   $$\tau, \sigma$$ 가 곱셈적인 이유를 **합성곱** 관점에서 다시 서술하라.  
   *힌트*: $$\mathbf{1},\mathrm{id}$$ 와의 합성곱 표현.

2) **역공식으로 $$\varphi$$ 복원**  
   $$\sum_{d\mid n}\varphi(d)=n$$ 에 역공식 적용으로 $$\varphi$$ 를 유도하라.  
   *힌트*: $$\mu*\mathbf{1}=\varepsilon$$.

3) **부분합**  
   $$\sum_{n\le N}\tau(n)=\sum_{d\le N}\lfloor N/d\rfloor$$ 를 **격자점** 관점에서 설명하라.  
   *힌트*: $$ab\le N$$.

4) **달력**  
   $$Y$$ 년까지 윤년 수가 $$\lfloor Y/4\rfloor-\lfloor Y/100\rfloor+\lfloor Y/400\rfloor$$ 임을 포함배제로 증명하라.

---

## 7. 요약

- **약수의 개수/합**:  
  $$\tau(n)=\prod(\alpha_i+1),\qquad \sigma(n)=\prod\frac{p_i^{\alpha_i+1}-1}{p_i-1},$$  
  $$\tau=\mathbf{1}*\mathbf{1},\ \sigma=\mathrm{id}*\mathbf{1}.$$
- **뫼비우스와 역공식**: $$\mu*\mathbf{1}=\varepsilon,\quad f=\mu*F\ \ (F=\sum_{d\mid n} f(d)).$$  
  $$\varphi(n)=n\prod_{p\mid n}\!\left(1-\frac1p\right)=\sum_{d\mid n}\mu(d)\frac{n}{d}.$$
- **바닥함수와 부분합**:
  $$
  \sum_{n\le N}\tau(n)=\sum_{d\le N}\Big\lfloor\frac{N}{d}\Big\rfloor,\qquad
  \sum_{n\le N}\sigma(n)=\sum_{d\le N} d\,\Big\lfloor\frac{N}{d}\Big\rfloor.
  $$
- **달력 응용**:  
  $$L(Y)=\lfloor Y/4\rfloor-\lfloor Y/100\rfloor+\lfloor Y/400\rfloor,$$
  요일·횟수는 정수 나눗셈/나머지와 바닥함수로 정리.

> **메시지**: 뫼비우스 역공식은 “누적을 원천으로 되돌리는 스위치”, 바닥함수는 “정확한 카운팅의 자와 눈금”이다. 약수함수와 달력 문제는 이 두 도구의 정수를 보여준다.