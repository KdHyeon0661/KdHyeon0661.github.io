---
layout: post
title: Git - 저장소 생성 및 관리
date: 2025-01-16 20:20:23 +0900
category: Git
---
# GitHub 저장소 생성 및 관리

## 0. 빠른 개요(핵심 유지 + 안전수칙 추가)

- GitHub에서 **빈 저장소**를 만들고 로컬에서 `git init` → `remote add` → `commit` → `push` 하면 가장 단순합니다.
- GitHub에서 **README를 생성하지 않으면** 초보자 기준 **충돌 위험이 줄어듭니다**(로컬이 ‘정본’이 됨).
- 다만 **README를 생성해도 안전하게 시작하는 절차**가 있습니다. 즉, “절대 생성하지 마라”는 **상황에 따라 예외**가 있습니다(§3.2 참고).
- 협업을 염두에 두면, 시작 단계에서 **기본 브랜치명, 브랜치 보호, 2FA/SSH·PAT**까지 세팅하는 것이 좋습니다.

---

## 1. GitHub에서 저장소(Repository) 만들기 — 기본 절차(기존 내용 보강)

1) https://github.com 로그인  
2) 우측 상단 **+** → **New repository**  
3) 항목 입력  
   - **Repository name**: 예) `my-first-repo`  
   - **Description**: 선택  
   - **Public / Private**  
   - **Initialize this repository with**:  
     - 초보자/개인 단독 시작: **비워두기**(README/.gitignore/License 체크 해제)  
     - 협업·가이드 명확: README를 생성해도 되나, **로컬 절차(§3.2)**가 달라짐
4) **Create repository** 클릭

> 팁: 조직 저장소라면 **Default branch명을 `main`으로**, **Require 2FA**, **브랜치 보호 규칙**을 초기부터 고려합니다.

---

## 2. 로컬에서 Git 저장소 초기화 및 원격 연결 — 가장 단순한 성공 경로

### 2.1 폴더 준비
```bash
mkdir my-first-repo
cd my-first-repo
```

### 2.2 Git 초기화
```bash
git init
```

### 2.3 원격 추가(HTTPS 예)
```bash
git remote add origin https://github.com/username/my-first-repo.git
git remote -v
```

> SSH 사용 시  
> ```bash
> git remote add origin git@github.com:username/my-first-repo.git
> ```

---

## 3. 첫 커밋과 푸시 — 두 가지 시나리오

### 3.1 시나리오 A: GitHub에 **빈 저장소**(README 없음) → 로컬에서 최초 푸시
```bash
echo "# My First Repo" > README.md
git add .
git commit -m "Initial commit"
git branch -M main
git push -u origin main
```
- 가장 단순하며 충돌 가능성이 거의 없습니다.

### 3.2 시나리오 B: GitHub에서 **README를 생성**한 경우(초보자 주의 포인트)
- 원격에 **이미 커밋(README)** 이 있으므로, 로컬에서 바로 `push` 하면 **거부**됩니다.  
- 해결 절차(안전):
```bash
# 1. 로컬에 내용이 이미 있다면, 먼저 원격의 초기 커밋을 당겨옵니다.
git pull --rebase origin main  # 또는 git pull origin main 후 로컬 머지/충돌해결

# 2. 충돌이 없다면 계속
git push -u origin main
```
- 로컬이 비어있다면 **클론부터** 시작하는 것이 더 쉽습니다.
```bash
cd ..
git clone https://github.com/username/my-first-repo.git
cd my-first-repo
# 여기서 작업 후 add/commit/push
```

> 결론: **README를 만들어도 되지만** 그 경우 **클론으로 시작**하거나 **먼저 pull(rebase)** 로 동기화해야 한다는 점이 핵심입니다.

---

## 4. Pull(동기화) — 협업의 출발점

원격의 변경(README 수정 등)을 로컬로 가져오려면:
```bash
git pull origin main
```

리베이스 기반으로 깔끔한 이력을 유지하려면:
```bash
git pull --rebase origin main
```

> 팀 규칙에 따라 `merge` vs `rebase`를 결정합니다. 초보 팀은 **merge**가 안전, 숙련 팀은 **rebase**로 선형 이력 유지.

---

## 5. 전체 흐름(요약 스크립트) — 기존 제공 스니펫 보강

```bash
# 1. 프로젝트 폴더 생성
mkdir my-repo && cd my-repo

# 2. Git 초기화
git init

# 3. 파일 작성 및 커밋
echo "Hello GitHub" > hello.txt
git add .
git commit -m "첫 커밋"

# 4. 원격 저장소 연결(HTTPS 예)
git remote add origin https://github.com/username/my-repo.git

# 5. 브랜치명 설정 및 최초 푸시
git branch -M main
git push -u origin main

# 6. 원격 변경 가져오기
git pull --rebase origin main
```

---

## 6. 자주 발생하는 오류와 **원인별 해법**(확장 표)

| 오류 메시지 | 주요 원인 | 해결 |
|---|---|---|
| `fatal: remote origin already exists` | 이미 origin이 등록됨 | `git remote remove origin` 후 재등록 또는 `git remote set-url origin <url>` |
| `error: failed to push ... non-fast-forward` | 원격이 앞서감(README 등) | `git pull --rebase origin main` → 충돌 해결 → `git push` |
| `Permission denied (publickey)` | SSH 키 미설정/잘못된 키 | HTTPS로 전환 또는 `ssh-keygen` 후 GitHub에 공개키 등록 |
| `fatal: repository not found` | URL 오타, 권한 없음 | URL/권한 확인(조직 프라이빗이면 초대 필요) |
| `.gitignore가 무시 안 됨` | 이미 추적됨 | `git rm --cached <파일>` → 커밋 후 재추적 방지 |
| 줄바꿈(LF/CRLF) 경고 | OS간 개행 차이 | 팀 정책 수립, `.gitattributes`로 통제(§9.3) |
| `Updates were rejected because the remote contains work...` | 원격에 선행 커밋 존재 | `git pull --rebase origin main` 또는 `git fetch` 후 수동 merge/rebase |

---

## 7. 로컬에서 먼저 만들고 GitHub로 올리기 — “빈 원격” 기준 권장 절차

1) 로컬 프로젝트 생성  
2) `git init` → `add` → `commit`  
3) GitHub에서 **빈 저장소** 생성(README 생성하지 않음)  
4) `git remote add origin ...`  
5) `git branch -M main` → `git push -u origin main`

> 이 경로는 초보자에게 **충돌이 거의 없는 최단 루트**입니다.

---

## 8. 협업을 위한 브랜칭 — 최소 요령부터

### 8.1 작업 브랜치 생성과 PR
```bash
git checkout -b feature/login
# 코드 작성
git add .
git commit -m "feat(login): add OAuth flow"
git push -u origin feature/login
# GitHub에서 PR 생성 → 리뷰 → 머지
```

### 8.2 머지 전략 개요
- **Merge commit**: 이력 보존(간단), 잡음 증가 가능  
- **Squash merge**: PR을 1커밋으로 압축(이력 깔끔)  
- **Rebase merge**: 선형 이력, 충돌 해결 역량 필요

팀 표준이 중요합니다. 초보 팀은 **Squash** 또는 **Merge**로 시작 후 성숙도에 맞게 전환.

---

## 9. 필수 운영 파일과 초반 설정

### 9.1 `.gitignore`(예: Node/VSCode)
```
node_modules/
dist/
.env
.DS_Store
.vscode/
```
- 언어별 템플릿을 사용(“GitHub gitignore” 검색)하고, **이미 추적 중이면 `--cached`로 제거**해야 합니다.

### 9.2 `README.md`(최소 예시)
```markdown
# My Project
- 설치/실행
- 아키텍처 개요
- 브랜치/PR 규칙
```

### 9.3 `.gitattributes`로 개행/바이너리 정책
```
* text=auto
*.sh text eol=lf
*.bat text eol=crlf
*.png binary
```
- 플랫폼 간 개행 충돌을 줄이고, 바이너리 파일의 diff를 방지합니다.

---

## 10. 원격 URL, 인증, 브랜치 보호

### 10.1 원격 URL 변경
```bash
git remote set-url origin https://github.com/username/renamed-repo.git
```

### 10.2 인증 방식
- **HTTPS + PAT**: 범용, 프록시 환경 친화적  
- **SSH 키**: 개발자 선호, 무암호 자동화 용이  
- **2FA**: 조직 운영 시 사실상 필수

### 10.3 브랜치 보호(권장)
- `main`에 직접 푸시 금지, 리뷰 1+명, 상태 체크(Test/Lint) 통과 필수  
- Force push 금지, 특정 파일 보호(예: `protected` 디렉터리)

---

## 11. 변경 이력 관리 고급: 충돌, 리베이스, 체리픽

### 11.1 충돌 해결(리베이스 예)
```bash
git pull --rebase origin main
# 충돌 파일 수정 후
git add <file>
git rebase --continue
```

### 11.2 커밋 정리
```bash
git commit --amend
git rebase -i HEAD~5  # pick/squash/reword 등으로 정리
```

### 11.3 특정 커밋만 이식(체리픽)
```bash
git checkout hotfix/typo
git cherry-pick <commit-sha>
```

> 공유 브랜치 이력 변경은 엄격히 통제(팀 규칙).

---

## 12. Fork/Upstream 협업(오픈소스 기여 기본)

- 개인 저장소로 **Fork** → 수정 → 자신의 Fork에서 PR 생성  
- Upstream 동기화:
```bash
git remote add upstream https://github.com/original/repo.git
git fetch upstream
git checkout main
git merge upstream/main   # 또는 rebase
```

---

## 13. 기존 프로젝트 “가져오기”와 “미러”

### 13.1 기존 로컬 Git을 새 GitHub로 업로드
```bash
# 프로젝트 루트에 .git이 존재한다고 가정
git remote add origin https://github.com/username/new-home.git
git push -u origin --all
git push -u origin --tags
```

### 13.2 Mirror push(히스토리 포함 그대로 미러링)
```bash
git clone --mirror https://old.example.com/repo.git
cd repo.git
git push --mirror https://github.com/username/repo.git
```

---

## 14. Sparse/Partial Clone, 대용량 파일(LFS)

### 14.1 Sparse checkout(일부 경로만)
```bash
git sparse-checkout init --cone
git sparse-checkout set subdir1 subdir2
```

### 14.2 Git LFS
```bash
git lfs install
git lfs track "*.bin"
git add .gitattributes
git commit -m "chore: enable LFS"
```

---

## 15. 태그/릴리스 — 배포 기준선 만들기

### 15.1 태그
```bash
git tag -a v1.0.0 -m "Release 1.0.0"
git push origin v1.0.0
```

### 15.2 GitHub Release(웹 또는 CLI)
```bash
gh release create v1.0.0 --notes "주요 변경사항..."
```

---

## 16. GitHub CLI(gh) — 터미널에서 저장소 생성부터 PR까지

```bash
# 로그인
gh auth login

# 현재 디렉터리를 새 저장소로 만들어 푸시
gh repo create my-first-repo --public --source=. --push

# 이슈/PR
gh issue create --title "버그: 로그인 실패" --body "재현절차..."
gh pr create --fill --base main --head feature/login
gh pr view --web
```

---

## 17. 간단 CI 예제(GitHub Actions) — 푸시/PR 시 빌드·테스트

`.github/workflows/ci.yml`
```yaml
name: CI
on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '22'

      - name: Install
        run: npm ci

      - name: Lint
        run: npm run lint --if-present

      - name: Test
        run: npm test --if-present
```

> 브랜치 보호의 **Required status checks**로 `build-test` 성공을 요구하면, 품질이 보장됩니다.

---

## 18. 상황별 “정답 스크립트” 모음

### 18.1 “GitHub에서 README 만들지 않았다(빈 원격)” → 로컬에서 올리기
```bash
git init
echo "# Project" > README.md
git add .
git commit -m "init"
git branch -M main
git remote add origin https://github.com/username/project.git
git push -u origin main
```

### 18.2 “GitHub에서 README가 이미 있다” → 로컬이 뒤섞이지 않게 시작
```bash
# 방법 1: 클론으로 시작(가장 안전)
git clone https://github.com/username/project.git
cd project
# 작업 → add/commit/push

# 방법 2: 로컬이 이미 있다면 pull --rebase로 동기화
git remote add origin https://github.com/username/project.git
git fetch origin
git pull --rebase origin main
git push -u origin main
```

### 18.3 “origin URL을 SSH로 바꾸고 싶다”
```bash
git remote set-url origin git@github.com:username/project.git
```

### 18.4 “원격을 잘못 추가했다”
```bash
git remote remove origin
git remote add origin <정상 URL>
```

---

## 19. 협업 초기 체크리스트(팀 운영 관점)

1) 기본 브랜치 `main` 지정  
2) 브랜치 보호(리뷰 최소 1명, Required checks)  
3) PR/Issue 템플릿, CODEOWNERS  
4) `.gitignore`, `.gitattributes` 기본값 확정  
5) 2FA 의무화, 권한 최소화(Write 제한)  
6) Actions 러너 권한/시크릿 분리, 환경 승인(Prod)  
7) 릴리스 태깅 규칙(세만틱 버저닝)과 체인지로그

---

## 20. 고급 트러블슈팅(원인 추적 예시 포함)

### 20.1 “푸시가 거부된다(non-fast-forward)”
- 원격이 앞서가 있음(README, 다른 사람 커밋) → **pull(rebase)** → 충돌 해결 → 푸시

### 20.2 “내 .gitignore가 무시된다”
- 이미 추적 중 → `git rm --cached -r <경로>`로 인덱스에서 제거 후 커밋

### 20.3 “LF/CRLF 경고가 시끄럽다”
- Windows/Unix 혼합 환경 → `.gitattributes`로 명시(`*.sh eol=lf`, `*.bat eol=crlf`)  
- 팀 정책 문서화

### 20.4 “권한 오류”
- 프라이빗 저장소 권한 없음/조직 정책 → 저장소 Owner에게 권한 요청  
- SSO/SAML 활성 조직은 SSO 링크 통해 인증 필요

---

## 21. 예제 워크플로우(개인 프로젝트 템플릿)

```
repo/
├─ .github/
│  └─ workflows/
│     └─ ci.yml
├─ .gitignore
├─ .gitattributes
├─ README.md
└─ src/...
```

`README.md` 예:
```markdown
# My First Repo
## Getting Started
- Node 22 이상
- `npm ci`
- `npm test`
- `npm run build`
```

---

## 22. 권장 커밋 메시지 포맷(Conventional Commits)

```
feat(auth): add OAuth login
fix(api): handle null id gracefully
chore(deps): update axios to 1.7.0
docs(readme): add usage section
```

- 릴리스 노트 자동 생성, 변경 추적이 쉬워집니다.

---

## 23. 마무리 — 핵심 정리

- **빈 원격**으로 시작하면 가장 단순합니다.  
- **README를 원격에서 생성해도** 클론으로 시작하거나 `pull --rebase`를 먼저 수행하면 안전하게 정렬할 수 있습니다.  
- 협업 단계에서는 **브랜치 보호/리뷰/CI**를 조기에 도입해야 **속도와 품질**을 동시에 확보할 수 있습니다.  
- `.gitignore`/`.gitattributes`/PR·Issue 템플릿/CODEOWNERS는 **초기부터** 정해두는 것이 유지보수 비용을 확 줄입니다.

---

## 부록 A. 전체 명령 모음(요약)

```bash
# 새 저장소(빈 원격) 경로
git init
git add .
git commit -m "init"
git branch -M main
git remote add origin https://github.com/username/repo.git
git push -u origin main

# 원격에 README가 있을 때(이미 커밋 존재)
git remote add origin https://github.com/username/repo-with-readme.git
git fetch origin
git pull --rebase origin main
git push -u origin main

# 브랜치 작업
git checkout -b feature/x
git push -u origin feature/x

# 충돌 해결(리베이스)
git pull --rebase origin main
# 수정 후
git add <file>
git rebase --continue

# 원격 URL 교체(SSH)
git remote set-url origin git@github.com:username/repo.git

# 태그/릴리스
git tag -a v1.0.0 -m "v1.0.0"
git push origin v1.0.0
```

---

## 참고

- Git 브랜치 기본: `git checkout`, `git branch`, `git merge`  
- 협업 시 Pull Request: GitHub 웹에서 브랜치 비교 후 PR 생성  
- “README를 절대 만들지 마라”는 **초보자 충돌 회피 팁**일 뿐, **상황별 안전 절차**를 따르면 생성해도 무방합니다.  
- 원격 주소 변경: `git remote set-url origin [주소]`  
- 현재 상태 확인: `git status`  
- 공식 문서: GitHub Docs, Git 문서, 언어별 `.gitignore` 템플릿