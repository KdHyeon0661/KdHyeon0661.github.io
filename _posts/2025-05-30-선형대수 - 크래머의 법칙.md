---
layout: post
title: 선형대수 - 크래머의 법칙
date: 2025-05-30 21:20:23 +0900
category: 선형대수
---
# 크래머의 법칙(Cramer’s Rule)

**크래머의 법칙**은 **정방행렬** \(A\in\mathbb{F}^{n\times n}\) (실수/복소수 체)이고 \(\det(A)\neq 0\)일 때,  
선형 연립방정식
\[
A\vec{x}=\vec{b}
\]
의 해를 **행렬식(determinant)**으로 직접 주는 **폐형식(closed form)**이다.  
작은 차원(특히 \(2\times2, 3\times3\))에서 **분석/해석**에 유용하며, 해의 존재성·유일성 파악에도 쓸모가 크다.

---

## 1) 정의와 공식

- 조건: \(A\)가 정방이고 \(\det(A)\neq 0\) (즉, 가역).
- 각 미지수 \(x_i\)는
\[
x_i=\frac{\det(A_i)}{\det(A)}\quad (i=1,\dots,n)
\]
로 계산한다. 여기서 \(A_i\)는 \(A\)의 **\(i\)번째 열을** \(\vec{b}\)로 **치환**한 행렬.

> 직관: \(\det(A)\)가 “변환의 부피 스케일”이라면, \(\det(A_i)\)는 “\(i\)축에 대한 치환 효과”를 계량화한다.  
> 비율 \(\det(A_i)/\det(A)\)가 곧 \(x_i\).

---

## 2) 왜 맞는가? — 두 가지 유도

### 2.1 여인자/수반행렬(adjugate)로부터
가역 행렬은
\[
A^{-1}=\frac{\operatorname{adj}(A)}{\det(A)}
\]
를 만족(수반행렬 정리). 따라서
\[
\vec{x}=A^{-1}\vec{b}=\frac{\operatorname{adj}(A)\vec{b}}{\det(A)}.
\]
\(\operatorname{adj}(A)\)의 \(i\)번째 성분은 정확히 \(\det(A_i)\)와 일치하여 \(x_i=\det(A_i)/\det(A)\)를 얻는다.

### 2.2 행렬식 보조정리(Determinant Lemma)로부터
열 치환은 \(A_i=A+( \vec{b}-A\vec{e}_i)\vec{e}_i^{\top}\).  
행렬식 보조정리 \(\det(A+uv^{\top})=\det(A)\,(1+v^{\top}A^{-1}u)\)을 쓰면
\[
\det(A_i)=\det(A)\Big(1+\vec{e}_i^{\top}A^{-1}(\vec{b}-A\vec{e}_i)\Big)
=\det(A)\,\vec{e}_i^{\top}A^{-1}\vec{b}.
\]
따라서 \(x_i=\vec{e}_i^{\top}A^{-1}\vec{b}=\det(A_i)/\det(A)\).

---

## 3) 2×2, 3×3 빠른 예제

### 3.1 2×2 예제
\[
\begin{cases}
2x+3y=8\\
4x+y=7
\end{cases},\qquad
A=\begin{bmatrix}2&3\\4&1\end{bmatrix},\; \vec{b}=\begin{bmatrix}8\\7\end{bmatrix}.
\]
\[
\det(A)=2\cdot1-3\cdot4=-10.
\]
\[
A_1=\begin{bmatrix}8&3\\7&1\end{bmatrix}\Rightarrow \det(A_1)=8\cdot1-3\cdot7=-13\Rightarrow x=\frac{-13}{-10}=1.3.
\]
\[
A_2=\begin{bmatrix}2&8\\4&7\end{bmatrix}\Rightarrow \det(A_2)=2\cdot7-8\cdot4=-18\Rightarrow y=\frac{-18}{-10}=1.8.
\]

### 3.2 3×3 예제
\[
\begin{cases}
x+2y+z=9\\
2x- y+3z=1\\
3x+ y+2z=7
\end{cases}
\quad
A=\begin{bmatrix}1&2&1\\2&-1&3\\3&1&2\end{bmatrix},\quad
\vec{b}=\begin{bmatrix}9\\1\\7\end{bmatrix}.
\]
1) \(\det(A)\) (Sarrus/여인자로 계산)  
\[
\det(A)=
1\cdot((-1)\cdot2-3\cdot1)-2\cdot(2\cdot2-3\cdot3)+1\cdot(2\cdot1-(-1)\cdot3)
= -5-2\cdot(-5)+5= -5+10+5=\boxed{10}.
\]
2) \(A_1\) (1열 치환)
\[
A_1=\begin{bmatrix}9&2&1\\1&-1&3\\7&1&2\end{bmatrix}
\Rightarrow
\det(A_1)
=9((-1)\cdot2-3\cdot1)-2(1\cdot2-3\cdot7)+1(1\cdot1-(-1)\cdot7)
=9(-5)-2(2-21)+(1\cdot8)
=-45-2(-19)+8=\boxed{-45+38+8=1}.
\]
\(\Rightarrow x=\det(A_1)/\det(A)=1/10=0.1\)

3) \(A_2\) (2열 치환)
\[
A_2=\begin{bmatrix}1&9&1\\2&1&3\\3&7&2\end{bmatrix}
\Rightarrow
\det(A_2)=1(1\cdot2-3\cdot7)-9(2\cdot2-3\cdot3)+1(2\cdot7-1\cdot3)
= (2-21)-9(4-9)+(14-3)
= -19-9(-5)+11=\boxed{-19+45+11=37}.
\]
\(\Rightarrow y=37/10=3.7\)

4) \(A_3\) (3열 치환)
\[
A_3=\begin{bmatrix}1&2&9\\2&-1&1\\3&1&7\end{bmatrix}
\Rightarrow
\det(A_3)=1((-1)\cdot7-1\cdot1)-2(2\cdot7-1\cdot3)+9(2\cdot1-(-1)\cdot3)
=(-7-1)-2(14-3)+9(2+3)
=-8-2\cdot11+9\cdot5
=-8-22+45=\boxed{15}.
\]
\(\Rightarrow z=15/10=1.5\)

**정답:** \((x,y,z)=(0.1, 3.7, 1.5)\).

---

## 4) 기하학적 해석과 3D 벡터 공식(3×3)

열벡터 \(\vec{a},\vec{b},\vec{c}\)로 \(A=[\vec{a}\ \vec{b}\ \vec{c}]\), \(\vec{x}=(x,y,z)^T\), \(\vec{b}_{rhs}\)라 할 때
\[
A\vec{x}=\vec{b}_{rhs}\;\Leftrightarrow\; x\,\vec{a}+y\,\vec{b}+z\,\vec{c}=\vec{b}_{rhs}.
\]
가우스의 스칼라 3중곱을 쓰면
\[
\det(A)=\vec{a}\cdot(\vec{b}\times\vec{c}),
\]
\[
x=\frac{\det([\vec{b}_{rhs}\ \vec{b}\ \vec{c}])}{\det([\vec{a}\ \vec{b}\ \vec{c}])}
=\frac{\vec{b}_{rhs}\cdot(\vec{b}\times\vec{c})}{\vec{a}\cdot(\vec{b}\times\vec{c})},
\]
\[
y=\frac{\vec{a}\times\vec{c}\cdot \vec{b}_{rhs}}{\vec{a}\times\vec{c}\cdot \vec{b}},\quad
z=\frac{\vec{a}\times\vec{b}\cdot \vec{b}_{rhs}}{\vec{a}\times\vec{b}\cdot \vec{c}}.
\]
**물리/그래픽스**에서 좌표 분해·힘 분해에 매우 직관적.

---

## 5) “상황”으로 보는 크래머 활용

### 5.1 2D 직선 교점(표준형) — 對해석/기하
\[
\begin{cases}
a_1x+b_1y=c_1\\
a_2x+b_2y=c_2
\end{cases}
\Rightarrow
x=\dfrac{\det\begin{bmatrix}c_1&b_1\\c_2&b_2\end{bmatrix}}{\det\begin{bmatrix}a_1&b_1\\a_2&b_2\end{bmatrix}},
\quad
y=\dfrac{\det\begin{bmatrix}a_1&c_1\\a_2&c_2\end{bmatrix}}{\det\begin{bmatrix}a_1&b_1\\a_2&b_2\end{bmatrix}}.
\]
- 분모 0 → 평행/일치(해 없음/무한 해).  
- 간단한 도형 교점, 균형점(회로/정역학 소규모) 계산에 즉시 사용 가능.

### 5.2 2×2 회로/균형 예시
키르히호프 법칙으로 얻은
\[
\begin{cases}
R_1i_1+R_m(i_1-i_2)=V_1\\
R_m(i_2-i_1)+R_2i_2=V_2
\end{cases}
\]
을 \(A\vec{i}=\vec{V}\)로 쓰고 크래머로 해를 닫힌형으로 제시(설계 파라미터 상징식 얻기).

### 5.3 3D 역해석(작은 축소형)
소형 로봇 링크의 평형식 3개에서 토크 3개를 즉시 해석식으로 도출(상징 계산에 유리).

---

## 6) 계산 복잡도와 수치 안정성

| 방법 | 연산량(대략) | 수치 안정성 | 비고 |
|---|---:|---|---|
| 가우스 소거/LU | \(O(n^3)\) | ✔️ (부분피벗) | 표준 실무해법 |
| QR 분해 | \(O(n^3)\) | ✔️ | 최소제곱에 강함 |
| 역행렬 구해 곱 | \(O(n^3)\) | ❌(불필요한 역) | 비권장 |
| **크래머(순진)** | \((n+1)\)개 det → 전개 시 \(O(n!)\) | ❌ | 상징/소형에만 |
| **크래머(LU로 det)** | 각 det \(O(n^3)\) × \(n\)회 = \(O(n^4)\) | △ | \(\det(A_i)\)마다 재분해 필요 |

> **핵심:** 수치해석 실무에서는 **크래머로 숫자를 구하지 않는다**.  
> 해석/상징식 도출, 교육/검산, 2×2·3×3 **소형 문제**에서만 사용을 권장.

**수치 불안정** 이유:
- \(\det\)은 곱과 뺄셈이 섞여 **조건수(ill-conditioning)**에 민감.
- \(\det(A)\)가 매우 작을 때 \(\det(A_i)/\det(A)\)는 **소수점 오차 증폭**.

**실전 팁**
- 검산은 \(r=\|A\hat{x}-b\|\) 잔차로 확인.
- \(\det\)은 `slogdet`(부호+로그)로 다루면 규모 폭발에 조금 안전.
- 근접 특이일 땐 크래머 대신 **LU/QR**로 푸는 게 정석.

---

## 7) 파이썬 구현 — 심볼릭/수치/3D 특화

### 7.1 SymPy(정확/상징) — 일반 \(n\)에 대한 크래머
```python
from sympy import Matrix

def cramer_sympy(A, b):
    A = Matrix(A)
    b = Matrix(b)
    detA = A.det()
    if detA == 0:
        raise ValueError("det(A)=0 → 크래머 불가(해 없음/무한 해 가능)")
    xs = []
    for i in range(A.shape[1]):
        Ai = A.copy()
        Ai[:, i] = b
        xs.append(Ai.det() / detA)
    return Matrix(xs)

# 예시
A = Matrix([[2,3],[4,1]])
b = Matrix([8,7])
x = cramer_sympy(A,b)
print(x)  # Matrix([[13/10],[9/5]]) = (1.3, 1.8)
```

### 7.2 NumPy(수치) — 교육/검산용 간단 구현
```python
import numpy as np

def cramer_numeric(A, b):
    A = np.asarray(A, dtype=float)
    b = np.asarray(b, dtype=float).reshape(-1)
    n = A.shape[0]
    if A.shape[0]!=A.shape[1] or b.size!=n:
        raise ValueError("정방행렬/차원 불일치")
    detA = np.linalg.det(A)
    if abs(detA) < 1e-14:
        raise ValueError("det(A)≈0 → 크래머 불가(특이/근접특이)")
    x = np.empty(n, dtype=float)
    for i in range(n):
        Ai = A.copy()
        Ai[:, i] = b
        x[i] = np.linalg.det(Ai) / detA
    return x

# 검산
A = np.array([[1., 2., 1.],
              [2.,-1., 3.],
              [3., 1., 2.]])
b = np.array([9., 1., 7.])
x = cramer_numeric(A, b)
res = np.linalg.norm(A @ x - b)
print("x =", x, "  residual =", res)
```

> ⚠️ 경고: 근접 특이 시 결과 신뢰도 낮음. 실무 계산은 `scipy.linalg.solve`(LU/QR) 권장.

### 7.3 3×3 특화 — 벡터/외적 기반 닫힌형
```python
import numpy as np

def cramer_3x3_by_cross(a, b, c, rhs):
    """열벡터 a,b,c와 rhs (shape=(3,))를 받아 (x,y,z) 반환"""
    a = np.asarray(a, float).reshape(3)
    b = np.asarray(b, float).reshape(3)
    c = np.asarray(c, float).reshape(3)
    rhs = np.asarray(rhs, float).reshape(3)
    denom = np.dot(a, np.cross(b, c))
    if abs(denom) < 1e-14:
        raise ValueError("det(A)=0 → 해 없음/무한 해")
    x = np.dot(rhs, np.cross(b, c)) / denom
    y = np.dot(np.cross(c, a), rhs) / np.dot(np.cross(c, a), b)
    z = np.dot(np.cross(a, b), rhs) / np.dot(np.cross(a, b), c)
    return np.array([x, y, z])

# 예시: A=[a b c]
a = [1,2,3]; b = [2,-1,1]; c = [1,3,2]; rhs = [9,1,7]
print(cramer_3x3_by_cross(a,b,c,rhs))  # [0.1 3.7 1.5] 근사
```

### 7.4 2D 직선 교점 유틸
```python
def intersect_2lines(a1,b1,c1, a2,b2,c2, eps=1e-14):
    D  = a1*b2 - b1*a2
    Dx = c1*b2 - b1*c2
    Dy = a1*c2 - c1*a2
    if abs(D) < eps:
        return None  # 평행 또는 일치 → 해 없음/무한 해
    return (Dx/D, Dy/D)

print(intersect_2lines(1, -1, 0, 2, 1, 5))  # x - y = 0, 2x + y = 5 → (x,y)=(5/3, 5/3)
```

---

## 8) 싱귤러한/근접 특이 사례와 판정

- \(\det(A)=0\)이면 **크래머 불가**. 실제로는
  - **해 없음**: \(\operatorname{rank}([A|b]) > \operatorname{rank}(A)\).
  - **무한 해**: \(\operatorname{rank}([A|b]) = \operatorname{rank}(A) < n\).
- 실무 판정은 `numpy.linalg.matrix_rank`(또는 RREF)로.

작은 예:
\[
\begin{cases}
x+y=2\\
2x+2y=5
\end{cases}\Rightarrow
A=\begin{bmatrix}1&1\\2&2\end{bmatrix},\ \det(A)=0,\ [A|b]\text{ 랭크가 더 큼} \Rightarrow \text{해 없음}.
\]

---

## 9) 자주 묻는 질문(FAQ)

- **Q. 왜 실무에선 크래머를 안 쓰나요?**  
  A. \(\det\)은 수치적으로 불안정하고, \(n\)번의 det 계산은 비싸다. **LU/QR**가 더 빠르고 안정적.

- **Q. 상징식이 필요할 땐요?**  
  A. 크래머가 **상징적/해석적 표현**을 짧게 준다(특히 \(2\times2,3\times3\)). SymPy와 궁합 최고.

- **Q. 복소수/다항 계수도 가능한가요?**  
  A. 가능. 체만 바꾸면 동일하게 성립(복소수, 유리함수 등).

---

## 10) 요약

- **정의:** \(x_i=\det(A_i)/\det(A)\) (정방, \(\det(A)\neq0\)에서만).
- **장점:** 해석적·직관적, 소형 문제에 깔끔.
- **단점:** 고차원에서 느리고 불안정 → 수치 실무에는 **LU/QR** 권장.
- **활용:** 2D 교점, 3D 벡터 분해, 회로·정역학 소형 시스템, 상징식 유도.

> **실전 레시피:**  
> - 해석/블로그·교재 예제: **크래머**로 깔끔히 정리.  
> - 코드/프로덕션: **`solve`(LU/QR)**로 계산, 크래머는 검산/설명용.