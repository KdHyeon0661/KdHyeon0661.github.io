---
layout: post
title: 선형대수 - 그람-슈미트 직교화 과정
date: 2025-06-06 23:20:23 +0900
category: 선형대수
---
# 🧮 그람-슈미트 직교화 과정 (Gram-Schmidt Orthogonalization)

**그람-슈미트 정규 직교화 과정**은 주어진 벡터 집합을  
서로 **직교**하고 **정규화된(길이 1)** 형태의 집합으로 변환하는 방법입니다.

이를 통해 **정규 직교 기저(orthonormal basis)**를 만들 수 있습니다.  
주로 **QR 분해**, **직교 투영**, **최소제곱해** 계산 등에 사용됩니다.

---

## 📘 1. 문제 설정

어떤 벡터 공간 \( V \subseteq \mathbb{R}^n \)의 기저 벡터들이 있다고 하자:

\[
\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_k
\]

이 벡터들은 서로 **선형 독립**이지만, 반드시 직교하지는 않습니다.  
이를 정규 직교 기저 \( \vec{u}_1, \vec{u}_2, \ldots, \vec{u}_k \)로 변환하고자 합니다.

---

## 🧩 2. 핵심 아이디어

각 벡터에서 **이미 만들어진 기저 방향으로의 성분을 제거**하여  
수직인(직교인) 성분만 남기는 방식입니다.

---

## 🧾 3. 수식 정리

1. 첫 번째 벡터는 그냥 정규화:

\[
\vec{u}_1 = \frac{\vec{v}_1}{\|\vec{v}_1\|}
\]

2. 두 번째 벡터는 \( \vec{v}_2 \)에서 \( \vec{u}_1 \) 방향 성분 제거:

\[
\vec{u}_2' = \vec{v}_2 - \text{proj}_{\vec{u}_1}(\vec{v}_2) \\
\vec{u}_2 = \frac{\vec{u}_2'}{\|\vec{u}_2'\|}
\]

3. 세 번째 벡터는 \( \vec{v}_3 \)에서 \( \vec{u}_1, \vec{u}_2 \) 방향 모두 제거:

\[
\vec{u}_3' = \vec{v}_3 - \text{proj}_{\vec{u}_1}(\vec{v}_3) - \text{proj}_{\vec{u}_2}(\vec{v}_3) \\
\vec{u}_3 = \frac{\vec{u}_3'}{\|\vec{u}_3'\|}
\]

일반화하면:

\[
\vec{u}_k' = \vec{v}_k - \sum_{j=1}^{k-1} \text{proj}_{\vec{u}_j}(\vec{v}_k), \quad
\vec{u}_k = \frac{\vec{u}_k'}{\|\vec{u}_k'\|}
\]

여기서 \( \text{proj}_{\vec{u}}(\vec{v}) \)는 **정사영**:

\[
\text{proj}_{\vec{u}}(\vec{v}) = \frac{\vec{v} \cdot \vec{u}}{\|\vec{u}\|^2} \vec{u}
\]

---

## 🧑‍🏫 4. 예제

\[
\vec{v}_1 =
\begin{bmatrix}
1 \\ 1 \\ 0
\end{bmatrix}, \quad
\vec{v}_2 =
\begin{bmatrix}
1 \\ 0 \\ 1
\end{bmatrix}
\]

### 1단계: \( \vec{u}_1 = \frac{\vec{v}_1}{\|\vec{v}_1\|} \)

\[
\|\vec{v}_1\| = \sqrt{1^2 + 1^2 + 0^2} = \sqrt{2} \\
\vec{u}_1 = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ 1 \\ 0 \end{bmatrix}
\]

### 2단계: \( \vec{u}_2' = \vec{v}_2 - \text{proj}_{\vec{u}_1}(\vec{v}_2) \)

\[
\vec{v}_2 \cdot \vec{u}_1 = \frac{1}{\sqrt{2}}(1\cdot1 + 0\cdot1 + 1\cdot0) = \frac{1}{\sqrt{2}} \\
\text{proj}_{\vec{u}_1}(\vec{v}_2) = \frac{1}{\sqrt{2}} \cdot \vec{u}_1 = \frac{1}{2}
\begin{bmatrix}
1 \\ 1 \\ 0
\end{bmatrix}
\]

\[
\vec{u}_2' = \vec{v}_2 - \text{proj} = \begin{bmatrix} 1 \\ 0 \\ 1 \end{bmatrix}
-
\begin{bmatrix} 0.5 \\ 0.5 \\ 0 \end{bmatrix}
=
\begin{bmatrix} 0.5 \\ -0.5 \\ 1 \end{bmatrix}
\]

\[
\vec{u}_2 = \frac{\vec{u}_2'}{\|\vec{u}_2'\|} = \cdots
\]

---

## 🧮 5. 파이썬 구현 (NumPy)

```python
import numpy as np

def gram_schmidt(V):
    U = []
    for v in V:
        proj = sum(np.dot(v, u) * u for u in U)
        u = v - proj
        u = u / np.linalg.norm(u)
        U.append(u)
    return np.array(U)

# 예시
V = np.array([[1, 1, 0], [1, 0, 1]])
U = gram_schmidt(V)
print(U)
```

---

## 🧠 6. 활용

- **QR 분해**: \( A = QR \), 여기서 Q는 정규 직교 행렬, R은 상삼각 행렬
- **최소 제곱 근사**: \( \vec{b} \)를 열공간에 투영할 때
- **신호처리**: 잡음 제거, 주파수 분리
- **기저 변환**: 수치 계산을 안정화하기 위해

---

## ✅ 요약

| 항목 | 내용 |
|------|------|
| 목적 | 일반 기저 → 정규 직교 기저로 변환 |
| 수단 | 이전 벡터들의 방향 성분을 제거 |
| 결과 | 계산 효율성 증가, 직교 투영 가능 |
| 적용 | QR 분해, 최소 제곱법, PCA 등 |