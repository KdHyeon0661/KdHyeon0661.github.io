---
layout: post
title: 정수론 - 비선형 디오판토스 방정식
date: 2025-09-15 16:25:23 +0900
category: 정수론
---
# 비선형 디오판토스 방정식 — 피타고라스 방정식 \(x^2+y^2=z^2\) 과 페르마의 마지막 정리

> **작성 원칙**
> - 예제는 **적게** 두되 **아주 자세히** 전개한다.
> - 가능한 곳에 **증명**(또는 엄밀한 증명 스케치)을 포함한다.
> - 모든 수식은 $$\dots$$ 로 감싼 **MathJax** 표기.
> - 표기: \(\mathbb Z\) 는 정수, \(\gcd(a,b)\) 는 최대공약수, “원시(primitive)”는 세 수가 서로소(\(\gcd(x,y,z)=1\))임을 뜻한다.

---

## 1. 피타고라스 방정식 \(x^2+y^2=z^2\)

### 1.1 문제와 첫 예제
정수 해(특히 양의 정수 해) \((x,y,z)\) 를 모두 구하는 것이 목표다. 대표적 해:
- \((3,4,5):\ 3^2+4^2=5^2\)
- \((5,12,13):\ 5^2+12^2=13^2\)

이런 해들을 **피타고라스 수(Pythagorean triples)** 라 한다. 두 부류로 나뉜다.
- **원시 해(primitive)**: \(\gcd(x,y,z)=1\).
- **비원시 해(non-primitive)**: 어떤 정수 \(k>1\) 에 대해 \((x,y,z)=k(x',y',z')\).

핵심은 **원시 해의 완전한 분류**이며, 그러면 모든 해는 스칼라 배 확대로 얻어진다.

---

### 1.2 원시 해의 완전분류(유클리드 공식; Euclid’s formula)

#### 정리(필요충분)
양의 정수 \(m>n\) 에 대해
$$
x=m^2-n^2,\qquad y=2mn,\qquad z=m^2+n^2
$$
이면 \(x^2+y^2=z^2\) 이다.  
반대로, \((x,y,z)\) 가 **원시** 해이면 (둘 중 하나가 짝수, 다른 하나가 홀수이며) 어떤 \(m>n\) 에 대해 위 꼴로 **유일하게** 표현된다. 더 나아가
$$
\gcd(m,n)=1,\qquad m\not\equiv n\pmod 2\ (\text{서로 다른 홀짝})
$$
이 필요충분조건이다.

#### 증명(→: 구성의 타당성)
직접 계산:
$$
(m^2-n^2)^2+(2mn)^2
= m^4-2m^2n^2+n^4+4m^2n^2
= m^4+2m^2n^2+n^4=(m^2+n^2)^2.
$$
따라서 항상 해를 준다.

#### 증명(←: 역방향, 원시 해의 구조)
\((x,y,z)\) 가 원시해라 하자. 먼저 **짝수-홀수** 분석:
- \(x,y\) 둘 다 홀수이면 \(x^2\equiv y^2\equiv 1\ (\bmod 4)\Rightarrow z^2\equiv 2\ (\bmod 4)\) 모순.
- 둘 다 짝수이면 원시성에 모순.
따라서 \(x,y\) 중 하나만 짝수. 편의상 \(y\) 짝수로 두자.

이제
$$
x^2=z^2-y^2=(z-y)(z+y),\qquad \gcd(z-y,z+y)=\gcd(z-y,2y)=2
$$
이며 \(\gcd(x,y)=1\Rightarrow \gcd(z-y,z+y)=2\).  
따라서 어떤 양의 정수 \(u,v\) 에 대해
$$
z-y=2u,\qquad z+y=2v,\qquad \gcd(u,v)=1,\qquad x^2=4uv.
$$
여기서 \(uv\) 는 정사각수가 되어야 하므로(왜냐하면 \(4uv=x^2\) 완전제곱) 서로소인 \(u,v\) 는 각자 완전제곱이어야 한다. 즉 \(u=n^2,\ v=m^2\).  
이로부터
$$
z=\frac{(2u)+(2v)}{2}=m^2+n^2,\quad y=\frac{(2v)-(2u)}{2}=m^2-n^2\ \text{또는}\ 2mn
$$
인데 짝수인 것을 \(y\) 로 택하면 \(y=2mn\), 그리고 \(x=m^2-n^2\).  
남은 것은 \(\gcd(m,n)=1\) 및 \(m\not\equiv n\pmod 2\) 의 필요성이다. 만약 \(\gcd(m,n)>1\) 이면 \((x,y,z)\) 가 원시가 아님(모두 그 공약수의 배). 또 \(m\equiv n\ (\bmod 2)\) 이면 \(x=m^2-n^2\) 가 짝수, \(y=2mn\) 도 짝수여서 원시에 모순. 역으로 이 두 조건을 만족하면 \(\gcd(x,y,z)=1\) 임을 바로 확인할 수 있다. □

> **표준형**: 원시해는
> $$
> (x,y,z)=(m^2-n^2,\ 2mn,\ m^2+n^2),\quad m>n,\ \gcd(m,n)=1,\ m\not\equiv n\pmod 2.
> $$
> 모든 해는 \((X,Y,Z)=k(x,y,z)\) 의 꼴로 얻어진다.

---

### 1.3 예제와 체크리스트

- **예제 1**: \(m=2,n=1\Rightarrow (x,y,z)=(3,4,5)\).
- **예제 2**: \(m=3,n=2\Rightarrow (x,y,z)=(5,12,13)\).
- **예제 3**: \(m=4,n=1\Rightarrow (x,y,z)=(15,8,17)\) (순서를 바꾸면 \((8,15,17)\)).

각 예제에서 \(\gcd(m,n)=1,\ m\not\equiv n\pmod 2\) 를 체크하면 원시임을 즉시 알 수 있다.

---

### 1.4 기하학적/대수적 파라미터화: 단위원과 기울기

\(x^2+y^2=z^2\) 을 \(z\ne 0\) 로 나눠 \((X,Y)=(x/z,y/z)\) 라 놓으면
$$
X^2+Y^2=1
$$
으로 **단위원** 위의 유리점 문제가 된다. \((-1,0)\) 을 통과하고 기울기 \(t\in\mathbb Q\) 를 갖는 직선
$$
Y=t(X+1)
$$
과 원의 교점은 \((X,Y)=\left(\frac{1-t^2}{1+t^2},\,\frac{2t}{1+t^2}\right)\).  
따라서 유리 \(t=\frac{n}{m}\) 를 넣으면
$$
(X,Y)=\Big(\frac{m^2-n^2}{m^2+n^2},\ \frac{2mn}{m^2+n^2}\Big),
$$
곧 \((x,y,z)=(m^2-n^2,2mn,m^2+n^2)\) 의 정수해가 된다(분모를 공통분모로 지우면 정수). 이는 §1.2의 유클리드 공식과 정확히 일치한다.

---

### 1.5 가우스 정수 \(\mathbb Z[i]\) 와 “두 제곱의 합”

**정리(두 제곱의 합)**  
정수 \(N>0\) 가 두 제곱의 합 \(N=x^2+y^2\) 로 표현될 필요충분조건은, \(N\) 의 소인수분해에서 **모든** \(p\equiv 3\ (\bmod 4)\) 소수의 지수가 **짝수**인 것이다.

**스케치**: 가우스 정수환 \(\mathbb Z[i]\) 가 **유일분해정역(UFD)** 임을 이용한다.  
\(x^2+y^2=N\) 은 \((x+iy)(x-iy)=N\) 의 분해이다. \(p\equiv 3\pmod 4\) 인 소수는 \(\mathbb Z[i]\) 에서도 **소수**로 남으므로(분해되지 않음) 양변에 짝수 번 등장해야 좌변처럼 켤레쌍 곱으로 나타날 수 있다.

**귀결(빗변의 성질)**  
원시 피타고라스 해의 빗변 \(z\) 는 **오직** \(1\pmod 4\) 인 소수들의 곱이다.  
왜냐하면 \(z=m^2+n^2\) 이므로 \(z\) 의 소인수 중 \(3\pmod 4\) 인 소수는 짝수 지수로만 등장해야 하고, \(z\) 가 **원시 빗변**(자명 배수 없음)이 되려면 그런 소수들이 아예 나타나지 않아야 한다. 실제로 \(z\) 가 원시 빗변이 되기 위한 필요충분조건은 “\(z\) 의 모든 소인수가 \(1\pmod 4\)” 임을 보일 수 있다.

---

### 1.6 “한 변이 주어졌을 때”의 특징

- **빗변 \(z\) 가 주어졌을 때**: \(z\) 가 \(1\pmod 4\) 소수들의 곱(각각 1제곱)일 때에만 **원시** 빗변이 된다. 그때 \((x,y)\) 는 (순서까지 합치면) 여러 가지가 나올 수 있는데, \(\mathbb Z[i]\) 에서의 분해 갯수와 관련된다.

- **수직변 \(x\) 가 주어졌을 때**: 원시 조건 \(\gcd(x,y)=1\) 과 함께 \(x\) 의 소인수 중 \(3\pmod 4\) 꼴이 있으면 **반드시** 홀수 지수로 들어가야 \(x^2+y^2=z^2\) 이 가능하다(§1.5의 보조정리 응용). 예컨대 \(x\) 가 \(2\) 의 거듭제곱이나 \(1\pmod 4\) 소수들의 곱이면 원시 가능성이 높다.

---

### 1.7 해의 계수/분포(한 줄 메모)
빗변 \(z\le N\) 인 원시 피타고라스 삼단수의 개수는 \(N\) 에 선형적으로 비례한다는 사실이 알려져 있다(정밀 상수는 고급 해석수론 범위). 본 문서에서는 정성적 메시지만 남긴다: **“많이” 존재한다**.

---

## 2. 페르마의 마지막 정리(FLT)

### 2.1 진술과 역사
**정리(FLT)**  
정수 지수 \(n>2\) 에 대해
$$
x^n+y^n=z^n
$$
을 만족하는 **서로 0이 아닌 정수** \(x,y,z\) 는 존재하지 **않는다**.

- \(n=2\) 는 바로 앞의 피타고라스 방정식으로 **많은 해**가 있다.
- \(n=3,4,5\) 등의 개별 지수는 18–19세기 수학자들이 점차 해결(예: \(n=4\) 는 페르마의 **무한강하법**, \(n=3\) 은 오일러 등).
- **최종 해결(1994)**: 앤드루 와일스(Andrew Wiles)가 리처드 테일러와 함께 보강하여 증명. 핵심은 **타니야마–시무라–바일(모듈러성) 추측**의 “준안정(semistable) 타원곡선에 대한 경우”를 증명하고, **리베(케네스 리베)의 정리**와 합쳐 FLT를 귀결.

> 요지: **수론의 중심축 이동** — 디오판토스 방정식을 타원곡선·모듈러 형식의 세계로 옮겨 **간접적으로** 해결했다.

---

### 2.2 \(n=4\) 의 고전 증명(페르마의 “무한강하”)

**목표**: \(x^4+y^4=z^2\) 에 정수해(서로 0이 아닌) 없음 ⇒ \(x^4+y^4=z^4\) 의 부재도 귀결(왜냐하면 \(z^4=(z^2)^2\)).

**개요**
1) \(x^4+y^4=z^2\) 의 해 중 최소의 \(z>0\) 가 있다고 가정(자연수 순서로 **최소 반례**).
2) 이를 적절한 대수적 조작으로 **더 작은** \(z'\) 를 가진 또 다른 해로부터 유도 ⇒ 모순(무한히 내려가기).  
   핵심 아이디어: \(x^4+y^4=z^2\) 를 \((x^2)^2+(y^2)^2=z^2\) 로 보고 **피타고라스 삼단수** 이론을 적용한 다음, 원시성/짝홀성 분석으로 **더 작은** 해를 구성.

이 논증은 실제로 엄밀히 채워 넣으면 수 페이지 분량이지만, 메시지는 분명하다: \(n=4\) 는 고전 기법으로 **완료**되며, 이후 \(n\) 이 짝수면 \(4\mid n\) 로 내려 FLT를 그 지수에 대해 귀결시킨다.

---

### 2.3 “Frey 곡선 \(\to\) 리베 정리 \(\to\) 모듈러성 \(\to\) 모순”: 현대적 스케치

**가정**: \(n>2\) 에 대해 \(x^n+y^n=z^n\) 의 비자명 정수해 존재.

1) **Frey 곡선(가설적 타원곡선)**  
   그 해로부터 특수 타원곡선
   $$
   E:\ y^2=x(x-a^n)(x+b^n)
   $$
   (모양은 표기마다 약간 다름; 여기선 \(a=x,\ b=y\))을 만든다. 이 곡선은 도리어 “이상한(good) 축약성”과 모듈러성에 반하는 성질을 갖는다(직관).

2) **리베의 정리(ε-정리; 1986)**  
   Frey 곡선이 **모듈러** 라면(Hecke 고유형과 대응) 곧바로 모순이 터짐을 보였다. 따라서 그 곡선은 **모듈러가 될 수 없다**.

3) **와일스(1994) + 테일러–와일스 보강**  
   **모든 준안정 타원곡선은 모듈러** 임을 증명. Frey 곡선도 준안정에 속한다 ⇒ **모듈러여야만** 한다.

4) **모순**  
   2)와 3)가 동시에 참일 수는 없음 ⇒ 최초 가정(FLT의 반례 존재)이 거짓.

이로써 모든 \(n>2\) 에 대해 FLT가 성립한다.  
**중요**: 위 사슬의 각 단계는 매우 깊은 현대 수론(갈루아 표현, 변형 이론, 모듈러 형식 이론 등)에 선다. 여기서는 **구조와 흐름**만 잡아두자.

---

### 2.4 소수 지수별 고전적 접근(참고용 요약)

- **\(n=3\)**: 오일러의 아이디어(무한강하), 복소정수환 \(\mathbb Z[\omega]\) (\(\omega\) 는 3제곱근)에서의 인수분해 성질을 활용.  
- **\(n=5\)**: 라그랑주, 르장드르, 쿰머(정규 소수·아이디얼 수론의 시초).  
- **\(n=p\) 큰 소수**: 쿰머가 **정규 소수**에 대해 대수적 수론으로 증명 진전(클래스 수, “유니트” 등). 이 축적이 20세기 말 **모듈러성** 관점의 완전 해결의 초석이 된다.

---

### 2.5 **모듈러 산술**로 보는 지역적(합동론적) 제약들(맛보기)

FLT 식 \(x^n+y^n=z^n\) 은 작은 법에 대해 많은 불가능 조건을 준다(“지역적(local) 조건)”:
- **짝홀성**: \(n>2\) 홀수면 \(x,y\) 둘 다 홀수라고 가정해 보면 \(\bmod 4\) 에서 모순이 잦다.
- **\(\bmod 3,9\)**: 세제곱 잔여가 0, \(\pm 1\) 등으로 제한 → 경우의 수를 크게 줄인다.
- **\(\bmod 8\)**: 거듭제곱의 잔여 패턴(특히 짝수 지수)로 인한 강한 제약.

물론 이런 **국소 조건**만으로 FLT 전체를 증명하긴 턱없이 부족하지만, 반례 탐색을 “거의 불가능”하게 만드는 강력한 필터로 작동한다.

---

## 3. 두 방정식의 연결과 대비

- **\(n=2\)**: 방정식은 **원에 대한 유리점** 문제로 떨어져 완전 분류(유클리드 공식). 가우스 정수의 UFD 성질이 핵심 도구.
- **\(n>2\)**: 방정식은 타원곡선/모듈러 형식으로 옮겨가 **‘형태가 같은 해’ 자체가 부정**된다.  
  → **“많은 해”** vs **“해가 없음”** 이라는 극명한 대비.  
  → 공통분모는 모두 **정수론적 구조(환의 분해 성질, 군 구조, 모듈러성)** 를 본다는 점.

---

## 4. 실전 예제(적게, 그러나 끝까지)

### 4.1 주어진 빗변으로 해 찾기 — \(z=65\)
\(65=5\cdot 13\). 둘 다 \(1\pmod 4\) 소수 → **원시 빗변 후보**. 유클리드 공식의 역을 써 보자.
- \(m^2+n^2=65\) 를 만족하는 \((m,n)\) 정수를 찾는다.
  - \(1^2+8^2=65\Rightarrow (m,n)=(8,1)\) (서로소, 홀짝 다름)
  - \(4^2+7^2=65\Rightarrow (m,n)=(7,4)\) (서로소, 홀짝 다름)
따라서 두 개의 원시 삼단수:
$$
(8,1)\Rightarrow (x,y)=(8^2-1^2,\,2\cdot 8\cdot 1)=(63,16),\\
(7,4)\Rightarrow (x,y)=(49-16,\,56)=(33,56).
$$
검산: \(63^2+16^2=65^2,\ 33^2+56^2=65^2\).

> **메시지**: 하나의 빗변에도(특히 소인수 구조에 따라) 여러 원시 표현이 존재할 수 있다.

---

### 4.2 FLT의 합동론적 제약 맛보기 — \(n=3\)

가정: \(x^3+y^3=z^3\) (서로 0이 아니고 \(\gcd=1\)). \(\bmod 9\) 에서 **세제곱 잔여**는 \(0,\pm1\) 뿐이다.  
가능한 조합을 일일이 점검하면(작은 표) 왼쪽 합이 \(0,\pm 1,\pm 2\) 중 하나인데, \(z^3\equiv 0,\pm 1\) 과 맞추기 어려운 경우가 대부분이다. 이런 모듈러 필터는 \(x,y,z\) 의 짝홀성·배수성(3의 배수 등)을 강제한다. 실제 완전한 증명은 \(\mathbb Z[\omega]\) 의 인수분해 성질(유일분해/클래스수)을 쓴다.

---

## 5. 정리(요약 카드)

### 피타고라스 방정식 \(x^2+y^2=z^2\)
- **원시 해의 완전 분류(유클리드 공식)**:
  $$
  (x,y,z)=(m^2-n^2,\,2mn,\,m^2+n^2),\quad m>n,\ \gcd(m,n)=1,\ m\not\equiv n\ (\bmod 2).
  $$
- **두 제곱의 합 정리**: \(N=x^2+y^2\) \(\Leftrightarrow\) \(N\) 의 소인수분해에서 \(p\equiv 3\pmod 4\) 의 지수는 모두 짝수.
- **원시 빗변**: \(z\) 의 모든 소인수가 \(1\pmod 4\).

### 페르마의 마지막 정리 \(x^n+y^n=z^n,\ n>2\)
- **고전 부분 결과**: \(n=4\) (무한강하), \(n=3,5\) (19세기).
- **현대적 완전해결(와일스)**:  
  Frey 곡선 → **리베 정리**(비모듈러성) ↔ **모듈러성 정리(준안정 타원곡선은 모듈러)** → **모순**.  
  결과: **비자명 정수해 없음**.
- **메시지**: \(n=2\) 는 “군/환의 좋은 분해 성질(UFD)” 덕에 해가 풍부, \(n>2\) 는 “모듈러성”이라는 전혀 다른 원리로 **해 부재**.

---

## 6. 연습 문제(힌트 동봉)

1) **유클리드 공식의 역 방향을 \(\mathbb Z[i]\) 로 증명**  
   힌트: \(x^2+y^2=z^2\Rightarrow (x+iy)(x-iy)=z^2\). \(\mathbb Z[i]\) UFD ⇒ 각 요인의 소인수 분포는 켤레쌍. 원시성으로부터 \(x+iy=(m+in)^2\) 꼴을 도출.

2) **한 변 고정**  
   (a) \(x=20\) 일 때 \(x^2+y^2=z^2\) 의 정수해를 모두 찾아라.  
   힌트: \((20/z)^2+(y/z)^2=1\) 의 유리점. 또는 유클리드 공식에서 \(2mn=20\) 또는 \(m^2-n^2=20\) 을 풀어라.  
   (b) 원시 해가 되는 경우를 따로 분류.

3) **FLT의 \(n=4\) 증명 채우기**  
   힌트: 최소 반례 \((x,y,z)\) 로부터 피타고라스 분해를 거쳐 더 작은 \(z'\) 를 갖는 반례를 구성.

4) **합동론 필터 만들기**  
   \(x^5+y^5=z^5\) 를 \(\bmod 11\) 에서 검사하여 가능한 잔여 조합을 좁혀라.

---

### 마무리 한 줄
> \(x^2+y^2=z^2\) 는 **정수해의 풍요**를, \(x^n+y^n=z^n\ (n>2)\) 는 **정수해의 부재**를 보여 준다. 전자는 **UFD/군/기하 파라미터화**로, 후자는 **타원곡선·모듈러성**으로 드라마틱하게 풀린다.