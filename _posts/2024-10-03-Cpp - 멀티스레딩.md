---
layout: post
title: C++ - ë©€í‹°ìŠ¤ë ˆë”©
date: 2024-10-03 19:20:23 +0900
category: Cpp
---
# ë©€í‹°ìŠ¤ë ˆë”©ê³¼ ë™ê¸°í™” ê¸°ì´ˆ ì •ë¦¬

ë©€í‹°ìŠ¤ë ˆë”©ì€ í•˜ë‚˜ì˜ í”„ë¡œê·¸ë¨ì—ì„œ ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê¸°ìˆ ë¡œ, í”„ë¡œê·¸ë¨ì˜ ì„±ëŠ¥ì„ ë†’ì´ê³  ì‘ë‹µì„±ì„ ê°œì„ í•˜ëŠ” ë° ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ê°™ì€ ìì›ì— ì ‘ê·¼í•  ë•ŒëŠ” ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ 'ë™ê¸°í™”'ê°€ í•„ìš”í•©ë‹ˆë‹¤.

---

## `std::thread`: ìŠ¤ë ˆë“œ ìƒì„±

```cpp
#include <thread>

void task() {
    std::cout << "ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ ì¤‘\n";
}

int main() {
    std::thread t(task);  // ìƒˆ ìŠ¤ë ˆë“œ ì‹¤í–‰
    t.join();             // ë©”ì¸ ìŠ¤ë ˆë“œê°€ ê¸°ë‹¤ë¦¼
}
```

### ğŸ”¹ ì£¼ìš” í•¨ìˆ˜

| ë©”ì„œë“œ      | ì„¤ëª…                            |
|-------------|---------------------------------|
| `join()`    | ìŠ¤ë ˆë“œ ì¢…ë£Œê¹Œì§€ ê¸°ë‹¤ë¦¼          |
| `detach()`  | ë…ë¦½ ì‹¤í–‰ (ì¢…ë£Œ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ)  |
| `joinable()`| ìŠ¤ë ˆë“œê°€ `join` ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ |

---

## `std::mutex`: ìƒí˜¸ ë°°ì œ (Mutual Exclusion)

ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ **ê³µìœ  ìì› ë³´í˜¸**ì— ì‚¬ìš©

```cpp
#include <mutex>

std::mutex mtx;
int counter = 0;

void safe_increment() {
    mtx.lock();
    ++counter;
    mtx.unlock();
}
```

### ë” ì•ˆì „í•œ ë°©ë²•: `std::lock_guard`

```cpp
void safe_increment() {
    std::lock_guard<std::mutex> lock(mtx);
    ++counter;
    // lock í•´ì œëŠ” ìë™ìœ¼ë¡œ ìˆ˜í–‰ë¨
}
```

---

## `std::unique_lock`: ìœ ì—°í•œ ë½ ê´€ë¦¬

```cpp
std::unique_lock<std::mutex> lock(mtx);
lock.unlock();   // ì¤‘ê°„ì— ë½ í•´ì œ ê°€ëŠ¥
lock.lock();     // ë‹¤ì‹œ ë½
```

> lockì„ ë‚˜ì¤‘ì— ê±¸ê±°ë‚˜, í•´ì œí–ˆë‹¤ê°€ ë‹¤ì‹œ ê±¸ê³  ì‹¶ì„ ë•Œ `unique_lock`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

---

## `std::async`ì™€ `std::future`: ë¹„ë™ê¸° ì‹¤í–‰

```cpp
#include <future>

int compute() {
    return 42;
}

int main() {
    std::future<int> f = std::async(compute);
    std::cout << "ê³„ì‚° ê²°ê³¼: " << f.get();  // ê²°ê³¼ ëŒ€ê¸°
}
```

- `std::async`ì€ **í•¨ìˆ˜ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰**
- `std::future::get()`ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë°›ì•„ì˜´ (blockë¨)

---

## ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ì¶œë ¥ ì‹œ ì£¼ì˜ì 

```cpp
std::mutex print_mtx;

void print_message(const std::string& msg) {
    std::lock_guard<std::mutex> lock(print_mtx);
    std::cout << msg << "\n";
}
```

> `cout`ì€ ê³µìœ  ìì›ì´ë¯€ë¡œ ìŠ¤ë ˆë“œ ê°„ ë™ê¸°í™” í•„ìš”

---

## ë§ˆë¬´ë¦¬ ìš”ì•½

| ê¸°ëŠ¥              | ë„êµ¬                           |
|-------------------|--------------------------------|
| ìŠ¤ë ˆë“œ ì‹¤í–‰       | `std::thread`, `join()`        |
| ìŠ¤ë ˆë“œ ê°„ ë™ê¸°í™”  | `std::mutex`, `lock_guard`     |
| ìœ ì—°í•œ ë½         | `std::unique_lock`             |
| ë¹„ë™ê¸° ê³„ì‚°       | `std::async`, `std::future`    |
| ì¶œë ¥ ë™ê¸°í™”       | `mutex`ë¥¼ ì‚¬ìš©í•œ `cout` ë³´í˜¸   |

---

## ì‹¤ì „ íŒ

- `detach()`ëŠ” ë‚¨ìš©í•˜ì§€ ë§ ê²ƒ (ìŠ¤ë ˆë“œê°€ ëë‚˜ê¸° ì „ì— mainì´ ì¢…ë£Œë˜ë©´ ë¬¸ì œ ë°œìƒ)
- ë°ì´í„° ë ˆì´ìŠ¤ë¥¼ ë§‰ê¸° ìœ„í•œ ë½ ì „ëµ ì„¤ê³„ ì¤‘ìš”
- ë³µì¡í•œ ê³µìœ  ìƒíƒœ â†’ `std::atomic`, `condition_variable`, `thread pool` ë„ ê³ ë ¤