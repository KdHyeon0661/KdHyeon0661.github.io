---
layout: post
title: Avalonia - ì—¬ëŸ¬ í˜ì´ì§€ êµ¬ì¡°
date: 2024-12-26 19:20:23 +0900
category: Avalonia
---
# ğŸ§­ Avalonia MVVM: ì—¬ëŸ¬ í˜ì´ì§€ êµ¬ì¡° (íƒ­, ë©”ë‰´, ë„¤ë¹„ê²Œì´ì…˜ ë“±)

---

## âœ… ëª©í‘œ

- ì—¬ëŸ¬ í™”ë©´(View)ì„ íƒ­, ë©”ë‰´, ë²„íŠ¼ ë“±ìœ¼ë¡œ ì „í™˜í•  ìˆ˜ ìˆëŠ” êµ¬ì¡° êµ¬ì„±
- ViewModelê³¼ ê²°í•©í•˜ì—¬ MVVM ì•„í‚¤í…ì²˜ ìœ ì§€
- í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì— ê°•í•œ ì„¤ê³„ ë°©ì‹ ì œê³µ

---

## ğŸ“ ì˜ˆì‹œ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
MyAvaloniaApp/
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ MainView.axaml
â”‚   â”œâ”€â”€ DashboardView.axaml
â”‚   â”œâ”€â”€ SettingsView.axaml
â”‚   â””â”€â”€ AboutView.axaml
â”œâ”€â”€ ViewModels/
â”‚   â”œâ”€â”€ MainViewModel.cs
â”‚   â”œâ”€â”€ DashboardViewModel.cs
â”‚   â”œâ”€â”€ SettingsViewModel.cs
â”‚   â””â”€â”€ AboutViewModel.cs
```

---

# 1ï¸âƒ£ íƒ­(TabControl) ê¸°ë°˜ í˜ì´ì§€ ì „í™˜

ê°€ì¥ ê¸°ë³¸ì ì¸ ë‹¤ì¤‘ í˜ì´ì§€ UI ë°©ì‹ì…ë‹ˆë‹¤.

## ğŸ“„ MainView.axaml

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="MyAvaloniaApp.Views.MainView"
             xmlns:views="clr-namespace:MyAvaloniaApp.Views"
             xmlns:vm="clr-namespace:MyAvaloniaApp.ViewModels">

    <UserControl.DataContext>
        <vm:MainViewModel/>
    </UserControl.DataContext>

    <TabControl SelectedIndex="{Binding SelectedTab}">
        <TabItem Header="ëŒ€ì‹œë³´ë“œ">
            <views:DashboardView />
        </TabItem>
        <TabItem Header="ì„¤ì •">
            <views:SettingsView />
        </TabItem>
        <TabItem Header="ì •ë³´">
            <views:AboutView />
        </TabItem>
    </TabControl>
</UserControl>
```

## ğŸ“„ MainViewModel.cs

```csharp
using ReactiveUI;

public class MainViewModel : ReactiveObject
{
    private int _selectedTab;

    public int SelectedTab
    {
        get => _selectedTab;
        set => this.RaiseAndSetIfChanged(ref _selectedTab, value);
    }
}
```

> âœ… ê°„ë‹¨í•˜ë©´ì„œë„ ë¹ ë¥´ê²Œ êµ¬í˜„ ê°€ëŠ¥í•˜ì§€ë§Œ, ê³ ì •ëœ íƒ­ ìˆ˜ì— ì í•©

---

# 2ï¸âƒ£ ë©”ë‰´(Menu) + ContentControlì„ ì´ìš©í•œ ë™ì  í˜ì´ì§€ ì „í™˜

ë” ì¼ë°˜ì ì´ê³  ë™ì ìœ¼ë¡œ í™”ë©´ì„ ë°”ê¾¸ê³  ì‹¶ì„ ë•Œ ì í•©í•©ë‹ˆë‹¤.

## ğŸ“„ MainView.axaml

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="MyAvaloniaApp.Views.MainView"
             xmlns:views="clr-namespace:MyAvaloniaApp.Views"
             xmlns:vm="clr-namespace:MyAvaloniaApp.ViewModels">

    <UserControl.DataContext>
        <vm:MainViewModel/>
    </UserControl.DataContext>

    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="í˜ì´ì§€ ì´ë™">
                <MenuItem Header="ëŒ€ì‹œë³´ë“œ" Command="{Binding ShowDashboardCommand}" />
                <MenuItem Header="ì„¤ì •" Command="{Binding ShowSettingsCommand}" />
                <MenuItem Header="ì •ë³´" Command="{Binding ShowAboutCommand}" />
            </MenuItem>
        </Menu>

        <ContentControl Content="{Binding CurrentView}" />
    </DockPanel>
</UserControl>
```

## ğŸ“„ MainViewModel.cs

```csharp
using ReactiveUI;
using System.Reactive;
using System;

public class MainViewModel : ReactiveObject
{
    public object? CurrentView { get; set; }

    public ReactiveCommand<Unit, Unit> ShowDashboardCommand { get; }
    public ReactiveCommand<Unit, Unit> ShowSettingsCommand { get; }
    public ReactiveCommand<Unit, Unit> ShowAboutCommand { get; }

    public MainViewModel()
    {
        ShowDashboardCommand = ReactiveCommand.Create(() =>
            CurrentView = new DashboardViewModel());

        ShowSettingsCommand = ReactiveCommand.Create(() =>
            CurrentView = new SettingsViewModel());

        ShowAboutCommand = ReactiveCommand.Create(() =>
            CurrentView = new AboutViewModel());

        CurrentView = new DashboardViewModel();
    }
}
```

> ğŸ§  `ContentControl`ì€ ë‚´ë¶€ ViewModelì— ë§ì¶° Viewë¥¼ ìë™ ë Œë”ë§í•˜ëŠ” Avaloniaì˜ í•µì‹¬ ì»¨íŠ¸ë¡¤ì…ë‹ˆë‹¤.

## ğŸ“„ ViewLocator.cs (ViewModel â†’ View ë§¤í•‘)

```csharp
public class ViewLocator : IDataTemplate
{
    public Control Build(object? data)
    {
        if (data is DashboardViewModel) return new DashboardView();
        if (data is SettingsViewModel) return new SettingsView();
        if (data is AboutViewModel) return new AboutView();
        return new TextBlock { Text = "ì•Œ ìˆ˜ ì—†ëŠ” í˜ì´ì§€" };
    }

    public bool Match(object? data) => data is IViewModel;
}
```

## ğŸ“„ App.axamlì— ViewLocator ë“±ë¡

```xml
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:MyAvaloniaApp">

    <Application.DataTemplates>
        <local:ViewLocator />
    </Application.DataTemplates>
</Application>
```

> âœ… MVVM ìŠ¤íƒ€ì¼ì„ ìœ ì§€í•˜ë©´ì„œ ViewModel ê°„ ì „í™˜ì´ ê¹”ë”í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.

---

# 3ï¸âƒ£ ë²„íŠ¼ìœ¼ë¡œ ì§ì ‘ ì „í™˜ (Frame ë°©ì‹)

`TabControl`ì´ë‚˜ `Menu` ì—†ì´ë„ ë‹¨ìˆœí•œ í˜ì´ì§€ ë²„íŠ¼ ì „í™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```xml
<StackPanel>
    <StackPanel Orientation="Horizontal" Spacing="8">
        <Button Content="Home" Command="{Binding ShowHome}" />
        <Button Content="Profile" Command="{Binding ShowProfile}" />
    </StackPanel>

    <ContentControl Content="{Binding CurrentView}" />
</StackPanel>
```

---

# 4ï¸âƒ£ í˜ì´ì§€ ì „í™˜ ì‹œ íŒŒë¼ë¯¸í„° ì „ë‹¬

## ì˜ˆ: ì‚¬ìš©ì IDë¥¼ í”„ë¡œí•„ í˜ì´ì§€ì— ì „ë‹¬

```csharp
ShowProfileCommand = ReactiveCommand.Create<int>(id =>
{
    CurrentView = new ProfileViewModel(id);
});
```

---

# 5ï¸âƒ£ NavigationServiceë¡œ êµ¬ì¡°í™” (ì˜µì…˜)

`INavigationService` ê°™ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì „í™˜ ë¡œì§ì„ ViewModel ê°„ ë¶„ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```csharp
public interface INavigationService
{
    void NavigateTo(object viewModel);
}
```

```csharp
public class NavigationService : INavigationService
{
    public Action<object>? OnNavigate { get; set; }

    public void NavigateTo(object viewModel)
    {
        OnNavigate?.Invoke(viewModel);
    }
}
```

ViewModelì—ì„œ ì´ ì„œë¹„ìŠ¤ë¥¼ ì£¼ì…ë°›ì•„ í˜¸ì¶œí•˜ë©´ í™”ë©´ ì „í™˜ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.

---

## âœ… ì •ë¦¬

| ë°©ì‹ | ì„¤ëª… | ì¥ì  | ë‹¨ì  |
|------|------|------|------|
| TabControl | ê³ ì •ëœ í˜ì´ì§€ íƒ­ êµ¬ì¡° | ë¹ ë¦„, ì‰¬ì›€ | ìœ ì—°ì„± ë¶€ì¡± |
| Menu + ContentControl | ë©”ë‰´ ê¸°ë°˜ ë™ì  ì „í™˜ | êµ¬ì¡°í™” ì‰¬ì›€, MVVM ì¹œí™”ì  | ì•½ê°„ ë³µì¡ |
| ë²„íŠ¼ + ContentControl | ì‘ì€ ì•±ì— ì í•© | ìµœì†Œí•œì˜ ì „í™˜ | í™•ì¥ì„± ë–¨ì–´ì§ |
| NavigationService | êµ¬ì¡°ì ì´ê³  ì¬ì‚¬ìš© ê°€ëŠ¥ | ì¤‘ëŒ€í˜• ì•± ì í•© | ì„¤ê³„ í•„ìš” |