---
layout: post
title: 미적분 - 벡터장과 선적분
date: 2025-08-17 22:20:23 +0900
category: 미적분
---
# 벡터장과 선적분

## 0. 준비: 표기와 기본 개념

- **벡터장** \( \mathbf{F} \)  
  평면/공간의 각 점에 벡터를 대응시키는 함수:
  - 2D: \( \mathbf{F}(x,y) = \langle P(x,y),\, Q(x,y) \rangle \)
  - 3D: \( \mathbf{F}(x,y,z) = \langle P(x,y,z),\, Q(x,y,z),\, R(x,y,z) \rangle \)

- **곡선의 매개화**  
  조각-매끄러운 곡선 \( C \) 를
  $$
  \mathbf{r}(t)=\langle x(t),\,y(t),\,z(t)\rangle,\quad a\le t\le b
  $$
  로 매개화한다(2D면 \(z\) 성분 생략).

- **선적분(벡터장)**  
  벡터장에 대한 선적분은
  $$
  \int_C \mathbf{F}\cdot d\mathbf{r}
  \;:=\;\int_a^b \mathbf{F}(\mathbf{r}(t))\cdot\mathbf{r}'(t)\,dt.
  $$
  평면에서는 **미분형**으로
  $$
  \int_C P\,dx + Q\,dy
  $$
  와 동일하다(\(dx= x'(t)dt\), \(dy=y'(t)dt\), 내적을 전개한 꼴).

- **물리적 해석**  
  - \( \mathbf{F} \)가 **힘장**이면, \( \int_C \mathbf{F}\cdot d\mathbf{r} \) 는 경로 \( C \) 를 따라 수행된 **일(work)**  
  - 폐곡선 \(C\) 에서의 값 \( \oint_C \mathbf{F}\cdot d\mathbf{r} \) 는 **순환(circulation)**

---

## 1. 정의: 벡터장에 대한 선적분

### 1.1 정의
곡선 \( C \) : \( \mathbf{r}(t) \), \( a\le t\le b\).  
벡터장 \( \mathbf{F} \). 그러면
$$
\boxed{
\int_C \mathbf{F}\cdot d\mathbf{r}
:=\int_a^b \mathbf{F}(\mathbf{r}(t))\cdot \mathbf{r}'(t)\,dt.
}
$$
평면 형태 \( \mathbf{F}=\langle P,Q\rangle \) 에서는
$$
\int_C \mathbf{F}\cdot d\mathbf{r}
=\int_C P\,dx + Q\,dy.
$$

### 1.2 성질
- **재매개 불변성**: \(t=\phi(s)\) 가 단조 증가이면 값은 동일.
- **방향 반전**: \(\int_{-C}\mathbf{F}\cdot d\mathbf{r} = -\int_C\mathbf{F}\cdot d\mathbf{r}\).
- **가법성**: \(C=C_1\cup C_2\) (끝점 일치)면 \(\int_C=\int_{C_1}+\int_{C_2}\).

---

## 2. 예제: 직접 계산으로 감각 익히기

### 2.1 예제 A — 원에서의 순환
벡터장 \( \mathbf{F}(x,y)=\langle -y,\, x\rangle \).  
단위원 \( C: x=\cos t,\ y=\sin t,\ 0\le t\le 2\pi \).

- \( \mathbf{F}(\mathbf{r}(t))=\langle -\sin t,\ \cos t\rangle \)
- \( \mathbf{r}'(t)=\langle -\sin t,\ \cos t\rangle \)
- 내적 \(=1\)

따라서
$$
\oint_C \mathbf{F}\cdot d\mathbf{r}
=\int_0^{2\pi} 1\,dt = 2\pi.
$$
**해석**: 반시계 방향으로 도는 회전형 벡터장의 순환값은 \(2\pi\).

---

### 2.2 예제 B — 직선 경로에서의 일
\( \mathbf{F}(x,y)=\langle 2x+y,\ x-3y\rangle \).  
경로 \( C: (0,0)\to(1,2) \) 를 직선으로 \( \mathbf{r}(t)=(t,2t),\ 0\le t\le 1 \).

- \( \mathbf{F}(\mathbf{r}(t))=\langle 4t,\ -5t\rangle \)
- \( \mathbf{r}'(t)=\langle 1, 2\rangle \)
- 내적 \(= 4t\cdot 1 + (-5t)\cdot 2 = -6t\)

적분:
$$
\int_C \mathbf{F}\cdot d\mathbf{r}
=\int_0^1 (-6t)\,dt
= -3.
$$

---

### 2.3 예제 C — 경로 의존성 확인
동일한 시작·끝점을 잇는 **서로 다른 경로**에서 적분값을 비교해 보자.  
\( \mathbf{F}=\langle -y,\, x\rangle \).  
경로1: 직선 \( \mathbf{r}_1(t) = (1-t,\ t)\), \(0\le t\le 1\).  
경로2: 원호 \( \mathbf{r}_2(t) = (\cos t,\ \sin t)\), \(0\le t\le \pi/2\).

- **경로1**  
  \( \mathbf{F}(\mathbf{r}_1) = \langle -t,\, 1-t\rangle \), \( \mathbf{r}_1'(t)=(-1,1) \)  
  내적 \(= (-t)(-1)+(1-t)(1)=1 \) → 적분값 \(=1\).

- **경로2**  
  앞선 순환 예와 동일(사분원) → 내적 \(=1\) → 적분값 \(=\pi/2\).

**결론**: 적분값이 다르므로 이 장은 **보존장**이 아니다(경로의존적).

---

## 3. 보존장(Conservative Field), 퍼텐셜, 경로독립성

### 3.1 보존장의 정의
벡터장 \( \mathbf{F} \) 가 **어떤 스칼라장(퍼텐셜)** \( \phi \) 의 그라디언트이면
$$
\mathbf{F}=\nabla \phi.
$$
이 경우 \( \mathbf{F} \) 를 **보존장**이라 부른다.

### 3.2 선적분의 기본정리
보존장 \( \mathbf{F}=\nabla \phi \) 에 대해 \(C: A\to B\) 이면
$$
\boxed{
\int_C \mathbf{F}\cdot d\mathbf{r} = \phi(B) - \phi(A).
}
$$
즉, **경로독립**: 시작/끝점만 중요, 경로는 중요하지 않다.  
폐곡선에서는
$$
\oint_C \mathbf{F}\cdot d\mathbf{r} = 0.
$$

### 3.3 평면에서의 충분조건(단일연결)
2D에서 \( \mathbf{F}=\langle P, Q\rangle \) 가 \(C^1\) 이고, 영역이 **단일연결**이면
$$
\frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}
\quad\Rightarrow\quad \mathbf{F}\ \text{는 보존장}.
$$
(필요충분은 아니지만, 단일연결에서는 충분조건으로 자주 사용)

### 3.4 예제 D — 보존장 판별과 퍼텐셜 찾기
\( \mathbf{F}(x,y)=\langle 2xy+y^3,\ x^2+3xy^2\rangle \).  
교차미분:
$$
\frac{\partial P}{\partial y} = 2x+3y^2,\qquad
\frac{\partial Q}{\partial x} = 2x+3y^2
$$
동일 → 보존장(단일연결 가정). 퍼텐셜 \( \phi \) 를 구한다:
- \( \phi_x=P \) 로부터 \( \phi = \int (2xy+y^3)\,dx = x^2y + xy^3 + g(y) \)
- \( \phi_y = x^2 + 3xy^2 + g'(y) = Q \Rightarrow g'(y)=0 \Rightarrow g=\text{const} \)
따라서
$$
\phi(x,y)=x^2y+xy^3.
$$
임의의 \(A\to B\) 경로 선적분은 \(\phi(B)-\phi(A)\) 로 즉시 계산된다.

---

## 4. “구멍 난 영역”과 보존성 실패: 단일연결의 중요성

### 4.1 대표 반례
\( \mathbf{F}(x,y)=\left\langle \frac{-y}{x^2+y^2},\, \frac{x}{x^2+y^2} \right\rangle \), 원점 제외한 영역에서 정의.  
이 장은 \(\nabla \times \mathbf{F}=0\) (2D 등가에서는 \(Q_x-P_y=0\)) 처럼 보일 수 있지만,
영역이 **단일연결이 아님(원점이 구멍)** 이므로 **보존장이 아니다**.  
폐곡선으로 원을 한 바퀴 돌면
$$
\oint_C \mathbf{F}\cdot d\mathbf{r}=2\pi \neq 0.
$$
“구멍”의 감김수(winding number)에 비례(정확히는 \(2\pi\cdot n\)).

---

## 5. 평면: Green 정리(미리보기)와 순환

### 5.1 Green 정리(요지)
영역 \(D\) 의 양의 방향(반시계) 경계 \( \partial D \) 에 대해
$$
\oint_{\partial D} P\,dx+Q\,dy
= \iint_D \left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA.
$$
좌변은 **순환**(circulation), 우변은 벡터장 “회전 성분(2D curl)”의 면적 적분.

### 5.2 예제 E — Green 정리로 빠른 순환 계산
\( \mathbf{F}=\langle -y,\ x\rangle \), \(D\) 는 단위원.  
\(\partial Q/\partial x - \partial P/\partial y = 1 - (-1) = 2\).  
면적은 \(\pi\). 따라서
$$
\oint_{\partial D} \mathbf{F}\cdot d\mathbf{r}
= \iint_D 2\,dA = 2\pi,
$$
앞서 직접계산과 일치.

---

## 6. 3차원으로 확장: Curl·Divergence와의 연결(예고)

- 3D에서 **Stokes 정리**:
  $$
  \oint_{\partial S} \mathbf{F}\cdot d\mathbf{r}
  = \iint_S (\nabla\times\mathbf{F})\cdot\mathbf{n}\,dS.
  $$
  순환 ↔ **컬(curl)** 의 플럭스.

- **발산 정리**:
  $$
  \iint_{\partial V}\mathbf{F}\cdot\mathbf{n}\,dS=\iiint_V \nabla\cdot \mathbf{F}\,dV.
  $$
  아직 본문의 초점은 **선적분**이므로 자세한 전개는 후속 글로 넘기고, 여기서는 벡터장 선적분과의 개념 연결만 짚고 넘어간다.

---

## 7. 수치/심볼릭 계산 코드

아래 코드는 **수치적분**으로 선적분을 계산하는 도구와, **SymPy** 를 통한 심볼릭 검증 스니펫을 포함한다.

### 7.1 NumPy로 수치 선적분(벡터장)
```python
import numpy as np

def line_integral_vector(r, rp, F, a, b, n=20000):
    """
    ∫_C F · dr ≈ ∑ F(r(tk)) · r'(tk) Δt  (Trapezoidal)
    r  : callable(t) -> (x,y) or (x,y,z)
    rp : callable(t) -> (dx/dt, dy/dt, [dz/dt])
    F  : callable(x,y[,z]) -> (Fx,Fy[,Fz])
    """
    ts = np.linspace(a, b, n+1)
    dt = (b - a) / n

    vals = []
    for t in ts:
        pos = np.array(r(t))
        vel = np.array(rp(t))
        vals.append(np.dot(F(*pos), vel))
    vals = np.array(vals)
    return dt * (0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

# 예제: 단위원, F=(-y, x) -> ∮ F·dr = 2π
r  = lambda t: (np.cos(t), np.sin(t))
rp = lambda t: (-np.sin(t), np.cos(t))
F  = lambda x, y: (-y, x)

approx = line_integral_vector(r, rp, F, 0.0, 2*np.pi, n=100000)
print("∮ F·dr ≈", approx)  # ≈ 2π
print("Error ≈", abs(approx - 2*np.pi))
```

### 7.2 엘립스에서 스칼라/벡터 선적분 비교(응용)
```python
# 스칼라 선적분: ∫_C ρ ds
def line_integral_scalar(r, rp, f, a, b, n=20000):
    ts = np.linspace(a, b, n+1)
    dt = (b - a) / n
    vals = []
    for t in ts:
        speed = np.linalg.norm(np.array(rp(t)))
        vals.append(f(*r(t)) * speed)
    vals = np.array(vals)
    return dt * (0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

a, b = 2.0, 1.0
r2  = lambda t: (a*np.cos(t), b*np.sin(t))
rp2 = lambda t: (-a*np.sin(t),  b*np.cos(t))
rho = lambda x, y: x*x + y*y

M = line_integral_scalar(r2, rp2, rho, 0.0, 2*np.pi, n=80000)
print("∮ ρ ds (ellipse) ≈", M)

# 같은 경로에서 F=(-y, x)의 순환(경로가 원이 아니므로 값이 변함)
F  = lambda x, y: (-y, x)
circ = line_integral_vector(r2, rp2, F, 0.0, 2*np.pi, n=80000)
print("∮ F·dr (ellipse) ≈", circ)
```

### 7.3 SymPy로 보존장 판정과 퍼텐셜 찾기(예제 D)
```python
import sympy as sp

x, y = sp.symbols('x y', real=True)
P = 2*x*y + y**3
Q = x**2 + 3*x*y**2

cond = sp.diff(Q, x) - sp.diff(P, y)
print("Q_x - P_y =", sp.simplify(cond))  # 0 -> 보존장(단일연결 가정)

# 퍼텐셜 phi 찾기
phi = sp.integrate(P, (x))  # ∫ P dx
phi = sp.simplify(phi)      # x^2 y + x y^3 + g(y)
phi_y = sp.diff(phi, y)
print("phi =", phi)
print("phi_y - Q =", sp.simplify(phi_y - Q))  # 0 up to constant
```

---

## 8. 실전 시나리오

### 8.1 시나리오 1 — 힘장이 보존장일 때의 빠른 일 계산
포텐셜 \( \phi(x,y)=\tfrac{1}{2}k(x^2+y^2) \) 의 그래디언트는 \( \mathbf{F}=k\langle x, y\rangle \).  
어떤 경로로 \( A\to B \) 이동하든
$$
W=\int_C \mathbf{F}\cdot d\mathbf{r}
=\phi(B)-\phi(A)=\tfrac{1}{2}k(\|B\|^2-\|A\|^2).
$$
**경로독립** 덕분에 즉시 계산.

### 8.2 시나리오 2 — 회전형 유동에서의 순환
평면 속도장 \( \mathbf{u}(x,y)=\omega \langle -y, x\rangle \).  
반시계 원 \(C_R\) 에서 순환
$$
\oint_{C_R} \mathbf{u}\cdot d\mathbf{r}
= \int_0^{2\pi} \omega R^2\,dt = 2\pi\omega R^2.
$$
**각속도 \(\omega\) 와 반지름 \(R\)** 에 비례(바깥쪽일수록 크다).

### 8.3 시나리오 3 — 구멍 난 도메인에서의 경로 의존성
전자기 포텐셜 해석 등에서, 원점을 제외한 평면의 벡터장  
\( \mathbf{F}=\langle -y/r^2,\, x/r^2\rangle \) 의 순환은 **감김수**에 의존:
$$
\oint_C \mathbf{F}\cdot d\mathbf{r} = 2\pi n,\quad n=\text{winding}(C\text{ around }0).
$$
‘보존장처럼 보이는’ 조건이 있어도, 도메인이 단일연결이 아니면 경로독립성이 깨질 수 있다.

---

## 9. 체크리스트(계산/이론/구현)

- □ 곡선 매개화 \( \mathbf{r}(t) \), \( \mathbf{r}'(t) \) 를 먼저 정확히 구했는가?  
- □ \(\int_C \mathbf{F}\cdot d\mathbf{r}\) = \(\int_a^b \mathbf{F}(\mathbf{r}(t))\cdot \mathbf{r}'(t)\,dt\) 를 일관되게 사용했는가?  
- □ 경로 방향(시작·끝)과 부호에 주의했는가?  
- □ 2D에서 \( \partial P/\partial y = \partial Q/\partial x \) 를 확인했고, **단일연결** 여부를 점검했는가?  
- □ 보존장이라면 퍼텐셜을 찾아 **기본정리**로 빠르게 처리했는가?  
- □ 폐곡선이면 \(\oint\) 를 명확히 표기하고, Green/Stokes 정리 적용 가능성 검토했는가?  
- □ 수치적분에서는 구간 분할, 특이점 근방 분해, 적응적 방법 검토했는가?

---

## 10. 연습문제(정답 스케치)

1) \( \mathbf{F}=\langle y\cos x,\ \sin x + x y^2\rangle \).  
   (a) \( \partial P/\partial y,\ \partial Q/\partial x \) 를 비교하여 보존장인지 판단하라.  
   (b) 보존장이라면 퍼텐셜 \( \phi \) 를 구하고 \( A=(0,0)\to B=(1,1) \) 의 선적분을 계산하라.  
   - 힌트: (a)에서 일반적으로 같지 않음 → 비보존장.

2) \( \mathbf{F}=\langle 2xy+y^3,\ x^2+3xy^2\rangle \).  
   (a) 보존장 판별. (b) 퍼텐셜 \( \phi \). (c) \(A=(0,0), B=(1,1)\) 에서 \(\int_C\) 값을 구하라.  
   - 정답 스케치: 보존장, \( \phi=x^2y+xy^3 \), 결과 \( \phi(1,1)-\phi(0,0)=2\).

3) \( \mathbf{F}=\langle -y/(x^2+y^2),\, x/(x^2+y^2)\rangle \).  
   (a) 단위원을 반시계로 1회, 2회 도는 두 경로에서 \(\oint_C\) 값을 구하라.  
   - 정답: \(2\pi\), \(4\pi\).

4) \( \mathbf{F}=\langle -y, x\rangle \).  
   (a) 원 \(x^2+y^2=R^2\) 에서 \(\oint_C\) 값. (b) 타원 \(x^2/a^2+y^2/b^2=1\) 에서 \(\oint_C\) 값을 수치적으로 평가하라.  
   - (a) \(2\pi R^2/R^0\) 가 아니라, 매개에 따라 내적=1이 되는 단위원 사례만 \(2\pi\).  
     일반 \(R\) 원: \(x=R\cos t, y=R\sin t\)이면 같은 계산으로 결과는 \(2\pi R^2/R^0\) 가 아닌 **\(2\pi R^2 / R^0\)로 보일 수 있으나** 실제 계산은
     \(\mathbf{F}=\langle -R\sin t, R\cos t\rangle\), \(\mathbf{r}'=\langle -R\sin t, R\cos t\rangle\) → 내적 \(=R^2\), 결과 \(2\pi R^2\).

5) 3D: \( \mathbf{F}(x,y,z)=\langle -y, x, \beta\rangle \), \( C: \mathbf{r}(t)=\langle R\cos t, R\sin t, \alpha t\rangle, 0\le t\le T \).  
   \(\int_C \mathbf{F}\cdot d\mathbf{r}\) 를 구하라.  
   - 정답: \( (R^2+\alpha\beta)T \).

---

## 11. 요약

- **벡터장에 대한 선적분**은 경로를 따라 벡터장이 한 **일**(또는 **순환**)을 측정한다.  
- **보존장**이면 **경로독립**이며, 퍼텐셜의 차로 계산 가능(선적분의 기본정리).  
- 평면에서는 **Green 정리**로 폐곡선의 선적분을 영역 적분으로 바꿀 수 있다(회전의 면적 적분).  
- 영역의 **단일연결성**은 보존성·경로독립성 판정에서 핵심.  
- 수치/심볼릭 도구를 활용하면 복잡한 경로/벡터장에서도 안정적으로 계산 가능.

---

## 부록: SymPy로 순환 값 확인(원에서 2π)

```python
import sympy as sp

t = sp.symbols('t', real=True)
x = sp.cos(t)
y = sp.sin(t)
dx = sp.diff(x, t)
dy = sp.diff(y, t)

P = -y
Q =  x
integrand = P*dx + Q*dy
res = sp.integrate(integrand, (t, 0, 2*sp.pi))
print("∮ (-y)dx + x dy on unit circle:", sp.simplify(res))  # 2π
```