---
layout: post
title: 정수론 - 정수를 제곱들의 합으로 표현하기
date: 2025-09-15 17:25:23 +0900
category: 정수론
---
# 정수를 제곱들의 합으로 표현하기 — 조제프 루이 라그랑주, 두 제곱의 합, 셋·넷 제곱의 합

> **작성 원칙**
> - 예제는 **적게** 두되 **아주 자세히** 전개한다.
> - 핵심 정리에는 **증명(또는 엄밀한 증명 스케치)** 를 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.
> - 표기: $$\mathbb{Z}$$(정수), $$\mathbb{N}$$(자연수), $$\gcd(a,b)$$(최대공약수), $$\sigma(n)=\sum_{d\mid n}d$$(약수합), $$r_k(n)$$(순서·부호까지 세는, $$n$$ 을 $$k$$ 제곱의 합으로 나타내는 표현 수).

---

## 0. 라그랑주(Joseph-Louis Lagrange) — 네 제곱 정리의 역사적 맥락

18세기 말 **라그랑주**는 다음의 기념비적 정리를 증명했다.

- **라그랑주의 네 제곱 정리(1770)**  
  $$
  \boxed{\ \text{모든 } n\in\mathbb{N} \text{ 은 네 개의 정수 제곱의 합으로 표현된다.}\ }
  $$
  즉
  $$
  \forall n\in\mathbb{N}\ \exists\ x_1,x_2,x_3,x_4\in\mathbb{Z}\ \text{ s.t. }\ n=x_1^2+x_2^2+x_3^2+x_4^2.
  $$

라그랑주의 원래 증명은 **무한강하**와 **합성법(Composition)**, 그리고 합의 닫힘을 보장하는 항등식(오늘날 **오일러의 네 제곱 항등식**)을 핵심으로 삼는다. 이후 **가우스**, **자코비**, **레장드르**가 셋·넷 제곱의 합에 대한 정밀한 산술과 표현 개수 공식을 발전시켰고, 19–20세기를 거치며 **가우스 정수** $$\mathbb{Z}[i]$$, **허위 사원수(Quaternions)**, **기하수론(미코프스키)** 등 다양한 관점에서 재증명이 축적되었다.

---

## 1. 두 제곱의 합 — 페르마–가우스의 정리와 가우스 정수

### 1.1 필요충분조건(페르마의 두 제곱 정리)

- **정리(페르마–오일러–가우스)**  
  $$n>0$$ 을 소인수분해
  $$
  n=2^{\alpha}\prod_{p\equiv 1\ (4)}p^{\alpha_p}\prod_{q\equiv 3\ (4)}q^{\beta_q}
  $$
  하자. 그러면
  $$
  \boxed{\ n=x^2+y^2\ \text{로 표현} \iff \text{모든 } q\equiv 3\ (4)\ \text{에 대해 } \beta_q\ \text{가 짝수}\ }.
  $$
  즉, **\(4\)로 나눈 나머지가 \(3\)** 인 소수는 **짝수 지수**로만 등장해야 한다.

- **아이디어(증명 스케치)**  
  핵심은 가우스 정수환 $$\mathbb{Z}[i]$$ 가 **유일분해정역(UFD)** 라는 사실.  
  $$
  x^2+y^2=N\quad\Leftrightarrow\quad (x+iy)(x-iy)=N
  $$
  이고, $$\mathbb{Z}[i]$$ 에서의 소인수분해를 켤레쌍까지 고유하게 비교하면, 실수 정수에서의 소인수 분포가 어떻게 되어야 하는지(특히 $$q\equiv 3\pmod 4$$ 가 **분해되지 않는 소수**임) 곧장 도출된다.

### 1.2 닫힘성: 브라흐마굽타–피보나치 항등식

- **항등식**
  $$
  (a^2+b^2)(c^2+d^2)=(ac\pm bd)^2+(ad\mp bc)^2.
  $$
  따라서 **두 제곱의 합의 곱은 다시 두 제곱의 합**이다.  
  이 닫힘성은 “소수에서 케이스를 만들고 곱으로 확장”하는 전략의 핵심.

### 1.3 표현 개수: 자코비–디리클레 공식(요지)

- **자코비의 두 제곱 표현 수**
  $$
  \boxed{\ r_2(n)=4\big(d_1(n)-d_3(n)\big)\ },
  $$
  여기서 $$d_1(n)$$ 은 $$n$$ 의 약수 중 $$\equiv 1\ (4)$$ 인 개수, $$d_3(n)$$ 는 $$\equiv 3\ (4)$$ 인 개수. (순서·부호 포함하여 센다.)
  
  예컨대 $$n=65=5\cdot 13$$ 의 약수는 $$1,5,13,65$$(모두 \(1\bmod 4\))이므로  
  $$
  r_2(65)=4(4-0)=16.
  $$
  (이는 \(\pm\) 부호와 순서까지 포함한 총 표현 수이며, “본질적으로 다른” 표현은 그보다 적다.)

### 1.4 구체 예제(작게, 그러나 끝까지)

- **예제 A: 21은 두 제곱의 합이 아니다.**  
  $$21=3\cdot 7,\ 3\equiv 7\equiv 3\ (\bmod 4),$$ 두 소수의 지수가 모두 1(홀수) → **불가능**.

- **예제 B: 45는 두 제곱의 합**  
  $$45=3^2\cdot 5,$$ 여기서 $$3\equiv 3\ (\bmod 4)$$ 이지만 **지수 2(짝수)** → 가능. 실제로
  $$
  45=6^2+3^2.
  $$

- **예제 C: 325의 표현을 실제로 구하기**  
  $$325=5^2\cdot 13.$$ 이미 가능 조건 충족. 항등식으로 **구체 표현**:
  $$
  5=2^2+1^2,\quad 13=3^2+2^2,\quad 25=5^2+0^2.
  $$
  먼저 $$25\cdot 13=325=(5^2+0^2)(3^2+2^2)$$ 에 항등식을 적용하면
  $$
  325=(5\cdot 3\pm 0\cdot 2)^2+(5\cdot 2\mp 0\cdot 3)^2=15^2+10^2.
  $$
  다른 조합으로도
  $$
  325=17^2+6^2,\quad 325=18^2+1^2
  $$
  등 여러 표현이 나온다(합성수의 곱구조를 반영).

### 1.5 실제 계산법 한 가지: 코르나키아(Cornacchia) 알고리즘(개요)

**목표**: 큰 소수 $$p\equiv 1\ (4)$$ 에 대해 $$p=x^2+y^2$$ 를 **빠르게** 찾기.  
**핵심 단계**
1) $$t^2\equiv -1\ (\bmod p)$$ 인 $$t$$ 를 찾는다(예: $$t\equiv \pm 2^{(p-1)/4}\ (\bmod p)$$, 또는 확률적 탐색).
2) 확장 유클리드로 $$p$$ 와 $$t$$ 에 유클리드 알고리즘을 적용, 나머지열에서 **제곱근 후보**를 얻는다.
3) 후보로부터 $$x^2+y^2=p$$ 를 검증.

이 방법은 실제 구현에서 매우 효율적이며, 거대한 RSA 모델의 보조 계산 등에서도 쓰인다.

---

## 2. 셋·넷 제곱의 합 — 레장드르·라그랑주·자코비

### 2.1 레장드르의 세 제곱 정리(완전 분류)

- **정리(레장드르, 1798)**  
  $$
  \boxed{\ n=x^2+y^2+z^2\ \text{로 표현} \iff n\neq 4^a(8b+7)\ \text{의 꼴\ (어떤 }a,b\in\mathbb{Z}_{\ge 0})\ }.
  $$
  즉, **\(4^a(8b+7)\)** 형태의 수만이 **세 제곱의 합으로 표현되지 않는다**.

- **불가능의 간단한 필요조건(모듈러 관찰)**  
  제곱은 $$\bmod 8$$ 에서 $$0,1,4$$ 중 하나. 세 제곱의 합은 $$\bmod 8$$ 에서 $$0,1,2,3,4,5,6$$ 을 만들 수 있지만 **7** 은 만들 수 없다.  
  $$4^a$$ 배는 제곱의 가감으로 “스케일”만 바꾸므로 **형태 자체**가 보존된다.

- **예제**  
  - $$n=15=4^0(8\cdot 1+7)$$ → **불가능**(세 제곱 X).  
    하지만 네 제곱으로는 $$15=3^2+2^2+1^2+1^2$$ (라그랑주).  
  - $$n=30$$ 은 아닌 형태 → 가능. 실제로
    $$
    30=15^2+9^2+2^2- \text{(아님)}\quad\text{정정: }30=25+4+1=5^2+2^2+1^2.
    $$
    (작게 맞춰 해를 찾을 수 있다.)

### 2.2 라그랑주의 네 제곱 정리(존재 증명 스케치)

- **오일러의 네 제곱 항등식**  
  $$
  (a_1^2+\cdots+a_4^2)(b_1^2+\cdots+b_4^2)=\sum_{j=1}^4 c_j^2
  $$
  (적절한 선형 결합으로 오른쪽의 $$c_j$$ 들을 구성).  
  → **네 제곱의 합의 곱은 다시 네 제곱의 합**. 이 닫힘성은 **귀납적 구성**의 문을 연다.

- **증명 줄거리(라그랑주/가우스/미코프스키 등 다양한 버전)**  
  1) **소수 단계**: 각 소수 $$p$$ 가 **어떤** 네 제곱의 합을 나눈다는 것(혹은 네 제곱의 합 자체임)을 보인다.  
     - 예: 비둘기집 원리/격자법으로 $$\{0,\pm 1,\ldots,\pm m\}^4$$ 의 사상 $$\bmod p$$ 를 비교해 **충돌**에서 차이를 취하면 $$p\mid(x_1^2+\cdots+x_4^2)$$ 을 얻게 된다.  
  2) **합성수 단계**: 항등식으로 곱에 대해 닫힘 ⇒ 모든 자연수로 확장.  
  3) **무한강하**: “가장 작은 반례”를 가정하면 위 과정을 통해 **더 작은 반례**를 만든다는 모순.

- **자코비의 네 제곱 표현 수 공식(강력한 정밀화)**  
  $$
  \boxed{\ r_4(n)=8\sum_{\substack{d\mid n\\4\nmid d}} d }.
  $$
  즉, $$n$$ 의 약수 중 **4로 나누어떨어지지 않는** 약수들의 합에 8을 곱하면, 순서·부호 포함 총 표현 수가 된다.

  *예*: $$n=15$$ 의 약수는 $$1,3,5,15$$ (모두 \(4\nmid d\)) → 합은 24 → $$r_4(15)=8\cdot 24=192$$.

### 2.3 작은 예제(세·네 제곱)

- **세 제곱 불가능의 전형**: $$n=39=4^0(8\cdot 4+7)$$ → **세 제곱 불가**.  
  그러나 네 제곱으로는 $$39=6^2+3^2+1^2+1^2=36+9+1+1$$.

- **세 제곱 가능의 전형**: $$n=310$$ 은 \(310\not=4^a(8b+7)\).  
  간단 탐색으로
  $$
  310=15^2+9^2+2^2=225+81+4.
  $$

- **네 제곱의 간단 구성 예**: $$n=12345$$  
  $$\lfloor\sqrt{12345}\rfloor=111,\ 111^2=12321,\ \text{차이는 }24=4^2+2^2+0^2.$$
  $$
  12345=111^2+4^2+2^2+0^2.
  $$
  (탐욕적 제곱 빼기가 항상 4개 이내로 끝난다는 보장은 **정리 자체**가 주지만, 실제로도 자주 짧게 끝난다.)

---

## 3. 두 제곱의 합과 가우스 정수 — 조금 더 깊이

### 3.1 $$\mathbb{Z}[i]$$ 에서의 분해와 분기

- 정수 소수의 분류:
  - $$p=2$$: $$2=(-i)(1+i)^2$$ (람리피케이션).
  - $$p\equiv 1\ (4)$$: 분해 $$p=\pi\overline{\pi}$$ (서로 켤레인 가우스 소수).
  - $$p\equiv 3\ (4)$$: **여전히 소수**(분해되지 않음).

- **두 제곱의 합의 본질**:  
  $$n=x^2+y^2\ \Leftrightarrow\ n=(x+iy)(x-iy)$$  
  여기서 우변은 **켤레쌍의 곱**. 따라서 분해되지 않는 소수(즉 \(3\bmod 4\))가 등장하려면 반드시 **짝수 번** 등장해야 한다.

### 3.2 유일성/다양성

- **표현의 유일성**은 대개 **성립하지 않는다**(합성수는 여러 표현 가질 수).  
  그러나 **소수**의 경우,
  $$
  p\equiv 1\ (4)\ \Rightarrow\ p=x^2+y^2
  $$
  의 표현(부호·순서를 무시한 “본질적 표현”)은 **사실상 하나**뿐이다. (이는 $$\mathbb{Z}[i]$$ 에서의 소인수분해의 유일성과 단위군 $$\{\pm 1,\pm i\}$$ 때문에 생기는 4·8중복을 정리하면 얻는다.)

---

## 4. 모듈러 제약 — 빠른 판정의 손전등

- **두 제곱**:  
  - $$n\equiv 3\ (\bmod 4)$$ 인 소수는 **불가**.  
  - 일반 $$n$$ 에서도 \(3\bmod 4\) 소수의 지수 짝홀로 즉시 판정.

- **세 제곱(레장드르)**:  
  - $$n\equiv 7\ (\bmod 8)$$ 이면 **불가**.  
  - $$n=4^a m$$ 으로 축소해 $$m\equiv 7\ (\bmod 8)$$ 인지 확인.

- **네 제곱(라그랑주)**:  
  - **항상 가능**. 불가능 케이스가 없다.

---

## 5. 표현 **개수** — 자코비의 공식 두 가지

- **두 제곱**:
  $$
  r_2(n)=4\big(d_1(n)-d_3(n)\big).
  $$
  *예*: $$n=65\Rightarrow r_2(65)=16.$$

- **네 제곱**:
  $$
  r_4(n)=8\sum_{\substack{d\mid n\\4\nmid d}} d.
  $$
  *예*: $$n=15\Rightarrow r_4(15)=192.$$

> *비고*: 이는 **디리클레 급수**와 **캐릭터**(예: $$\chi_4$$) 분석, 혹은 **세타함수**의 모듈러 성질로 유도된다.

---

## 6. 계산 절차(요약 레시피)

### 6.1 “두 제곱으로 만들 수 있나?” 체크리스트
1) 소인수분해(혹은 최소한 \(3\bmod 4\) 소수의 지수만 확인).  
2) 모든 \(3\bmod 4\) 소수의 지수가 **짝수**이면 **가능**.  
3) 구체 표현은
   - 작은 수: 손계산/항등식 조합,
   - 큰 소수: **코르나키아**,
   - 일반 큰 수: 인수분해 후 항등식으로 조합.

### 6.2 “세 제곱으로 가능?” 체크리스트
1) $$n=4^a m$$ 로 4의 거듭제곱을 **탈착**.  
2) $$m\equiv 7\ (\bmod 8)$$ 이면 **불가**, 아니면 **가능**.  
3) 구체 표현은 탐욕+소규모 탐색(혹은 정수격자 감소/근사기법).

### 6.3 “네 제곱으로 표현”은 항상 가능
- 탐욕적으로 큰 제곱을 빼 나가도 대개 4개 이하에서 끝.  
- 더 체계적으로는 **라그랑주–오일러 항등식**을 써서 작은 소수 표현들을 “곱”해 구성.

---

## 7. 추가 예제 두 개(끝까지 전개)

### 7.1 두 제곱: $$n=130=2\cdot 5\cdot 13$$
- 조건: \(3\bmod 4\) 소수 없음 → **가능**.  
- 표현:
  $$
  5=2^2+1^2,\quad 13=3^2+2^2,\quad 2=1^2+1^2.
  $$
  항등식을 두 번 적용:
  $$
  (5\cdot 13)=65=(15)^2+(10)^2,\quad 130=2\cdot 65=(15\pm 10)^2+(15\mp 10)^2.
  $$
  즉
  $$
  130=25^2+5^2\quad\text{(오류 체크)}\ \Rightarrow\ 25^2=625\ \text{로 과대.\ 정정:}
  $$
  실제로는
  $$
  130=11^2+3^2=121+9,\quad \text{또는}\quad 130= \, (15-10)^2+(15+10)^2=5^2+25^2\ \text{는 과대}\ \Rightarrow\ \text{모듈러 130로 보는 항등식이 아님}.
  $$
  **정정 절차**: 곱 항등식은 **정수의 곱**에 대해 작동한다.  
  $$2=1^2+1^2,\ 65=15^2+10^2$$ 이므로
  $$
  130=(1^2+1^2)(15^2+10^2)=(15\pm 10)^2+(15\mp 10)^2=25^2+5^2\ \text{는 수치가 }650\ \text{이므로 잘못된 조합}.
  $$
  올바른 적용은 **벡터화**가 필요:  
  $$
  (a^2+b^2)(c^2+d^2)=(ac\pm bd)^2+(ad\mp bc)^2.
  $$
  여기서 \(a=b=1,\ c=15,\ d=10\):
  $$
  (ac+bd,\, ad-bc)=(15+10,\ 10-15)=(25,-5),\\
  (ac-bd,\, ad+bc)=(15-10,\ 10+15)=(5,25).
  $$
  두 결과 모두 **130이 아니라** \(25^2+(-5)^2=650\).  
  **원인**: \(65\) 자체가 두 제곱의 합이지만, **130=2\cdot 65** 에 항등식을 그대로 쓰면 곱이 \(2\cdot 65\) 가 아니라 \( (1^2+1^2)\cdot (15^2+10^2)= (1^2+1^2)\cdot 325\) 로 해석되는 오류.  
  바른 경로는 **직접 탐색** 또는 **가우스정수**에서
  $$
  130=(11+3i)(11-3i)\Rightarrow 130=11^2+3^2
  $$
  를 한 번에 확인하는 것.  
  → **최종 결론**: $$130=11^2+3^2= (±11)^2+(±3)^2$$ (순서·부호 포함 다수 표현).

> *메시지*: 항등식 적용은 **정확한 인수쌍**에만! 실제 계산에서는 가우스정수 GCD/코르나키아가 더 견고하다.

### 7.2 세 제곱 불가 & 네 제곱 가능: $$n=79$$
- \(79\equiv 7\ (\bmod 8)\) → **세 제곱 불가**.  
- 네 제곱 표현은 존재해야 한다.  
  간단 탐색:  
  $$\lfloor \sqrt{79}\rfloor=8,\ 79-8^2=15,$$
  $$15=3^2+1^2+1^2+0^2.$$
  따라서
  $$
  79=8^2+3^2+1^2+1^2.
  $$

---

## 8. 관련 주제(가벼운 메모)

- **워링 문제(Waring’s problem)**: 임의의 $$k\ge 2$$ 에 대해 “모든 자연수는 $$g(k)$$ 개의 $$k$$제곱의 합”으로 표현.  
  제곱의 경우는 **라그랑주 정리**가 정확히 $$g(2)=4$$ 임을 준다.

- **15 정리/290 정리**(자연수 전체를 나타내는 양의 정정부호 2차형의 분류)는 “넷 제곱의 합”을 넘어 **일반 이차형**의 보편성 문제를 완결한다.

---

## 9. 요약

1) **두 제곱의 합(페르마–가우스)**:  
   $$
   n=x^2+y^2\iff n\ \text{의 }(3\bmod 4)\ \text{소수의 지수가 모두 짝수}.
   $$
   닫힘성(브라흐마굽타–피보나치), 계산(가우스정수·코르나키아), 표현 수(자코비)까지 정밀하다.

2) **세 제곱의 합(레장드르)**:  
   $$
   n=x^2+y^2+z^2\iff n\not=4^a(8b+7).
   $$
   간단한 모듈러 필터로 **불가형**을 즉시 걸러낸다.

3) **네 제곱의 합(라그랑주)**:  
   $$
   \forall n\in\mathbb{N},\ \exists\ x_1,\dots,x_4\in\mathbb{Z}:\ n=\sum_{j=1}^4 x_j^2.
   $$
   오일러 항등식과 무한강하/격자기하로 증명. 표현 수는 **자코비 공식**:
   $$
   r_4(n)=8\sum_{4\nmid d\mid n} d.
   $$

> **큰 그림**: 두 제곱은 **대수적 분해(UFD, $$\mathbb{Z}[i]$$)** 가, 세 제곱은 **모듈러 패턴**이, 네 제곱은 **합성 항등식과 기하수론**이 지배한다.  
> 세 정리의 조합으로 “정수를 제곱들의 합으로 표현한다”는 주제는 **가능/불가능/개수/계산**의 네 축에서 거의 완결에 가깝게 정리되어 있다.