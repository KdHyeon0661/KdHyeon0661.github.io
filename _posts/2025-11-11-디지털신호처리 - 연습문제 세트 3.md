---
layout: post
title: 디지털신호처리 - 연습문제 세트 3
date: 2025-11-11 15:25:23 +0900
category: 디지털신호처리
---
# 연습문제 세트 3 — 양측 Z-변환·ROC·역변환·시스템·차분방정식

## 파트 A. 양측 Z-변환과 ROC (문제 1–6)

### 문제 1. (정의로 직접 계산 — 짧은 신호)

#### 1.1 문제 재진술
양측 Z-변환 정의로 $$X(z)$$ 를 직접 구하고, 단위원 위 값이 DTFT $$X(e^{j\omega})$$ 임을 확인하라.

주어진 신호:
- $$x[n]=\{1,-2,1\}$$ for $$n=0,1,2$$
- 그 외 $$x[n]=0$$

#### 1.2 양측 Z-변환 정의
양측 Z-변환:

$$
X(z)=\sum_{n=-\infty}^{\infty} x[n]z^{-n}.
$$

이 신호는 **유한 길이**이므로 합이 실제로는 3항만 남는다.

#### 1.3 직접 계산
$$
\begin{aligned}
X(z)
&=\sum_{n=-\infty}^{\infty} x[n]z^{-n}\\
&=x[0]z^0+x[1]z^{-1}+x[2]z^{-2}\\
&=1-2z^{-1}+z^{-2}.
\end{aligned}
$$

#### 1.4 DTFT와 연결
DTFT는 Z-변환을 단위원 $$z=e^{j\omega}$$ 위에서 평가한 것:

$$
X(e^{j\omega})=X(z)\big|_{z=e^{j\omega}}
=1-2e^{-j\omega}+e^{-j2\omega}.
$$

**직관**: Z-평면에서 “반지름 1인 원 위를 도는 값”이 DTFT 스펙트럼이다.

#### 1.5 ROC(수렴영역)
유한 길이(정확히는 유한 지지) 신호는  
$$X(z)$$ 가 유한 개의 항의 다항식이므로,
- $$z=0$$ 또는 $$z=\infty$$ 같이 정의가 깨지는 특이점만 제외하면  
  **모든 $$z$$ 에서 수렴**한다.

따라서 ROC는 “전체 평면(원점/무한대 제외)”이다.

#### 1.6 실습 포인트
- 유한 길이 신호는 ROC가 DTFT 존재성과 무관하게 단위원을 포함한다.
- 위상/크기도 함께 그려보면 더 강하게 이해됨.

**Octave (원본 유지)**

```octave
w=linspace(-pi,pi,2001);
X=1 - 2*exp(-1j*w) + exp(-1j*2*w);
plot(w,abs(X)); grid on; xlabel('\omega'); ylabel('|X|');
title('|X(e^{j\omega})| for x[n]={1,-2,1}');
```

---

### 문제 2. (우측 지수와 ROC)

#### 2.1 문제 재진술
$$x[n]=a^n u[n],\ |a|<1$$ 의 $$X(z)$$ 와 ROC를 구하고 단위원 포함 여부로 DTFT 존재를 판정하라.

#### 2.2 정의로 합 전개
$$u[n]$$ 때문에 $$n\ge 0$$ 만 남는다.

$$
\begin{aligned}
X(z)
&=\sum_{n=0}^{\infty} a^n z^{-n}\\
&=\sum_{n=0}^\infty (a z^{-1})^n.
\end{aligned}
$$

이는 비율 $$r=a z^{-1}$$ 인 등비급수.

#### 2.3 등비급수 합
수렴 조건 $$|r|<1$$ 즉 $$|az^{-1}|<1$$ 아래에서

$$
X(z)=\frac{1}{1-a z^{-1}}.
$$

#### 2.4 ROC
수렴 조건:

$$
|az^{-1}|<1
\ \Longleftrightarrow\
|z|>|a|.
$$

따라서 ROC는 **원점에서 바깥쪽**이다.

#### 2.5 단위원 포함과 DTFT 존재
DTFT 존재 조건: **단위원 $$|z|=1$$ 이 ROC에 들어야 한다.**

- ROC가 $$|z|>|a|$$ 이고
- $$|a|<1$$ 이므로 $$1>|a|$$

따라서 $$|z|=1$$ 은 ROC 내부.  
즉 DTFT가 존재한다.

**직관**: 우측 지수는 $$|a|<1$$ 이면 오른쪽으로 감쇠 → 절대수렴 → DTFT 존재.

#### 2.6 실습 포인트
- $$|a|<1$$ 이면 안정/DTFT OK
- $$|a|>1$$ 이면 ROC가 $$|z|>|a|>1$$ 되어 단위원 미포함 → DTFT 없음(문제 5와 연결).

**Octave (원본 유지)**

```octave
a=0.8; w=linspace(-pi,pi,4096);
X=1./(1 - a*exp(-1j*w));
plot(w,20*log10(abs(X)+1e-12)); grid on; 
xlabel('\omega'); ylabel('|X| dB'); title('DTFT magnitude');
```

---

### 문제 3. (좌측 지수와 ROC)

#### 3.1 문제 재진술
$$x[n]=-a^{n-1}u[-n-1]$$ 의 $$X(z)$$ 와 ROC를 구하라.

> 주의: 사용자가 제시한 해에는 **상수 스케일이 누락되어 있다.**  
> 아래에서 정의로 정확히 계산한 결과를 제시한다.

#### 3.2 신호 지지 구간
$$u[-n-1]=1 \iff -n-1\ge 0 \iff n\le -1.$$

즉 좌측(음의 방향) 신호.

#### 3.3 정의로 직접 계산
양측 정의:

$$
X(z)=\sum_{n=-\infty}^{-1} \big(-a^{n-1}\big) z^{-n}.
$$

치환 $$n=-m-1,\ m=0,1,2,\dots$$

- $$n-1=-m-2$$  
- $$a^{n-1}=a^{-m-2}=a^{-2}\,a^{-m}$$  
- $$z^{-n}=z^{m+1}$$

따라서

$$
\begin{aligned}
X(z)
&=\sum_{m=0}^{\infty} \left(-a^{-2}a^{-m}\right) z^{m+1}\\
&=-\frac{z}{a^2} \sum_{m=0}^{\infty} \left(\frac{z}{a}\right)^m.
\end{aligned}
$$

#### 3.4 등비급수 합과 결과
수렴 조건 $$\left|\frac{z}{a}\right|<1$$ 하에서

$$
X(z)=-\frac{z}{a^2}\cdot \frac{1}{1-\frac{z}{a}}
=-\frac{z}{a^2}\cdot \frac{a}{a-z}
=\frac{z}{a(z-a)}.
$$

즉

$$
\boxed{
X(z)=\frac{z}{a(z-a)}
}
$$

#### 3.5 ROC
등비급수 수렴 조건에서

$$
\left|\frac{z}{a}\right|<1
\iff |z|<|a|.
$$

따라서 ROC는 **원점 중심 안쪽**이다.

#### 3.6 단위원 포함성
단위원 $$|z|=1$$ 이 ROC에 들어가려면

$$
1<|a|.
$$

즉 $$|a|>1$$ 일 때만 DTFT 존재 가능.  
(좌측 신호는 “과거로 갈수록 감쇠”해야 단위원 포함)

---

### 문제 4. (양측 지수 합성)

#### 4.1 문제 재진술
$$x[n]=a_1^n u[-n-1]+a_2^n u[n],\ |a_1|<|a_2|$$  
의 $$X(z)$$ 와 ROC를 구하라.

#### 4.2 두 신호로 분해
$$x=x_L+x_R$$ 로 두고

- 좌측 성분: $$x_L[n]=a_1^n u[-n-1]$$  
- 우측 성분: $$x_R[n]=a_2^n u[n]$$

#### 4.3 각각의 Z-변환
1) 좌측:

잘 알려진 결과(문제3에서 스케일 없는 형태):

$$
\mathcal{Z}\{a^n u[-n-1]\}=-\frac{z}{z-a},
\quad \text{ROC: }|z|<|a|.
$$

따라서

$$
X_L(z)=\frac{z}{z-a_1},
\quad \text{ROC: }|z|<|a_1|.
$$

(부호는 정의에 따라 위 형태로 정리하면 된다.)

2) 우측:

$$
X_R(z)=\frac{1}{1-a_2 z^{-1}},
\quad \text{ROC: }|z|>|a_2|.
$$

#### 4.4 합성
$$
\boxed{
X(z)=\frac{z}{z-a_1}+\frac{1}{1-a_2 z^{-1}}
}
$$

#### 4.5 ROC(교집합)
양측 신호의 ROC는 **각 ROC의 교집합**.

- 좌측은 $$|z|<|a_1|$$
- 우측은 $$|z|>|a_2|$$

그런데 조건이 $$|a_1|<|a_2|$$ 이므로 교집합이

$$
\boxed{
|a_1|<|z|<|a_2|
}
$$

즉 두 원 사이의 **환대(annulus)** 가 ROC가 된다.

**직관**:  
양쪽 감쇠 조건을 동시에 만족해야 하므로 “안쪽도 안 되고, 바깥쪽도 안 되는” 중간 띠가 수렴영역.

---

### 문제 5. (단위원 위 수렴과 DTFT 존재)

#### 5.1 문제 재진술
$$x[n]=1.1^n u[n]$$ 의 DTFT 존재 여부를 판단하라.

#### 5.2 Z-변환과 ROC
우측 지수이므로

$$
X(z)=\frac{1}{1-1.1 z^{-1}},
\quad \text{ROC: }|z|>1.1.
$$

#### 5.3 단위원 포함성
단위원 $$|z|=1$$ 은 ROC 조건 $$|z|>1.1$$ 을 만족하지 못한다.

따라서 **DTFT가 존재하지 않는다.**

**직관**: 오른쪽으로 갈수록 커지는 신호는 절대수렴하지 못해 주파수 표현이 무너짐.

---

### 문제 6. (정의합 기반 수치 Z-변환)

#### 6.1 문제 재진술
임의의 양측 신호 $$x[n]$$ 에 대해, 반지름 $$R$$ 인 원 $$z=Re^{j\theta}$$ 를 따라 $$X(z)$$ 를 정의합으로 근사하여 그려라.

#### 6.2 수치 근사의 의미
양측 정의:

$$
X(z)=\sum_{n=-\infty}^{\infty} x[n]z^{-n}.
$$

실제 계산은 유한 구간 $$n\in[-N,N]$$ 으로 자른 근사:

$$
X_R(\theta)\approx \sum_{n=-N}^{N} x[n]\,(Re^{j\theta})^{-n}.
$$

- $$R=1$$ 이면 DTFT 근사.
- $$R\neq 1$$ 이면 단위원 밖/안에서의 Z-평면 응답을 본다.

#### 6.3 실습 코드(원본 유지)
```octave
n=-50:50; x=(0.9).^abs(n);      % 양측 감쇠 신호
R=1.0; theta=linspace(0,2*pi,2000); 
z=R*exp(1j*theta); X=zeros(size(z));

for k=1:numel(z)
  X(k)=sum( x .* (z(k)).^(-n) );
end

plot(theta,20*log10(abs(X)+1e-12)); grid on; 
xlabel('\theta'); ylabel('|X(z)| dB');
title(sprintf('|X(z)| along |z|=%.2f',R));
```

#### 6.4 추가 실험(여러 반지름 비교)
```octave
Rs=[0.7 1.0 1.3];
figure;
for i=1:numel(Rs)
  R=Rs(i); z=R*exp(1j*theta);
  for k=1:numel(z), X(k)=sum(x.*(z(k)).^(-n)); end
  plot(theta,20*log10(abs(X)+1e-12)); hold on;
end
grid on; legend('R=0.7','R=1.0','R=1.3');
title('Z-transform magnitude on different circles');
```

---

## 파트 B. Z-변환의 중요한 성질 (문제 7–12)

### 문제 7. (선형성)

#### 7.1 성질
선형성:

$$
\mathcal{Z}\{a x[n]+b y[n]\}=aX(z)+bY(z).
$$

#### 7.2 증명(정의 기반)
$$
\begin{aligned}
\mathcal{Z}\{a x+b y\}
&=\sum_n (a x[n]+b y[n])z^{-n}\\
&=a\sum_n x[n]z^{-n}+b\sum_n y[n]z^{-n}\\
&=aX(z)+bY(z).
\end{aligned}
$$

#### 7.3 실습 주의
- 코드에서 Z-변환은 실제로 `fft`로 “단위원 위 샘플”을 취한 것.  
  즉 Z-선형성 자체는 더 일반이지만, 수치로는 DTFT/DFT 값으로 확인하는 셈.

**Octave (원본 유지)**

```octave
x=[1 2 1]; y=[0 1 0]; a=2; b=-1;
N=4096; 
X=fft([x zeros(1,N-numel(x))]);
Y=fft([y zeros(1,N-numel(y))]);

L=fft([a*x + b*y zeros(1,N-numel(x))]);
R=a*X + b*Y;

printf("linearity error=%.2e\n", norm(L-R)/norm(L));
```

---

### 문제 8. (시간 시프트)

#### 8.1 성질
시간 이동:

$$
x[n-n_0]\ \longleftrightarrow\ z^{-n_0}X(z).
$$

#### 8.2 증명
$$
\begin{aligned}
\mathcal{Z}\{x[n-n_0]\}
&=\sum_n x[n-n_0] z^{-n}.
\end{aligned}
$$

치환 $$m=n-n_0$$:

$$
\sum_m x[m] z^{-(m+n_0)}
=z^{-n_0}\sum_m x[m]z^{-m}
=z^{-n_0}X(z).
$$

#### 8.3 ROC 변화
- 우측 신호는 ROC가 그대로(반지름 경계 동일).  
- 좌측 신호 역시 그대로.  
- **지연/이동은 ROC의 원반 경계는 바꾸지 않고, 단지 $$z^{-n_0}$$ 라는 “영점/극을 원점에 추가”하는 효과만 낸다.**

**Octave (원본 유지)**

```octave
x=hamming(41)'; n0=7; N=8192;
X=fft([x zeros(1,N-numel(x))]);

xs=circshift([x zeros(1,N-numel(x))],[0 n0]);
Xs=fft(xs);

w=2*pi*(0:N-1)/N; 
err=norm(Xs - X.*exp(-1j*w*n0))/norm(Xs);
printf("shift property error=%.2e\n", err);
```

---

### 문제 9. (지수 곱)

#### 9.1 성질
지수 가중:

$$
a^n x[n]\ \longleftrightarrow\ X\!\left(\frac{z}{a}\right).
$$

#### 9.2 정의로 증명
$$
\begin{aligned}
\tilde X(z)
&=\sum_n a^n x[n] z^{-n}\\
&=\sum_n x[n] (z/a)^{-n}\\
&=X(z/a).
\end{aligned}
$$

#### 9.3 해석(직관)
- 시간에서 지수를 곱하면  
  Z-평면에서 **반지름이 스케일링**된다.
- $$|a|<1$$ 이면 신호가 더 감쇠 → ROC가 단위원 쪽으로 넓어질 수 있다.  
  $$|a|>1$$ 이면 더 발산 → ROC가 바깥으로 밀린다.

#### 9.4 간단 수치 예
```octave
x=[1 2 1]; a=0.8; n=0:2;
xt = (a.^n).*x;

% Z를 단위원에서 샘플링하면 DTFT 비교 가능
w=linspace(-pi,pi,2048); 
X1 = x(1) + x(2)*exp(-1j*w) + x(3)*exp(-1j*2*w);
X2 = xt(1) + xt(2)*exp(-1j*w) + xt(3)*exp(-1j*2*w);

% 성질상 X2(w) = X1( w - j ln a )의 형태지만,
% 수치로는 정의합이 일치함을 확인하면 됨.
printf("rel diff on unit circle = %.2e\n", norm(X2-X1)/norm(X2));
```

---

### 문제 10. (가중 — $$-z\,dX/dz$$)

#### 10.1 성질
시간에서 n-가중:

$$
n x[n]\ \longleftrightarrow\ -z\frac{dX}{dz}.
$$

#### 10.2 정의 기반 증명
$$
X(z)=\sum_n x[n]z^{-n}.
$$

양변을 $$z$$ 로 미분:

$$
\frac{dX}{dz}
=\sum_n x[n]\frac{d}{dz}(z^{-n})
=\sum_n x[n](-n)z^{-n-1}.
$$

따라서

$$
-z\frac{dX}{dz}
=\sum_n n x[n]z^{-n}
=\mathcal{Z}\{n x[n]\}.
$$

#### 10.3 실습 주의
- 수치 미분은 잡음이 크므로 `gradient`로 충분히 촘촘히 샘플링해야 한다.
- $$z=Re^{j\theta}$$ 에서 미분하면 복소 곡선 미분이라 수치 오차가 생김.

**Octave (원본 유지)**

```octave
a=0.7; N=300; n=0:N-1; x=(a.^n);
R=1.0; th=linspace(0,2*pi,2000); z=R*exp(1j*th);
X=zeros(size(z)); Xn=zeros(size(z));
for k=1:numel(z)
  X(k)=sum(x.*(z(k)).^(-n));
  Xn(k)=sum((n.*x).*(z(k)).^(-n));
end
dXdz = gradient(X)./gradient(z);
rel = norm(Xn + z.*dXdz)/norm(Xn);
printf("n-weight identity error=%.2e\n", rel);
```

---

### 문제 11. (컨볼루션 정리)

#### 11.1 성질
시간 컨볼루션:

$$
y[n]=(x*h)[n]
\ \longleftrightarrow\
Y(z)=X(z)H(z).
$$

#### 11.2 증명 스케치
$$
y[n]=\sum_k x[k]h[n-k].
$$

Z-변환하면

$$
\begin{aligned}
Y(z)
&=\sum_n\left(\sum_k x[k]h[n-k]\right)z^{-n}\\
&=\sum_k x[k]z^{-k}\sum_m h[m]z^{-m}\\
&=X(z)H(z).
\end{aligned}
$$

(치환 $$m=n-k$$ 로 분리)

#### 11.3 실습 주의
- `conv(x,h,'same')` 은 길이를 입력과 같게 잘라내므로  
  FFT 기반 계산에서도 같은 길이로 자르지 않으면 차이가 난다.

**Octave (원본 유지)**

```octave
x=randn(1,1024); h=hamming(31)'; y=conv(x,h,'same');
N=2^nextpow2(numel(x)); 
yc=ifft(fft(x,N).*fft(h,N)); yc=yc(1:numel(y));
printf("conv theorem error=%.2e\n", norm(y - yc)/norm(y));
```

---

### 문제 12. (반전)

#### 12.1 성질
시간 반전:

$$
x[-n]
\ \longleftrightarrow\
X(z^{-1}).
$$

ROC는 “안쪽↔바깥쪽”이 뒤집힌다.

#### 12.2 정의로 증명
$$
\begin{aligned}
\mathcal{Z}\{x[-n]\}
&=\sum_n x[-n] z^{-n}.
\end{aligned}
$$

치환 $$m=-n$$:

$$
\sum_m x[m] z^{m}
= X(z^{-1}).
$$

#### 12.3 ROC 반전
예: $$x[n]=a^n u[n]$$

- 원래 ROC: $$|z|>|a|$$
- 반전 $$x[-n]=a^{-n}u[-n]$$ 의 ROC:

정의합:

$$
\sum_{n=-\infty}^{0} a^{-n}z^{-n}
=\sum_{m=0}^{\infty}(a z)^m
=\frac{1}{1-a z}
$$

수렴 조건 $$|az|<1 \Rightarrow |z|<1/|a|$$

즉

$$
\boxed{\text{ROC for }x[-n]:\ |z|<\frac{1}{|a|}}.
$$

#### 12.4 단위원 포함 비교
- 원래 단위원 포함 조건: $$1>|a|$$ (즉 $$|a|<1$$)
- 반전 단위원 포함 조건: $$1<1/|a|$$ (역시 $$|a|<1$$)

따라서 $$|a|<1$$ 이면 **원래도, 반전도 DTFT 존재**한다.

(사용자 원문에 “반전 ROC는 단위원 포함하지 않음” 취지의 문장이 있었는데,  
정확히는 $$|a|<1$$ 이면 반전 ROC가 $$|z|<1/|a|>1$$ 로 **단위원을 포함**한다.)

---

## 파트 C. 역 Z-변환 (문제 13–18)

### 문제 13. (부분분수 — 서로 다른 단일극)

#### 13.1 문제 재진술
$$
X(z)=\frac{1-0.5 z^{-1}}
{(1-0.8 z^{-1})(1-0.3 z^{-1})},
\quad \text{ROC: }|z|>0.8.
$$

역 Z-변환으로 $$x[n]$$ 을 구하라.

#### 13.2 인과/우측 해 판정
ROC가 $$|z|>0.8$$ 로 **바깥쪽**이므로 우측(인과) 확장.

즉 각 항은

$$
\frac{1}{1-p z^{-1}} \leftrightarrow p^n u[n]
$$

형태로 쓴다.

#### 13.3 부분분수 분해
가정:

$$
X(z)=
\frac{A}{1-0.8 z^{-1}}
+\frac{B}{1-0.3 z^{-1}}.
$$

양변에 분모를 곱하면

$$
1-0.5 z^{-1}
= A(1-0.3 z^{-1}) + B(1-0.8 z^{-1}).
$$

계수 비교:

- 상수항: $$1=A+B$$
- $$z^{-1}$$ 항: $$-0.5 = -0.3A - 0.8B$$

연립:

1) $$B=1-A$$  
2) $$0.5 = 0.3A + 0.8(1-A)=0.8-0.5A$$  
   $$0.5A=0.8-0.5=0.3 \Rightarrow A=0.6$$  
   $$B=0.4$$

#### 13.4 역변환
$$
\boxed{
x[n]=0.6(0.8)^n u[n]+0.4(0.3)^n u[n]
}
$$

#### 13.5 실습(원본 유지)
```octave
pkg load signal
b=[1 -0.5]; a=conv([1 -0.8],[1 -0.3]);
[r,p,k]=residuez(b,a); N=50; n=0:N-1;
x=zeros(size(n)); 
for i=1:numel(p), x+= r(i)*(p(i).^n); end
stem(n,x,'filled'); grid on; title('x[n] by partial fractions');
```

---

### 문제 14. (같은 형식, 다른 ROC → 양측 해)

#### 14.1 문제 재진술
문제 13과 같은 $$X(z)$$ 이지만 ROC가

$$
0.3<|z|<0.8
$$

일 때 $$x[n]$$ 을 구하라.

#### 14.2 ROC로 전개 방향 결정
각 극에 대해:

- 극 $$0.8$$ 에 해당하는 항은 ROC가 **안쪽**을 포함해야 좌측 전개  
  (왜냐하면 좌측 신호 ROC는 $$|z|<|p|$$)

- 극 $$0.3$$ 항은 ROC가 **바깥쪽**을 포함해야 우측 전개  
  (우측 신호 ROC는 $$|z|>|p|$$)

즉

$$
\frac{A}{1-0.8 z^{-1}} \Rightarrow \text{좌측 전개}\Rightarrow -A(0.8)^n u[-n-1]
$$

$$
\frac{B}{1-0.3 z^{-1}} \Rightarrow \text{우측 전개}\Rightarrow B(0.3)^n u[n].
$$

#### 14.3 계수는 문제 13과 동일
부분분수 계수는 ROC와 무관하게 같다:

- $$A=0.6$$
- $$B=0.4$$

#### 14.4 결과
$$
\boxed{
x[n]=
-0.6(0.8)^n u[-n-1]
+0.4(0.3)^n u[n]
}
$$

**직관**: 같은 $$X(z)$$ 라도 ROC가 달라지면 “과거/미래로 어느 쪽 전개냐”가 바뀌어 시간신호가 완전히 달라진다.

---

### 문제 15. (중복극)

#### 15.1 문제 재진술
$$
X(z)=\frac{z^{-2}}{(1-0.9 z^{-1})^2},\quad \text{ROC: }|z|>0.9.
$$

역 Z-변환.

#### 15.2 기본쌍
중복극 기본쌍:

$$
\frac{1}{(1-p z^{-1})^2}
\leftrightarrow
(n+1)p^n u[n].
$$

#### 15.3 시프트 포함 처리
주어진 $$X(z)$$ 는 위 기본쌍에 $$z^{-2}$$ 가 곱해진 형태.

먼저

$$
g[n]=(n+1)0.9^n u[n]
\leftrightarrow
\frac{1}{(1-0.9 z^{-1})^2}.
$$

시간 시프트 성질:

$$
z^{-2}G(z)\leftrightarrow g[n-2].
$$

따라서

$$
x[n]=g[n-2]
=(n-1)0.9^{n-2}u[n-2].
$$

#### 15.4 결과
$$
\boxed{
x[n]=(n-1)0.9^{n-2}u[n-2]
}
$$

#### 15.5 실습(원본 유지)
```octave
b=[1 0 0]; a=conv([1 -0.9],[1 -0.9]); 
N=60; n=0:N-1;
x_imp=impz(b,a,N);
x_form=zeros(size(n)); idx=find(n>=2); 
x_form(idx)=(n(idx)-1).*(0.9.^(n(idx)-2));
printf("RMS=%.2e\n", rms(x_imp - x_form));
```

---

### 문제 16. (복소 공켤레 극쌍)

#### 16.1 문제 재진술
$$
X(z)=\frac{1}{1-2r\cos\omega_0\, z^{-1}+r^2 z^{-2}}.
$$

#### 16.2 분모의 의미
분모는 극이

$$
z=r e^{\pm j\omega_0}
$$

인 2차 시스템을 뜻한다.

#### 16.3 표준 역변환
기본쌍:

$$
\frac{1}{1-2r\cos\omega_0\, z^{-1}+r^2 z^{-2}}
\leftrightarrow
\frac{\sin((n+1)\omega_0)}{\sin\omega_0}\, r^n u[n].
$$

#### 16.4 직관
- 반경 $$r<1$$ 이면 감쇠 진동(안정)
- $$r\approx 1$$ 이면 거의 지속 진동(고 Q)

#### 16.5 실습(원본 유지)
```octave
r=0.95; w0=0.3*pi; a=[1 -2*r*cos(w0) r^2]; b=1;
N=100; n=0:N-1; x_imp=impz(b,a,N);
x_form=(sin((n+1)*w0)/sin(w0)).*(r.^n);
printf("RMS=%.2e\n", rms(x_imp - x_form));
```

---

### 문제 17. (비정상형 → 다항 나눗셈)

#### 17.1 문제 재진술
$$
X(z)=1+0.5 z^{-1} + \frac{z^{-2}}{1-0.8 z^{-1}}.
$$

#### 17.2 분리
다항부(직접 역변환 가능) + 진짜 유리부로 나눈다.

- $$1 \leftrightarrow \delta[n]$$  
- $$0.5 z^{-1}\leftrightarrow 0.5\delta[n-1]$$  
- 유리부는 시프트된 우측 지수.

#### 17.3 유리부 역변환
먼저

$$
\frac{1}{1-0.8 z^{-1}}\leftrightarrow 0.8^n u[n].
$$

$$z^{-2}$$ 곱이므로 2샘플 지연:

$$
0.8^{n-2}u[n-2].
$$

#### 17.4 결과
$$
\boxed{
x[n]=\delta[n]+0.5\delta[n-1]+0.8^{n-2}u[n-2]
}
$$

---

### 문제 18. (잔여정리 스케치)

#### 18.1 컨투어 적분 역변환
양측 역변환:

$$
x[n]=\frac{1}{2\pi j}\oint_C X(z) z^{n-1}\,dz.
$$

- $$C$$ 는 ROC 내부에서 한 바퀴 도는 폐곡선.
- 적분값은 내부 극에서의 잔여 합.

#### 18.2 문제 13의 경우
극:

$$
z=0.8,\quad z=0.3.
$$

따라서

$$
x[n]
=
\sum_{\text{poles }p_i\in C}
\operatorname{Res}\left(X(z)z^{n-1},\, z=p_i\right).
$$

ROC가 $$|z|>0.8$$ 이므로  
일반적으로 큰 원을 잡아 두 극을 포함시키면 우측 해가 나온다.

잔여 계산을 하면 문제 13과 같은 계수(0.6,0.4)가 복원된다.

---

## 파트 D. z-영역 시스템 표현 (문제 19–24)

### 문제 19. (LCCDE → $$H(z)$$)

#### 19.1 문제 재진술
$$
y[n]-0.8y[n-1]+0.15y[n-2]=x[n]-0.5x[n-1].
$$

전달함수 $$H(z)$$, 극/영점, 안정/인과 여부.

#### 19.2 Z-변환 적용(초기조건 0 가정: 제로상태)
$$
Y(z)-0.8z^{-1}Y(z)+0.15z^{-2}Y(z)=X(z)-0.5z^{-1}X(z).
$$

#### 19.3 $$H(z)$$
$$
\boxed{
H(z)=\frac{Y(z)}{X(z)}
=\frac{1-0.5z^{-1}}
{1-0.8z^{-1}+0.15z^{-2}}
}
$$

#### 19.4 극/영점
- 영점: 분자 $$1-0.5z^{-1}=0 \Rightarrow z=0.5$$
- 극: $$1-0.8z^{-1}+0.15z^{-2}=0$$ 를 풀어 얻음.

극이 단위원 안이면 안정, ROC가 바깥 포함이면 인과.

#### 19.5 실습(원본 유지)
```octave
b=[1 -0.5]; a=[1 -0.8 0.15];
[H,w]=freqz(b,a,4096);
subplot(2,1,1); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
subplot(2,1,2); plot(w/pi,unwrap(angle(H))); grid on; title('∠H');
```

---

### 문제 20. (극/영점 도표와 응답 직관)

#### 20.1 직관 규칙
- 단위원 근처의 **극(pole)** 은 해당 각 주파수에서 이득을 크게 만든다.
- 단위원 근처의 **영점(zero)** 은 해당 주파수에서 감쇠/노치를 만든다.
- 반경이 1보다 작은 극은 안정적 감쇠.

#### 20.2 실습(원본 유지)
```octave
z=roots(fliplr([1 -0.5])); 
p=roots(fliplr([1 -0.8 0.15]));
th=linspace(0,2*pi,600); 
plot(cos(th),sin(th),'k--'); hold on
plot(real(z),imag(z),'ob'); 
plot(real(p),imag(p),'xr'); axis equal; grid on
legend('unit','zeros','poles'); title('z-plane');
```

---

### 문제 21. (직렬/병렬 합성)

#### 21.1 직렬
$$
H_s(z)=H_1(z)H_2(z).
$$

다항식으로는

$$
B_s = B_1 * B_2,\quad A_s = A_1 * A_2.
$$

#### 21.2 병렬
$$
H_p(z)=\alpha H_1(z)+\beta H_2(z)
=\frac{\alpha B_1 A_2+\beta B_2 A_1}{A_1A_2}.
$$

#### 21.3 실습(원본 유지)
```octave
[b1,a1]=butter(3,0.4); 
[b2,a2]=cheby1(3,1,0.3);
bS=conv(b1,b2); aS=conv(a1,a2);
[HS,w]=freqz(bS,aS,4096); 
plot(w/pi,20*log10(abs(HS)+1e-12)); grid on
title('Series-combined response');
```

---

### 문제 22. (피드백 합성)

#### 22.1 기본 공식
단일 음의 피드백(폐루프):

$$
H(z)=\frac{G(z)}{1+G(z)F(z)}.
$$

#### 22.2 다항식 형태
$$
G=\frac{B_G}{A_G},\quad F=\frac{B_F}{A_F}.
$$

그러면

$$
H
=
\frac{B_G A_F}{A_G A_F + B_G B_F}.
$$

특히 $$F=1$$ 이면 $$A_F=1,\ B_F=1$$

$$
\boxed{
H=\frac{B_G}{A_G+B_G}.
}
$$

#### 22.3 실습(개념 시연, 원본 유지)
```octave
[bG,aG]=butter(2,0.5); bF=1; aF=1;

% F=1이면 H = BG / (AG + BG)
bFB=bG; 
aFB = aG + bG;  

[H,w]=freqz(bFB,aFB,2048); 
plot(w/pi,abs(H)); grid on; title('Closed-loop |H|');
```

---

### 문제 23. (FIR 선형위상과 군지연)

#### 23.1 핵심 성질
선형위상 FIR(대칭 계수)에서 위상은

$$
\phi(\omega)\approx -\omega\frac{N-1}{2}.
$$

따라서 군지연

$$
\tau_g(\omega)= -\frac{d\phi}{d\omega}\approx \frac{N-1}{2}.
$$

#### 23.2 실습(원본 유지)
```octave
N=101; b=fir1(N-1,0.3,hamming(N)); a=1;
[H,w]=freqz(b,a,4096); 
phi=unwrap(angle(H)); 
tau=-gradient(phi)./gradient(w);
printf("mean τg≈%.2f theory=%.2f\n", mean(tau), (N-1)/2);
```

#### 23.3 함정
- FIR이 **정확히 대칭**이어야 위 군지연이 일정해진다.
- 창 설계가 아닌 임의 FIR이면 군지연이 주파수에 따라 변할 수 있음.

---

### 문제 24. (안정/인과 판정)

#### 24.1 문제 재진술
$$
H(z)=\frac{1}{1-1.02 z^{-1}+0.5 z^{-2}}.
$$

안정/인과 여부 판정.

#### 24.2 극의 반경
안정 조건(BIBO):

$$
\text{모든 극 }p_i\text{ 가 }|p_i|<1.
$$

인과 조건:

- 전달함수가 유리형일 때  
  ROC가 **무한대를 포함**하면 인과.
- 일반적으로 인과 시스템의 ROC는 **가장 바깥 극 밖**이다.

#### 24.3 실습(원본 유지)
```octave
a=[1 -1.02 0.5]; 
p=roots(fliplr(a)); 
disp([p abs(p)]);
```

출력된 $$|p_i|$$ 중 1 이상이 있으면 불안정.  
1에 매우 근접하면 감쇠가 매우 느려 “거의 진동 유지”처럼 보일 수 있음.

---

## 파트 E. 차분 방정식의 해 (문제 25–36)

### 문제 25. (동차해 — 서로 다른 근)

#### 25.1 문제 재진술
$$
y[n]-1.1 y[n-1]+0.24 y[n-2]=0.
$$

#### 25.2 특성방정식
$$
r^2-1.1r+0.24=0.
$$

근:

$$
r_{1,2}=\frac{1.1\pm\sqrt{1.21-0.96}}{2}
=\frac{1.1\pm 0.5}{2}
\Rightarrow r_1=0.8,\ r_2=0.3.
$$

#### 25.3 동차해
$$
\boxed{
y_h[n]=C_1(0.8)^n+C_2(0.3)^n.
}
$$

---

### 문제 26. (중복근)

#### 26.1 문제 재진술
$$
y[n]-1.2 y[n-1]+0.36 y[n-2]=0.
$$

#### 26.2 특성방정식과 중복근
$$
r^2-1.2r+0.36=0
\Rightarrow (r-0.6)^2=0.
$$

중복근 $$r=0.6$$.

#### 26.3 동차해
중복근일 때 표준해:

$$
\boxed{
y_h[n]=(C_1+C_2 n)\,0.6^n.
}
$$

---

### 문제 27. (복소근)

#### 27.1 문제 재진술
$$
y[n]-2\rho\cos\omega_0\, y[n-1]+\rho^2 y[n-2]=0.
$$

#### 27.2 근
특성방정식:

$$
r^2-2\rho\cos\omega_0\,r+\rho^2=0
\Rightarrow r=\rho e^{\pm j\omega_0}.
$$

#### 27.3 동차해
복소 공켤레근이면 실수해는 감쇠 사인/코사인:

$$
\boxed{
y_h[n]=\rho^n(A\cos\omega_0 n+B\sin\omega_0 n).
}
$$

---

### 문제 28. (특정계수법 — 지수 입력)

#### 28.1 문제 재진술
$$
y[n]-0.8y[n-1]=2(0.5)^n u[n],\quad y[-1]=0.
$$

#### 28.2 특해 가정
우변이 $$0.5^n$$ 이므로

$$
y_p[n]=K(0.5)^n.
$$

특성근은 0.8이므로 **충돌 없음**.

#### 28.3 대입
$$
K(0.5)^n-0.8K(0.5)^{n-1}=2(0.5)^n.
$$

양변을 $$(0.5)^{n-1}$$ 로 나누면

$$
0.5K-0.8K=2\cdot 0.5
\Rightarrow -0.3K=1
\Rightarrow K=-\frac{10}{3}.
$$

#### 28.4 완전해
$$
y[n]=C(0.8)^n u[n] -\frac{10}{3}(0.5)^n u[n].
$$

초기조건 $$y[-1]=0$$ 로 $$C$$ 결정 가능.

#### 28.5 실습(원본 유지)
```octave
a=[1 -0.8]; b=[2]; N=80; n=0:N-1; x=(0.5).^n;
y=filter(b,a,x);
plot(n,y,'k.-'); grid on; title('특정계수법 지수 입력');
```

---

### 문제 29. (특정계수법 — 충돌)

#### 29.1 문제 재진술
$$
y[n]-0.5y[n-1]=(0.5)^n u[n],\quad y[-1]=0.
$$

#### 29.2 충돌 판단
특성근 $$r=0.5$$ 와 입력 지수 $$0.5^n$$ 가 동일 → 충돌.

#### 29.3 특해 가정
충돌 시 $$n$$ 을 곱해 독립성 확보:

$$
y_p[n]=K\,n(0.5)^n.
$$

대입해 $$K$$ 를 구하면 된다.

---

### 문제 30. (사인 입력)

#### 30.1 문제 재진술
$$
y[n]-1.2 y[n-1]+0.36 y[n-2]=\cos(0.3\pi n)u[n],
\quad y[-1]=y[-2]=0.
$$

#### 30.2 정상상태는 주파수응답으로 바로 구할 수 있음
LTI 시스템에서 사인 입력의 정상상태는

$$
y_{ss}[n]=|H(e^{j\omega_0})|\cos(\omega_0 n+\angle H(e^{j\omega_0})).
$$

특정계수법으로 풀어도 같은 결과로 수렴해야 한다.

#### 30.3 실습(원본 유지)
```octave
pkg load signal
a=[1 -1.2 0.36]; b=[1 0 0]; N=120; n=0:N-1; x=cos(0.3*pi*n);
y=filter(b,a,x);
H0=freqz(b,a,0.3*pi); 
yss=abs(H0)*cos(0.3*pi*n + angle(H0));
plot(n,y,'k'); hold on; plot(n,yss,'r--'); 
grid on; legend('y','steady-state');
```

---

### 문제 31. (단위계단 입력과 최종값)

#### 31.1 문제 재진술
$$
y[n]-0.7y[n-1]=u[n],\quad y[-1]=0.
$$

최종값과 수치 검증.

#### 31.2 최종값
정상상태에서 $$y[n]=K$$ 로 가정:

$$
K-0.7K=1 \Rightarrow 0.3K=1 \Rightarrow K=\frac{1}{0.3}.
$$

#### 31.3 실습(원본 유지)
```octave
a=[1 -0.7]; b=[1]; N=100; n=0:N-1; x=ones(1,N);
y=filter(b,a,x); 
plot(n,y,'k.-'); hold on; 
yline(1/(1-0.7),'r--'); grid on;
title('Step response final value');
```

---

### 문제 32. (컨볼루션 해)

#### 32.1 핵심
초기조건이 0인 LTI 시스템에서

$$
y=x*h
$$

이며, `filter` 결과와 `conv` 결과가 같아야 한다.

**Octave (원본 유지)**

```octave
[b,a]=butter(3,0.3); N=256; x=randn(1,N); h=impz(b,a,N);
y1=filter(b,a,x); y2=conv(x,h); y2=y2(1:N);
printf("RMS=%.2e\n", rms(y1-y2));
```

---

### 문제 33. (Z-변환 해법 — 초기조건 없는 경우)

#### 33.1 문제 재진술
$$
y[n]-1.1 y[n-1]+0.24 y[n-2]=x[n],\quad x[n]=\delta[n].
$$

#### 33.2 제로상태 해
$$
Y(z)=H(z)X(z),\quad X(z)=1.
$$

따라서

$$
y[n]=h[n].
$$

즉 시스템 임펄스응답이 곧 해.

---

### 문제 34. (Z-변환 해법 — 초기조건 포함)

#### 34.1 핵심
초기조건이 있으면

$$
y = y_{ZI}+y_{ZS}
$$

- 제로입력(동차) 성분 $$y_{ZI}$$ 가 초기조건 만족.
- 제로상태 성분 $$y_{ZS}=h*x$$.

따라서 초기조건을 동차해 상수로 흡수해 분리하면 된다.

---

### 문제 35. (상태공간 해)

#### 35.1 핵심
2차 LCCDE를 상태로 만들면

$$
\mathbf{x}[n+1]=A\mathbf{x}[n]+B u[n],\quad y[n]=C\mathbf{x}[n]+D u[n].
$$

시뮬레이션 출력이 `filter`와 같아야 한다.

**Octave (원본 유지)**

```octave
a1=1.1; a2=-0.24; b0=1;
A=[a1 a2; 1 0]; B=[b0;0]; C=[1 0]; D=0;
N=60; n=0:N-1; x=(0.5).^n; xst=zeros(2,1); yss=zeros(1,N);
for k=1:N
  yss(k)=C*xst + D*x(k); 
  xst=A*xst + B*x(k); 
end
a=[1 -a1 -a2]; b=[b0 0 0]; y=filter(b,a,x);
printf("RMS=%.2e\n", rms(y - yss));
```

---

### 문제 36. (안정성/점근 안정)

#### 36.1 증명 요지
동차해는 근들의 거듭제곱 합:

$$
y_h[n]=\sum_i C_i r_i^n
\quad(\text{중복근이면 }n r^n\text{ 포함}).
$$

- $$|r_i|<1 \Rightarrow r_i^n\to 0$$  
- 중복근도 $$|r|<1$$ 이면 $$n r^n\to 0$$.

따라서 **특성근 반경이 모두 1보다 작으면 점근 안정**.

#### 36.2 단위원 근접 시 현상
- $$|r|\approx 1$$ : 감쇠가 매우 느려 과도응답이 길고  
  진동이 오래 지속.
- $$|r|>1$$ : 발산(불안정).

---

## 파트 F. 종합 프로젝트형 문제 (문제 37–40)

### 문제 37. (ROC로 시간영역 해 판별)

#### 37.1 문제 재진술
$$
X(z)=\frac{1}{1-0.8 z^{-1}}+\frac{z}{z-0.5}.
$$

ROC를
1) $$|z|>0.8$$  
2) $$|z|<0.5$$  
3) $$0.5<|z|<0.8$$  
로 둘 때 각각 $$x[n]$$ 을 구하라.

#### 37.2 각 항의 기본쌍
1) 첫 항:

$$
\frac{1}{1-0.8 z^{-1}}
\leftrightarrow
\begin{cases}
0.8^n u[n], & |z|>0.8\\
-0.8^n u[-n-1], & |z|<0.8
\end{cases}
$$

2) 둘째 항:

$$
\frac{z}{z-0.5}
=
\frac{1}{1-0.5 z^{-1}}
\leftrightarrow
\begin{cases}
0.5^n u[n], & |z|>0.5\\
-0.5^n u[-n-1], & |z|<0.5
\end{cases}
$$

#### 37.3 ROC별 조합
(i) $$|z|>0.8$$  
- 첫 항: 우측(ROC 밖) → $$0.8^n u[n]$$  
- 둘째 항: ROC가 $$|z|>0.8$$ 이면 자동으로 $$|z|>0.5$$ 포함 → 우측  
  $$0.5^n u[n]$$

$$
\boxed{
x[n]=0.8^n u[n]+0.5^n u[n]
}
$$

(ii) $$|z|<0.5$$  
- 첫 항: ROC가 $$|z|<0.5<0.8$$ → 좌측 전개  
  $$-0.8^n u[-n-1]$$  
- 둘째 항: ROC $$|z|<0.5$$ → 좌측 전개  
  $$-0.5^n u[-n-1]$$

$$
\boxed{
x[n]= -0.8^n u[-n-1]-0.5^n u[-n-1]
}
$$

(iii) $$0.5<|z|<0.8$$  
- 첫 항: ROC가 $$|z|<0.8$$ 포함 → 좌측  
  $$-0.8^n u[-n-1]$$  
- 둘째 항: ROC가 $$|z|>0.5$$ 포함 → 우측  
  $$0.5^n u[n]$$

$$
\boxed{
x[n]= -0.8^n u[-n-1]+0.5^n u[n]
}
$$

---

### 문제 38. (필터 합성과 응답 타겟팅)

#### 38.1 문제 재진술
$$\omega_0=0.4\pi$$ 에서 노치(notch)가 되도록  
영점을 단위원 위 $$e^{\pm j\omega_0}$$ 에 배치하고,  
극 반경 $$r<1$$ 로 Q를 조절하라.

#### 38.2 설계 원리
- 단위원 위의 영점은 해당 주파수에서 완전 소거(노치).
- 같은 각도에 반경 $$r$$ 의 극을 두면 노치 주변 대역의 폭(Q)이 조절된다.
  - $$r\to 1$$ : 노치가 매우 날카로움(Q 증가)
  - $$r$$ 작음 : 노치가 넓어짐(Q 감소)

#### 38.3 전달함수
영점 다항식:

$$
B(z)=1-2\cos\omega_0\,z^{-1}+z^{-2}.
$$

극 다항식:

$$
A(z)=1-2r\cos\omega_0\,z^{-1}+r^2 z^{-2}.
$$

#### 38.4 실습(원본 유지)
```octave
w0=0.4*pi; 
z0=[exp(1j*w0), exp(-1j*w0)]; 
b=poly(z0);              % zeros on unit circle
r=0.95; p0=r*z0; a=poly(p0);

[H,w]=freqz(b,a,4096); 
plot(w/pi,20*log10(abs(H)+1e-12)); grid on
xlabel('\omega/\pi'); ylabel('dB');
title('Notch filter by pole-zero placement');
```

---

### 문제 39. (특정계수법 vs 주파수응답)

#### 39.1 문제 재진술
$$
y[n]-0.7y[n-1]=\cos(0.25\pi n)u[n].
$$

특정계수법의 정상상태와 $$H(e^{j\omega_0})$$ 기반 정상상태가 일치함을 보여라.

#### 39.2 주파수응답 방법
$$
H(z)=\frac{1}{1-0.7 z^{-1}}.
$$

따라서

$$
H(e^{j\omega_0})
=\frac{1}{1-0.7e^{-j\omega_0}}.
$$

정상상태:

$$
y_{ss}[n]=|H(e^{j\omega_0})|\cos(\omega_0 n+\angle H(e^{j\omega_0})).
$$

#### 39.3 실습(원본 유지)
```octave
a=[1 -0.7]; b=[1]; w0=0.25*pi; 
N=200; n=0:N-1; x=cos(w0*n);
y=filter(b,a,x); 
H0=freqz(b,a,w0); 
yss=abs(H0)*cos(w0*n + angle(H0));
plot(n,y,'k'); hold on; plot(n,yss,'r--'); 
grid on; legend('sim','H-based');
title('Steady-state check');
```

---

### 문제 40. (역 Z-변환 자동 채점기)

#### 40.1 목표
부분분수 기반 역변환 결과와 실제 임펄스응답 `impz` 를 비교해 RMS 오차를 출력하는 자동 검증기.

#### 40.2 실습(원본 유지)
```octave
function rms_err = iz_checker(b,a,N)
  [r,p,k]=residuez(b,a); 
  n=0:N-1; hpf=zeros(size(n));
  for i=1:numel(p)
    hpf += r(i)*(p(i).^n); 
  end
  h=impz(b,a,N); 
  rms_err=rms(h - hpf);
endfunction

printf("err=%.2e\n", iz_checker([1 -0.5], [1 -0.8 0.15], 80));
```

---

## 마무리 체크리스트(확장)

1) **양측 Z와 ROC**
- 우측: $$|z|>|p_{\max}|$$  
- 좌측: $$|z|<|p_{\min}|$$  
- 양측: $$|p_1|<|z|<|p_2|$$  
- DTFT 존재 ⇔ **단위원 포함**

2) **Z-변환 성질**
- 선형성  
- 시간 시프트  
- 지수 곱(축 스케일링)  
- n-가중(미분)  
- 컨볼루션 정리  
- 반전(ROC 뒤집힘)

3) **역 Z-변환**
- 부분분수 + ROC로 전개 방향 결정  
- 중복극: $$ (1-pz^{-1})^{-2}\leftrightarrow (n+1)p^n u[n] $$  
- 복소극쌍: 감쇠 사인/코사인  
- 다항 나눗셈으로 직접항 분리  
- 잔여정리(컨투어 적분)

4) **z-영역 시스템**
- LCCDE → $$H(z)=B(z)/A(z)$$  
- 극/영점 위치로 안정/인과/주파수응답 직관  
- 직렬/병렬/피드백 합성  
- FIR 선형위상 군지연

5) **차분방정식 해**
- 동차해: 특성근 구조(서로다른/중복/복소)  
- 특정계수법: 충돌 시 $$n$$ 승수  
- 정상상태는 $$H(e^{j\omega_0})$$ 로 즉시 계산 가능  
- 컨볼루션/상태공간/일측 Z로 교차 검증