---
layout: post
title: 디지털신호처리 - 연습문제 세트 3
date: 2025-11-11 15:25:23 +0900
category: 디지털신호처리
---
# 연습문제 세트 3

## 파트 A. 양측 Z-변환과 ROC (문제 1–6)

### 문제 1. (정의로 직접 계산 — 짧은 신호)

**목표**: 양측 정의에 따라 \(X(z)\)를 구하고 DTFT와의 연결 확인
**문제**: \(x[n]=\{1, -2, 1\}\) for \(n=0,1,2\). \(X(z)\)와 \(X(e^{j\omega})\)를 구하라.
**풀이**:
$$
X(z)=1-2z^{-1}+z^{-2},\quad X(e^{j\omega})=1-2e^{-j\omega}+e^{-j2\omega}.
$$
ROC는 전체(원점/무한대 제외).
**Octave**:
```octave
w=linspace(-pi,pi,2001);
X=1 - 2*exp(-1j*w) + exp(-1j*2*w);
plot(w,abs(X)); grid on; xlabel('\omega'); ylabel('|X|');
```

---

### 문제 2. (우측 지수와 ROC)

**목표**: 우측/좌측/양측 ROC 구분
**문제**: \(x[n]=a^n u[n]\), \(|a|<1\). \(X(z)\)와 ROC를 쓰고, 단위원 포함 여부를 판정하라.
**풀이**:
$$
X(z)=\sum_{n=0}^\infty (a z^{-1})^n = \frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|>|a|.
$$
\(|a|<1\)이면 단위원 \(|z|=1\)이 ROC에 포함 → DTFT 존재.
**Octave**:
```octave
a=0.8; w=linspace(-pi,pi,4096); X=1./(1 - a*exp(-1j*w));
plot(w,20*log10(abs(X)+1e-12)); grid on; title('DTFT magnitude[dB]');
```

---

### 문제 3. (좌측 지수와 ROC)

**목표**: 좌측 신호의 전개
**문제**: \(x[n]=-a^{n-1}u[-n-1]\). \(X(z)\), ROC?
**풀이**:
$$
X(z)=\frac{-z}{z-a},\quad \text{ROC: }|z|<|a|.
$$
단위원 포함성은 \(|a|>1\)일 때만 가능.

---

### 문제 4. (양측 지수 합성)

**목표**: 환대 ROC
**문제**: \(x[n]=a_1^n u[-n-1]+a_2^n u[n]\), \(|a_1|<|a_2|\). \(X(z)\), ROC?
**풀이**:
$$
X(z)=\frac{z}{z-a_1}+\frac{1}{1-a_2 z^{-1}},\quad \text{ROC: }|a_1|<|z|<|a_2|.
$$

---

### 문제 5. (단위원 위 수렴과 DTFT 존재)

**목표**: DTFT 존재 조건
**문제**: \(x[n]=1.1^n u[n]\). DTFT 존재 여부?
**풀이**: ROC: \(|z|>1.1\). 단위원 \(|z|=1\) 미포함 → DTFT 존재하지 않음.

---

### 문제 6. (정의합 기반 수치 Z-변환)

**목표**: \(z\)-원 둘레에서 정의합 근사
**문제/Octave**: 임의 신호 \(x[n]\)에서 \(|z|=R\) 원을 따라 \(X(z)\) 그려보기.
```octave
n=-50:50; x=(0.9).^abs(n);      % 양측 유한 근사
R=1.0; theta=linspace(0,2*pi,2000); z=R*exp(1j*theta); X=zeros(size(z));
for k=1:numel(z), X(k)=sum( x .* (z(k)).^(-n) ); end
plot(theta,20*log10(abs(X)+1e-12)); grid on; xlabel('\theta'); ylabel('|X(z)| dB');
```

---

## 파트 B. Z-변환의 중요한 성질 (문제 7–12)

### 문제 7. (선형성)

**목표**: \(\mathcal{Z}\{ax+by\}=aX+bY\) 수치 검증
**문제/Octave**:
```octave
x=[1 2 1]; y=[0 1 0]; a=2; b=-1;
N=4096; X=fft([x zeros(1,N-numel(x))]);
Y=fft([y zeros(1,N-numel(y))]);
L=fft([a*x + b*y zeros(1,N-numel(x))]);
R=a*X + b*Y;
printf("linearity error=%.2e\n", norm(L-R)/norm(L));
```

---

### 문제 8. (시간 시프트)

**목표**: \(x[n-n_0]\leftrightarrow z^{-n_0}X(z)\)
**문제/Octave**:
```octave
x=hamming(41)'; n0=7; N=8192;
X=fft([x zeros(1,N-numel(x))]);
xs=circshift([x zeros(1,N-numel(x))],[0 n0]);
Xs=fft(xs);
w=2*pi*(0:N-1)/N; err=norm(Xs - X.*exp(-1j*w*n0))/norm(Xs);
printf("shift property error=%.2e\n", err);
```

---

### 문제 9. (지수 곱)

**목표**: \(a^n x[n]\leftrightarrow X(z/a)\)
**문제**: \(x[n]=\{1,2,1\}\), \(a=0.8\). 좌우 비교.
**스케치**: 직접합 정의로 ```latex \(\tilde X(z)=\sum x[n](az^{-1})^n = X(z/a)\)```

---

### 가중 — \( -z\,dX/dz\))

**목표**: \(\mathcal{Z}\{n x[n]\}=-z\dfrac{dX}{dz}\)
**문제/Octave(수치 미분)**:
```octave
a=0.7; N=300; n=0:N-1; x=(a.^n);
R=1.0; th=linspace(0,2*pi,2000); z=R*exp(1j*th);
X=zeros(size(z)); Xn=zeros(size(z));
for k=1:numel(z)
  X(k)=sum(x.*(z(k)).^(-n));
  Xn(k)=sum((n.*x).*(z(k)).^(-n));
end
dXdz = gradient(X)./gradient(z);
rel = norm(Xn + z.*dXdz)/norm(Xn);
printf("n-weight identity error=%.2e\n", rel);
```

---

### 문제 11. (컨볼루션 정리)

**목표**: \((x*h)\leftrightarrow XH\)
**문제/Octave**:
```octave
x=randn(1,1024); h=hamming(31)'; y=conv(x,h,'same');
N=2^nextpow2(numel(x)); yc=ifft(fft(x,N).*fft(h,N)); yc=yc(1:numel(y));
printf("conv theorem error=%.2e\n", norm(y - yc)/norm(y));
```

---

### 문제 12. (반전)

**목표**: \(x[-n]\leftrightarrow X(z^{-1})\)와 ROC 반전
**문제**: \(x[n]=a^n u[n]\)의 반전 \(x[-n]\)에 대한 ROC를 서술하고, 단위원 포함 여부를 비교하라.
**풀이**: 원래 ROC \(|z|>|a|\). 반전은 \(|z|<|a|^{-1}\). \(|a|<1\)이면 반전 ROC는 \(|z|>1\) 포함하지 않음.

---

## 파트 C. 역 Z-변환 (문제 13–18)

### 문제 13. (부분분수 — 서로 다른 단일극)

**목표**: 표준형 분해와 시간영역 해
**문제**:
$$
X(z)=\frac{1-0.5 z^{-1}}{(1-0.8 z^{-1})(1-0.3 z^{-1})},\quad \text{ROC: }|z|>0.8.
$$
\(x[n]\)을 구하라.
**풀이**: \(X=\frac{A}{1-0.8 z^{-1}}+\frac{B}{1-0.3 z^{-1}}\Rightarrow x[n]=A(0.8)^n u[n]+B(0.3)^n u[n]\).
**Octave**:
```octave
pkg load signal
b=[1 -0.5]; a=conv([1 -0.8],[1 -0.3]);
[r,p,k]=residuez(b,a); N=50; n=0:N-1;
x=zeros(size(n)); for i=1:numel(p), x+= r(i)*(p(i).^n); end
stem(n,x,'filled'); grid on; title('x[n] by partial fractions');
```

---

### 문제 14. (같은 형식, 다른 ROC → 양측 해)

**목표**: ROC가 해를 바꾸는 사례
**문제**: 위 \(X(z)\)에서 ROC가 \(0.3<|z|<0.8\)일 때 \(x[n]\)?
**풀이**: \((1-0.8 z^{-1})^{-1}\)는 좌측 전개, \((1-0.3 z^{-1})^{-1}\)는 우측 전개 → 양측 합. 형태와 계수는 동일하나 전개 방향이 바뀜.

---

### 문제 15. (중복극)

**목표**: \((1-pz^{-1})^{-2}\leftrightarrow (n+1)p^n u[n]\)
**문제**:
$$
X(z)=\frac{z^{-2}}{(1-0.9 z^{-1})^2}, \quad \text{ROC: } |z|>0.9.
$$
**풀이**:
$$
x[n]=(n-1)\,0.9^{n-2}u[n-2].
$$
**Octave**:
```octave
b=[1 0 0]; a=conv([1 -0.9],[1 -0.9]); N=60; n=0:N-1;
x_imp=impz(b,a,N);
x_form=zeros(size(n)); idx=find(n>=2); x_form(idx)=(n(idx)-1).*(0.9.^(n(idx)-2));
printf("RMS=%.2e\n", rms(x_imp - x_form));
```

---

### 문제 16. (복소 공켤레 극쌍)

**목표**: 감쇠 사인/코사인
**문제**:
$$
X(z)=\frac{1}{1-2r\cos\omega_0\, z^{-1}+r^2 z^{-2}}.
$$
**풀이**:
$$
x[n]=\frac{\sin((n+1)\omega_0)}{\sin \omega_0}\, r^n u[n].
$$
**Octave**:
```octave
r=0.95; w0=0.3*pi; a=[1 -2*r*cos(w0) r^2]; b=1;
N=100; n=0:N-1; x_imp=impz(b,a,N);
x_form=(sin((n+1)*w0)/sin(w0)).*(r.^n);
printf("RMS=%.2e\n", rms(x_imp - x_form));
```

---

### 문제 17. (비정상형 → 다항 나눗셈)

**목표**: 분자차수 ≥ 분모차수
**문제**:
$$
X(z)=1+0.5 z^{-1} + \frac{z^{-2}}{1-0.8 z^{-1}}.
$$
**풀이**: \(x[n]=\delta[n]+0.5\delta[n-1] + 0.8^{n-2} u[n-2]\).

---

### 문제 18. (잔여정리 스케치)

**목표**: 컨투어 적분으로 복원
**문제**: 문제 13의 \(X(z)\)에 대해 \(x[n]=\frac{1}{2\pi j}\oint X(z)z^{n-1}dz\)로 극에서의 잔여 합으로 표현하라.
**풀이 스케치**: \(z=0.8,0.3\)의 극에서 \(X(z)z^{n-1}\) 잔여의 합.

---

## 파트 D. z-영역 시스템 표현 (문제 19–24)

### 문제 19. (LCCDE → \(H(z)\))

**목표**: 전달함수
**문제**:
$$
y[n]-0.8y[n-1]+0.15 y[n-2]=x[n]-0.5 x[n-1].
$$
\(H(z)\)와 극/영점, 안정/인과 여부.
**풀이**:
$$
H(z)=\frac{1-0.5 z^{-1}}{1-0.8 z^{-1}+0.15 z^{-2}}.
$$
극 반경 \(<1\)이면 안정, ROC 바깥 포함이면 인과.
**Octave**:
```octave
b=[1 -0.5]; a=[1 -0.8 0.15];
[H,w]=freqz(b,a,4096);
subplot(2,1,1); plot(w/pi,20*log10(abs(H)+1e-12)); grid on; title('|H| dB');
subplot(2,1,2); plot(w/pi,unwrap(angle(H))); grid on; title('∠H');
```

---

### 문제 20. (극/영점 도표와 응답 직관)

**목표**: 단위원 거리 vs 증폭/감쇠
**문제/Octave**:
```octave
z=roots(fliplr([1 -0.5])); p=roots(fliplr([1 -0.8 0.15]));
th=linspace(0,2*pi,600); plot(cos(th),sin(th),'k--'); hold on
plot(real(z),imag(z),'ob'); plot(real(p),imag(p),'xr'); axis equal; grid on
legend('unit','zeros','poles'); title('z-plane');
```

---

### 문제 21. (직렬/병렬 합성)

**목표**: \(H_s=H_1H_2\), \(H_p=aH_1+bH_2\)
**문제/Octave**:
```octave
[b1,a1]=butter(3,0.4); [b2,a2]=cheby1(3,1,0.3);
bS=conv(b1,b2); aS=conv(a1,a2);
[HS,w]=freqz(bS,aS,4096); plot(w/pi,20*log10(abs(HS)+1e-12)); grid on
```

---

### 문제 22. (피드백 합성)

**목표**: \(H=\dfrac{G}{1+GF}\)
**문제**: \(F=1\)인 단일 폐루프.
**Octave(개념 시연)**:
```octave
[bG,aG]=butter(2,0.5); bF=1; aF=1;
bFB=bG; aFB = aG + conv(bG,bF);  % 간략화 표현
[H,w]=freqz(bFB,aFB,2048); plot(w/pi,abs(H)); grid on; title('Closed-loop |H|');
```

---

### 문제 23. (FIR 선형위상과 군지연)

**목표**: \(\tau_g\approx(N-1)/2\)
**문제/Octave**:
```octave
N=101; b=fir1(N-1,0.3,hamming(N)); a=1;
[H,w]=freqz(b,a,4096); phi=unwrap(angle(H)); tau=-gradient(phi)./gradient(w);
printf("mean τg≈%.2f theory=%.2f\n", mean(tau), (N-1)/2);
```

---

### 문제 24. (안정/인과 판정)

**목표**: ROC 기반 판정
**문제**: \(H(z)=\dfrac{1}{1-1.02 z^{-1}+0.5 z^{-2}}\). 안정/인과?
**풀이**: 극 반경 중 1.02에 가까운 경우 단위원 밖 가능 → BIBO 불안정. 인과는 ROC가 무한대 포함이면 성립 가능. 실제 수치로 극 반경 확인.
**Octave**:
```octave
a=[1 -1.02 0.5]; p=roots(fliplr(a)); disp([p abs(p)]);
```

---

## 파트 E. 차분 방정식의 해 (문제 25–36)

### 문제 25. (동차해 — 서로 다른 근)

**목표**: 특성방정식
**문제**:
$$
y[n]-1.1 y[n-1]+0.24 y[n-2]=0.
$$
**풀이**: \(r^2-1.1 r+0.24=0\Rightarrow r_1=0.8,r_2=0.3\).
\(y_h[n]=C_1 (0.8)^n + C_2 (0.3)^n\).

---

### 문제 26. (중복근)

**목표**: \(n r^n\)
**문제**:
$$
y[n]-1.2 y[n-1]+0.36 y[n-2]=0.
$$
**풀이**: \((r-0.6)^2=0\Rightarrow y_h[n]=(C_1+C_2 n)0.6^n\).

---

### 문제 27. (복소근)

**목표**: 감쇠 사인/코사인
**문제**:
$$
y[n]-2\rho\cos\omega_0\, y[n-1]+\rho^2 y[n-2]=0.
$$
**풀이**: \(r=\rho e^{\pm j\omega_0}\Rightarrow y_h[n]=\rho^n(A\cos\omega_0 n+B\sin\omega_0 n)\).

---

### 문제 28. (특정계수법 — 지수 입력)

**목표**: 충돌 여부
**문제**:
$$
y[n]-0.8 y[n-1]=2\cdot(0.5)^n u[n],\quad y[-1]=0.
$$
**풀이**: 특해 \(K(0.5)^n\), 충돌 없음. \(K\) 대입으로 결정. 완전해는 \(C(0.8)^n+K(0.5)^n\).
**Octave**:
```octave
a=[1 -0.8]; b=[2]; N=80; n=0:N-1; x=(0.5).^n; y=filter(b,a,x);
plot(n,y,'k.-'); grid on; title('특정계수법 지수 입력');
```

---

### 문제 29. (특정계수법 — 충돌)

**목표**: \(\times n\) 승수
**문제**:
$$
y[n]-0.5 y[n-1]=(0.5)^n u[n],\quad y[-1]=0.
$$
**풀이**: \(0.5\)가 특성근 → \(y_p[n]=K\,n (0.5)^n\).

---

### 문제 30. (사인 입력)

**목표**: \(A\cos+B\sin\)
**문제**:
$$
y[n]-1.2 y[n-1]+0.36 y[n-2]=\cos(0.3\pi n)\,u[n],\quad y[-1]=y[-2]=0.
$$
**풀이**: 특해 \(A\cos(\omega_0 n)+B\sin(\omega_0 n)\) (충돌 없음). 정상상태는 \(H(e^{j\omega_0})\)로 바로 계산 가능.
**Octave**:
```octave
pkg load signal
a=[1 -1.2 0.36]; b=[1 0 0]; N=120; n=0:N-1; x=cos(0.3*pi*n);
y=filter(b,a,x);
H0=freqz(b,a,0.3*pi); yss=abs(H0)*cos(0.3*pi*n + angle(H0));
plot(n,y,'k'); hold on; plot(n,yss,'r--'); grid on; legend('y','steady-state');
```

---

### 문제 31. (단위계단 입력과 최종값)

**목표**: 정적 이득
**문제**:
$$
y[n]-0.7 y[n-1]=u[n],\quad y[-1]=0.
$$
최종값과 수치 검증.
**풀이**: \(K-0.7K=1\Rightarrow K=1/0.3\).
**Octave**:
```octave
a=[1 -0.7]; b=[1]; N=100; n=0:N-1; x=ones(1,N);
y=filter(b,a,x); yline(1/(1-0.7),'r--'); hold on; plot(n,y,'k.-'); grid on;
```

---

### 문제 32. (컨볼루션 해)

**목표**: \(y=x*h\)
**문제**: 임의 \(h\)에 대해 \(y=\text{conv}(x,h)\)와 `filter` 결과가 일치함을 보이라.
**Octave**:
```octave
[b,a]=butter(3,0.3); N=256; x=randn(1,N); h=impz(b,a,N);
y1=filter(b,a,x); y2=conv(x,h); y2=y2(1:N);
printf("RMS=%.2e\n", rms(y1-y2));
```

---

### 문제 33. (Z-변환 해법 — 초기조건 없는 경우)

**목표**: 대수적 해
**문제**:
$$
y[n]-1.1 y[n-1]+0.24 y[n-2]=x[n],\quad x[n]=\delta[n].
$$
**풀이**: \(Y=H X\Rightarrow y=h\) (제로상태). \(h[n]=\mathcal{Z}^{-1}\{H\}\), 앞선 부분분수 공식 활용.

---

### 문제 34. (Z-변환 해법 — 초기조건 포함)

**목표**: 일측 Z-변환 개입
**문제**: 위 식에서 \(y[-1]=1,y[-2]=0\). 제로입력(동차) 성분과 제로상태 성분을 분리해 구하라.
**풀이**: \(y=y_{ZI}+y_{ZS}\). \(y_{ZI}\)는 동차해 상수로 초기조건 만족, \(y_{ZS}=h\*\delta=h\).

---

### 문제 35. (상태공간 해)

**목표**: \(A^n\) 합 표현
**문제**: 2차 LCCDE를 상태공간으로 바꾸고 `filter`와 결과 일치 확인.
**Octave(스케치)**:
```octave
a1=1.1; a2=-0.24; b0=1;
A=[a1 a2; 1 0]; B=[b0;0]; C=[1 0]; D=0;
N=60; n=0:N-1; x=(0.5).^n; xst=zeros(2,1); yss=zeros(1,N);
for k=1:N, yss(k)=C*xst + D*x(k); xst=A*xst + B*x(k); end
a=[1 -a1 -a2]; b=[b0 0 0]; y=filter(b,a,x);
printf("RMS=%.2e\n", rms(y - yss));
```

---

### 문제 36. (안정성/점근 안정)

**목표**: 동차해 소멸 조건
**문제**: 특성근 \(|r_i|<1\)이면 \(n\to\infty\)에 \(y_h[n]\to 0\)임을 보이고, 단위원 근접 시 과도/진동 성향을 서술하라.
**풀이**: \(|r_i|<1\Rightarrow r_i^n\to 0\). 중복근이면 \(n r^n\)이지만 여전히 \(|r|<1\)이면 소멸. \(|r|\approx 1\)이면 감쇠 느리고 진동 지속.

---

## 파트 F. 종합 프로젝트형 문제 (문제 37–40)

### 문제 37. (ROC로 시간영역 해 판별)

**목표**: 같은 유리형 \(X(z)\)에서 ROC만 바꾸어 3가지 해 비교
**문제**:
$$
X(z)=\frac{1}{1-0.8 z^{-1}}+\frac{z}{z-0.5}.
$$
ROC를 (i)\(|z|>0.8\), (ii)\(|z|<0.5\), (iii)\(0.5<|z|<0.8\)로 각각 두고 \(x[n]\)을 구하라.
**풀이**: 첫 항은 (i) 우측, (ii) 불가→좌측, (iii) 좌측; 둘째 항은 (i) 우측 불가→좌측, (ii) 좌측, (iii) 우측. 조합별로 양측/좌측/우측 혼합.

---

### 문제 38. (필터 합성과 응답 타겟팅)

**목표**: 극/영점 배치로 notch 만들기
**문제**: \(\omega_0=0.4\pi\)에서 노치가 되도록 \(H(z)\)의 영점을 단위원 위 \(e^{\pm j\omega_0}\)에 배치하라. 적절한 극 반경 \(r<1\)로 선택해 Q를 조절하고 주파수응답을 그려라.
**풀이/Octave**:
```octave
w0=0.4*pi; z0=[exp(1j*w0), exp(-1j*w0)]; b=poly(z0); % (1 - 2cos w0 z^-1 + z^-2)
r=0.95; p0=r*z0; a=poly(p0);
[H,w]=freqz(b,a,4096); plot(w/pi,20*log10(abs(H)+1e-12)); grid on
```

---

### 문제 39. (특정계수법 vs 주파수응답)

**목표**: 사인 입력의 정상상태를 두 방식으로 일치 확인
**문제**:
$$
y[n]-0.7 y[n-1]=\cos(0.25\pi n)\,u[n].
$$
특정계수법으로 \(A,B\)를 풀고, \(H(e^{j\omega_0})\)로 계산한 정상상태와 비교하라.
**Octave(숫자 검증)**:
```octave
a=[1 -0.7]; b=[1]; w0=0.25*pi; N=200; n=0:N-1; x=cos(w0*n);
y=filter(b,a,x); H0=freqz(b,a,w0); yss=abs(H0)*cos(w0*n + angle(H0));
plot(n,y,'k'); hold on; plot(n,yss,'r--'); grid on; legend('sim','H-based');
```

---

### 문제 40. (역 Z-변환 자동 채점기)

**목표**: 여러 항의 역 Z-변환을 자동 검증
**문제/Octave**: `residuez`와 `impz`를 사용해 부분분수 결과 대비 임펄스응답 RMS 오차를 내는 스크립트를 작성하라.
**풀이/Octave**:
```octave
function rms_err = iz_checker(b,a,N)
  [r,p,k]=residuez(b,a); n=0:N-1; hpf=zeros(size(n));
  for i=1:numel(p), hpf += r(i)*(p(i).^n); end
  h=impz(b,a,N); rms_err=rms(h - hpf);
endfunction

printf("err=%.2e\n", iz_checker([1 -0.5], [1 -0.8 0.15], 80));
```

---

# 마무리 체크리스트

- **양측 Z & ROC**: 우측/좌측/양측 판정 → DTFT 존재 여부.
- **성질**: 선형·시프트·지수곱·\(n\)가중·컨볼루션 정리.
- **역 Z**: 부분분수·거듭제곱 전개·다항 나눗셈·잔여정리.
- **z-영역 시스템**: \(H(z)=B/A\), 극/영점과 안정/인과, 합성(직렬/병렬/피드백), FIR 군지연.
- **차분 해**: 동차+특해(+초기조건), 특정계수법, 컨볼루션, Z-변환, 상태공간.
- **수치 검증**: `freqz`/`impz`/`residuez`/직접합으로 교차 확인.
