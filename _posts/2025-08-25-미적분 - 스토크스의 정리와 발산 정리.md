---
layout: post
title: 미적분 - 스토크스의 정리와 발산 정리
date: 2025-08-25 23:20:23 +0900
category: 미적분
---
# 스토크스의 정리와 발산 정리

핵심 메시지는 다음 네 줄로 요약된다.

- **선적분 ↔ 회전의 면적분**: 경계 곡선의 **순환(line integral)** 은 곡면 내부의 **회전(curl)** 의 면적분과 같다.  
  $$
  \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_{S}(\nabla\times\mathbf F)\cdot\mathbf n\,dS.
  $$
- **닫힌면 플럭스 ↔ 발산의 체적분**: 닫힌면을 통과하는 **유량(flux)** 은 내부의 **발산(divergence)** 의 체적분과 같다.  
  $$
  \iint_{\partial V}\mathbf F\cdot\mathbf n\,dS=\iiint_{V}\nabla\cdot\mathbf F\,dV.
  $$
- 두 정리는 모두 **경계와 내부의 미분 연산자**를 연결한다: 선적분(경계) ↔ 회전(내부), 면적분(경계) ↔ 발산(내부).
- 일반 스토크스(미분형식 버전)는 이 둘을 하나의 원리에 포함한다.

---

## 0) 큰 그림: 경계-내부 대응표

| 정리 | 경계 측 | 내부 측 | 연산자 | 차원 |
|---|---|---|---|---|
| 선적분의 기본정리 | 두 점 \(a,b\) | 구간 \([a,b]\) | 그라디언트 \(\nabla\) | 1D |
| **그린의 정리** | 폐곡선 \(C\) | 평면영역 \(D\) | 2D 회전/발산 | 2D |
| **스토크스의 정리** | 공간곡선 \(C\) | 곡면 \(S\) | 3D 회전 \(\nabla\times\) | 2D↔1D |
| **발산 정리** | 닫힌면 \(\partial V\) | 체적 \(V\) | 3D 발산 \(\nabla\cdot\) | 3D↔2D |

---

## 1) 스토크스의 정리 (Stokes’ Theorem)

### 1.1 정식 진술과 가정
- \(S\subset\mathbb R^3\) 를 **매끄럽고 유향(orientation)** 을 가진 곡면이라 하자.  
- \(\partial S=C\) 는 \(S\)의 **경계 곡선**으로, **우수법(Right-hand rule)** 에 맞는 **양의 방향**을 갖는다.
- \(\mathbf F:\mathbb R^3\to\mathbb R^3\) 가 \(S\) 를 포함하는 열린 집합에서 \(C^1\) 이라면,

$$
\boxed{\ \oint_{C}\mathbf F\cdot d\mathbf r
=\iint_{S}(\nabla\times\mathbf F)\cdot\mathbf n\,dS\ }.
$$

여기서 \(\mathbf n\) 은 \(S\) 의 선택된 단위법선(방향 포함)이다.

### 1.2 방향 일치(오리엔테이션)
- **오른손 법칙**: 오른손 엄지를 \(\mathbf n\) 방향(면의 양 방향)으로 두고 네 손가락을 감은 방향이 **경계 \(C\)** 의 양의 진행 방향.
- 곡면을 바꾸더라도 **경계만 같고 방향 일치**면 값은 동일하다. (예제 2에서 확인)

### 1.3 계산 레시피
1) \(C=\partial S\) 를 **매개화**: \(\mathbf r(t),\ t\in[a,b]\).  
   선적분은
   $$
   \oint_{C}\mathbf F\cdot d\mathbf r=\int_{a}^{b}\mathbf F(\mathbf r(t))\cdot\mathbf r'(t)\,dt.
   $$
2) \(S\) 를 **매개화**: \(\mathbf R(u,v),\ (u,v)\in D\).  
   면적분은
   $$
   \iint_{S}(\nabla\times\mathbf F)\cdot\mathbf n\,dS
   =\iint_{D}(\nabla\times\mathbf F)(\mathbf R(u,v))\cdot(\mathbf R_u\times\mathbf R_v)\,du\,dv.
   $$
3) **둘 중 쉬운 쪽**을 택한다. (경계 적분 vs. 회전의 면적분)

---

## 2) 스토크스 예제

### 예제 2.1 (원판 경계: 평면 vs. 포물면 선택 불변성)
- 벡터장: \(\mathbf F=\langle -y,\ x,\ 0\rangle\).  
- 경계: 단위원 \(C:\ x^2+y^2=1,\ z=0\), 양의 방향(위에서 볼 때 반시계).
- 곡면 ①: 원판 \(S_1:\ z=0,\ x^2+y^2\le 1\) (위쪽 법선).  
- 곡면 ②: 포물면 모자 \(S_2:\ z=1-x^2-y^2,\ z\ge 0\) (위쪽 법선).  
  두 곡면의 **경계는 동일**하며 방향 일치.

**① 경계로 직접(선적분)**  
\(C\) 를 \(\mathbf r(t)=\langle \cos t,\ \sin t,\ 0\rangle\), \(t\in[0,2\pi]\).  
\(\mathbf r'(t)=\langle -\sin t,\ \cos t,\ 0\rangle\).  
\(\mathbf F(\mathbf r(t))=\langle -\sin t,\ \cos t,\ 0\rangle\).  
따라서
$$
\oint_{C}\mathbf F\cdot d\mathbf r
=\int_{0}^{2\pi}\big\langle -\sin t,\ \cos t,\ 0\rangle\cdot\langle -\sin t,\ \cos t,\ 0\rangle\,dt
=\int_{0}^{2\pi}( \sin^2 t+\cos^2 t )\,dt=2\pi.
$$

**② 스토크스로 면적분**  
\(\nabla\times\mathbf F=\langle 0,0,2\rangle\).  
- 원판 \(S_1\): \( \mathbf n=\langle 0,0,1\rangle\), \(dS=dx\,dy \).  
  $$
  \iint_{S_1}(\nabla\times\mathbf F)\cdot\mathbf n\,dS=\iint_{x^2+y^2\le 1}2\,dx\,dy=2\pi.
  $$
- 포물면 \(S_2\): 그래프 \(z=g(x,y)=1-x^2-y^2\), 위쪽 법선  
  \( \mathbf n\,dS=\langle -g_x,-g_y,1\rangle\,dx\,dy=\langle 2x,2y,1\rangle\,dx\,dy \).  
  $$
  (\nabla\times\mathbf F)\cdot\mathbf n\,dS=\langle 0,0,2\rangle\cdot\langle 2x,2y,1\rangle\,dx\,dy=2\,dx\,dy.
  $$
  적분영역은 동일 원판 → 결과 \(2\pi\).  

**결론**: 곡면 선택과 무관하게 \(2\pi\)로 일치.

---

### 예제 2.2 (보존장: 회전=0이면 경계 적분=0)
\(\mathbf F=\nabla\phi\) 인 **보존장**이면 \(\nabla\times\mathbf F=\mathbf 0\).  
따라서 모든 곡면 \(S\) 에 대해
$$
\oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_{S} \underbrace{(\nabla\times\mathbf F)}_{\mathbf 0}\cdot\mathbf n\,dS=0.
$$
→ 닫힌 곡선에서의 순환은 0. (경로독립성과 연결)

---

### 예제 2.3 (계산 지름길)
\(\mathbf F=\langle yz, zx, xy\rangle\), \(C\): 평면 \(z=1\) 에서 \(x^2+y^2=1\) 원, 위에서 반시계.  
스토크스로 **면적분**으로 바꾸면,
$$
\nabla\times\mathbf F=\left\langle x-z,\ y-x,\ z-y\right\rangle.
$$
평면 \(z=1\) 에서 \(x^2+y^2\le 1\), 위쪽 법선 → \(\mathbf n=\langle 0,0,1\rangle\).  
그러면 integrand는 \((\nabla\times\mathbf F)\cdot\mathbf n = z-y = 1 - y\).  
면적분:
$$
\iint_{x^2+y^2\le 1} (1-y)\,dx\,dy = \pi - 0 = \pi.
$$
(대칭성으로 \( \iint y\,dx\,dy=0 \).)  
따라서 \( \displaystyle \oint_C \mathbf F\cdot d\mathbf r=\pi \).

---

## 3) 발산 정리 (Divergence / Gauss Theorem)

### 3.1 정식 진술과 가정
- \(V\subset\mathbb R^3\) 를 유한 체적의 **매끄러운 영역**이라 하고, \(\partial V=S\) 를 **닫힌 곡면**(외향 법선)이라 하자.
- \(\mathbf F\) 가 \(C^1\) 이면,
$$
\boxed{\ \iint_{\partial V}\mathbf F\cdot\mathbf n\,dS=\iiint_{V}\nabla\cdot\mathbf F\,dV\ }.
$$

### 3.2 의미와 해석
- 좌변: 닫힌 면을 뚫고 **나가는 총 유량**(외향 플럭스).  
- 우변: 내부에서의 **순 생성률**(발산의 체적 적분).
- 유체/전기장/자기장/열유속 등에서 **보존/원천/흡수**를 연결하는 물리적 균형식.

### 3.3 계산 레시피
1) 좌변(플럭스)을 직접 면적분으로 계산하거나,  
2) 우변(발산의 체적분)으로 바꿔 **훨씬 단순한 체적 적분**으로 계산.

---

## 4) 발산 정리 예제

### 예제 4.1 (구면 플럭스)
\(\mathbf F=\langle x,y,z\rangle\), \(V\): 반지름 \(R\) 구, \(S=\partial V\) 구면(외향).  
\(\nabla\cdot\mathbf F=3\). 체적 \(= \tfrac{4}{3}\pi R^3\).  
$$
\iint_{S}\mathbf F\cdot\mathbf n\,dS=\iiint_{V}3\,dV=3\cdot\tfrac{4}{3}\pi R^3=4\pi R^3.
$$
(직접 면적분으로도 \(R\cdot 4\pi R^2\) 로 동일.)

---

### 예제 4.2 (역제곱 법칙과 특이점)
\(\mathbf F=\displaystyle \frac{\mathbf r}{\|\mathbf r\|^3}=\left\langle \frac{x}{r^3},\frac{y}{r^3},\frac{z}{r^3}\right\rangle\), \(r=\sqrt{x^2+y^2+z^2}\).  
원점 제외 영역에서 \(\nabla\cdot \mathbf F=0\) 이지만, 원점을 포함하는 임의의 구면 \(S\) 에 대해
$$
\iint_{S}\mathbf F\cdot\mathbf n\,dS=4\pi.
$$
→ **델타 함수 원천** \(\nabla\cdot\mathbf F=4\pi\delta\) 로 해석(분포 의미).  
**실무 주의**: 영역/정칙성 가정 위반(특이점)이면 발산 정리를 그대로 쓰면 안 되고, **작은 구로 둘러싸서 제외** 후 한계로 다룬다.

---

### 예제 4.3 (원기둥의 플럭스: 체적 적분으로 단순화)
\(\mathbf F=\langle \alpha x,\ \beta y,\ \gamma z\rangle\).  
원기둥 \(x^2+y^2\le R^2,\ z\in[0,h]\) 를 감싸는 닫힌면(옆면+윗/아랫뚜껑).  
\(\nabla\cdot\mathbf F=\alpha+\beta+\gamma\) (상수).  
체적 \(=\pi R^2 h\).  
$$
\iint_{\partial V}\mathbf F\cdot\mathbf n\,dS
=\iiint_{V}(\alpha+\beta+\gamma)\,dV=(\alpha+\beta+\gamma)\pi R^2 h.
$$
면을 각 조각으로 나눠 플럭스 합을 구하는 것보다 **훨씬 빠르다**.

---

### 예제 4.4 (닫히지 않은 면을 다룰 때 — 뚜껑으로 닫기)
발산 정리는 **닫힌면**만 가능.  
예를 들어 옆면만 있는 원기둥 \(S_{\text{side}}\) 의 플럭스를 구하고 싶다면,
윗/아랫뚜껑 \(S_{\text{top}}, S_{\text{bot}}\) 으로 **닫힌면** \(S_{\text{closed}}\) 을 만든 뒤
$$
\iint_{S_{\text{side}}}\mathbf F\cdot\mathbf n\,dS
=\iint_{S_{\text{closed}}}\mathbf F\cdot\mathbf n\,dS
-\iint_{S_{\text{top}}}\mathbf F\cdot\mathbf n\,dS
-\iint_{S_{\text{bot}}}\mathbf F\cdot\mathbf n\,dS.
$$
우변의 첫 항은 발산 정리로 체적적분으로 빠르게 계산.

---

## 5) 스토크스 ↔ 발산: 직관과 연결

- **스토크스**: “작은 소용돌이(회전)의 합 = 경계에서의 전체 순환”.  
  유체에서 **회전(curl)** 은 미소 회전을 의미, 그들의 합이 테두리를 도는 순환과 같다는 말.

- **발산**: “작은 원천/흡수(발산)의 합 = 껍질을 통과하는 순유량”.  
  유체/열/전하(가우스 법칙)에서 **발산(div)** 은 국소 생성률. 그들의 합이 벽면을 나가는 총량.

- **미분형식(일반 스토크스)**:  
  적절한 차원의 미분형식 \(\omega\) 에 대해  
  $$\displaystyle \int_{\partial \Omega}\omega=\int_{\Omega} d\omega.$$  
  \(\omega=\mathbf F\cdot d\mathbf r\) (1-형식) → 스토크스,  
  \(\omega=\mathbf F\cdot d\mathbf S\) (2-형식) → 발산 정리.

---

## 6) 자주 하는 실수 — 체크리스트

- [ ] **방향 일치**: 스토크스에서 곡면 법선과 경계 방향(오른손법칙)이 맞는가?  
- [ ] **닫힌면 여부**: 발산 정리는 반드시 **닫힌면**. 열려 있다면 캡을 덧대서 닫아라.  
- [ ] **정칙성/특이점**: 원천(특이점) 포함 여부를 점검. 필요 시 특이점 주변을 제외하고 한계취함.  
- [ ] **도메인 구분**: 분할 곡면/체적이면 각 조각에서 적분 후 합산.  
- [ ] **계산 레시피**의 일관성: 매개화 \(\mathbf R_u\times\mathbf R_v\), 그래프 \(\langle -g_x,-g_y,1\rangle\) 등 면소를 정확히.  
- [ ] **대칭성 활용**: 회전/발산이 상수이거나 홀/짝 대칭이면 즉시 간소화.

---

## 7) 파이썬(SymPy)로 검증/보조 계산

아래 코드는 본문 일부 예제(스토크스·발산)를 **심볼릭/수치**로 확인한다.

```python
import sympy as sp

# 변수/기호
t = sp.symbols('t', real=True)
x, y, z, R, a = sp.symbols('x y z R a', real=True)
alpha, beta, gamma = sp.symbols('alpha beta gamma', real=True)
r = sp.sqrt(x**2 + y**2 + z**2)

# ===== Stokes Example 2.1 =====
# F = <-y, x, 0>, C: unit circle on z=0
F = sp.Matrix([-y, x, 0])
curlF = sp.Matrix([sp.diff(F[2], y)-sp.diff(F[1], z),
                   sp.diff(F[0], z)-sp.diff(F[2], x),
                   sp.diff(F[1], x)-sp.diff(F[0], y)])  # curl F
# Parameterize C
rx = sp.cos(t); ry = sp.sin(t); rz = 0
dr = sp.Matrix([-sp.sin(t), sp.cos(t), 0])
Fc = F.subs({x: rx, y: ry, z: rz})
circulation = sp.integrate(Fc.dot(dr), (t, 0, 2*sp.pi))
print("Stokes ex2.1 circulation =", sp.simplify(circulation))  # 2*pi

# Surface integral over disk: curlF = <0,0,2>, n = k
flux_rot = sp.integrate(sp.integrate(2, (x, -1, 1)), (y, -sp.sqrt(1-x**2), sp.sqrt(1-x**2)))
print("Stokes ex2.1 surface(curl) =", sp.simplify(flux_rot))  # 2*pi

# ===== Divergence Example 4.1 =====
F2 = sp.Matrix([x, y, z])
divF2 = sp.diff(F2[0], x) + sp.diff(F2[1], y) + sp.diff(F2[2], z)  # 3
vol_sphere = 4*sp.pi*R**3/3
flux_sphere = sp.simplify(divF2 * vol_sphere)
print("Gauss ex4.1 flux =", flux_sphere)  # 4*pi*R^3

# ===== Divergence Example 4.3 (cylinder) =====
F3 = sp.Matrix([alpha*x, beta*y, gamma*z])
divF3 = sp.diff(F3[0], x) + sp.diff(F3[1], y) + sp.diff(F3[2], z)  # alpha+beta+gamma
h = sp.symbols('h', positive=True)
flux_cyl = sp.simplify((alpha+beta+gamma) * sp.pi * R**2 * h)
print("Gauss ex4.3 flux =", flux_cyl)  # (alpha+beta+gamma)*pi*R^2*h
```

> 참고: 예제 4.2의 \(\mathbf F=\mathbf r/r^3\) 는 원점 특이점을 포함하므로
> `sympy`에서 직접 발산을 0이라 돌려도(원점 제외) **구면 플럭스 4π** 결과와 모순되지 않는다.
> 이는 **분포(divergence in distribution sense)** 관점에서 \(\nabla\cdot \mathbf F=4\pi\delta\) 로 해석한다.

---

## 8) 증명 스케치(개념적)

### 8.1 스토크스(평면/조각별 그린의 정리 → 곡면으로)
- 매끄러운 곡면 \(S\) 를 작은 패치로 나누어 **국소 좌표**로 평면 근사.  
- 각 패치에서 **그린의 정리**(2D) 적용 → **회전의 면적분 = 경계의 선적분**.  
- 내부 경계는 서로 **상쇄**되고, 바깥 경계만 남아 전체 정리 성립.

### 8.2 발산 정리(작은 상자 합 → 체적 한계)
- 작은 상자(직육면체)에서 면 플럭스 합을 계산하면 중심에서의 **발산×체적**에 근접.  
- 상자를 빽빽이 채우면 내부 면은 서로 상쇄되고, 최종적으로 바깥 껍질만 남음 → 전체 정리 성립.

---

## 9) 실전 팁: 어느 쪽을 쓸까?

- **스토크스를 써라**: 경계 곡선이 단순하고 \(\nabla\times\mathbf F\) 가 간단할 때.  
  (반대로 경계 적분이 쉬우면 굳이 면적분으로 바꾸지 말 것.)
- **발산 정리를 써라**: 닫힌면 플럭스가 필요하고 \(\nabla\cdot\mathbf F\) 가 단순하거나 상수일 때.  
  (특히 대칭성 있는 체적: 구/원통/직육면체.)

---

## 10) 연습문제(해설 스케치)

1) **스토크스-원판/포물면 재확인**  
   \(\mathbf F=\langle -y,\ x,\ 0\rangle\), 경계 \(x^2+y^2=1\) 을 가지는 임의의 **위쪽 법선 곡면**에서 \(\oint\mathbf F\cdot d\mathbf r\) 를 구하라.  
   - 스케치: \(\nabla\times\mathbf F=\langle 0,0,2\rangle\) 이므로 면적분은 항상 \(2\pi\).

2) **스토크스 지름길**  
   \(\mathbf F=\langle yz,\ zx,\ xy\rangle\), \(C:\ z=2\) 평면의 \(x^2+y^2=1\) 원, 위쪽 법선.  
   - 스케치: \((\nabla\times\mathbf F)\cdot\mathbf n=2 - y\Rightarrow \pi\cdot 2 - 0 = 2\pi\).

3) **발산 정리-구면**  
   \(\mathbf F=\langle x^3, y^3, z^3\rangle\), 반지름 \(R\) 구면 플럭스.  
   - 스케치: \(\nabla\cdot\mathbf F=3(x^2+y^2+z^2)\). 구 좌표로 체적적분.

4) **열려 있는 면 플럭스**  
   원기둥 **옆면** 플럭스를 발산 정리로 풀기 위해 윗/아랫뚜껑을 덧댄 후 빼는 방식으로 계산하라.  
   - 스케치: 닫힌면 전체 = 체적적분, 뚜껑 두 면은 직접/대칭으로 계산 후 제거.

5) **특이점 다루기**  
   \(\mathbf F=\mathbf r/\|\mathbf r\|^3\). 반지름 \(R\) 구면 플럭스와 반지름 \(2R\) 구면 플럭스를 비교하라.  
   - 스케치: 둘 다 \(4\pi\). 발산 정리 직접 적용 불가(특이점), 구 중심에서 작은 구로 제외 후 한계로 접근.

---

## 11) 한 페이지 요약

- **스토크스**:  
  $$
  \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_{S}(\nabla\times\mathbf F)\cdot\mathbf n\,dS.
  $$
  방향 일치(오른손법칙), 곡면 선택 불변(경계만 동일하면 OK).

- **발산 정리**:  
  $$
  \iint_{\partial V}\mathbf F\cdot\mathbf n\,dS=\iiint_{V}\nabla\cdot\mathbf F\,dV.
  $$
  닫힌면 필수, 특이점 주의(필요 시 제외/한계).

- **전략**: 더 쉬운 쪽(경계 vs 내부)으로 바꿔 계산. 대칭성과 상수 발산/회전 상황에서 압도적.