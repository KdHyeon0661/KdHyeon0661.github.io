---
layout: post
title: 미적분 - 곡선의 길이와 곡률
date: 2025-08-25 19:20:23 +0900
category: 미적분
---
# 곡선의 길이와 곡률

## 0. 표기와 기본 설정

- 곡선: $$\vec r(t)=\langle x(t),y(t),z(t)\rangle,\ t\in[a,b]$$ (2D면 \(z\)성분 생략)
- 속도(스칼라 속력): $$v(t)=\lVert \vec r'(t)\rVert$$
- 호(길이) 좌표: $$s(t)=\displaystyle\int_{t_0}^{t} v(\tau)\,d\tau$$
- 단위 접선벡터: $$\hat T=\dfrac{\vec r'}{\lVert \vec r'\rVert}$$

---

## 1. 곡선의 길이(Arc Length)

### 1.1 정의(파라미터 표현)
$$
L=\int_{a}^{b}\lVert \vec r'(t)\rVert\,dt
=\int_{a}^{b}\sqrt{\Big(\tfrac{dx}{dt}\Big)^2+\Big(\tfrac{dy}{dt}\Big)^2+\Big(\tfrac{dz}{dt}\Big)^2}\,dt.
$$

> **재매개불변성**: \(t\)를 어떠한 단사 미분가능 매개변수로 바꿔도 \(L\)은 동일하다. (길이는 기하량)

### 1.2 \(y=f(x)\) 형태
$$
L=\int_{x_1}^{x_2}\sqrt{1+\big(f'(x)\big)^2}\,dx.
$$

### 1.3 대표 예제

**예제 A — 포물선 \(\vec r(t)=\langle t,\ t^2\rangle,\ 0\le t\le 1\)**
\(\vec r'(t)=\langle 1,2t\rangle,\ \lVert \vec r'\rVert=\sqrt{1+4t^2}\).
$$
L=\int_0^1\sqrt{1+4t^2}\,dt
=\frac{t}{2}\sqrt{1+4t^2}\ \Big|_0^1+\frac{1}{4}\,\mathrm{asinh}(2)
=\frac{\sqrt5}{2}+\frac14\,\mathrm{asinh}(2).
$$

**예제 B — 원 \(\vec r(\theta)=\langle R\cos\theta,R\sin\theta\rangle,\ 0\le\theta\le2\pi\)**
\(\lVert \vec r'(\theta)\rVert=R\Rightarrow L=\int_0^{2\pi}R\,d\theta=2\pi R\).

**예제 C — 3D 나선(헬릭스) \(\vec r(t)=\langle a\cos t,\ a\sin t,\ bt\rangle\)**
\(\lVert \vec r'(t)\rVert=\sqrt{a^2+b^2}\Rightarrow L=\sqrt{a^2+b^2}\,(t_2-t_1).\)

---

## 2. 곡률(Curvature)

### 2.1 핵심 정의(기하적 의미)
- **정의**: 곡률은 “방향 변화의 세기”
$$
\kappa=\left\lVert \frac{d\hat T}{ds}\right\rVert
\quad\text{(단위: 1/길이)}.
$$
- 직선: \(\kappa=0\).
- 반지름 \(R\)인 원: \(\kappa=\dfrac{1}{R}\) (항상 일정).

> 평면곡선에서 곡률은 “접선각 \(\theta\)”의 호길이 변화율: $$\kappa=\dfrac{d\theta}{ds}.$$

### 2.2 계산공식(파라미터 \(t\))

**3D 일반식**
$$
\kappa(t)=\frac{\lVert \vec r'(t)\times \vec r''(t)\rVert}{\lVert \vec r'(t)\rVert^3}.
$$

**2D 축약식** \(\vec r(t)=\langle x(t),y(t)\rangle\)
$$
\kappa(t)=\frac{|x'(t)y''(t)-y'(t)x''(t)|}{\big(x'(t)^2+y'(t)^2\big)^{3/2}}.
$$
(부호까지 쓰는 **부호있는 곡률**은 \(|\cdot|\) 제거 및 방향 규칙을 둔다)

**\(y=f(x)\) 형태**
$$
\kappa(x)=\frac{|f''(x)|}{\big(1+(f'(x))^2\big)^{3/2}}.
$$

### 2.3 대표 예제

**예제 D — 포물선 \(y=x^2\)**
\(f'(x)=2x,\ f''(x)=2\Rightarrow\)
$$
\kappa(x)=\frac{2}{\big(1+4x^2\big)^{3/2}},\quad
R(x)=\frac{1}{\kappa(x)}=\frac{\big(1+4x^2\big)^{3/2}}{2}.
$$
특히 \(x=0\)에서 \(\kappa(0)=2,\ R(0)=\tfrac12\).

**예제 E — 원 \(x^2+y^2=R^2\)**
상수 곡률 \(\kappa=1/R\).

**예제 F — 헬릭스 \(\vec r(t)=\langle a\cos t,\ a\sin t,\ bt\rangle\)**
\(\lVert \vec r'\rVert=\sqrt{a^2+b^2}\), \(\vec r''=\langle -a\cos t,-a\sin t,0\rangle\)
\(\Rightarrow\ \kappa=\dfrac{a}{a^2+b^2}\) (상수).
(참고: 비틀림 \(\tau=\dfrac{b}{a^2+b^2}\))

**예제 G — 클로소이드(오일러 나선)**
곡률이 호길이에 **선형**: \(\kappa(s)=\alpha s\). 도로/철도에서 곡률 연속 설계에 쓰인다.

---

## 3. 오스큘레이팅 원(접촉원)·법선·프레네-세레(간단)

- 곡선의 한 점에서 “가장 잘 맞는” 원의 반지름 \(R=1/\kappa\), 중심은 **주법선 방향**으로 \(R\)만큼 이동.
- 평면 \(y=f(x)\)에서 법선단위벡터
$$
\hat n=\frac{\langle -f'(x),\,1\rangle}{\sqrt{1+(f'(x))^2}},
\quad
\text{오스큘레이팅 원 중심 } \vec c
=\langle x,f(x)\rangle+\frac{1}{\kappa}\,\hat n.
$$
- 3D에서는 프레네-세레 정식:
  - \(\hat T=\dfrac{d\vec r}{ds}\), \(\hat N=\dfrac{1}{\kappa}\dfrac{d\hat T}{ds}\), \(\hat B=\hat T\times\hat N\).
  - \(\dfrac{d\hat T}{ds}=\kappa \hat N,\ \dfrac{d\hat N}{ds}=-\kappa \hat T+\tau \hat B,\ \dfrac{d\hat B}{ds}=-\tau \hat N.\)

---

## 4. 암시적 곡선 \(F(x,y)=0\)의 곡률(추가)

평면에서 **부호 있는 곡률**:
$$
\kappa=\operatorname{div}\!\left(\frac{\nabla F}{\lVert\nabla F\rVert}\right)
=\frac{F_{xx}F_y^2-2F_{xy}F_xF_y+F_{yy}F_x^2}{(F_x^2+F_y^2)^{3/2}}.
$$
레벨셋 방법·영상처리에서 유용.

---

## 5. 자주 틀리는 포인트 & 경계 사례

1) **속력이 0인 점**(첨점, cusp): \(\vec r'(t_0)=0\)이면 공식이 정의되지 않는다.
2) **샘플 노이즈**: 수치미분은 노이즈를 증폭한다 → 평활화 후 미분(스플라인, Savitzky–Golay).
3) **부호 있는 곡률**의 방향 일관성: 좌표계·파라미터 진행방향에 따라 부호가 바뀐다.
4) **재매개**에 무관: 곡률은 기하량이다(정확히 계산했다면 \(t\) 선택과 무관).
5) **수렴성**: 길이 적분은 루트항 때문에 해석적 원시함수 없는 경우가 흔하다 → 수치적분 사용.

---

## 6. 현업 시나리오

- **모션 플래닝/차량 조향**: 최대 곡률 \(\kappa_{\max}=1/R_{\min}\) 제약 하에 경로 설계(클로소이드로 곡률 연속).
- **도로/철도 설계**: 곡률·곡률변화율(Jerk) 연속성(\(G^2\) 이상) 확보.
- **로봇 팔 경로**: 툴팁 경로 길이 최소화, 곡률 제한으로 진동/충격 저감.
- **CG/애니메이션**: 곡선의 시각적 매끄러움 → 곡률의 급변 억제.
- **이미지 곡선 추정**: 레벨셋에서의 곡률 항(정규화 mean curvature).

---

## 7. 검산용 수치 코드(파이썬, 의존성 최소)

> `numpy`만 가정. 심볼릭이 필요하면 `sympy`로 대체 가능(아래 추가).

### 7.1 파라미터 곡선의 길이(심프슨 적분)

```python
import numpy as np

def arc_length(r, t0, t1, n=2000):
    """
    r: callable t -> array([x,y]) or [x,y,z]
    [t0,t1] 구간 길이. 심프슨 규칙.
    """
    if n % 2: n += 1
    t = np.linspace(t0, t1, n+1)
    pts = np.array([r(tt) for tt in t])
    v = np.linalg.norm(np.gradient(pts, t, axis=0), axis=1)  # |r'(t)| 근사
    h = (t1 - t0)/n
    S = v[0] + v[-1] + 4*v[1:-1:2].sum() + 2*v[2:-2:2].sum()
    return S * h/3
```

### 7.2 곡률(중심차분으로 1·2차 미분 근사)

```python
def curvature_parametric(r, t, h=1e-4):
    """
    2D/3D 모두 지원. 중앙차분으로 r', r'' 근사 후
    kappa = |r' x r''| / |r'|^3  (2D면 z=0으로 확장)
    """
    r_m = np.array(r(t-h))
    r_0 = np.array(r(t))
    r_p = np.array(r(t+h))
    r1 = (r_p - r_m) / (2*h)
    r2 = (r_p - 2*r_0 + r_m) / (h*h)
    if r_0.shape[0] == 2:
        # 2D -> 3D로 승격
        r1 = np.array([r1[0], r1[1], 0.0])
        r2 = np.array([r2[0], r2[1], 0.0])
    cross = np.linalg.norm(np.cross(r1, r2))
    speed = np.linalg.norm(r1)
    return cross / (speed**3)
```

### 7.3 오스큘레이팅 원(평면)

```python
def osculating_circle_2d(x, y, t, h=1e-4):
    """
    r(t) = [x(t), y(t)]
    반환: (center_x, center_y, R, kappa)
    """
    import numpy as np
    def r(tt): return np.array([x(tt), y(tt)])
    r_m, r_0, r_p = r(t-h), r(t), r(t+h)
    r1 = (r_p - r_m)/(2*h)
    r2 = (r_p - 2*r_0 + r_m)/(h*h)
    x1,y1 = r1
    x2,y2 = r2
    denom = (x1*x1 + y1*y1)**1.5
    kappa = abs(x1*y2 - y1*x2) / denom
    R = 1.0/kappa
    # 법선 단위벡터: T = r1/|r1|, N = rot(T) = (-Ty, Tx)
    T = r1/np.linalg.norm(r1)
    N = np.array([-T[1], T[0]])
    # 부호 있는 곡률을 원하면 sign = sign(x1*y2 - y1*x2)
    cx, cy = r_0 + R * N
    return cx, cy, R, kappa
```

### 7.4 사용 예

```python
# (1) 포물선 r(t) = (t, t^2)
f_len = arc_length(lambda tt: [tt, tt*tt], 0.0, 1.0)  # 길이 수치확인
k0 = curvature_parametric(lambda tt: [tt, tt*tt], t=0.0)  # 이론값 2와 비교

# (2) 헬릭스 r(t) = (a cos t, a sin t, b t)
a,b = 2.0, 1.0
helix = lambda tt: [a*np.cos(tt), a*np.sin(tt), b*tt]
L = arc_length(helix, 0.0, 3.0)                # ≈ sqrt(a^2+b^2)*3
k = curvature_parametric(helix, t=1.23)        # ≈ a/(a^2+b^2)
```

### 7.5 (선택) 심볼릭으로 정확식 얻기 — Sympy

```python
import sympy as sp
t = sp.symbols('t', real=True)
x = t
y = t**2
x1, y1 = sp.diff(x,t), sp.diff(y,t)
x2, y2 = sp.diff(x1,t), sp.diff(y1,t)
kappa = sp.simplify(abs(x1*y2 - y1*x2) / ( (x1**2 + y1**2)**sp.Rational(3,2) ))
sp.simplify(kappa)  # 2/(1+4*t**2)**(3/2)
```

---

## 8. \(G^1/G^2\) 매끄러움과 곡률 연속

- **\(G^1\)**: 접선방향 연속(속도 방향 연속)
- **\(G^2\)**: 곡률까지 연속(가속도 방향 연속)
차량·로봇 경로, 도로 설계에서는 최소 \(G^2\)가 안전·승차감 측면에서 중요. 스플라인(클로소이드, B-스플라인)로 곡률 변화를 부드럽게 설계한다.

---

## 9. 실수·성능 팁(수치)

1) 적분 구간 분할 수 \(n\)은 **적응적**으로 늘리며 오차 추정(심프슨 오차 \(O(h^4)\)).
2) 미분은 중심차분·작은 \(h\) 사용, 단 너무 작으면 반올림오차↑ → \(h\) 스윕으로 안정값 선택.
3) 샘플 노이즈 큰 데이터는 스무딩 후 곡률 계산(SG필터, 스플라인).
4) 3점 원 적합(Menger 곡률)도 실무에서 강건:
   - 세 점 \(A,B,C\) 변 장 \(a,b,c\), 삼각형 면적 \(\Delta\)이면
     $$\kappa_M=\frac{4\Delta}{abc}.$$
   - 부호는 \(\angle ABC\)의 반시계/시계로 정한다.

---

## 10. 연습문제(블로그 독자용)

1) \(y=x^3\)의 \(x\in[0,1]\)에서 길이를 수치로 구하고, \(x=0\)의 곡률을 공식으로 구해 확인하라.
2) 헬릭스 \(a=3,b=4\)의 곡률·비틀림을 계산하고, 수치 함수로 검증하라.
3) \(F(x,y)=x^2+y^2-R^2=0\)의 암시적 곡률공식으로 \(\kappa\)가 \(1/R\)임을 도출하라.
4) \(C^1\)만 연속인 두 Bézier 곡선을 \(G^2\)로 잇기 위한 제어점 배치 조건을 정리해 보라.

---

## 11. 요약 표

| 항목 | 핵심 공식/포인트 |
|---|---|
| 길이(파라미터) | \(L=\displaystyle\int\lVert \vec r'(t)\rVert dt\) |
| 길이(함수형) | \(L=\displaystyle\int\sqrt{1+(f')^2}\,dx\) |
| 곡률(3D) | \(\kappa=\dfrac{\lVert \vec r'\times \vec r''\rVert}{\lVert \vec r'\rVert^3}\) |
| 곡률(2D) | \(\kappa=\dfrac{|x'y''-y'x''|}{(x'^2+y'^2)^{3/2}}\) |
| 곡률(\(y=f(x)\)) | \(\kappa=\dfrac{|f''|}{(1+(f')^2)^{3/2}}\) |
| 오스큘레이팅 원 | \(R=1/\kappa,\ \vec c=\vec r+\dfrac{1}{\kappa}\hat n\) |
| 평이동·회전·재매개 | 곡률·길이는 **불변** |
| 수치 안정화 | 중심차분, 스무딩, 적응적 적분 |

---

## 12. 마무리

길이와 곡률은 곡선의 “양적 형태”를 집약해 주는 기하량이다.
