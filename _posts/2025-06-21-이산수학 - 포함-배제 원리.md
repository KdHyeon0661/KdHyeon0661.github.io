---
layout: post
title: 이산수학 - 포함-배제 원리
date: 2025-06-21 22:20:23 +0900
category: 이산수학
---
# 🧮 포함-배제 원리 (Principle of Inclusion-Exclusion)

## 📌 개요

**포함-배제 원리**는 여러 집합의 합집합에 포함된 원소의 **정확한 개수**를 구하는 기법입니다.  
서로 겹치는 조건이 있을 때, **중복을 제거하여 정확한 원소 수를 계산**할 수 있게 해주는 매우 강력한 도구입니다.

> 겹치는 부분은 **한 번만** 세야 하므로, **포함하고**, **겹친 것은 빼고**, **겹친 것을 또 빼서 빠진 건 다시 더하고...** 이런 방식으로 계산합니다.

---

## ✅ 1. 두 집합의 포함-배제

가장 기본적인 형태:

\[
|A \cup B| = |A| + |B| - |A \cap B|
\]

> A 또는 B에 속하는 원소의 수 = 각각의 원소 수를 더한 다음, **겹치는 원소를 한 번 빼줌**

---

## ✅ 2. 세 집합의 포함-배제

\[
|A \cup B \cup C| = |A| + |B| + |C| - |A \cap B| - |B \cap C| - |C \cap A| + |A \cap B \cap C|
\]

- 처음에는 각 집합의 크기를 모두 더하고  
- 두 개씩 겹치는 부분을 **빼고**  
- 세 개 모두 겹치는 부분을 **다시 더함**

---

## ✅ 3. 일반화된 포함-배제 원리

서로 다른 \( n \)개의 집합 \( A_1, A_2, ..., A_n \)이 있을 때:

\[
\left|\bigcup_{i=1}^n A_i\right|
= \sum_{i} |A_i|
- \sum_{i<j} |A_i \cap A_j|
+ \sum_{i<j<k} |A_i \cap A_j \cap A_k|
- \cdots
+ (-1)^{n+1} |A_1 \cap A_2 \cap \cdots \cap A_n|
\]

- **홀수 개의 교집합**은 더하고  
- **짝수 개의 교집합**은 뺍니다

---

## 🧪 예제 1: 1부터 100까지의 수 중 2 또는 3의 배수의 개수

- \( A \): 2의 배수, \( |A| = \left\lfloor \frac{100}{2} \right\rfloor = 50 \)  
- \( B \): 3의 배수, \( |B| = \left\lfloor \frac{100}{3} \right\rfloor = 33 \)  
- \( A \cap B \): 6의 배수, \( |A \cap B| = \left\lfloor \frac{100}{6} \right\rfloor = 16 \)

\[
|A \cup B| = 50 + 33 - 16 = 67
\]

→ 1부터 100까지 2 또는 3의 배수는 **67개**

---

## 🧪 예제 2: 세 조건 이상일 때

> 1~100 사이에서 2, 3, 5의 배수의 개수는?

- \( A = \) 2의 배수: 50  
- \( B = \) 3의 배수: 33  
- \( C = \) 5의 배수: 20

교집합:

- \( A \cap B = 6의 배수 = 16 \)  
- \( B \cap C = 15의 배수 = 6 \)  
- \( A \cap C = 10의 배수 = 10 \)  
- \( A \cap B \cap C = 30의 배수 = 3 \)

포함-배제 적용:

\[
|A \cup B \cup C| = 50 + 33 + 20 - 16 - 6 - 10 + 3 = 74
\]

---

## 🧮 4. 프로그래밍 활용 예시 (Python)

```python
from math import lcm

def count_multiples(n, divisors):
    from itertools import combinations
    total = 0
    for i in range(1, len(divisors)+1):
        for comb in combinations(divisors, i):
            l = lcm(*comb)
            cnt = n // l
            if i % 2 == 1:
                total += cnt
            else:
                total -= cnt
    return total

print(count_multiples(100, [2, 3, 5]))  # → 74
```

---

## 📦 5. 포함-배제의 주요 활용 분야

| 분야 | 활용 예시 |
|------|-----------|
| 조합론 | 조건을 만족하는 원소의 수 세기 |
| 확률 | \( P(A \cup B) = P(A) + P(B) - P(A \cap B) \) |
| 알고리즘 | 비트마스크 포함배제 (DP + 집합 계산) |
| 정수론 | 배수/공배수 개수 계산 |
| 컴퓨터공학 | Inclusion-Exclusion with Moebius Transform |

---

## 🎯 고급 예: 서로 다른 자리의 수

> 4자리 수 중에서 숫자 1, 2, 3이 모두 **포함되지 않는** 수는 몇 개인가?

전체 경우의 수: \( 9 \times 10 \times 10 \times 10 = 9000 \)

포함배제를 사용해 **1, 2, 3 중 최소 하나 이상 포함되는 수**의 개수를 구한 뒤, 전체에서 빼면 됨.

1. \( A = \) 1이 없는 수  
2. \( B = \) 2가 없는 수  
3. \( C = \) 3이 없는 수  
→ 포함배제로 \( A^c \cup B^c \cup C^c \) 크기를 구함

---

## 📚 정리

| 항목 | 내용 |
|------|------|
| 목적 | 조건이 겹치는 경우의 정확한 수 세기 |
| 핵심 공식 | \( |A \cup B| = |A| + |B| - |A \cap B| \) 등 |
| 일반화 | \( n \)개 집합일 경우 교집합 개수 계산 반복 |
| 활용 | 조합, 확률, 배수 세기, 알고리즘 등 |
| 주의 | 교집합 항목 계산 실수가 많으므로 주의해야 함 |