---
layout: post
title: 정수론 - 이차 상호법칙
date: 2025-09-09 23:25:23 +0900
category: 정수론
---
# 이차 상호법칙 — 오일러 판정기준, 르장드르 기호, 이차 상호성, 합성수 모듈러의 이차합동

> **구성/원칙**
> - 예제는 **적게** 두되 **아주 자세히** 설명한다.
> - 가능한 곳에 **증명**(또는 엄밀한 증명 스케치)을 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.
> - 표기: 홀수 소수는 $$p,q$$, 정수는 $$a,b,n$$, 오일러의 φ-함수는 $$\varphi$$.
> - “제곱잔여(residue)”는 $$x^2\equiv a\pmod m$$ 의 해가 **존재**함을 뜻한다.

---

## 0. 프롤로그 — 문제의 핵심

- 고전적 질문: **주어진 소수 \(p\)** 에 대해 어떤 정수 \(a\) 가 **제곱잔여**인가?  
- **오일러 판정기준**과 **르장드르 기호**는 이를 체계화한다.  
- 그리고 고전 정수론의 정수: **이차 상호법칙**은 “\(p\) 가 \(q\) 에 대해 제곱잔여인가?”가 “\(q\) 가 \(p\) 에 대해 제곱잔여인가?”와 **정교하게 얽혀 있음을** 밝힌다.  
- 마지막으로 합성수 모듈러에서는 **자코비 기호**, **CRT**, **헨젤 올림(Hensel lifting)** 이 작동한다.

---

## 1. 오일러 판정기준(Euler’s Criterion)

### 1.1 진술
\(p\) 를 홀수 소수, \(a\) 를 정수라 하자(편의상 \(p\nmid a\)). 그러면
$$
\boxed{\ a^{\frac{p-1}{2}}\equiv
\begin{cases}
\ \ \ 1 \pmod p, & a\ \text{가 제곱잔여일 때}\\[2mm]
-1 \pmod p, & a\ \text{가 비잔여일 때}
\end{cases}\ }
$$
특히, \(a^{\frac{p-1}{2}}\equiv \pm 1\pmod p\).

### 1.2 증명(가우스 재배열)
\((\mathbb Z/p\mathbb Z)^\times\) 는 크기 \(p-1\)의 순환군.  
\(a\) 가 제곱잔여라면 \(a\equiv x^2\) 이므로 \(a^{(p-1)/2}\equiv x^{p-1}\equiv 1\) (페르마 작은정리).  
비잔여일 때는 군론적으로 \(a\)의 거듭제곱이 정확히 반을 “부호 반전”시키는 효과를 가져 결과가 \(-1\) 이 된다(보다 초등적으로는 서로소 잔여계 \(\{\pm r\}\) 의 재배열로 증명 가능). □

> **핵심**: 제곱잔여 여부는 단 하나의 거듭제곱 값 \(a^{(p-1)/2}\) 의 부호로 판정된다.

---

## 2. 르장드르 기호 \(\displaystyle\left(\frac{a}{p}\right)\) 와 성질

### 2.1 정의
홀수 소수 \(p\) 에 대해
$$
\left(\frac{a}{p}\right)=
\begin{cases}
\ \ \ 0,& p\mid a,\\
\ \ \ 1,& a\ \text{가}\ \bmod p\ \text{의 제곱잔여},\\
-1,& a\ \text{가 비잔여}.
\end{cases}
$$

### 2.2 기본 성질(곱셈성, 모듈러 의존성, 오일러)
1) **곱셈성**  
   $$
   \left(\frac{ab}{p}\right)=\left(\frac{a}{p}\right)\left(\frac{b}{p}\right).
   $$

2) **모듈러 의존성(법 \(p\) 에서의 잔여만 중요)**  
   $$
   a\equiv b\pmod p\Rightarrow \left(\frac{a}{p}\right)=\left(\frac{b}{p}\right).
   $$

3) **오일러 판정기준**  
   $$
   \boxed{\ \left(\frac{a}{p}\right)\equiv a^{\frac{p-1}{2}}\ (\bmod p)\ \ } \quad(\text{값은 } \pm1 \text{ 또는 }0).
   $$

4) **\((-1/p)\), \((2/p)\) 보충정리(“Supplement”)**
   $$
   \left(\frac{-1}{p}\right)=(-1)^{\frac{p-1}{2}}=
   \begin{cases}
   +1,& p\equiv 1\ (\bmod 4)\\
   -1,& p\equiv 3\ (\bmod 4)
   \end{cases}
   $$
   $$
   \left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=
   \begin{cases}
   +1,& p\equiv \pm1\ (\bmod 8)\\
   -1,& p\equiv \pm3\ (\bmod 8)
   \end{cases}
   $$

**증명 스케치**  
(1)(2)는 정의와 군론적 해석에서 즉시. (3)은 §1.2.  
(4) \((-1/p)\) 는 오일러 기준에 \(a=-1\) 을 넣으면 되고, \((2/p)\) 는 **가우스의 레마(Gauss’s lemma)** 로 표준적으로 증명한다.

---

## 3. 이차 상호법칙(Quadratic Reciprocity)

### 3.1 가우스의 레마(Gauss’s lemma)
\(p\) 홀수 소수, \(\gcd(a,p)=1\). 집합
$$
S=\left\{a,2a,\dots,\frac{p-1}{2}a\right\}
$$
의 각 원소를 법 \(p\) 에서 **가장 작은 절댓값의 대표**로 취하자(즉 \((-\frac{p}{2},\frac{p}{2}]\) 범위의 정수). 이때 그 대표들 중 **음수의 개수**를 \(\nu\) 라 하면
$$
\boxed{\ \left(\frac{a}{p}\right)=(-1)^{\nu}\ }.
$$
**아이디어**: 부호만 바뀌는 쌍들의 곱이 정해져 있고, 전체 곱 비교로 위 식을 얻는다.

### 3.2 이차 상호법칙(정확한 진술)
서로 다른 홀수 소수 \(p,q\) 에 대해
$$
\boxed{\ \left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=(-1)^{\frac{p-1}{2}\cdot\frac{q-1}{2}}\ }.
$$
즉,
- \(p\equiv 1\ (\bmod 4)\) 또는 \(q\equiv 1\ (\bmod 4)\) 이면 \(\left(\frac{p}{q}\right)=\left(\frac{q}{p}\right)\) (대칭).
- \(p\equiv q\equiv 3\ (\bmod 4)\) 이면 \(\left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right)\) (부호 반전).

**보충정리 재기술**: \((-1/p)\), \((2/p)\) 는 상호법칙의 **보충**으로 함께 기술되는 것이 전통적이다.

### 3.3 증명 스케치(가우스의 레마 버전)
- \(\displaystyle \left(\frac{p}{q}\right)=(-1)^{\nu_p}\), \(\displaystyle \left(\frac{q}{p}\right)=(-1)^{\nu_q}\) 로 두고, \(\nu_p,\nu_q\) 는 각각 \(\{p,2p,\dots,\frac{q-1}{2}p\}\) 와 \(\{q,2q,\dots,\frac{p-1}{2}q\}\) 의 **음수 대표 개수**.  
- 적절한 격자점 카운팅/면적 인수분해를 통해 \(\nu_p+\nu_q=\frac{p-1}{2}\cdot \frac{q-1}{2}\) 를 얻는다.  
- 따라서 곱은 위 지수의 \((-1)\) 거듭제곱이 된다.

> **메시지**: 상호법칙은 “둘 중 하나의 모듈러에서의 제곱성”이 다른 한쪽의 제곱성과 **짝수/홀수 정보**로 얽혀 있음을 말한다.

---

## 4. 모듈러스가 **합성수**인 이차합동 \(x^2\equiv a\pmod n\)

합성수 \(n\) 에서는 **자코비 기호**와 **CRT**, 그리고 소수멱에서의 해법(헨젤 올림)이 핵심이다.

### 4.1 자코비 기호 \(\left(\frac{a}{n}\right)\) (정의와 주의)
\(n\) 이 양의 **홀수** 합성수일 때, 소인수분해 \(n=\prod p_i^{\alpha_i}\) 에 대해
$$
\boxed{\ \left(\frac{a}{n}\right):=\prod_i \left(\frac{a}{p_i}\right)^{\alpha_i}\ }.
$$
- 르장드르 기호의 **형식적 확장**이지만, \(\left(\frac{a}{n}\right)=1\) 이라고 해서 **제곱잔여를 보장하지 않는다**(필요조건일 뿐, 충분조건 아님).
- 그러나 **빠른 계산**과 **필터링**에는 유용하다.

### 4.2 CRT(중국인의 나머지 정리) 전략
\(n=\prod p_i^{\alpha_i}\) 라면
$$
x^2\equiv a\pmod n
\quad\Longleftrightarrow\quad
x^2\equiv a\pmod {p_i^{\alpha_i}}\ \text{를 모든 \(i\)에 대해 동시 만족}.
$$
- 각 소수멱 모듈러에서 해를 **독립적으로** 구한 뒤, **CRT**로 결합.

### 4.3 소수멱에서의 해: \(p\) 홀수, \(k\ge 1\)
- **기본 스텝**: \(x_1^2\equiv a\pmod p\) 의 해가 **존재**해야 한다(르장드르 기호로 판정).  
- **헨젤 올림(Hensel’s lemma)**: \(p\nmid 2x_1\) 이면 해는 **유일하게** \(p^k\) 까지 올려진다. 즉
  $$
  x\equiv x_1 + t p\ \ (\bmod p^2),\ \text{적당한 }t\in\{0,\dots,p-1\}
  $$
  부터 시작해 귀납적으로 한 자리씩 해결 가능. 결국 \(p\) 홀수에선 “mod \(p\) 해 ⇔ mod \(p^k\) 해”가 **동치**(특수한 퇴화 경우 제외).

- **해의 개수**: \(p\nmid a\) 이면 \(x^2\equiv a\pmod {p^k}\) 의 해는 **정확히 2개**(서로 부호 반대). \(p\mid a\) 인 경우는 별도 취급.

### 4.4 \(2\)-멱 모듈러
- \(x^2\equiv a\pmod{2}\): \(a\equiv 0,1\) 모두 가능(자명).
- \(\pmod 4\): 제곱은 \(0,1\). 즉 \(x^2\equiv a\pmod 4\) 는 \(a\equiv 0,1\) 일 때만 가능.
- \(\pmod{8}\): 홀수의 제곱은 모두 \(1\). 따라서 \(x^2\equiv a\pmod 8\) 은 \(a\equiv 0,1,4\) 일 때만 가능.
- \(k\ge 3\) 에서 \(x\) 가 홀수이면 \(x^2\equiv 1\pmod 8\) 이므로, \(a\) 가 홀수이면 **\(a\equiv 1\pmod 8\)** 일 때만 해가 있다. 그 후에는 헨젤 올림으로 \(2^k\) 까지 끌어올린다.

> 요약: \(2^k\) 에서의 패턴은 “짝/홀 구분 + \(a \bmod 8\)”로 판정 후 올림.

---

## 5. 예제(적게, 그러나 자세히)

### 예제 1 — **오일러 판정**과 르장드르 기호: \(a=5,\ p=11\)
오일러 기준으로
$$
5^{\frac{11-1}{2}}=5^5\pmod{11}\ \text{를 계산}.
$$
빠른 거듭제곱:
$$
5^2=25\equiv 3,\quad 5^4\equiv 3^2=9,\quad 5^5\equiv 5\cdot 9=45\equiv 1\ (\bmod 11).
$$
따라서 \(5\) 는 \(\bmod 11\) 의 제곱잔여,
$$
\left(\frac{5}{11}\right)=+1.
$$
실제로 해를 찾으면 \(x^2\equiv 5\pmod{11}\) 의 해는 \(x\equiv \pm 4\) (왜냐하면 \(4^2=16\equiv 5\)).

---

### 예제 2 — **이차 상호법칙**: \(\left(\frac{29}{43}\right)\) 계산
\(29,43\) 은 모두 \(3\ (\bmod 4)\) 이다:
$$
29\equiv 1\ (\bmod 4)\quad\text{아님},\quad 29\equiv 1? 29\equiv 1\ (\bmod 4)\ \text{맞음},\quad 43\equiv 3\ (\bmod 4).
$$
(정확히는 \(29\equiv 1\), \(43\equiv 3\) mod 4.) 그러므로 상호법칙으로
$$
\left(\frac{29}{43}\right)=\left(\frac{43}{29}\right)\cdot (-1)^{\frac{29-1}{2}\cdot\frac{43-1}{2}}
=\left(\frac{43}{29}\right)\cdot (-1)^{14\cdot 21}=\left(\frac{43}{29}\right)
$$
(지수는 짝수 → 부호 \(+1\)). 이제 \(\bmod 29\) 로 축소:
$$
43\equiv 43-29=14\quad\Rightarrow\quad \left(\frac{43}{29}\right)=\left(\frac{14}{29}\right)=\left(\frac{2}{29}\right)\left(\frac{7}{29}\right).
$$
보충정리 \((2/p)\): \(29\equiv 5\equiv -3\ (\bmod 8)\) 이므로
$$
\left(\frac{2}{29}\right)=(-1)^{\frac{29^2-1}{8}}=(-1)^{\frac{840}{8}}=(-1)^{105}=-1.
$$
또,
$$
\left(\frac{7}{29}\right)=\left(\frac{29}{7}\right)\cdot (-1)^{\frac{7-1}{2}\cdot\frac{29-1}{2}}
=\left(\frac{1}{7}\right)\cdot(-1)^{3\cdot 14}=\left(\frac{1}{7}\right)\cdot(+1)=+1.
$$
(여기서 \(29\equiv 1\ (\bmod 7)\), 제곱잔여성은 자명.)
따라서
$$
\left(\frac{29}{43}\right)=(-1)\cdot(+1)=-1.
$$
즉 \(29\) 는 \(\bmod 43\) 의 **비잔여**.

> 같은 절차로 다른 예도 일관되게 처리 가능. 핵심은 **상호법칙 + 보충정리 + 작은 수로 환원**.

---

### 예제 3 — **합성수 모듈러**: \(x^2\equiv 5\pmod{77}\)
분해: \(77=7\cdot 11\) (서로소). **CRT 전략**으로
$$
\begin{cases}
x^2\equiv 5\ (\bmod 7),\\
x^2\equiv 5\ (\bmod 11).
\end{cases}
$$

1) \(\bmod 7\): \(5\equiv -2\). 르장드르 기호로
$$
\left(\frac{5}{7}\right)=\left(\frac{-1}{7}\right)\left(\frac{2}{7}\right).
$$
보충정리: \((-1/7)=(-1)^{3}= -1\). 또 \(7\equiv -1\ (\bmod 8)\Rightarrow (2/7)=+1\).  
따라서 \((5/7)=-1\). 즉 **해 없음**.

2) 이미 한쪽에서 해가 없으므로 \(\bmod 77\) 에 **해가 없다**(CRT는 각 성분에 해가 있어야 결합이 가능).

> **자코비 기호 체크**: \(\left(\frac{5}{77}\right)=\left(\frac{5}{7}\right)\left(\frac{5}{11}\right)=(-1)\cdot(+1)=-1\) 이므로 역시 불가능함을 빠르게 보여 준다. (**여기서는 충분조건**: 자코비가 \(-1\) 이면 해 없음. 반대로 자코비가 \(+1\) 이라고 **반드시** 해가 있는 것은 아니다.)

---

### 예제 4 — **소수멱으로 올리기**: \(x^2\equiv 2\pmod{3^k}\) (모든 \(k\ge 1\))
- \(\bmod 3\): 제곱은 \(0,1\). \(2\)는 **비잔여**.  
- 따라서 어떤 \(k\) 에 대해서도 \(x^2\equiv 2\ (\bmod 3^k)\) **불가능** (헨젤 올림의 필요조건 불만족).

대조: \(x^2\equiv 2\pmod{5^k}\)
- \(\bmod 5\): \(2\) 는 제곱잔여(예, \(3^2=9\equiv 4\), \(±\) 탐색으로 \(x=±3\) → 아, \(2\) 는 실제로 \(±1\) 의 제곱이 \(1\), \(±2\) 의 제곱이 \(4\). 여기서는 직접 확인하면 \(x= \pm  \)\(…\) 잠깐, 정확히는 \(2\) 는 \(\bmod 5\) **비잔여**다.**  
  체크: \(1^2=1,\ 2^2=4,\ 3^2=9\equiv 4,\ 4^2=16\equiv 1\) → 제곱잔여는 \(1,4\) 뿐 → \(2\) 는 비잔여.  
- 결론: \(5^k\) 에서도 전 범위 **불가능**.

반면 \(x^2\equiv 3\pmod{5^k}\)  
- \(\bmod 5\): \(3\equiv -2\) 이고 \((-2/5)=(-1/5)(2/5)=(+1)(-1)=-1\) → 비잔여. (따라서 불가능.)  
- 예시를 바꿔 \(x^2\equiv 4\pmod{5^k}\) 는 가능(해는 \(x\equiv \pm 2\) 를 헨젤로 올리면 됨).  

> 메시지: **mod \(p\) 에서 잔여인지**가 전부를 좌우(홀수 \(p\)).

---

## 6. 계산·이론 팁 정리

1) **소수 \(p\)** 에서 \(a\) 의 제곱성  
   - 오일러: \(a^{(p-1)/2}\equiv \pm 1\).  
   - 르장드르: \((a/p)\) 를 **상호법칙 + 보충정리 + 모듈러 축소**로 빠르게 계산.

2) **합성수 \(n\)** 에서 \(x^2\equiv a\)  
   - 먼저 **자코비 기호** \((a/n)\) 로 **필터링**: \(-1\) 이면 **즉시 불가능**. \(+1\) 이면 **가능성**만 의미.  
   - 각 소수멱 모듈러에서 해를 찾고 **헨젤**로 올린 후, **CRT**로 결합.

3) **\(2^k\)**  
   - \(a\equiv 1\ (\bmod 8)\) (홀수 \(a\))가 필요충분 조건(해가 있으면 유일하게 올려짐).  
   - 짝수 \(a\) 는 별도 케이스 분기.

4) **해의 개수**  
   - \(n=\prod p_i^{\alpha_i}\), 각 홀수 소수멱에서 \(p_i\nmid a\) 이면 해가 생기면 **둘씩**(±).  
   - 전체 해 개수는 성분 해의 **곱**(CRT 독립성).

---

## 7. (간단 연습) — 스스로 해보기 위한 가이드

1) \(\left(\frac{13}{37}\right)\) 를 계산하라.  
   *힌트*: 상호법칙으로 \((37/13)\) 로 넘기고, 보충정리로 \(2\) 와 \(-1\) 을 처리.

2) \(x^2\equiv 10\pmod{21}\) 의 해 존재를 판정하라.  
   *힌트*: \(21=3\cdot 7\). 자코비 \((10/21)=(10/3)(10/7)\) 으로 시작.

3) \(x^2\equiv a\pmod{2^k}\) 의 필요충분 조건을 정리하라.  
   *힌트*: \(k\ge 3\) 에서 홀수 \(x\) 의 제곱은 모두 \(1\pmod 8\).

---

## 8. 요약 맵

- **오일러 판정기준**:  
  $$
  a^{\frac{p-1}{2}}\equiv \left(\frac{a}{p}\right)\pmod p,\qquad (\pm1,0)
  $$
  제곱잔여성의 일격 판정.

- **르장드르 기호**: 곱셈성·보충정리 \((\!-1/p),(2/p)\)·상호법칙으로 **계산기** 완성.

- **이차 상호법칙**:  
  $$
  \left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=(-1)^{\frac{p-1}{2}\cdot\frac{q-1}{2}},
  $$
  “서로의 제곱성”의 상호 관계를 결정.

- **합성수 모듈러**: 자코비 기호는 **필요조건**, 실제 해는 **소수멱**에서 **헨젤+CRT**로 조립.  
  \(2^k\) 는 \(a\equiv 1\pmod 8\) (홀수 \(a\))가 핵심.

> 이 체계를 익히면, 제곱잔여 판정과 이차합동의 해법이 **선형화·분해·재조립**의 관점에서 선명하게 정리된다.  
> 상호법칙은 그 정수론적 “대칭성”의 정점으로, 이후 고차 잔여(큐브 잔여 등)와 대수적 수론(이차체, 이데아 클래스군)으로 자연스럽게 이어진다.