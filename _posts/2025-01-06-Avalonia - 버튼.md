---
layout: post
title: Avalonia - ë²„íŠ¼
date: 2025-01-06 19:20:23 +0900
category: Avalonia
---
# ğŸ”˜ Avalonia MVVMì—ì„œ ë²„íŠ¼ ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸°

## âœ… ëª©í‘œ

- ReactiveCommandë¥¼ ì‚¬ìš©í•œ ë²„íŠ¼ ê¸°ëŠ¥ êµ¬í˜„
- ë²„íŠ¼ ë¹„í™œì„±í™”/í™œì„±í™” ì œì–´ (`CanExecute`)
- ë¹„ë™ê¸° ì²˜ë¦¬ (`async Command`)
- ë²„íŠ¼ í´ë¦­ í›„ UI ì—…ë°ì´íŠ¸

---

## ğŸ§© ì‚¬ìš© ê¸°ìˆ 

| ê¸°ìˆ  | ì„¤ëª… |
|------|------|
| `ReactiveCommand` | MVVM ë°©ì‹ì˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ì²˜ë¦¬ |
| `CanExecute` | ì¡°ê±´ì— ë”°ë¼ ë²„íŠ¼ í™œì„±/ë¹„í™œì„± |
| `async` / `await` | ë¹„ë™ê¸° ì²˜ë¦¬ ì§€ì› |
| `RaiseCanExecuteChanged` | ì¡°ê±´ ë³€í™”ì— ë”°ë¼ ë²„íŠ¼ ìƒíƒœ ê°±ì‹  |

---

## ğŸ“ êµ¬ì¡°

- View: `ButtonView.axaml`
- ViewModel: `ButtonViewModel.cs`

---

## ğŸ›ï¸ ViewModel: `ButtonViewModel.cs`

```csharp
using ReactiveUI;
using System;
using System.Reactive;
using System.Reactive.Linq;
using System.Threading.Tasks;

public class ButtonViewModel : ReactiveObject
{
    private string _status;
    private bool _canClick = true;

    public string Status
    {
        get => _status;
        set => this.RaiseAndSetIfChanged(ref _status, value);
    }

    public bool CanClick
    {
        get => _canClick;
        set => this.RaiseAndSetIfChanged(ref _canClick, value);
    }

    public ReactiveCommand<Unit, Unit> ClickCommand { get; }
    public ReactiveCommand<Unit, Unit> AsyncCommand { get; }

    public ButtonViewModel()
    {
        Status = "ëŒ€ê¸° ì¤‘...";

        var canClickObservable = this.WhenAnyValue(x => x.CanClick);

        ClickCommand = ReactiveCommand.Create(OnClick, canClickObservable);
        AsyncCommand = ReactiveCommand.CreateFromTask(OnAsyncClick, canClickObservable);
    }

    private void OnClick()
    {
        Status = $"[{DateTime.Now:T}] ë²„íŠ¼ í´ë¦­ë¨!";
    }

    private async Task OnAsyncClick()
    {
        CanClick = false;
        Status = "ì²˜ë¦¬ ì¤‘...";

        await Task.Delay(2000); // 2ì´ˆ ëŒ€ê¸°

        Status = $"[{DateTime.Now:T}] ì™„ë£Œ!";
        CanClick = true;
    }
}
```

---

## ğŸ–¼ï¸ View: `ButtonView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="MyAvaloniaApp.Views.ButtonView"
             xmlns:vm="clr-namespace:MyAvaloniaApp.ViewModels"
             Width="400" Height="200">

    <UserControl.DataContext>
        <vm:ButtonViewModel/>
    </UserControl.DataContext>

    <StackPanel Margin="20" Spacing="10">
        <TextBlock Text="{Binding Status}" FontSize="16"/>

        <Button Content="ë™ê¸° ë²„íŠ¼ í´ë¦­"
                Command="{Binding ClickCommand}" />

        <Button Content="ë¹„ë™ê¸° ë²„íŠ¼ í´ë¦­ (2ì´ˆ ëŒ€ê¸°)"
                Command="{Binding AsyncCommand}" />
    </StackPanel>
</UserControl>
```

---

## ğŸ” ê¸°ëŠ¥ ì„¤ëª…

| ë²„íŠ¼ ê¸°ëŠ¥ | ì„¤ëª… |
|-----------|------|
| âœ… ê¸°ë³¸ í´ë¦­ | `OnClick()`ìœ¼ë¡œ ì¦‰ì‹œ ë°˜ì‘ |
| â³ ë¹„ë™ê¸° í´ë¦­ | `async Task`ë¡œ ì²˜ë¦¬ í›„ ì™„ë£Œ í‘œì‹œ |
| ğŸ”’ ìƒíƒœ ì œì–´ | `CanClick` ê°’ì— ë”°ë¼ ë²„íŠ¼ í™œì„±/ë¹„í™œì„± |
| ğŸ”„ ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸ | `WhenAnyValue`ë¡œ Reactiveí•˜ê²Œ ì²˜ë¦¬ |

---

## ğŸ§  ê³ ê¸‰ í™•ì¥ íŒ

| ê¸°ëŠ¥ | êµ¬í˜„ ë°©ì‹ |
|------|-----------|
| ë¡œë”© ì¤‘ ë²„íŠ¼ ë¹„í™œì„±í™” | `CanClick = false` ì²˜ë¦¬ |
| ë²„íŠ¼ í´ë¦­ ì‹œ ìŠ¤í”¼ë„ˆ í‘œì‹œ | `IsBusy` ìƒíƒœ ë°”ì¸ë”© + ì• ë‹ˆë©”ì´ì…˜ |
| ì…ë ¥ ì¡°ê±´ ë§Œì¡± ì‹œ í™œì„±í™” | `WhenAnyValue(x => x.InputText, ...)` |

---

## âœ… ì •ë¦¬

- ë²„íŠ¼ì€ **ReactiveCommand**ë¡œ ì²˜ë¦¬í•˜ë©´ MVVMì— ì í•©í•©ë‹ˆë‹¤.
- ìƒíƒœì— ë”°ë¼ ë²„íŠ¼ì„ í™œì„±í™”/ë¹„í™œì„±í™”í•˜ë ¤ë©´ `CanExecute`ì— í•´ë‹¹í•˜ëŠ” `Observable`ì„ ì—°ê²°í•©ë‹ˆë‹¤.
- ë¹„ë™ê¸° ì²˜ë¦¬ë„ ì‰½ê²Œ ê°€ëŠ¥í•˜ë©° UIì™€ ìƒíƒœ ê°±ì‹ ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°ë©ë‹ˆë‹¤.
