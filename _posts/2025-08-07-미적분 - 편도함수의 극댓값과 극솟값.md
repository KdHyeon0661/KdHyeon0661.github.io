---
layout: post
title: 미적분 - 편도함수의 극댓값과 극솟값
date: 2025-08-07 22:20:23 +0900
category: 미적분
---
# 편도함수의 극댓값과 극솟값

- 편도함수 \(f_{x_i}\)는 \(\mathbb{R}^n\to\mathbb{R}\)인 **새로운 함수**다.  
- 따라서 \(f_{x_i}\)의 극값은 **그 자체의 임계점**(일차 미분 0)·**이차 미분 판정**·**경계 점검**으로 찾는다.  
- 동시에 \(f_{x_i}\)는 **그래디언트의 좌표성분**이므로, \(|f_{x_i}|\le \|\nabla f\|\) 및 방향도함수의 최대 \(\|\nabla f\|\) 등 **투영·기하적 불등식**으로 강한 상계를 얻을 수 있다.

아래에서 2변수 \((x,y)\)를 기본으로 전개하고, \(n\)변수로 자연스럽게 일반화한다. 수식은 MathJax의 $$\cdots$$, 코드는 ```로 감싼다.

---

## 1. 문제 설정: “편도함수의 극값”이란?

### 1.1 편도함수의 정의 재확인
함수 \(f:\mathbb{R}^2\to\mathbb{R}\), 편도함수
$$
f_x(x,y)=\frac{\partial f}{\partial x}(x,y),\qquad
f_y(x,y)=\frac{\partial f}{\partial y}(x,y).
$$
두 함수 \(f_x,f_y:\mathbb{R}^2\to\mathbb{R}\)의 **극대/극소** 문제를 푼다.

- **내부(Interior) 극값**: 열린 영역 내부 점 \((x_0,y_0)\)에서 \(f_x\) (혹은 \(f_y\))가 국소 최대/최소.
- **경계(Boundary) 극값**: 닫힌·유계 영역의 경계 위에서의 최대/최소.
- **전역(Global) 극값**: 주어진 영역 전체에서의 최대/최소.

### 1.2 왜 중요한가?
- **기하적 의미**: \(f_x,f_y\)는 각각 \(x\)·\(y\)축 방향의 **국소 경사**.  
  \(f_x\) 최대는 “\(x\)-방향으로 가장 가파른 상승” 지점.  
- **수치/영상**: \(|f_x|\), \(|f_y|\)는 방향성 에지 강도. 최댓값 위치는 강한 방향성 변화.  
- **모델링/물리**: 열장·압력장 등에서 특정 방향 변형률의 최대/최소 탐색.

---

## 2. 해석적 기반: 그래디언트와 투영

### 2.1 방향도함수와 그래디언트
단위벡터 \(\mathbf{u}=(\cos\theta,\sin\theta)\)에 대한 방향도함수
$$
D_{\mathbf{u}}f(x,y) \;=\; \nabla f(x,y)\cdot \mathbf{u}.
$$
**코시–슈바르츠**에 의해
$$
|D_{\mathbf{u}} f(x,y)| \le \|\nabla f(x,y)\|.
$$
특히 좌표방향 \(\mathbf{e}_x=(1,0),\ \mathbf{e}_y=(0,1)\)에 대해
$$
|f_x(x,y)| \le \|\nabla f(x,y)\|,\qquad |f_y(x,y)| \le \|\nabla f(x,y)\|.
$$

### 2.2 방향도함수의 최대
모든 단위 \(\mathbf{u}\) 중 \(\max |D_{\mathbf{u}}f|=\|\nabla f\|\).  
즉, “편도함수의 최대”는 “방향도함수의 최대”보다 작거나 같다:
$$
\max_{\text{domain}} |f_x| \;\le\; \max_{\text{domain}} \|\nabla f\|.
$$
상계가 필요한 응용(예: 안정성·오차전파)에서 유용하다.

---

## 3. 내부 극값 조건(제약 없음)

### 3.1 일차 조건(정상점)
함수 \(g=f_x\)의 내부 극값 \((x_0,y_0)\)에서
$$
\frac{\partial}{\partial x}f_x(x_0,y_0)=f_{xx}(x_0,y_0)=0,\qquad
\frac{\partial}{\partial y}f_x(x_0,y_0)=f_{xy}(x_0,y_0)=0.
$$
즉, \(f_{xx}=0,\ f_{xy}=0\)이 **동시에** 성립해야 한다.  
(마찬가지로 \(f_y\)의 경우 \(f_{yy}=0,\ f_{xy}=0\).)

> 해석: \(f_x\)의 그래디언트 \(\nabla (f_x)=(f_{xx},f_{xy})\)가 0인 점.

### 3.2 이차 조건(판정)
\(f_x\)의 해시안
$$
H_{f_x}=
\begin{pmatrix}
f_{xxx} & f_{xxy}\\
f_{xxy} & f_{xyy}
\end{pmatrix},
$$
(즉, \(f\)의 **3계 편도함수**들)에서 **양의 정부호**면 \(f_x\)의 **국소 최소**, **음의 정부호**면 **국소 최대**. 부정부호면 안장.

> 실무 관점: 3계 도함수를 써야 하므로, “편도함수의 극값” 문제는 “원함수의 3계 미분”까지 요구할 수 있다.

---

## 4. 경계 포함(유계 영역 \(\Omega\subset \mathbb{R}^2\))

### 4.1 극값 존재
\(\overline{\Omega}\)가 **콤팩트**이고 \(f_x\)가 연속이면, **전역 극대/극소가 존재**(최대·최소값 정리).  
따라서
1) 내부 임계점(\(f_{xx}=f_{xy}=0\))  
2) **경계 \(\partial\Omega\)** 점검이 모두 필요.

### 4.2 경계에서의 판정
- 경계가 **매개곡선** \(\gamma(t)=(x(t),y(t))\)이면, \(f_x(\gamma(t))\)를 **1변수 함수**로 보고 극값 판정을 수행:
  $$
  \frac{d}{dt}\,f_x(x(t),y(t))=f_{xx}\,x'(t)+f_{xy}\,y'(t).
  $$
- 경계가 **제약식** \(g(x,y)=0\)이면, **라그랑주 승수법**으로 \(f_x\)의 극값을 찾는다:
  $$
  \nabla(f_x)=\lambda\,\nabla g.
  $$

---

## 5. 상계/안정성: 리프시츠·평활성

### 5.1 리프시츠 상계(평활성 \(C^{2}\))
만약 \(\nabla f\)가 리프시츠 연속(예: \(f\in C^{1,1}\))이면  
\(\|\nabla f(x)-\nabla f(y)\|\le L\|x-y\|\). 이때
$$
|f_x(x)| \le |f_x(x_0)| + L\|x-x_0\|.
$$
**국소 최대 상계**에 유용.

### 5.2 \(\|\nabla f\|\)와의 연동
이미 본 대로 \(|f_x|\le \|\nabla f\|\).  
따라서 \(\|\nabla f\|\)의 전역 상계를 알고 있으면, \(f_x\)의 전역 상계도 즉시 확보.

---

## 6. 계산 레시피(체크리스트)

1) **문제 설정**: \(f\), 목표 편도함수 \(g=f_x\) 또는 \(g=f_y\).  
2) **내부 임계점**: \(\nabla g=0\) → \(f_{xx}=f_{xy}=0\) (또는 \(f_{yy}=f_{xy}=0\)).  
3) **판정**: \(H_g\)의 정부호성 검사 → 최대/최소/안장.  
4) **경계 점검**: (콤팩트 영역일 때) 경계 매개화 또는 라그랑주 승수로 \(g\) 극값 탐색.  
5) **전역 결론**: 내부·경계 후보들 중 최대/최소 선정.  
6) **상계 확인**: \(|g|\le \|\nabla f\|\) 등 보조 상계로 sanity check.  
7) **수치 검증**: 샘플링·기울기 기반 탐색으로 결과 확인.

---

## 7. 예제 세트

### 예제 A — 다항: \(f(x,y)=x^3-3xy^2\)

고전적 사들 포인트 예제. 먼저 목표를 **\(f_x\)의 극값**으로 둔다.

- 편도, 혼합:
  $$
  f_x=3x^2-3y^2,\qquad f_y=-6xy.
  $$
- \(g:=f_x\)의 내부 임계점 \(\nabla g=0\):
  $$
  g_x=f_{xx}=6x=0 \Rightarrow x=0,\qquad
  g_y=f_{xy}=-6y=0 \Rightarrow y=0.
  $$
  → 유일한 내부 후보: \((0,0)\).
- 이차 판정에 필요한 \(H_{g}\):
  $$
  g_{xx}=f_{xxx}=6,\quad
  g_{xy}=f_{xxy}=0,\quad
  g_{yy}=f_{xyy}=-6.
  $$
  따라서
  $$
  H_g(0,0)=\begin{pmatrix}6&0\\0&-6\end{pmatrix}.
  $$
  한 방향 양, 한 방향 음 → **안장점**.  
  즉, \(f_x=3x^2-3y^2\)는 \((0,0)\)에서 극대/극소가 아니라 안장.

- **영역 제약**이 있으면 결과가 바뀔 수 있다. 예를 들어 \(D=\{x^2+y^2\le 1\}\)에서 \(f_x\)의 전역 극값은 경계 \(x^2+y^2=1\)에서 발생:
  $$
  f_x|_{\partial D}=3(x^2-y^2)=3\cos(2\theta),\quad \max=3,\ \min=-3.
  $$
  내부 안장이라도 **콤팩트 영역에서는 경계에서 전역 극값**이 생길 수 있음을 보여 준다.

### 예제 B — 삼각/지수 혼합: \(f(x,y)=e^{x}\sin y\)

- 편도:
  $$
  f_x=e^{x}\sin y,\qquad f_y=e^{x}\cos y.
  $$
- 내부 임계점(제약 없음)에서 \(g=f_x\)의 \(\nabla g=0\):
  $$
  g_x=f_{xx}=e^x\sin y=0,\quad
  g_y=f_{xy}=e^x\cos y=0.
  $$
  두 식을 동시에 만족하려면 \(e^x\neq 0\)이므로 \(\sin y=0\)과 \(\cos y=0\)을 동시에 만족해야 한다. 불가능.  
  → **내부 임계점 없음**.  
- 따라서 **제약 없는 전역 극값은 존재하지 않는다**(무한영역·주기성).  
  반면, 사각형 \(D=[a,b]\times[c,d]\) 같은 콤팩트 영역에서는 **경계**에서 최대/최소를 갖는다.  
  예: \(D=[0,1]\times[0,\pi]\).  
  경계 \(y=0,\pi\)에서 \(f_x=0\). \(y=\pi/2\)에서 \(f_x=e^x\)이 최대화 → \(x=1\)에서 최대 \(e\).  
  결론: \(\max_{D} f_x=e\), \(\min_{D} f_x=0\).

### 예제 C — “절댓값” 최소화: \(|f_x|\)의 최소

범함수적 관점에서 “드리프트 없는 \(x\)-방향” 지점을 찾고 싶을 때 \(|f_x|\)의 최소(=0) 지점을 구한다.  
예: \(f(x,y)=\ln(1+x^2+y^2)\).  
- \(f_x=\dfrac{2x}{1+x^2+y^2}\).  
- \(|f_x|\)를 최소화하려면 \(x=0\) (모든 \(y\)).  
- \(|f_x|\)의 최대는 주어진 영역에서 \(x^2+y^2\)가 작고 \(|x|\)가 큰 곳에서 달성.

### 예제 D — 제약(곡선 경계): 타원 경계 위에서 \(f_x\) 극값

\(f(x,y)=x^2+y^2\), 타원 \(g(x,y)=\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}-1=0\) 위에서 \(f_x=2x\)의 극값.
- 라그랑주:
  $$
  \nabla (f_x)=(2,0)=\lambda\,\nabla g=\lambda\Big(\tfrac{2x}{a^2},\tfrac{2y}{b^2}\Big).
  $$
  두 번째 성분 \(0=\lambda\tfrac{2y}{b^2}\Rightarrow y=0\) (혹은 \(\lambda=0\)은 불가능).  
  경계식에서 \(x=\pm a\).  
  따라서 \(f_x=2x\)의 극값은 \(\pm 2a\). 즉, 타원 경계 위에서 \(x\)-편도함수는 \(\pm 2a\)의 전역 극값을 갖는다.

---

## 8. \(n\)변수 일반화

함수 \(f:\mathbb{R}^n\to\mathbb{R}\), 고정된 인덱스 \(i\)에 대해 \(g:=f_{x_i}\).
- 내부 임계점: \(\nabla g=\mathbf{0}\). 즉
  $$
  f_{x_ix_1}=\cdots=f_{x_ix_n}=0.
  $$
- 판정: \(g\)의 해시안 \(H_g=[f_{x_ix_jx_k}]_{j,k}\)의 정부호성.  
- 경계/제약: 동일한 매커니즘(매개화 · 라그랑주 승수).

---

## 9. 수치 검증(상징·샘플링)

아래 코드는 SymPy로 **해석적 임계점**을 구하고, NumPy 샘플링으로 **경계 포함 전역 극값**을 확인한다.

```python
# SymPy + NumPy: 편도함수의 극값 (예제 A, B)
import sympy as sp
import numpy as np

# 예제 A: f(x,y)=x^3 - 3xy^2
x, y = sp.symbols('x y', real=True)
fA = x**3 - 3*x*y**2
fxA = sp.diff(fA, x)
fxxA = sp.diff(fxA, x)
fxyA = sp.diff(fxA, y)

# 내부 임계점: fxx=0, fxy=0
critA = sp.solve([sp.Eq(fxxA,0), sp.Eq(fxyA,0)], [x,y], domain=sp.S.Complexes)
print("A-internal critical points of fx:", critA)  # [(0,0)]

# 해시안(H_g) 성분
fxxxA = sp.diff(fxxA, x)
fxxyA = sp.diff(fxxA, y)
fxyyA = sp.diff(fxyA, y)
HgA = sp.Matrix([[fxxxA.subs({x:0,y:0}), fxxyA.subs({x:0,y:0})],
                 [fxxyA.subs({x:0,y:0}), fxyyA.subs({x:0,y:0})]])
print("A-Hessian of g=fx at (0,0):", HgA)  # [[6,0],[0,-6]] -> saddle

# 경계 포함 전역 극값 확인: 단위원판 D={(x,y): x^2+y^2<=1}
def fxA_np(xx, yy):
    return 3*xx**2 - 3*yy**2

rs = np.linspace(0, 2*np.pi, 2001)
xs, ys = np.cos(rs), np.sin(rs)
vals = fxA_np(xs, ys)
print("A-boundary max/min over unit circle:", vals.max(), vals.min())  # ~ 3, -3

# 예제 B: f(x,y)=e^x sin y, D=[0,1]x[0,pi]
fB = sp.exp(x)*sp.sin(y)
fxB = sp.diff(fB, x)
fxxB = sp.diff(fxB, x)
fxyB = sp.diff(fxB, y)

# 내부 임계점: fxx=0, fxy=0 -> e^x sin y=0 and e^x cos y=0 -> no solution
critB = sp.solve([sp.Eq(fxxB,0), sp.Eq(fxyB,0)], [x,y], domain=sp.S.Complexes)
print("B-internal critical points of fx:", critB)  # []

# 경계 포함 전역 극값: 샘플링
def fxB_np(xx, yy):
    return np.exp(xx)*np.sin(yy)

xs = np.linspace(0, 1, 401)
ys = np.linspace(0, np.pi, 401)
X, Y = np.meshgrid(xs, ys, indexing='xy')
vals = fxB_np(X, Y)
print("B-domain max/min approx:", vals.max(), vals.min())  # max~e at (1,pi/2), min~0 on y=0,pi
```

---

## 10. 실무 팁과 함정

1) **“편도함수의 극값” vs “원함수의 극값”**  
   \(f_x=0\)은 \(f\)의 극값 조건(필요조건) 중 하나일 뿐이고, 여기서는 **\(f_x\) 자체**의 극값을 논한다. 서로 다르다.

2) **연속성/미분가능성 가정**  
   내부 극값 분석엔 최소한 \(f\in C^2\) (적어도 \(f_{xx},f_{xy}\) 연속) 필요. 판정에는 3계 미분까지 쓰일 수 있다.

3) **경계가 전부**  
   콤팩트 영역에서 전역 극값은 경계에서 발생하는 경우가 흔하다(예제 A, B). 내부 임계점이 “없거나 안장”이어도 경계에서 극값.

4) **좌표 의존성**  
   \(f_x\)는 좌표 선택에 따라 달라진다. 회전 좌표에선 달라진다. **좌표 불변인 최대 방향 도함수**는 \(\|\nabla f\|\)로 주어진다.

5) **수치 민감성**  
   3계 미분은 노이즈에 취약. 실무에서는 수치 미분 대신 **심볼릭**(가능하면)·**정규화/스무딩** 후 판정.

---

## 11. 확장: \(|f_x|\)의 전역 상계와 그래디언트 노름

- 영역 \(\Omega\)에서 \(\|\nabla f\|\le M\)이면 \(|f_x|\le M\).  
- **에너지 기반 상계**: \(\int_\Omega \|\nabla f\|^2\)가 작으면 \(|f_x|\)의 \(L^2\)-노름도 작다. 엣지 검출·레귤러라이제이션에 응용.

---

## 12. 연습문제(정답 스케치)

1) \(f(x,y)=\sin(xy)+x^2y\).  
   (a) \(f_x=y\cos(xy)+2xy\). 내부 임계점: \(f_{xx}=-y^2\sin(xy)+2y=0,\ f_{xy}=\cos(xy)-xy\sin(xy)+2x=0\).  
   (b) 정사각형 \(D=[0,1]^2\)에서 \(f_x\)의 전역 극값을 경계 포함으로 찾고 수치 검증.

2) \(f(x,y)=e^{-(x^2+y^2)}\).  
   \(f_x=-2x e^{-(x^2+y^2)}\). 디스크 \(x^2+y^2\le 1\)에서 \(|f_x|\)의 최대는 어디인가? 힌트: 극좌표 사용.

3) 타원 경계 \(x^2/a^2+y^2/b^2=1\) 위에서 \(f(x,y)=xy\)의 \(f_x\) 극값.

4) \(n\)변수 \(f(\mathbf{x})=\phi(\|\mathbf{x}\|^2)\)에서 \(f_{x_i}\)의 전역 상계와 내부 임계점 조건.

---

## 13. 한 페이지 요약

1) 목표는 **\(g=f_{x_i}\)**의 극값 문제다.  
2) 내부 극값 → \(\nabla g=\mathbf{0}\) (예: \(f_{xx}=f_{xy}=0\) in 2D).  
3) 판정 → \(H_g\)의 정부호성(3계 미분 등장).  
4) 콤팩트 영역 → **경계 검사 필수**(매개화/라그랑주).  
5) 좌표독립 상계 → \(|f_{x_i}|\le \|\nabla f\|\), 방향도함수 최대는 \(\|\nabla f\|\).  
6) 수치검증 → 샘플링/격자탐색으로 내부·경계 후보 확인.