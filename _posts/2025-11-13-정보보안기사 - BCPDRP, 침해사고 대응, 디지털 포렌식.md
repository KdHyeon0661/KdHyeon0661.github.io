---
layout: post
title: 정보보안기사 - BCP/DRP, 침해사고 대응, 디지털 포렌식
date: 2025-11-13 23:25:31 +0900
category: 정보보안기사
---
# SECTION 17 정보보안 일반/관리 — 05 BCP/DRP · 06 침해사고 대응 · 07 디지털 포렌식

## 0) 개요
본 글은 “정보보안 일반/관리”의 세 축 **업무 연속성 계획(BCP)**, **재해복구계획(DRP)**, **침해사고 대응(IR)**, **디지털 포렌식(DF)**을 **실무·실기 관점**에서 통합 설계한다.  
요구 사항 → 문서 구조 → 절차/조직 → 기술 패턴 → 연습/테스트 → 측정/개선 순서로 전개하고, 각 절에 **핵심 체크리스트, 예제 코드/명령, 템플릿**을 제시한다.

---

## 1) BCP/DRP 핵심 개념 정리

### 1.1 용어(수식 포함)
- **RTO**(Recovery Time Objective): 서비스 중단 후 **복구 목표 시간**.  
- **RPO**(Recovery Point Objective): 복구 시점 기준 **데이터 허용 손실량**(시간).  
- **WRT**(Work Recovery Time): 시스템 복구 후 **업무 정상화까지 소요 시간**.  
- **MTD**(Maximum Tolerable Downtime): 조직이 감내 가능한 **최대 중단 시간**.

수식:
$$
\mathrm{MTD} = \mathrm{RTO} + \mathrm{WRT}
$$

데이터 손실 최대치(시간):
$$
\text{Max Data Loss} \le \mathrm{RPO}
$$

### 1.2 BCP vs DRP
- **BCP**: 조직 수준의 **업무 지속** 전략(사람·공간·공급망·대체 프로세스 포함).  
- **DRP**: **IT 서비스 복구**에 특화된 기술 계획(백업/복제/전환/테스트).

### 1.3 재해/사고 범주
자연재해, 전원/설비, 네트워크/클라우드 장애, 랜섬웨어/침해, 공급망 중단(벤더/SaaS), 대규모 인력 불능 등.

---

## 2) BCP 문서·프로세스 설계

### 2.1 BCP 문서 구조(샘플 목차)
1. 목적/범위/정의  
2. 거버넌스(위원회, 역할·책임 RACI)  
3. 비즈니스 영향 분석(BIA)  
4. 연속성 전략(대체 프로세스·대체 근무지·핵심 인력·연락망)  
5. IT 의존도 및 DR 연계(서비스 중요도/우선순위)  
6. 커뮤니케이션 계획(내부/외부/규제기관)  
7. 훈련·테스트(주기, 유형)  
8. 지표·보고(KPI/KRI)  
9. 유지관리(개정 주기, 변경관리)  
10. 부록(연락망, 외주·벤더 리스트, 폼/체크리스트)

### 2.2 BIA 절차(예)
1) **업무 카탈로그화** → 2) **정량/정성 영향 측정**(매출, 법규, 평판, 안전) → 3) **업무 중요도 등급화**(A/B/C)  
4) **RTO/RPO 요구 파생** → 5) **자원(IT/인력/설비) 매핑** → 6) **우선 복구 시나리오 수립**

BIA 평가표(샘플)

| 업무 | 등급 | 최대 허용 중단(MTD) | RTO | RPO | 의존 IT/벤더 | 대체 프로세스 |
|---|---|---:|---:|---:|---|---|
| 주문/결제 | A | 8h | 2h | 15m | Commerce API, PG | 수기 접수 후 일괄처리 |
| 고객지원 | B | 24h | 8h | 4h | CRM, 콜센터 | 이메일 큐 임시 운영 |
| 보고/정산 | C | 72h | 24h | 24h | ERP | 월말 수기 보정 |

---

## 3) DR 전략·패턴·아키텍처

### 3.1 DR 패턴(온프레/클라우드 공통)
| 패턴 | 개념 | RTO/RPO 기대 | 비용/복잡도 | 적용 예 |
|---|---|---|---|---|
| **백업/복구** | 정기 백업→장애 시 복구 | RTO: h~d / RPO: h~d | 낮음 | 파일서버/비핵심 DB |
| **Pilot Light** | 최소 핵심 컴포넌트 상시 대기 | RTO: min~h / RPO: min | 중간 | 핵심 API, 작은 DB |
| **Warm Standby** | 축소 용량 상시 가동 | RTO: min / RPO: min | 중상 | 중간 트래픽 서비스 |
| **Active-Active** | 다중 리전 동시 운영 | RTO≈0 / RPO≈0 | 높음 | 결제, 인증 핵심계 |

### 3.2 DR 계층화(예: DB)
- **스토리지**: 스냅샷/증분 백업, 오프사이트/크로스리전 복제  
- **데이터베이스**: 동기/비동기 복제(RPO 영향), 읽기 복제본/Failover  
- **애플리케이션**: IaC(코드형 인프라), 이미지·컨테이너 재현성  
- **네트워크**: DNS 헬스체크, GSLB, Anycast, 단축 TTL

ASCII 개념도
```
[Users] -> [DNS/GSLB] ->  Region A (Active) <-> Region B (Standby)
                          | DB Primary |      | DB Replica |
                          | App Tier   |      | App Tier   |
                           Snapshots        Cross-Region Replication
```

### 3.3 DR 실행 런북(샘플)
1) 장애 감지(SIEM/헬스체크)  
2) 장애 선언(심각도·전파)  
3) 트래픽 전환(DNS/GA/로드밸런서)  
4) 데이터 승격(Replica → Primary)  
5) App 재배치(IaC 배포)  
6) 검증(헬스·거래샘플·로그)  
7) 장애 종료 및 보고

### 3.4 IaC/자동화 예시

#### Terraform(요약)
```hcl
# 예: 멀티 리전 DB 스냅샷 복제(개념형)
variable "regions" { type = list(string) }
resource "aws_db_instance" "primary" {
  engine         = "postgres"
  multi_az       = true
  backup_retention_period = 7
}
resource "aws_db_snapshot" "daily" {
  db_instance_identifier = aws_db_instance.primary.id
  depends_on = [aws_db_instance.primary]
}
# 스냅샷 카피는 provider alias/region 으로 반복 적용
```

#### 백업 검증 스크립트(Python)
```python
import boto3, datetime
rds = boto3.client('rds')
snaps = rds.describe_db_snapshots(SnapshotType='automated')['DBSnapshots']
today = datetime.datetime.utcnow().date()
latest = max(snaps, key=lambda s: s['SnapshotCreateTime'])
assert (today - latest['SnapshotCreateTime'].date()).days <= 1, "백업 지연"
print("OK: 최신 자동 백업 확인", latest['DBSnapshotIdentifier'])
```

---

## 4) BCP/DR 테스트·검증

### 4.1 유형
- **문서검토**(Walkthrough)  
- **테이블탑**(Tabletop: 시나리오 토론)  
- **기능 시험**(부분 복구)  
- **평행 테스트**(병행 처리 검증)  
- **전면 전환**(정규/비정규, 주의 요망)

### 4.2 체크리스트
- [ ] BIA 최신화(연 1회) / RTO·RPO 현실성  
- [ ] 백업 무결성·복구 테스트(분기)  
- [ ] DR 전환 절차 자동화(IaC/Runbook)  
- [ ] 모의훈련 결과 보고·개선액션 등록  
- [ ] 연락망/벤더 지원 갱신, SLA 확인

---

## 5) 침해사고 대응(Incident Response)

### 5.1 단계(요약)
1) **준비(Preparation)**: 정책·도구·계약·훈련  
2) **감지/분석(Detection & Analysis)**: 경보 triage, 스코핑  
3) **격리/완화(Containment)**: 확산 차단, 임시통제  
4) **근절(Eradication)**: 원인 제거, 취약점 수정  
5) **복구(Recovery)**: 정상화, 모니터링 강화  
6) **사후학습(Post-Incident)**: 근본원인 분석, 개선

### 5.2 IR RACI(예)
| 역할 | 책임 |
|---|---|
| IR 리드 | 선언/심각도 결정/의사소통 총괄 |
| 포렌식 | 증거 보전·분석, 타임라인 |
| 네트워크 | 격리, 방화벽/WAF/EDR 정책 |
| 애플리케이션 | 핫픽스, 롤백, 키 회전 |
| 법무/컴플라이언스 | 규제 신고, 대외 커뮤니케이션 |
| PR/CS | 고객 공지 템플릿 실행 |

### 5.3 Triage 기준(샘플)
- 알림 소스 신뢰도(SIEM/EDR/외부)  
- 자산 중요도(등급, PII/결제 여부)  
- 지표: 다수 호스트 동시 탐지, C2 패턴, 데이터 유출 지표(DLP/프록시)

### 5.4 예시 시나리오 — 랜섬웨어
- **감지**: 대량 파일 변경, 확장자 패턴, EDR 행위 탐지  
- **격리**: 네트워크 세그먼트 단절, 서비스 계정 차단, 스냅샷 보호  
- **근절**: 초기 침투 벡터(원격포트, 취약 VPN) 제거, 패치  
- **복구**: 오프라인 백업에서 복구, 키/비밀 회전  
- **사후학습**: RDP/VPN → ZTNA, MFA·JIT 특권, 백업 격리 강화

EDR 격리 예(PowerShell/Windows)
```powershell
# 예시: Microsoft Defender for Endpoint 장치 격리(개념형, 실제는 API 토큰 필요)
$deviceId = "device-guid"
$token = "Bearer <MDE-API-TOKEN>"
Invoke-RestMethod -Uri "https://api.securitycenter.microsoft.com/api/machines/$deviceId/isolate" `
  -Headers @{Authorization=$token} -Method Post -Body (@{ Comment="IR Isolation" } | ConvertTo-Json)
```

방화벽 임시 차단(리눅스)
```bash
# C2 도메인/아이피 임시 차단(개념 예)
sudo ipset create c2 hash:ip -exist
sudo ipset add c2 203.0.113.10 -exist
sudo iptables -I OUTPUT -m set --match-set c2 dst -j REJECT
```

### 5.5 예시 시나리오 — 웹 서버 침해
- **지표**: WAF 경보·500 에러 급증·비정상 업로드  
- **조치**: 업로드 디렉터리 즉시 읽기 전용, 아웃바운드 egress 제한, 컨테이너 재빌드(이미지 서명)  
- **근절**: 취약점 패치, 비밀 회전, 서드파티 라이브러리 업데이트(SBOM/SCA)  
- **복구**: 블루/그린 배포, 헬스체크 통과 후 트래픽 전환  
- **증거**: 접근로그, 웹서버 로그, 애플리케이션 로그, 컨테이너 레이어 diff

Nginx 액세스 로그에서 의심 URI 조회
```bash
awk '{print $7}' /var/log/nginx/access.log | sort | uniq -c | sort -nr | head
grep -E "(\.\./|%2e%2e|/admin|/wp-admin|/phpmyadmin)" /var/log/nginx/access.log
```

---

## 6) 디지털 포렌식(Digital Forensic)

### 6.1 원칙
- **무결성 보존**: 원본 미변경(Write Blocker/이미징), 해시(SHA-256)  
- **연쇄적 관리(Chain of Custody)**: 취급자·시간·장소·목적 문서화  
- **재현 가능성**: 표준 도구·버전·해시 기록  
- **법적 준거**: 관련 법규·정책 준수

Chain of Custody(예시 YAML)
```yaml
evidence_id: DF-2025-001
item: "NVMe 1TB / Host-123"
hash: "sha256: <수집 후 기록>"
collected_by: "홍길동"
collected_at: "2025-11-10T14:30+09:00"
method: "Write-blocked imaging via ddrescue"
transfer_log:
  - to: "DF Lab Locker A"
    at: "2025-11-10T16:00+09:00"
    by: "홍길동"
```

### 6.2 수집

디스크 이미징(리눅스)
```bash
# 블록 장치 식별
lsblk -o NAME,SIZE,MODEL,SERIAL
# 해시 선계산(옵션)
sudo sha256sum /dev/nvme0n1
# ddrescue 이용한 이미지 수집(에러 견고)
sudo ddrescue --force --no-trim /dev/nvme0n1 image.dd image.log
# 이미지 해시
sha256sum image.dd > image.dd.sha256
```

메모리 포렌식(Volatility 3)
```bash
# 메모리 덤프 획득(Windows 예: RamCapture/WinPMEM 등 도구 사용)
# 분석(프로세스/네트워크/핸들)
vol.py -f mem.vmem windows.pslist
vol.py -f mem.vmem windows.netscan
vol.py -f mem.vmem windows.malfind
```

네트워크 PCAP 기초 분석(tshark)
```bash
tshark -r traffic.pcap -q -z io,stat,60
tshark -r traffic.pcap -Y "http.request || dns" -T fields -e frame.time -e ip.src -e http.host -e http.request.uri | head
```

타임라인(Plaso/log2timeline)
```bash
log2timeline.py case.plaso /mnt/evidence/image_mount
psort.py -o l2tcsv case.plaso > timeline.csv
```

YARA 스캔(악성 패턴 탐지)
```bash
yara -r rules/index.yar /mnt/evidence/image_mount/home
```

### 6.3 분석 포인트
- **Artefacts**: Prefetch, ShimCache, AmCache, Registry(RecentDocs/Run Keys), Browser history, SSH known_hosts, Bash history  
- **Persistence**: crontab/systemd, Windows 서비스/스케줄러  
- **Lateral Movement**: RDP/SMB/SSH 흔적, 인증 로그  
- **Exfiltration**: 대용량 전송, 압축 아카이브, 클라우드 스토리지 사용

Windows 이벤트 추출(PowerShell)
```powershell
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4624; StartTime=(Get-Date).AddDays(-2)} |
  Select TimeCreated, @{n='Acct';e={$_.Properties[5].Value}}, @{n='IP';e={$_.Properties[18].Value}} |
  Export-Csv logon.csv -NoTypeInformation -Encoding UTF8
```

리눅스 인증 로그
```bash
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -nr | head
```

### 6.4 보고서 구성(요약)
1) 개요/범위/제약  
2) 사용 도구·버전·해시  
3) 타임라인(주요 이벤트)  
4) 관찰 사실(Facts) vs 해석(Analysis) 구분  
5) 결론/권고(재발 방지)  
6) 증거 목록(해시 포함) 및 보관 위치

---

## 7) 통합 시나리오 — “클라우드 상거래 서비스 침해 + DR 전환”

1) **감지**: WAF에서 SSRF 의심 + DB 연결 급증  
2) **선언**: IR P1, 포렌식 범위 지정(API 게이트웨이/앱/DB)  
3) **격리**: 아웃바운드 메타데이터 엔드포인트 차단, 해당 워크로드 격리  
4) **근절**: 취약 라이브러리 패치, 인스턴스 재구축(이미지 서명 검증), 시크릿 회전  
5) **DR 전환**: Warm Standby 리전 승격, DB 읽기 복제본 승격, DNS 전환  
6) **복구 검증**: Synthetic 트랜잭션, 정합성 샘플링, 로그 오류율  
7) **사후학습**: SSRF 차단(네트워크 정책·IMDSv2), 아웃바운드 egress 제어, 스캐너 파이프라인 상시화

DNS 전환(개념형)
```bash
# API: DNS A/ALIAS 레코드 대상 LB를 Standby로 교체(도구/프로바이더별 상이)
cli dns update --zone example.com --record api --ttl 30 --alias standby-lb.example.net
```

---

## 8) 체크리스트(실무 제출용 요약)

### 8.1 BCP
- [ ] BIA 최신화(업무 등급·RTO/RPO/MTD)  
- [ ] 대체 프로세스/근무지/핵심 인력/연락망 문서화  
- [ ] 커뮤니케이션 계획(규제 신고/고객 공지 템플릿)  
- [ ] 훈련 계획(테이블탑/평행/정기) 및 결과 개선

### 8.2 DRP
- [ ] 서비스별 DR 패턴 선정(백업/파일럿/웜/액티브)  
- [ ] IaC·Runbook 자동화, 복구 테스트 증빙  
- [ ] 백업 무결성 검증(해시/샘플 복구)  
- [ ] DNS/GSLB 전환 절차/롤백 절차

### 8.3 IR
- [ ] IR 정책·심각도 기준·RACI 공개  
- [ ] Triage 표준(신뢰도/자산 중요도/확산성)  
- [ ] 격리 수단(EDR·세그멘테이션·WAF) 준비  
- [ ] 근절 체크(벡터 차단/패치/비밀 회전)  
- [ ] Postmortem 템플릿 운용

### 8.4 DF
- [ ] 수집 절차(이미징/해시/CoC) 표준화  
- [ ] 도구 버전 관리(Volatility/Plaso/YARA 등)  
- [ ] 타임라인·지표 표준(Artefact 목록)  
- [ ] 법무 협업/신고 기준 반영

---

## 9) 예제 템플릿·폼

BCP 연락망(발췌)
```yaml
contacts:
  ir_lead: { name: "김보안", phone: "+82-10-1234-5678", email: "irlead@example.com" }
  forensic: { name: "이증거", phone: "+82-10-5678-1234", email: "df@example.com" }
  pr: { name: "박대외", phone: "+82-10-0000-0000", email: "pr@example.com" }
  vendor_pg: { name: "결제사", sla: "P1 1h", hotline: "+82-02-000-0000" }
```

IR 공지 초안(내부)
```text
제목: [P1] 웹 애플리케이션 보안사고 대응 개시(YYYY-MM-DD HH:MM)
내용: 오늘 HH:MM WAF 경보를 통해 P1 사고를 선언했습니다.
- 영향: 주문 API 2% 오류율 증가(감소 추세)
- 조치: 문제가 된 워크로드 격리, 패치 배포 중, DR 전환 완료(Standby 리전)
- 다음: 1시간마다 업데이트, 고객 공지 필요 시 PR팀과 협의
```

Postmortem 템플릿(요약)
```markdown
## 개요
- 사고 ID/시간/영향
## 타임라인
- T0 감지 ~ Tn 복구
## 근본 원인
- 기술/프로세스/조직
## 재발 방지
- 단기(2주) / 중기(분기) / 장기(반기)
## 지표
- MTTD/MTTR, 재현 테스트 결과
```

---

## 10) 미니 실습: RTO/RPO 검증 파이프라인

백업 목록에서 **어제자 스냅샷 존재**(RPO≤24h)와 **테스트 복구 시간 측정**(RTO)을 기록.

Bash(개념)
```bash
start=$(date +%s)
# 복구 테스트(샌드박스 DB)에 스냅샷 복원
restore_db_from_snapshot snapshot-2025-11-11
# 헬스 체크
until curl -fsS http://sandbox-db:5432/health; do sleep 5; done
end=$(date +%s); rto=$((end-start))
echo "RTO(sec)=$rto" | tee -a rto.log
# 스냅샷 타임스탬프 검사 → RPO 산출
snap_ts=$(get_snapshot_time snapshot-2025-11-11)  # YYYY-MM-DDTHH:MMZ
rpo_hours=$(( ( $(date -u +%s) - $(date -ud "$snap_ts" +%s) ) / 3600 ))
echo "RPO(hours)=$rpo_hours" | tee -a rpo.log
```

---

## 11) 기출 포인트·실기형 대비

1) **정의 구분**: RTO/RPO/WRT/MTD 관계와 수식  
2) **DR 패턴 선택**: 비용·복잡도·RTO/RPO 트레이드오프  
3) **IR 단계**: NIST형 6단계와 각 단계 산출물(선언서, IOC 세트, 격리/근절 체크리스트, 사후학습 보고)  
4) **포렌식 원칙**: CoC, 해시, 원본 미변경, 도구·버전 기록  
5) **실무 묻는 문제**: “랜섬웨어 대응 중 BCP/DR/IR/DF 경계와 연결점은?”  
   - BCP: 핵심업무 지속(수기/대체), DR: IT 복구/전환, IR: 확산 차단·근절·복구, DF: 증거 수집/원인 규명

---

## 12) 결론
- **BCP**는 조직의 **업무 지속성**을, **DRP**는 **IT 복구 시간·시점 목표**를 달성하기 위한 **구현 수단**이다.  
- **IR**은 위협이 현실화되었을 때의 **전술적 실행**, **DF**는 **증거 기반 원인 규명과 법적 견고성**을 보장한다.  
- 네 영역은 **서로 맞물린 톱니**처럼 동작한다: BIA→DR 설계→IR 대응→DF 분석→사후개선.  
- 최신 환경에서는 **IaC·자동화·정체성 중심 제어·분리/격리·오프라인 백업**이 실질적 복원력을 좌우한다.