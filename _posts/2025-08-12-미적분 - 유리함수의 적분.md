---
layout: post
title: 미적분 - 유리함수의 적분
date: 2025-08-12 22:20:23 +0900
category: 미적분
---
# 유리함수의 적분: 부분분수법(Partial Fraction Decomposition)

## 1. 출발점: 유리함수와 “적분을 쉽도록 쪼개기”

**유리함수(rational function)**

$$
\frac{P(x)}{Q(x)}, \quad P,Q \ \text{다항식},\ Q\not\equiv 0.
$$

핵심 아이디어는 **분모를 인수분해**하고, 그에 맞춰 **간단한 분수들의 합으로 분해**해 적분을 표준형(로그·아크탄·거듭제곱)으로 떨어뜨리는 것이다.

---

## 2. 부분분수법 알고리즘(체크리스트)

1) **정상화(Improper 확인)**  
   $$\deg P \ge \deg Q$$ 이면 먼저 **다항식 나눗셈**으로
   $$
   \frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)},\quad \deg R<\deg Q.
   $$
   적분은 $$\int S(x)\,dx + \int \frac{R(x)}{Q(x)}\,dx$$ 로 분리.

2) **분모 인수분해(실수 범위)**  
   실수에서
   $$
   Q(x)=\prod (x-a_i)^{\alpha_i}\ \prod (x^2+b_jx+c_j)^{\beta_j},
   $$
   여기서 $$x^2+b_jx+c_j$$ 는 **실수에서 인수분해 불가**(판별식 $$b_j^2-4c_j<0$$).

3) **분해 꼴 설정**  
   - 서로 다른 일차: $$\frac{A}{x-a}$$
   - 중복 일차: $$\frac{A_1}{x-a}+\frac{A_2}{(x-a)^2}+\cdots+\frac{A_n}{(x-a)^n}$$
   - 비인수분해 이차: $$\frac{Ax+B}{x^2+bx+c}$$
   - 중복 이차: $$\frac{A_1x+B_1}{x^2+bx+c}+\cdots+\frac{A_nx+B_n}{(x^2+bx+c)^n}$$

4) **계수 결정법**  
   - **커버업(Heaviside)**: 서로 다른 일차인수에 유효  
     $$
     A_k=\left[(x-a_k)\frac{P(x)}{Q(x)}\right]_{x=a_k}.
     $$
   - **대입법/계수비교**: 임의의 $$x$$ 치환으로 연립방정식 풀기  
   - **반응수법(도함수 활용)**: 중복근에서 파생 계수 추출(필요시)

5) **적분 표준형으로 정리**  
   - $$\int \frac{A}{x-a}\,dx=A\ln|x-a|+C$$  
   - $$\int \frac{A}{(x-a)^n}\,dx=\frac{-A}{(n-1)(x-a)^{n-1}}+C\quad(n\ge 2)$$  
   - $$\int \frac{Ax+B}{x^2+bx+c}\,dx=\frac{A}{2}\ln(x^2+bx+c)+\frac{2B-Ab}{\sqrt{4c-b^2}}\arctan\!\frac{2x+b}{\sqrt{4c-b^2}}+C$$  
     (단, $$4c-b^2>0$$. 그렇지 않다면 **완전제곱** 후 로그로 처리.)

---

## 3. 분해 템플릿(요약 표)

| 분모 유형 | 분해 형태 | 적분 결과 개요 |
|---|---|---|
| $$(x-a)$$ | $$\frac{A}{x-a}$$ | $$A\ln|x-a|$$ |
| $$(x-a)^n$$ | $$\sum_{k=1}^n \frac{A_k}{(x-a)^k}$$ | $$A_1\ln|x-a|+\sum_{k=2}^n \frac{-A_k}{(k-1)(x-a)^{k-1}}$$ |
| $$x^2+bx+c\ (4c-b^2>0)$$ | $$\frac{Ax+B}{x^2+bx+c}$$ | $$\frac{A}{2}\ln(x^2+bx+c)+\frac{2B-Ab}{\sqrt{4c-b^2}}\arctan\!\frac{2x+b}{\sqrt{4c-b^2}}$$ |
| $$(x^2+bx+c)^n$$ | $$\sum_{k=1}^n \frac{A_kx+B_k}{(x^2+bx+c)^k}$$ | $$k=1$$ 항은 위와 같고, $$k\ge2$$ 는 $$u'= (2x+b)$$ 분리 및 부분적분/치환 병행 |

---

## 4. 예제 — 기초에서 혼합형까지

### 예제 1. 서로 다른 일차 인수

$$
\int \frac{3x+5}{(x+1)(x+2)}\,dx.
$$

분해  
$$
\frac{3x+5}{(x+1)(x+2)}=\frac{A}{x+1}+\frac{B}{x+2}.
$$

통분·계수비교  
$$
3x+5=A(x+2)+B(x+1).
$$
$$
x=-2\Rightarrow 3(-2)+5=B(-1)\Rightarrow B=1,\quad
x=-1\Rightarrow 3(-1)+5=A(1)\Rightarrow A=2.
$$

적분  
$$
\int\left(\frac{2}{x+1}+\frac{1}{x+2}\right)\,dx=2\ln|x+1|+\ln|x+2|+C.
$$

---

### 예제 2. 중복 일차 인수

$$
\int \frac{5x+1}{(x-1)^2}\,dx.
$$

분해  
$$
\frac{5x+1}{(x-1)^2}=\frac{A}{x-1}+\frac{B}{(x-1)^2}.
$$

통분  
$$
5x+1=A(x-1)+B=Ax-A+B.
$$

계수비교  
$$
x\text{항}:5=A,\quad \text{상수}:1=-A+B\Rightarrow B=6.
$$

적분  
$$
\int\left(\frac{5}{x-1}+\frac{6}{(x-1)^2}\right)\,dx
=5\ln|x-1|-\frac{6}{x-1}+C.
$$

---

### 예제 3. 비인수분해 이차 인수(직접 적분)

$$
\int \frac{x+1}{x^2+1}\,dx
= \int \frac{x}{x^2+1}\,dx + \int \frac{1}{x^2+1}\,dx
= \frac{1}{2}\ln(x^2+1)+\arctan x + C.
$$

---

### 예제 4. 혼합형(일차+이차)

$$
\int \frac{2x+1}{(x-1)(x^2+1)}\,dx.
$$

분해  
$$
\frac{2x+1}{(x-1)(x^2+1)}=\frac{A}{x-1}+\frac{Bx+C}{x^2+1}.
$$

통분  
$$
2x+1=A(x^2+1)+(Bx+C)(x-1)
=Ax^2+A+Bx^2-(B-C)x-C.
$$

계수비교  
$$
x^2:\ A+B=0,\qquad x:\ -(B-C)=2,\qquad \text{상수}:\ A-C=1.
$$
연립해  
$$
B=-A,\quad C=B-2=-A-2,\quad A-C=1\Rightarrow A-(-A-2)=1\Rightarrow 2A+2=1\Rightarrow A=-\frac{1}{2}.
$$
따라서  
$$
B=\frac{1}{2},\quad C=-\frac{3}{2}.
$$

적분  
$$
\int\left(\frac{-\tfrac{1}{2}}{x-1}+\frac{\tfrac{1}{2}x-\tfrac{3}{2}}{x^2+1}\right)\,dx
=-\frac{1}{2}\ln|x-1|+\frac{1}{4}\ln(x^2+1)-\frac{3}{2}\arctan x+C.
$$

---

### 예제 5. 다항식 나눗셈이 필요한 경우(Improper)

$$
\int \frac{x^3+x}{x^2+1}\,dx.
$$

나눗셈  
$$
\frac{x^3+x}{x^2+1}=x+\frac{-x+x}{x^2+1}=x+\frac{0}{x^2+1}=x.
$$

즉 적분은  
$$
\int x\,dx=\frac{x^2}{2}+C.
$$
(우연히 완전 약분된 케이스로, 일반적으로는 나머지가 남는다.)

---

### 예제 6. 중복 이차 인수

$$
\int \frac{3x+5}{(x^2+4)^2}\,dx.
$$

아이디어:  
$$
\frac{3x+5}{(x^2+4)^2}=\frac{A x+B}{x^2+4}+\frac{C x+D}{(x^2+4)^2}.
$$

통분 후 계수비교로 $$A,B,C,D$$ 를 구한다. 적분은
$$
\int \frac{Ax+B}{x^2+4}\,dx=\frac{A}{2}\ln(x^2+4)+\frac{B}{2}\arctan\!\frac{x}{2}
$$
와
$$
\int \frac{Cx+D}{(x^2+4)^2}\,dx
$$
으로 나뉜다. 두 번째 항은
$$
u=x^2+4,\ du=2x\,dx
$$
를 쓰거나, 
$$
\frac{Cx}{(x^2+4)^2}=\frac{C}{2}\cdot\frac{2x}{(x^2+4)^2}
$$
형태로 치환, 그리고
$$
\frac{D}{(x^2+4)^2}
$$
는 표준 적분(삼각치환 혹은 표)로 처리한다. (아래 코드 예제에서 자동화 확인.)

---

### 예제 7. 완전제곱으로 로그만 나오는 이차

$$
\int \frac{2x+1}{x^2+2x+1}\,dx
=\int \frac{2x+1}{(x+1)^2}\,dx.
$$

분해  
$$
\frac{2x+1}{(x+1)^2}=\frac{A}{x+1}+\frac{B}{(x+1)^2}.
$$

통분  
$$
2x+1=A(x+1)+B=Ax+A+B.
$$

계수비교  
$$
x:2=A,\quad \text{상수}:1=A+B\Rightarrow B=-1.
$$

적분  
$$
\int \left(\frac{2}{x+1}-\frac{1}{(x+1)^2}\right)\,dx=2\ln|x+1|+\frac{1}{x+1}+C.
$$

---

### 예제 8. 정적분(절댓값·아크탄 주의)

$$
\int_{0}^{1}\frac{3x+5}{(x+1)(x+2)}\,dx.
$$

예제 1의 분해를 사용:
$$
\int_{0}^{1}\left(\frac{2}{x+1}+\frac{1}{x+2}\right)\,dx
=\left[2\ln|x+1|+\ln|x+2|\right]_{0}^{1}
=2\ln 2+\ln 3-(2\ln 1+\ln 2).
$$

정리:
$$
2\ln 2+\ln 3-\ln 2=\ln 2+\ln 3=\ln 6.
$$

---

## 5. 계수 구하기: 방법 비교와 팁

1) **커버업(Heaviside)** — 분모가 **서로 다른 일차인수**일 때 즉시 계산  
   $$
   \frac{P(x)}{\prod_{k}(x-a_k)}=\sum_k \frac{A_k}{x-a_k},\quad
   A_k=\left[(x-a_k)\frac{P(x)}{\prod_{j}(x-a_j)}\right]_{x=a_k}.
   $$
   제한: **중복근**이나 **이차(비인수분해)**에는 바로 적용 불가.

2) **대입법** — 적당한 $$x$$ 값을 여러 개 대입해 연립방정식으로 해결. 중복근·이차에도 유효.

3) **계수비교** — 전개 후 $$x^k$$ 항의 계수 일치로 선형시스템을 푼다. 체계적이며 코드화에 유리.

4) **반응수법(도함수 사용)** — 중복근의 높은 차수 계수 추출 시 사용(필요할 때).

**실무 팁**  
- 먼저 **공통인수 약분**(분자·분모) 여부 확인. 약분 후가 진짜 분해 대상.  
- **부호·절댓값**: 로그 항에는 반드시 $$\ln|x-a|$$.  
- **이차 항의 판별식** 확인: $$4c-b^2>0$$ 이면 **아크탄**, $$=0$$ 이면 완전제곱, $$<0$$ 이면 로그 두 개(실수 인수화 가능).  
- 적분 결과를 **미분해 원 integrand 복원** 테스트로 검증.

---

## 6. 표준 적분 공식(완전제곱 포함)

이차식 완전제곱  
$$
x^2+bx+c=(x+\tfrac{b}{2})^2+\left(c-\tfrac{b^2}{4}\right)
=(x+m)^2+\alpha^2,
$$
$$
m=\frac{b}{2},\quad \alpha=\sqrt{c-\frac{b^{2}}{4}}.
$$

핵심 템플릿  
- 선형분자 포함:
  $$
  \int \frac{Ax+B}{(x+m)^2+\alpha^2}\,dx
  =\frac{A}{2}\ln\!\big((x+m)^2+\alpha^2\big)
  +\frac{B-A m}{\alpha}\arctan\!\frac{x+m}{\alpha}+C.
  $$
- 거듭제곱 분모(대표):
  $$
  \int \frac{dx}{\big((x+m)^2+\alpha^2\big)^2}
  =\frac{x+m}{2\alpha^2\big((x+m)^2+\alpha^2\big)}
   +\frac{1}{2\alpha^3}\arctan\!\frac{x+m}{\alpha}+C.
  $$

---

## 7. 고난도 예제(혼합+거듭제곱)

다음 적분을 구하라.
$$
\int \frac{2x^2+3x+5}{(x-1)^2(x^2+2x+5)}\,dx.
$$

1) 분해 꼴  
$$
\frac{2x^2+3x+5}{(x-1)^2(x^2+2x+5)}
=\frac{A}{x-1}+\frac{B}{(x-1)^2}+\frac{Cx+D}{x^2+2x+5}.
$$

2) 통분·계수비교로 $$A,B,C,D$$ 결정(계산 과정 생략 가능, 코드로 검증 아래 참조).

3) 적분  
- $$\frac{A}{x-1},\ \frac{B}{(x-1)^2}$$ 는 로그·거듭제곱 공식 적용.  
- $$x^2+2x+5=(x+1)^2+4$$ 이므로
  $$
  \int \frac{Cx+D}{x^2+2x+5}\,dx
  =\frac{C}{2}\ln(x^2+2x+5)+\frac{D-C}{2}\arctan\!\frac{x+1}{2}+C_0.
  $$

정답 형태는
$$
A\ln|x-1|-\frac{B}{x-1}+\frac{C}{2}\ln(x^2+2x+5)+\frac{D-C}{2}\arctan\!\frac{x+1}{2}+C
$$
가 된다. (아래 SymPy 코드로 수치·상징 검증 제공.)

---

## 8. 응용 스냅샷

- **라플라스 변환 역변환**: 부분분수로 $$\frac{P(s)}{Q(s)}$$ 를 분해해 시간영역 항들의 합으로 변환.  
- **1차·2차 선형 ODE 해석**: 상수계수 ODE 해의 라플라스상 파셜 분해 → 지수·사인/코사인 항.  
- **확률·통계**: 합리적 특성함수의 역푸리에에서 부분분수(복소평면 잔차와 연결).  
- **회로이론**: 전달함수 $$H(s)$$ 의 극-영점 전개, 시간응답 해석.

---

## 9. 검증·자동화: SymPy 코드

아래 코드는 분해( `apart` ), 적분( `integrate` ), 결과 미분 검증(원 integrand 복원), 수치 비교를 한 번에 수행한다.

```python
import sympy as sp
x = sp.symbols('x', real=True)

def check_integral(expr):
    F = sp.integrate(expr, x)
    back = sp.simplify(sp.diff(F, x) - expr)
    return F, sp.simplify(back)

# 예제 1
expr1 = (3*x + 5)/((x+1)*(x+2))
print("예제1 분해:", sp.apart(expr1, x))
F1, err1 = check_integral(expr1)
print("예제1 적분:", F1)
print("미분 복원 오차:", err1)

# 예제 4 (혼합형)
expr4 = (2*x + 1)/((x-1)*(x**2 + 1))
print("\n예제4 분해:", sp.apart(expr4, x))
F4, err4 = check_integral(expr4)
print("예제4 적분:", sp.simplify(F4))
print("미분 복원 오차:", err4)

# 예제 6 (중복 이차)
expr6 = (3*x + 5)/(x**2 + 4)**2
print("\n예제6 분해:", sp.apart(expr6, x))
F6, err6 = check_integral(expr6)
print("예제6 적분:", sp.simplify(F6))
print("미분 복원 오차:", err6)

# 고난도 예제
exprH = (2*x**2 + 3*x + 5)/((x-1)**2*(x**2 + 2*x + 5))
print("\n고난도 분해:", sp.apart(exprH, x))
FH, errH = check_integral(exprH)
print("고난도 적분:", sp.simplify(FH))
print("미분 복원 오차:", errH)
```

실행 포인트  
- `sp.apart`가 자동으로 부분분수를 만들어 준다(실수/복소 영역 옵션 가능).  
- 적분 후 `diff` 로 원 integrand 복원여부 검사(0이면 성공).  
- 수치 검증은 `sp.lambdify` 로 임의 점에서 비교 가능.

---

## 10. 연습 문제(정답 스케치 포함)

문제 1  
$$
\int \frac{4x+7}{(x-2)(x+3)}\,dx.
$$
스케치: $$\frac{A}{x-2}+\frac{B}{x+3}$$, 커버업으로 $$A,B$$. 결과는 로그 두 개의 합.

문제 2  
$$
\int \frac{3x^2+1}{(x+1)^3}\,dx.
$$
스케치: $$\frac{A}{x+1}+\frac{B}{(x+1)^2}+\frac{C}{(x+1)^3}$$. 거듭제곱 분모 적분 공식 적용.

문제 3  
$$
\int \frac{x^2+2x+3}{x^2+4x+8}\,dx.
$$
스케치: 다항식 나눗셈으로 $$1+\frac{-2x-5}{x^2+4x+8}$$, 이후 완전제곱 $$=(x+2)^2+4$$ 로 로그+아크탄.

문제 4  
$$
\int \frac{5x+1}{(x^2+1)^2}\,dx.
$$
스케치: $$\frac{Ax+B}{x^2+1}+\frac{Cx+D}{(x^2+1)^2}$$ 분해 후, 치환과 표준 적분 결합.

문제 5(정적분)  
$$
\int_{0}^{\infty}\frac{dx}{(x+1)(x^2+1)}.
$$
스케치: $$\frac{A}{x+1}+\frac{Bx+C}{x^2+1}$$ 분해, 각 항 무한대 극한 수렴성 점검(로그·아크탄 경계값 주의).

---

## 11. 마무리: 실전 운용 요약

- 먼저 **나눗셈**으로 Proper화 → **인수분해** → **분해 꼴 설정** → **계수 계산** → **표준 적분**.  
- 로그에는 **절댓값**. 이차는 **완전제곱**과 **판별식**으로 분기(아크탄/로그).  
- 결과는 반드시 **미분 검산**하라(실수 예방).  
- 반복해서 손이 가는 유형은 **템플릿**으로 익혀 속도를 올릴 것.