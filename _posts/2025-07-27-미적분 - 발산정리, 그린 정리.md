---
layout: post
title: 미적분 - 발산정리, 그린 정리
date: 2025-07-27 20:20:23 +0900
category: 미적분
---
# 발산정리(가우스), 그린 정리

## 0) 빠른 개념 지도

| 정리 | 차원 | 좌변(경계 적분) | 우변(내부 적분) | 물리적 의미 |
|---|---|---|---|---|
| **그린 정리** | 2D 평면 | \( \displaystyle \oint_{\partial D} P\,dx + Q\,dy \) | \( \displaystyle \iint_D \left(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}\right) dA \) | 경계에서의 **회전(순환)** = 내부 **2D curl** 누적 |
| **발산정리(가우스)** | 3D 공간 | \( \displaystyle \iint_{\partial V} \mathbf F\cdot \mathbf n\, dS \) | \( \displaystyle \iiint_V (\nabla\cdot \mathbf F)\, dV \) | 경계에서의 **유량(플럭스)** = 내부 **발산** 누적 |
| **스토크스 정리** | 3D | \( \displaystyle \oint_{\partial S} \mathbf F\cdot d\mathbf r \) | \( \displaystyle \iint_S (\nabla\times \mathbf F)\cdot \mathbf n\, dS \) | 경계 선적분 = 내부 **회전(curl)**의 면적분 |

- 그린 정리는 스토크스 정리의 **2D 특수형**으로 볼 수 있고, 발산정리는 “**발산-유량 보존**”을 명문화합니다.

---

## 1) 그린 정리 (Green’s Theorem)

### 1.1 정리(순환형, circulation form)

$$
\boxed{
\oint_{\partial D} P\,dx + Q\,dy
\;=\;
\iint_D \Big(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}\Big)\, dA
}
$$

- \(D\): 평면의 유한 영역(통상 **단순 폐곡선**으로 둘러싸임)
- \(\partial D\) 방향: **양의(반시계)** 방향
- \(P,Q\in C^1\) (영역의 열린 이웃에서 연속미분 가능)

### 1.2 유량형(divergence form) 버전

$$
\oint_{\partial D} \big(P\,dy - Q\,dx\big)
\;=\;
\iint_D \Big(\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}\Big)\, dA
=
\iint_D \nabla\cdot (P,Q)\, dA
$$

> 벡터장 \( \mathbf F=(P,Q) \)의 **2D 발산**과 경계 유량의 연결.

### 1.3 직관
- 내부의 **회전성(curl)**이 클수록 경계에서 **반시계 방향 순환** 선적분이 커진다.
- 내부의 **발산(div)**이 클수록 경계로 **빠져나가는 유량**이 커진다.

### 1.4 조건/주의
- 영역이 **다중 연결**(구멍 포함)이라면 각 구멍 경계는 **시계방향**으로 취급(양의 방향은 “왼쪽에 영역”)해야 부호가 맞습니다.
- 경계가 조각별 \( C^1 \), \(P,Q\)는 그 이웃에서 \( C^1 \)이면 충분.
- **특이점**(정의 안 되는 점, 예: 원점에서 분모 0)이 내부에 있으면 그대로 적용 불가 → 영역 분할/제거 필요.

---

## 2) 발산정리 (Gauss’s / Divergence Theorem)

### 2.1 정리

$$
\boxed{
\iiint_V (\nabla\cdot \mathbf F)\, dV
\;=\;
\iint_{\partial V} \mathbf F\cdot \mathbf n \, dS
}
$$

- \(V\): 닫힌 부피(경계 \(\partial V\)는 **바깥 법선** \(\mathbf n\))
- \(\mathbf F\in C^1\) (열린 이웃에서)
- 좌변: 내부 **발산 총합**, 우변: 경계로 나가는 **총 유량(플럭스)**

### 2.2 직관(연속 방정식)
- “소스/싱크(발산)의 총량 = 경계로 나간 총량”
- 유체/전자기/열전달 등 **보존 법칙**의 핵심 수학 도구.

### 2.3 조건/주의
- **바깥**을 향한 단위 법선 사용.
- \(\mathbf F\)가 경계에서 충분히 매끄럽고, \(V\)는 **Lipschitz** 정도의 정상적인 형상.
- 내부 특이점은 예외 처리(작은 구로 도려내고 극한 등).

---

## 3) 손계산 예제

### 예제 A — 그린 정리(순환형)로 면적/선적분 확인

벡터장 \( \mathbf F=(-y,\; x) \), 단위원 \( D:\ x^2+y^2\le1 \).

1) 우변(면적분):
\[
\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}
= \frac{\partial (x)}{\partial x}-\frac{\partial(-y)}{\partial y}
=1-(-1)=2
\]
\[
\iint_D 2\, dA = 2\cdot \text{Area}(D)= 2\cdot \pi = 2\pi.
\]

2) 좌변(선적분, 반시계):
\[
\oint_{\partial D} (-y)\,dx + x\,dy = 2\pi
\]
(직접 매개화 \(x=\cos t, y=\sin t\)로 계산해도 동일)

> **결론**: 양변 = \(2\pi\) (일치)

---

### 예제 B — 그린 정리(유량형)로 “면적” 계산

항등식:
$$
\text{Area}(D)=\frac12\oint_{\partial D} x\,dy - y\,dx
$$

- 다각형 영역의 면적을 **경계점 좌표만**으로 계산 가능(컴퓨팅에서 매우 유용, shoelace와 동일 맥락).

---

### 예제 C — 발산정리: 구에서의 방사형 벡터장

\( \mathbf F(x,y,z)=(x,y,z) \), \( V: x^2+y^2+z^2\le R^2 \).

- 발산: \( \nabla\cdot \mathbf F=1+1+1=3 \)
- 좌변:
  \[
  \iiint_V 3\, dV = 3\cdot \frac{4}{3}\pi R^3 = 4\pi R^3.
  \]
- 우변(플럭스):
  \[
  \mathbf n=\frac{\mathbf r}{R},\ \mathbf F\cdot \mathbf n=\frac{\mathbf r\cdot\mathbf r}{R}=R
  \]
  \[
  \iint_{\partial V} R\, dS = R \cdot 4\pi R^2 = 4\pi R^3.
  \]
> **일치**.

---

### 예제 D — 발산정리: 큐브에서의 빠른 계산

\( \mathbf F=(x^2,\,y^2,\,z^2) \), \( V=[0,1]^3 \).

- 발산: \( \nabla\cdot \mathbf F = 2x+2y+2z \)
- 좌변:
  \[
  \iiint_0^1\!\!\iiint_0^1\!\!\iiint_0^1 (2x+2y+2z)\,dx\,dy\,dz
  = 2\left(\frac12+\frac12+\frac12\right) = 3.
  \]
- 우변(플럭스): 각 면에서의 \( \mathbf F\cdot \mathbf n \) 계산하면 역시 3 (대칭·선형성으로 빠르게 확인)

---

### 예제 E — **구멍이 있는 영역**(Green): 도넛형(환형 영역)

\( D \): 외부 원 \(x^2+y^2\le R^2\), 내부 원 \(x^2+y^2\le r^2\) 제거.  
경계는 **바깥 원 반시계, 안쪽 원 시계**가 양의 방향.

\[
\oint_{\partial D} P\,dx+Q\,dy
=
\iint_D \Big(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\Big)\,dA
=
\iint_{\text{바깥}-\text{안쪽}} (\cdots) dA.
\]

> 안쪽 경계의 **방향 주의**(시계). 부호를 잘못 잡으면 결과가 2배/0로 틀어집니다.

---

## 4) Python 코드 — 심볼릭/수치 검증 스니펫

> 실행 환경: SymPy(심볼릭), NumPy(수치). 노트북/스크립트에 복사해 테스트하세요.

### 4.1 Green(순환형) — 단위원 예제 A 검증

```python
import sympy as sp

t = sp.symbols('t', real=True)
x = sp.cos(t)
y = sp.sin(t)
dx = sp.diff(x, t)
dy = sp.diff(y, t)

P = -y
Q = x

line = sp.simplify(P*dx + Q*dy)
res_line = sp.integrate(line, (t, 0, 2*sp.pi))
print("∮(-y dx + x dy) over unit circle =", sp.simplify(res_line))

# area integral (curl_z = Q_x - P_y = 1 - (-1) = 2)
res_area = 2 * sp.pi  # ∫∫_Disk 2 dA = 2 * Area = 2π
print("∬ curl dA =", res_area)
```

### 4.2 Green(유량형) — 다각형 면적(Shapely 없이 수치)

```python
import numpy as np

# simple polygon counterclockwise: a square
poly = np.array([[0,0],[2,0],[2,1],[0,1]])

# area by line integral: 1/2 ∮ (x dy - y dx)
def polygon_area_line(poly):
    N = len(poly)
    area2 = 0.0
    for i in range(N):
        x1,y1 = poly[i]
        x2,y2 = poly[(i+1)%N]
        area2 += x1*y2 - y1*x2  # shoelace
    return 0.5*area2

print("Area =", polygon_area_line(poly))
```

### 4.3 Divergence — 구에서 방사형 벡터장 예제 C 검증(심볼릭)

```python
import sympy as sp
r, theta, phi, R = sp.symbols('r theta phi R', positive=True)
# spherical: dV = r^2 sin(phi) dr dphi dtheta
divF = 3
vol_int = sp.integrate(divF * r**2 * sp.sin(phi), (r, 0, R), (phi, 0, sp.pi), (theta, 0, 2*sp.pi))
print("∭ (div F) dV =", sp.simplify(vol_int))

# surface flux: F·n = R on sphere r=R, dS = R^2 sin(phi) dphi dtheta
flux = sp.integrate(R * R**2 * sp.sin(phi), (phi, 0, sp.pi), (theta, 0, 2*sp.pi))
print("∯ F·n dS =", sp.simplify(flux))
```

### 4.4 Divergence — 큐브 예제 D(수치 적분)

```python
import numpy as np

def divF(x,y,z): return 2*x + 2*y + 2*z

# simple 3D Riemann sum over [0,1]^3
N = 200
xs = np.linspace(0,1,N)
ys = np.linspace(0,1,N)
zs = np.linspace(0,1,N)
dx = dy = dz = 1.0/(N-1)

vsum = 0.0
for xi in xs:
    for yi in ys:
        for zi in zs:
            vsum += divF(xi,yi,zi)
vsum *= dx*dy*dz
print("Riemann ∭ divF dV ≈", vsum, "(→ 3)")
```

---

## 5) 실전 응용 패턴

### 5.1 면적·무게중심(그린)
- 면적:  
  \[
  A=\frac12\oint_{\partial D}(x\,dy - y\,dx)
  \]
- 1차 모멘트(무게중심)도 경계 적분으로 변환 가능(다각형, 복잡 경계 처리를 단순화).

### 5.2 유량/보존식(발산)
- 유량 측정: 파이프/외피를 감싸는 표면에 대해 \(\iint \mathbf F\cdot \mathbf n\, dS\)
- 전자기학 가우스 법칙:  
  \[
  \iint_S \mathbf E\cdot \mathbf n\, dS = \frac{1}{\varepsilon_0}\iiint_V \rho\, dV
  \]
  (발산정리와 맥락 동일)

### 5.3 수치해석/검증
- **FEM/FVM**에서 **셀 내부 발산의 적분 = 셀 경계 유량 합**을 기본 가정으로 사용 → 수치 보존성 테스트.

---

## 6) 빈출 함정 & 체크리스트

1) **방향/법선**  
   - Green: **바깥 둘레 반시계**, 구멍은 **시계**.  
   - Gauss: **바깥 법선**(outward) 사용.
2) **정칙성/특이점**  
   - 내부에 \(\mathbf F\)가 정의되지 않는 점이 있으면 직접 적용 X.  
     → 작은 구/원으로 도려내고 극한 과정 필요.
3) **경계가 조각별 매끈**인지 확인(코너는 OK, 조각별 \(C^1\)이면 충분).
4) **좌표계 선택**  
   - 구/원 계열은 **극/구면 좌표**로 적분이 쉬워짐.
5) **다중 연결영역**  
   - 경계 방향 부호를 반드시 확인(실수 1위).

---

## 7) 심화 예제 — 그린 정리로 면적·토크 계산

### 7.1 면적(임의 매끄러운 단순 폐곡선)
\[
A=\frac12\oint_{\partial D}(x\,dy-y\,dx).
\]
- **다각형**이면 꼭짓점 좌표만으로 계산(shoelace).  
- **부호**는 경계 방향에 의해 결정(반시계면 \(A>0\)).

### 7.2 토크(2D 모멘트) 예시  
평면에서 밀도 \(\rho(x,y)\)와 속도장 \(\mathbf v\)가 있을 때, 축에 대한 순환/토크가 선적분 형태로 간단히 표현되는 경우가 많습니다(적절히 \(P,Q\) 도출하여 Green 적용).

---

## 8) 심화 예제 — 발산정리로 복잡 표면 플럭스 빠르게

**문제**: \(\mathbf F=(x+y,\; y+z,\; z+x)\), \(V=[0,1]^3\).

- \(\nabla\cdot\mathbf F = 1+1+1 = 3\)
- \(\iiint_V 3\,dV = 3\) (한 줄!)
- 개별 면 플럭스를 일일이 적분할 필요 없이 **1초 컷**.

---

## 9) 연습문제 (풀이 스케치 포함)

1) (Green-순환형) \(\mathbf F=(P,Q)=(xy,\; x^2)\), \(D\): \(x^2+y^2\le1\).  
   \[
   Q_x-P_y=2x-y \Rightarrow \iint_D (2x-y)dA=0
   \]
   (원판에서 홀수함수 적분=0) → 경계 선적분도 0.

2) (Green-유량형) \(D\): 꼭짓점 \((0,0),(2,0),(2,1),(0,1)\)의 직사각형. **라인 적분으로 면적**.  
   정답 \(A=2\).

3) (Gauss) \(\mathbf F=(x,0,0)\), \(V=[-a,a]^3\).  
   \(\nabla\cdot\mathbf F=1 \Rightarrow \iiint 1\,dV=(2a)^3\).  
   플럭스는 **x=+a 면의 +유량**과 **x=-a 면의 -유량**이 합쳐져 동일 결과.

4) (Gauss) \(\mathbf F=\dfrac{\mathbf r}{\|\mathbf r\|^3}\), \(V:\) 원점 포함 구 반지름 \(R\).  
   내부에 **특이점**(원점) → 직접 적용 X.  
   작은 구로 제외 후 극한 → 플럭스 \(=4\pi\) (단위원 기준). (전기학의 표준 결과)

---

## 10) 요약

- **그린 정리**: 선적분 ↔ 면적분, **회전/발산**의 2D 누적-경계 등가.
- **발산정리**: 표면 유량 ↔ 부피 발산, 보존 법칙의 수학적 심장.
- **실전**: 면적/무게중심/토크/유량/보존성 검증에 직행, 수치해석 검산에 강력.