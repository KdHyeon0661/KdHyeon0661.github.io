---
layout: post
title: 미적분 - 미적분학의 기본 정리
date: 2025-06-28 22:20:23 +0900
category: 미적분
---
# 미적분학의 기본 정리 (Fundamental Theorem of Calculus)

**핵심:** *미분*과 *정적분*은 서로의 **역연산**이다.  
(수학은 $$\cdots$$, 코드는 ``` 로 감싼다.)

---

## ✅ 1) 제1기본정리 (FTC Part 1: 적분으로 만든 함수의 도함수)

### 정리(표준형)
연속 함수 $$f:[a,b]\to\mathbb{R}$$ 에 대해
$$
F(x)=\int_{a}^{x} f(t)\,dt\quad(x\in[a,b])
$$
이면, $$F$$ 는 $$[a,b]$$ 에서 연속이고 $$(a,b)$$ 에서 미분 가능이며
$$
\boxed{\,F'(x)=f(x)\,}.
$$

> **직관**: “그래프 아래 *누적 면적*의 순간 증가율은 바로 높이(함수값)”.

### 예
$$
f(t)=\cos t,\quad F(x)=\int_0^x \cos t\,dt=\sin x\ \Rightarrow\ F'(x)=\cos x=f(x).
$$

### (조심) 연속이 아닐 때
- $$f$$ 가 불연속이면 $$F'(x)=f(x)$$ 가 **모든 점**에서 성립하지 않을 수 있다.  
- 다만 $f$ 가 적분 가능(리만/르베그)이고 거의 어디서나 연속이면 **대부분의 점**에서 $$F'=f$$ 가 성립(르베그 관점).

---

## ✅ 2) 제2기본정리 (FTC Part 2: 정적분 계산법)

### 정리
$$f$$ 가 $$[a,b]$$ 에서 연속이고 $$F' = f$$ 인 원시함수(부정적분) $$F$$ 가 존재하면
$$
\boxed{\,\int_{a}^{b} f(x)\,dx = F(b)-F(a)\,}.
$$

> **직관**: “넓이 = 원시함수의 끝점 값의 차이.”

### 예
$$
f(x)=2x,\ F(x)=x^2\ \Rightarrow\ \int_{1}^{3}2x\,dx=9-1=8.
$$

---

## ✅ 3) 가변 상한/하한 적분의 미분 (Leibniz 규칙—기본 버전)

연속 $$f$$ 와 미분 가능 $$g(x)$$ 에 대해
$$
H(x)=\int_{a}^{g(x)}f(t)\,dt\quad\Rightarrow\quad
\boxed{\,H'(x)=f(g(x))\cdot g'(x)\,}.
$$

양쪽이 변하면(상·하한이 모두 $$x$$ 의 함수),
$$
\boxed{\
\frac{d}{dx}\int_{\alpha(x)}^{\beta(x)} f(t)\,dt
=f(\beta(x))\,\beta'(x)-f(\alpha(x))\,\alpha'(x)\
}.
$$

> 내부 integrand 가 $$f(t,x)$$ 처럼 $$x$$ 에도 의존하면
> $$
> \frac{d}{dx}\int_{\alpha(x)}^{\beta(x)} f(t,x)\,dt
> =f(\beta(x),x)\beta'(x)-f(\alpha(x),x)\alpha'(x)
> +\int_{\alpha(x)}^{\beta(x)} \frac{\partial f}{\partial x}(t,x)\,dt.
> $$

### 예(가변 상한)
$$
G(x)=\int_{1}^{x^2}\ln t\,dt.
$$
$$
G'(x)=\ln(x^2)\cdot 2x=4x\ln x.
$$

---

## ✅ 4) 왜 성립하나? (증명 스케치·아이디어)

- **제1정리**: 평균값정리(MVT)로
  $$
  \frac{F(x+h)-F(x)}{h}=\frac{1}{h}\int_{x}^{x+h}f(t)\,dt=f(\xi_h)
  $$
  (어떤 $$\xi_h\in(x,x+h)$$). $$h\to 0$$ 에서 $$f(\xi_h)\to f(x)$$ (연속성) ⇒ $$F'(x)=f(x)$$.
- **제2정리**: $$F' = f$$ 를 가정하면
  $$
  \int_a^b f = \int_a^b F' = F(b)-F(a)
  $$
  (뉴턴–라이프니츠 공식).

---

## ✅ 5) 면적·누적량 해석

- 제1정리: “**누적량의 순간 변율 = 밀도(함수값)**”.
- 제2정리: “**누적량 = 변화율의 적분 = 원시함수 차**”.

> 물리 예: 속도 $$v(t)$$ 의 적분은 변위.  
> $$s(t)=\int_{t_0}^{t} v(\tau)\,d\tau \Rightarrow s'(t)=v(t).$$

---

## ✅ 6) 자주 하는 실수 & 체크리스트

- [ ] integrand 가 **연속**인지(최소한 부분연속/적분 가능 + 필요한 미분가능성).  
- [ ] **상·하한 위치**(교환하면 부호가 바뀜: $$\int_b^a=-\int_a^b$$).  
- [ ] 가변 상·하한에서 **곱체인 규칙** 빠뜨리지 않기(끝점에 함수값 × 미분).  
- [ ] 절댓값 면적 문제 vs 정적분(부호) 문제 구분.

---

## ✅ 7) 연습문제 (정답/해설 스케치)

1) $$F(x)=\displaystyle\int_{2}^{x} \frac{1}{1+t^2}\,dt.$$
   - (a) $$F'(x)=\frac{1}{1+x^2}$$  
   - (b) $$F(x)=\arctan x-\arctan 2.$$

2) $$H(x)=\displaystyle\int_{0}^{\sin x} e^{-t^2}\,dt.$$
   - **정답**: $$H'(x)=e^{-(\sin x)^2}\cos x.$$

3) $$\displaystyle\int_{0}^{1} 3x^2\sqrt{1+x^3}\,dx.$$
   - 치환 $$u=1+x^3$$ ⇒ $$du=3x^2dx$$  
   - **정답**: $$\tfrac{2}{3}\left( (1+1^3)^{3/2}-1^{3/2}\right)=\tfrac{2}{3}(2^{3/2}-1).$$

4) $$\displaystyle\frac{d}{dx}\int_{x^2}^{x} \ln(1+t^2)\,dt.$$
   - **정답**: $$\ln(1+x^2)\cdot 1-\ln(1+x^4)\cdot(2x).$$

---

## ✅ 8) 파이썬으로 시각 확인(수치 미분 vs. 원함수)

```python
import numpy as np

# f, F
def f(t): return np.cos(t)
def F(x): return np.sin(x)  # ∫_0^x cos t dt

xs = np.linspace(-2*np.pi, 2*np.pi, 9)
num_deriv = []
h = 1e-6
for x in xs:
    num_deriv.append((F(x+h)-F(x-h))/(2*h))  # 수치미분

print("x:", xs)
print("수치미분 F'(x):", np.round(num_deriv, 6))
print("f(x):", np.round(f(xs), 6))
```

---

## ✅ 9) 한눈 요약

- **제1정리**: $$F(x)=\int_a^x f\Rightarrow F'=f$$ (연속성 필요).  
- **제2정리**: $$\int_a^b f = F(b)-F(a)$$ (원시함수 차).  
- **Leibniz 규칙**: 상·하한이 $$x$$ 에 의존하면 끝점 평가 × 미분 + 내부 파셜.  
- 실전: “누적량–밀도” 관점을 항상 기억하면 풀이 방향이 보인다.