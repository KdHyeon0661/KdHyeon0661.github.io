---
layout: post
title: 미적분 - 미적분학의 기본 정리
date: 2025-06-28 22:20:23 +0900
category: 미적분
---
# 미적분학의 기본 정리 (Fundamental Theorem of Calculus)

## 0) 로드맵

- **제1기본정리(FTC-1)**: 누적적분으로 정의한 함수의 도함수는 **적분 피적분 함수**와 같다.  
- **제2기본정리(FTC-2)**: 정적분은 **원시함수(부정적분)**의 **끝점 값의 차**로 계산된다.  
- **Leibniz 규칙**: 적분의 상한/하한이 변수일 때의 미분, 그리고 파라미터 미분.  
- **파생 규칙**: 치환, 부분적분은 FTC와 미분 규칙에서 자연스럽게 나온다.  
- **정밀성**: 연속성/적분가능성/절대연속성 등 조건과 **실패 사례**.  
- **수치 실험 코드**: FTC를 수치 미분/수치 적분으로 검증.

---

## 1) 제1기본정리 (FTC Part 1) — 적분으로 만든 함수의 도함수

### 정리(표준형)
연속 함수 $$f:[a,b]\to\mathbb{R}$$ 에 대해
$$
F(x)=\int_a^x f(t)\,dt\quad(x\in[a,b])
$$
이면 $$F$$ 는 $$[a,b]$$에서 연속, $$(a,b)$$에서 미분 가능이며
$$
\boxed{F'(x)=f(x)}.
$$

**직관**: “$F$는 $f$의 **누적 면적**. 그 순간 증가율(기울기)은 그 지점의 **높이** $f(x)$.”

#### 빠른 예
$$
f(t)=\cos t,\quad
F(x)=\int_0^x \cos t\,dt=\sin x
\ \Rightarrow\ F'(x)=\cos x=f(x).
$$

#### 증명 스케치(평균값정리)
작은 $h$에 대해
$$
\frac{F(x+h)-F(x)}{h}=\frac1h\int_x^{x+h} f(t)\,dt
= f(\xi_h) \quad (\xi_h\in(x,x+h))
$$
연속성으로 $h\to 0$이면 $f(\xi_h)\to f(x)$.

> **연속이 아닐 때**: $f$가 불연속이면 모든 점에서 $F'(x)=f(x)$가 성립하지 않을 수 있음(아래 §7 참조).  
> 르베그 관점에서는 $f\in L^1$이면 $F(x)=\int_a^x f$는 **절대연속**이고 $F'=f$가 **거의 모든 점**에서 성립.

---

## 2) 제2기본정리 (FTC Part 2) — 정적분 계산법

### 정리(뉴턴–라이프니츠 공식)
$f$가 $[a,b]$에서 연속이고 $F$가 $F'=f$인 원시함수라면
$$
\boxed{\int_a^b f(x)\,dx=F(b)-F(a)}.
$$

**예**
$$
\int_1^3 2x\,dx
= \big[x^2\big]_1^3
= 9-1
= 8.
$$

**설명**: “넓이 = 원시함수의 끝점 값 차이”. FTC-1로 $F$가 $f$의 적분-누적량임을 알고, FTC-2로 **한 번에** 계산한다.

---

## 3) 가변 상·하한 적분의 미분 — Leibniz 규칙(기본형)

상한만 변수:
$$
H(x)=\int_a^{g(x)} f(t)\,dt
\quad\Rightarrow\quad
\boxed{H'(x)=f\big(g(x)\big)\,g'(x)}.
$$

상·하한 모두 변수:
$$
\boxed{\frac{d}{dx}\int_{\alpha(x)}^{\beta(x)} f(t)\,dt
= f(\beta(x))\,\beta'(x)-f(\alpha(x))\,\alpha'(x)}.
$$

적분 내부가 파라미터 $x$에도 의존할 때(미분 가능, 적절한 지배조건 가정):
$$
\boxed{\frac{d}{dx}\int_{\alpha(x)}^{\beta(x)} f(t,x)\,dt
= f(\beta(x),x)\beta'(x)-f(\alpha(x),x)\alpha'(x)
+ \int_{\alpha(x)}^{\beta(x)} \frac{\partial f}{\partial x}(t,x)\,dt}.
$$

**예(상한 $x^2$)**
$$
G(x)=\int_{1}^{x^2}\ln t\,dt
\ \Rightarrow\
G'(x)=\ln(x^2)\cdot (2x)=4x\ln x.
$$

---

## 4) FTC로 보는 핵심 적분법

### 4.1 치환법(변수변환)
연속 $g$, 미분 가능, $u=g(x)$:
$$
\int f\big(g(x)\big)g'(x)\,dx
=\int f(u)\,du.
$$
**유도**: $F'=f$, $dF(g(x))/dx = f(g(x))g'(x)$ ⇒ $\int f(g)g' = F(g)+C$.

### 4.2 부분적분
$u,v$ 미분 가능:
$$
\int u\,dv = uv-\int v\,du.
$$
**유도**: $(uv)'=u'v+uv'$를 적분 후 FTC-2 적용.

---

## 5) 불연속/리만-르베그/절대연속 — 정밀 조건

- **Riemann**: $f$가 $[a,b]$에서 리만적분 가능(유계 + 불연속점 집합이 측도 0)이면 $F(x)=\int_a^x f$는 연속, 거의 모든 곳에서 미분 가능이며 $F'=f$ a.e.  
- **Lebesgue**: $f\in L^1([a,b])$이면 $F(x)=\int_a^x f$는 **절대연속(AC)**, $F'=f$ a.e., 그리고  
  $$
  F(x)=F(a)+\int_a^x F'(t)\,dt.
  $$
- **절대연속(AC)** ⇔ 어떤 $g\in L^1$가 존재하여 $F(x)=F(a)+\int_a^x g(t)\,dt$. 이때 $F'=g$ a.e.

**실패 사례(§7에서 상세)**: $f$의 점프 불연속점에서는 $F'=f$가 보장되지 않음.

---

## 6) Improper integral과 FTC

$f$가 $(a,b]$에서 연속, $a$에서만 특이하면
$$
\int_a^b f(x)\,dx
:=\lim_{\varepsilon\downarrow 0}\int_{a+\varepsilon}^b f(x)\,dx.
$$
원시함수 $F$가 존재하고 $\lim_{x\downarrow a}F(x)$가 유한하면
$$
\int_a^b f = \lim_{x\downarrow a} \big(F(b)-F(x)\big).
$$
(반대 끝점/무한대도 유사.)

---

## 7) 경계/불연속에서의 주의 — **언제 $F'=f$가 실패하나?**

### 7.1 점프 불연속
$f(t)=\mathbf{1}_{\{t\ge 0\}}$ (헤비사이드).  
$F(x)=\int_0^x f(t)\,dt = \max\{x,0\}$.
- $x<0$: $F'(x)=0=f(x)$.  
- $x>0$: $F'(x)=1=f(x)$.  
- $x=0$: $F'$ **미정**(좌미분 0, 우미분 1). $f$가 **불연속**한 점에서는 FTC-1의 “모든 점” 결론이 깨진다.

### 7.2 델타류(분포적 관점)
$f$가 “충격(Dirac)”처럼 분포일 때는 고전적 FTC가 아닌 **분포/약한 미분** 이론을 사용.

---

## 8) 다변수로의 스냅샷 — 선적분의 기본정리(Gradient Theorem)

$F:\mathbb{R}^n\to\mathbb{R}$가 미분 가능, $\nabla F=\mathbf{f}$.  
곡선 $\gamma$가 $a\to b$로 연속적으로 이어질 때
$$
\int_\gamma \mathbf{f}\cdot d\mathbf{r}
= F(b)-F(a).
$$
(그린/발산/스토크스 정리는 FTC의 고차원 일반화로 볼 수 있다.)

---

## 9) 수치 실험 — FTC를 눈으로 확인

아래 코드는 **수치 미분**으로 $F'(x)$를 근사해 $f(x)$와 비교하고, **수치 적분**으로 FTC-2를 확인한다.

### 9.1 $F(x)=\int_0^x \cos t\,dt$ 의 $F'(x)$ vs $f(x)=\cos x$
```python
import numpy as np

def f(t): return np.cos(t)
def F(x): return np.sin(x)  # ∫_0^x cos t dt

xs = np.linspace(-2*np.pi, 2*np.pi, 9)
h = 1e-6
num_deriv = (F(xs+h)-F(xs-h))/(2*h)  # 중심차분

print("x:", xs)
print("수치미분 F'(x):", np.round(num_deriv, 6))
print("f(x):          ", np.round(f(xs), 6))
```

### 9.2 FTC-2: $ \int_1^3 2x\,dx = 8 $ 수치검증
```python
import numpy as np

x = np.linspace(1, 3, 10001)
fx = 2*x
area = np.trapz(fx, x)  # 사다리꼴 적분
print("수치적분:", area, " | 이론:", 9-1)
```

### 9.3 Leibniz 규칙(상한이 $x^2$): $G'(x)=\ln(x^2)\cdot 2x$
```python
import numpy as np

def G(x):
    # 수치적분으로 ∫_1^{x^2} ln t dt
    t = np.linspace(1, x**2, 20001)
    return np.trapz(np.log(t), t)

xs = np.linspace(1.0, 2.0, 5)
h  = 1e-6
num_deriv = np.array([(G(x+h)-G(x-h))/(2*h) for x in xs])
formula   = np.log(xs**2)*(2*xs)

print("x:", xs)
print("G'(x) 수치:", np.round(num_deriv, 6))
print("G'(x) 공식:", np.round(formula,   6))
```

### 9.4 파라미터 미분(적분 내부에 $x$): $I(x)=\int_0^1 t^x \ln t\,dt$
- $J(x)=\int_0^1 t^x\,dt = \frac{1}{x+1}$ (단, $x>-1$)
- $I(x)=J'(x)= -\frac{1}{(x+1)^2}$ 를 확인.
```python
import numpy as np

def I(x):
    t = np.linspace(1e-8, 1, 200000)   # 0 근처 수치적분 안정화
    return np.trapz((t**x)*np.log(t), t)

xs = np.array([0.0, 0.5, 1.0, 2.0])
num = np.array([I(x) for x in xs])
the = -1.0/(xs+1.0)**2

print("x:", xs)
print("I(x) 수치:", np.round(num, 6))
print("I(x) 이론:", np.round(the, 6))
```

---

## 10) 실전 테크닉 — FTC 관점에서 문제 푸는 루틴

1) **적분의 미분**이냐 **미분의 적분**이냐를 먼저 식별.  
2) **치환**이 먹히는지(내부에 $g'(x)$가 보이는지) 확인.  
3) **부분적분**이 필요한지(곱 구조 또는 로그/역삼각) 본다.  
4) **경계/부호/연속성** 조건 점검(FTC 적용 가능성).  
5) **수치 검증**으로 빠르게 sanity-check.

---

## 11) 자주 하는 실수 체크리스트

- [ ] 상·하한 순서 혼동: $$\int_b^a f = -\int_a^b f$$.  
- [ ] 가변 상·하한에서 **체인 규칙** 누락(끝점 함수값 × 끝점 미분).  
- [ ] 면적 문제에서 **절댓값** 누락(정적분은 부호를 가짐).  
- [ ] 불연속점에서 FTC-1을 **모든 점**에 적용하려 함(거의 모든 점 or 연속점에서 성립).  
- [ ] 치환에서 **새 하한·상한** 변환 깜박함($u=g(a),g(b)$).

---

## 12) 연습문제(해설 포함)

**1) $F(x)=\displaystyle\int_{2}^{x} \frac{1}{1+t^2}\,dt$**  
(a) $F'(x)=\dfrac{1}{1+x^2}$ (FTC-1).  
(b) 원시함수 $\arctan t$ → $F(x)=\arctan x-\arctan 2$.

**2) $H(x)=\displaystyle\int_{0}^{\sin x} e^{-t^2}\,dt$**  
Leibniz(상한 $\sin x$): $H'(x)=e^{-(\sin x)^2}\cdot\cos x$.

**3) $\displaystyle\int_{0}^{1} 3x^2\sqrt{1+x^3}\,dx$**  
치환 $u=1+x^3$, $du=3x^2dx$:  
$\displaystyle \int_{u=1}^{2} \sqrt{u}\,du=\Big[\tfrac{2}{3}u^{3/2}\Big]_1^2=\tfrac{2}{3}(2^{3/2}-1)$.

**4) $\displaystyle\frac{d}{dx}\int_{x^2}^{x} \ln(1+t^2)\,dt$**  
상한 $x$, 하한 $x^2$:  
$\ln(1+x^2)\cdot 1 - \ln\big(1+(x^2)^2\big)\cdot (2x)$.

**5) (파라미터) $J(\alpha)=\int_0^\infty e^{-\alpha t}\sin t\,dt\ (\alpha>0)$**  
지배수렴 하에 $J'(\alpha)=\int_0^\infty -t e^{-\alpha t}\sin t\,dt$.  
또는 표준 적분으로 $J(\alpha)=\dfrac{1}{1+\alpha^2}$.

**6) (연속성 체크) $f=\mathbf{1}_{\{t\ge 0\}}$**  
$F(x)=\int_0^x f(t)\,dt=\max\{x,0\}$, $F'$은 $x\ne 0$에서만 존재, $x=0$에서 미정.

---

## 13) 한눈 요약

- **FTC-1**: $F(x)=\int_a^x f \Rightarrow F'(x)=f(x)$ (연속점에서).  
- **FTC-2**: $\int_a^b f = F(b)-F(a)$ (원시함수 $F$).  
- **Leibniz**: 가변 상·하한/파라미터 미분 공식은 **끝점 평가 × 미분 + 내부 파셜**.  
- **치환·부분적분**: FTC와 미분 규칙에서 자연히 유도.  
- **정밀 조건**: 리만/르베그/절대연속으로 일반화, 불연속/경계에서의 주의.  
- 풀이 루틴: **구조 파악 → 조건 점검 → 적절한 규칙 선택 → 수치 검증**.
