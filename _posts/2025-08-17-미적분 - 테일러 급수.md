---
layout: post
title: 미적분 - 테일러 급수
date: 2025-08-17 22:20:23 +0900
category: 미적분
---
# 테일러 급수(Taylor Series)

## 1. 직관과 개념

한 함수를 한 점 \(a\) 주변에서 **다항식으로 국소 근사**하는 것이 테일러 급수다. 미분 가능한 정보를 차수별로 모아 다항식 계수로 쓰고, 차수를 올릴수록 근사가 정밀해진다.

---

## 2. 정의와 테일러 정리(나머지항 포함)

함수 \(f\)가 점 \(a\)에서 모든 차수 미분 가능하면, 형식적으로
$$
f(x) \sim \sum_{n=0}^{\infty}\frac{f^{(n)}(a)}{n!}(x-a)^n.
$$

유한 차수 \(n\)에서의 **테일러 다항식**
$$
P_n(x)=\sum_{k=0}^{n}\frac{f^{(k)}(a)}{k!}(x-a)^k,\qquad R_n(x):=f(x)-P_n(x).
$$

나머지항의 대표적 표현들:

- 라그랑주 나머지항  
  $$
  R_n(x)=\frac{f^{(n+1)}(c)}{(n+1)!}(x-a)^{n+1},\qquad c\in(a,x).
  $$

- 코시 나머지항  
  $$
  R_n(x)=\frac{f^{(n+1)}(\xi)}{n!}(x-a)^n(x-\xi),\qquad \xi\in(a,x).
  $$

- 적분형 나머지항  
  $$
  R_n(x)=\frac{1}{n!}\int_{a}^{x}f^{(n+1)}(t)(x-t)^n\,dt.
  $$

- 페아노(작은-o)형  
  $$
  f(x)=P_n(x)+o\!\left((x-a)^n\right)\quad(x\to a).
  $$

---

## 3. 수렴반경과 수렴구간

테일러 계수를 \(a_n=\frac{f^{(n)}(a)}{n!}\)라 쓰면 멱급수
$$
\sum_{n=0}^{\infty} a_n (x-a)^n
$$
의 **수렴반경 \(R\)**은 비율/근 판정으로 구한다.
$$
R=\lim_{n\to\infty}\left|\frac{a_n}{a_{n+1}}\right|
\quad \text{또는}\quad
\frac{1}{R}=\limsup_{n\to\infty}|a_n|^{1/n}.
$$
- \(|x-a|<R\): 절대수렴, 항별 미분·적분 가능.
- \(|x-a|>R\): 발산.
- \(|x-a|=R\): 개별 판정 필요.

---

## 4. 항별 미분·적분 정리

\(|x-a|<R\)에서
$$
\frac{d}{dx}\sum_{n=0}^{\infty}a_n(x-a)^n
=\sum_{n=1}^{\infty}n a_n(x-a)^{n-1},
$$
$$
\int \sum_{n=0}^{\infty}a_n(x-a)^n\,dx
=\sum_{n=0}^{\infty}\frac{a_n}{n+1}(x-a)^{n+1}+C.
$$
미분·적분 후의 수렴반경은 동일하며, 경계점 거동은 달라질 수 있다.

---

## 5. 표준 맥클로린 급수(암기표)

- 기하급수( \(|x|<1\) )
  $$
  \frac{1}{1-x}=\sum_{n=0}^{\infty}x^n.
  $$
- 지수
  $$
  e^x=\sum_{n=0}^{\infty}\frac{x^n}{n!}.
  $$
- 사인/코사인
  $$
  \sin x=\sum_{n=0}^{\infty}(-1)^n\frac{x^{2n+1}}{(2n+1)!},\quad
  \cos x=\sum_{n=0}^{\infty}(-1)^n\frac{x^{2n}}{(2n)!}.
  $$
- 로그( \(-1<x\le 1\) )
  $$
  \ln(1+x)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{x^n}{n}.
  $$
- 아크탄( \(|x|\le 1\) )
  $$
  \arctan x=\sum_{n=0}^{\infty}(-1)^n\frac{x^{2n+1}}{2n+1}.
  $$

---

## 6. 예제와 오차 설계

### 6.1 \(e^x\) (중심 \(a=0\))
5차 다항식:
$$
P_5(x)=1+x+\frac{x^2}{2}+\frac{x^3}{6}+\frac{x^4}{24}+\frac{x^5}{120}.
$$
라그랑주 나머지:
$$
|R_5(x)|=\left|\frac{e^{c}}{6!}x^6\right|\le \frac{e^{|x|}}{720}|x|^6.
$$
예: \(|x|\le 1\)에서 \(|R_5(x)|\le \frac{e}{720}\approx 0.00378\).

목표 오차 \(\varepsilon\)에 맞추려면 \(n\)을 키워 \(\frac{e^{|x|}}{(n+1)!}|x|^{n+1}\le \varepsilon\)을 만족시키면 된다.

### 6.2 \(\sin x\) (교대·홀수항만)
3차 근사:
$$
\sin x \approx x-\frac{x^3}{6}.
$$
오차는 다음 항 절댓값 이하:
$$
|R_3(x)|\le \frac{|x|^5}{5!}.
$$
\(|x|=0.3\)이면 \(|R_3|\le 0.3^5/120\approx 2.43\times 10^{-5}\).

### 6.3 \(\ln(1+x)\) 의 교대수렴과 오차
$$
\ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}-\cdots,\quad -1<x\le 1.
$$
\(x\in(0,1]\)에서 단조감소 교대급수이므로 **오차 ≤ 다음 항**:
$$
\left|\ln(1+x)-\sum_{k=1}^{n}(-1)^{k+1}\frac{x^k}{k}\right|\le \frac{x^{n+1}}{n+1}.
$$
예: \(x=0.5\), \(n=4\)일 때 오차 \(\le 0.5^5/5=0.00625\).

경계 \(x=1\): \(\ln 2=1-\tfrac12+\tfrac13-\cdots\) (조건수렴). 속도는 느림.

### 6.4 \(\arctan x\) 로 \(\pi\) 근사
$$
\frac{\pi}{4}=\arctan(1)=1-\frac{1}{3}+\frac{1}{5}-\cdots.
$$
교대급수 오차 ≤ 다음 항: \(1/(2n+3)\). 느리므로 마친 공식을 함께 쓰는 것이 실용적이다(예: Machin 형식).

---

## 7. 반례와 주의점

- 미분은 되지만 **해석적(analytic)**이지 않은 케이스:  
  \(f(x)=e^{-1/x^2}\) ( \(x\ne 0\) ), \(f(0)=0\). 모든 계수가 \(0\)이어서 \(x=0\)에서의 테일러 급수는 **항상 0**인데, \(x\ne 0\)에서 \(f(x)\ne 0\).  
  즉, 테일러 급수가 함수에 수렴하지 않을 수 있다.

- 비미분점: \(f(x)=|x|\)은 \(a=0\)에서 미분 불가 → 테일러 전개 불가.

- 경계점: 수렴반경의 테두리에서는 별도 판정 필요(로그·아크탄에서 자주 등장).

---

## 8. 급수 연산과 조합 기술

- 합/곱: 전개해 계수 정리(코시 곱). 수렴반경은 보통 더 작은 쪽에 의해 제한.
- 나눗셈: 분모가 \(1+(\text{고차})\) 형태면 기하급수 전개 후 곱.
- 합성 \(f(g(x))\): \(g(a)=0\)이면 맥클로린 표준형을 빠르게 얻을 수 있다.
- 미분방정식에서의 계수 비교:  
  예) \(y'=y\), \(y(0)=1\) → 계수방정식 \( (n+1)a_{n+1}=a_n \Rightarrow a_n=\frac{1}{n!}\) → \(e^x\).

---

## 9. 오차 설계 레시피

- 라그랑주 상계: \(|f^{(n+1)}(t)|\le M\) on \([a,x]\) 이면
  $$
  |R_n(x)|\le \frac{M}{(n+1)!}|x-a|^{n+1}.
  $$

- 교대·단조 감소 급수(로그/아크탄 등): 오차 ≤ 다음 항 절댓값.

- 실무 팁: 구간 \(|x-a|\le h\)에서의 균일 오차를 원하면 \(M=\max_{|t-a|\le h}|f^{(n+1)}(t)|\)를 잡아 한 번에 \(n\) 선택.

예) \(|x|\le 1\)에서 \(e^x\)를 오차 \(10^{-6}\) 이내로:  
\(\frac{e}{(n+1)!}\le 10^{-6}\)을 만족하는 최소 \(n\)은 \(n=9\) ( \(10!\approx 3.6\cdot 10^6\) ).

---

## 10. 실전 코드 스니펫

### 10.1 SymPy로 테일러(맥클로린) 전개와 수치 확인
```python
import sympy as sp

x = sp.symbols('x')
f = sp.exp(x) * sp.cos(x)  # 예: e^x cos x
series = sp.series(f, x, 0, 8)  # 0에서 7차까지
print(series)  # O(x^8) 포함

# 다항식 부분만 추출하여 함수로
P7 = sp.series(f, x, 0, 8).removeO()
P7_func = sp.lambdify(x, P7, 'numpy')
f_func  = sp.lambdify(x, f, 'numpy')

# 에러 평가(예: x=0.7)
import numpy as np
val  = f_func(0.7)
pval = P7_func(0.7)
print("true=", val, " approx=", pval, " abs err=", abs(val-pval))
```

### 10.2 일반 테일러 다항식 생성 함수(중심 \(a\))
```python
def taylor_poly(expr, var, a, n):
    """
    expr: SymPy 표현식 f(x), var: 기호, a: 중심(수치), n: 차수
    반환: P_n(x)
    """
    return sp.series(expr, var, a, n+1).removeO()

# 예: ln(1+x) 의 6차, 중심 0
P6 = taylor_poly(sp.log(1+x), x, 0, 6)
print(P6)
```

### 10.3 호너 방식으로 테일러 다항식 평가(수치 안정성)
```python
def horner_eval(coeffs, t):
    """
    coeffs = [c0, c1, ..., cn] for sum c_k * t^k
    """
    acc = 0.0
    for c in reversed(coeffs):
        acc = acc * t + c
    return acc

# 예: e^x 맥클로린 5차 계수
import math
coeffs = [1.0, 1.0, 1/2, 1/6, 1/24, 1/120]
xval = 0.8
print(horner_eval(coeffs, xval))
```

### 10.4 오차 상계 자동 추천(라그랑주)
```python
def lagrange_error_bound(M, h, n):
    # |R_n| <= M * h^{n+1} / (n+1)!
    from math import factorial
    return M * (h**(n+1)) / factorial(n+1)

# 예: |x|<=1에서 e^x 의 (n+1)차 도함수도 e^x 이므로 M = e
from math import e
for n in range(3, 11):
    print(n, lagrange_error_bound(e, 1.0, n))
```

---

## 11. 여러 변수의 테일러(간략)

\(f:\mathbb{R}^m\to\mathbb{R}\) 이 \(a\in\mathbb{R}^m\)에서 두 번 미분 가능:
$$
f(x)\approx f(a)+\nabla f(a)^{\!\top}(x-a)+\frac12(x-a)^{\!\top}H_f(a)(x-a),
$$
여기서 \(H_f\)는 헤시안. 고차항은 다중 지수의 멱급수로 확장된다. 최적화의 정성적 분석(볼록/준볼록, 뉴턴법)에서 핵심.

---

## 12. 패데 근사(Padé) 한 줄 요약

테일러 다항식 대신 유리함수 \(P/Q\)로 맞추면 극/지수형 거동에 강하고 수렴영역이 넓어지는 경우가 많다. 고주파·큰 \(|x|\)에서 테일러보다 안정적인 경우가 많다.

---

## 13. 체크리스트

1) 중심 \(a\) 선택(오차가 필요한 구간의 중앙이 유리).  
2) 수렴반경과 경계점 확인.  
3) 나머지항 유형으로 오차 상계 산출.  
4) 교대·단조면 “다음 항” 오차를 활용.  
5) 구현은 호너 평가로 안정화.  
6) 필요 시 패데로 보완.

---

## 14. 연습문제(풀이 스케치 포함)

1) \(f(x)=\ln(1+x)\). \(|x|\le 0.5\)에서 오차 \(10^{-4}\) 이내가 되려면 몇 차까지?  
   교대·단조 사용: \(\frac{0.5^{n+1}}{n+1}\le 10^{-4}\)을 만족하는 최소 \(n\).

2) \(f(x)=e^x\cos x\). \(a=0\), 6차 다항식 작성 및 \(|x|\le 0.6\) 오차 상계.  
   \(|f^{(7)}(t)|\le e^{|t|}\sqrt{2}\) 등을 사용해 라그랑주 상계 계산.

3) \(f(x)=\arctan x\). \(x=1\)에서 \(\pi/4\) 근사 시 \(n\)번째 부분합의 오차 ≤ \(1/(2n+3)\)를 증명.

4) \(f(x)=e^{-1/x^2}\) ( \(x\ne 0\), \(f(0)=0\) ). \(a=0\)에서 모든 계수가 0임을 보이고, \(x>0\)에서 \(f(x)>0\)로 테일러 급수가 함수에 수렴하지 않음을 설명.

---

## 15. 간단 예시 계산 로그

### 15.1 \(\sin(0.3)\) 5차 근사
$$
\sin x \approx x-\frac{x^3}{6}+\frac{x^5}{120}.
$$
오차 상계 \(\le \frac{|x|^7}{7!}\approx 0.3^7/5040\approx 2.18\times 10^{-7}\).

### 15.2 \(\ln(1+0.5)\) 6항 근사
부분합 \(S_6=0.5-\frac{0.5^2}{2}+\cdots-\frac{0.5^6}{6}\).  
오차 \(\le 0.5^7/7\approx 0.00112\).

---

## 마무리

테일러 급수의 핵심은  
- 국소 다항식 근사,  
- 나머지항을 통한 **정량적 오차 관리**,  
- 수렴반경과 경계점의 **정성적 이해**다.  
표준 급수와 오차 레시피, 간단한 코드만 준비하면 공학/수치/모델링 과제에서 신속하게 실용 근사를 얻을 수 있다.