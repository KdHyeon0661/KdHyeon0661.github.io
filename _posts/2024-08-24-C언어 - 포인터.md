---
layout: post
title: C - 포인터
date: 2024-08-24 19:20:23 +0900
category: C
---
# 포인터(Pointer)

포인터는 **변수의 메모리 주소를 다루는 도구**로, 고급 프로그래밍과 메모리 제어에 필수적인 개념입니다.

---

## 포인터란?

- 포인터는 **메모리 주소를 저장하는 변수**입니다.
- 선언 시 `*` 기호를 사용하여 정의합니다.

```c
int a = 10;
int* p = &a;  // p는 a의 주소를 가짐

printf("%p\n", p);   // 주소 출력
printf("%d\n", *p);  // 역참조 → 10 출력
```

| 기호 | 의미 |
|------|------|
| `&` | 주소 연산자: 변수의 주소 |
| `*` | 역참조 연산자: 주소가 가리키는 값 |

---

## 포인터의 기본 사용

```c
int x = 42;
int* ptr = &x;

printf("x의 주소: %p\n", ptr);
printf("x의 값: %d\n", *ptr);
```

- `ptr`은 변수 `x`의 주소를 저장함
- `*ptr`은 주소에 저장된 실제 값을 의미

---

## 포인터를 통한 값 변경

```c
void set_to_zero(int* n) {
    *n = 0;
}

int main() {
    int a = 5;
    set_to_zero(&a);
    printf("%d\n", a);  // 0
}
```

- 포인터를 이용하면 **함수에서 원본 값을 직접 변경** 가능
- → **Call by Reference 방식 구현**

---

## 포인터와 배열

배열명 자체는 **첫 번째 요소의 주소를 의미하는 포인터**입니다.

```c
int arr[3] = {1, 2, 3};
int* p = arr;

printf("%d\n", *(p + 1));  // 2 출력
```

- `arr[1] == *(arr + 1)`
- 포인터 연산이 가능함 (단, 자료형 크기 기준으로 이동)

---

## 포인터와 문자열

```c
char* str = "Hello";
printf("%c\n", *(str + 1));  // 'e'
```

- 문자열 리터럴은 읽기 전용 → 변경 금지
- 가변 문자열은 `char 배열`로 선언

```c
char msg[] = "Hi";
msg[0] = 'B';  // "Bi"
```

---

## NULL 포인터

```c
int* p = NULL;
```

- 어떤 주소도 가리키지 않는 포인터
- 사용 전 반드시 NULL 여부 확인해야 함

```c
if (p != NULL) {
    printf("%d", *p);
}
```

---

## 포인터의 포인터(이중 포인터)

```c
int x = 10;
int* p = &x;
int** pp = &p;

printf("%d\n", **pp);  // 10
```

- 이중 포인터(`**pp`)는 포인터를 가리키는 포인터
- 2차원 배열이나 동적 할당 시 자주 사용

---

## 이중 포인터의 활용

### 포인터 값을 함수에서 바꾸고 싶을 때

```c
void setNull(int** ptr) {
    *ptr = NULL;
}

int main() {
    int x = 100;
    int* p = &x;
    setNull(&p);
    // p는 이제 NULL
}
```

---

## 함수 인자로 포인터 사용 예

```c
void swap(int* a, int* b) {
    int temp = *a;
    *a = *b;
    *b = temp;
}

int main() {
    int x = 1, y = 2;
    swap(&x, &y);
    printf("%d %d\n", x, y);  // 2 1
}
```

---

## 함수 포인터란?

> 함수의 **주소를 저장하는 포인터**로, **함수를 인자로 전달**하거나 **동적으로 호출**할 수 있습니다.

### 기본 형식:

```c
반환형 (*포인터이름)(매개변수);
```

예:

```c
int add(int a, int b) {
    return a + b;
}

int (*fp)(int, int) = add;
printf("%d\n", fp(3, 4));  // 7 출력
```

---

## 함수 포인터 활용 예제

### 1. 함수 선택기

```c
int add(int a, int b) { return a + b; }
int mul(int a, int b) { return a * b; }

void operate(int x, int y, int (*op)(int, int)) {
    printf("결과: %d\n", op(x, y));
}

int main() {
    operate(3, 4, add);  // 결과: 7
    operate(3, 4, mul);  // 결과: 12
}
```

---

## 배열과 함수 포인터

```c
int add(int a, int b) { return a + b; }
int sub(int a, int b) { return a - b; }

int (*ops[2])(int, int) = {add, sub};

int main() {
    printf("%d\n", ops[0](5, 2));  // 7
    printf("%d\n", ops[1](5, 2));  // 3
}
```

---

## 정리

| 개념 | 설명 | 예시 |
|------|------|------|
| 이중 포인터 | 포인터를 가리키는 포인터 | `int** pp = &p;` |
| 함수 포인터 | 함수를 가리키는 포인터 | `int (*fp)(int, int)` |
| 포인터 배열 | 여러 함수 저장 및 호출 | `fp[0](), fp[1]() 등` |
| 활용 | 콜백 함수, 동적 호출, 다형성 구현 등 | 메뉴, 계산기, API 등 |

---

## 주의사항

- 이중 포인터는 `*` 연산자가 여러 번 사용되므로 헷갈릴 수 있음 → 단계별로 디버깅
- 함수 포인터는 **정확한 시그니처 일치**가 필수
- `(*fp)(...)`처럼 괄호로 묶는 것이 중요 (`*fp(...)`는 다른 의미)

---

## 포인터 관련 자주 하는 실수와 주의점

포인터는 강력한 만큼 실수가 많을 수 있는 부분입니다. 아래는 흔히 발생하는 오류와 주의 사항입니다.

---

### 일반 변수에 `NULL`을 넣는 경우

`NULL`은 포인터용 상수로, **정수형 또는 일반 변수에 사용하는 것은 논리적으로 잘못된 표현**입니다.

```c
int x = NULL;  // 컴파일러에 따라 경고 또는 오류
```

- 일부 컴파일러는 `NULL`을 `0`으로 간주해 에러 없이 동작할 수 있으나 **의미적으로 올바르지 않습니다**.
- `NULL`은 **포인터 초기화 용도**로만 사용해야 합니다.

---

### 포인터에 잘못된 값 대입

```c
int* p = 100;  // 임의의 정수 값을 주소처럼 사용 → 위험
*p = 5;        // 런타임 에러 또는 세그먼트 폴트 가능
```

- 포인터는 반드시 유효한 메모리 주소를 가리키고 있어야 합니다.
- 초기화 없이 사용하거나 리터럴 상수를 넣으면 프로그램이 비정상 종료될 수 있습니다.

---

### 일반 변수 주소를 포인터 없이 직접 할당

```c
int a = 10;
int* p = a;  // 오류! a는 int형이고 주소가 아님
```

- `int*` 타입은 반드시 **주소값** (`&a`)을 받아야 합니다.

```c
int* p = &a;  // 올바른 선언
```

---

### 포인터끼리 연산

```c
int a = 10, b = 20;
int* pa = &a;
int* pb = &b;

int *sum = pa + pb;  // 의미 없는 연산, 대부분 컴파일 에러
```

- 포인터 간 덧셈은 정의되지 않음 (단, 같은 배열 내에서 뺄셈은 가능)
- 더해서 만든 값은 아무 의미를 가지지 않음
- 뺄샘의 경우, 사용자 정의 allocator 등에서 할당 영역 내 오프셋 계산 및 포인터 관리, 디버거나 메모리 분석 도구에서 포인터 차이를 이용해 스택 프레임이나 변수 간 거리 분석 등의 장점을 가지고 있다.

---

## 정리

| 개념 | 설명 |
|------|------|
| `*` | 주소에 저장된 값을 읽음 (역참조) |
| `&` | 변수의 주소 |
| 포인터 | 메모리 주소를 저장하는 변수 |
| 배열과 포인터 | 사실상 동일하게 동작 |
| 문자열 | `char*` 또는 `char[]` 로 표현 |
| NULL | 아무것도 가리키지 않음 |
| `**` | 포인터를 가리키는 포인터 |