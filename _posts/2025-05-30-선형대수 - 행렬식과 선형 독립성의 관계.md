---
layout: post
title: 선형대수 - 행렬식과 선형 독립성의 관계
date: 2025-05-30 22:20:23 +0900
category: 선형대수
---
# 🔗 행렬식(det)과 선형 독립성 — 왜, 어떻게, 무엇에 쓰나

**핵심 한 줄 요약**
$$
\boxed{\text{열벡터들이 선형 독립} \;\Longleftrightarrow\; \det(A)\neq 0}
$$

여기서 \(A=[\mathbf{v}_1\;\mathbf{v}_2\;\cdots\;\mathbf{v}_n]\in\mathbb{R}^{n\times n}\) 는 열에 벡터들을 모은 정방행렬입니다.

---

## 1. 용어 리마인드

- **선형 독립**:
  \(c_1\mathbf{v}_1+\cdots+c_n\mathbf{v}_n=\mathbf{0}\)의 유일한 해가 \(c_1=\cdots=c_n=0\).
- **행렬식(det)**: 정방행렬 \(A\)를 스칼라로 보내는 함수.
  기하학적으로 **부피스케일(및 방향)**, 대수적으로 **곱셈에 관한 대수량**.
- **랭크(rank)**: 선형 독립한 행(또는 열)의 최대 개수.

---

## 2. 왜 \(\det(A)\neq 0 \iff\) 선형 독립인가? (대수적 증명)

### 2.1 \(\det(A)=0 \Rightarrow\) 선형 **종속**
행렬식의 **다중선형성(각 열에 선형)**과 **교대성(같은 열이 있으면 det=0)**을 이용:

- 만약 어떤 열이 다른 열들의 선형 결합이면
  \(\mathbf{v}_k=\sum_{j\neq k}\alpha_j\mathbf{v}_j\)
  → 열들을 그 선형결합으로 바꿔도 det는 다중선형성으로 전개되는데, 결국 **같은 열이 생기거나** 교대성 때문에 **전체가 0**이 됨.
  따라서 **열 종속 ⇒ \(\det(A)=0\)**.

### 2.2 \(\det(A)\neq 0 \Rightarrow\) 선형 **독립**
- \(\det(A)\neq 0\) 이면 **역행렬** \(A^{-1}\) 이 존재(아주 중요한 등가조건).
- \(A\mathbf{c}=\mathbf{0}\)을 가정하면, 양변에 \(A^{-1}\)을 곱해 \(\mathbf{c}=\mathbf{0}\).
  즉 **영벡터만 해** → 선형 독립.

> 결론:
> \[
> \boxed{
> \det(A)\neq 0 \;\Longleftrightarrow\; A^{-1}\ \text{존재} \;\Longleftrightarrow\; \mathrm{rank}(A)=n \;\Longleftrightarrow\; \text{열/행 선형 독립}
> }
> \]

---

## 3. 기하학: “부피가 0이면 눌려 있다”

- \(n\)개의 열벡터가 만드는 \(n\)-평행다체(parallelotope)의 **부피=|\det(A)|**.
- **부피=0** ↔ 벡터들이 더 낮은 차원 초평면에 눌림 ↔ **선형 종속**.
- \(\det>0\)/\(<0\)는 **방향(오리엔테이션)**만 다르고 독립성에는 무관.

---

## 4. 연립방정식/해의 구조와의 연결 (정방행렬)

선형시스템 \(A\mathbf{x}=\mathbf{b}\):

| 조건 | 등가 | 해의 상태 |
|---|---|---|
| \(\det(A)\neq 0\) | \(\mathrm{rank}(A)=n\), \(A^{-1}\) 존재 | **임의의 \(\mathbf{b}\)**에 대해 **유일해** |
| \(\det(A)=0\) | \(\mathrm{rank}(A)<n\) | 어떤 \(\mathbf{b}\)는 해가 없거나 무한히 많음 |

---

## 5. **정방행렬이 아닐 때**: Gram 행렬로 확장

\(A\in\mathbb{R}^{m\times n}\) (열이 \(n\)개, \(m\ge n\))라면 **Gram 행렬** \(G=A^\top A\in\mathbb{R}^{n\times n}\):

\[
\boxed{\; \det(G)=0 \;\Longleftrightarrow\; \text{A의 열이 종속} \;}
\quad(\text{그리고 } \det(G)>0 \iff \text{열 독립})
\]

- \(G\)는 양의 준정정(PSD), 독립이면 양의 정정(PD) → \(\det(G)>0\).
- 기하학적으로 \(\sqrt{\det(G)}\)는 열벡터들이 만드는 **n-부피**.

---

## 6. 계산 실무: det로 판단해도 될까?

- **작은 차원(2–3)**: det로 직관적/간단.
- **중/대형·수치안정성**: det는 **조건수**나 스케일에 민감.
  → **랭크(SVD/QR)**, **최소 특이값 \(\sigma_{\min}\)**, 또는 **Gram det**가 더 안정적.
- 부동소수 오차: `np.linalg.det`은 0 근처에서 오차 큼 → `slogdet`, `matrix_rank`, `svdvals` 권장.

---

## 7. 손계산 예제

### 7.1 독립 (2×2)
\[
A=\begin{bmatrix}3&5\\2&4\end{bmatrix},\quad
\det(A)=3\cdot4-5\cdot2=2\neq 0
\]
→ 열 독립, \(A^{-1}\) 존재, 임의 \(\mathbf{b}\)에 유일해.

### 7.2 종속 (3×3)
\[
A=\begin{bmatrix}1&2&3\\2&4&6\\1&1&1\end{bmatrix}
\]
두 번째 열이 첫 번째의 2배, 세 번째가 첫+두 번째의 1.5배 → \(\det(A)=0\) (열 종속).

### 7.3 정방 아님(Gram)
\[
A=\begin{bmatrix}1&0\\1&1\\0&1\end{bmatrix},\quad
G=A^\top A=\begin{bmatrix}2&1\\1&2\end{bmatrix},\quad
\det(G)=3>0
\]
→ 열 독립(이 \(A\)는 \(\mathbb{R}^3\)의 2차원 평면 기저).

---

## 8. Python/SymPy/NumPy/PyTorch 실습

> **팁**: 작은 예시는 SymPy(정확), 실무는 NumPy/PyTorch로 **랭크/SVD/Gram** 기반 판정.

### 8.1 SymPy — 정확한 det로 판정
```python
from sympy import Matrix

A_ind = Matrix([[3,5],[2,4]])
A_dep = Matrix([[1,2,3],[2,4,6],[1,1,1]])

print("det(A_ind) =", A_ind.det())   # 2  → 독립
print("det(A_dep) =", A_dep.det())   # 0  → 종속
```

### 8.2 NumPy — 랭크/특이값/Gram
```python
import numpy as np

def independence_report(A, tol=1e-10):
    A = np.array(A, dtype=float)
    detA = None
    if A.shape[0] == A.shape[1]:
        detA = np.linalg.det(A)
    # SVD
    s = np.linalg.svd(A, compute_uv=False)
    rank = np.sum(s > tol * s.max())
    gram_det = np.linalg.det(A.T @ A) if A.shape[0] >= A.shape[1] else None
    return dict(det=detA, rank=int(rank), sigma_min=s.min(), gram_det=gram_det)

print(independence_report([[3,5],[2,4]]))
print(independence_report([[1,2,3],[2,4,6],[1,1,1]]))
print(independence_report([[1,0],[1,1],[0,1]]))  # 정방 아님 → Gram 사용
```

### 8.3 PyTorch — 랭크/Gram/조건수(선호 프레임워크)
```python
import torch

def torch_independence_report(A, tol=1e-12):
    A = torch.as_tensor(A, dtype=torch.float64)
    square = A.shape[0] == A.shape[1]
    detA = torch.linalg.det(A).item() if square else None

    # SVD 기반 랭크
    s = torch.linalg.svdvals(A)
    rank = int((s > tol * s.max()).sum().item())
    sigma_min = s.min().item()
    cond = (s.max()/s.min()).item() if s.min() > 0 else float('inf')

    gram_det = None
    if A.shape[0] >= A.shape[1]:
        gram_det = torch.linalg.det(A.T @ A).item()

    return {
        "det": detA,
        "rank": rank,
        "sigma_min": sigma_min,
        "cond_number": cond,
        "gram_det": gram_det
    }

print(torch_independence_report([[3,5],[2,4]]))
print(torch_independence_report([[1,2,3],[2,4,6],[1,1,1]]))
print(torch_independence_report([[1,0],[1,1],[0,1]]))
```

### 8.4 “거의 종속” 사례(수치불안정)
```python
import numpy as np

eps = 1e-8
A = np.array([[1, 2],
              [2, 4+eps]], dtype=float)

detA = np.linalg.det(A)
s = np.linalg.svd(A, compute_uv=False)
cond = s.max()/s.min()

print("det ~", detA)   # 매우 작음(0에 근접) → 거의 종속
print("cond ~", cond)  # 매우 큼 → 수치 민감
```

---

## 9. 응용 연결고리

- **기저/차원**: \(\det(A)\neq 0\)이면 열이 **기저**가 됨(\(\mathbb{R}^n\) 전체 생성).
- **역행렬/선형시스템**: \(\det\neq0\) ↔ \(A^{-1}\) 존재 ↔ \(A\mathbf{x}=\mathbf{b}\) **유일해**.
- **최소제곱(회귀)**: \(X^\top X\)가 **가역**(det>0)이어야 **해 유일**. 다중공선성 ↔ \(\det(X^\top X)=0\).
- **PCA/공분산**: 공분산 \(\Sigma\)의 \(\det(\Sigma)=0\) ↔ **특잇축 존재**(분산 0) ↔ 데이터가 낮은 차원에 놓임.
- **기하학/그래픽스**: \(|\det(A)|\)는 축척(부피). 0이면 평면/선에 눌려 **퇴화**.

---

## 10. 자주 하는 실수 & 체크리스트

1) **정방이 아닌데 det로 판정** → ❌ → **Gram det**(=\(\det(A^\top A)\))나 **랭크** 사용.
2) **det만 믿고 안정성 간과** → 근사 0 상황에 취약 → **SVD/랭크/cond** 확인.
3) **스케일 민감**: 열 스케일링에 det도 스케일 → 비교는 정규화/조건수 병행.
4) **정수/유리 문제**: 정확 판정 필요시 **SymPy**로 기약 분수 연산.
5) **부호 해석 오해**: det의 **부호는 방향**, 독립성과는 무관.

---

## 11. 미니 실습 과제

- **과제 A (정방)**: 무작위 \(A\in\mathbb{R}^{4\times4}\) 생성, 두 번째 열을 첫 번째의 선형결합으로 바꾸고 \(\det/랭크\) 비교.
- **과제 B (직사각형)**: \(A\in\mathbb{R}^{5\times3}\)에서 \(G=A^\top A\)의 eigenvalue로 독립성 확인(모두 \(>0\)?)
- **과제 C (회귀)**: 다중공선성 데이터 \(X=[x,\;2x+\epsilon]\)에서 \(\det(X^\top X)\)와 조건수 변화를 \(\epsilon\to 0\)로 관찰.

---

## 12. 치트시트

- **정방 \(A\)**:
  \[
  \det(A)\neq 0 \iff \mathrm{rank}(A)=n \iff A^{-1}\ \text{존재} \iff
  \{\mathbf{v}_j\}\ \text{독립}.
  \]
- **직사각 \(A\)**:
  \[
  \det(A^\top A)>0 \iff \text{열 독립}.
  \]
- **수치판정**: det 대신 **SVD/랭크/조건수**를 우선 고려.
