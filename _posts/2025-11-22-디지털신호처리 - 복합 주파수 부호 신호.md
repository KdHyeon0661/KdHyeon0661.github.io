---
layout: post
title: 디지털신호처리 - 복합 주파수 부호 신호
date: 2025-11-22 21:25:23 +0900
category: 디지털신호처리
---
# 복합 주파수 부호 신호(Composite Frequency-Coded Signals)

여기서 “복합 주파수 부호 신호”는 보통 다음을 뜻한다.

- 하나의 파형이 **여러 주파수 성분(여러 사인/코사인 성분)**의 **합으로 구성**된 신호
- 즉, **단일 주파수(순수 정현파) 신호가 아닌, 다중 주파수 성분을 ‘부호(코딩)’처럼 포함하는 신호**
- 시간 영역에서는 **파형 1개**로 보이지만, 주파수 영역에서는 **스펙트럼(주파수 성분들의 집합)**으로 보이는 신호

이 관점은 **포리에(Fourier) 분석**이 제공한다. 복합 신호는 곧 **“주파수 성분들의 조합”**이고,
그 조합을 이해하는 것이 **대역폭, 왜곡, 샘플링률, 필터 설계, 통신 채널 모델링**의 출발점이다.

---

## 예비사항: 단일 주파수 vs 복합 주파수 신호

### 단일 주파수(순수 정현파)

가장 단순한 신호는

$$
x(t)=A\cos(2\pi f_0 t+\phi)
$$

- 주파수 성분이 **딱 하나** \(f_0\)
- 스펙트럼은 **한 줄(선 스펙트럼)**로 나타남
- LTI 필터를 통과시키면 크기·위상만 바뀌지 **형태는 유지**

### 복합 주파수 신호

반면 대부분의 실제 신호는 다음처럼 여러 주파수 성분을 갖는다.

$$
x(t)=\sum_{k=1}^{K} A_k\cos(2\pi f_k t+\phi_k)
$$

- 주파수 성분이 **여러 개**
- 스펙트럼이 **여러 줄/연속 구간**을 차지
- **채널이 일부 주파수만 통과**시키면 시간 파형이 변형됨
- 따라서 **“파형이 어떤 주파수 성분을 얼마나 포함하느냐”**가 핵심이다.

---

## 포리에 시리즈/변환: 복합 신호를 주파수 성분으로 “부호화”하기

복합 주파수 신호를 이해하는 1번 도구는 **포리에 시리즈/변환**이다.

### 주기 신호 → 포리에 시리즈(이산 주파수 성분)

주기 \(T_0\)를 갖는 신호 \(x(t)\)는

$$
x(t)=a_0+\sum_{n=1}^{\infty}
\Big(a_n\cos(n\omega_0 t)+b_n\sin(n\omega_0 t)\Big),
\qquad \omega_0=\frac{2\pi}{T_0}
$$

- **기본 주파수** \(f_0=\omega_0/2\pi\)
- 그 정수배인 **고조파(harmonics)**들이 합쳐져 원래 파형을 만든다.
- 즉 주기 신호는 **“기본 + 고조파들의 복합 주파수 부호 신호”**다.

### 비주기 신호 → 포리에 변환(연속 주파수 성분)

비주기 신호는 연속 스펙트럼으로

$$
X(f)=\int_{-\infty}^{\infty}x(t)e^{-j2\pi ft}\,dt,
\qquad
x(t)=\int_{-\infty}^{\infty}X(f)e^{j2\pi ft}\,df
$$

- 비주기 신호는 **무한히 많은 주파수 성분**이 필요할 수 있다.
- 특히 **디지털 펄스열(사각 펄스)** 같은 신호는 **이론적으로 무한 대역폭**을 요구한다.

---

## 스펙트럼과 대역폭: 복합 주파수 성분의 “범위”가 곧 대역폭

### 스펙트럼(spectrum)

- **선 스펙트럼(line spectrum)**: 주기적 복합 신호
- **연속 스펙트럼(continuous spectrum)**: 비주기적 복합 신호

스펙트럼은 “이 신호가 어떤 주파수를 포함하는가”의 지도이다.

### 대역폭(bandwidth)의 정의

가장 기본 정의:

$$
B=f_{\max}-f_{\min}
$$

하지만 실제 설계에서는 다음이 자주 쓰인다.

1. **Null-to-Null BW**: 스펙트럼의 첫 영점(0) 사이 폭
2. **3-dB BW(half-power BW)**: 최대치의 절반(−3 dB)까지 포함되는 폭
3. **Effective BW**: 에너지의 대부분(예: 90~99%)이 들어있는 폭

디지털 펄스 스펙트럼은 **sinc 형태**라서 **널-투-널 대역폭**이 중요한 기준이 된다.

---

## 복합 주파수 신호의 고전 예: 사각파의 고조파 합성

사각파는 단순해 보이지만 **무한 고조파를 포함하는 복합 신호**의 전형이다.

### 이상적 사각파(주기 신호)

정규화된 사각파는 포리에 시리즈로

$$
x(t)=\frac{4}{\pi}\sum_{m=1,3,5,\dots}^{\infty}\frac{1}{m}\sin(m\omega_0 t)
$$

- **홀수 고조파만** 포함
- 고조파 수를 제한하면 **모양이 흐려짐(기브스 현상 포함)**

### GNU Octave 실험: 고조파 개수에 따른 사각파 근사

```octave
clear; close all; clc

fs = 20000;          % 샘플링 주파수
T0 = 0.01;           % 기본 주기 10ms -> f0=100Hz
t  = 0:1/fs:3*T0;    % 3주기만 보기
f0 = 1/T0; w0 = 2*pi*f0;

harm_set = [1 3 5 11 51];   % 포함할 홀수 고조파 최대 차수
figure;

for i=1:length(harm_set)
  Mmax = harm_set(i);
  x = zeros(size(t));

  for m=1:2:Mmax     % 홀수만
    x += (4/pi)*(1/m)*sin(m*w0*t);
  end

  subplot(length(harm_set),1,i)
  plot(t*1000, x, "linewidth", 1.2);
  grid on
  title(sprintf("Square wave approx with odd harmonics up to m=%d", Mmax));
  xlabel("time (ms)"); ylabel("amplitude");
end
```

#### 관찰 포인트

- m=1(기본파 하나) → 단순 사인
- m=3,5,… 늘릴수록 모서리가 서서히 날카로워짐
- m가 커질수록 **고주파 성분이 더 필요**함을 뜻한다.
- 즉 사각파는 “복합 주파수 부호 신호”이며, 그 **부호(성분)**의 개수가 곧 대역폭이다.

---

## 복합 신호가 채널을 지나며 왜곡되는 이유

### 채널/필터는 주파수별로 이득이 다르다

LTI 시스템의 출력은 주파수 영역에서

$$
Y(f)=H(f)X(f)
$$

- 각 주파수 성분은 **H(f)에 의해 서로 다르게 크기/위상이 변한다**
- 그래서 **복합 신호는 통과 후 파형이 바뀔 수 있다**

### “고조파 일부만 통과”하면 시간 파형이 변형된다

- 사각파의 고주파 고조파를 잘라내면 → 모서리가 둥글어짐
- 펄스열에서 고주파를 제거하면 → 펄스가 퍼져 **ISI**가 발생

이게 바로 **대역 제한 채널에서의 왜곡(distortion)**이다.

### GNU Octave 실험: 저역통과 필터 통과 전/후 왜곡

사각파를 저역통과 필터로 통과시키며 왜곡을 보자.

```octave
clear; close all; clc; pkg load signal

fs = 20000;
T0 = 0.01; f0 = 1/T0; w0 = 2*pi*f0;
t  = 0:1/fs:5*T0;

% 사각파 근사 (고조파 51개)
x = zeros(size(t));
for m=1:2:51
  x += (4/pi)*(1/m)*sin(m*w0*t);
end

% 1) 통과대역이 넓은 LPF
fc1 = 2000;   % 컷오프 2kHz
b1  = fir1(200, fc1/(fs/2));  % FIR LPF
y1  = filter(b1, 1, x);

% 2) 통과대역이 좁은 LPF
fc2 = 300;    % 컷오프 300Hz
b2  = fir1(200, fc2/(fs/2));
y2  = filter(b2, 1, x);

figure;
subplot(3,1,1); plot(t*1000, x);  grid on; title("input square (harmonics up to 51)");
subplot(3,1,2); plot(t*1000, y1); grid on; title("after LPF fc=2kHz (mild distortion)");
subplot(3,1,3); plot(t*1000, y2); grid on; title("after LPF fc=300Hz (severe rounding)");
xlabel("time (ms)");
```

#### 결과 해석

- fc=2kHz: 고조파 일부는 살아남아 **원형 유지가 꽤 됨**
- fc=300Hz: 고조파 대부분 제거 → **거의 사인처럼 변형**
- 즉 **복합 주파수 성분의 손실 = 파형 왜곡**이다.

---

## 디지털 신호는 왜 “무한 대역의 복합 신호”인가?

### NRZ 펄스열의 스펙트럼

예를 들어 NRZ 직사각 펄스(폭 \(T_b\))는

$$
X(f)\propto T_b\,\mathrm{sinc}(fT_b)
$$

- \(\mathrm{sinc}(u)=\frac{\sin(\pi u)}{\pi u}\)
- 영점이 \(f=\pm\frac{1}{T_b},\pm\frac{2}{T_b},\dots\)
- **이론적으로 끝까지 0이 되지 않으므로 무한 대역**

즉 **디지털 파형은 비주기 복합 주파수 부호 신호이며**,
완벽히 전달하려면 무한 대역이 필요하다. 실제 채널은 유한 대역이므로 **부분 성분 손실 → ISI**가 생긴다.

### GNU Octave 실험: 펄스열 스펙트럼과 대역 제한

```octave
clear; close all; clc

fs = 200000;              % 높은 샘플링
Rb = 1000; Tb = 1/Rb;     % 비트율 1kbps
Ns = round(fs*Tb);        % 비트당 샘플 수
Nbits = 100;
bits = randi([0 1], 1, Nbits)*2 - 1; % ±1

% NRZ waveform 생성
x = kron(bits, ones(1, Ns));   % 각 비트를 Ns샘플로 확장
t = (0:length(x)-1)/fs;

% 스펙트럼(FFT)
Nfft = 2^nextpow2(length(x));
X = fft(x, Nfft);
f = (0:Nfft-1)*(fs/Nfft);
Xmag = abs(X)/length(x);

% 대역 제한(간단 ideal LPF 구현)
fc = 3000;  % 3kHz lowpass
H = double(f < fc | f > fs-fc);   % 이상적 대칭 LPF
Y = X .* H;
y = real(ifft(Y));

figure;
subplot(2,1,1);
plot(f(1:Nfft/2), 20*log10(Xmag(1:Nfft/2)+1e-12));
grid on; title("NRZ spectrum magnitude"); xlabel("Hz"); ylabel("dB");

subplot(2,1,2);
plot(t(1:8*Ns), x(1:8*Ns), "linewidth",1); hold on;
plot(t(1:8*Ns), y(1:8*Ns), "linewidth",1);
grid on; title("time waveform before/after bandwidth limit");
legend("original NRZ", "after LPF");
```

#### 관찰

- 스펙트럼은 sinc 꼴로 **멀리까지 퍼져 있음**
- 3kHz로 자르면
  - 펄스 모서리가 퍼지고
  - 인접 비트에 침범 → **ISI**
- 즉 **“복합 주파수 성분의 상실이 곧 통신 오류의 근본”**이다.

---

## 복합 주파수 부호 신호와 나이퀴스트/샤논 관점

### 나이퀴스트 대역 제한과 ISI 조건

**대역 \(B\)**로 제한된 채널에서
ISI 없이 전송 가능한 최대 심볼율은(이상적)

$$
R_s \le 2B
$$

- 이는 **복합 스펙트럼의 겹침을 피하는 조건**이다.
- 대역이 좁을수록 고주파 성분이 더 잘려 파형이 퍼지므로 심볼을 빨리 보낼수록 겹친다.

### 샤논 용량과 “복합 신호의 성분 분배”

용량

$$
C = B\log_2(1+\mathrm{SNR})
$$

- 유한 대역 내에서 **주파수 성분을 어떻게 배치/코딩하느냐**가 용량에 직결
- OFDM이나 다중 반송파 계열은 사실상 **주파수 성분을 병렬로 배치하는 복합 부호 신호 설계**다. (개념적 연결)

---

## 복합 주파수 신호를 다룰 때의 실무적 의미

### 신호 설계 관점

- 원하는 시간 파형을 얻으려면
  → **어떤 주파수 성분이 필요하고**
  → **대역폭이 얼마나 필요한지**부터 역으로 설계해야 한다.

예) 오디오의 트랜지언트(급격한 변화)는 고주파 성분이 많아야 자연스럽다.
대역이 부족하면 소리가 “먹먹/둔감”해진다.

### 필터 설계 관점

- FIR/IIR은 스펙트럼을 조작하는 도구
- “복합 성분 중 원하는 대역만 통과/억제”가 필터의 목적

### 샘플링률/양자화 관점

- 샘플링은 “복합 주파수 성분을 이산화”하는 과정
- 양자화는 “성분의 크기 표현을 제한”하는 과정
- 고주파 성분이 많을수록
  - 샘플링률 요구가 증가
  - 양자화 잡음/반올림 영향이 더 민감해질 수 있다.

---

## 추가 심화 예제: 여러 사인 성분의 합으로 “임의 파형” 만들기

복합 주파수 신호가 직관적으로 잘 느껴지는 실험이다.

### 여러 톤 합성 → 파형 변화

```octave
clear; close all; clc

fs=5000; t=0:1/fs:1;
fset = [50, 120, 300, 600];   % 성분 주파수들
Aset = [1.0, 0.6, 0.4, 0.2];  % 성분 크기
ph   = [0, pi/4, pi/2, -pi/3];

x = zeros(size(t));
for k=1:length(fset)
  x += Aset(k)*cos(2*pi*fset(k)*t + ph(k));
end

% FFT
Nfft=8192; X=fft(x,Nfft); f=(0:Nfft-1)*fs/Nfft;

figure;
subplot(2,1,1);
plot(t, x); grid on;
title("Composite signal in time domain");
xlabel("time (s)"); ylabel("amplitude");

subplot(2,1,2);
stem(f(1:Nfft/2), abs(X(1:Nfft/2))/length(x), ".");
grid on;
title("Line spectrum (sum of tones)");
xlabel("Hz"); ylabel("|X(f)|");
```

#### 해석

- 시간 영역 파형은 복잡하지만
- 주파수 영역에서는 **“주파수 4개를 부호로 가진 합성 신호”**로 완전히 정리된다.

---

## 연습문제(예제)와 풀이 아이디어

### 문제 1. 사각파 근사의 대역폭 추정

기본 주파수 \(f_0=100\text{ Hz}\) 사각파를 홀수 고조파 \(m=1,3,\dots,51\)까지 합성했다.
이때 **포함된 최고 주파수 성분**과 **대략적인 null-to-null 대역폭**을 구하라.

**풀이 스케치**
- 최대 고조파 \(m_{\max}=51\)
- 최고 성분 주파수

$$
f_{\max}=m_{\max}f_0 = 51\times 100=5100\text{ Hz}
$$

- 사각파는 선 스펙트럼이므로 “대역폭”을 엄밀히 정의하기 어렵지만
  실무적으로는 **포함된 최고 고조파까지**를 유효 대역으로 본다.
  따라서 대략 \(0\sim 5.1\text{ kHz}\) 유효 대역폭.

---

### 문제 2. NRZ 스펙트럼 첫 영점 위치

비트율 \(R_b=2\text{ kbps}\)인 NRZ 펄스열의 스펙트럼 첫 영점(null) 주파수를 구하라.

**풀이**
- \(T_b=1/R_b=0.5\text{ ms}\)
- NRZ의 첫 영점은 \(f=1/T_b\)

$$
f_{null,1}=\frac{1}{T_b}=R_b=2000\text{ Hz}
$$

즉 null-to-null BW는 대략 \(2R_b=4\text{ kHz}\).

---

### 문제 3. 대역 제한에 따른 ISI 확인 실험

문제2의 NRZ를
(1) \(B=4\text{ kHz}\) 채널
(2) \(B=1\text{ kHz}\) 채널
로 보냈을 때, GNU Octave로 시간 파형을 비교하고 ISI 여부를 판단하라.

**풀이 아이디어 코드(핵심 부분만)**

```octave
% 위 5.2 코드에서 fc만 바꿔 비교
fc1 = 4000;  % 거의 첫 null까지 통과
fc2 = 1000;  % null보다 훨씬 좁음
% H 만들고 ifft한 뒤 time waveform 비교
```

- fc1에서는 모서리 퍼짐이 작고 ISI가 약함
- fc2에서는 펄스가 심하게 퍼져 비트가 겹침 → ISI 확실

---

### 문제 4. 고조파 제거가 파형에 미치는 영향

사각파 근사에 대해
(1) 고조파 51개
(2) 고조파 11개
(3) 고조파 3개
를 사용한 파형을 그리고, 동일한 저역통과 필터(fc=500Hz)를 통과시킨 뒤
출력 파형의 차이를 설명하라.

**풀이 아이디어**
- 입력에서 고조파가 적을수록 필터 영향이 작다.
- 고조파가 많을수록 필터가 더 많은 성분을 잘라 왜곡이 커진다.
- “필터 왜곡”은 사실 “복합 성분 손실”의 표현이다.

---

## 전체 요약

1. **복합 주파수 부호 신호**는
   - 여러 사인/코사인(주파수 성분)의 합으로 구성된 신호이며
   - 포리에 분석으로 그 “성분 부호”를 드러낼 수 있다.

2. 주기 신호는
   - 기본파 + 고조파들의 복합 신호(선 스펙트럼)로 표현되고,
   - 고조파가 많을수록 시간 파형이 날카로워지며 대역폭이 증가한다.

3. 비주기 디지털 펄스열은
   - sinc형 연속 스펙트럼을 가지며 이론적으로 무한 대역을 요구한다.
   - 실제 채널의 유한 대역 때문에 성분이 잘려 **ISI/왜곡**이 생긴다.

4. 따라서
   - 대역폭은 “복합 주파수 성분이 차지하는 범위”이며
   - 필터/채널 설계는 “성분을 어떻게 남기고 억제할 것인가”의 문제다.
