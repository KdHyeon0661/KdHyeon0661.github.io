---
layout: post
title: 미적분 - 선적분
date: 2025-08-17 21:20:23 +0900
category: 미적분
---
# 선적분(Line Integral)

1) **스칼라장에 대한 선적분**: 곡선 위 선밀도·온도 등을 길이요소와 함께 적분(질량/열량/총량).
2) **벡터장에 대한 선적분(일·순환)**: 힘장과 이동의 내적 적분, 회전·순환(∮)과의 연결.
3) **보존장(Conservative Field)**과 **선적분의 기본정리**: 경로독립성, 퍼텐셜, 적분값 = 끝점값 차.
4) **Green 정리/정리의 문턱**: 평면에서 ∮Pdx+Qdy ↔ ∬(∂Q/∂x−∂P/∂y) dA.

---

## 표기와 기본 아이디어

- 매끄러운(조각 매끄러운) 곡선 \(C\) 를 매개화:
  $$
  \mathbf{r}(t) = \langle x(t),\,y(t),\,z(t)\rangle,\qquad a\le t\le b,
  $$
  속도 \( \mathbf{r}'(t)\), 길이요소 \( ds = \|\mathbf{r}'(t)\|\,dt\).

- 스칼라장 \( f:\mathbb{R}^n\to\mathbb{R} \) 의 선적분(“선밀도 적분”):
  $$
  \int_C f\,ds = \int_a^b f(\mathbf{r}(t))\,\|\mathbf{r}'(t)\|\,dt.
  $$

- 벡터장 \( \mathbf{F}:\mathbb{R}^n\to\mathbb{R}^n \) 의 선적분(“일/순환”):
  $$
  \int_C \mathbf{F}\cdot d\mathbf{r} = \int_a^b \mathbf{F}(\mathbf{r}(t))\cdot\mathbf{r}'(t)\,dt.
  $$

**성질**
- 매개변수 재표현(단조 증가 재매개)에는 **불변**.
- 경로 \(C\) 가 같으면 선적분은 동일 (시작·끝, 방향이 결과에 영향).
- **방향을 바꾸면 부호가 바뀐다**: \(\int_{-C} = -\int_C\).

---

## 스칼라장에 대한 선적분: \(\displaystyle \int_C f\,ds\)

### 정의와 해석

- 물리적으로는 **선밀도 \(\rho(\mathbf{x})\)** 를 길이 요소와 적분해 **총 질량**을 구하는 것:
  $$
  M = \int_C \rho\,ds.
  $$
- 동일하게 **온도/오염도** 등의 합계(총량)로 해석 가능.

### 계산법(평면/공간 동일)

매개화 \( \mathbf{r}(t)=\langle x(t),y(t),z(t)\rangle \) 이면
$$
\int_C f\,ds
=\int_a^b f(x(t),y(t),z(t))\,\sqrt{(x')^2+(y')^2+(z')^2}\,dt.
$$

### 예제 A — 원호의 선밀도 적분

곡선 \( C: x=R\cos t,\ y=R\sin t,\ 0\le t\le \theta_0 \), 선밀도 \( \rho(x,y)=\rho_0(1+\alpha r^2) \) (단 \( r^2=x^2+y^2\)).

- 여기서는 \(r=R\) 이므로 \( \rho=\rho_0(1+\alpha R^2) \) 상수.
- \(ds=\|\mathbf{r}'(t)\|dt = \sqrt{(-R\sin t)^2+(R\cos t)^2}\,dt = R\,dt\).
- 총 질량:
  $$
  M=\int_0^{\theta_0} \rho_0(1+\alpha R^2)\,R\,dt
   = \rho_0(1+\alpha R^2)\,R\,\theta_0.
  $$

### 예제 B — 비균질 엘리프스

곡선 \( C: x=a\cos t,\ y=b\sin t,\ 0\le t\le 2\pi \). 선밀도 \( \rho(x,y)=x^2+y^2 \).
- \( \rho=a^2\cos^2 t + b^2\sin^2 t\).
- \( ds=\sqrt{(-a\sin t)^2+(b\cos t)^2}\,dt = \sqrt{a^2\sin^2 t+b^2\cos^2 t}\,dt \).
- 질량:
  $$
  M=\int_0^{2\pi} (a^2\cos^2 t + b^2\sin^2 t)\,\sqrt{a^2\sin^2 t+b^2\cos^2 t}\,dt.
  $$
폐쇄형 원시는 어렵다. 수치적분으로 평가하거나 특별한 관계가 있을 때만 닫힌식이 나온다(예: 원 \(a=b\)).

---

## 벡터장에 대한 선적분: \(\displaystyle \int_C \mathbf{F}\cdot d\mathbf{r}\)

### 정의와 해석

- **일(work)**: 힘장 \( \mathbf{F} \) 가 경로 \( C \) 를 따라 물체를 이동시킬 때 한 **일**:
  $$
  W = \int_C \mathbf{F}\cdot d\mathbf{r}
    = \int_a^b \mathbf{F}(\mathbf{r}(t))\cdot\mathbf{r}'(t)\,dt.
  $$
- 평면장 \( \mathbf{F}=\langle P,Q\rangle \) 이면
  $$
  \int_C \mathbf{F}\cdot d\mathbf{r} = \int_C P\,dx + Q\,dy.
  $$

### 예제 C — 원에서의 순환(회전계 벡터장)

평면장 \( \mathbf{F}(x,y)=\langle -y,\ x\rangle \).
단위원 \( C: x=\cos t,\ y=\sin t,\ 0\le t\le 2\pi \) 에서
- \( \mathbf{F}(\mathbf{r}(t))=\langle -\sin t,\ \cos t\rangle \),
- \( \mathbf{r}'(t)=\langle -\sin t,\ \cos t\rangle \),
- 내적은 \( 1 \),
- 결과:
  $$
  \int_C \mathbf{F}\cdot d\mathbf{r}=\int_0^{2\pi} 1\,dt=2\pi.
  $$
이는 **양의 방향(반시계)** 순환의 크기가 \(2\pi\) 임을 보여준다(회전 대칭).

### 예제 D — 경로에 의존하는 경우

벡터장 \( \mathbf{F}(x,y)=\langle -y/(x^2+y^2),\ x/(x^2+y^2)\rangle \) (원점 제외).
단위원 \(C\) 를 반시계로 한 바퀴:
- 극좌표 \( x=\cos t,\ y=\sin t\Rightarrow x^2+y^2=1 \),
- \( \mathbf{F}=\langle -\sin t,\ \cos t\rangle \), \( \mathbf{r}'=\langle -\sin t,\ \cos t\rangle \),
- 결과는 \(2\pi\) (앞 예제와 동일).
하지만 **원점을 감싸지 않는 경로**에서는 적분값이 0이 될 수 있다.
이 장은 원점에서 **보존적이지 않음**(단일연결이 아니고 원점이 특이점).

---

## 보존장과 선적분의 기본정리

### 보존장(Conservative Field)

평면에서 \( \mathbf{F}=\langle P,Q\rangle \) 가 **어떤 스칼라 퍼텐셜** \( \phi \) 의 그라디언트이면,
$$
\mathbf{F}=\nabla \phi = \left\langle \frac{\partial \phi}{\partial x},\ \frac{\partial \phi}{\partial y} \right\rangle,
$$
이를 **보존장**이라 부른다.

**충분조건(평탄/단일연결 영역에서)**
- \(P,Q\) 가 연속 미분 가능하고 \( \dfrac{\partial P}{\partial y} = \dfrac{\partial Q}{\partial x}\) 이면 보존장.

### 선적분의 기본정리(Fundamental Theorem for Line Integrals)

\(\mathbf{F}=\nabla \phi\) 이고 \(C\) 가 \(A\to B\) 를 잇는 경로라면
$$
\int_C \mathbf{F}\cdot d\mathbf{r} = \phi(B)-\phi(A).
$$
**경로독립성**: 시작/끝점만 같으면 적분값 동일, 경로와 무관.

### 예제 E — 보존장 판별과 퍼텐셜 찾기

\( \mathbf{F}(x,y)=\langle 2xy+y^3,\ x^2+3xy^2\rangle \).

- 교차 미분:
  \(\partial P/\partial y = 2x+3y^2\), \(\partial Q/\partial x=2x+3y^2\) 동일 → **보존장**.
- 퍼텐셜 \( \phi \) 찾기: \( \phi_x = 2xy+y^3\) 를 적분:
  \(\phi = x^2y + xy^3 + g(y)\).
- \( \phi_y = x^2 + 3xy^2 + g'(y)\) 가 \( Q=x^2+3xy^2\) 와 같아야 → \( g'(y)=0 \Rightarrow g=\text{const}\).
- 따라서 \( \phi(x,y)=x^2y+xy^3\) (상수 무시).

임의의 경로로 \(A\to B\) 이동 시
$$
\int_C \mathbf{F}\cdot d\mathbf{r} = \phi(B)-\phi(A).
$$

### 예제 F — 경로독립성 활용

점 \(A=(0,0)\), \(B=(1,1)\). 위 \(\mathbf{F}\) 에 대해
$$
\phi(B)-\phi(A) = (1^2\cdot 1 + 1\cdot 1^3) - 0 = 2.
$$
직선 경로든 곡선 경로든 결과는 2.

---

## 과 Green 정리(미리보기)

- 벡터장 \(\mathbf{F}=\langle P,Q\rangle\) 의 선적분:
  $$
  \int_C P\,dx + Q\,dy.
  $$
- **폐곡선** \(C=\partial D\) 가 **양의 방향(반시계)** 으로 둘러싼 영역 \(D\) 에 대해 **Green 정리**:
  $$
  \oint_C P\,dx+Q\,dy = \iint_D \left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA.
  $$
이를 통해 **영역 적분**으로 바꾸어 계산할 수 있다(다음 글: 그린의 정리 상세).

### 예제 G — 그린 정리로 빠르게 계산

\(\mathbf{F}=\langle -y, x\rangle\), \(C\) 는 단위원(반시계).
- \(\partial Q/\partial x - \partial P/\partial y = 1 - (-1) = 2\).
- 면적 \(\pi\).
- 오른쪽은 \( \iint_D 2\,dA = 2\pi\).
- 결과: \( \oint_C \mathbf{F}\cdot d\mathbf{r} = 2\pi \), 앞서의 직접계산과 일치.

---

## 곡선의 방향, 부분곡선, 조각-매끄러움

- \(C=C_1\cup C_2\) (끝점 연속). 선적분은 **가법적**:
  $$
  \int_C = \int_{C_1} + \int_{C_2}.
  $$
- **방향 반전**: \(\int_{-C} = -\int_C\).
- 조각-매끄러운(각 구간마다 매끄러운) 곡선이면 구간별 적분을 합한다.

---

## 3차원에서의 선적분

- 동일정의: \(\displaystyle \int_C \mathbf{F}\cdot d\mathbf{r}\) (공간곡선).
- **자기장/자속선**, **유체속도장과 경로작업** 등 공학 응용에서 빈번.

### 예제 H — 나선 경로에서의 일

\( C: \mathbf{r}(t)=\langle R\cos t, R\sin t, \alpha t\rangle,\ 0\le t\le T\).
힘장 \( \mathbf{F}=\langle -y,\ x,\ \beta\rangle \).

- \( \mathbf{F}(\mathbf{r}) = \langle -R\sin t,\ R\cos t,\ \beta\rangle \),
- \( \mathbf{r}'(t)=\langle -R\sin t,\ R\cos t,\ \alpha\rangle \),
- 내적: \( R^2(\sin^2 t+\cos^2 t) + \alpha\beta = R^2+\alpha\beta \),
- 적분: \( \int_0^{T} (R^2+\alpha\beta)\,dt = (R^2+\alpha\beta)T \).

---

## 좌표계/특수 경로: 극좌표·파라메트릭

### 극좌표에서 \( \int_C Pdx+Qdy \)

일반적으로 \(x,y\) 의 함수로 계산하되, 경로가 원/부채꼴이면 **자연 매개화**로 단순화.

### 원호 \(\theta=\theta_1\to\theta_2\)

\(C: x=R\cos\theta,\ y=R\sin\theta\).
\(dx=-R\sin\theta\,d\theta,\ dy=R\cos\theta\,d\theta\).
\(\int_C Pdx+Qdy\) 는
$$
\int_{\theta_1}^{\theta_2} \big[-P(R\cos\theta,R\sin\theta)R\sin\theta+Q(R\cos\theta,R\sin\theta)R\cos\theta\big]\,d\theta.
$$
회전대칭 벡터장에서는 대폭 단순화.

---

## 수치 적분(파이썬): 스칼라/벡터 선적분

**전략**
1) 경로를 \(N\)개 분할, \(t_k=a+k\Delta t\).
2) 스칼라: \(\displaystyle \int_C f\,ds\approx \sum f(\mathbf{r}(t_k))\,\|\mathbf{r}'(t_k)\|\Delta t\).
3) 벡터: \(\displaystyle \int_C \mathbf{F}\cdot d\mathbf{r}\approx \sum \mathbf{F}(\mathbf{r}(t_k))\cdot \mathbf{r}'(t_k)\,\Delta t\).
4) 단순/Simpson 등 수치적분 사용.

```python
import numpy as np

def line_integral_scalar(r, rp, f, a, b, n=20000):
    """
    ∫_C f ds ≈ ∑ f(r(tk)) * ||r'(tk)|| Δt
    r  : callable(t) -> (x,y) or (x,y,z)
    rp : callable(t) -> (dx/dt, dy/dt, [dz/dt])
    f  : callable(x, y, [z]) -> scalar
    """
    ts = np.linspace(a, b, n+1)
    dt = (b - a) / n
    vals = []
    for t in ts:
        vec = np.array(rp(t))
        speed = np.linalg.norm(vec)
        pos = r(t)
        vals.append(f(*pos) * speed)
    # Trapezoidal
    vals = np.array(vals)
    return dt * (0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

def line_integral_vector(r, rp, F, a, b, n=20000):
    """
    ∫_C F · dr ≈ ∑ F(r(tk)) · r'(tk) Δt
    """
    ts = np.linspace(a, b, n+1)
    dt = (b - a) / n
    vals = []
    for t in ts:
        pos = np.array(r(t))
        vec = np.array(rp(t))
        vals.append(np.dot(F(*pos), vec))
    vals = np.array(vals)
    return dt * (0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

# -> ∮ F·dr = 2π

r  = lambda t: (np.cos(t), np.sin(t))
rp = lambda t: (-np.sin(t), np.cos(t))
F  = lambda x, y: (-y, x)

approx = line_integral_vector(r, rp, F, 0.0, 2*np.pi, n=20000)
print("∮ F·dr ≈", approx)  # ≈ 2π

# 스칼라 예제: ρ(x,y)=x^2+y^2, 엘립스 x=a cos t, y=b sin t

a, b = 2.0, 1.0
r2  = lambda t: (a*np.cos(t), b*np.sin(t))
rp2 = lambda t: (-a*np.sin(t),  b*np.cos(t))
rho = lambda x, y: x*x + y*y

M_approx = line_integral_scalar(r2, rp2, rho, 0.0, 2*np.pi, n=40000)
print("∮ ρ ds (ellipse) ≈", M_approx)
```

**주의**
- 특이점/급격한 변화가 있으면 구간을 세분하거나 **적응적 적분** 사용.
- 폐곡선에서 파라미터의 주기성(시작/끝값)이 정확히 맞도록 설정.

---

## 선적분과 경로의 기하: 길이, 곡률과의 연결

- **곡선 길이**: \( L=\int_C 1\,ds \).
- **스칼라 선적분**은 곡선 길이를 가중치로 평균을 구하는 도구가 된다:
  $$
  \overline{f}_C = \frac{1}{L}\int_C f\,ds.
  $$
- **곡률/프레네 프레임**과 결합해 **곡선 에너지** \(\int_C \kappa^2 ds\) 같은 변분문제로 확장 가능(심화 주제).

---

## 보존성 판별과 경로독립성 — 실전 체크리스트

1) \(P,Q\) 가 충분히 매끄럽고 영역이 단일연결이라면
   \(\partial P/\partial y=\partial Q/\partial x\) → 보존장 후보.
2) 퍼텐셜 \(\phi\) 를 구성해 본다(적분법 + 일관성 점검).
3) \(\int_C \mathbf{F}\cdot d\mathbf{r}=\phi(B)-\phi(A)\) 로 즉시 계산.
4) 폐곡선 \(\oint_C \mathbf{F}\cdot d\mathbf{r}=0\) (보존장 필수조건).
5) 특이점/구멍(비단일연결) 존재 시 **경로의 감김수**에 따라 결과가 달라질 수 있음(예: \(\langle -y/r^2,\ x/r^2\rangle\)).

---

## 다양한 예제

### 예제 J — 직선 경로에서의 일 (간단 검산)

\( C\): \( (0,0)\to(1,2) \) 직선, \( \mathbf{r}(t)=(t,2t),\ 0\le t\le 1\).
\( \mathbf{F}=\langle 2x+y,\ x-3y\rangle \).
- \(\mathbf{F}(\mathbf{r})=\langle 2t+2t,\ t-6t\rangle=\langle 4t, -5t\rangle\),
- \(\mathbf{r}'=(1,2)\),
- \( \mathbf{F}\cdot \mathbf{r}' = 4t\cdot 1 + (-5t)\cdot 2 = 4t - 10t = -6t\),
- 적분: \( \int_0^1 -6t\,dt = -3\).

### 예제 K — 경로에 따라 달라지는 벡터장

\( \mathbf{F}=\langle -y,x\rangle \).
경로1: \(C_1\): \((1,0)\to(0,1)\) 직선 \( \mathbf{r}(t)=(1-t,t)\).
경로2: \(C_2\): 원호 \(x=\cos t,y=\sin t,\ 0\le t\le \pi/2\).

- \(C_1\): \(\mathbf{F}(\mathbf{r})=\langle -t,1-t\rangle\), \(\mathbf{r}'=(-1,1)\).
  \( \mathbf{F}\cdot\mathbf{r}' = (-t)(-1) + (1-t)(1) = t + 1 - t = 1 \),
  적분 \( \int_0^1 1\,dt = 1\).

- \(C_2\): 앞선 방식대로 계산하면
  \( \mathbf{F}=\langle -\sin t,\ \cos t\rangle,\ \mathbf{r}'=\langle -\sin t,\ \cos t\rangle\) → 내적=1,
  적분 \( \int_0^{\pi/2} 1\,dt = \pi/2 \).
  **경로에 따라 결과가 다름**(비보존장).

### 예제 L — 스칼라장 평균값(곡선 평균)

곡선 \(C\): \(x=t,\ y=t^2,\ 0\le t\le 1\), \( f(x,y)=x \).
- \( ds=\sqrt{(dx/dt)^2+(dy/dt)^2}\,dt=\sqrt{1+(2t)^2}\,dt\).
- \(\int_C f\,ds = \int_0^1 t\sqrt{1+4t^2}\,dt\).
  치환 \(u=1+4t^2\Rightarrow du=8t\,dt\):
  \( = \tfrac{1}{8}\int_{u=1}^{5}\sqrt{u}\,du = \tfrac{1}{8}\cdot \tfrac{2}{3} (u^{3/2})\big|_1^5 = \tfrac{1}{12}(5^{3/2}-1).\)
- 길이 \(L=\int_0^1 \sqrt{1+4t^2}\,dt\) (표준 적분, 닫힌식은 \(\mathrm{arsinh}\)).
  평균 \( \overline{f}_C = \dfrac{\int_C f\,ds}{L}\).

---

## 선적분과 미적분학의 정리들: 연결 지도

- **선적분의 기본정리**: \(\mathbf{F}=\nabla\phi\Rightarrow \int_C \mathbf{F}\cdot d\mathbf{r}=\phi(B)-\phi(A)\).
- **Green 정리**(2D 경계↔면적): \(\displaystyle \oint_{\partial D}P\,dx+Q\,dy = \iint_D(\partial Q/\partial x-\partial P/\partial y)\,dA\).
- **Stokes 정리**(3D 경계곡선↔곡면): \(\displaystyle \oint_{\partial S}\mathbf{F}\cdot d\mathbf{r}=\iint_S (\nabla\times\mathbf{F})\cdot\mathbf{n}\,dS\).
- **발산 정리**(체적 경계↔체적 내부): \(\displaystyle \iint_{\partial E}\mathbf{F}\cdot\mathbf{n}\,dS=\iiint_E \nabla\cdot\mathbf{F}\,dV\).

선적분은 이들 정리의 “경계측” 객체로 반복 등장한다.

---

## 자주 하는 실수/주의 포인트

- □ \(ds\) 를 **\(\|\mathbf{r}'(t)\|dt\)** 로 정확히 쓰지 않아 생기는 오류.
- □ 벡터장 선적분에서 내적의 **부호/방향** 실수(경로 방향 반전 시 부호 반전).
- □ 보존장 판정에서 영역의 **단일연결성**을 간과(특이점이 있으면 \(\oint\) 가 0이 아닐 수 있음).
- □ 폐곡선 기호 \(\oint\) 사용 누락/방향(양의 방향=반시계)을 반대로 지정.
- □ 수치적분 시 분할수 부족/특이점 근접부의 오차 폭주.

---

## 연습문제(정답 스케치)

1) \( C\): \(x=3\cos t,\ y=4\sin t,\ 0\le t\le 2\pi\).
   \( \rho(x,y)=\sqrt{x^2+y^2} \). \(\int_C \rho\,ds\) 를 수치로 추정하라.
   - \(r=\sqrt{9\cos^2 t+16\sin^2 t}\), \(ds=\sqrt{9\sin^2 t+16\cos^2 t}\,dt\).
   - 코드로 적분.

2) \(\mathbf{F}=\langle 2xy,\ x^2\rangle\), \(C\): \((0,0)\to(1,1)\) 의 두 경로
   (a) 직선 \(y=x\) (b) 포물선 \(y=x^2\). 각각 \(\int_C \mathbf{F}\cdot d\mathbf{r}\) 을 계산하고 비교.
   - 보존장 여부 확인: \(\partial P/\partial y=2x,\ \partial Q/\partial x=2x\) → 보존장.
   - 퍼텐셜 \(\phi=x^2 y\). 값은 경로무관: \(\phi(1,1)-\phi(0,0)=1\).

3) \(\mathbf{F}=\langle -y/(x^2+y^2),\,x/(x^2+y^2)\rangle\), \(C\) 는 반지름 \(R\) 의 원을 \(n\)번 감는다.
   \(\oint_C \mathbf{F}\cdot d\mathbf{r}\) 계산.
   - 결과는 \(2\pi n\) (감김수).

4) \(C\): \(x=t,\ y=t^3,\ 0\le t\le 1\), \(f(x,y)=x^2+y\). \(\int_C f\,ds\) 계산.
   - \(ds=\sqrt{1+9t^4}\,dt\), 적분은 수치적으로.

5) \(\mathbf{F}=\nabla (x^3y+xy^3)\), \(A=(1,0)\), \(B=(0,1)\).
   \(\int_C \mathbf{F}\cdot d\mathbf{r}\) 을 임의 경로로 계산하지 말고 기본정리로 끝내라.
   - \(\phi(B)-\phi(A) = (0+0) - (1^3\cdot 0 + 1\cdot 0^3) = 0\).

---

## 결론

- **스칼라 선적분**은 곡선상의 **총량**(질량/열량/오염도)을,
- **벡터 선적분**은 경로상의 **일·순환**을 표현한다.
- 보존장에서는 **경로독립**, 기본정리 활용로 즉시 계산 가능.
- 평면에서는 **Green 정리**, 3차원에서는 **Stokes 정리**가 선적분과 면적분/곡면적분을 연결한다.
- 실무에서는 수치적분/적응적 분할/특이점 처리(경계 재매개 포함)를 잘 활용하라.

---

## 부록: 간단한 SymPy 검증 스니펫

```python
import sympy as sp

t = sp.symbols('t', real=True)
x, y = sp.Function('x')(t), sp.Function('y')(t)

# 예제 C: F = (-y, x), C: unit circle (0..2π)

tt = sp.symbols('tt', real=True)
xC = sp.cos(tt)
yC = sp.sin(tt)
dx = sp.diff(xC, tt)
dy = sp.diff(yC, tt)

P = -yC
Q = xC
integrand = P*dx + Q*dy
res = sp.integrate(integrand, (tt, 0, 2*sp.pi))
print("∮ (-y)dx + x dy on unit circle:", sp.simplify(res))  # 2π

# 보존장 예제 E: F = <2xy + y^3, x^2 + 3xy^2>

x, y = sp.symbols('x y', real=True)
P = 2*x*y + y**3
Q = x**2 + 3*x*y**2
# curl-like test (2D): Q_x - P_y

cond = sp.diff(Q, x) - sp.diff(P, y)
print("Q_x - P_y =", sp.simplify(cond))  # 0 -> conservative
phi = sp.integrate(P, (x))  # integrate P wrt x
phi = sp.simplify(phi)
# ensure phi_y == Q

phi_y = sp.diff(phi, y)
print("phi =", phi)
print("phi_y - Q =", sp.simplify(phi_y - Q))  # should be 0 up to const
```
