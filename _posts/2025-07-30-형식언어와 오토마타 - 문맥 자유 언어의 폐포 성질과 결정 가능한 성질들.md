---
layout: post
title: 형식언어와 오토마타 - 문맥 자유 언어의 폐포 성질과 결정 가능한 성질들
date: 2025-07-30 16:20:23 +0900
category: 형식언어와 오토마타
---
# 문맥 자유 언어(CFL)의 **폐포 성질**과 **결정 알고리즘**

이 글은 문맥 자유 언어(Context-Free Languages, **CFL**)의 **폐포 성질(closure properties)** 과 **결정 가능한(Decidable) 성질들**을 체계적으로 정리한다.

---

## 1) 준비: 용어와 표기
- \( \Sigma \) : 입력 알파벳, \( \Sigma^* \) : 모든 문자열 집합  
- CFG \(G=(V,\Sigma,R,S)\) : 변수(비단말) \(V\), 터미널 \(\Sigma\), 생성규칙 \(R\), 시작기호 \(S\)  
- PDA(푸시다운 오토마타), DCFL(결정적 CFL) 등은 필요 시 언급

---

## 2) **폐포 성질** — 무엇에 닫혀 있고, 무엇에는 닫혀 있지 않은가

### 2.1 닫혀 있는 연산들 (Closure: **Yes**)

1. **합집합** \(L_1 \cup L_2\)  
   CFG 두 개 \(G_1,G_2\)에 대해 새 시작기호 \(S\)에서 \(S\to S_1 \mid S_2\) 추가하여 구성.

2. **접합(연접)** \(L_1 L_2 = \{xy\mid x\in L_1, y\in L_2\}\)  
   \(S\to S_1 S_2\) 규칙 추가.

3. **Kleene 스타** \(L^*\)  
   \(S\to SS \mid \varepsilon \mid S_0\) 와 같이 반복을 허용(정석적으로는 새로운 시작기호로 안전하게 구성).

4. **역순(리버설)** \(L^R=\{w^R\mid w\in L\}\)  
   각 규칙 오른쪽 문자열을 뒤집으면 된다(유도 트리 대칭).

5. **호모모르피즘** \(h(L)\) (문자 대치·삭제 포함)  
   문자를 문자열로 치환하는 규칙을 문법에 합성.

6. **역(逆) 호모모르피즘** \(h^{-1}(L)\)  
   \(w\in h^{-1}(L) \iff h(w)\in L\). PDA/CFG에 \(h\)를 “앞단”으로 붙이면 구성 가능.

7. **정규언어와의 교집합** \(L_{\text{CFL}} \cap R_{\text{REG}}\)  
   **Yes**. PDA와 DFA의 데카르트 곱(제품)으로 PDA를 얻는다 → 여전히 CFL.

8. **정규언어와의 몫(Quotient)**  
   우몫 \(L/R=\{x\mid \exists y\in R: xy\in L\}\), 좌몫 \(R\backslash L=\{y\mid \exists x\in R: xy\in L\}\) 모두 **Yes** (정규와의 몫은 교차/비결정 추적으로 처리 가능).

9. **Prefix/Suffix/Factor(부분문자열) 집합**  
   \( \mathrm{Pref}(L)=L/\Sigma^*,\ \mathrm{Suff}(L)=\Sigma^*\backslash L,\ \mathrm{Substr}(L)=\Sigma^*\backslash L/\Sigma^* \)  
   정규(\(\Sigma^*\))와의 몫 조합이므로 **Yes**.

10. **대치(Substitution)**  
    각 문자 \(a\in\Sigma\)를 **CFL \(L_a\)** 로 치환하는 치환 \(s\)에 대해, \(s(L)\)은 **CFL**.

> 요약: **정규와의 상호작용(교집합·몫)**, **문자 치환(호모/역호모/대치)**, **연접·스타·합집합·역순**에는 닫혀 있다.

---

### 2.2 닫혀 있지 않은 연산들 (Closure: **No**)

1. **교집합** \(L_1 \cap L_2\) (둘 다 CFL) — 일반적으로 **No**  
   고전 반례: \(L_1=\{a^i b^i c^j\},\ L_2=\{a^i b^j c^j\}\) (둘 다 CFL) → 교집합은 \(\{a^n b^n c^n\}\) (비CFL)

2. **여집합/차집합**(보수, 차) — 일반적으로 **No**  
   여집합에 닫혀 있지 않으므로 차집합도 닫혀 있지 않다.  
   (단, **DCFL**은 보수에 **Yes**.)

3. **Shuffle(섞기)** — 일반적으로 **No**

4. **상호 몫(CFL과의 몫)** — 일반적으로 **No** (정규와의 몫만 Yes)

> 팁: **정규**가 끼면 대개 잘 된다(교집합/몫/필터링). **CFL끼리**의 교집합/보수/차는 조심.

---

## 3) **결정 알고리즘** — 어떤 성질들이 결정 가능한가?

### 3.1 멤버십(소속성) 결정: \(w \stackrel{?}{\in} L(G)\) — **Decidable**

- **CNF 변환 + CYK 알고리즘**: \(O(n^3)\) (문자열 길이 \(n\), 문법 크기 의존 상수 있음)
- **Earley 파싱**: 최악 \(O(n^3)\), 많은 경우 평균적으로 더 빠르다.

**CYK(요약 의사코드)** — \(G\)를 촘스키 정규형(CNF)이라 가정:
```text
Input: CNF G, string w = a1...an
P[i][j] = set of variables generating substring w[i..j]
for i=1..n:
  P[i][i] = { A | A -> ai in G }
for len=2..n:
  for i=1..n-len+1:
    j = i+len-1
    P[i][j] = ∪_{k=i..j-1} { A | A -> B C, B∈P[i][k], C∈P[k+1][j] }
return S ∈ P[1][n]
```

---

### 3.2 공백성(Emptiness): \(L(G)=\varnothing\) ? — **Decidable**

- **생성 가능 변수(terminating/generating)** 를 마킹:  
  (i) 터미널만으로 유도 가능한 변수부터 표시,  
  (ii) 표시된 변수들로만 우변이 구성되는 규칙의 좌변도 반복적으로 표시.  
- 시작기호 \(S\)가 **생성 가능**이 아니면 \(L(G)=\varnothing\).

---

### 3.3 유한성(Finiteness): \(L(G)\)가 유한? — **Decidable**

- (1) 위와 같이 **생성 가능** 변수만 남기고, (2) **도달 가능** 변수만 남긴 뒤,  
- (3) 남은 규칙 그래프에서 **터미널을 생성하는 루프**(사이클)를 탐지.  
  루프가 있으면 무한; 없으면 유한.

---

### 3.4 정규와의 교차 공백성: \(L(G)\cap R=\varnothing\) ? — **Decidable**

- PDA(또는 CFG)와 DFA의 **제품 구성**으로 PDA를 얻음 → **Emptiness** 알고리즘으로 판정.

---

### 3.5 동치/포함/보편성/모호성 — **일반적으로 Undecidable**

- **포함** \(L(G_1)\subseteq L(G_2)\) — **Undecidable**  
- **동치성** \(L(G_1)=L(G_2)\) — **Undecidable**  
- **보편성** \(L(G)=\Sigma^*\) — **Undecidable**  
- **교집합 공백성(두 CFL 사이)** — **Undecidable**  
- **모호성(Grammar ambiguity)** — **Undecidable**  
- **정규성 판정**(주어진 CFG가 정규 언어인가?) — **Undecidable**

> 단, **결정적 CFL(DCFL)** 에서는 **보수(Complement)** 가 가능하고, **동치성(=언어 동일성)** 은 매우 어려우나 이론적으로는 **결정 가능**(Sénizergues 정리; 실용적 복잡도는 극도로 큼). 일반 CFL에는 적용되지 않는다.

---

## 4) 구성/증명 스케치 (대표 몇 가지)

### 4.1 \( \text{CFL} \cap \text{REG} \) 에 닫혀 있음
- PDA \(M\)과 DFA \(A\)가 있을 때, \((q_M,\gamma,q_A)\) 식의 **제품 상태**로 PDA’를 만들고,  
  입력 심볼을 읽을 때마다 둘 다 동시에 전이. 최종상태/스택 수용 조건을 결합하면 끝.

### 4.2 호모모르피즘/역호모모르피즘
- **호모모르피즘**: CFG의 각 터미널 \(a\)를 \(h(a)\)로 치환하여 규칙들을 일괄 대체.  
- **역호모모르피즘**: \(w\in h^{-1}(L) \iff h(w)\in L\). PDA/CFG의 **입력 전처리기**로 \(h\)를 흉내 내면 된다.

### 4.3 Prefix/Suffix/Factor
- Prefix: \( \mathrm{Pref}(L)=L/\Sigma^*\) (우몫), Suffix: \(\Sigma^*\backslash L\) (좌몫), Factor: 양쪽 몫의 조합.  
  정규와의 몫은 **CFL에 닫힘**을 이용.

---

## 5) 실무/학습 팁

- **정규 필터링**을 활용하라: 복잡한 CFL 문제를 **정규 제약(DFA/정규식)** 으로 필터링한 뒤 다루면, 교집합/공백성 같은 결정을 할 수 있다.
- **CNF + CYK**는 기본기: 소속성/파싱을 위한 표준. Earley/GLR는 실제 문법(특히 모호한 문법)에서 유용.
- **폐포로 증명하기**: 문제 언어를 합/연접/호모모르피즘/정규교집합 등으로 구성하여 **CFL임을 보이거나**(구성), **비CFL 반례를 구성**(교집합/보수 비폐쇄)하는 테크닉이 실전에서 자주 쓰인다.
- **Undecidable 회피**: 포함/동치/모호성은 일반적으로 불가능하므로, **제약을 정규/Deterministic/특수형**으로 제한하거나 **근사적 검사**를 고려한다.

---

## 6) 요약 표

### 6.1 폐포 성질
| 연산 | CFL 닫힘? | 메모 |
|---|---|---|
| 합집합 \(\cup\) | Yes | 문법 병합 \(S\to S_1\mid S_2\) |
| 연접 \( \cdot \) | Yes | \(S\to S_1 S_2\) |
| 스타 \( ^* \) | Yes | 반복 규칙 |
| 역순 \( ^R \) | Yes | 규칙 뒤집기 |
| 호모모르피즘 \(h\) | Yes | 문자 치환 |
| 역호모모르피즘 \(h^{-1}\) | Yes | 전처리 |
| 대치(Substitution) | Yes | 각 문자→CFL |
| 정규와의 교집합 | Yes | PDA×DFA |
| 정규와의 몫(좌/우) | Yes | 교차/비결정 추적 |
| Prefix/Suffix/Factor | Yes | 정규와의 몫 조합 |
| **CFL과의 교집합** | **No** | 고전 반례 존재 |
| 보수/차집합 | No | DCFL은 보수 Yes |
| Shuffle | No |  |

### 6.2 결정 가능 성질
| 성질 | CFL | 비고 |
|---|---|---|
| 멤버십 \(w\in L\) | **Decidable** | CYK/Earley |
| 공백성 \(L=\varnothing\) | **Decidable** | 생성/도달 마킹 |
| 유한성 | **Decidable** | 생성 루프 탐지 |
| \(L \cap R = \varnothing\) (정규 \(R\)) | **Decidable** | PDA×DFA → emptiness |
| 포함/동치/보편성/모호성 | **Undecidable** | 일반 CFL |
| 정규성 판정 | **Undecidable** |  |
| (참고) DCFL 보수 | **Decidable** | DCFL은 보수에 닫힘 |
| (참고) DCFL 동치성 | **Decidable** | 이론적으로 가능(매우 어려움) |

---

## 7) 마무리

- **정규와의 상호작용**은 CFL을 다루는 핵심 도구(교집합/몫/필터링).  
- **CYK/Earley** 등 파싱 알고리즘은 멤버십·구문 해석의 실무 표준.  
- **포함/동치/모호성** 같은 전역 성질은 일반적으로 **불가능**하므로,  
  문제를 **정규 또는 결정적 제약**으로 변형하거나 **부분 문제**로 쪼개서 접근하는 것이 실용적이다.