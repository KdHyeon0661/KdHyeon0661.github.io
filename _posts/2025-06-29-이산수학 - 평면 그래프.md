---
layout: post
title: 이산수학 - 평면 그래프
date: 2025-06-29 22:20:23 +0900
category: 이산수학
---
# 평면 그래프 (Planar Graph)

## 0. 한눈 개요

- **평면 그래프**: 간선이 **교차 없이** 평면에 그려질 수 있는 그래프.
- **핵심 도구**: 오일러 공식, 간선 상한( $$E\le 3V-6$$ 등), Kuratowski/Wagner 정리(비평면성의 특성화), **평면 임베딩**(rotation system), **이중 그래프(dual)**, **색칠 정리**(4색/5색/6색), **분리자 정리**, **계산적 판별 알고리즘**(Boyer–Myrvold, Hopcroft–Tarjan).
- **응용**: VLSI 배선, 지도·도로 네트워크, 회로·배관 배치, 그래프 시각화/플래너라이제이션, 알고리즘 가속(분리자·SPQR·플래너 SSSP/MST).

---

## 1. 정의와 용어

### 1.1 평면 그래프와 평면 삽도
- **정의**: 그래프 $$G=(V,E)$$가 **간선 교차 없이** 평면에 그려질 수 있으면 **평면 그래프(planar)**.
- **평면 삽도(plane drawing)**: 교차 없이 그려진 **구체적 배치**.
- **면(face)**: 삽도에서 간선들이 둘러싸는 영역(외부 면 포함).
- **평면 그래프 vs 평면 삽도**: 그래프가 평면이라는 성질 자체 vs 그 성질을 만족시키는 **특정 그림**.

### 1.2 그래프 임베딩(embedding)과 회전 체계(rotation system)
- 각 정점에서 **부착된 간선들의 원형 순서**(시계·반시계)를 지정한 것이 **회전 체계**.
- 평면 임베딩은 각 정점의 회전 체계가 일관되게 주어지고, 그에 따라 **면 순회**가 가능.

---

## 2. 오일러 다면체 공식과 즉시 결과

### 2.1 오일러 공식
- **연결된 평면 그래프**의 임베딩에서
$$
V - E + F = 2.
$$
- 여기서 $$V$$: 정점 수, $$E$$: 간선 수, $$F$$: 면(face) 수(외부 면 포함).

**스케치 증명 아이디어**
- 트리의 경우 $$E=V-1, F=1$$ ⇒ $$V-E+F=2$$.
- 사이클을 하나 추가하면 $$E\to E{+}1, F\to F{+}1$$로 좌변이 보존. 임의의 연결 평면 그래프는 트리에 사이클을 더해 구성 가능.

### 2.2 간선 상한(삼각면 존재 가정)
- **단순** 평면 그래프(다중간선·루프 없음), $$V\ge 3$$, 모든 면의 길이(경계)가 **최소 3**이므로
  - 면 경계 길이의 합 = $$\sum \text{face length} = 2E$$ (각 간선은 두 면에 한 번씩 기여)
  - 따라서 $$3F \le 2E \Rightarrow F \le \frac{2E}{3}$$.
  - 오일러 공식 대입:
    $$
    V - E + F = 2 \Rightarrow V - E + \frac{2E}{3} \ge 2 \Rightarrow E \le 3V - 6.
    $$
- **평균 차수** $$\bar{d} = \frac{2E}{V} < 6$$ ⇒ **평면 그래프는 5-퇴화(5-degenerate)**, 그리디로 **6색** 가능.

### 2.3 girth(최소 사이클 길이) 기반 일반 상한
- girth가 $$g\ge 3$$인 단순 평면 그래프에 대해
$$
E \le \frac{g}{g-2}(V-2).
$$
- 예:
  - $$g=3$$ ⇒ $$E\le 3V-6$$(삼각분할 상한)
  - $$g=4$$(사각 이상) ⇒ $$E\le 2V-4$$ → **평면 이분 그래프**에 적용(홀수 사이클 없음 ⇒ girth ≥ 4).

### 2.4 특수 부류 상한
- **이분 평면 그래프**: $$E \le 2V - 4$$ (단, $$V\ge 3$$).
- **외평면(outerplanar)**: 모든 정점을 외부 면 경계 위에 둘 수 있는 그래프. 상한 $$E \le 2V - 3$$.

---

## 3. 비평면성의 특성화: Kuratowski·Wagner

### 3.1 Kuratowski 정리
- 그래프가 평면이 **아니면**, 그래프 안에 **$$K_5$$ 또는 $$K_{3,3}$$의 subdivision(변형)**이 존재.
  - subdivision: 간선 중간에 **차수 2** 정점 삽입해 **길이를 늘린** 형태.

### 3.2 Wagner 정리(마이너 관점)
- 그래프는 평면 ⇔ **$$K_5$$ 또는 $$K_{3,3}$$를 minor(마이너)**로 포함하지 않음.
- minor: **간선 삭제/수축**으로 얻을 수 있는 그래프.

> 실무 관점: 비평면성 판정 시 **“어디가 문제인지”**를 알려주는 **금지 패턴(증거)**가 바로 이 두 그래프(또는 그 파생).

---

## 4. 평면 임베딩과 이중 그래프(dual)

### 4.1 이중 그래프 $$G^\*$$
- 면마다 정점 하나씩, 면을 맞대는(경계 간선을 공유) 두 면 사이에 간선.
- **성질**: (2-연결 이상에서) $$(G^\*)^\* \cong G$$, 오일러 공식은 **쌍대적으로 대칭**.
- **브리지(다리) 간선**은 이중에서 **자기 루프**가 됨.

### 4.2 절단·순환의 쌍대성
- 평면 그래프에서 **최소 컷** ↔ **이중 그래프의 최소 사이클** 등 **흔한 쌍대 대응**.
- 응용: **최소 컷/최단 사이클**(이중에서 SSSP/사이클 탐색), **전기회로**(망 분석), **도형 분할**.

---

## 5. 평면 그래프의 색칠

- **6색 정리**: 평균차수 < 6 ⇒ 6색 그리디 가능(간단).
- **5색 정리**: 비교적 짧은 증명으로 가능.
- **4색 정리**: 모든 평면 그래프는 4색으로 충분(컴퓨터 보조 증명, 1976).

> 실용: **지도**, **주파수/채널 배치**, **시험 시간표** 등 conflict-free 할당 문제로 귀결.

---

## 6. 기하적 삽도 결과

- **Fáry 정리**: 모든 **단순 평면 그래프**는 **직선 세그먼트만**으로도 평면에 그릴 수 있음(직선 삽도).
- **Tutte의 barycentric 임베딩**: 3-연결 평면 그래프는 외부 얼굴을 고정하고 나머지 정점을 **평균 위치**로 잡으면 교차 없는 직선 삽도 확보.

---

## 7. 구조·알고리즘: 분리자, SPQR, 플래너 SSSP 등

- **Lipton–Tarjan 분리자 정리**: 평면 그래프는 $$O(\sqrt{V})$$ 크기의 정점을 제거하여 두 부분으로 쪼갤 수 있음(각각 최대 $$\frac{2}{3}V$$). → 분할정복 기반 알고리즘 가속.
- **SPQR 트리**: 2-연결 그래프의 triconnected 분해. 임베딩 공간 탐색/유일성/동형성, 동적 플래너 유지 등에 핵심.
- **평면 그래프 최단 경로/최소 컷/최대 유량**: 특수 자료구조·분리자·쌍대성으로 **근선형/선형 시간**에 가까운 전용 알고리즘 존재(이론/라이브러리 의존).

---

## 8. 특수 부류: 외평면·시리즈-패럴렐·삼각분할

- **외평면(outerplanar)**: 모든 정점이 외부 면 경계. 금지 마이너: $$K_4, K_{2,3}$$. 색칠수 ≤ 3.
- **시리즈-패럴렐**: $$K_4$$ 마이너 없음. 회로·네트워크 모델에 빈번.
- **삼각분할(최대 평면 그래프)**: 모든 면이 삼각형, $$E=3V-6$$ 달성. 휠 그래프 등.

---

## 9. 평면성 판정 알고리즘

- **Hopcroft–Tarjan(1974)**: 선형 시간.
- **Boyer–Myrvold(2004)**: 선형 시간, 구현 친화적, 많이 쓰임.
- **실무**: Python에선 `networkx.algorithms.planarity.check_planarity(G, True)`가 Boyer–Myrvold 기반으로 **임베딩과 함께** 반환.

**아이디어(매우 요약)**: DFS 트리 + back-edge로 **유도된 순환 구조**를 관리하며, **임베딩 가능성**을 증명적으로 구성/실패 시 금지 패턴 추출.

---

## 10. 수작업 예제: 평면/비평면 판별 & 오일러 공식 검증

### 10.1 삼각형 그래프 $$K_3$$
- $$V=3, E=3$$. 삽도에서 면 $$F=2$$(내부·외부).
- $$3-3+2=2$$ ✅

### 10.2 사각형+대각선(한 개)
- 정사각형 대각선 하나 → 면이 삼각 2개 + 외부 1개 = $$F=3$$.
- $$V=4, E=5$$ ⇒ $$4-5+3=2$$ ✅

### 10.3 완전 그래프 $$K_5$$ 비평면
- $$V=5, E=10$$. 만약 평면이라 가정하고 오일러 상한 적용:
  $$E\le 3V-6 = 9$$에 위배(10>9). ⇒ **비평면**.

### 10.4 완전 이분 $$K_{3,3}$$ 비평면
- $$V=6, E=9$$. 이 그래프는 **이분**(홀수 사이클 없음) ⇒ $$E\le 2V-4=8$$ 위배(9>8). ⇒ **비평면**.

---

## 11. 코드 예제 (Python)

> 아래 코드는 **교육용**입니다. `networkx` 사용 예시는 **실행 환경**에 따라 설치가 필요합니다.

### 11.1 간단한 유틸: 오일러 항 검증과 간선 상한 체크

```python
def euler_characteristic(V, E, F):
    """연결 평면 삽도에서 V - E + F 값을 계산."""
    return V - E + F  # 평면 연결 그래프면 2여야 함

def planar_edge_upper_bound(V, bipartite=False):
    """단순 평면 그래프 간선 상한 추정치."""
    if V < 3:
        # 작은 그래프는 개별 고려
        return None
    if bipartite:
        return 2*V - 4  # girth >=4 가정
    else:
        return 3*V - 6

def violates_planar_bound(V, E, bipartite=False):
    bound = planar_edge_upper_bound(V, bipartite=bipartite)
    return (bound is not None) and (E > bound)
```

**사용 예시**

```python
print(violates_planar_bound(5, 10, bipartite=False))  # K5: True (비평면)
print(violates_planar_bound(6, 9, bipartite=True))    # K3,3: True (비평면)
```

### 11.2 `networkx`로 평면성 판정 + 임베딩·면 나열

```python
# pip install networkx
import networkx as nx
from networkx.algorithms import planarity

def check_planarity_and_faces(edges, directed=False):
    G = nx.DiGraph() if directed else nx.Graph()
    G.add_edges_from(edges)
    is_planar, embedding = planarity.check_planarity(G, True)
    if not is_planar:
        return False, None, None
    # 면 추출(외부 면 포함)
    faces = list(embedding.faces())
    return True, embedding, faces

# 예시 1: 평면 그래프 (사각형+대각선 하나)
edges1 = [(0,1),(1,2),(2,3),(3,0),(0,2)]
ok1, emb1, faces1 = check_planarity_and_faces(edges1)
print(ok1, faces1)

# 예시 2: 비평면 K5
edges2 = [(i,j) for i in range(5) for j in range(i+1,5)]
ok2, emb2, faces2 = check_planarity_and_faces(edges2)
print(ok2)  # False
```

> `embedding.faces()`는 각 면의 **경계 정점 순환**을 반환(라이브러리 버전에 따라 API가 다를 수 있음).

### 11.3 외평면 테스트(간단 휴리스틱)
- 완전한 판정은 별도 알고리즘이 필요하지만, **상한** 및 **금지 마이너 힌트**로 빠른 필터 가능.

```python
def quick_outerplanar_filter(V, E):
    # 외평면 상한: E <= 2V - 3 (V>=2)
    if V >= 2 and E > 2*V - 3:
        return False  # 확실히 외평면 아님
    return True  # '가능성'만 의미

print(quick_outerplanar_filter(6, 10))  # 2*6-3=9 → 10>9 ⇒ 외평면 X
```

---

## 12. 실전 시나리오

### 12.1 VLSI/PCB 배선 레이아웃
- **목표**: 신호선 간 **교차 최소화**(이상적으로 0). **층(layer)** 수를 줄이고 배선 길이 최소화.
- **판정**: 회로망 그래프가 **평면**이면 **단일층**에서도 교차 없이 설계 가능.
- **전략**:
  1) `check_planarity`로 평면성 판단.
  2) 비평면이면 **최소 교차 수**(crossing number) 최적화는 어렵지만, **계층 추가**/**재배치**/**버스 그룹화**/**SPQR 분해** 등으로 **플래너라이제이션** 시도.
- **주의**: 실제 물리 설계는 **기하 제약**(폭·간격·비아 비용) 포함 → 단순 그래프 평면성만으로 충분치 않음.

### 12.2 지도·도로 네트워크 레이아웃
- 도시 도로망은 대체로 **거의 평면**(교차로·교량 제외). 평면 가정하에 라우팅/시각화 알고리즘이 **가볍게** 동작.
- **이중 그래프 활용**: 면=구역을 정점으로 보고, **경계 공유 관계**를 간선으로 모델링 → **구역 경계 최단 사이클**, **컷** 문제를 쌍대에서 다룸.

### 12.3 충돌 없는 채널/시간표 배정(평면 그래프 색칠)
- 지도색칠 ↔ 평면 그래프 **정점 색칠**.
- 실무에서는 4색까지 줄이는 대신, **6색 그리디**(빠름·안정)로 충분한 경우가 많음(평균차수 < 6).

---

## 13. 자주 하는 실수·함정

1) **오일러 상한만으로 평면성 결론**:
   - $$E \le 3V-6$$ 만족해도 **항상 평면**은 아님(충분조건 아님). 꼭 **임베딩** 혹은 **금지 패턴** 확인.

2) **다중간선/루프 포함 시**:
   - 상한식·증명에 **단순성(간선 중복/루프 없음)** 가정이 숨어 있음. 해당 조건을 점검.

3) **이분 평면 상한 혼동**:
   - 이분 평면 그래프에서만 $$E \le 2V-4$$. 일반 평면 그래프는 $$3V-6$$.

4) **외평면 vs 평면**:
   - 외평면은 더 강한 제약. 상한과 금지 마이너( $$K_4, K_{2,3}$$ )가 다름.

5) **면 개수 계산**:
   - **연결 그래프** 가정. 비연결이면 성수식 $$\sum (V_i - E_i + F_i) = 1 + C$$ 형태(컴포넌트 수 $$C$$ 반영)로 바뀜.
   - 일반식: 모든 컴포넌트 합쳐 **$$V - E + F = 1 + C$$**.

---

## 14. 심화: 플래너 그래프의 더 많은 사실

- **Whitney 유일성 정리**: 3-연결 평면 그래프의 임베딩은 **구면 위에서 유일**(면 교환을 제외하면 본질적 동일).
- **Tutte 다항식**과 평면 쌍대: 평면 그래프의 Tutte 다항식은 쌍대에서 변수 교환으로 관련.
- **스패닝 트리와 쌍대 코트리**: 평면 그래프에서 스패닝 트리의 여집합 간선은 이중에서 스패닝 트리를 이룸.
- **분리자 기반 알고리즘**: SSSP, max-flow, 동형성 등에서 **서브쿼드릭~선형**에 가까운 이론적 결과들.

---

## 15. 연습 문제(스스로 풀어보기)

1) $$V=8$$, $$E=15$$, 단순 연결 그래프가 평면일 수 있는가?
   - 힌트: $$E\le 3V-6=18$$ ⇒ 상한만으로는 배제 못 함. 임베딩 시도 or 판별 알고리즘 필요.

2) 이분·연결·단순 그래프( $$V=10$$ )에서 평면이면 $$E$$의 최대는?
   - 답: $$2V-4=16$$.

3) 외평면·연결·단순 그래프( $$V=7$$ )의 최대 간선 수는?
   - 답: $$2V-3=11$$.

4) $$K_{2,4}$$는 평면인가?
   - 이분 평면 상한으로 가능성 체크( $$V=6, E=8 \le 8$$ ). 실제로 평면임(임베딩 가능).

5) 주어진 무향 그래프 입력에서 `networkx`로 평면성 판정 후 **면 리스트**를 얻어보라.

---

## 16. 요약 표

| 주제 | 핵심 정리/식 |
|---|---|
| 오일러 | $$V - E + F = 2\ (\text{연결})$$ |
| 간선 상한 | 일반: $$E \le 3V-6$$, 이분: $$E \le 2V-4$$, 외평면: $$E \le 2V-3$$ |
| 금지 패턴 | Kuratowski: subdivision of $$K_5$$ or $$K_{3,3}$$ |
| 쌍대 | 면↔정점, 컷↔사이클 |
| 색칠 | 6색(그리디), 5색(짧은 증명), 4색(컴퓨터 증명) |
| 임베딩 | Fáry(직선 삽도), Tutte(바리센터) |
| 분리자 | $$O(\sqrt{V})$$ 크기 분리자 존재 |

---

## 17. 마무리

평면 그래프는 **구조적 제약**이 강한 만큼,
- **증명 도구**(오일러 공식·금지 패턴),
- **알고리즘 가속 장치**(분리자, SPQR, 전용 SSSP/Flow),
- **시각화·설계 실무**(VLSI/지도/레이아웃)
에서 **강력한 레버리지**를 제공합니다.
