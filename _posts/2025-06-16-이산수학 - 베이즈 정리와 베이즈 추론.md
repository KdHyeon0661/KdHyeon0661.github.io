---
layout: post
title: 이산수학 - 베이즈 정리와 베이즈 추론
date: 2025-06-16 21:20:23 +0900
category: 이산수학
---
# 🧠 베이즈 정리와 베이즈 추론: 원리와 실전 활용

## 📌 개요

**베이즈 정리(Bayes’ Theorem)**는 **사전 확률(prior)**과 **새로운 정보(likelihood)**를 이용해 **사후 확률(posterior)**을 계산하는 공식입니다.  
이는 단순한 확률 계산을 넘어, **베이즈 추론(Bayesian Inference)**이라는 강력한 통계적 사고 체계로 확장되며, 의학, 기계학습, 데이터 분석 등 다양한 분야에서 활용됩니다.

---

## 📐 1. 베이즈 정리(Bayes’ Theorem)

### ✅ 수식

\[
P(H \mid E) = \frac{P(E \mid H) \cdot P(H)}{P(E)}
\]

- \( H \): 가설 (Hypothesis)
- \( E \): 관찰된 증거 (Evidence)
- \( P(H) \): 사전 확률 (Prior)
- \( P(E \mid H) \): 가능도 (Likelihood)
- \( P(E) \): 정규화 상수 (Evidence의 전체 확률)

---

### 📌 의미 해석

> **"처음에 얼마나 가능성이 있었는가 (Prior)"** +  
> **"새로운 데이터가 주어졌을 때 얼마나 가능성이 있는가 (Likelihood)"**  
> → 이를 통해 **최종적으로 얼마나 믿을 수 있는가 (Posterior)**를 계산

---

## 🧪 2. 예제: 의학 검사 문제

> 어떤 질병의 유병률이 1%이며, 진단 테스트의 정확도는 다음과 같다:  
- 감염자가 양성일 확률 (민감도): 99%  
- 비감염자가 양성일 확률 (위양성률): 5%

양성 반응을 받은 사람이 실제 감염자일 확률은?

---

### 🎯 용어 정리

- \( H \): 감염자일 확률 = \( P(H) = 0.01 \)  
- \( \overline{H} \): 비감염자일 확률 = \( P(\overline{H}) = 0.99 \)  
- \( E \): 테스트 양성일 확률

---

### 📌 베이즈 적용

\[
P(H \mid E) = \frac{P(E \mid H) \cdot P(H)}{P(E)}
\]

- 분모:  
\[
P(E) = P(E \mid H) \cdot P(H) + P(E \mid \overline{H}) \cdot P(\overline{H})
= 0.99 \cdot 0.01 + 0.05 \cdot 0.99 = 0.0594
\]

- 계산:

\[
P(H \mid E) = \frac{0.99 \cdot 0.01}{0.0594} \approx 0.1667
\]

> ⚠️ **결론**: 양성 반응을 받아도 실제 감염자일 확률은 **16.67%**밖에 안 된다!

---

## 🧠 3. 베이즈 추론 (Bayesian Inference)

### ✅ 정의

**관찰 데이터를 기반으로 사전 확률을 갱신하여 사후 확률을 계산하는 과정**

\[
\text{Posterior} \propto \text{Likelihood} \times \text{Prior}
\]

- 사전 확률 \( P(\theta) \): 기존의 믿음, 도메인 지식  
- 가능도 \( P(D \mid \theta) \): 데이터를 얼마나 잘 설명하는가  
- 사후 확률 \( P(\theta \mid D) \): 관찰 이후의 새로운 확률

---

### 📊 예제: 코인의 공정성 추론

> 어떤 동전을 10번 던졌더니 7번 앞면이 나왔다. 이 동전이 공정할 확률은?

---

### 🎯 접근 방식

- 사전 확률: \( \theta \sim \text{Uniform}(0,1) \)  
- 가능도:  
\[
P(D \mid \theta) = \theta^7 \cdot (1 - \theta)^3
\]

- 사후 확률:  
\[
P(\theta \mid D) \propto \theta^7 (1 - \theta)^3
\]

→ 이 사후 확률은 **베타 분포 \( \text{Beta}(8,4) \)**로 표현됨

---

## 🤖 4. 실전 활용 사례

### 🧬 1. 의학 진단

- 질병 진단에서 **검사의 정확도와 유병률**을 함께 고려  
- COVID-19, 암 진단에서 **오진을 줄이는 기준**으로 활용됨

---

### 📊 2. 스팸 필터 (나이브 베이즈 분류기)

- 이메일 텍스트의 단어 출현을 바탕으로 스팸 여부 예측  
- 사후 확률을 기반으로 분류함

---

### 🤖 3. 머신러닝 하이퍼파라미터 튜닝

- 베이지안 최적화 (Bayesian Optimization):  
  하이퍼파라미터의 확률적 분포를 갱신하며 탐색

---

### 📈 4. A/B 테스트

- 실험군과 대조군 결과의 사후 확률을 비교  
- **신뢰도 있는 의사 결정**을 가능하게 함

---

## 🔍 5. 베이즈 vs 빈도주의

| 항목 | 베이즈 추론 | 빈도주의 추론 |
|------|--------------|----------------|
| 확률 의미 | 믿음의 정도 | 장기 빈도 |
| 사전 정보 | 사용함 | 사용하지 않음 |
| 데이터 처리 | 순차적 업데이트 가능 | 독립된 표본 필요 |
| 계산 방식 | 사후 분포 계산 | 통계적 검정 (p-value 등) |

---

## 🛠️ 6. Python 실습 예시

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import beta

# 관측: 앞면 7번, 뒷면 3번
a, b = 7 + 1, 3 + 1  # 베타 분포의 파라미터

x = np.linspace(0, 1, 100)
y = beta.pdf(x, a, b)

plt.plot(x, y)
plt.title("Posterior Distribution: Beta(8, 4)")
plt.xlabel("Coin Bias (θ)")
plt.ylabel("Probability Density")
plt.show()
```

---

## ✅ 요약 정리

| 개념 | 설명 |
|------|------|
| 베이즈 정리 | 사후 확률 계산의 기초 |
| 사전 확률 | 사전 지식 기반의 초기 확률 |
| 가능도 | 관찰 데이터가 주어졌을 때 가설의 설명력 |
| 사후 확률 | 데이터 관측 후 믿을만한 확률 |
| 베이즈 추론 | 확률 분포 갱신 기반 추론 프레임워크 |