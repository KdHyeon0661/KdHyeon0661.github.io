---
layout: post
title: AWS - IAM 정책 설계 가이드
date: 2025-08-03 19:20:23 +0900
category: AWS
---
# IAM 정책 설계 가이드: AWS 보안을 위한 권한 제어 전략

AWS의 **Identity and Access Management(IAM)**는 클라우드 리소스에 대한 *정교하고 세밀한 권한 제어*를 제공하는 핵심 서비스입니다. 이 글에서는 IAM 정책을 어떻게 안전하게, 그리고 효율적으로 설계할 수 있는지에 대해 자세히 다룹니다.

---

## 🔐 IAM 정책이란?

IAM 정책은 사용자가 AWS 리소스를 어떻게 사용할 수 있는지 정의하는 *JSON 기반의 문서*입니다. 하나의 정책은 하나 이상의 `Statement`로 구성되며, 각 statement는 *허용(Allow)* 또는 *거부(Deny)* 동작을 기술합니다.

### ✅ 기본 구조

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::example-bucket/*"
    }
  ]
}
```

- **Version**: 정책 언어 버전 (현재는 항상 `"2012-10-17"` 사용)
- **Effect**: `Allow` 또는 `Deny`
- **Action**: 수행할 수 있는 API 작업 (ex. `s3:PutObject`)
- **Resource**: 접근 대상 리소스 (ARN 형식)
- **Condition** (선택): 시간, IP, MFA 여부 등 조건 제약

---

## 🧠 정책 설계 전략

IAM 정책을 설계할 때 중요한 점은 **최소 권한 원칙 (Principle of Least Privilege)**을 지키는 것입니다. 즉, "해야 할 작업만, 그 리소스에만, 꼭 필요한 시점에만" 권한을 부여해야 합니다.

### 1. 리소스 수준의 제한

> 가능하면 `*` 대신 특정 ARN을 명시하세요.

**❌ 잘못된 예**
```json
"Resource": "*"
```

**✅ 좋은 예**
```json
"Resource": "arn:aws:s3:::my-bucket/*"
```

### 2. 명시적인 Deny 활용

> `Deny`는 `Allow`보다 우선합니다. 특정 조건에서 접근을 막고 싶을 때 사용합니다.

```json
{
  "Effect": "Deny",
  "Action": "s3:*",
  "Resource": "*",
  "Condition": {
    "BoolIfExists": {
      "aws:MultiFactorAuthPresent": "false"
    }
  }
}
```

: MFA 미사용 시 S3 접근 차단

### 3. Condition을 적극 활용

> `aws:SourceIp`, `aws:RequestedRegion`, `aws:PrincipalTag` 등을 활용해 세밀한 제어 가능

```json
"Condition": {
  "IpAddress": {
    "aws:SourceIp": "203.0.113.0/24"
  }
}
```

---

## 👥 정책 부착 위치

IAM 정책은 다양한 엔터티에 부착할 수 있습니다:

| 대상           | 설명                               |
|----------------|------------------------------------|
| 사용자 (User)  | 개별 사용자에게 직접 부여         |
| 그룹 (Group)   | 여러 사용자에게 공통 권한 부여     |
| 역할 (Role)    | AWS 서비스 또는 외부 사용자에게 권한 위임 |
| 리소스 기반    | S3, Lambda 등에서 직접 리소스에 부착 |

---

## 🛡️ 관리형 vs 인라인 정책

| 구분        | 설명 |
|-------------|------|
| 관리형 정책 | 여러 사용자/역할에 공유 가능 |
| 인라인 정책 | 특정 사용자/역할에만 종속됨 |

- **조직 전반의 일관성**을 원한다면 관리형 정책 사용
- **일시적인 테스트**나 예외적인 권한이라면 인라인 정책 사용

---

## 🔧 실전 예시

### 예제 1: 특정 사용자에게 S3 읽기만 허용

```json
{
  "Effect": "Allow",
  "Action": [
    "s3:GetObject"
  ],
  "Resource": "arn:aws:s3:::my-bucket/*"
}
```

### 예제 2: 특정 시간대에만 DynamoDB 쓰기 허용

```json
{
  "Effect": "Allow",
  "Action": [
    "dynamodb:PutItem",
    "dynamodb:UpdateItem"
  ],
  "Resource": "arn:aws:dynamodb:ap-northeast-2:123456789012:table/Orders",
  "Condition": {
    "DateGreaterThan": {
      "aws:CurrentTime": "2025-08-09T09:00:00Z"
    },
    "DateLessThan": {
      "aws:CurrentTime": "2025-08-09T18:00:00Z"
    }
  }
}
```

---

## 🧱 태그 기반 권한 관리

정책에 리소스나 사용자 태그를 조건으로 넣을 수 있어, 조직 단위 관리에 효과적입니다.

```json
"Condition": {
  "StringEquals": {
    "aws:RequestTag/Department": "Finance"
  }
}
```

---

## 🧪 정책 테스트: IAM Policy Simulator

AWS Console의 [IAM Policy Simulator](https://policysim.aws.amazon.com/home/index.jsp) 를 이용해 정책의 동작을 시뮬레이션 할 수 있습니다.  
정책 변경 전 테스트하는 것은 *보안 사고 예방*에 매우 중요합니다.

---

## 🚫 자주 발생하는 실수

| 실수 | 설명 |
|------|------|
| `Resource: "*"` 남용 | 모든 리소스에 권한을 부여하는 것은 위험 |
| `Allow`만 사용 | 명시적인 `Deny`를 사용하지 않아 위험 조건 제어 부족 |
| 조건문 미사용 | IP 제한, 시간 제한 등을 활용하지 않음 |
| 역할 남용 | EC2나 Lambda 역할에 과도한 권한 부여 |

---

## 📘 모범 사례 정리

- 최소 권한 원칙 준수
- 리소스 수준 명시
- 조건(Condition) 적극 활용
- 역할(Role) 설계는 서비스에 맞게 최소한으로
- 정기적인 정책 리뷰 및 감사
- CloudTrail과 Access Analyzer로 모니터링 강화

---

## ✅ 결론

IAM 정책은 AWS 보안의 핵심입니다. 잘 설계된 정책은 보안 사고를 예방하고, 운영 효율성을 높이며, 감사와 추적성을 향상시킵니다. 단순한 JSON 문서를 넘어서 **클라우드 보안 아키텍처의 근간**이므로, 언제나 꼼꼼하게 설계하고 주기적으로 점검하는 습관이 필요합니다.
