---
layout: post
title: Git - SSH 키
date: 2025-01-19 21:20:23 +0900
category: Git
---
# GitHub에서 SSH 키 사용하기

## SSH 키란?

SSH 키는 공개키와 개인키의 쌍으로 이루어진 디지털 인증서입니다. 공개키를 GitHub에 등록하고 개인키를 로컬에 안전하게 보관하면, 매번 비밀번호를 입력하지 않고도 안전하게 GitHub와 통신할 수 있습니다.

---

## SSH 키 생성하기

가장 현대적이고 안전한 ED25519 알고리즘으로 키를 생성하는 것을 권장합니다.

```bash
ssh-keygen -t ed25519 -a 64 -o -C "your_email@example.com"
```

이 명령을 실행하면:
1. 키를 저장할 파일 경로를 물어봅니다. (기본값을 사용하려면 Enter)
2. **암호문구(passphrase)**를 설정하라는 메시지가 나타납니다. 보안을 위해 암호문구를 설정하는 것이 좋습니다.

**참고**: 레거시 시스템과의 호환성이 필요한 경우에만 RSA를 사용하세요.
```bash
ssh-keygen -t rsa -b 4096 -a 64 -o -C "legacy@example.com"
```

---

## GitHub에 공개키 등록하기

1. 생성한 공개키 내용을 확인합니다.
```bash
cat ~/.ssh/id_ed25519.pub
```

2. 출력된 내용을 모두 복사합니다. (형식: `ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... your_email@example.com`)

3. GitHub 웹사이트에서 **Settings → SSH and GPG keys → New SSH key**로 이동합니다.
4. 적절한 제목(예: "My Work Laptop")을 입력하고, 복사한 공개키를 Key 필드에 붙여넣습니다.
5. **Add SSH key** 버튼을 클릭합니다.

여러 장치(회사 노트북, 개인 PC 등)를 사용한다면, 각 장치마다 별도의 키 쌍을 생성하여 등록하는 것이 보안상 좋습니다.

---

## SSH 연결 테스트

키 등록이 완료되면 터미널에서 연결을 테스트해볼 수 있습니다.

```bash
ssh -T git@github.com
```

처음 연결할 때는 GitHub 호스트의 신뢰성을 확인하는 메시지가 나타납니다. `yes`를 입력하면 연결이 완료되고 다음과 같은 환영 메시지를 볼 수 있습니다.
```
Hi username! You've successfully authenticated, but GitHub does not provide shell access.
```

---

## 기존 프로젝트를 SSH로 전환하기

HTTPS로 클론한 프로젝트가 있다면, 원격 주소를 SSH 형식으로 변경할 수 있습니다.

```bash
git remote set-url origin git@github.com:username/repository.git
```

새로운 프로젝트를 클론할 때는 처음부터 SSH 주소를 사용하세요.
```bash
git clone git@github.com:username/repository.git
```

---

## ssh-agent로 편리하게 사용하기

매번 암호문구를 입력하는 것이 번거롭다면 ssh-agent를 사용할 수 있습니다. ssh-agent는 암호화된 개인키를 메모리에 저장하여 자동으로 인증할 수 있게 해줍니다.

에이전트를 시작하고 키를 추가합니다.
```bash
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519
```

macOS 사용자의 경우 키체인과 연동하여 더 편리하게 관리할 수 있습니다.
```bash
ssh-add --apple-use-keychain ~/.ssh/id_ed25519
```

---

## 여러 GitHub 계정 관리하기

개인 계정과 회사 계정을 함께 사용하는 경우, SSH 설정 파일(`~/.ssh/config`)을 통해 깔끔하게 관리할 수 있습니다.

```sshconfig
# 개인 계정
Host github.com
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_personal
  IdentitiesOnly yes

# 회사 계정 (별칭 사용)
Host github-work
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_work
  IdentitiesOnly yes
```

회사 저장소를 클론할 때는 별칭을 사용합니다.
```bash
git clone git@github-work:company/repository.git
```

---

## 보안 모범 사례

1. **2단계 인증(2FA) 필수**: SSH 키만으로는 충분하지 않습니다. GitHub 계정에 반드시 2FA를 활성화하세요.
2. **정기적인 키 교체**: 6개월에서 1년 주기로 새로운 키를 생성하고 이전 키는 GitHub에서 삭제하세요.
3. **적절한 파일 권한 설정**:
   ```bash
   chmod 700 ~/.ssh
   chmod 600 ~/.ssh/id_ed25519
   chmod 644 ~/.ssh/id_ed25519.pub
   chmod 644 ~/.ssh/config
   ```
4. **분실 대비**: 노트북을 분실했을 경우를 대비해, 각 장치별로 별도의 키를 사용하세요.

---

## 자주 발생하는 문제 해결

**"Permission denied (publickey)" 오류**
1. `ssh-add -l`로 키가 에이전트에 등록되었는지 확인하세요.
2. GitHub 설정에서 공개키가 올바르게 등록되었는지 확인하세요.
3. `~/.ssh/config` 파일에 `IdentitiesOnly yes` 옵션이 있는지 확인하세요.

**서브모듈과의 호환성 문제**
서브모듈이 포함된 프로젝트의 경우, 모든 서브모듈도 SSH 형식으로 변경해야 합니다.
```bash
git submodule foreach 'git remote set-url origin $(git config --get remote.origin.url | sed "s#https://github.com/#git@github.com:#")'
git submodule sync --recursive
```

**디버깅 모드**
문제의 원인을 파악하기 어렵다면 상세 로그를 확인하세요.
```bash
ssh -vT git@github.com
```

---

## 마무리

SSH 키를 사용하면 GitHub과의 안전하고 편리한 인증이 가능해집니다. 특히 여러 계정을 관리하거나 CI/CD 파이프라인에서 자동화된 작업을 수행할 때 그 진가를 발휘합니다. 처음 설정할 때는 다소 복잡하게 느껴질 수 있지만, 한번 구성해두면 장기적으로 개발 워크플로우의 효율성을 크게 향상시킬 수 있습니다.

**기억할 점**:
- ED25519 키를 사용하고 암호문구를 설정하세요.
- 각 장치마다 별도의 키를 생성하고 관리하세요.
- 정기적으로 키를 교체하고 보안 모범 사례를 따르세요.
- 문제가 발생하면 `ssh -vT git@github.com` 명령어로 상세 로그를 확인하세요.

SSH 키 설정은 한 번의 투자로 지속적인 편리함과 향상된 보안을 제공하는 가치 있는 작업입니다.