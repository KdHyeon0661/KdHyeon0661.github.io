---
layout: post
title: 이산수학 - 함수의 증가와 단조성
date: 2025-05-29 19:20:23 +0900
category: 이산수학
---
# 함수의 증가와 단조성 (Monotonicity)

## 1. 증가·감소의 정밀 정의

### 1.1 엄격히 증가(strictly increasing)
집합 $$D\subseteq\mathbb{R}$$ 에서 함수 $$f:D\to\mathbb{R}$$ 가 **엄격히 증가**라 함은
$$
\forall x_1,x_2\in D,\ x_1<x_2\ \Rightarrow\ f(x_1)<f(x_2)
$$
가 성립하는 것을 말한다.

### 1.2 단조 증가(monotone non-decreasing)
$$
\forall x_1<x_2\ \Rightarrow\ f(x_1)\le f(x_2).
$$
같은 값을 허용한다(평탄 구간 가능).

### 1.3 엄격히/단조 감소
증가의 부등호를 반대로 바꾼다:
- 엄격히 감소: $$x_1<x_2\Rightarrow f(x_1)>f(x_2)$$
- 단조 감소: $$x_1<x_2\Rightarrow f(x_1)\ge f(x_2)$$

### 1.4 구간 단조
함수는 전체 정의역에서 단조가 아닐 수 있으나, 특정 **구간**에서 단조일 수 있다.  
예: $$f(x)=x^2$$ 는 $$(-\infty,0]$$ 에서 단조 감소, $$[0,\infty)$$ 에서 단조 증가.

---

## 2. 직관과 예시

| 함수 | 성질 | 이유/메모 |
|---|---|---|
| $$f(x)=x$$ | 엄격히 증가 | 임의의 $$x_1<x_2\Rightarrow x_1<x_2$$ |
| $$f(x)=-x$$ | 엄격히 감소 | 부호 반전 |
| $$f(x)=x^2$$ | 단조 아님(전구간) | 원점 기준 좌우 대칭 |
| $$f(x)=\lceil x\rceil$$ | 단조 증가(비엄격) | 계단 함수, 평탄 구간 존재 |
| $$f(x)=\sin x$$ | 단조 아님 | 주기적 증감 반복 |

---

## 3. 단조성과 미분(해석학적 판별)

### 3.1 미분 부호로 충분조건
$$f$$ 가 구간 $$I$$ 에서 미분 가능하고
$$
\forall x\in I,\ f'(x)\ge 0
$$
이면 $$f$$ 는 $$I$$ 에서 **단조 증가**다.  
만약 $$f'(x)>0$$ 이 거의 모든 점에서 성립하고 연속이면 보통 **엄격히 증가**(드문 예외는 평탄 구간).

**증명 개요**: 평균값정리(MVT). $$x_1<x_2\Rightarrow \exists c\in(x_1,x_2)$$ s.t. $$\dfrac{f(x_2)-f(x_1)}{x_2-x_1}=f'(c)\ge 0.$$

### 3.2 역방향(필요조건의 한계)
$$f$$ 가 단조 증가이면 미분가능한 거의 모든 점에서 $$f'(x)\ge 0$$ 이다(르베그의 의미). 단, **모든 점**에서 미분이 존재할 필요는 없다(점프 가능).

---

## 4. 단조성과 역함수

### 4.1 단사성과 역함수
엄격히 단조이면 **단사**(one-to-one). 따라서 치역 $$f(D)$$ 에 대해 역함수 $$f^{-1}:f(D)\to D$$ 가 존재하며, 이 역함수도 **단조**(증가의 경우 증가, 감소의 경우 감소).

### 4.2 연속성과 역함수의 연속성
연속이고 엄격히 단조인 함수는 그 역함수도 연속이다(구간 위에서의 전형적 성질: 위상동형).

---

## 5. 단조성과 극값

- 단조 증가 함수는 구간 내 **국소 극댓값**이 없다(끝점 제외).  
- 닫힌 유계 구간 $$[a,b]$$ 에서 단조 증가이면 최소값은 $$x=a$$ 에서, 최대값은 $$x=b$$ 에서 달성된다.  
- 단조 감소는 반대.

---

## 6. 단조성과 유계·수렴(수열 중심)

### 6.1 단조수열 수렴정리
수열 $$(a_n)$$ 이 단조 증가이고 위로 유계이면 **수렴**하고, 극한은 상한 $$\sup\{a_n\}$$ 이다.
- 증명 스케치: 완비성(실수의 수축성) 이용.

### 6.2 차분을 통한 판별(수열)
- 엄격히 증가: $$a_{n+1}-a_n>0$$ for all $$n$$  
- 단조 증가: $$a_{n+1}-a_n\ge 0$$

**예**: $$a_n=\dfrac{n+1}{n}$$ 은 $$a_{n+1}-a_n=\dfrac{n+2}{n+1}-\dfrac{n+1}{n}=\dfrac{-1}{n(n+1)}<0$$ 이므로 단조 감소, 그리고 아래로 유계(1로 수렴).

---

## 7. 조합 규칙(연산에 대한 보존)

- **합**: $$f,g$$ 가 단조 증가이면 $$f+g$$ 도 단조 증가.  
- **스칼라배**: $$c>0$$ 이면 $$cf$$ 는 $$f$$ 와 같은 단조 방향, $$c<0$$ 이면 방향 반대.  
- **합성**: $$f$$ 단조 증가, $$g$$ 단조 증가이면 $$g\circ f$$ 도 단조 증가. $$g$$ 가 단조 감소이면 방향 반전.  
- **곱**: 부호 조건이 필요. 예컨대 $$f,g\ge 0$$ 이고 둘 다 단조 증가라고 해서 $$fg$$ 가 반드시 단조 증가인 것은 아니다(반례 존재). 다만 추가 가정(예: 미분 가능, 도함수 부호와 크기 제어) 하에서는 판별 가능.
- **단조 변환**: 순위/최댓값/최솟값의 **위치**는 엄격히 단조 변환 아래서 보존(값은 변하지만 argmax/argmin 불변).

---

## 8. 단조성과 볼록성(빠른 비교)

- 볼록(convex) 함수의 도함수는 **단조 증가**(존재하는 곳에서).  
- 반대로 도함수가 단조 증가라면 함수는 볼록(연속 미분 가능 가정).  
- 볼록이라고 해서 함수 자체가 단조인 것은 아니다(예: $$x^2$$).

---

## 9. 단조 함수의 불연속성과 변동

- 단조 함수는 **좌극한/우극한**이 모든 점에서 존재한다.  
- 불연속은 모두 **점프 불연속**이며, 그 집합은 **가산** 집합이다.  
- 단조 함수는 **유한 변동**(bounded variation)을 갖는다.

---

## 10. 이산 수학 관점의 확장(순서이론)

- **등질(isotone)**(모노톤 증가): 부분순서 집합 $$(P,\le_P)$$ 와 $$(Q,\le_Q)$$ 에서, $$x\le_P y\Rightarrow f(x)\le_Q f(y)$$.  
- **반등질(antitone)**: $$x\le_P y\Rightarrow f(x)\ge_Q f(y)$$.  
- **Tarski 고정점 정리**(격자): 완비 격자 상의 등질 사상은 최소/최대 고정점을 갖는다.  
  이 정리는 정적분석, 형식검증(데이터 흐름 분석의 수렴 보장) 등에서 중요.

---

## 11. 알고리즘에서의 단조성 활용

### 11.1 답에 대한 이분 탐색(Binary Search on Answer)
**단조 성질**을 갖는 판정 함수 $$P(m)$$(예: $$m$$ 이상이면 가능, 이하면 불가능)을 이용해 해 공간을 이분 탐색.

```python
def binary_search_answer(lo, hi, ok):
    # ok(m): 단조한 판정 함수(True -> True -> ... 영역)
    while lo < hi:
        mid = (lo + hi) // 2
        if ok(mid):
            hi = mid   # True 쪽 경계로 이동(최솟값 탐색)
        else:
            lo = mid + 1
    return lo
```

### 11.2 모노톤 스택(Monotone Stack)
다음 큰 원소(NGE), 히스토그램 최대 직사각형 등. 스택에 단조 성질을 유지해 **선형시간**.

```python
def next_greater_indices(a):
    n=len(a); ans=[-1]*n; st=[]
    for i,x in enumerate(a):
        while st and a[st[-1]]<x:
            ans[st.pop()]=i
        st.append(i)
    return ans  # 각 i의 다음 큰 값의 인덱스
```

### 11.3 모노톤 큐(Monotone Queue)
슬라이딩 윈도우 최소/최대: 데크에 후보를 단조로 유지해 각 원소 1회 입출.

```python
from collections import deque
def sliding_min(a, k):
    dq=deque(); ans=[]
    for i,x in enumerate(a):
        while dq and a[dq[-1]]>=x: dq.pop()
        dq.append(i)
        if dq[0]==i-k: dq.popleft()
        if i>=k-1: ans.append(a[dq[0]])
    return ans
```

### 11.4 이산 최적화(등질 변형)
값 대신 **순서**만 중요할 때, 단조 변환(예: 로그) 후 동일한 해를 얻는다(argmax 불변). 수치 안정성 향상.

---

## 12. 데이터에서 단조성 검정과 보정

### 12.1 유한 차분으로 경험적 검정
```python
def is_monotone_nondecreasing(xs, ys, tol=0.0):
    # xs는 증가 정렬이라 가정
    for i in range(1, len(xs)):
        if ys[i] + tol < ys[i-1]:
            return False
    return True
```

### 12.2 아이소토닉 회귀(Isotonic Regression)
관측 잡음으로 단조성이 깨졌을 때, **단조 제약 최소제곱**으로 보정(최소 제곱 오차, 단조 제약). 파이썬에서는 scikit-learn의 `IsotonicRegression` 등.

---

## 13. 연습 문제와 해설 스케치

1) $$f(x)=x^3-3x$$ 의 단조 구간을 찾아라.  
해: $$f'(x)=3x^2-3=3(x-1)(x+1)$$. 부호 분석: $$(-\infty,-1]$$ 증가, $$[-1,1]$$ 감소, $$[1,\infty)$$ 증가.

2) $$a_{n+1}=\frac{1}{2}(a_n+\frac{2}{a_n}),\ a_1>0$$ 가 정의될 때, $$(a_n)$$ 이 단조 감소이고 하계가 존재함을 보여라(평균-기하평균 부등식 응용).  
해: 뉴턴 방법의 예로, $$a_n\ge \sqrt{2}$$ 이면 감소하며 $$\sqrt{2}$$ 로 수렴.

3) $$f,g$$ 가 모두 연속·엄격히 증가라면 $$h(x)=g(f(x))$$ 가 엄격히 증가임을 증명하라.  
해: $$x_1<x_2\Rightarrow f(x_1)<f(x_2)\Rightarrow g(f(x_1))<g(f(x_2))$$.

4) 단조 증가이되 어디서나 미분 불가능한 예를 들어라.  
해: 캔터 함수는 단조 증가, 거의 어디서나 도함수 0, 구간의 특정 집합에서 점프적 변화.

---

## 14. 파이썬 실습: 단조성 시각화

```python
# 주의: 실행 환경에서 matplotlib를 사용할 수 있을 때만 작동
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-3, 3, 400)
y_inc = x                     # 단조 증가
y_non = x**2                  # 단조 아님(전구간)
y_dec = -x                    # 단조 감소

plt.plot(x, y_inc, label="y = x (단조 증가)")
plt.plot(x, y_non, label="y = x^2 (단조 아님)")
plt.plot(x, y_dec, label="y = -x (단조 감소)")
plt.legend()
plt.grid(True)
plt.title("단조성 시각화")
plt.show()
```

---

## 15. 자주 하는 오해와 주의점

- **미분가능이면 단조?** 아니다. 미분 부호가 일정해야 한다.  
- **단조 증가 ⇒ 연속?** 아니다. 점프 불연속 가능(계단 함수).  
- **값의 단조 변환 ⇒ 최적해 값 동일?** 값은 변하지만 **해의 위치(argmax/argmin)** 는 동일(엄격히 단조 변환일 때).  
- **곱의 단조성은 자동?** 아니다. 추가 조건 확인이 필요.

---

## 16. 요약

- 단조의 핵심 정의는 **순서 보존**: $$x_1<x_2\Rightarrow f(x_1)\le(\text{또는 }<) f(x_2)$$.  
- 미분 부호 일정(연속/미분 가능 가정) ⇒ 단조 판별.  
- 엄격히 단조이면 **단사**, 역함수도 단조.  
- 수열은 **차분 부호**로 판별, 유계 단조수열은 수렴.  
- 알고리즘에서 단조성은 **이분 탐색**, **모노톤 스택/큐**, **단조 제약 회귀** 등 핵심 테크닉으로 직결.

---

## 부록 A. 간단한 증명 모음

### A.1 평균값정리로 단조성
$$f'(x)\ge 0$$ 이면 $$x_1<x_2$$ 에 대해
$$
\frac{f(x_2)-f(x_1)}{x_2-x_1}=f'(c)\ge 0\ \Rightarrow\ f(x_2)\ge f(x_1).
$$

### A.2 단조수열 수렴정리
$$a_n$$ 단조 증가, 위로 유계라 하자. 집합 $$S=\{a_n\}$$ 의 상한 $$L=\sup S$$ 를 잡으면, 임의의 $$\varepsilon>0$$ 에 대해 $$L-\varepsilon$$ 은 상한이 아니므로 어떤 $$N$$ 에 대해 $$a_N>L-\varepsilon$$. 단조 증가이므로 $$n\ge N\Rightarrow a_n\ge a_N>L-\varepsilon$$ 이고, 상한 정의상 $$a_n\le L$$. 따라서 $$|a_n-L|<\varepsilon$$ 이 되어 $$a_n\to L$$.

---

## 부록 B. 연습용 체크 함수

```python
def monotonicity_report(xs, ys, tol=0.0):
    """
    xs: 정렬된 x 값들
    ys: f(xs)
    tol: 수치 오차 허용
    """
    inc=True; s_inc=True
    dec=True; s_dec=True
    for i in range(1, len(xs)):
        dy = ys[i] - ys[i-1]
        if dy + tol < 0: inc=False
        if dy <= tol:    s_inc=False
        if dy - tol > 0: dec=False
        if dy >= -tol:   s_dec=False
    status=[]
    if   s_inc: status.append("엄격히 증가")
    elif inc:   status.append("단조 증가")
    if   s_dec: status.append("엄격히 감소")
    elif dec:   status.append("단조 감소")
    if not status: status.append("단조 아님")
    return ", ".join(status)
```

---

## 부록 C. 예제 데이터로 실험

```python
xs = list(range(-5,6))
ys1 = [x for x in xs]           # 엄격히 증가
ys2 = [x*x for x in xs]         # 단조 아님(전구간)
ys3 = [-x for x in xs]          # 엄격히 감소
ys4 = [0,0,1,1,2,2,2,3,3,3,3]   # 단조 증가(비엄격)

print(monotonicity_report(xs, ys1))
print(monotonicity_report(xs, ys2))
print(monotonicity_report(xs, ys3))
print(monotonicity_report(xs, ys4))
```