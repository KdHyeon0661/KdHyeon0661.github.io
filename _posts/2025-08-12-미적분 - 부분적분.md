---
layout: post
title: 미적분 - 부분적분
date: 2025-08-12 19:20:23 +0900
category: 미적분
---
# 부분적분 (Integration by Parts)

> **핵심 한 줄:**  
> 두 함수의 곱 적분은 “**하나는 미분(u), 다른 하나는 적분(dv)**”으로 바꿔서  
> $$\displaystyle \int u\,dv \;=\; uv \;-\; \int v\,du$$ 로 푼다.  
> 올바른 **선택(무엇을 u, 무엇을 dv로?)**이 절반이다.

---

## 0) 공식과 직관

- **공식(부정적분)**  
  $$
  \boxed{\;\int u(x)\,v'(x)\,dx\;=\;u(x)v(x)\;-\;\int u'(x)\,v(x)\,dx\;}
  \quad\Longleftrightarrow\quad
  \boxed{\;\int u\,dv = uv - \int v\,du\;}
  $$

- **정적분 버전**  
  $$
  \boxed{\;\int_{a}^{b} u\,dv \;=\; \big[u\,v\big]_{a}^{b} \;-\; \int_{a}^{b} v\,du\;}
  $$

- **직관**: 곱의 미분
  $$
  (uv)'=u'v+uv' \ \Rightarrow\ \int uv'=\int(uv)'-\int u'v=uv-\int u'v.
  $$

---

## 1) 언제 쓰나? (사용 조건 & 효율 판단)

- 적분 대상이 **곱 형태**일 때: 다항×지수, 다항×삼각, 로그/역삼각×상수, …
- **한쪽(u)은 미분하면 단순해지고**, 다른 한쪽(dv)은 **원시함수(적분)가 쉽다**.
- 한 번으로 끝나지 않으면 **반복**(tabular method)로 정리.
- 정적분이면 **경계항 $[uv]_a^b$가 깔끔해지도록** 선택하면 계산이 쉬워짐.

---

## 2) u 선택 요령 — **LIATE** 규칙

우선순위가 높을수록 **u(미분할 것)**으로 택하기 좋다.

| 우선 | 분류 | 예시 |
|---|---|---|
| L | Logarithmic(로그) | $\ln x,\ \log_a x$ |
| I | Inverse trig(역삼각) | $\arctan x,\ \arcsin x$ |
| A | Algebraic(대수) | $x^n,\ 3x+2$ |
| T | Trig(삼각) | $\sin x,\ \cos x$ |
| E | Exponential(지수) | $e^{ax},\ a^x$ |

> 예: $\int x e^x\,dx$ 에서 $u=x$, $dv=e^x dx$가 정석.

---

## 3) 손에 익히는 **기본 예제**

### 예제 1) $\displaystyle \int x e^x\,dx$

- $u=x \Rightarrow du=dx$  
- $dv=e^x dx \Rightarrow v=e^x$
  
$$
\int x e^x\,dx
= x e^x - \int e^x\,dx
= x e^x - e^x + C
= e^x(x-1)+C.
$$

---

### 예제 2) $\displaystyle \int \ln x\,dx$  (로그 적분의 정석)

- $u=\ln x \Rightarrow du=\dfrac{1}{x}dx$  
- $dv=dx \Rightarrow v=x$

$$
\int \ln x\,dx
= x\ln x - \int x\cdot \frac{1}{x}\,dx
= x\ln x - \int 1\,dx
= x\ln x - x + C.
$$

---

### 예제 3) $\displaystyle \int x^2\cos x\,dx$  (반복 필요)

1차:
- $u=x^2,\ du=2x\,dx$  
- $dv=\cos x\,dx,\ v=\sin x$

$$
\int x^2\cos x\,dx
= x^2\sin x - \int 2x\sin x\,dx.
$$

2차(남은 적분):
- $u=2x,\ du=2\,dx$  
- $dv=\sin x\,dx,\ v=-\cos x$

$$
\int 2x\sin x\,dx
= -2x\cos x + \int 2\cos x\,dx
= -2x\cos x + 2\sin x.
$$

따라서
$$
\int x^2\cos x\,dx
= x^2\sin x + 2x\cos x - 2\sin x + C.
$$

---

## 4) **Tabular Method(표법)** — 반복 부분적분 자동화

다항×(지수/삼각)에서 다항이 0이 될 때까지 미분, 다른 항은 적분을 누적하는 표.

예) $\displaystyle \int x^3 e^{2x}\,dx$

| 미분(u) | 적분(dv) 누적 v |
|---|---|
| $x^3$ | $e^{2x}$ |
| $3x^2$ | $\dfrac{e^{2x}}{2}$ |
| $6x$ | $\dfrac{e^{2x}}{2^2}$ |
| $6$ | $\dfrac{e^{2x}}{2^3}$ |
| $0$ | $\dfrac{e^{2x}}{2^4}$ |

부호는 $+,-,+,-,\dots$ 로 교차:
$$
\int x^3 e^{2x}\,dx
= x^3\frac{e^{2x}}{2}
- 3x^2\frac{e^{2x}}{2^2}
+ 6x\frac{e^{2x}}{2^3}
- 6\frac{e^{2x}}{2^4} + C.
$$
정리하면
$$
\frac{e^{2x}}{8}\big(4x^3-6x^2+3x- \tfrac{3}{2}\big)+C
\quad\text{(상수는 합치면 됨)}.
$$

---

## 5) **감소/귀납 공식(Recurrence)** 만들기

### (A) $\displaystyle I_n=\int x^n e^{ax}\,dx$  (n: 정수 $\ge0$)

- $u=x^n \Rightarrow du=n x^{n-1} dx$  
- $dv=e^{ax}dx \Rightarrow v=\dfrac{e^{ax}}{a}$

$$
I_n
= \frac{x^n e^{ax}}{a} - \int \frac{e^{ax}}{a}\cdot n x^{n-1}\,dx
= \frac{e^{ax}}{a}x^n - \frac{n}{a}I_{n-1}.
$$

**재귀:**  
$$
\boxed{\,I_n=\frac{e^{ax}}{a}x^n - \frac{n}{a}I_{n-1}\,}
$$
초기 $I_0=\dfrac{e^{ax}}{a}+C$로 닫힌형 가능.

---

### (B) $\displaystyle J_n=\int x^n\sin bx\,dx$,  $\displaystyle K_n=\int x^n\cos bx\,dx$

- $u=x^n,\ du=n x^{n-1}dx$
- $dv=\sin bx\,dx,\ v=-\dfrac{\cos bx}{b}$ 또는 $dv=\cos bx\,dx,\ v=\dfrac{\sin bx}{b}$

결론(대표형):
$$
J_n = -\frac{x^n\cos bx}{b} + \frac{n}{b}K_{n-1},\qquad
K_n = \frac{x^n\sin bx}{b} - \frac{n}{b}J_{n-1}.
$$

서로 얽힌 **2개의 재귀**로 차례로 낮춰간다.

---

## 6) “순환 적분” 트릭 — $I$가 다시 자기 자신으로

### (A) $\displaystyle \int e^{ax}\cos bx\,dx$ (동일하게 $\sin$도)

- $dv=\cos bx\,dx \Rightarrow v=\dfrac{\sin bx}{b}$
- 한 번 더 하면 원래 적분이 등장 → **연립 후 $I$를 푼다**.

표준 결과:
$$
\boxed{\,\int e^{ax}\cos bx\,dx
=\frac{e^{ax}}{a^2+b^2}\,\big(a\cos bx + b\sin bx\big)+C\,}
$$
$$
\boxed{\,\int e^{ax}\sin bx\,dx
=\frac{e^{ax}}{a^2+b^2}\,\big(a\sin bx - b\cos bx\big)+C\,}
$$

---

## 7) 로그/역삼각 **클래식들**

### (A) $\displaystyle \int x^m \ln x\,dx\quad (m\ne -1)$

- $u=\ln x \Rightarrow du=dx/x$
- $dv=x^m dx \Rightarrow v=\dfrac{x^{m+1}}{m+1}$

$$
\int x^m \ln x\,dx
=\frac{x^{m+1}}{m+1}\ln x - \int \frac{x^{m+1}}{m+1}\cdot \frac{1}{x}\,dx
=\frac{x^{m+1}}{m+1}\ln x - \frac{1}{m+1}\cdot \frac{x^{m+1}}{m+1} + C.
$$

### (B) $\displaystyle \int \arctan x\,dx$

- $u=\arctan x \Rightarrow du=\dfrac{1}{1+x^2}dx$
- $dv=dx \Rightarrow v=x$

$$
\int \arctan x\,dx
= x\arctan x - \int \frac{x}{1+x^2}\,dx
= x\arctan x - \frac12 \ln(1+x^2)+C.
$$

---

## 8) **정적분**에 부분적분 적용 — 경계항이 효자

### 예제) $\displaystyle \int_{0}^{1} x\ln(1+x)\,dx$

- $u=\ln(1+x)\Rightarrow du=\dfrac{1}{1+x}dx$
- $dv=x\,dx\Rightarrow v=\dfrac{x^2}{2}$

$$
\int_{0}^{1} x\ln(1+x)\,dx
= \left[\frac{x^2}{2}\ln(1+x)\right]_0^1
- \int_{0}^{1} \frac{x^2}{2(1+x)}\,dx.
$$

분수는 $x^2/(1+x)=x-1+\frac{1}{1+x}$로 나눗셈:
$$
= \frac{1}{2}\ln 2 - \frac12\int_{0}^{1}\!\left(x-1+\frac{1}{1+x}\right)dx
= \frac{1}{2}\ln 2 - \frac12\left[\frac{x^2}{2}-x+\ln(1+x)\right]_0^1.
$$
$$
= \frac{1}{2}\ln 2 - \frac12\left(\frac12-1+\ln 2\right)
= \frac{1}{2}\ln 2 - \frac12\left(-\frac12+\ln 2\right)
= \frac14.
$$
**정답:** $\boxed{\tfrac14}$.

---

### 유명 정적분들 (부분적분으로 깔끔)

1) $\displaystyle \int_{0}^{\pi} x\sin x\,dx
= \Big[-x\cos x\Big]_0^\pi + \int_0^{\pi}\cos x\,dx
= \pi.$

2) $\displaystyle \int_0^\infty x e^{-x}\,dx$  
$u=x,\ dv=e^{-x}dx \Rightarrow$ 경계항 0으로 소멸 → 값 $=1$ (즉 $\Gamma(2)=1!)$.

3) $\displaystyle \int_0^1 \ln x\,dx$  
$u=\ln x,\ dv=dx \Rightarrow \big[x\ln x\big]_0^1 - \int_0^1 1\,dx = -1.$

---

## 9) **임프로퍼 적분**에서의 주의점 (경계항 소멸 조건)

- $[uv]_a^b$에서 $a$ 또는 $b$가 무한대거나 특이점이면,  
  **극한**으로 해석: $\lim_{R\to\infty}[uv]_a^R$ 등.
- **선택 전략**: 경계에서 $uv$가 **0으로 수렴**하게 만드는 $u,dv$ 선택.
  - 예: $u$가 다항, $v$가 $e^{-x}$면 $uv\to 0$.

---

## 10) 실전 응용 스냅샷

### (A) 감마함수 재귀: $\Gamma(n+1)=n\Gamma(n)$

$$
\Gamma(n+1)=\int_0^\infty x^{n}e^{-x}\,dx.
$$
부분적분: $u=x^n,\ dv=e^{-x}dx$  
$\Rightarrow \Gamma(n+1)=\big[-x^n e^{-x}\big]_0^\infty + n\int_0^\infty x^{n-1}e^{-x}\,dx = n\Gamma(n)$.

---

### (B) 라플라스 변환: $ \mathcal{L}\{t f(t)\}(s) = -\dfrac{d}{ds}\mathcal{L}\{f(t)\}(s)$

$$
\mathcal{L}\{t f(t)\}=\int_0^\infty t f(t)e^{-st}\,dt.
$$
$u=t f(t),\ dv=e^{-st}dt$로 적분하면 $v=-\dfrac{1}{s}e^{-st}$, 경계 0 가정 시  
$$
\int_0^\infty t f(t)e^{-st} dt = \frac{1}{s}\int_0^\infty f(t)e^{-st}dt + \frac{1}{s}\int_0^\infty t f'(t)e^{-st}dt,
$$
표준 정리로 정리하면 위 항등으로 귀결(자세한 정칙성 조건 필요).

---

### (C) 푸리에 변환: 미분→주파수에서 곱셈

$f'\in L^1$ 가정 시
$$
\mathcal{F}\{f'(x)\}(\omega)= (i\omega)\,\widehat f(\omega)
$$
은 적분구간에서 **부분적분**으로 얻는다(경계항 소멸 전제).

---

### (D) Stein’s Lemma(확률): $X\sim \mathcal{N}(0,1)$이면 $ \mathbb{E}[X g(X)] = \mathbb{E}[g'(X)] $

밀도 $\phi(x)=\dfrac{1}{\sqrt{2\pi}}e^{-x^2/2}$.  
$$
\mathbb{E}[Xg(X)] = \int_{-\infty}^\infty x g(x)\phi(x)\,dx
= \int g(x)\,(-\phi'(x))\,dx
= \Big[-g(x)\phi(x)\Big]_{-\infty}^{\infty} + \int g'(x)\phi(x)\,dx
= \mathbb{E}[g'(X)].
$$
(경계항 소멸은 $\phi$의 빠른 감쇠로 정당화.)

---

## 11) 자주 하는 실수 & 체크리스트

- □ **$u, dv$ 선택**이 비효율: 미분해도 안 단순해지면 선택 재고.  
- □ **정적분**에서 **경계항** $[uv]_a^b$를 빼먹음.  
- □ $\int \frac{1}{x}dx=\ln|x|+C$ **절댓값** 누락.  
- □ **임프로퍼**에서 극한/경계항 수렴성 미확인.  
- □ 반복 부분적분에서 **부호** 교차 실수.

---

## 12) 추가 예제 모음 (풀이 동봉)

### 예제 1) $\displaystyle \int x e^{2x}\,dx$
$u=x,\ dv=e^{2x}dx$:
$$
\frac{1}{2}xe^{2x}-\frac{1}{2}\int e^{2x}dx
= \frac{1}{2}xe^{2x}-\frac{1}{4}e^{2x}+C
= \frac{e^{2x}}{4}(2x-1)+C.
$$

### 예제 2) $\displaystyle \int \ln(1+x)\,dx$
$u=\ln(1+x),\ dv=dx$:
$$
x\ln(1+x)-\int \frac{x}{1+x}dx
= x\ln(1+x)-\int\left(1-\frac{1}{1+x}\right)dx
= x\ln(1+x)-x+\ln(1+x)+C.
$$

### 예제 3) $\displaystyle \int x\arctan x\,dx$
$u=\arctan x,\ dv=x\,dx$:
$$
\frac{x^2}{2}\arctan x - \int \frac{x^2/2}{1+x^2}dx
= \frac{x^2}{2}\arctan x - \frac12\int\left(1-\frac{1}{1+x^2}\right)dx
$$
$$
= \frac{x^2}{2}\arctan x - \frac{x}{2} + \frac{1}{2}\arctan x + C.
$$

### 예제 4) $\displaystyle \int_0^\infty e^{-ax}\ln x\,dx\quad (a>0)$
치환 $x=\tfrac{t}{a}$ 또는 $\Gamma'(1)$ 이용. 부분적분으로도 가능:
$$
\int_0^\infty e^{-ax}\ln x\,dx = \frac{-\gamma - \ln a}{a},
$$
($\gamma$: 오일러-마스케로니 상수)

### 예제 5) $\displaystyle \int x^3\sin x\,dx$ (Tabular)
| 미분 | 적분 |
|---|---|
| $x^3$ | $-\cos x$ |
| $3x^2$ | $-\sin x$ |
| $6x$ | $\cos x$ |
| $6$ | $\sin x$ |
| $0$ | $-\cos x$ |

부호 교차 적용:
$$
\int x^3\sin x\,dx
= -x^3\cos x + 3x^2\sin x + 6x\cos x - 6\sin x + C.
$$

---

## 13) 파이썬(SymPy)로 검증/실험

```python
import sympy as sp

x, a, b = sp.symbols('x a b', positive=True)
# 예제 검증 1: ∫ x*exp(2x) dx
expr = sp.integrate(x*sp.exp(2*x), x)
print(sp.simplify(expr))  # e^(2x)*(2x-1)/4 + C

# 예제 검증 2: ∫ x^2 cos x dx
expr2 = sp.integrate(x**2*sp.cos(x), x)
print(sp.simplify(expr2))  # x^2*sin(x) + 2*x*cos(x) - 2*sin(x) + C

# 예제 검증 3: 정적분 ∫_0^1 x*ln(1+x) dx
val = sp.integrate(x*sp.log(1+x), (x,0,1))
print(sp.simplify(val))  # 1/4

# 예제 검증 4: ∫ e^{ax} cos(bx) dx
expr3 = sp.integrate(sp.exp(a*x)*sp.cos(b*x), x)
print(sp.simplify(expr3))  # e^(ax)*(a*cos(bx)+b*sin(bx))/(a^2+b^2) + C
```

---

## 14) 연습문제 (힌트만)

1) $\int x^2 e^{-x}\,dx$ — Tabular.  
2) $\int_0^{\pi} x\cos x\,dx$ — 경계항이 핵심.  
3) $\int \arcsin x\,dx$ — $u=\arcsin x$, $dv=dx$.  
4) $\int x^n \ln(ax+b)\,dx$ — $u=\ln(ax+b)$, $dv=x^n dx$.  
5) $\int e^{ax}\sin bx\,dx$ — 순환 적분 해법.

---

## 15) 한눈에 보는 치트시트

- **공식**: $\displaystyle \int u\,dv = uv - \int v\,du$
- **선택**: LIATE(로그>역삼각>대수>삼각>지수)
- **반복**: Tabular로 빠르게
- **재귀**: $I_n=\frac{e^{ax}}{a}x^n-\frac{n}{a}I_{n-1}$ 등
- **순환형**: $\int e^{ax}\cos bx$, $\int e^{ax}\sin bx$는 표준식 암기
- **정적분**: $[uv]_a^b$ 먼저! (경계가 0이 되게 선택)
- **임프로퍼**: 경계항 소멸/수렴 확인