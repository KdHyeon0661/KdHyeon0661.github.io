---
layout: post
title: ë””ìì¸íŒ¨í„´ - Prototype
date: 2025-06-15 21:20:23 +0900
category: ë””ìì¸íŒ¨í„´
---
# Prototype(í”„ë¡œí† íƒ€ì… íŒ¨í„´) â€” êµ¬ì¡° ê·¸ë¦¼ ìœ ì§€, ì–•ì€/ê¹Šì€ ë³µì œ, ê·¸ë˜í”„/ìˆœí™˜ ì°¸ì¡°, ë ˆì§€ìŠ¤íŠ¸ë¦¬, ì§ë ¬í™”, ì¹´í”¼ì˜¨ë¼ì´íŠ¸, ì–¸ì–´ë³„ êµ¬í˜„ê¹Œì§€ ì‹¤ì „ ì™„ì „ ì •ë¦¬

ë³¸ ë¬¸ì„œëŠ” ì‚¬ìš©ìê°€ ì œê³µí•œ ì´ˆì•ˆì˜ **í•µì‹¬(ì •ì˜/ì˜ë„/êµ¬ì¡°/ì˜ˆì œ/ì¥ë‹¨ì /ë¹„êµ í‘œ)**ì™€ **êµ¬ì¡° ê·¸ë¦¼**ì„ ê·¸ëŒ€ë¡œ ì‚´ë¦¬ë©´ì„œ, ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ë°”ë¡œ ì ìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ **ë¬¸ì œ ë§¥ë½ â†’ êµ¬ì¡° í•´ì„¤ â†’ ì–•ì€/ê¹Šì€ ë³µì œ â†’ ìˆœí™˜ ì°¸ì¡°/ê·¸ë˜í”„ ë³µì œ â†’ í”„ë¡œí† íƒ€ì… ë ˆì§€ìŠ¤íŠ¸ë¦¬ â†’ ì§ë ¬í™” ê¸°ë°˜ ë³µì œ â†’ ì¹´í”¼-ì˜¨-ë¼ì´íŠ¸(Copy-on-Write) â†’ ì–¸ì–´ë³„ êµ¬í˜„(Python/C#/Java/TypeScript ì¼ë¶€) â†’ í…ŒìŠ¤íŠ¸ ì „ëµ â†’ ì„±ëŠ¥/ë©”ëª¨ë¦¬/ë™ì‹œì„± â†’ ë¦¬íŒ©í† ë§ ì ˆì°¨ â†’ ë‹¤ë¥¸ ìƒì„± íŒ¨í„´ê³¼ì˜ ê´€ê³„(Builder/Factory/Abstract Factory/Flyweight)**ê¹Œì§€ í™•ì¥í•œë‹¤. ëª¨ë“  ì½”ë“œëŠ” ì½”ë“œë¸”ë¡ìœ¼ë¡œ, ìˆ˜ì‹ì€ $$...$$ë¡œ í‘œê¸°í•œë‹¤. í‘œÂ·ê·¸ë¦¼ì€ ê°€ëŠ¥í•œ í•œ ìœ ì§€Â·ë³´ê°•í•œë‹¤.

---

## âœ… ì •ì˜(Definition)

**í”„ë¡œí† íƒ€ì… íŒ¨í„´(Prototype Pattern)**ì€ **ê¸°ì¡´ ê°ì²´ë¥¼ ë³µì œ(clone)**í•˜ì—¬ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” **ìƒì„± íŒ¨í„´**ì´ë‹¤.
ë³µì¡í•œ ì´ˆê¸°í™”ê°€ ë¹„ì‹¸ê±°ë‚˜, ìœ ì‚¬í•œ ê°ì²´ë¥¼ ë‹¤ëŸ‰ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•  ë•Œ **ìƒˆë¡œ ìƒì„±** ëŒ€ì‹  **ë³µì œ**ë¡œ ë¹„ìš©ì„ ì ˆê°í•˜ê³ , **êµ¬ì²´ íƒ€ì…/ìƒì„± ê³¼ì •ì„ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìˆ¨ê¸´ë‹¤**.

---

## ğŸ¯ ì˜ë„(Intent)

- **ë³µì œ**ë¥¼ í†µí•´ **ìƒì„± ë¹„ìš©/ì‹œê°„**ì„ ì¤„ì´ê±°ë‚˜ ìƒì„± ê³¼ì •ì„ ë‹¨ìˆœí™”í•œë‹¤.
- í´ë¼ì´ì–¸íŠ¸ëŠ” **êµ¬ì²´ íƒ€ì…/ìƒì„±ì**ë¥¼ ëª°ë¼ë„ **ì›ë³¸(í”„ë¡œí† íƒ€ì…)**ë§Œ ì•Œë©´ ëœë‹¤.
- **ëŸ°íƒ€ì„ì— ìƒˆë¡œìš´ â€œìœ í˜•â€**(ìƒì† ì—†ì´ë„)ì„ **ì›ë³¸ ë“±ë¡â†’ë³µì œ**ë¡œ ì‰½ê²Œ í™•ì¥í•œë‹¤.

---

## ğŸ“¦ êµ¬ì¡°(Structure) â€” ì œê³µí•œ ê·¸ë¦¼ ë³´ì¡´ + ì—­í•  í•´ì„¤

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Prototype (ì¸í„°í˜ì´ìŠ¤)â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–²
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ConcretePrototype      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Client       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Prototype**: `clone()` ê³„ì•½(ì–•ì€/ê¹Šì€ ë³µì œ, í›„ì²˜ë¦¬ ê·œì•½ í¬í•¨)
- **ConcretePrototype**: ìƒíƒœë¥¼ ê°€ì§„ ì‹¤ì œ ê°ì²´, `clone()` êµ¬í˜„
- **Client**: ë³µì œë¥¼ ìš”ì²­í•˜ê³ , ê²°ê³¼ë¥¼ ì‚¬ìš©. **êµ¬ì²´ ìƒì„±ìë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ**

í™•ì¥ êµ¬ì¡°(ë ˆì§€ìŠ¤íŠ¸ë¦¬ í¬í•¨):

```
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  PrototypeRegistry   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ key â†’ Prototype instance â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ clone(key)
                 â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”   clone()   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Client â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚ ConcretePrototype ...â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§‘â€ğŸ’» ê¸°ë³¸ êµ¬í˜„ ì˜ˆì‹œ (Python) â€” ì–•ì€/ê¹Šì€ ë³µì œ, ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ

```python
import copy
from abc import ABC, abstractmethod
from typing import Any

class Prototype(ABC):
    @abstractmethod
    def clone(self) -> "Prototype": ...

class Shape(Prototype):
    def __init__(self, meta: dict[str, Any], points: list[tuple[int,int]]):
        self.meta = meta                  # ì°¸ì¡° íƒ€ì…
        self.points = points              # ì°¸ì¡° íƒ€ì…(ê°€ë³€)

    def __repr__(self):
        return f"Shape(meta={self.meta}, points={self.points})"

    # ê¸°ë³¸: ê¹Šì€ ë³µì œ(ê¶Œì¥). í•„ìš” ì‹œ ì–•ì€ ë³µì œë¡œ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ ê°€ëŠ¥.
    def clone(self) -> "Shape":
        return copy.deepcopy(self)

    # copy.deepcopy ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ(ìˆœí™˜/ê³µìœ  ìœ ì§€ ê°€ëŠ¥)
    def __deepcopy__(self, memo):
        # memo: id(obj) -> cloned_obj ë”•ì…”ë„ˆë¦¬(ê³µìœ /ìˆœí™˜ ë³´ì¡´)
        cls = self.__class__
        new_obj = cls.__new__(cls)
        memo[id(self)] = new_obj
        # í•„ë“œ ë‹¨ìœ„ë¡œ ë³µì œ ì •ì±… ì§€ì •
        new_obj.meta   = copy.deepcopy(self.meta, memo)   # ê¹Šì€ ë³µì œ
        new_obj.points = copy.deepcopy(self.points, memo) # ê¹Šì€ ë³µì œ
        return new_obj

# ë°ëª¨

s1 = Shape(meta={"color":"red"}, points=[(0,0),(1,1)])
s2 = s1.clone()
s2.meta["color"] = "blue"     # s1ê³¼ ë¶„ë¦¬ë¨(ê¹Šì€ ë³µì œ)
s2.points.append((2,2))
print(s1)  # Shape(meta={'color': 'red'}, points=[(0, 0), (1, 1)])
print(s2)  # Shape(meta={'color': 'blue'}, points=[(0, 0), (1, 1), (2, 2)])
```

í¬ì¸íŠ¸
- **ê°€ë³€ í•„ë“œ**ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **ê¹Šì€ ë³µì œ**ê°€ ì•ˆì „.
- `__deepcopy__`ì—ì„œ **memo**ë¥¼ í™œìš©í•˜ë©´ **ìˆœí™˜ ì°¸ì¡°/ê³µìœ  ê°ì²´**ë¥¼ ìœ ì§€ ê°€ëŠ¥.

---

## ì–•ì€ ë³µì œ vs ê¹Šì€ ë³µì œ

| êµ¬ë¶„ | ì–•ì€ ë³µì œ(Shallow) | ê¹Šì€ ë³µì œ(Deep) |
|---|---|---|
| ì •ì˜ | ìµœìƒìœ„ ê°ì²´ë§Œ ìƒˆë¡œ ë§Œë“¤ê³ , ë‚´ë¶€ ì°¸ì¡°ëŠ” **ê°™ì€ ê°ì²´**ë¥¼ ê°€ë¦¬í‚´ | ë‚´ë¶€ ì°¸ì¡°ê¹Œì§€ **ì¬ê·€ì ìœ¼ë¡œ ë³µì œ** |
| ë¹„ìš© | ë‚®ìŒ(O(1)~O(í•„ë“œ ìˆ˜)) | ë†’ìŒ(O(ê°ì²´ ê·¸ë˜í”„ í¬ê¸°)) |
| ì•ˆì „ì„± | ì›ë³¸ê³¼ **ìƒíƒœ ê³µìœ **ë¡œ ë¶€ì‘ìš© ê°€ëŠ¥ | ì›ë³¸ê³¼ **ë…ë¦½** |
| ì“°ì„ | í° ë¶ˆë³€ ì„œë¸Œê·¸ë˜í”„ ê³µìœ , COW, ìºì‹œ | ë…ë¦½ ìƒíƒœê°€ í•„ìš”í•œ í¸ì§‘/ê°€ê³µ |

---

## ğŸ” ìˆœí™˜ ì°¸ì¡°/ê·¸ë˜í”„ ë³µì œ â€” ì•ˆì „í•œ ë”¥ì¹´í”¼

ê·¸ë˜í”„ êµ¬ì¡°(ì˜ˆ: íŠ¸ë¦¬ì§€ë§Œ ë¶€ëª¨ ì°¸ì¡°ê°€ ìˆì–´ **DAG/ìˆœí™˜**ì´ ë  ìˆ˜ ìˆìŒ)ë¥¼ ë³µì œí•  ë•Œ **ë¬´í•œ ì¬ê·€**ë¥¼ í”¼í•˜ê³ , **ê³µìœ  ë…¸ë“œ ë™ì¼ì„±**ì„ ë³´ì¥í•´ì•¼ í•œë‹¤. ëŒ€ë¶€ë¶„ ì–¸ì–´ì˜ í‘œì¤€ ë”¥ì¹´í”¼ëŠ” **ë©”ëª¨(memoization) ë§µ**ìœ¼ë¡œ ì´ë¥¼ í•´ê²°í•œë‹¤.

ìˆ˜ì‹ìœ¼ë¡œ ë‹¨ìˆœí™”í•˜ë©´, ë³µì œ ì‹œê°„ì€ **ê·¸ë˜í”„ì˜ ë…¸ë“œ ìˆ˜ \(N\)**ì™€ ì—£ì§€ ìˆ˜ \(E\)**ì— ëŒ€í•´**
$$
T_{\text{deepclone}} = \Theta(N + E)
$$
(ë…¸ë“œ/ì—£ì§€ë‹¹ í•œ ë²ˆì”© ë°©ë¬¸ ê°€ì •, í•´ì‹œ/ë§µ ì‚½ì…ì€ í‰ê·  \(O(1)\)).

Python ì˜ˆ: ì‚¬ìš©ì ì •ì˜ ê·¸ë˜í”„

```python
import copy

class Node:
    def __init__(self, name: str):
        self.name = name
        self.neighbors: list["Node"] = []

    def __deepcopy__(self, memo):
        if id(self) in memo:
            return memo[id(self)]
        cls = self.__class__
        clone = cls.__new__(cls)
        memo[id(self)] = clone
        clone.name = self.name
        clone.neighbors = [copy.deepcopy(n, memo) for n in self.neighbors]
        return clone

# ìˆœí™˜ êµ¬ì„±

a = Node("A"); b = Node("B"); c = Node("C")
a.neighbors = [b]; b.neighbors = [c]; c.neighbors = [a]  # cycle
clone_a = copy.deepcopy(a)   # ì•ˆì „í•˜ê²Œ ë³µì œ
```

---

## ğŸ—‚ï¸ í”„ë¡œí† íƒ€ì… ë ˆì§€ìŠ¤íŠ¸ë¦¬(Registry) â€” ëŸ°íƒ€ì„ í™•ì¥

í‚¤â†’í”„ë¡œí† íƒ€ì… ë§¤í•‘ìœ¼ë¡œ â€œìƒˆ ìœ í˜•â€ì„ **ìƒì† ì—†ì´ë„** ëŸ°íƒ€ì„ ë“±ë¡/êµì²´.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PrototypeRegistry               â”‚
â”‚  - register(key, prototype)     â”‚
â”‚  - clone(key, **overrides)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
import copy
from typing import Dict, Any

class PrototypeRegistry:
    def __init__(self) -> None:
        self._map: Dict[str, Any] = {}

    def register(self, key: str, proto: Any) -> None:
        if key in self._map:
            raise KeyError(f"duplicate key: {key}")
        self._map[key] = proto

    def clone(self, key: str, **overrides) -> Any:
        base = self._map[key]
        obj = copy.deepcopy(base)
        for k, v in overrides.items():
            setattr(obj, k, v)
        return obj

# ì‚¬ìš©: ê²Œì„ ëª¬ìŠ¤í„° í…œí”Œë¦¿

class Monster:
    def __init__(self, kind, hp, atk): self.kind, self.hp, self.atk = kind, hp, atk
    def __repr__(self): return f"{self.kind}(hp={self.hp}, atk={self.atk})"

reg = PrototypeRegistry()
reg.register("goblin", Monster("goblin", 50, 7))
reg.register("ogre",   Monster("ogre", 200, 25))

m1 = reg.clone("goblin", hp=60)  # ì¼ë¶€ë§Œ ë®ì–´ì“°ê¸°
m2 = reg.clone("ogre", atk=30)
```

ì¥ì 
- **í”ŒëŸ¬ê·¸ì¸/ëª¨ë“œ/í…Œë„ŒíŠ¸**ë³„ë¡œ êµ¬ì„± ë³€ê²½ì´ ì‰¬ì›€
- **A/B í…ŒìŠ¤íŠ¸**ë‚˜ **í”¼ì²˜ í”Œë˜ê·¸**ì™€ ê²°í•© ìš©ì´

---

## ğŸ§³ ì§ë ¬í™” ê¸°ë°˜ ë³µì œ(Serialization Clone) â€” ì¥ë‹¨ì 

**ì•„ì´ë””ì–´**: ê°ì²´ë¥¼ ë°”ì´íŠ¸ë¡œ ì§ë ¬í™” â†’ ì—­ì§ë ¬í™”ë¡œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ íšë“(ê¹Šì€ ë³µì œ íš¨ê³¼).
- ì¥ì : **ê°„ë‹¨**í•˜ê³  í”„ë ˆì„ì›Œí¬/IPCì— ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°
- ë‹¨ì : **ì„±ëŠ¥ ë¹„ìš©**(ì§ë ¬í™”/ì—­ì§ë ¬í™”), **ë³´ì•ˆ ìœ„í—˜**(ì„ì˜ íƒ€ì… ë¡œë”©), **ë¹„ì§ë ¬í™” ë¶ˆê°€ í•„ë“œ** ì²˜ë¦¬ í•„ìš”

Python(ì£¼ì˜: pickle ë³´ì•ˆ/ë²„ì „ ì˜ì¡´)

```python
import pickle

def serialize_clone(obj):
    return pickle.loads(pickle.dumps(obj, protocol=pickle.HIGHEST_PROTOCOL))
```

Java(ì£¼ì˜: `Serializable` ê¸°ë°˜, ì„±ëŠ¥/ë³´ì•ˆ ê³ ë ¤)

```java
// ìœ í‹¸ë¡œ ê°ì‹¸ì„œ í…ŒìŠ¤íŠ¸/ë„êµ¬ì—ì„œë§Œ ì‚¬ìš© ê¶Œì¥
static <T extends Serializable> T cloneBySer(T obj) {
    try (var baos = new ByteArrayOutputStream();
         var oos = new ObjectOutputStream(baos)) {
        oos.writeObject(obj);
        oos.flush();
        try (var ois = new ObjectInputStream(new ByteArrayInputStream(baos.toByteArray()))) {
            @SuppressWarnings("unchecked")
            T copy = (T) ois.readObject();
            return copy;
        }
    } catch (Exception e) { throw new RuntimeException(e); }
}
```

---

## ğŸŒ— ì¹´í”¼-ì˜¨-ë¼ì´íŠ¸(Copy-on-Write, COW) â€” ê³ ë¹ˆë„ ë³µì œì˜ ë¹„ìš© ì ˆê°

ëŒ€í˜• ë¶ˆë³€ ì„œë¸Œê·¸ë˜í”„ë¥¼ ê³µìœ í•˜ê³ , **ìˆ˜ì •ì´ ë°œìƒí•  ë•Œë§Œ** ì‹¤ì œ ë³µì œ.
- ì‹œê°„/ë©”ëª¨ë¦¬ ëª¨ë¸(ë‹¨ìˆœí™”):
  $$ T_{\text{clone-COW}} \approx O(1) \quad(\text{ë©”íƒ€ë°ì´í„°ë§Œ}) $$
  $$ T_{\text{first-write}} \approx O(|\text{ë³€ê²½ ì„œë¸Œê·¸ë˜í”„}|) $$
- Python í‘œì¤€ì—ëŠ” COW ì»¨í…Œì´ë„ˆê°€ ê¸°ë³¸ ì œê³µë˜ì§„ ì•Šì§€ë§Œ, **ë¶ˆë³€ ê°ì²´(tuple, frozenset)**ì™€ **ê³µìœ  ìºì‹œ**ë¡œ ìœ ì‚¬ íš¨ê³¼ ê°€ëŠ¥.
- C#/JavaëŠ” ì»¬ë ‰ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ **ë¶ˆë³€ ì»¬ë ‰ì…˜**/**persistent data structure**ë¥¼ í™œìš©.

---

## ğŸ§‘â€ğŸ’» ì–¸ì–´ë³„ êµ¬í˜„ íŒ

### Python

- `copy.copy`(ì–•ì€), `copy.deepcopy`(ê¹Šì€).
- ì»¤ìŠ¤í…€ì€ `__copy__` / `__deepcopy__(memo)` êµ¬í˜„.
- **ìŠ¬ë¡¯/í”„ë¡ì‹œ/íŒŒì¼ í•¸ë“¤/ë½** ë“± ë³µì œ ë¶ˆê°€ ìì›ì€ **ë©í•‘** ë˜ëŠ” **ì¬ì´ˆê¸°í™” ì •ì±…** ë¬¸ì„œí™”.

### C# (.NET)

- `MemberwiseClone()`ìœ¼ë¡œ **ì–•ì€ ë³µì œ**(protected).
- `ICloneable`ì€ **ë¹„ê¶Œì¥**(ì˜ë¯¸ê°€ ëª¨í˜¸) â†’ **ëª…ì‹œ ì¸í„°í˜ì´ìŠ¤** `IDeepCloneable<T>` ë˜ëŠ” **Copy Ctor** ê¶Œì¥.
- **record** íƒ€ì…ì€ **ê°’ ê¸°ë°˜** `with` ë³µì‚¬ê°€ ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€ì•ˆ.

```csharp
public interface IDeepCloneable<T> { T DeepClone(); }

public sealed class Tree : IDeepCloneable<Tree> {
    public int Value { get; init; }
    public List<Tree> Children { get; init; } = new();
    public Tree DeepClone() => new Tree {
        Value = this.Value,
        Children = this.Children.ConvertAll(c => c.DeepClone())
    };
}
```

### Java

- `Cloneable`+`clone()`ì€ **ì£¼ì˜**(ì–•ì€ ë³µì œ ê¸°ë³¸, ì˜ˆì™¸/ê°€ì‹œì„±/ë¶ˆë³€ì‹ ë¶•ê´´ ìœ„í—˜).
- ì‹¤ì „ì—ì„œëŠ” **ë³µì‚¬ ìƒì„±ì/ì •ì  íŒ©í† ë¦¬** ë˜ëŠ” **ë¹Œë”**ê°€ ë” ëª…í™•.
- ê·¸ë˜ë„ `clone()`ì„ ì“´ë‹¤ë©´ **ê¹Šì€ ë³µì œ**ë¥¼ ëª…ì‹œì ìœ¼ë¡œ êµ¬í˜„/ë¬¸ì„œí™”.

```java
public class Node implements Cloneable {
  int v; List<Node> children = new ArrayList<>();
  @Override protected Node clone() {
    try {
      Node n = (Node) super.clone();
      n.children = new ArrayList<>(children.size());
      for (var c: children) n.children.add(c.clone());
      return n;
    } catch (CloneNotSupportedException e) { throw new AssertionError(e); }
  }
}
```

### TypeScript(ë³´ë„ˆìŠ¤)

- êµ¬ì¡°ì  íƒ€ì… + ì–•ì€ ë³µì œëŠ” `{...obj}` / `Array.slice()`
- ê¹Šì€ ë³µì œëŠ” êµ¬ì¡°ì  ìˆœíšŒ/ì§ë ¬í™”(JSON ê¸°ë°˜ì€ Date/Map/Set/í•¨ìˆ˜ ì†ì‹¤ ì£¼ì˜)

---

## âœ… ì¥ì (ë³´ê°•)

- **ìƒì„± ë¹„ìš© ë†’ìŒ**(I/O, íŒŒì‹±, ëŒ€í˜• ê·¸ë˜í”„ ì¡°ë¦½)ì¼ ë•Œ **ë¹ ë¥¸ ìƒì„±**
- **ëŸ°íƒ€ì„ í™•ì¥ì„±**: ìƒì† ì—†ì´ë„ **ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¶”ê°€**ë§Œìœ¼ë¡œ â€œìƒˆ ìœ í˜•â€ ì •ì˜
- **ìƒíƒœë¥¼ ë³´ì¡´**í•œ ì±„ ìƒˆë¡œìš´ ë³€í˜• ìƒì„±(í…œí”Œë¦¿ ê¸°ë°˜)
- **DI/í”ŒëŸ¬ê·¸ì¸**ê³¼ ê²°í•© ì‰¬ì›€(í‚¤â†’í”„ë¡œí† íƒ€ì…)

---

## âš ï¸ ë‹¨ì (ë³´ê°•)

- ê¹Šì€ ë³µì œ ê·œì¹™ ì •ì˜/ìœ ì§€ ë³´ìˆ˜ ë¶€ë‹´(íŠ¹íˆ **ìˆœí™˜/ê³µìœ ** ì²˜ë¦¬)
- íŒŒì¼ í•¸ë“¤/ì†Œì¼“/ë½/ìŠ¤ë ˆë“œ ë“± **ë³µì œ ë¶ˆê°€ ìì›** ì²˜ë¦¬ ì •ì±… í•„ìš”
- **ë™ì¼ì„±/ë™ë“±ì„±**(identity/equality) ë¬¸ì œ: `id/hashCode/Equals` ì¬ê²€í† 
- ì–¸ì–´ë³„ ê¸°ë³¸ `clone` ì˜ë¯¸ê°€ ëª¨í˜¸í•˜ê±°ë‚˜ ë¹„ê¶Œì¥(C#, Java)

---

## ğŸ“Œ ì‚¬ìš© ì‚¬ë¡€(í™•ì¥)

| ì‚¬ìš© ì‚¬ë¡€ | ì„¤ëª… |
|---|---|
| **ê²Œì„ í…œí”Œë¦¿** | ëª¬ìŠ¤í„°/ì•„ì´í…œ/ë ˆë²¨ ë ˆì´ì•„ì›ƒì„ í…œí”Œë¦¿ì—ì„œ ë³µì œ í›„ íŒŒë¼ë¯¸í„°ë§Œ ì¡°ì • |
| **UI/ë„ë©´ í¸ì§‘ê¸°** | ë„í˜•/ì»´í¬ë„ŒíŠ¸ë¥¼ ë“œë˜ê·¸-ë³µì œ(ìƒíƒœ ìœ ì§€) |
| **DB/ë¬¸ì„œ** | ê¸°ì¡´ ë ˆì½”ë“œ/ë¬¸ì„œ ë³µì œ í›„ ì¼ë¶€ í•„ë“œ ë³€ê²½í•˜ì—¬ ì‹ ê·œ ì‘ì„± |
| **ë¨¸ì‹ ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸** | íŒŒì´í”„ë¼ì¸/í•˜ì´í¼íŒŒë¼ë¯¸í„° í…œí”Œë¦¿ì„ ë³µì œ í›„ ì‘ì€ ì°¨ì´ ì‹¤í—˜ |
| **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ì •** | í…Œë„ŒíŠ¸ë³„ ê¸°ë³¸ ì„¤ì • í”„ë¡œíŒŒì¼ì„ ë³µì œ í›„ ë®ì–´ì“°ê¸° |

---

## ğŸ” Prototype vs new vs Factory (ë³´ê°• í‘œ)

| í•­ëª© | `new` | Factory Method/Abstract Factory | **Prototype** |
|---|---|---|---|
| ìƒì„± ë°©ì‹ | ìƒì„±ì ì§ì ‘ | ì„ íƒ/ì œí’ˆêµ° ìƒì„± | **ë³µì œ ê¸°ë°˜** |
| ë¹„ìš© | ë³´í†µ | ë³´í†µ | **ë‚®ìŒ(í…œí”Œë¦¿ ì¤€ë¹„ ì‹œ)** |
| ìœ ì—°ì„± | ë‚®ìŒ | ì¤‘ | **ë†’ìŒ(ëŸ°íƒ€ì„ í…œí”Œë¦¿ êµì²´)** |
| í™•ì¥ì„± | íƒ€ì… ì¶”ê°€ í•„ìš” | íŒ©í† ë¦¬ ì¶”ê°€/êµì²´ | **ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë“±ë¡/êµì²´** |
| ìƒíƒœ ë³´ì¡´ | ì—†ìŒ | ì—†ìŒ | **ìˆìŒ**(í…œí”Œë¦¿ ìƒíƒœ ê³„ìŠ¹) |

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ(ê³„ì•½/ë™ë“±ì„±/ë¦¬ì†ŒìŠ¤ ì •ì±…)

- **ê³„ì•½ í…ŒìŠ¤íŠ¸**: `clone()`ì€ **ë…ë¦½ ê°ì²´**ë¥¼ ë°˜í™˜(= ì°¸ì¡° ë™ë“±ì„± ë¶€ì •), **ë¶ˆë³€ì‹ ìœ ì§€**.
- **ë™ë“±ì„±/í•´ì‹œ**: ë³µì œë³¸ì˜ `Equals`/`GetHashCode`/`hashCode` ê·œì¹™ ë¬¸ì„œí™”(ì‹ë³„ì ë™ê¸°í™” ì—¬ë¶€).
- **ë¦¬ì†ŒìŠ¤ ì •ì±… í…ŒìŠ¤íŠ¸**: íŒŒì¼/ì†Œì¼“/ë½ ë“±ì€ **ë³µì œ í›„ ìƒíƒœ**ê°€ ëª…í™•í•œì§€(ë‹«í˜/ì¬ì—°ê²°/í•¸ë“¤ ê³µìœ  ê¸ˆì§€).
- **ìˆœí™˜/ê³µìœ  ë³´ì¡´**: ë™ì¼ ì›ë³¸ì„ ë‘ í•„ë“œê°€ ì°¸ì¡°í•˜ë˜ ê²½ìš°, ë³µì œë³¸ë„ **ë™ì¼ ê°ì²´**ë¥¼ ê°€ë¦¬í‚¤ëŠ”ì§€.

PyTest ì˜ˆ

```python
def test_clone_independent():
    s1 = Shape(meta={"k":1}, points=[(0,0)])
    s2 = s1.clone()
    assert s1 is not s2
    s2.meta["k"] = 2
    assert s1.meta["k"] == 1  # ë…ë¦½

def test_shared_graph_preserved():
    import copy
    a = []
    b = [a, a]      # ê³µìœ 
    c = copy.deepcopy(b)
    assert c[0] is c[1]  # ê³µìœ  ìœ ì§€
```

---

## â±ï¸ ì„±ëŠ¥/ë©”ëª¨ë¦¬/ë™ì‹œì„±

- **ì‹œê°„**
  $$ T_{\text{shallow}} \approx O(1) \quad,\quad T_{\text{deep}} \approx O(|\text{ê°ì²´ ê·¸ë˜í”„}|) $$
- **ë©”ëª¨ë¦¬**: ê¹Šì€ ë³µì œëŠ” **ê·¸ë˜í”„ í¬ê¸°ë§Œí¼** ì¶”ê°€ ë©”ëª¨ë¦¬. COW/ë¶ˆë³€ êµ¬ì¡°ë¡œ ì™„í™”.
- **ë™ì‹œì„±**: í”„ë¡œí† íƒ€ì…ì€ ëŒ€ê°œ **ì½ê¸° ì „ìš© í…œí”Œë¦¿**ìœ¼ë¡œ ê³µìœ í•˜ê³ , ë³µì œë³¸ì—ì„œë§Œ ìˆ˜ì • â†’ ê²½í•© ìµœì†Œí™”.
- **ìºì‹±**: ë¹ˆë²ˆí•œ ë³µì œ ëŒ€ìƒì€ **ì‚¬ì „ ì¤€ë¹„ëœ í”„ë¡œí† íƒ€ì…**ìœ¼ë¡œ í•«íŒ¨ìŠ¤ ìµœì í™”.

---

## ğŸ”§ ë¦¬íŒ©í† ë§ ì ˆì°¨ â€” â€œë¹„ì‹¼ ìƒì„±ìâ€ â†’ â€œí”„ë¡œí† íƒ€ì…â€

**ëƒ„ìƒˆ**
- ë¬´ê±°ìš´ íŒŒì‹±/ê²€ì¦/ì¡°ë¦½ì´ ìƒì„±ìì— ì¡´ì¬, ëŒ€ëŸ‰ ìƒì„± ì‹œ ë³‘ëª©
- ë¹„ìŠ·í•œ ê°ì²´ë¥¼ ë‹¤ìˆ˜ ìƒì„±í•˜ë˜, ì°¨ì´ëŠ” **ì†Œìˆ˜ í•„ë“œ**ë¿

**ì ˆì°¨**
1) â€œì™„ì „ ì´ˆê¸°í™”ëœâ€ í…œí”Œë¦¿ ê°ì²´ë¥¼ **í•œ ë²ˆ ì¤€ë¹„**
2) **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì— ë“±ë¡, í‚¤ë¡œ ì¡°íšŒ ê°€ëŠ¥í•˜ê²Œ
3) `clone()`ì—ì„œ **ê¹Šì€ ë³µì œ + í•„ë“œ ë®ì–´ì“°ê¸°** ì •ì±… ë¬¸ì„œí™”
4) ìƒì„±ì í˜¸ì¶œì„ ì „ë¶€ `registry.clone(key, overrides...)`ë¡œ ëŒ€ì²´
5) ì„±ëŠ¥/ë©”ëª¨ë¦¬/ë™ì¼ì„±/ë¦¬ì†ŒìŠ¤ ì •ì±… í…ŒìŠ¤íŠ¸ ê°•í™”

---

## ğŸ¤ ë‹¤ë¥¸ íŒ¨í„´ê³¼ì˜ ê´€ê³„

| íŒ¨í„´ | ê´€ê³„ |
|---|---|
| **Builder** | í…œí”Œë¦¿ì„ **Builder**ë¡œ ë§Œë“¤ê³ , ì´í›„ **Prototype**ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë³µì œ/ë³€í˜• |
| **Factory Method** | â€œë¬´ì—‡ì„ ë§Œë“¤ì§€â€ ì„ íƒì€ **íŒ©í† ë¦¬**, ë§Œë“¤ì–´ì§„ ë² ì´ìŠ¤ë¥¼ **Prototype**ìœ¼ë¡œ ë‹¤ëŸ‰ ë³µì œ |
| **Abstract Factory** | ì œí’ˆêµ°ì˜ ê¸°ë³¸ í…œí”Œë¦¿ì„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë‘ê³ , íŒ©í† ë¦¬ê°€ ë‚´ë¶€ì ìœ¼ë¡œ **clone** |
| **Flyweight** | **ê³µìœ (ë¶ˆë³€) ìƒíƒœ**ëŠ” Flyweight, **ê°€ë³€ ìƒíƒœ**ëŠ” Prototypeìœ¼ë¡œ ë³µì œí•´ ë¶„ë¦¬ |

---

## ğŸ§‘â€ğŸ’» ì¶”ê°€ ì‹¤ì „ ì˜ˆì œ

### ë¬¸ì„œ í¸ì§‘ê¸°(ê³„ì¸µ ëª¨ë¸) â€” Python

```python
import copy
from dataclasses import dataclass, field
from typing import List

@dataclass
class Paragraph:
    text: str
    style: dict = field(default_factory=dict)

@dataclass
class Section:
    title: str
    paragraphs: List[Paragraph] = field(default_factory=list)

@dataclass
class Document:
    title: str
    sections: List[Section] = field(default_factory=list)

    def clone(self) -> "Document":
        # ê¹Šì€ ë³µì œ: ìŠ¤íƒ€ì¼/ë¬¸ë‹¨/ì„¹ì…˜ì´ ë…ë¦½
        return copy.deepcopy(self)

# í…œí”Œë¦¿

tpl = Document(
    title="Template",
    sections=[Section("Intro", [Paragraph("Welcome", {"size":12})])]
)

doc1 = tpl.clone(); doc1.title = "Doc A"
doc2 = tpl.clone(); doc2.sections[0].paragraphs[0].text = "Changed"
```

### C# ë ˆì§€ìŠ¤íŠ¸ë¦¬ + ë®ì–´ì“°ê¸°

```csharp
public interface IPrototype<T> { T DeepClone(); }

public sealed class Enemy : IPrototype<Enemy> {
    public string Kind { get; init; }
    public int Hp { get; init; }
    public int Atk { get; init; }
    public Enemy DeepClone() => new Enemy { Kind = Kind, Hp = Hp, Atk = Atk };
    public Enemy With(int? hp = null, int? atk = null)
        => new Enemy { Kind = Kind, Hp = hp ?? Hp, Atk = atk ?? Atk };
}

public sealed class Registry<T> where T : IPrototype<T> {
    private readonly Dictionary<string,T> _map = new();
    public void Register(string key, T proto) => _map.Add(key, proto);
    public T Clone(string key) => _map[key].DeepClone();
}

// ì‚¬ìš©
var reg = new Registry<Enemy>();
reg.Register("goblin", new Enemy{ Kind="goblin", Hp=50, Atk=7 });
var e1 = reg.Clone("goblin").With(hp:60);
```

### Java: `clone()` ëŒ€ì‹  ë³µì‚¬ ìƒì„±ì

```java
public final class Profile {
  private final String name;
  private final Map<String,String> attrs;

  public Profile(String name, Map<String,String> attrs) {
    this.name = name;
    this.attrs = new HashMap<>(attrs); // defensive copy
  }

  // ë³µì‚¬ ìƒì„±ì(ê¹Šì€ ë³µì œ ê·œì¹™ì„ ëª…í™•íˆ)
  public Profile(Profile other) {
    this(other.name, other.attrs);
  }

  public Profile withAttr(String k, String v) {
    var m = new HashMap<>(attrs);
    m.put(k, v);
    return new Profile(name, m);
  }
}
```

---

## ğŸ§  ì²´í¬ë¦¬ìŠ¤íŠ¸(ìµœì¢…)

- **ì™œ ë³µì œì¸ê°€?** ë¹„ì‹¼ ì´ˆê¸°í™”/ì¡°ë¦½/íŒŒì‹±ì„ íšŒí”¼í•˜ëŠ”ê°€?
- **ë³µì œ ê·œì¹™**(ì–•ì€/ê¹Šì€/ê³µìœ /ì¬ì´ˆê¸°í™”)ì´ ë¬¸ì„œí™”ë˜ì—ˆëŠ”ê°€?
- **ìˆœí™˜/ê³µìœ **ë¥¼ ë‹¤ë£¨ëŠ”ê°€(ë©”ëª¨/ì•„ì´ë´í‹°í‹° ë³´ì¡´)?
- **ë¦¬ì†ŒìŠ¤ í•„ë“œ**(íŒŒì¼/ë½/ìŠ¤ë ˆë“œ)ëŠ” ì •ì±…ì´ ìˆëŠ”ê°€(ë³µì œ ê¸ˆì§€/ì¬ìƒì„±)?
- **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ë¥¼ í†µí•œ ëŸ°íƒ€ì„ í™•ì¥/í”ŒëŸ¬ê·¸ì¸ì´ ì‰¬ìš´ê°€?
- **Equals/Hash/ID** ì •ì±…ì€ ì¼ê´€ì ì¸ê°€?
- ì„±ëŠ¥/ë©”ëª¨ë¦¬/ë™ì‹œì„±/í…ŒìŠ¤íŠ¸(ê³„ì•½Â·í˜ì¼íŒ¨ìŠ¤Â·í”„ë¡œí¼í‹°)ê°€ ì¤€ë¹„ë˜ì—ˆëŠ”ê°€?

---

## ğŸ§  ë§ˆë¬´ë¦¬

**Prototype**ì€ â€œ**í…œí”Œë¦¿ì„ í•œ ë²ˆ ì¤€ë¹„í•˜ê³  ë¹ ë¥´ê²Œ ë³€í˜•**â€í•˜ëŠ” ê°•ë ¥í•œ ë°©ë²•ì´ë‹¤.
ë³µì œ ê·œì¹™ì„ ë¯¸ë¦¬ **ëª…ì„¸í™”**í•˜ê³ , **ë ˆì§€ìŠ¤íŠ¸ë¦¬ + ë¹Œë”/íŒ©í† ë¦¬**ì™€ ì¡°í•©í•˜ë©´, ìƒì†ì— ì˜ì¡´í•˜ì§€ ì•Šê³ ë„ **ëŸ°íƒ€ì„ í™•ì¥ì„±Â·ì„±ëŠ¥Â·í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**ì„ ë™ì‹œì— ì–»ì„ ìˆ˜ ìˆë‹¤. ë°˜ëŒ€ë¡œ, ë‹¨ìˆœí•œ êµ¬ì¡°ì—ì„œ ë¬´ì¡°ê±´ ë³µì œë¥¼ ê°•í–‰í•˜ë©´ **ê·œì¹™ ê´€ë¦¬ ë¹„ìš©**ì´ ì»¤ì§„ë‹¤. **ì§„ì§œë¡œ ë¹„ì‹¼ ìƒì„±**ê³¼ **ë‹¤ë³€ëŸ‰ì˜ ìœ ì‚¬ ê°ì²´**ê°€ ìˆëŠ” ê³³ì— ì •í™•íˆ ì ìš©í•˜ë¼.
