---
layout: post
title: 선형대수 - 선형변환의 행렬 표현
date: 2025-06-10 21:20:23 +0900
category: 선형대수
---
# 선형변환의 행렬 표현

> **TL;DR**
> - 선형변환 \(T:\mathbb R^n\!\to\!\mathbb R^m\)은 항상 **어떤 행렬 \(A\)** 로 표현된다:  
>   \[
>   T(\mathbf x)=A\mathbf x.
>   \]
> - **표준기저**에서의 \(A\)는 **각 열이 \(T(\mathbf e_i)\)** 로 이루어진다.
> - **임의 기저** \(B,C\) 에서의 표현은  
>   \[
>   \boxed{[T]_{C\leftarrow B}=S_C^{-1}\,A\,S_B}
>   \]
>   (여기서 \(S_B=[\mathbf b_1\ \cdots\ \mathbf b_n]\), \(S_C=[\mathbf c_1\ \cdots\ \mathbf c_m]\)).

---

## 1. 정의에서 행렬까지: “기저의 이미지가 곧 열”

### 표준기저에서
- \(T:\mathbb R^n\!\to\!\mathbb R^m\) 이 선형이면, 표준기저 \(\{\mathbf e_i\}\)의 이미지를 열로 세운
  \[
  A=\big[T(\mathbf e_1)\ \cdots\ T(\mathbf e_n)\big]\in\mathbb R^{m\times n}
  \]
  가 **유일**하게 존재하며, 모든 \(\mathbf x\) 에 대해 \(T(\mathbf x)=A\mathbf x\).

### 왜 유일한가?
- 임의 \(\mathbf x=\sum_i x_i\mathbf e_i\) 에 대해
  \[
  T(\mathbf x)=\sum_i x_i\,T(\mathbf e_i) = A\mathbf x,
  \]
  즉 **선형성**이 각 열의 선형결합으로 딱 맞아떨어진다.

---

## 2. “열 규칙”과 “행 규칙”

- **열 규칙 (column rule)**: \(A\mathbf x = x_1\mathbf a_1+\cdots+x_n\mathbf a_n\)  
  (\(\mathbf a_i\) 는 \(A\)의 \(i\)번째 열)
- **행 규칙 (row rule)**: 각 성분은 \(A\)의 한 행과 \(\mathbf x\) 의 내적  
  \[
  (A\mathbf x)_j = \langle \text{row}_j(A),\,\mathbf x\rangle.
  \]

---

## 3. 임의 기저에서의 행렬 — 전이행렬과 좌표벡터

### 표기
- 도메인 기저: \(B=\{\mathbf b_1,\ldots,\mathbf b_n\}\Rightarrow S_B=[\mathbf b_1\ \cdots\ \mathbf b_n]\in\mathbb R^{n\times n}\)
- 코도메인 기저: \(C=\{\mathbf c_1,\ldots,\mathbf c_m\}\Rightarrow S_C=[\mathbf c_1\ \cdots\ \mathbf c_m]\in\mathbb R^{m\times m}\)

### 좌표벡터
- \([\mathbf x]_B\) 는 \(\mathbf x = S_B[\mathbf x]_B\) 를 만족하는 **좌표벡터**.
- 변환 후 좌표는 \([\ T(\mathbf x)\ ]_C\).

### 핵심 공식 (유도 포함)
\[
T(\mathbf x) = A\mathbf x = A\,S_B[\mathbf x]_B.
\]
한편
\[
[T(\mathbf x)]_C = S_C^{-1}\,T(\mathbf x)=S_C^{-1}A\,S_B[\mathbf x]_B.
\]
따라서 **임의 기저에서의 행렬 표현**:
\[
\boxed{[T]_{C\leftarrow B}=S_C^{-1}\,A\,S_B}.
\]

> 특수한 경우 \(B=C\) 이면 **유사변환(시밀라리티)**: \([T]_B=S_B^{-1}AS_B\).

---

## 4. 합성·역·항등: 기저를 고정해도, 바꿔도

- 합성 \(S\circ T\) :  
  \[
  [S\circ T]_{D\leftarrow B} = [S]_{D\leftarrow C}\,[T]_{C\leftarrow B}.
  \]
- 역변환(가역 시):  
  \[
  [T^{-1}]_{B\leftarrow C}=\big([T]_{C\leftarrow B}\big)^{-1}.
  \]
- 항등변환 \(I\) : 어떤 기저에서도 \([I]=I\).

---

## 5. 예제 1 — 2D 전단 변환을 여러 기저에서

### 변환 정의
\[
T(x,y)=(x+y,\ y),\qquad 
A=\begin{bmatrix}1&1\\0&1\end{bmatrix}\ (\text{표준기저}).
\]

### 다른 기저 \(B=\{\mathbf b_1,\mathbf b_2\}\)
- \(\mathbf b_1=(1,1)^\top,\ \mathbf b_2=(1,-1)^\top\)  
- \(S_B=\begin{bmatrix}1&1\\[2pt]1&-1\end{bmatrix},\quad S_B^{-1}=\tfrac12\begin{bmatrix}1&1\\[2pt]1&-1\end{bmatrix}.\)

### \(B\) 기준 행렬
\[
[T]_{B\leftarrow B}=S_B^{-1}AS_B
=\frac12\begin{bmatrix}1&1\\[2pt]1&-1\end{bmatrix}
\begin{bmatrix}1&1\\[2pt]0&1\end{bmatrix}
\begin{bmatrix}1&1\\[2pt]1&-1\end{bmatrix}
=
\begin{bmatrix} \tfrac32& \tfrac12\\[2pt] \tfrac12& \tfrac12\end{bmatrix}.
\]

### 해석
- 표준기저에서는 “x축 전단”이지만, 사선 기저 \(B\) 에서는 **대칭+전단 성분이 섞인** 형태로 보인다.  
- 동일한 선형변환이라도 **기저가 달라지면 행렬 모양이 달라진다**는 좋은 예.

---

## 6. 예제 2 — 평면 정사영: 좋은 기저에서 “대각”이 된다

### 변환: \(\mathbb R^3\) 에서 평면 \(W=\mathrm{span}\{(1,0,1)^\top,(0,1,1)^\top\}\) 로의 **직교 정사영** \(P\)
- 표준기저 행렬
  \[
  U=\begin{bmatrix}1&0\\0&1\\1&1\end{bmatrix},\quad 
  P=U\,(U^\top U)^{-1}U^\top.
  \]
  직접 계산하면
  \[
  P=\frac13\begin{bmatrix}2&-1&1\\ -1&2&1\\ 1&1&2\end{bmatrix}.
  \]

### “좋은 기저” \(\tilde B=\{u_1,u_2,n\}\) 선택
- \(u_1=(1,0,1)^\top,\ u_2=(0,1,1)^\top\), \(n=u_1\times u_2=(-1,-1,1)^\top\).
- 이 기저에서는
  \[
  [P]_{\tilde B\leftarrow \tilde B}=\mathrm{diag}(1,\,1,\,0).
  \]
  (평면 성분은 보존, 수직 성분은 0으로 **명확히 분리**)

> 교훈: 적절한 기저를 잡으면 **행렬이 구조를 드러내는 단순한 꼴**(대각/블록대각)이 된다.

---

## 7. 예제 3 — 선형함수(선형형식) \(T(\mathbf x)=\mathbf a^\top\mathbf x\)

- 표준기저에서 \(T\)의 행렬은 **한 줄짜리** \(A=\mathbf a^\top\in\mathbb R^{1\times n}\).
- 임의 기저 \(B\)에서는 \([T]_{\mathbb R\leftarrow B}=\mathbf a^\top S_B\).

---

## 8. 실전 절차 — “기저가 두 개일 때 이렇게 하자”

1) **표준행렬 \(A\)** 를 먼저 구한다(가능하면).  
2) **기저행렬** \(S_B, S_C\) 를 만든다(각 기저벡터를 **표준좌표**로 열에 세운다).  
3) **변환행렬**: \([T]_{C\leftarrow B}=S_C^{-1}AS_B\).  
4) **좌표 이동**:
   - 벡터 \(\mathbf x\) 의 \(B\)-좌표는 \([\mathbf x]_B=S_B^{-1}\mathbf x\).
   - 결과 좌표는 \([\ T(\mathbf x)\ ]_C=[T]_{C\leftarrow B}[\mathbf x]_B\).
   - 표준좌표로 돌아오려면 \(\mathbf y=S_C\,[\ T(\mathbf x)\ ]_C\).

**주의(매우 중요)**  
- 전이행렬의 **곱셈 순서**를 절대로 뒤바꾸지 말 것.  
- \(S_B,S_C\) 는 반드시 **가역**이어야 한다(진짜 기저인지 확인).
- 수치해석에서는 \(S_C^{-1}\) 대신 **LU/QR**로 선형계 풀기 권장.

---

## 9. 파이썬 검증 (NumPy/SymPy)

```python
import numpy as np
from numpy.linalg import inv, norm
from sympy import Matrix

# ---- 예제 1: 전단 T(x,y)=(x+y, y) ----
A = np.array([[1., 1.],
              [0., 1.]])

b1 = np.array([1., 1.])
b2 = np.array([1., -1.])
S_B = np.column_stack((b1, b2))
S_B_inv = inv(S_B)

T_B = S_B_inv @ A @ S_B  # [T]_{B<-B}
print("T_B =\n", T_B)

# 좌표 왕복 검증
x_std = np.array([2., 3.])
x_B   = S_B_inv @ x_std
y_std = A @ x_std
y_B   = T_B @ x_B
print("표준→B 좌표:", x_B)
print("T(x) 표준:", y_std)
print("T(x) B좌표 뒤 표준:", S_B @ y_B)  # 일치해야 함

# ---- 예제 2: 평면 정사영 ----
U = np.array([[1., 0.],
              [0., 1.],
              [1., 1.]])            # col-space basis
P = U @ inv(U.T @ U) @ U.T
print("P projection =\n", P)

u1 = np.array([1., 0., 1.])
u2 = np.array([0., 1., 1.])
n  = np.cross(u1, u2)                 # (-1,-1,1)
S_tilde = np.column_stack((u1, u2, n))
S_tilde_inv = inv(S_tilde)

# 기저에서의 표현: [P] = S^{-1} P S
P_tilde = S_tilde_inv @ P @ S_tilde
print("P in good basis ≈ diag(1,1,0):\n", np.round(P_tilde, 6))

# ---- SymPy로 정확성 체크(선택) ----
A_sym = Matrix(A.tolist())
SB_sym = Matrix(S_B.tolist())
TB_sym = SB_sym**-1 * A_sym * SB_sym
print("SymPy TB ="); print(TB_sym)
```

---

## 10. 빈출 함정 & 체크리스트

- **이동(translation)** \(T(\mathbf x)=\mathbf x+\mathbf a\) 는 선형 **아님**(원점 불보존).  
  (Affine = 선형 + 편향)
- **전이행렬 방향**: \([T]_{C\leftarrow B}\) 는 “**B좌표를 받아 C좌표로 내보냄**”이라는 의미.  
  이름-방향-곱셈순서 혼동 금지.
- **유사변환** \(S^{-1}AS\): **같은 공간, 같은 차원**의 **기저변경**일 때.  
  다른 차원(예: \(m\neq n\))이면 유사변환 개념 적용 안 됨.
- 수치안정성: \(S^{-1}\) 직접 구하지 말고 **선형계 풀이**(\(Sx=b\)) 사용 권장.

---

## 11. 추가 예시 스케치 (아이디어)

- **대각화**: 고유기저 \(V=[\mathbf v_1\cdots\mathbf v_n]\) 가 있으면  
  \([T]_{V\leftarrow V}=\mathrm{diag}(\lambda_1,\ldots,\lambda_n)\).
- **정규직교 기저(QR)**: \(A=QR\) 이면 \(Q\) 기저에서 \([A]=R\) (상삼각) 형태로 간단화.
- **직교변환**: 정규직교 기저에서 행렬이 **회전/반사**의 단순 블록으로.

---

## 12. 요약 표

| 주제 | 핵심 공식/메시지 |
|---|---|
| 표준기저 표현 | \(A=[T(\mathbf e_1)\ \cdots\ T(\mathbf e_n)]\) |
| 임의 기저 표현 | \([T]_{C\leftarrow B}=S_C^{-1}AS_B\) |
| 합성 | \([S\circ T]_{D\leftarrow B}=[S]_{D\leftarrow C}[T]_{C\leftarrow B}\) |
| 역 | \([T^{-1}]_{B\leftarrow C}=\big([T]_{C\leftarrow B}\big)^{-1}\) |
| 좋은 기저의 힘 | 구조(대각/블록)가 **눈에 보인다** |