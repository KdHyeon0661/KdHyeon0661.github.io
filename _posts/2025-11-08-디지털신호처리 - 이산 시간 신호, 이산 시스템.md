---
layout: post
title: 디지털신호처리 - 이산 시간 신호, 이산 시스템
date: 2025-11-08 15:25:23 +0900
category: 디지털신호처리
---
# 이산 시간 신호, 이산 시스템

## 이산 시간 신호의 정의와 기본 표기

### 정의

- 이산 시간 신호는 정수 인덱스 집합에서의 함수:
  $$
  x[n] : \mathbb{Z} \rightarrow \mathbb{R}\ \text{또는}\ \mathbb{C}.
  $$
- 연속시간 \(x(t)\)를 샘플 주기 \(T_s=1/F_s\)로 샘플링:
  $$
  x[n] = x(nT_s).
  $$

### 대표 기저 신호

- 단위 임펄스:
  $$
  \delta[n] = \begin{cases}1,& n=0\\0,& n\neq 0\end{cases}
  $$
- 단위 계단:
  $$
  u[n] = \begin{cases}1,& n\ge 0\\0,& n<0\end{cases}
  $$
- 복소 지수, 실수 사인/코사인:
  $$
  e^{j\omega_0 n},\quad \cos(\omega_0 n),\ \sin(\omega_0 n).
  $$
- 임펄스 전개(샘플-홀드 직관의 핵심):
  $$
  x[n] = \sum_{k=-\infty}^{\infty} x[k]\ \delta[n-k].
  $$

### 신호 연산

- 시프트/반전/스케일/결합:
  $$
  x[n-n_0],\ \ x[-n],\ \ a\,x[n],\ \ y[n]=a\,x[n]+b\,v[n].
  $$

### 에너지/전력 및 Parseval

- 에너지 신호:
  $$
  E_x=\sum_{n=-\infty}^{\infty}|x[n]|^2<\infty.
  $$
- 전력 신호(평균 전력):
  $$
  P_x = \lim_{N\to\infty}\frac{1}{2N+1}\sum_{n=-N}^{N}|x[n]|^2.
  $$
- Parseval(에너지 보존, DTFT \(X(e^{j\omega})\)):
  $$
  \sum_{n=-\infty}^{\infty}|x[n]|^2=\frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2\,d\omega.
  $$

### 정규화 주파수와 주기성(중요 보강)

- 이산시간 복소지수는 **단위원 주기성**을 갖는다:
  $$
  e^{j(\omega+2\pi)m n}=e^{j\omega n}\quad(\forall m\in\mathbb{Z}).
  $$
- 따라서 **정규화 주파수** \(\omega\)는 \([-\pi,\pi)\)로 족하다. 샘플링 주파수 \(F_s\)와 연계하면:
  $$
  \omega = 2\pi\frac{f}{F_s},\quad f\in[-\tfrac{F_s}{2},\tfrac{F_s}{2}).
  $$
- **위상 동치**: \(\omega\)와 \(\omega+2\pi k\)는 동일한 파형을 만든다.

### 짝/홀 분해, 실/복소 대칭

- 임의 신호의 짝/홀 분해:
  $$
  x_e[n]=\frac{x[n]+x[-n]}{2},\quad x_o[n]=\frac{x[n]-x[-n]}{2}.
  $$
- 실수 신호의 DTFT는 공액대칭:
  $$
  X(e^{j\omega}) = \overline{X(e^{-j\omega})}.
  $$

#### 실습 1: 기본 신호/연산 시각화

```octave
clear; close all; clc
N=10; n=-N:N;

delta = (n==0);
u     = (n>=0);
omega0 = pi/4;
x1 = cos(omega0*n);

subplot(2,2,1); stem(n, delta, 'filled'); title('delta[n]'); grid on
subplot(2,2,2); stem(n, u, 'filled');     title('u[n]'); grid on
subplot(2,2,3); stem(n, x1, 'filled');    title('cos(\omega_0 n), \omega_0=\pi/4'); grid on

x_shift = cos(omega0*(n-3));
x_flip  = cos(omega0*(-n));
subplot(2,2,4); hold on
stem(n, x1, 'filled'); stem(n, x_shift); stem(n, x_flip);
legend('orig','shift n-3','flip -n'); grid on; title('Shift & Flip');
```

---

## 이산 시스템: 정의와 분류

### 시스템 정의

- 시스템 \(\mathcal{T}\):
  $$
  y[n]=\mathcal{T}\{x[n]\}.
  $$

### 분류 기준(선형·시불변·인과·BIBO) + 기타 성질

- 선형성:
  $$
  \mathcal{T}\{a x_1[n]+b x_2[n]\}=a\,\mathcal{T}\{x_1[n]\}+b\,\mathcal{T}\{x_2[n]\}.
  $$
- 시불변성:
  $$
  \mathcal{T}\{x[n-n_0]\}=y[n-n_0].
  $$
- 인과성: \(y[n]\)은 \(n'\le n\)의 입력만 사용.
- BIBO 안정:
  $$
  |x[n]|\le B_x<\infty\Rightarrow |y[n]|\le B_y<\infty.
  $$
- **추가**: 기억성(메모리) 유무, 가역성(역시스템 존재), 단조/비단조, 비선형 왜곡 등.

#### 실습 2: 선형/시불변 여부를 수치로 점검

```octave
% y[n] = x[n] + 0.5*x[n-1]^2  (비선형 예)
N=40; n=0:N;
x1=randn(size(n)); x2=randn(size(n));
sys = @(x) [x(1), x(2:end) + 0.5*(x(1:end-1).^2)];

a=1.2; b=-0.7;
lhs = sys(a*x1 + b*x2);
rhs = a*sys(x1) + b*sys(x2);
fprintf('Linearity error (norm): %g\n', norm(lhs - rhs));

n0=3; z = zeros(1,n0);
x_shift = [z, x1(1:end-n0)];
y1 = sys(x1); y2 = sys(x_shift);
y1_shift = [z, y1(1:end-n0)];
fprintf('Time invariance error (norm): %g\n', norm(y2 - y1_shift));
```

---

## LTI 시스템의 3대 표상: 컨볼루션·차분방정식·주파수응답

### 컨볼루션

$$
y[n]=(x*h)[n]=\sum_{k=-\infty}^{\infty} x[k]\,h[n-k].
$$

### 선형 상수계수 차분방정식(LCDE)

$$
\sum_{m=0}^{M} a_m\,y[n-m] = \sum_{k=0}^{K} b_k\,x[n-k],\qquad a_0=1.
$$

### 주파수응답/전달함수

- DTFT:
  $$
  H(e^{j\omega})=\sum_{n=-\infty}^{\infty} h[n]\,e^{-j\omega n}.
  $$
- Z-변환(전달함수):
  $$
  H(z)=\frac{Y(z)}{X(z)}=\frac{\sum_{k=0}^{K} b_k z^{-k}}{1+\sum_{m=1}^{M} a_m z^{-m}}.
  $$
- 고유함수 성질:
  $$
  \mathcal{T}\{e^{j\omega n}\}=H(e^{j\omega})\,e^{j\omega n}.
  $$

#### 실습 3: 세 표상의 일치(임펄스, freqz, FFT)

```octave
pkg load signal
a = [1, -0.5]; b = 1;                 % y[n] = 0.5*y[n-1] + x[n]
N = 64; x = [1, zeros(1,N-1)];
h1 = filter(b, a, x);                 % h[n]
[H, w] = freqz(b, a, 512);
H_num = fft(h1, 512);

subplot(2,1,1); plot(w/pi, 20*log10(abs(H)+1e-12)); hold on
plot((0:511)/511, 20*log10(abs(H_num)+1e-12));
grid on; legend('freqz','FFT(h[n])'); ylabel('Mag [dB]'); xlabel('\omega/\pi');

subplot(2,1,2); plot(w/pi, unwrap(angle(H))); grid on
ylabel('Phase [rad]'); xlabel('\omega/\pi');
```

---

## 인과성·BIBO 안정성과 \(h[n]\), 극/영점

### 인과성

$$
h[n]=0\quad(n<0).
$$

### BIBO 안정성

- LTI에서 다음이 필요충분:
  $$
  \sum_{n=-\infty}^{\infty}|h[n]|<\infty.
  $$
- 유리형 \(H(z)\)인 IIR의 경우, 모든 폴이:
  $$
  |p_i|<1 \quad \text{(단위원 내부)}.
  $$

#### 실습 4: 극/영점과 안정성

```octave
a = [1, -1.4, 0.45];
b = [0.2, 0.2, 0.2];
p = roots(a); z = roots(b);
fprintf('max |pole| = %g\n', max(abs(p)));
```

---

## 차분방정식 해법: 자유응답·강제응답

- 표준형:
  $$
  y[n] - \sum_{m=1}^{M} a_m y[n-m] = \sum_{k=0}^{K} b_k x[n-k].
  $$
- 해 = **동차해(자유응답)** + **특해(강제응답)**.
- 동차해는 특성방정식
  $$
  r^{M}-\sum_{m=1}^{M} a_m r^{M-m}=0
  $$
  의 근 \(r_i\)로
  $$
  y_h[n] = \sum_i C_i\, r_i^n\quad(\text{중근이면 }n^s r^n \text{꼴}).
  $$
- 사인/코사인 입력(또는 \(e^{j\omega n}\))의 정상상태 특해:
  $$
  y_p[n]=|H(e^{j\omega})| \cos(\omega n + \angle H).
  $$

#### 실습 5: 초기조건(자유응답) 영향

```octave
pkg load signal
N=200; x=zeros(1,N); x(1)=1;
a=[1, -0.5]; b=1;

y0 = 10; yi = filtic(b,a, y0, 0);
y_ic = filter(b,a,x, yi);
y_zc = filter(b,a,x);

plot(0:N-1, y_zc, 'LineWidth',1.5); hold on
plot(0:N-1, y_ic, '--', 'LineWidth',1.5); grid on
legend('zero-IC','with-IC'); title('Initial condition effect');
```

---

## 컨볼루션: 선형/원형, 길이·경계·효율

### 선형 컨볼루션 길이

$$
N_y = N_x+N_h-1.
$$

### 원형 컨볼루션(DFT 기반)과 블록 처리

- DFT 길이 \(N\)에서의 곱은 **원형 컨볼루션**.
- 긴 신호는 **overlap-add (OLA)** 또는 **overlap-save (OLS)**로 처리.

#### 실습 6-1: 선형 vs 원형 컨볼루션

```octave
x = [1 2 3 4]; h = [1 -1 0.5];
y_lin = conv(x,h);
N = 4;
y_circ = ifft( fft(x,N).*fft(h,N) );
disp('linear vs circular (padded)'); disp([y_lin(:), y_circ(:)]);
```

#### 실습 6-2: Overlap-Add 스켈레톤

```octave
function y = ola_conv(x,h,L)
  Nfft = 2^nextpow2(L + numel(h) - 1);
  H = fft(h, Nfft);
  y = zeros(1, numel(x) + numel(h) - 1);
  idx = 1;
  while idx <= numel(x)
    xb = x(idx:min(idx+L-1, numel(x)));
    Yb = ifft( fft(xb, Nfft).*H );
    y(idx:idx+Nfft-1) += Yb;
    idx += L;
  end
  y = y(1:numel(x)+numel(h)-1);
end

% 테스트
x = randn(1,5000); h = fir1(63, 0.2);   % requires signal pkg
y1 = conv(x,h);
y2 = ola_conv(x,h, 256);
fprintf('OLA error: %g\n', norm(y1 - y2));
```

---

## DTFT와 주파수응답, 재구성 감각(DFT/창/누설)

### DTFT

$$
X(e^{j\omega})=\sum_{n=-\infty}^{\infty} x[n]\,e^{-j\omega n},\quad \omega\in[-\pi,\pi].
$$
역변환:
$$
x[n]=\frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^{j\omega})\,e^{j\omega n}\,d\omega.
$$

### DFT와의 관계(표본화 + 창)

- 유한구간 \(0\le n\le N-1\)에서의 DFT는 본질적으로 **창(사각창)**를 씌운 신호의 DTFT를 **\(\omega_k=2\pi k/N\)**에서 샘플링한 것:
  $$
  X[k] = \sum_{n=0}^{N-1} x[n] e^{-j2\pi kn/N}.
  $$
- 사각창의 주파수응답은 **sinc**형 → **스펙트럼 누설** 발생. 완화하려면 Hamming/Hann/Blackman 등 창 사용(메인로브 폭↔사이드로브 높이 트레이드오프).

### 군지연/위상지연, 선형위상 FIR

- 위상 \(\phi(\omega)=\arg H(e^{j\omega})\)에 대해:
  $$
  \tau_g(\omega)=-\frac{d\phi}{d\omega}\quad\text{(군지연)}.
  $$
- **선형위상 FIR**(대칭 계수)은 군지연이 대역 내 거의 상수 → 파형 왜곡 최소화.

#### 실습 7: FIR 응답·위상·군지연

```octave
pkg load signal
N=101; b=fir1(N-1, 0.3, hamming(N)); a=1;
[H,w]=freqz(b,a,2048);
dw=gradient(w); dphi=gradient(unwrap(angle(H)));
tau = -dphi ./ dw;

subplot(3,1,1); plot(w/pi, 20*log10(abs(H)+1e-12)); grid on; ylabel('Mag[dB]');
subplot(3,1,2); plot(w/pi, unwrap(angle(H))); grid on; ylabel('Phase[rad]');
subplot(3,1,3); plot(w/pi, tau); grid on; xlabel('\omega/\pi'); ylabel('Group delay');
```

---

## Z-변환과 ROC(수렴영역)

### Z-변환

$$
X(z)=\sum_{n=-\infty}^{\infty} x[n]\,z^{-n}.
$$
- **DTFT는** \(z=e^{j\omega}\)에 제한한 값:
  $$
  X(e^{j\omega})=X(z)\big|_{z=e^{j\omega}}.
  $$

### ROC 패턴(보강)

- 우측 신호(인과형): \(x[n]=a^n u[n]\)이면
  $$
  X(z)=\frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|>|a|.
  $$
- 좌측 신호(반인과): \(x[n]=-a^n u[-n-1]\)이면 ROC: \(|z|<|a|\).
- 양측 신호: ROC는 **고리형**(두 원 사이). **ROC는 극을 포함하지 않는다**가 핵심 규칙.
- **인과·안정** LTI(유리형)는 ROC가 가장 바깥 폴 밖이며 단위원을 포함해야 한다.

### 초기/최종값 정리(인과 안정 조건 가정)

- 초기값 정리:
  $$
  x[0]=\lim_{z\to\infty} X(z).
  $$
- 최종값 정리(적절한 조건하):
  $$
  \lim_{n\to\infty} x[n] = \lim_{z\to 1}(1-z^{-1})X(z).
  $$

#### 실습 8: 극·영점 맵과 주파수응답

```octave
pkg load signal
b = [0.2, -0.4, 0.2];
a = [1, -1.6, 0.99];
z = roots(b); p = roots(a);

theta = linspace(0,2*pi,1024);
zunit = exp(1j*theta);
H = polyval(fliplr(b), zunit.^-1) ./ polyval(fliplr(a), zunit.^-1);

subplot(1,2,1); plot(real(zunit), imag(zunit),'k--'); hold on
plot(real(z), imag(z), 'o'); plot(real(p), imag(p), 'x'); axis equal; grid on
legend('unit circle','zeros','poles'); title('Pole-Zero map');

subplot(1,2,2); plot(theta/pi, 20*log10(abs(H)+1e-12)); grid on
xlabel('\omega/\pi'); ylabel('Mag[dB]'); title('|H(e^{j\omega})|');
```

---

## 인과 LTI의 세 가지 입력 테스트: 임펄스·계단·지수

- 임펄스 \(\delta[n]\) → 임펄스응답 \(h[n]\).
- 계단 \(u[n]\) → 스텝응답 \(s[n]=\sum_{k=-\infty}^{n} h[k]\).
- 복소지수 \(e^{j\omega n}\) → 주파수응답 \(H(e^{j\omega})\).

#### 실습 9: 세 응답 비교

```octave
pkg load signal
b=fir1(80, 0.25, hamming(81)); a=1;
N=256; n=0:N-1;
imp = [1, zeros(1,N-1)];
u   = ones(1,N);
h = filter(b,a,imp);
s = filter(b,a,u);
omega0=pi/3; e = exp(1j*omega0*n); y = filter(b,a,e);
[H,w] = freqz(b,a,512);

subplot(2,2,1); stem(n,h,'filled'); title('h[n]'); grid on
subplot(2,2,2); plot(n,s); title('Step response'); grid on
subplot(2,2,3); plot(n, real(y)); title('Response to e^{j\omega_0 n}'); grid on
subplot(2,2,4); plot(w/pi, abs(H)); title('|H(e^{j\omega})|'); grid on
```

---

## 시간역/시스템 테스트와 수치 안정성(구현적 포인트)

### 속성 체크(인과·BIBO·TI)

- 인과성: \(h[n]=0\ (n<0)\).
- BIBO: \(\sum|h[n]|<\infty\) 또는 IIR 폴 반경 \(<1\).
- TI: 입·출력 동시 시프트 테스트.

#### 실습 10: BIBO 체크

```octave
pkg load signal
[b,a] = butter(4, 0.3);
N=2048; h = impz(b,a,N);
S = sum(abs(h));
fprintf('sum |h[n]| = %g\n', S);
```

### 필터 구조와 고정소수점/양자화

- **Direct Form II** 고차 IIR은 수치 민감. **직렬/병렬 분해**, **바이쿼드(2차 섹션)**, **스케일링** 권장.
- **양자화 노이즈**(계수/상태/출력)와 **오버플로** 방지: 워드길이/스케일 설계.
- **filtfilt**(양방향 필터링)로 위상 왜곡 최소화(경계 효과 주의).

---

## 예제 시나리오: 잡음 억제 파이프라인

- 문제: 센서 시계열의 고주파 잡음 + 느린 드리프트 제거.
- 방법: 저역 FIR(잡음 억제) → 하이패스 IIR(드리프트 제거).

```octave
pkg load signal
Fs=200; t=(0:1/Fs:300)';        % 5분
x = 0.5*sin(2*pi*0.5*t) + 0.05*randn(size(t)) + 0.002*t;

N=129; b_lp=fir1(N-1, 5/(Fs/2), hamming(N)); a_lp=1;
x1 = filtfilt(b_lp, a_lp, x);

[b_hp,a_hp] = butter(3, 0.02/(Fs/2), 'high');
y = filtfilt(b_hp, a_hp, x1);

plot(t, [x x1 y]); grid on
legend('raw','LPF','LPF+HPF'); xlabel('s'); title('Noise & drift removal');
```

---

## LTI의 **식별** 감각

- 흰잡음 \(w[n]\) 입력 → 출력 \(y[n]\). 자기/교차상관으로 임펄스응답 추정:
  $$
  r_{wy}[m] \approx \sigma_w^2\, h[m],\quad (\text{화이트 } w[n]).
  $$
- ARX/AR/MA/ARMA 모델 추정을 통해 \(h[n]\) 또는 \(H(z)\) 매개변수화 가능(최소자승/예측오차 기준).

```octave
% 매우 거친 직관 실습: 화이트 입력으로 h[n] 근사
pkg load signal
[b,a] = butter(2, 0.3);
N=4096; w = randn(1,N);
y = filter(b,a,w);
L=200;            % 추정 길이
rwy = xcorr(w,y,L,'unbiased');   % index shift: [-L..L]
h_est = rwy(L+1:end) / var(w);   % 대략적 h 추정
h_true = impz(b,a,L+1);

plot(0:L, [h_true(:), h_est(:)]); grid on
legend('true h','estimated h (rough)');
title('Impulse response estimation via cross-correlation');
```

---

## 디버깅·검증 체크리스트

1. **주파수 단위**: \(\omega\)(rad/sample), \(f\)(Hz), \(\omega=2\pi f/F_s\).
2. **단위원 주기성**: \(\omega\)와 \(\omega+2\pi k\) 동일.
3. **경계효과**: `conv` 모드, `filter` 초기조건, `filtfilt`의 패딩.
4. **윈도우/누설**: 창 선택은 해상도 ↔ 누설 절충.
5. **폴 반경**: IIR 설계 후 반드시 \( |p_i|<1 \) 확인.
6. **구조 선택**: 고차 IIR은 2차 섹션/스케일링으로 안정화.
7. **DFT 해석**: 제곱합 정규화/제로패딩/주파수 해상도 \(\Delta f = F_s/N\).

---

## 요약

- 이산 신호는 정수 인덱스에서 정의되며, **단위원 주기성**을 가진 복소지수가 핵심 기저다.
- **LTI**는 \(h[n]\)·LCDE·\(H(z),H(e^{j\omega})\)가 동치이며, 컨볼루션이 기본 연산이다.
- **인과·BIBO**: \(h[n]\)의 지지/절대합, 또는 폴의 단위원 내 존재로 판정한다.
- **DTFT↔DFT**: DFT는 창+표본화로 이해, 창 선택은 누설/해상도에 직결된다.
- **Z-변환/ROC**: 신호의 좌/우/양측성에 따라 ROC 패턴이 정해지며, 인과·안정 LTI는 ROC가 바깥 폴 밖·단위원 포함을 만족해야 한다.
- 구현 시 **수치 안정성/양자화/블록 컨볼루션**과 같은 실무 포인트가 중요하다.

---

## 부록 A) 핵심 수식 모음(보강 포함)

1. 임펄스 전개
   $$
   x[n]=\sum_k x[k]\ \delta[n-k].
   $$
2. 컨볼루션
   $$
   y[n]=\sum_k x[k]\,h[n-k].
   $$
3. DTFT/역변환
   $$
   X(e^{j\omega})=\sum_n x[n]e^{-j\omega n},\quad
   x[n]=\frac{1}{2\pi}\int_{-\pi}^{\pi}X(e^{j\omega})e^{j\omega n}d\omega.
   $$
4. Z-변환/전달함수
   $$
   X(z)=\sum_n x[n] z^{-n},\quad
   H(z)=\frac{\sum_{k=0}^K b_k z^{-k}}{1+\sum_{m=1}^M a_m z^{-m}}.
   $$
5. BIBO 안정성(LTI)
   $$
   \sum_n |h[n]|<\infty.
   $$
6. DFT
   $$
   X[k]=\sum_{n=0}^{N-1} x[n] e^{-j2\pi kn/N}.
   $$
7. 파서발(에너지 보존)
   $$
   \sum_n|x[n]|^2=\frac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\omega})|^2 d\omega.
   $$

---

## 부록 B) 간단 실습 세트(바로 실행, 보강)

```octave
% 1) LTI 고유함수 검증
pkg load signal
[b,a] = butter(3, 0.4);
N=256; n=0:N-1; w0=pi/5;
x = exp(1j*w0*n); y = filter(b,a,x);
[H,~]=freqz(b,a,[w0]);
fprintf('||y||/||x|| ~ |H| : %g vs %g\n', norm(y)/norm(x), abs(H(1)));

% 2) conv vs filter 동치
h = fir1(40, 0.3);
x = randn(1,300);
y1 = conv(x,h,'same');
y2 = filter(h,1,x);
fprintf('conv vs filter error: %g\n', norm(y1 - y2));

% 3) 극 반경으로 안정성 힌트
[~,a] = butter(6, 0.2);
p = roots(a); fprintf('max |pole| = %g\n', max(abs(p)));

% 4) 창에 따른 스펙트럼 누설 비교
N=256; n=0:N-1; f0=0.12; x = cos(2*pi*f0*n);
X_rect = fft(x.*ones(size(x)));
X_ham  = fft(x.*hamming(N).');
figure; plot((0:N-1)/N, 20*log10(abs([X_rect(:), X_ham(:)])+1e-12));
grid on; legend('rect','hamming'); xlabel('Normalized f'); ylabel('Mag[dB]');
title('Leakage: rectangular vs hamming');

% 5) 블록 컨볼루션(OLA) 검증
x = randn(1,6000); h = fir1(63, 0.2);
y_full = conv(x,h);
function y = ola_conv(x,h,L)
  Nfft = 2^nextpow2(L + numel(h) - 1);
  H = fft(h, Nfft); y = zeros(1, numel(x) + numel(h) - 1);
  idx = 1;
  while idx <= numel(x)
    xb = x(idx:min(idx+L-1, numel(x)));
    Yb = ifft( fft(xb, Nfft).*H );
    y(idx:idx+Nfft-1) += Yb;
    idx += L;
  end
  y = y(1:numel(x)+numel(h)-1);
end
y_ola = ola_conv(x,h,256);
fprintf('OLA conv error: %g\n', norm(y_full - y_ola));
```
