---
layout: post
title: C++ - ì˜ˆì™¸ì²˜ë¦¬
date: 2024-10-01 19:20:23 +0900
category: Cpp
---
# ì˜ˆì™¸ ì²˜ë¦¬ : `try`, `catch`, `throw`, ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸

## 1. ì˜ˆì™¸ ì²˜ë¦¬ë€?

- **ëª©í‘œ**: ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí•´ë„ í”„ë¡œê·¸ë¨ì„ â€œê¹¨ë—ì´â€ **ì •ë¦¬**í•˜ê³ , **í•œ ê³³ì—ì„œ ì˜ë¯¸ ìˆê²Œ ì²˜ë¦¬**.
- **í‚¤ì›Œë“œ**: `try`(ë³´í˜¸ êµ¬ì—­), `throw`(ì˜ˆì™¸ ë°œìƒ), `catch`(ì˜ˆì™¸ ì²˜ë¦¬).

```cpp
try {
    // ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì½”ë“œ
    if (/* ì˜¤ë¥˜ ì¡°ê±´ */) {
        throw std::runtime_error("ì„¤ëª… ê°€ëŠ¥í•œ ì‹¤íŒ¨!");
    }
    // ...
}
catch (const std::exception& e) {      // í‘œì¤€ ì˜ˆì™¸ ê³µí†µ ì²˜ë¦¬
    std::cerr << "[ì—ëŸ¬] " << e.what() << "\n";
}
catch (...) {                           // ë§ˆì§€ë§‰ ìˆ˜ë‹¨: ì–´ë–¤ íƒ€ì…ì´ë“ 
    std::cerr << "[ì•Œ ìˆ˜ ì—†ëŠ” ì˜ˆì™¸]\n";
}
```

**ì›ì¹™**: *throw by value, catch by (const) reference* â€” ê°’ìœ¼ë¡œ ë˜ì§€ê³ , (const) ì°¸ì¡°ë¡œ ë°›ëŠ”ë‹¤.

---

## 2. ê¸°ë³¸ ë¬¸ë²•ê³¼ íë¦„

### 2.1 ê¸°ë³¸ ë¬¸ë²•

```cpp
try {
    throw "ì˜ˆì™¸ ë°œìƒ!";   // C-ë¬¸ìì—´ì„ ë˜ì§(ë¹„ê¶Œì¥: std::exception ê³„ì—´ ê¶Œì¥)
}
catch (const char* msg) {
    std::cerr << "ì˜¤ë¥˜: " << msg << "\n";
}
```

### 2.2 ë‹¤ì–‘í•œ ì˜ˆì™¸ íƒ€ì…

```cpp
throw 42;                               // ì›ì‹œí˜• (ê¶Œì¥X)
throw std::runtime_error("ëŸ°íƒ€ì„");     // í‘œì¤€ ì˜ˆì™¸ (ê¶Œì¥)
throw std::string("ë¬¸ìì—´ ì˜ˆì™¸");        // ì‚¬ìš©ì íƒ€ì…
```

**catch ìˆœì„œ ì¤‘ìš”**: ë” **êµ¬ì²´ì (íŒŒìƒ)** â†’ ë” **ì¼ë°˜ì (ê¸°ë°˜)** ìˆœì„œ.

```cpp
try {
    throw std::out_of_range("ë²—ì–´ë‚¨");
}
catch (const std::logic_error& e) {     // âœ… ë¨¼ì €: íŒŒìƒ/êµ¬ì²´
    std::cerr << "ë…¼ë¦¬ ì˜¤ë¥˜: " << e.what() << "\n";
}
catch (const std::exception& e) {       // ê·¸ ë‹¤ìŒ: ê¸°ë°˜/ì¼ë°˜
    std::cerr << "ì¼ë°˜ ì˜¤ë¥˜: " << e.what() << "\n";
}
```

### 2.3 ì¬ë˜ì§€ê¸°(rethrow)

```cpp
try {
    // í•˜ìœ„ ë ˆì´ì–´
    throw std::runtime_error("DB ì—°ê²° ì‹¤íŒ¨");
}
catch (const std::exception& e) {
    // ë¡œê¹…, ë¬¸ë§¥ ì²¨ê°€ ë“±
    std::cerr << "[í•˜ìœ„ ë ˆì´ì–´] " << e.what() << "\n";
    throw; // ğŸ’¡ ê°™ì€ ì˜ˆì™¸ë¥¼ ê·¸ëŒ€ë¡œ ìƒìœ„ë¡œ ì „ë‹¬ (ìŠ¤íƒ/what ìœ ì§€)
}
```

> `throw;` ë§Œì´ **ì›ë˜ ìŠ¤íƒ ì •ë³´ì™€ what()**ì„ ìœ ì§€í•©ë‹ˆë‹¤. `throw e;` ëŠ” **ë³µì‚¬**ë˜ì–´ ì •ë³´ ì†ì‹¤ ìœ„í—˜.

---

## 3. í‘œì¤€ ì˜ˆì™¸ ê³„ì¸µ í•œëˆˆì—

í—¤ë”: `<stdexcept>`, `<system_error>`, `<new>`, `<typeinfo>` ë“±

| ê³„ì—´             | ì£¼ìš” íƒ€ì…(ì˜ˆ)                                      | ì˜ë¯¸/ìš©ë¡€                                     |
|------------------|-----------------------------------------------------|-----------------------------------------------|
| `std::exception` | ëª¨ë“  í‘œì¤€ ì˜ˆì™¸ì˜ ê¸°ë°˜                              | `what()` ê°€ìƒ í•¨ìˆ˜                             |
| ë…¼ë¦¬ ì˜¤ë¥˜        | `logic_error` â†’ `invalid_argument`, `out_of_range` | í˜¸ì¶œ ì „ì œ ìœ„ë°˜/ì‚¬ì „ì¡°ê±´ ì‹¤íŒ¨                   |
| ëŸ°íƒ€ì„ ì˜¤ë¥˜      | `runtime_error`, `range_error`, `overflow_error`   | ì™¸ë¶€ í™˜ê²½/ì‹¤í–‰ ì‹œì  ì‹¤íŒ¨                       |
| ë©”ëª¨ë¦¬           | `bad_alloc`                                        | `new` ì‹¤íŒ¨                                    |
| í˜•ë³€í™˜           | `bad_cast`, `bad_typeid`                           | RTTI ê´€ë ¨ ì‹¤íŒ¨                                 |
| ì‹œìŠ¤í…œ ì˜¤ë¥˜      | `system_error` + `std::error_code`                  | OS/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜¤ë¥˜ ì½”ë“œì™€ í•¨ê»˜ ì „ë‹¬            |

```cpp
try {
    std::vector<int> v;
    v.at(5); // ë²”ìœ„ ì²´í¬ â†’ out_of_range
}
catch (const std::out_of_range& e) {
    std::cerr << "ë²”ìœ„ ì˜¤ë¥˜: " << e.what() << "\n";
}
```

---

## 4. ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸

ë„ë©”ì¸ì— ë§ëŠ” ì •ë³´ë¥¼ ë‹´ì•„ **ì˜ë¯¸ ìˆëŠ” ì²˜ë¦¬**ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
ê´€ë¡€ì ìœ¼ë¡œ `std::exception`(í˜¹ì€ íŒŒìƒ)ì—ì„œ ìƒì†.

```cpp
#include <stdexcept>
#include <string>

class HttpError : public std::runtime_error {
    int code_;
    std::string url_;
public:
    HttpError(int code, std::string url, std::string msg)
        : std::runtime_error(std::move(msg)), code_(code), url_(std::move(url)) {}

    int code() const noexcept { return code_; }
    const std::string& url() const noexcept { return url_; }
};

void fetch(const std::string& url) {
    // ...
    throw HttpError(404, url, "Not Found");
}

int main() {
    try {
        fetch("https://example.com/x");
    } catch (const HttpError& e) {
        std::cerr << "HTTP(" << e.code() << ") " << e.url() << ": " << e.what() << "\n";
    }
}
```

> `what()`ì€ `const char*`ë¥¼ ë°˜í™˜í•´ì•¼ í•˜ë¯€ë¡œ, ë©”ì‹œì§€ëŠ” ê¸°ë°˜ í´ë˜ìŠ¤ì— ì „ë‹¬/ë³´ê´€í•˜ëŠ” ë°©ì‹ì´ í”í•©ë‹ˆë‹¤.

---

## 5. RAIIì™€ ìŠ¤íƒ ì–¸ì™€ì¸ë”©

ì˜ˆì™¸ê°€ ë˜ì ¸ì§€ë©´ **ìŠ¤íƒ í”„ë ˆì„ì´ ì—­ë°©í–¥ìœ¼ë¡œ íŒŒê´´**(ì–¸ì™€ì¸ë”©)ë˜ë©´ì„œ, **ëª¨ë“  ì§€ì—­ ê°ì²´ì˜ ì†Œë©¸ì**ê°€ í˜¸ì¶œë©ë‹ˆë‹¤.
ë”°ë¼ì„œ **RAII(ìì›ì€ ê°ì²´ ìˆ˜ëª…ì— ë¬¶ëŠ”ë‹¤)**ë¥¼ ì“°ë©´ ì˜ˆì™¸ ìƒí™©ì—ì„œë„ ìì› ëˆ„ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.

```cpp
#include <fstream>
#include <stdexcept>

void save_text(const std::string& path, const std::string& body) {
    std::ofstream out(path);            // ì—´ë¦¼
    if (!out) throw std::runtime_error("íŒŒì¼ ì—´ê¸° ì‹¤íŒ¨");
    out << body;                        // ì“°ê¸° ì¤‘ ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥
}                                       // out ì†Œë©¸ â†’ ìë™ close()
```

**ê¸ˆì§€**: ì†Œë©¸ìì—ì„œ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ë§ ê²ƒ(í”„ë¡œê·¸ë¨ `std::terminate`).
ë¶ˆê°€í”¼í•˜ë‹¤ë©´ **ì†Œë©¸ì ë‚´ë¶€ì—ì„œ ì¡ì•„ì„œ ì‚¼í‚¤ê±°ë‚˜ ë¡œê¹…**í•˜ì„¸ìš”.

---

## 6. ì˜ˆì™¸ ì•ˆì „ ë³´ì¥(ì„¸ ê°€ì§€ ë ˆë²¨)

ì˜ˆì™¸ê°€ ë°œìƒí•´ë„ ìë£Œêµ¬ì¡° ë¶ˆë³€ì‹ì„ ë³´ì¥í•´ì•¼ í•©ë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ì„¸ ìˆ˜ì¤€:

| ìˆ˜ì¤€               | ì˜ë¯¸                                                                                      |
|--------------------|-------------------------------------------------------------------------------------------|
| **no-throw**       | ì˜ˆì™¸ê°€ ì ˆëŒ€ ë°œìƒí•˜ì§€ ì•ŠìŒ (ì„±ê³µ ë³´ì¥)                                                    |
| **strong**         | ì‹¤íŒ¨ ì‹œ **ì›ìì„±** ë³´ì¥: í˜¸ì¶œ ì „ ìƒíƒœë¡œ ì™„ë²½ ë³µê·€                                         |
| **basic**          | ë¶ˆë³€ì‹ì€ ìœ ì§€, ì¼ë¶€ ìƒíƒœ/ìì›ì€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë‚˜ **ëˆ„ìˆ˜ ì—†ìŒ**                           |

### 6.1 Strong ë³´ì¥ì„ ìœ„í•œ Copy/Swap íŒ¨í„´

```cpp
#include <vector>
#include <algorithm>

class Numbers {
    std::vector<int> v_;
public:
    void push_sorted(int x) {
        Numbers backup = *this;               // ë³µì‚¬ (ì—¬ê¸°ì„œ ì˜ˆì™¸ ê°€ëŠ¥)
        auto tmp = v_;
        tmp.push_back(x);                     // ì˜ˆì™¸ ê°€ëŠ¥
        std::sort(tmp.begin(), tmp.end());    // ì˜ˆì™¸ ê°€ëŠ¥
        v_.swap(tmp);                         // ì»¤ë°‹: ì—¬ê¸°ê¹Œì§€ ì˜¤ë©´ ì˜ˆì™¸ ì—†ì´ êµì²´
    }
};
```

**ì•„ì´ë””ì–´**: ì‹¤íŒ¨ ê°€ëŠ¥ ì‘ì—…ì€ **ì„ì‹œ ê°ì²´**ì—ì„œ ìˆ˜í–‰ â†’ ë§ˆì§€ë§‰ì— ì»¤ë°‹(swap).

---

## 7. `noexcept`ì™€ ì´ë™ ì˜ë¯¸ë¡ 

`noexcept`ëŠ” í•¨ìˆ˜ê°€ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠìŒì„ **ì„ ì–¸/í‘œí˜„**í•©ë‹ˆë‹¤.

```cpp
void f() noexcept;                // fëŠ” ë˜ì§€ì§€ ì•ŠìŒ
bool g() noexcept(false);         // ë˜ì§ˆ ìˆ˜ ìˆìŒ(ê¸°ë³¸)
```

- **ì»¨í…Œì´ë„ˆ ìµœì í™”**: íƒ€ì…ì˜ **ì´ë™ ìƒì„±/ëŒ€ì…**ì´ `noexcept`ë©´, `std::vector` ì¬í• ë‹¹ ì‹œ **ë³µì‚¬ ëŒ€ì‹  ì´ë™** ì‚¬ìš© â†’ ì„±ëŠ¥ í–¥ìƒ.

```cpp
struct Big {
    Big() = default;
    Big(Big&&) noexcept { /* ë¹ ë¥¸ ì´ë™ */ } // noexceptê°€ í•µì‹¬
    Big(const Big&) { /* ë¹„ì‹¸ê±°ë‚˜ ê¸ˆì§€ */ }
};
```

- `noexcept(expr)`: **ì»´íŒŒì¼ íƒ€ì„ íŒë‹¨**. `expr`ì´ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´ `true`.

```cpp
template <class T>
void reallocate(std::vector<T>& v) noexcept(noexcept(T(std::declval<T&&>()))) {
    // Tì˜ ì´ë™ ìƒì„±ìê°€ noexceptë©´ ì´ í•¨ìˆ˜ë„ noexcept
}
```

- **ì†Œë©¸ì**ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `noexcept(true)` â€” ë˜ì§€ë©´ `std::terminate()`.

---

## 8. ìŠ¤íŠ¸ë¦¼ê³¼ ì˜ˆì™¸

I/O ìŠ¤íŠ¸ë¦¼ì€ **ìƒíƒœ ë¹„íŠ¸**ë¡œ ì˜¤ë¥˜ë¥¼ í‘œí˜„í•˜ì§€ë§Œ, **ì˜ˆì™¸ ëª¨ë“œ**ë¡œë„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```cpp
#include <fstream>
#include <iostream>

int main() {
    std::ifstream fin;
    fin.exceptions(std::ifstream::failbit | std::ifstream::badbit);
    try {
        fin.open("data.txt");         // ì‹¤íŒ¨ ì‹œ ios_base::failure
        int x; fin >> x;
        std::cout << x << "\n";
    } catch (const std::ios_base::failure& e) {
        std::cerr << "I/O ì‹¤íŒ¨: " << e.what() << "\n";
    }
}
```

---

## 9. ì˜ˆì™¸ ì²´ì´ë‹: ì›ì¸ ë³´ì¡´

C++ëŠ” **nested exception** ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤.

```cpp
#include <exception>
#include <stdexcept>
#include <iostream>

void low() {
    throw std::runtime_error("Low-level fail");
}
void mid() {
    try { low(); }
    catch (...) {
        std::throw_with_nested(std::runtime_error("Mid-level context"));
    }
}
int main() {
    try { mid(); }
    catch (const std::exception& e) {
        std::cerr << "Top: " << e.what() << "\n";
        try { std::rethrow_if_nested(e); }
        catch (const std::exception& nested) {
            std::cerr << "Cause: " << nested.what() << "\n";
        }
    }
}
```

ì¶œë ¥ ì˜ˆ:
```
Top: Mid-level context
Cause: Low-level fail
```

---

## 10. ìŠ¤ë ˆë“œ ê°„ ì˜ˆì™¸ ì „ë‹¬: `exception_ptr`

ìŠ¤ë ˆë“œ ê²½ê³„ë¥¼ ë„˜ì–´ì„œ ì§ì ‘ ì˜ˆì™¸ê°€ ì „íŒŒë˜ì§„ ì•ŠìŠµë‹ˆë‹¤. **í¬ì°©í•´ì„œ ì „ë‹¬**í•´ì•¼ í•©ë‹ˆë‹¤.

```cpp
#include <thread>
#include <exception>
#include <iostream>

std::exception_ptr ep;

void worker() {
    try {
        throw std::runtime_error("ìŠ¤ë ˆë“œ ë‚´ë¶€ ì‹¤íŒ¨");
    } catch (...) {
        ep = std::current_exception(); // ì˜ˆì™¸ ìº¡ì²˜
    }
}

int main() {
    std::thread t(worker);
    t.join();
    if (ep) {
        try { std::rethrow_exception(ep); }
        catch (const std::exception& e) {
            std::cerr << "ë©”ì¸ì—ì„œ ì²˜ë¦¬: " << e.what() << "\n";
        }
    }
}
```

ë˜ëŠ” `std::promise`/`std::future`ë¥¼ í†µí•´ ì „ë‹¬.

---

## 11. ì˜ˆì™¸ vs ì˜¤ë¥˜ ì½”ë“œ (`std::error_code`, `std::expected`)

- **ì˜ˆì™¸**: ì˜¤ë¥˜ê°€ **ë¹„ì •ìƒì /í¬ê·€**í•˜ê³ , **ìƒìœ„ì—ì„œ ì¼ê´„ ì²˜ë¦¬**ê°€ ë°”ëŒì§í•  ë•Œ ìœ ë¦¬.
- **ì˜¤ë¥˜ ì½”ë“œ**: ì„±ëŠ¥ ë¯¼ê° ê²½ë¡œ/ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì‹¤íŒ¨(íŒŒì¼ ì—†ìŒ ë“±), ë¡œì»¬ ì¦‰ì‹œ ì²˜ë¦¬.

### 11.1 `std::error_code` (ì‹œìŠ¤í…œ/ë¼ì´ë¸ŒëŸ¬ë¦¬)

```cpp
#include <system_error>

std::error_code ec;
// OS í˜¸ì¶œ wrapperê°€ ecì— ì±„ì›Œì¤Œ
if (ec) {
    std::cerr << ec.message() << " (" << ec.value() << ")\n";
}
```

### 11.2 `std::expected` (C++23) â€” ì˜ˆì™¸ ì—†ëŠ” ê²°ê³¼/ì˜¤ë¥˜ ë¦¬í„´

```cpp
#include <expected>
#include <string>

std::expected<int, std::string> parse_int(const std::string& s) {
    try {
        return std::stoi(s);
    } catch (...) {
        return std::unexpected("ì •ìˆ˜ê°€ ì•„ë‹™ë‹ˆë‹¤");
    }
}

int main() {
    auto r = parse_int("xyz");
    if (r) std::cout << *r << "\n";
    else   std::cerr << "ì—ëŸ¬: " << r.error() << "\n";
}
```

> íŒ€ ê·œì¹™: **API ê²½ê³„**(ë°”ìš´ë”ë¦¬)ì—ì„œëŠ” ì˜ˆì™¸ â†’ ì˜¤ë¥˜ ì½”ë“œë¡œ ë³€í™˜/ë°˜í™˜(ë˜ëŠ” ê·¸ ì—­)ì„ ëª…í™•íˆ.

---

## 12. ì•ˆí‹°íŒ¨í„´ & ì£¼ì˜ì 

1. **ì†Œë©¸ìì—ì„œ throw**: ê¸ˆì§€. (ëŒ€ì‹  ë‚´ë¶€ì—ì„œ catch í›„ ë¡œê¹…)
2. **ìƒì„±ìì—ì„œ throw**ëŠ” OK (ë¶€ë¶„ ìƒì„± ê°ì²´ëŠ” ì•ˆì „í•˜ê²Œ ì •ë¦¬ë¨) â€” ë‹¨, ì´ë¯¸ íšë“í•œ ìì›ì€ **RAII**ë¡œ ê´€ë¦¬.
3. **ì˜ˆì™¸ ë‚¨ìš©**: ë¹ˆë²ˆí•œ ì‹¤íŒ¨ ê²½ë¡œ(ì˜ˆ: íŒŒì‹± ë£¨í”„)ì—” ë¶€ì í•©. ì„±ëŠ¥ê³¼ ê°€ë…ì„± ì €í•˜.
4. **ì˜ˆì™¸ ì¤‘ë¦½ì„±**: í…œí”Œë¦¿/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œëŠ” ì˜ˆì™¸ë¥¼ **ì‚¼í‚¤ì§€ ë§ê³  ê·¸ëŒ€ë¡œ ì „íŒŒ**(rethrow)í•˜ê±°ë‚˜ **ê³„ì¸µí™”**.
5. **ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°/ì»¨í…Œì´ë„ˆ**: `noexcept` ì´ë™ ì§€ì›ìœ¼ë¡œ ê°•í•œ ë³´ì¥/ì„±ëŠ¥ í™•ë³´.
6. **ì„ì–´ ì“°ê¸°**: `noexcept(false)` í•¨ìˆ˜ì—ì„œ ë‚´ë¶€ `noexcept` í•¨ìˆ˜ì˜ ì‹¤íŒ¨ë¥¼ **ì ì ˆíˆ ë˜í•‘**í•˜ë˜, ì •ë³´ ì†ì‹¤ ì£¼ì˜.

---

## 13. ì‹¤ì „ ì˜ˆì œ ëª¨ìŒ

### 13.1 ê²¬ê³ í•œ íŒŒì„œ: strong ë³´ì¥ + ë¬¸ë§¥ ì²¨ê°€

```cpp
#include <string>
#include <vector>
#include <sstream>
#include <stdexcept>

struct Record { int id; std::string name; };

std::vector<Record> parse_csv(const std::string& text) {
    std::vector<Record> out;          // strong ë³´ì¥ ìœ„í•´: ì‹¤íŒ¨ ì‹œ outì€ ë¹„ì–´ ìˆìŒ
    std::istringstream ss(text);
    std::string line;
    int lineno = 0;

    while (std::getline(ss, line)) {
        ++lineno;
        if (line.empty()) continue;

        std::istringstream row(line);
        std::string sid, name;
        if (!std::getline(row, sid, ',') || !std::getline(row, name))
            throw std::runtime_error("CSV í˜•ì‹ ì˜¤ë¥˜ @ line " + std::to_string(lineno));

        try {
            int id = std::stoi(sid);
            out.push_back(Record{ id, name });   // ì—¬ê¸°ê¹Œì§€ ì˜¤ë©´ ì»¤ë°‹
        } catch (const std::exception& e) {
            std::throw_with_nested(std::runtime_error(
                "ì •ìˆ˜ ë³€í™˜ ì‹¤íŒ¨ @ line " + std::to_string(lineno) + " (sid=" + sid + ")"));
        }
    }
    return out; // ì •ìƒ ê²°ê³¼ë§Œ ë°˜í™˜
}
```

### 13.2 ë¦¬ì†ŒìŠ¤ ë˜í¼: ì˜ˆì™¸ ì•ˆì „ RAII

```cpp
#include <cstdio>
#include <stdexcept>

class File {
    std::FILE* fp_{};
public:
    explicit File(const char* path, const char* mode) {
        fp_ = std::fopen(path, mode);
        if (!fp_) throw std::runtime_error("fopen ì‹¤íŒ¨");
    }
    ~File() noexcept { if (fp_) std::fclose(fp_); }
    std::FILE* get() const noexcept { return fp_; }

    // ë³µì‚¬ ê¸ˆì§€, ì´ë™ í—ˆìš©
    File(const File&) = delete;
    File& operator=(const File&) = delete;
    File(File&& o) noexcept : fp_(o.fp_) { o.fp_ = nullptr; }
    File& operator=(File&& o) noexcept {
        if (this != &o) { if (fp_) std::fclose(fp_); fp_ = o.fp_; o.fp_ = nullptr; }
        return *this;
    }
};
```

### 13.3 ì •ì±…: â€œë˜ì§€ê¸°-ëŠ¦ê²Œ ì¡ê¸°(Throw early, catch late)â€

```cpp
void repo_save(/*...*/) { /* êµ¬ì²´ì  ì‹¤íŒ¨ì—ì„œ ì¦‰ì‹œ throw */ }
void service_logic() { repo_save(); /* ... */ }       // ì „íŒŒ
int main() {
    try { service_logic(); }
    catch (const std::exception& e) {
        // ìµœìƒìœ„ì—ì„œ ì¼ê´„ ë¡œê¹…/ì‚¬ìš©ì ë©”ì‹œì§€
        std::cerr << "[Fatal] " << e.what() << "\n";
        return 1;
    }
}
```

---

## 14. ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **throw by value, catch by (const) reference**ë¥¼ ì§€ì¼°ëŠ”ê°€?
- [ ] **íŒŒìƒ â†’ ê¸°ë°˜** ìˆœì„œë¡œ `catch`ë¥¼ ë°°ì¹˜í–ˆëŠ”ê°€?
- [ ] **rethrowëŠ” `throw;`** ë¡œ í–ˆëŠ”ê°€? (`throw e;` ê¸ˆì§€)
- [ ] **RAII**(ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°/ë˜í¼)ë¡œ ìì›ì„ ê´€ë¦¬í•˜ëŠ”ê°€?
- [ ] APIì˜ **ì˜ˆì™¸ ì•ˆì „ ë³´ì¥** ìˆ˜ì¤€(basic/strong/no-throw)ì„ ë¬¸ì„œí™”í–ˆëŠ”ê°€?
- [ ] ì„±ëŠ¥ ë¯¼ê° ë£¨í”„/ê²½ê³„ì—ì„œëŠ” **ì˜ˆì™¸ ëŒ€ì‹  ì˜¤ë¥˜ ì½”ë“œ/`std::expected`**ë¥¼ ê³ ë ¤í–ˆëŠ”ê°€?
- [ ] ìŠ¤ë ˆë“œ ê²½ê³„ì—ëŠ” `std::exception_ptr`/`future`ë¡œ **ì˜ˆì™¸ë¥¼ ì „ë‹¬**í•˜ëŠ”ê°€?
- [ ] ê³µê°œ í•¨ìˆ˜ì˜ **`noexcept` ì ì •ì„±**(íŠ¹íˆ ì´ë™/ì†Œë©¸ì)ì„ ì ê²€í–ˆëŠ”ê°€?
- [ ] ì†Œë©¸ìì—ì„œ **ì˜ˆì™¸ë¥¼ ì‚¼í‚¤ë„ë¡** ë°©ì–´í–ˆëŠ”ê°€?

---

## 15. ìš”ì•½

- C++ ì˜ˆì™¸ëŠ” **ì–¸ì™€ì¸ë”© + RAII**ë¡œ ìì› ì •ë¦¬ë¥¼ ìë™í™”í•˜ê³ , ì˜¤ë¥˜ ì²˜ë¦¬ ì½”ë“œë¥¼ **ë¶„ë¦¬/ë‹¨ìˆœí™”**í•©ë‹ˆë‹¤.
- í‘œì¤€ ì˜ˆì™¸ ê³„ì¸µì„ í™œìš©í•˜ê³ , ë„ë©”ì¸ì— ë§ëŠ” **ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸**ë¡œ ì˜ë¯¸ë¥¼ ê°•í™”í•˜ì„¸ìš”.
- **ì˜ˆì™¸ ì•ˆì „ ë³´ì¥**ê³¼ **`noexcept` ì„¤ê³„**ëŠ” ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ë™ì‹œì— ì¢Œìš°í•©ë‹ˆë‹¤.
- ìŠ¤ë ˆë“œ/ê²½ê³„/ì„±ëŠ¥ ì‹œë‚˜ë¦¬ì˜¤ì—ì„  **`error_code`/`expected`**ì™€ì˜ **ì „ëµì  í˜¼ìš©**ì´ ì‹¤ìš©ì ì…ë‹ˆë‹¤.

ì´ì œ ì—¬ëŸ¬ë¶„ì˜ ì½”ë“œë² ì´ìŠ¤ì—ì„œ **ë˜ì§ˆ ê³³ê³¼ ì¡ì„ ê³³**, **ë³´ì¥ ìˆ˜ì¤€**, **ìì› ê´€ë¦¬ ë°©ì‹**ì„ ëª…í™•íˆ ì •ì˜í•´ ë³´ì„¸ìš”.
ì˜ˆì™¸ëŠ” â€œë¬´ì„­ê¸° ë•Œë¬¸ì´ ì•„ë‹ˆë¼, **ê·œì¹™ì„ ì„¸ìš°ì§€ ì•Šìœ¼ë©´** ë¬´ì„œì›Œì§€ëŠ”â€ ê¸°ëŠ¥ì…ë‹ˆë‹¤.
