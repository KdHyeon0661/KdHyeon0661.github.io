---
layout: post
title: 미적분 - 벡터에 대한 미분적분학적 관점
date: 2025-08-25 15:20:23 +0900
category: 미적분
---
# 벡터에 대한 미분적분학적 관점

## 0. 표기·전제

- 벡터는 굵은체 $$\mathbf{v}$$ 또는 화살표 $$\vec v$$ 로 적는다.
- 함수의 정의역은 명시 없으면 실수 공간(예: $$\mathbb{R}^n$$)으로 본다.
- 미분가능성(C¹ 이상), 적분구간의 유계성 등은 문맥에 따라 가정한다.

---

## 1. 벡터의 기초 개념 (요약·보강)

### 1.1 벡터, 노름, 각도
- 벡터: $$\mathbf{v}=(v_1,\dots,v_n)^\top.$$
- 노름: $$\lVert\mathbf{v}\rVert=\sqrt{\sum_i v_i^2}.$$
- 내적: $$\mathbf{a}\cdot\mathbf{b}=\sum_i a_i b_i=\lVert\mathbf{a}\rVert\lVert\mathbf{b}\rVert\cos\theta.$$

### 1.2 외적(3차원)
- $$\mathbf{a}\times\mathbf{b}$$: 두 벡터에 수직, 크기는 평행사변형 넓이.

### 1.3 정사영(Projection)
- $$\operatorname{proj}_{\mathbf{u}}\mathbf{v}=\dfrac{\mathbf{v}\cdot\mathbf{u}}{\lVert\mathbf{u}\rVert^2}\,\mathbf{u}.$$

---

## 2. 벡터함수(Vector-valued Functions)와 운동학

### 2.1 정의와 미분
- 궤적: $$\mathbf{r}(t)=(x(t),y(t),z(t)),$$ 속도 $$\mathbf{v}(t)=\mathbf{r}'(t),$$ 가속도 $$\mathbf{a}(t)=\mathbf{v}'(t)=\mathbf{r}''(t).$$
- **호의 길이 매개화**: $$s(t)=\int_{t_0}^t\lVert\mathbf{r}'(\tau)\rVert\,d\tau.$$

### 2.2 프레네–세레(Frenet–Serret) 프레임
단위 접선/법선/종법선:
$$
\hat{\mathbf{T}}=\frac{d\mathbf{r}/dt}{\lVert d\mathbf{r}/dt\rVert},\quad
\hat{\mathbf{N}}=\frac{d\hat{\mathbf{T}}/ds}{\lVert d\hat{\mathbf{T}}/ds\rVert},\quad
\hat{\mathbf{B}}=\hat{\mathbf{T}}\times\hat{\mathbf{N}}.
$$

- **곡률** $$\kappa=\left\lVert\frac{d\hat{\mathbf{T}}}{ds}\right\rVert=\frac{\lVert\mathbf{r}'\times\mathbf{r}''\rVert}{\lVert\mathbf{r}'\rVert^3}.$$
- **비틀림(3D)** $$\tau=\frac{(\mathbf{r}'\times\mathbf{r}'')\cdot \mathbf{r}'''}{\lVert\mathbf{r}'\times\mathbf{r}''\rVert^2}.$$

프레네–세레 방정식(호길이 매개 $$s$$):
$$
\frac{d}{ds}\begin{bmatrix}\hat{\mathbf{T}}\\\hat{\mathbf{N}}\\\hat{\mathbf{B}}\end{bmatrix}
=
\begin{bmatrix}
0 & \kappa & 0\\
-\kappa & 0 & \tau\\
0 & -\tau & 0
\end{bmatrix}
\begin{bmatrix}\hat{\mathbf{T}}\\\hat{\mathbf{N}}\\\hat{\mathbf{B}}\end{bmatrix}.
$$

> **해석**: 곡률은 “얼마나 굽는가”, 비틀림은 “얼마나 비틀리는가”. 2D 곡선은 $$\tau=0$$.

### 2.3 예제: 원 나선(helix)
$$
\mathbf{r}(t)=(a\cos t,\ a\sin t,\ bt).
$$
- $$\mathbf{r}'=(-a\sin t,\ a\cos t,\ b),\quad \mathbf{r}''=(-a\cos t,\ -a\sin t,\ 0).$$
- 곡률 $$\kappa=\dfrac{a}{a^2+b^2},\quad \tau=\dfrac{b}{a^2+b^2}.$$

---

## 3. 다변수 미적분 도구: 그래디언트, 야코비안, 체인룰

### 3.1 그래디언트(최가증 방향)
스칼라장 $$f:\mathbb{R}^n\to\mathbb{R}$$ 에서
$$
\nabla f=\left(\frac{\partial f}{\partial x_1},\dots,\frac{\partial f}{\partial x_n}\right).
$$
- $$\nabla f(\mathbf{x})$$ 는 $$f$$ 증가가 **가장 큰 방향**이며, 크기는 최대 증가율.

### 3.2 야코비안과 선형화
벡터장 $$\mathbf{F}:\mathbb{R}^n\to\mathbb{R}^m$$ 의 야코비 행렬:
$$
J_{\mathbf{F}}(\mathbf{x})=\left[\frac{\partial F_i}{\partial x_j}\right]_{i,j}.
$$
- 국소 선형 근사: $$\mathbf{F}(\mathbf{x}+\Delta\mathbf{x})\approx \mathbf{F}(\mathbf{x})+J_{\mathbf{F}}(\mathbf{x})\,\Delta\mathbf{x}.$$

### 3.3 체인룰(합성함수)
$$
\frac{d}{dt}\, \mathbf{F}(\mathbf{r}(t))=J_{\mathbf{F}}(\mathbf{r}(t))\ \mathbf{r}'(t).
$$

---

## 4. 벡터장의 미분: 다이버전스와 컬

### 4.1 다이버전스(발산)
$$
\nabla\cdot\mathbf{F}=\frac{\partial F_1}{\partial x}+\frac{\partial F_2}{\partial y}+\frac{\partial F_3}{\partial z}.
$$
- **부호 해석**: $$>0$$(순 유출), $$<0$$(순 유입), $$=0$$(발산 없음, 불압축성 유체 속도장 등).

### 4.2 컬(회전)
$$
\nabla\times\mathbf{F}=
\left(
\frac{\partial F_3}{\partial y}-\frac{\partial F_2}{\partial z},\
\frac{\partial F_1}{\partial z}-\frac{\partial F_3}{\partial x},\
\frac{\partial F_2}{\partial x}-\frac{\partial F_1}{\partial y}
\right).
$$
- **물리 해석**: 미소 회전(와도), 국소적 회전 경향.

### 4.3 항등식(벡터 미적분의 문법)
$$
\nabla\times(\nabla f)=\mathbf{0},\qquad \nabla\cdot(\nabla\times\mathbf{F})=0.
$$

---

## 5. 선적분·면적분과 기본 정리들

### 5.1 선적분(Line Integral)
곡선 $$C: \mathbf{r}(t),\ t\in[a,b]$$,
- 스칼라장:
$$
\int_C f\,ds=\int_a^b f(\mathbf{r}(t))\, \lVert\mathbf{r}'(t)\rVert\,dt.
$$
- 벡터장(일, work):
$$
\int_C \mathbf{F}\cdot d\mathbf{r}=\int_a^b \mathbf{F}(\mathbf{r}(t))\cdot \mathbf{r}'(t)\,dt.
$$

### 5.2 보존장과 경로 독립성
- **보존장**: $$\mathbf{F}=\nabla \phi$$ (스칼라 포텐셜).
- **경로 독립**: 두 점 $$A\to B$$ 선적분은 경로 무관, $$\int_C \mathbf{F}\cdot d\mathbf{r}=\phi(B)-\phi(A).$$
- **필요충분(단순연결영역)**: $$\nabla\times\mathbf{F}=\mathbf{0} \iff \mathbf{F}\ \text{보존장}.$$

### 5.3 면적분(Surface Integral)
매개화 $$\mathbf{r}(u,v)$$, 법선요소 $$d\mathbf{S}=(\mathbf{r}_u\times \mathbf{r}_v)\,du\,dv.$$
- 스칼라장: $$\iint_S f\,dS=\iint_D f(\mathbf{r}(u,v))\,\lVert \mathbf{r}_u\times\mathbf{r}_v\rVert\,du\,dv.$$
- 벡터장(유량, flux): $$\iint_S \mathbf{F}\cdot d\mathbf{S}=\iint_D \mathbf{F}(\mathbf{r}(u,v))\cdot(\mathbf{r}_u\times\mathbf{r}_v)\,du\,dv.$$

### 5.4 그린 정리(2D)
$$
\oint_{\partial D} P\,dx+Q\,dy=\iint_D \left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right) dA.
$$

### 5.5 스토크스 정리(3D)
$$
\oint_{\partial S} \mathbf{F}\cdot d\mathbf{r}=\iint_S (\nabla\times\mathbf{F})\cdot d\mathbf{S}.
$$

### 5.6 발산 정리(가우스)
$$
\iiint_V (\nabla\cdot\mathbf{F})\,dV=\iint_{\partial V}\mathbf{F}\cdot d\mathbf{S}.
$$

> **연계**: 그린 정리는 2D에서의 스토크스 정리 특수형, 스토크스/가우스는 상보적(회전↔경계 선적분, 발산↔경계 표면적분).

---

## 6. 좌표계 변환과 야코비안

### 6.1 극·원통·구면
- 극: $$(r,\theta)\mapsto (r\cos\theta,r\sin\theta),\quad dA=r\,dr\,d\theta.$$
- 원통: $$(r,\theta,z),\quad dV = r\,dr\,d\theta\,dz.$$
- 구면: $$(\rho,\phi,\theta)\mapsto (\rho\sin\phi\cos\theta,\ \rho\sin\phi\sin\theta,\ \rho\cos\phi),\\ dV=\rho^2\sin\phi\, d\rho\, d\phi\, d\theta.$$

### 6.2 야코비안 결정식
변수변환 $$\mathbf{x}=\mathbf{x}(\mathbf{u})$$ 에서
$$
d\mathbf{x} = \left|\det \frac{\partial \mathbf{x}}{\partial \mathbf{u}}\right|\, d\mathbf{u}.
$$

---

## 7. 사례 연구와 수작업 풀이

### 7.1 보존장 판별과 포텐셜 구하기
$$
\mathbf{F}(x,y)=(2xy,\,x^2+2y).
$$
- 컬(2D): $$\frac{\partial}{\partial x}(x^2+2y)-\frac{\partial}{\partial y}(2xy)=2x-2x=0.$$
→ 보존장. 포텐셜 $$\phi$$ 를 찾자:
$$
\frac{\partial \phi}{\partial x}=2xy\Rightarrow \phi=x^2y+g(y),\\
\frac{\partial \phi}{\partial y}=x^2+2y\Rightarrow x^2+g'(y)=x^2+2y\Rightarrow g(y)=y^2.
$$
따라서 $$\phi=x^2y+y^2.$$
임의 경로 $$A\to B$$ 선적분은 $$\phi(B)-\phi(A).$$

### 7.2 스토크스 정리 검산
$$
\mathbf{F}=(y,-x,0),\ \ S: x^2+y^2\le 1,\ z=0.
$$
- 좌변(경계 원, 반시계): $$\oint \mathbf{F}\cdot d\mathbf{r}=2\pi.$$
- 우변: $$\nabla\times\mathbf{F}=(0,0,-2),\quad \iint_S (0,0,-2)\cdot(0,0,1)\,dS=-2\cdot \pi=-2\pi.$$
부호가 다른 이유는 **법선 방향**(정향) 선택 때문이다. 경계 방향과 표면 법선의 우수좌표 정합을 맞추면 둘은 일치한다(법선을 아래로 잡으면 일치). **정향 일치**가 필수임을 보여준다.

### 7.3 발산 정리 검산(단위구)
$$
\mathbf{F}=(x,y,z),\quad \nabla\cdot\mathbf{F}=3.\\
\iiint_{B_1}3\,dV=3\cdot \frac{4}{3}\pi=4\pi
\quad\text{vs}\quad
\iint_{S_1}\mathbf{F}\cdot\hat{\mathbf{n}}\, dS=\iint_{S_1}1\, dS=4\pi.
$$

---

## 8. 수치 예제(검산 가능한 코드)

> 아래 코드는 개념 검산·학습용이다. 고차원/복잡 기하에서는 메시 품질, 적분자 선택 등이 정확도에 큰 영향을 준다.

### 8.1 Python/NumPy — 원 위 선적분(수치 vs 해석)
\`\`\`python
import numpy as np

# F = (y, -x, 0), C: x^2 + y^2 = 1, z=0, counterclockwise
def F(x, y):
    return np.array([y, -x])

def r(t):
    return np.array([np.cos(t), np.sin(t)])

def rprime(t):
    return np.array([-np.sin(t), np.cos(t)])

def line_integral(n=20000):
    ts = np.linspace(0, 2*np.pi, n+1)
    vals = []
    for i in range(n):
        tmid = 0.5*(ts[i] + ts[i+1])
        x, y = r(tmid)
        Fx, Fy = F(x, y)
        rx, ry = rprime(tmid)
        vals.append(Fx*rx + Fy*ry)  # F·r'
    return np.trapz(vals, ts[:-1] + 0.5*(ts[1:]-ts[:-1]))

approx = line_integral()
print("∮C F·dr (numeric) ≈", approx, " ; exact = 2π =", 2*np.pi)
\`\`\`

### 8.2 Python/NumPy — 방사형 장의 구면 유량(발산 정리 수치 확인)
\`\`\`python
import numpy as np

# flux over sphere x^2 + y^2 + z^2 = R^2, F = (x,y,z)
def sphere_flux(R=1.0, nu=400, nv=800):
    us = np.linspace(0, np.pi, nu)       # polar angle φ
    vs = np.linspace(0, 2*np.pi, nv)     # azimuth θ
    flux = 0.0
    for i in range(nu-1):
        for j in range(nv-1):
            u = 0.5*(us[i] + us[i+1])
            v = 0.5*(vs[j] + vs[j+1])
            x = R*np.sin(u)*np.cos(v); y = R*np.sin(u)*np.sin(v); z = R*np.cos(u)
            Fx, Fy, Fz = x, y, z
            dS = (R**2)*np.sin(u) * (us[i+1]-us[i]) * (vs[j+1]-vs[j])  # |r_u × r_v|
            # F·n = F·(r/|r|) = R
            flux += R * dS
    return flux

num_flux = sphere_flux(R=1.0)
print("Flux over unit sphere (numeric) ≈", num_flux, " ; exact = 4π =", 4*np.pi)
\`\`\`

### 8.3 PyTorch — 프레네 프레임(곡률/접선/법선의 배치 계산)
\`\`\`python
import torch

# r(t) = (a cos t, a sin t, b t), batch of t's
def helix(t, a=2.0, b=1.0):
    x = a*torch.cos(t); y = a*torch.sin(t); z = b*t
    return torch.stack([x,y,z], dim=-1)

def frenet(t, a=2.0, b=1.0):
    t.requires_grad_(True)
    r = helix(t, a, b)
    dr = torch.autograd.grad(r, t, grad_outputs=torch.ones_like(r), create_graph=True)[0]
    d2r = torch.autograd.grad(dr, t, grad_outputs=torch.ones_like(dr), create_graph=True)[0]
    T = dr / torch.linalg.vector_norm(dr, dim=-1, keepdim=True)
    cross = torch.cross(dr, d2r, dim=-1)
    kappa = torch.linalg.vector_norm(cross, dim=-1) / (torch.linalg.vector_norm(dr, dim=-1)**3 + 1e-12)
    dT_dt = torch.autograd.grad(T, t, grad_outputs=torch.ones_like(T), create_graph=True)[0]
    N = dT_dt / (torch.linalg.vector_norm(dT_dt, dim=-1, keepdim=True)+1e-12)
    B = torch.cross(T, N, dim=-1)
    return T, N, B, kappa

t = torch.linspace(0, 2*torch.pi, 200)
T, N, B, kappa = frenet(t)
print("kappa (mean) ≈", kappa.mean().item(), " ; theory a/(a^2+b^2) =", 2.0/(2.0**2 + 1.0))
\`\`\`

---

## 9. 좌표계에서의 벡터 미분 연산(개요)

> 실제 공학 문제(유체/EM)에서는 원통/구면 좌표에서의 $$\nabla\cdot, \nabla\times$$ 가 자주 필요.

- 원통 좌표 $$(r,\theta,z)$$ 에서의 발산(개요):
$$
\nabla\cdot\mathbf{F}=\frac{1}{r}\frac{\partial}{\partial r}\big(r F_r\big)
+\frac{1}{r}\frac{\partial F_\theta}{\partial \theta}
+\frac{\partial F_z}{\partial z}.
$$
- 구면 좌표 $$(\rho,\phi,\theta)$$ 에서의 발산(개요):
$$
\nabla\cdot\mathbf{F}
=\frac{1}{\rho^2}\frac{\partial}{\partial \rho}(\rho^2 F_\rho)
+\frac{1}{\rho\sin\phi}\frac{\partial}{\partial \phi}(\sin\phi\,F_\phi)
+\frac{1}{\rho\sin\phi}\frac{\partial F_\theta}{\partial \theta}.
$$

> **주의**: 단위벡터가 위치에 따라 변하므로 미분 시 추가 항이 생긴다. 엄밀 유도에는 정규 직교 좌표계의 스케일 계수 사용.

---

## 10. 응용 시나리오

### 10.1 유체역학(불압축성)
- 속도장 $$\mathbf{u}$$ 에서 $$\nabla\cdot \mathbf{u}=0$$ 는 질량 보존.
- 경계 면적분 $$\iint_{\partial V}\mathbf{u}\cdot \hat{\mathbf{n}}\,dS=0$$.

### 10.2 전자기학(MW)
- 가우스 법칙: $$\iint_S \mathbf{E}\cdot d\mathbf{S}= \frac{Q_{\text{enc}}}{\varepsilon_0}.$$
- 패러데이 법칙(스토크스): $$\oint_C \mathbf{E}\cdot d\mathbf{r}=-\frac{d}{dt}\iint_S \mathbf{B}\cdot d\mathbf{S}.$$

### 10.3 최적화·경로계획
- 경사 하강: $$\mathbf{x}_{k+1}=\mathbf{x}_k-\eta\nabla f(\mathbf{x}_k).$$
- 포텐셜 장 기반 경로 계획: 장애물 포텐셜의 **음의 그래디언트**를 따라 이동.

---

## 11. 수치 해석 관점의 팁

1) **정향 일치**: 스토크스/발산 정리 수치 검산 시 **법선 방향–경계 방향** 일관성 필수.  
2) **샘플링 해상도**: 선적분/면적분은 분할 수를 늘려 수렴 확인(오차–해상도 관계 관찰).  
3) **야코비안**: 좌표변환 적분에서 빠뜨리면 값이 크게 왜곡.  
4) **평활화**: 노이즈 있는 장에서 수치 컬/다이버전스는 민감하므로 스무딩·정칙화 고려.

---

## 12. 종합 예제: 두 방식으로 같은 값을 얻기

**문제**: $$\mathbf{F}=(z,0,x)$$, 곡면 $$S$$ 는 평면 $$x+y+z=1$$ 의 제1사분면 부분(좌표평면과 만나는 삼각형), 경계 $$\partial S$$ 의 **양의 방향**은 법선에 따른 스토크스 정향.

1) **우변(스토크스)**: $$\nabla\times\mathbf{F}=(0-1,\ 1-0,\ 0-0)=(-1,1,0).$$  
평면의 상수 법선 $$\hat{\mathbf{n}}=\frac{(1,1,1)}{\sqrt{3}}$$ (위로 향함).  
면적요소 벡터 $$d\mathbf{S}=\hat{\mathbf{n}}\,dS$$.  
삼각형 면적: 꼭짓점(1,0,0),(0,1,0),(0,0,1) → 면적 $$\frac{\sqrt{3}}{2}$$.  
따라서
$$
\iint_S (\nabla\times\mathbf{F})\cdot d\mathbf{S}
= (-1,1,0)\cdot\hat{\mathbf{n}}\ \cdot \text{Area}
= \frac{-1+1+0}{\sqrt{3}}\cdot \frac{\sqrt{3}}{2}=0.
$$

2) **좌변(경계 선적분)**: 경계는 세 모서리(좌표평면 선분)의 합. 각 변에서 $$\mathbf{F}\cdot d\mathbf{r}$$ 을 직접 적분해도 0이 됨을 확인(대칭성/부호상쇄).  
→ **스토크스 정리 일치**.

---

## 13. 연습문제(해설 스케치 포함)

1) **보존장 판정**:  
   $$\mathbf{F}(x,y,z)=\big(2xz+y,\ x^2-2z,\ x+y^2\big)$$ 가 보존장인지 판정하고, 가능하면 포텐셜 $$\phi$$ 를 구하라.  
   *스케치*: 컬이 0인지 성분별로 확인. 0이면 통합으로 $$\phi$$ 복원.

2) **프레네 프레임**:  
   $$\mathbf{r}(t)=(t,\ t^2,\ t^3)$$ 의 $$\kappa(t)$$ 를 구하라.  
   *스케치*: $$\kappa=\lVert \mathbf{r}'\times\mathbf{r}''\rVert/\lVert \mathbf{r}'\rVert^3.$$

3) **그린 정리로 면적 계산**:  
   $$C$$: 단위원, $$\oint_C x\,dy = \text{?}$$  
   *스케치*: $$P=0,Q=x \Rightarrow \iint_D (\partial Q/\partial x - \partial P/\partial y)\,dA=\iint_D 1\,dA=\pi.$$

4) **발산 정리**:  
   $$\mathbf{F}=(x^2, y^2, z^2)$$, 단위구에서 표면 유량을 구하라.  
   *스케치*: 발산은 $$2x+2y+2z$$ 가 아니라 성분별 미분 → $$\nabla\cdot\mathbf{F}=2x+2y+2z$$ (오류 경계! 실제로 $$\partial x^2/\partial x=2x$$ 등). 구 대칭성으로 부피적분의 결과는 0.

5) **좌표변환 적분(구면)**:  
   $$\iint_{S_\rho} z\, dS$$ 를 구하라($$S_\rho$$ 는 반지름 $$\rho$$ 구).  
   *스케치*: 구면에서 평균 높이는 0 → 결과 0. 또는 매개화로 적분해도 0.

---

## 14. 결론(요약)

- **미분**은 벡터/벡터장의 **국소 변화**(속도, 가속도, 그래디언트, 컬, 다이버전스)를 정량화한다.  
- **적분**은 곡선/곡면/부피에서의 **누적 효과**(일, 유량, 총발산)를 계산한다.  
- **그린/스토크스/발산 정리**는 내부(미분)와 경계(적분)의 **대칭적 연결**을 제공한다.  
- **프레네 프레임**은 궤적의 기하(곡률/비틀림)를 구조적으로 설명한다.  
- 좌표변환·야코비안은 **기하적 척도 변화**를 정확히 반영하는 핵심 도구다.  
- 수치 구현 시 정향·샘플링·야코비안·안정성에 유의하면, 해석식과 잘 **수렴**한다.

---

## 부록 A. 자주 쓰는 공식 모음

- 호의 길이: $$L=\int_a^b \lVert \mathbf{r}'(t)\rVert\,dt.$$
- 곡률(파라메트릭): $$\kappa=\dfrac{\lVert\mathbf{r}'\times\mathbf{r}''\rVert}{\lVert\mathbf{r}'\rVert^3}.$$
- 보존장 필요충분(단순연결): $$\nabla\times\mathbf{F}=\mathbf{0}\iff \mathbf{F}=\nabla\phi.$$
- 스토크스: $$\oint_{\partial S}\mathbf{F}\cdot d\mathbf{r}=\iint_S (\nabla\times\mathbf{F})\cdot d\mathbf{S}.$$
- 발산: $$\iiint_V \nabla\cdot\mathbf{F}\,dV=\iint_{\partial V}\mathbf{F}\cdot d\mathbf{S}.$$
- 좌표변환 야코비안: $$d\mathbf{x}=|\det \partial\mathbf{x}/\partial\mathbf{u}|\,d\mathbf{u}.$$

---

## 부록 B. 실전 체크리스트

- [ ] 경계 **정향**과 법선 방향 일치 여부(오른손 규칙)  
- [ ] 좌표변환 시 **야코비안** 누락/오류 방지  
- [ ] 컬/다이버전스 계산 시 **편미분 인덱스** 착각 주의  
- [ ] 수치 적분의 **분할 수** 및 **안정성(조건수)** 확인  
- [ ] 보존장인지 **컬=0**로 빠르게 선별 후, 가능하면 **포텐셜** 복원