---
layout: post
title: C++ - ìŠ¤ë§ˆíŠ¸ í¬ì¸í„° ì ìš© ì˜ˆì œ
date: 2024-09-28 19:20:23 +0900
category: Cpp
---
# ğŸ§  ìŠ¤ë§ˆíŠ¸ í¬ì¸í„° ì ìš© ì˜ˆì œ ëª¨ìŒ

ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ëŠ” ì´ë¡ ë¿ ì•„ë‹ˆë¼ **ë³µì¡í•œ ê°ì²´ ê°„ ê´€ê³„ë¥¼ ì•ˆì „í•˜ê²Œ í‘œí˜„**í•  ìˆ˜ ìˆëŠ” ì‹¤ì „ ë„êµ¬ì…ë‹ˆë‹¤.  
ì´ë²ˆ ê¸€ì—ì„œëŠ” íŠ¸ë¦¬, ê·¸ë˜í”„, GUI êµ¬ì¡° ë“± ë‹¤ì–‘í•œ íŒ¨í„´ì—ì„œ  
`unique_ptr`, `shared_ptr`, `weak_ptr`ì„ ì–´ë–»ê²Œ ì¡°í•©í•˜ëŠ”ì§€ ì˜ˆì œë¡œ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.

---

## ğŸ§± 1. íŠ¸ë¦¬ êµ¬ì¡° (`unique_ptr`)

íŠ¸ë¦¬ëŠ” **ë¶€ëª¨ê°€ ìì‹ì˜ ì†Œìœ ê¶Œì„ ê°–ëŠ” ê³„ì¸µì  êµ¬ì¡°**ì…ë‹ˆë‹¤.  
â†’ ì†Œìœ ê¶Œ ì´ì „ì´ ëª…í™•í•˜ë¯€ë¡œ `std::unique_ptr`ë¡œ ìì‹ ë…¸ë“œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

```cpp
#include <memory>
#include <vector>
#include <string>
#include <iostream>

class TreeNode {
public:
    std::string name;
    std::vector<std::unique_ptr<TreeNode>> children;

    TreeNode(std::string n) : name(std::move(n)) {}

    void addChild(std::unique_ptr<TreeNode> child) {
        children.push_back(std::move(child));
    }

    void print(int depth = 0) const {
        std::cout << std::string(depth * 2, '-') << name << "\n";
        for (const auto& child : children)
            child->print(depth + 1);
    }
};

int main() {
    auto root = std::make_unique<TreeNode>("Root");
    root->addChild(std::make_unique<TreeNode>("Child1"));
    root->addChild(std::make_unique<TreeNode>("Child2"));

    root->children[0]->addChild(std::make_unique<TreeNode>("Grandchild"));

    root->print();
}
```

### âœ… ìš”ì•½
- ìì‹ì€ í•˜ë‚˜ì˜ ë¶€ëª¨ì—ê²Œë§Œ ì†Œìœ ë¨ â†’ `unique_ptr`
- íŠ¸ë¦¬ êµ¬ì¡°ì— ì´ìƒì  (ì†Œìœ  ê´€ê³„ê°€ ëª…í™•)

---

## ğŸ”— 2. ê·¸ë˜í”„ êµ¬ì¡° (`shared_ptr` + `weak_ptr`)

ê·¸ë˜í”„ëŠ” **ì„œë¡œ ì—°ê²°ëœ ê°ì²´ë“¤**ì´ê¸° ë•Œë¬¸ì—,  
ìˆœí™˜ ì°¸ì¡°ê°€ ì¼ì–´ë‚˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ì´ë¥¼ ë§‰ê¸° ìœ„í•´ `weak_ptr`ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```cpp
#include <memory>
#include <vector>
#include <string>

class Node;
using NodePtr = std::shared_ptr<Node>;

class Node {
public:
    std::string name;
    std::vector<std::weak_ptr<Node>> neighbors;

    Node(std::string n) : name(std::move(n)) {}

    void addNeighbor(const NodePtr& neighbor) {
        neighbors.push_back(neighbor);
    }
};

int main() {
    auto a = std::make_shared<Node>("A");
    auto b = std::make_shared<Node>("B");
    auto c = std::make_shared<Node>("C");

    a->addNeighbor(b);
    b->addNeighbor(c);
    c->addNeighbor(a);  // ìˆœí™˜ êµ¬ì¡°

    // weak_ptr ë•ë¶„ì— ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì—†ìŒ
}
```

### âœ… ìš”ì•½
- ê°ì²´ë“¤ì´ ì„œë¡œ ì°¸ì¡° â†’ `shared_ptr`
- ìˆœí™˜ ì°¸ì¡° ë°©ì§€ â†’ `weak_ptr` ì‚¬ìš©
- `lock()`ìœ¼ë¡œ ìœ íš¨í•œ ê²½ìš°ë§Œ ì‚¬ìš©

---

## ğŸªŸ 3. GUI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡° (ë¶€ëª¨ëŠ” ì†Œìœ , ìì‹ì€ ì°¸ì¡°)

GUI ì‹œìŠ¤í…œì—ì„œëŠ” **ë¶€ëª¨ê°€ ìì‹ ìœ„ì ¯ì„ ì†Œìœ **í•˜ê³ ,  
**ìì‹ì´ ë¶€ëª¨ë¥¼ ì°¸ì¡°**í•˜ëŠ” êµ¬ì¡°ê°€ ì¼ë°˜ì ì…ë‹ˆë‹¤.

```cpp
#include <memory>
#include <vector>
#include <iostream>

class Widget;
using WidgetPtr = std::shared_ptr<Widget>;

class Widget : public std::enable_shared_from_this<Widget> {
    std::vector<WidgetPtr> children;
    std::weak_ptr<Widget> parent;

public:
    void addChild(const WidgetPtr& child) {
        child->parent = shared_from_this();
        children.push_back(child);
    }

    void printHierarchy(int level = 0) {
        std::cout << std::string(level * 2, ' ') << "Widget\n";
        for (auto& c : children)
            c->printHierarchy(level + 1);
    }
};

int main() {
    auto root = std::make_shared<Widget>();
    auto child1 = std::make_shared<Widget>();
    auto child2 = std::make_shared<Widget>();

    root->addChild(child1);
    root->addChild(child2);

    root->printHierarchy();
}
```

### âœ… ìš”ì•½
- ë¶€ëª¨ â†’ ìì‹ : `shared_ptr` (ì†Œìœ )
- ìì‹ â†’ ë¶€ëª¨ : `weak_ptr` (ì°¸ì¡°)
- `enable_shared_from_this`ë¡œ ì•ˆì „í•˜ê²Œ ìê¸° í¬ì¸í„° ì „ë‹¬

---

## ğŸ“Œ ê²°ë¡ 

| êµ¬ì¡°       | ìŠ¤ë§ˆíŠ¸ í¬ì¸í„° êµ¬ì„±                             | ì´ìœ  |
|------------|------------------------------------------------|------|
| íŠ¸ë¦¬       | `unique_ptr`                                   | ë¶€ëª¨ê°€ ìì‹ ì†Œìœ , ëª…í™•í•œ ì†Œìœ ê¶Œ |
| ê·¸ë˜í”„     | `shared_ptr` + `weak_ptr`                      | ìˆœí™˜ ì°¸ì¡° ê°€ëŠ¥ì„±, ê³µìœ  ë…¸ë“œ í•„ìš” |
| GUI        | ë¶€ëª¨â†’ìì‹: `shared_ptr`, ìì‹â†’ë¶€ëª¨: `weak_ptr` | ì–‘ë°©í–¥ ì°¸ì¡° êµ¬ì¡° (ìˆœí™˜ ë°©ì§€ í•„ìš”) |

---

ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ëŠ” ë‹¨ìˆœíˆ ë©”ëª¨ë¦¬ë¥¼ ìë™ í•´ì œí•˜ëŠ” ê²ƒì„ ë„˜ì–´ì„œ,  
**êµ¬ì¡°ì˜ ì†Œìœ ê¶Œê³¼ ìˆ˜ëª… ê´€ë¦¬ê¹Œì§€ ì•ˆì „í•˜ê²Œ í‘œí˜„**í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤ë‹ˆë‹¤.