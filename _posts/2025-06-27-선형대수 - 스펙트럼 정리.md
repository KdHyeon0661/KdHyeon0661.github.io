---
layout: post
title: 선형대수 - 스펙트럼 정리
date: 2025-06-27 20:20:23 +0900
category: 선형대수
---
# 스펙트럼 정리(Spectral Theorem)
> **TL;DR**
> 실수 **대칭 행렬**(또는 복소 **에르미트 행렬**)은 항상 **직교(또는 유니タ리) 대각화**가 가능하다.
> 즉, 모든 대칭 행렬 $$A\in\mathbb{R}^{n\times n}$$에 대해 **직교행렬** $$Q$$, **대각행렬** $$\Lambda$$가 존재하여
> $$\boxed{A = Q\,\Lambda\,Q^{\mathsf T}}$$
> 이고, 여기서 $$Q$$의 열벡터는 **정규직교 고유벡터**, $$\Lambda$$의 대각원소는 **실수 고유값**이다.

---

## 1. 정리의 정확한 진술(실수/복소)

### 1.1 실수판(대칭 행렬)
실수 대칭 $$A=A^{\mathsf T}$$ 에 대해
$$
\boxed{A = Q\,\Lambda\,Q^{\mathsf T}}
$$
- $$Q\in\mathbb{R}^{n\times n}$$: 직교행렬($$Q^{\mathsf T}Q=I$$), 열이 **정규직교 고유벡터**
- $$\Lambda=\operatorname{diag}(\lambda_1,\dots,\lambda_n)$$: **실수 고유값**

### 1.2 복소판(에르미트/정규 행렬)
- **에르미트** $$A=A^*$$ 에 대해
  $$
  \boxed{A = U\,\Lambda\,U^*}
  $$
  여기서 $$U$$는 **유니タリ**($$U^*U=I$$), 고유값은 **실수**.
- 더 일반적으로 **정규행렬** $$A^*A=AA^*$$ 도 유니タリ 대각화 가능(고유값은 복소수 가능).
  에르미트는 정규의 특수케이스.

> 용어: 실수에서는 **직교(orthogonal)**, 복소에서는 **유니タリ(unitary)**.

---

## 2. 직관과 기하학

- 대칭 $$A$$는 공간을 **서로 직교하는 축(고유벡터)** 방향으로만 **스케일**한다.
  적절한 직교 기저(고유벡터 기저)로 보면,
  $$
  Q^{\mathsf T} A Q = \Lambda \quad(\text{대각})
  $$
  이므로 그 좌표계에서는 “곱하기 $$\lambda_i$$” 만 수행하는 **축별 독립 스케일링**.

- **타원체** 해석: 집합 $$\{\mathbf x:\ \mathbf x^{\mathsf T}\mathbf x=1\}$$의 $$A$$-이미지는
  $$\{\mathbf y:\ \mathbf y^{\mathsf T} A^{-1}\mathbf y=1\}$$의 타원. 축은 **고유벡터**, 반지름은 **$$|\lambda_i|^{-1/2}$$**와 연결.

---

## 3. 핵심 성질(결과물)

1. **고유값은 모두 실수**(대칭/에르미트).
2. **상이한 고유값에 대응하는 고유벡터는 서로 직교**.
3. **정규직교 기저**로 고유벡터를 잡을 수 있음(Gram–Schmidt不要).
4. 스펙트럼 분해(스펙트럴 분해):
   $$
   \boxed{A=\sum_{i=1}^n \lambda_i\,\mathbf q_i \mathbf q_i^{\mathsf T}}
   \quad(\text{복소에서는 } \mathbf q_i\mathbf q_i^*)
   $$
   여기서 $$\{\mathbf q_i\}$$는 단위 고유벡터.

5. **함수 계산(Functional calculus)**:
   연속/해석적 함수 $$f$$에 대해
   $$
   \boxed{f(A)=\sum_{i=1}^n f(\lambda_i)\,\mathbf q_i\mathbf q_i^{\mathsf T}}
   $$
   (예: $$\exp(A),\ \sqrt{A}\ (\text{PSD일 때}),\ \operatorname{sign}(A)$$ 등)

---

## 4. 증명 스케치(두 가지 관점)

### 4.1 슈어 분해(실수 대칭의 경우)
- 임의의 실수 정방 $$A$$는 유니타リ/직교 슈어 분해로 $$A = Q T Q^{\mathsf T}$$ (또는 $$Q^*AQ=T$$) 가능, $$T$$는 상삼각.
- 대칭이면 $$A=A^{\mathsf T}\ \Rightarrow\ T = T^{\mathsf T}$$.
  상삼각이면서 대칭이면 **대각**이어야 한다 ⇒ $$T=\Lambda$$.
  곧 $$A=Q\Lambda Q^{\mathsf T}$$.

### 4.2 레일리 몫–최소최대 원리(에르미트의 실수 고유값)
- 레일리 몫 $$R_A(\mathbf x)=\dfrac{\mathbf x^*A\mathbf x}{\mathbf x^*\mathbf x}$$의 극값이 고유값을 줌.
- 최댓값/최솟값에서의 정류 조건이 $$A\mathbf x=\lambda\mathbf x$$ 유도.
- 귀납적으로 직교 보완에 대해 반복하면 직교 고유기저 완성.

---

## 5. 양의(반)정정부호, 제곱근, 지수

- $$A\succeq 0\ (\text{PSD}) \iff \lambda_i\ge 0\ \forall i$$.
  이때 **유일한 PSD 루트** 존재:
  $$
  \boxed{A^{1/2} = Q\,\sqrt{\Lambda}\,Q^{\mathsf T}}
  $$
- 지수행렬:
  $$
  \exp(A)=Q\,\exp(\Lambda)\,Q^{\mathsf T}=\sum_i e^{\lambda_i}\,\mathbf q_i\mathbf q_i^{\mathsf T}.
  $$

---

## 6. SVD와의 관계(대칭의 SVD)

대칭 $$A=Q\Lambda Q^{\mathsf T}$$에서
**특이값**은 $$\sigma_i=|\lambda_i|$$.
SVD는
$$
A = U\Sigma V^{\mathsf T},\quad
\Sigma=\operatorname{diag}(|\lambda_i|),\quad
U=Q,\quad
V=Q\,\operatorname{diag}(\operatorname{sign}\lambda_i),
$$
(부호 행렬까지 포함해 정리 가능).
PSD인 경우 $$\lambda_i\ge 0$$이라서 **$$U=V=Q$$**, **$$\Sigma=\Lambda$$**.

---

## 7. 수치 계산과 실무 팁

- **`np.linalg.eigh`**(대칭/에르미트 전용)를 사용하라.
  일반 `eig`보다 수치적으로 안정·빠름.
- 큰 희소/대규모 행렬: **파워 방법**, **Lanczos/LOBPCG**(scipy.sparse.linalg) 사용.
- **정렬**: 보통 오름차순. 필요 시 내림차순 재정렬.
- **정규직교성 확인**: $$Q^{\mathsf T}Q\approx I$$, 재구성 $$Q\Lambda Q^{\mathsf T}\approx A$$ 체크.

---

## 8. 예제 1 — 손계산 가능한 2×2

$$
A=\begin{bmatrix}2&1\\[2pt]1&2\end{bmatrix}
$$
- 특성다항식: $$(\lambda-3)(\lambda-1)=0\Rightarrow \lambda_1=3,\ \lambda_2=1.$$
- 정규화 고유벡터:
  $$
  \mathbf q_1=\tfrac1{\sqrt2}\begin{bmatrix}1\\1\end{bmatrix},\quad
  \mathbf q_2=\tfrac1{\sqrt2}\begin{bmatrix}1\\-1\end{bmatrix}.
  $$
- 분해:
  $$
  A=Q\Lambda Q^{\mathsf T},\
  Q=\begin{bmatrix}\tfrac1{\sqrt2}&\ -\tfrac1{\sqrt2}\\[2pt]\tfrac1{\sqrt2}&\ \tfrac1{\sqrt2}\end{bmatrix},\
  \Lambda=\begin{bmatrix}3&0\\0&1\end{bmatrix}.
  $$

---

## 9. 예제 2 — 파이썬으로 일반 대칭 행렬 대각화

```python
import numpy as np

# 대칭 행렬 생성
np.random.seed(7)
M = np.random.randn(5, 5)
A = (M + M.T) / 2  # 대칭화

# 스펙트럼 분해 (대칭/에르미트 전용 루틴)
w, Q = np.linalg.eigh(A)  # w: 고유값(오름차순), Q: 고유벡터 열
Lambda = np.diag(w)

# 검증
I = np.eye(A.shape[0])
recon = Q @ Lambda @ Q.T
print("재구성 오차 ||A - QΛQ^T||_F =", np.linalg.norm(A - recon, 'fro'))
print("직교성 오차 ||Q^T Q - I||_F  =", np.linalg.norm(Q.T @ Q - I, 'fro'))

# 레일리 몫(최대/최소) 확인
def rayleigh(x):
    x = x / np.linalg.norm(x)
    return float(x @ A @ x)

x = np.random.randn(5)
print("Rayleigh quotient (random x):", rayleigh(x))
print("min eigenvalue <= R(x) <= max eigenvalue ? ",
      w[0] <= rayleigh(x) <= w[-1])
```

---

## 10. 예제 3 — 함수 $$f(A)$$ 계산: $$\exp(A)$$, $$A^{1/2}$$(PSD)

```python
import numpy as np

# PSD 행렬 만들기: B^T B
np.random.seed(0)
B = np.random.randn(4, 4)
A = B.T @ B  # PSD (대칭)

# 대각화
w, Q = np.linalg.eigh(A)
Lambda = np.diag(w)

# 행렬 지수와 제곱근
expA = Q @ np.diag(np.exp(w)) @ Q.T
sqrtA = Q @ np.diag(np.sqrt(w)) @ Q.T

# 검증: sqrtA^2 ≈ A
print("||sqrt(A)^2 - A||_F =", np.linalg.norm(sqrtA @ sqrtA - A, 'fro'))
```

---

## 11. 예제 4 — PCA와 스펙트럼 정리의 만남(공분산은 대칭)

$$
C=\frac1n X^{\mathsf T}X \quad (\text{평균 중심화된 데이터 }X)
$$

- $$C$$는 대칭(에르미트) ⇒ **스펙트럼 정리로 직교 대각화** 가능.
- 고유벡터 = **주성분 방향**, 고유값 = **분산**.

```python
import numpy as np

# 예제 데이터 (row=샘플, col=특징), 평균 중심화
X = np.array([[2.5, 2.4],
              [0.5, 0.7],
              [2.2, 2.9],
              [1.9, 2.2],
              [3.1, 3.0],
              [2.3, 2.7],
              [2.0, 1.6],
              [1.0, 1.1],
              [1.5, 1.6],
              [1.1, 0.9]])
Xc = X - X.mean(axis=0, keepdims=True)

# 공분산(행 기준: rowvar=False)
C = np.cov(Xc, rowvar=False)

# 대각화 (PCA)
vals, vecs = np.linalg.eigh(C)            # 오름차순
order = np.argsort(vals)[::-1]
vals, vecs = vals[order], vecs[:, order]  # 내림차순 정렬

explained = vals / vals.sum()
print("주성분 방향(열):\n", vecs)
print("설명 분산 비율:", explained)
```

---

## 12. 레일리 몫과 최소–최대 원리(실전 최적화 관점)

- **최대 고유값**:
  $$
  \lambda_{\max} = \max_{\mathbf x\neq 0}\ \frac{\mathbf x^{\mathsf T}A\mathbf x}{\mathbf x^{\mathsf T}\mathbf x}.
  $$
- **최소 고유값**도 동일 방식의 최소화.
- 제약을 추가하면(직교 제약) **두 번째, 세 번째 …** 고유값에 대한 최소–최대 원리(코랑–피셔).

> 응용: **최대분산 방향**(PCA), **그래프 절단/스펙트럴 클러스터링**(라플라시안의 Fiedler 벡터), **최적화의 곡률**(헤시안 대칭).

---

## 13. 주된 불변량, 정리, 부등식(스펙트럼 분석의 도구들)

- **트레이스/행렬식 불변**(유사변환):
  $$\operatorname{tr}(A)=\sum_i \lambda_i,\quad \det(A)=\prod_i \lambda_i.$$
- **간섭(Interlacing)**(주요소 행렬과 고유값):
  $$\lambda_i(A_{\text{principal}})\ \text{가}\ \lambda_i(A)\ \text{사이에 낀다}.$$
- **웨일 부등식/Weyl inequalities**(대칭 합의 고유값 경계):
  $$\lambda_i(A)+\lambda_1(B)\le \lambda_i(A+B)\le \lambda_i(A)+\lambda_n(B).$$
- **호프만–비엘란트(Hoffman–Wielandt)**: 고유값 간 거리의 제곱 합은 프로베니우스 노름의 제곱으로 상계.

> 실무 해석: 작은 대칭 섭동 $$E$$가 있을 때 고유값/고유벡터 **민감도**를 정량화.

---

## 14. 비대칭이 왜 문제인가(반예와 Jordan)

- $$J=\begin{bmatrix}1&1\\0&1\end{bmatrix}$$ 은 비대칭이고 **대각화 불가**(고유벡터 1개).
- 이와 대비되어 대칭은 **항상 직교 대각화 가능**(스펙트럼 정리의 힘).

---

## 15. 그래프 라플라시안에 즉시 적용

- **라플라시안** $$L=D-A$$ 는 대칭(무향 그래프)이고 **PSD**.
- $$L=Q\Lambda Q^{\mathsf T}$$, $$\lambda_1=0$$, 두 번째 고유벡터(Fiedler)는 **스펙트럴 분할** 기준.
  (상세는 그래프 라플라시안 글 참고)

---

## 16. SVD/정규화/수치상 고려 요약

- 대칭/에르미트: `eigh`(실수)/`eigh`(복소) 우선.
- 매우 큰 문제: 희소용 방법(Lanczos/LOBPCG), 전처리/스케일링, 수치 조건수 관리.
- **절대 금지**: 굳이 필요 없는 한 $$A^TA$$ 형성(조건수 악화/정밀도 손실).

---

## 17. 종합 예제 — 스펙트럼 분해, 함수계산, 레일리 몫, 인터레이싱

```python
import numpy as np

np.random.seed(42)
n = 6
M = np.random.randn(n, n)
A = (M + M.T) / 2  # 대칭

# 1. 스펙트럼 분해
w, Q = np.linalg.eigh(A)
Lambda = np.diag(w)
A_recon = Q @ Lambda @ Q.T

print("재구성 오차:", np.linalg.norm(A - A_recon, 'fro'))

# 2. 함수계산: f(A) = cos(A)
fA = Q @ np.diag(np.cos(w)) @ Q.T

# 3. 레일리 몫 경계 확인
def rayleigh(x):
    x = x / np.linalg.norm(x)
    return float(x.T @ A @ x)

xs = np.random.randn(5, n)
R = [rayleigh(x) for x in xs]
print("Rayleigh 범위 체크:", min(R) >= w[0] - 1e-10 and max(R) <= w[-1] + 1e-10)

# 4. 인터레이싱(주요소 행렬)
idx = [0,1,3,5]                 # 일부 인덱스 선택
A_sub = A[np.ix_(idx, idx)]
ws, _ = np.linalg.eigh(A_sub)
# 인터레이싱: w[i] <= ws[i] <= w[i + (n-k)]
k = len(idx)
ok = True
for i in range(k):
    if not (w[i] - 1e-9 <= ws[i] <= w[i + (n - k)] + 1e-9):
        ok = False
        break
print("인터레이싱 대략 만족?:", ok)
```

---

## 18. 자주 틀리는 포인트 체크리스트

- [ ] **대칭/에르미트 여부** 확인 후 `eigh` 사용.
- [ ] 고유벡터 행렬 **열은 정규직교** ⇒ $$Q^{\mathsf T}Q=I$$.
- [ ] 필요 시 **정렬**(내림/오름) 후 벡터/값 동기화.
- [ ] **함수계산은 고유값에 함수 적용** 후 다시 조립.
- [ ] PSD면 **모든 고유값 비음수**. 음수가 보이면 수치/모델 의심.
- [ ] SVD와 혼동 금지: 특이값 $$=|\lambda|$$(대칭), 에르미트 아닌 일반 정규는 유니タリ 대각화지만 고유값 복소 가능.

---

## 19. 요약 표

| 항목 | 내용 |
|---|---|
| 정리 | $$A=A^{\mathsf T}\Rightarrow A=Q\Lambda Q^{\mathsf T}$$ (복소: $$A=A^*\Rightarrow A=U\Lambda U^*$$) |
| 결과 | 고유값 **실수**, 고유벡터 **직교**(정규화 가능) |
| 분해 | $$A=\sum_i \lambda_i \mathbf q_i\mathbf q_i^{\mathsf T}$$ |
| 함수 | $$f(A)=\sum_i f(\lambda_i)\mathbf q_i\mathbf q_i^{\mathsf T}$$ |
| 응용 | PCA/공분산, 그래프 라플라시안, 최적화 곡률(헤시안), 신호처리 모드 분해 |
| 수치 | `eigh` 사용, 희소는 Lanczos/LOBPCG, 검증: 재구성/직교성 |

---

## 20. 미니 과제(스스로 해보기)

1. 임의의 대칭 $$A$$에 대해 $$\exp(A)$$, $$\cos(A)$$, $$A^{1/2}$$를 직접 구현하고
   테일러 급수/`scipy.linalg.expm`와 정확도 비교(가능하면).
2. **PSD 근사**: 수치오차로 음의 고유값이 미소하게 생기면 **0으로 잘라 재조립**.
3. 라플라시안 $$L$$의 두 번째 고유벡터로 2-클러스터링을 구현하고, 엣지 절단 비율을 비교.
