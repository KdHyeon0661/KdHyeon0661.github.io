---
layout: post
title: 미적분 - 벡터함수의 미분과 적분
date: 2025-07-27 17:20:23 +0900
category: 미적분
---
# 벡터함수의 미분과 적분 (Vector-Valued Functions: Differentiation & Integration)

> 벡터함수는 *스칼라*를 입력 받아 **벡터**를 출력합니다.  
> 미분은 **접선·속도·가속도**를, 적분은 **변위·호장(arc length)** 등을 연결합니다.  

---

## 0) 표기와 전제

- 곡선(궤적)  
  $$
  \vec r(t)=\langle x(t),\,y(t),\,z(t)\rangle,\quad t\in I\subset\mathbb R.
  $$
- **속도/가속도/속력**  
  $$
  \vec v(t)=\vec r'(t),\qquad \vec a(t)=\vec r''(t),\qquad v(t)=\|\vec r'(t)\|.
  $$
- **정칙(regular)**: $v(t)=\|\vec r'(t)\|>0$인 구간 (접선과 곡률 등의 정의가 안정적).

---

## 1) 정의·극한·연속

### 1.1 정의/예시
- 3D: $\vec r(t)=\langle \cos t,\ \sin t,\ t\rangle$  (헬릭스)
- 2D: $\vec r(t)=\langle x(t),\,y(t)\rangle$

### 1.2 극한과 연속(성분별)
$$
\lim_{t\to t_0}\vec r(t)
=\Big\langle \lim_{t\to t_0}x(t),\ \lim_{t\to t_0}y(t),\ \lim_{t\to t_0}z(t)\Big\rangle.
$$
$\vec r$가 $t_0$에서 연속 $\iff$ 각 성분이 $t_0$에서 연속.

---

## 2) 벡터함수의 **미분**

### 2.1 정의와 의미
$$
\vec r'(t)=\left\langle x'(t),\,y'(t),\,z'(t)\right\rangle.
$$
- **기하학**: $\vec r'(t)$는 접선 방향 벡터, $\ v(t)=\|\vec r'(t)\|$는 속력.
- **물리학**: $\vec v=\vec r'$, $\vec a=\vec r''$.

### 2.2 연산 법칙(자주 쓰는 6종)
- 선형성: $(\alpha\vec r+\beta\vec s)'=\alpha\vec r'+\beta\vec s'$
- 스칼라·벡터 곱: $(f\vec r)'=f'\vec r+f\vec r'$
- 내적: $(\vec r\cdot\vec s)'=\vec r'\cdot\vec s+\vec r\cdot\vec s'$
- 외적: $(\vec r\times\vec s)'=\vec r'\times\vec s+\vec r\times\vec s'$
- 노름: $\dfrac{d}{dt}\|\vec r\|=\dfrac{\vec r\cdot\vec r'}{\|\vec r\|}\quad(\|\vec r\|\neq0)$
- **체인룰**: $s=g(t)$이면 $\dfrac{d}{dt}\vec r(g(t))=\vec r'(s)\,g'(t)$

### 2.3 단위 접선과 그 미분
$$
\vec T(t)=\frac{\vec r'(t)}{\|\vec r'(t)\|},\qquad
\vec T'(t)=\frac{\vec r''}{\|\vec r'\|}-\frac{\vec r'(\vec r'\cdot\vec r'')}{\|\vec r'\|^3}.
$$

### 2.4 예제(미분)
$$
\vec r(t)=\langle t^2,\,\sin t,\,\ln t\rangle\quad(t>0)
$$
$$
\vec r'(t)=\langle 2t,\,\cos t,\,1/t\rangle,\qquad
\vec r''(t)=\langle 2,\,-\sin t,\,-1/t^2\rangle.
$$

---

## 3) 벡터함수의 **적분**

### 3.1 부정적분(성분별)
$$
\int \vec r(t)\,dt=\Big\langle \int x(t)\,dt,\ \int y(t)\,dt,\ \int z(t)\,dt\Big\rangle+\vec C.
$$

### 3.2 정적분과 뉴턴–라이프니츠
$$
\int_a^b \vec r'(t)\,dt=\vec r(b)-\vec r(a).
$$

### 3.3 속도/가속도에서 역적분(초깃값 포함)
- $\displaystyle \vec v(t)=\vec v(t_0)+\int_{t_0}^{t}\vec a(\tau)\,d\tau$
- $\displaystyle \vec r(t)=\vec r(t_0)+\int_{t_0}^{t}\vec v(\tau)\,d\tau$

### 3.4 예제(적분)
$$
\vec r(t)=\langle t,\ t^2,\ \sin t\rangle
\ \Rightarrow\ 
\int\vec r(t)\,dt
=\left\langle \tfrac{t^2}{2},\ \tfrac{t^3}{3},\ -\cos t\right\rangle+\vec C.
$$

---

## 4) 속력, 호의 길이, 아크길이 매개화

### 4.1 속력
$$
v(t)=\|\vec r'(t)\|=\sqrt{\,x'(t)^2+y'(t)^2+z'(t)^2\,}.
$$

### 4.2 호의 길이(arc length)
$$
s=\int_{a}^{b}\|\vec r'(t)\|\,dt.
$$

### 4.3 아크길이 매개화(등속화)
$s(t)=\int_{t_0}^{t}\|\vec r'(\tau)\|\,d\tau$, 역함수 $t=t(s)$가 있으면  
$\tilde{\vec r}(s)=\vec r\!\big(t(s)\big)$는 **등속**: $\left\|\frac{d\tilde{\vec r}}{ds}\right\|=1$.

---

## 5) 곡률와 가속도의 분해(미분 응용)

### 5.1 곡률(3D)
$$
\kappa(t)=\frac{\|\vec r'(t)\times\vec r''(t)\|}{\|\vec r'(t)\|^3}.
$$

### 5.2 가속도 분해(탱젠셜/노말)
$$
\vec a=\underbrace{\frac{dv}{dt}}_{a_T}\vec T+\underbrace{v^2\,\kappa}_{a_N}\vec N,
$$
- $a_T$: **속력 변화율**(가감속),  
- $a_N$: **방향 변화율**(곡률에 의한 구심 가속도 크기).

---

## 6) 물리/선적분 연결 (짧게)

- **일(work)**: $\displaystyle W=\int_C \vec F\cdot d\vec r=\int_{a}^{b}\vec F(\vec r(t))\cdot\vec r'(t)\,dt$  
  (미분 $\Rightarrow$ 접선성분만 누적되는 내적)

---

## 7) 완전 예제 모음 (해석 풀이)

### 예제 A — 헬릭스의 미분/속력/호장
$$
\vec r(t)=\langle a\cos t,\ a\sin t,\ bt\rangle,\quad t\in[0,T].
$$
- $\vec r'=\langle -a\sin t,\ a\cos t,\ b\rangle$  
  $v=\|\vec r'\|=\sqrt{a^2+b^2}=:c$ (상수)
- **호장**: $s=\int_0^T c\,dt=cT$
- **가속도**: $\vec r''=\langle -a\cos t,\ -a\sin t,\ 0\rangle$
- **곡률**: $\displaystyle \kappa=\frac{a}{a^2+b^2}$ (상수)

> 등속/등곡률: 일정 회전반경으로 일정 속도로 감겨 올라감.

---

### 예제 B — 포물선 조각의 길이와 단위 접선
$$
\vec r(t)=\langle t,\ t^2\rangle,\quad 0\le t\le1.
$$
- $\vec r'=\langle 1,\ 2t\rangle,\ v=\sqrt{1+4t^2}$
- **호장**:
  $$
  L=\int_0^1\sqrt{1+4t^2}\,dt
  =\frac14\Big(\sinh^{-1}2+2\sqrt5\Big).
  $$
- **단위 접선**: $\displaystyle \vec T=\frac{1}{\sqrt{1+4t^2}}\langle 1,\,2t\rangle$

---

### 예제 C — 투사체 운동(평면)과 가속도 분해
$$
\vec r(t)=\big\langle v_0\cos\alpha\ t,\ v_0\sin\alpha\ t-\tfrac12gt^2\big\rangle.
$$
- $\vec v=\langle v_0\cos\alpha,\ v_0\sin\alpha-gt\rangle$  
  $v=\sqrt{(v_0\cos\alpha)^2+(v_0\sin\alpha-gt)^2}$
- $\vec a=\langle 0,-g\rangle$  
- 정점에서 $a_T=\dfrac{dv}{dt}=0$ → 전 가속도가 노말 성분($a_N=g$)만 남음.

---

### 예제 D — 벡터 적분으로 변위 구하기
시간 $[0,T]$ 동안 속도 $\vec v(t)=\langle 2t,\ \cos t,\ e^{-t}\rangle$일 때
$$
\Delta \vec r=\int_0^T \vec v(t)\,dt
=\left\langle t^2,\ \sin t,\ -e^{-t}\right\rangle\Big|_{0}^{T}
=\langle T^2,\ \sin T,\ 1-e^{-T}\rangle.
$$

---

### 예제 E — 선적분(일) 미니 사례
힘 $\vec F(x,y)=\langle y,\ -x\rangle$, 경로 $\vec r(t)=\langle \cos t,\ \sin t\rangle$, $t\in[0,2\pi]$:
$$
W=\int_0^{2\pi}\vec F(\vec r(t))\cdot\vec r'(t)\,dt
=\int_0^{2\pi}\langle \sin t,-\cos t\rangle\cdot\langle -\sin t,\ \cos t\rangle\,dt
=\int_0^{2\pi}(\!-\,\sin^2 t+\cos^2 t)\,dt=0.
$$
> 이 장에서는 “미분·적분” 관점만 맛보기. (회전장/보존장 분석은 장 이론 파트에서 확장)

---

## 8) PyTorch 실습 코드 (자동미분/수치적분)

> **목표**: 주어진 $\vec r(t)$에 대해 $\vec r',\ \vec r'',\ v,\ $호장, 곡률을 **수치적으로** 구해보기.  
> 💡 사용 프레임워크: **PyTorch** (*사용자 선호*). GPU 불필요.

```python
# PyTorch: vector-valued function calculus toolkit
# - Compute r, v, a, speed, arc length, curvature for a parametric curve
# - Uses autograd (safe) and trapz for integration

import torch
torch.set_default_dtype(torch.float64)

# ---- define a scalar-to-vector function r(t): R -> R^3
def r_helix_scalar(t, a=1.0, b=0.5):
    # <a cos t, a sin t, b t>
    return torch.stack((a*torch.cos(t), a*torch.sin(t), b*t))

def componentwise_derivative(f_scalar, t):
    # returns vector of df/dt for each component of f(t) in R^3
    r = f_scalar(t)
    comps = []
    for i in range(r.numel()):
        gi = torch.zeros_like(r); gi[i] = 1.0
        dri = torch.autograd.grad(r, t, grad_outputs=gi, retain_graph=True, create_graph=True)[0]
        comps.append(dri)
    return torch.stack(comps)  # (3,)

@torch.no_grad()
def normalize(v, eps=1e-12):
    n = torch.linalg.vector_norm(v, dim=-1, keepdim=True).clamp_min(eps)
    return v / n

def sample_curve(f_scalar, t_vals):
    rL, vL, aL = [], [], []
    for tv in t_vals:
        t = tv.clone().detach().requires_grad_(True)
        r = f_scalar(t)                                  # (3,)
        v = componentwise_derivative(f_scalar, t)        # (3,)
        # second derivative
        a_comps = []
        for i in range(v.numel()):
            dvi = v[i]
            d2vi = torch.autograd.grad(dvi, t, retain_graph=True)[0]
            a_comps.append(d2vi)
        a = torch.stack(a_comps)                         # (3,)
        rL.append(r.detach()); vL.append(v.detach()); aL.append(a.detach())
    r = torch.stack(rL)         # (N,3)
    v = torch.stack(vL)         # (N,3)
    a = torch.stack(aL)         # (N,3)
    speed = torch.linalg.vector_norm(v, dim=-1)                  # (N,)
    cross = torch.cross(v, a, dim=-1)
    kappa = torch.linalg.vector_norm(cross, dim=-1) / (speed**3).clamp_min(1e-12)
    T = normalize(v)
    # simple central-diff for T' to get a rough N
    Tp = torch.zeros_like(T)
    if len(t_vals) >= 3:
        Tp[1:-1] = T[2:] - T[:-2]
    N = normalize(Tp)
    B = torch.cross(T, N, dim=-1)
    return {"r": r, "v": v, "a": a, "speed": speed, "kappa": kappa, "T": T, "N": N, "B": B}

# --- sample: helix
N = 400
t_vals = torch.linspace(0.0, 2.0*torch.pi, N)
out = sample_curve(lambda t: r_helix_scalar(t, a=1.0, b=0.5), t_vals)

# arc length by numerical integration
L_num = torch.trapz(out["speed"], t_vals).item()
print("Numeric arc length on [0, 2π]:", L_num)
print("Expected (constant speed): sqrt(a^2+b^2)*2π =", ( (1.0**2 + 0.5**2)**0.5 * 2.0*3.141592653589793 ))
print("Mean speed:", out["speed"].mean().item())
print("Mean curvature (≈ a/(a^2+b^2) = 1/1.25 = 0.8):", out["kappa"].mean().item())
```

**출력 해석**
- 호장 $L\approx \sqrt{a^2+b^2}\,2\pi$  
- 평균 곡률 $\approx \dfrac{a}{a^2+b^2}$ (헬릭스의 폐형식과 일치)

> ⚠️ 팁  
> 토션(비틀림) $\tau$는 3차 미분/혼합곱이 필요해 수치적으로 민감합니다. 스플라인 보간 후 미분 또는 스무딩 권장.

---

## 9) 체크리스트·주의점

1. **정칙성**: $v(t)=0$인 점에서는 $\vec T,\ \kappa$가 불안정 → 구간 분리/재매개화.  
2. **스케일**: $t$가 실제 시간인지, 단순 파라미터인지 구분(물리 단위 해석에 중요).  
3. **수치 안정성**: 정규화/나눗셈에 $\varepsilon$ 클램프.  
4. **아크길이 매개화**: 균일 샘플링, 카메라/로봇 등 경로 제어에 유리.  
5. **가속도 분해**: $a_T=\dfrac{dv}{dt}$, $a_N=v^2\kappa$는 주행 안전/제어 제한 설정의 핵심.  
6. **선적분 연결**: $d\vec r=\vec r'(t)\,dt$ 덕분에 곡선을 따라 물리량 누적이 자연스럽게 구현.

---

## 10) 연습문제(간단 해답 포함)

1) $\vec r(t)=\langle 3\cos t,\,3\sin t,\,4t\rangle$, $t\in[0,\pi]$.  
   - $v=\sqrt{3^2+4^2}=5$ (상수) → $L=5\pi$.

2) $\vec r(t)=\langle t,\,t^2,\,0\rangle$.  
   - $\displaystyle \kappa(t)=\dfrac{2}{(1+4t^2)^{3/2}}$.

3) $\vec v(t)=\langle 2t,\,\cos t,\,e^{-t}\rangle$, $t\in[0,T]$, $\vec r(0)=\vec 0$.  
   - $\vec r(T)=\langle T^2,\,\sin T,\,1-e^{-T}\rangle$.

4) $\vec r(t)=\langle R\cos(\omega t),\,R\sin(\omega t)\rangle$.  
   - $v=R\omega$, $a_T=0$, $a_N=R\omega^2$.

---

## 요약

| 개념 | 핵심 식 | 해석 |
|---|---|---|
| 속도/가속도 | $\vec v=\vec r',\ \vec a=\vec r''$ | 접선/방향 변화율 |
| 속력 | $v=\|\vec r'\|$ | 운동 강도 |
| 호장 | $L=\int\|\vec r'\|\,dt$ | 곡선의 길이 |
| 곡률 | $\displaystyle \kappa=\frac{\|\vec r'\times\vec r''\|}{\|\vec r'\|^3}$ | 굽음 정도 |
| 분해 | $\vec a=\frac{dv}{dt}\vec T+v^2\kappa\,\vec N$ | 가감속 vs 방향변화 |
| 적분복원 | $\vec v=\vec v_0+\int\vec a,\ \vec r=\vec r_0+\int\vec v$ | 초기값으로 경로 복원 |
