---
layout: post
title: 미적분 - 벡터함수의 미분과 적분
date: 2025-07-27 18:20:23 +0900
category: 미적분
---
# 벡터함수의 미분과 적분

## 벡터함수 복습과 해석

### 정의와 예시

$$
\vec r(t)=\langle x(t),\,y(t),\,z(t)\rangle,\quad t\in I\subset\mathbb{R}.
$$

- 입력은 스칼라(보통 시간), 출력은 벡터.
- 예: 헬릭스
$$
\vec r(t)=\langle \cos t,\,\sin t,\,t\rangle.
$$

### 극한과 연속

$$
\lim_{t\to a}\vec r(t)=\big\langle \lim_{t\to a}x(t),\,\lim_{t\to a}y(t),\,\lim_{t\to a}z(t)\big\rangle,
$$
$$
\vec r \text{ 가 } t=a \text{ 에서 연속}\iff x,y,z \text{ 가 모두 } a \text{ 에서 연속}.
$$

---

## 벡터함수의 **미분** — 규칙과 의미

### 성분별 미분(정의)

$$
\vec r'(t)=\frac{d\vec r}{dt}=\langle x'(t),\,y'(t),\,z'(t)\rangle.
$$
- $$\vec v(t)=\vec r'(t)$$: **속도 벡터**
- $$\vec a(t)=\vec r''(t)=\vec v'(t)$$: **가속도 벡터**
- 속력(스칼라) $$v(t)=\|\vec r'(t)\|.$$

### 미분 규칙 요약

스칼라 $$f,g$$, 벡터 $$\vec r,\vec u,\vec w$$, 상수 $$c$$:
- 선형성
$$
\frac{d}{dt}(f\vec r)=f'\vec r+f\vec r',\quad \frac{d}{dt}(\vec u+\vec w)=\vec u'+\vec w'.
$$
- 점곱
$$
\frac{d}{dt}(\vec u\cdot \vec w)=\vec u'\cdot \vec w+\vec u\cdot \vec w'.
$$
- 벡터곱(3D)
$$
\frac{d}{dt}(\vec u\times \vec w)=\vec u'\times \vec w+\vec u\times \vec w'.
$$
- 연쇄
$$
\frac{d}{dt}\vec r(\phi(t))=\vec r'(\phi(t))\,\phi'(t).
$$

### 기하적 의미(접선·법선)

- $$\vec r'(t)$$: 매개곡선의 접선 방향
- **단위 접선** $$\vec T=\dfrac{\vec r'}{\|\vec r'\|}$$
- **단위 법선**(정의는 §5 참조)

### 미분 예제

초안의 예제를 확장:
$$
\vec r(t)=\langle t^2,\,\sin t,\,\ln t\rangle\Rightarrow
\vec r'(t)=\langle 2t,\,\cos t,\,\tfrac1t\rangle,\quad
\vec r''(t)=\langle 2,\,-\sin t,\,-\tfrac1{t^2}\rangle.
$$

---

## 벡터함수의 **적분** — 성분별·기본정리·변위

### 성분별 적분(부정·정적분)

$$
\int \vec r(t)\,dt=\left\langle \int x(t)\,dt,\,\int y(t)\,dt,\,\int z(t)\,dt\right\rangle+\vec C,
$$
$$
\int_a^b \vec r(t)\,dt=\left\langle \int_a^b x(t)\,dt,\,\int_a^b y(t)\,dt,\,\int_a^b z(t)\,dt\right\rangle.
$$

### 벡터판 미적분학의 기본정리

$$
\frac{d}{dt}\left(\int_{t_0}^{t}\vec r(\tau)\,d\tau\right)=\vec r(t),
\quad
\int_a^b \vec r'(t)\,dt=\vec r(b)-\vec r(a).
$$

- 좌변은 **누적 효과의 변화율 = 순간값**.
- 우변은 **속도의 적분 = 변위**.

### 변위와 이동거리

- 변위(벡터) $$\Delta \vec r=\int_a^b \vec r'(t)\,dt=\vec r(b)-\vec r(a).$$
- 이동거리(스칼라) $$S=\int_a^b \|\vec r'(t)\|\,dt$$ 는 **호의 길이**(§4).

### 적분 예제

$$
\vec r(t)=\langle t,\,t^2,\,\sin t\rangle\Rightarrow
\int \vec r(t)\,dt=\left\langle \tfrac{t^2}{2},\,\tfrac{t^3}{3},\,-\cos t\right\rangle+\vec C.
$$

---

## 호의 길이 · 속력 · 재매개화

### 호의 길이

미소 길이 $$ds\approx \|\vec r'(t)\|dt \Rightarrow$$
$$
L=\int_a^b \|\vec r'(t)\|\,dt.
$$

### 속력

$$
v(t)=\|\vec r'(t)\|=\sqrt{(x')^2+(y')^2+(z')^2}.
$$

### 호길이 매개화와 등속화

누적 길이
$$
s(t)=\int_{t_0}^t \|\vec r'(\tau)\|\,d\tau.
$$
역함수 $$t=t(s)$$ 가 가능하면 $$\vec r(s)=\vec r(t(s))$$ 로 재매개화되어
$$
\left\|\frac{d\vec r}{ds}\right\|=1.
$$

---

## 곡률(κ) · T–N 분해 · 프레네 프레임(개요)

### 단위 접선·법선

$$
\vec T=\frac{\vec r'}{\|\vec r'\|},\qquad
\vec N=\frac{\vec T'}{\|\vec T'\|}\quad(\|\vec T'\|\neq 0).
$$
3D에서는 **이면벡터**
$$
\vec B=\vec T\times \vec N.
$$

### 곡률의 등가식(3D/2D)

3D 일반식
$$
\kappa(t)=\frac{\|\vec r'(t)\times \vec r''(t)\|}{\|\vec r'(t)\|^3}
=\frac{\|\vec T'(t)\|}{\|\vec r'(t)\|}
=\left\|\frac{d\vec T}{ds}\right\|.
$$
2D 매개식
$$
\kappa(t)=\frac{|x'(t)\,y''(t)-y'(t)\,x''(t)|}{\big(x'(t)^2+y'(t)^2\big)^{3/2}}.
$$

### 가속도의 T–N 분해

속력 $$v=\|\vec r'\|$$. 그러면
$$
\vec v=v\,\vec T,\qquad
\vec a=\frac{dv}{dt}\,\vec T+v\,\frac{d\vec T}{dt}
=\underbrace{\frac{dv}{dt}}_{a_T}\vec T+\underbrace{v^2\kappa}_{a_N}\,\vec N.
$$
- $$a_T$$: 속력 변화(탄젠셜), $$a_N$$: 방향 변화(법선).

---

## 예제 — 원·헬릭스·등가속

### 원(반지름 $$R$$)

$$
\vec r(t)=\langle R\cos t,\,R\sin t\rangle,\quad
\vec r'=\langle -R\sin t,\,R\cos t\rangle,\quad v=R.
$$
$$
\kappa=\frac1R,\quad
\vec a=\vec r''=\langle -R\cos t,\,-R\sin t\rangle=-R\,\frac{\vec r}{R}=-R\,\hat r,
$$
$$
a_T=0,\quad a_N=v^2\kappa=R^2\cdot \frac1R=R.
$$

### 헬릭스(상수 곡률·토션)

$$
\vec r(t)=\langle a\cos t,\,a\sin t,\,bt\rangle,\quad
\|\vec r'\|=\sqrt{a^2+b^2}.
$$
$$
\kappa=\frac{a}{a^2+b^2},\qquad \text{(토션) }\ \tau=\frac{b}{a^2+b^2}.
$$

### 등가속 직선운동

$$
\vec a(t)=\vec a_0\ \text{(상수)}\Rightarrow
\vec v(t)=\vec v_0+\vec a_0 t,\quad
\vec r(t)=\vec r_0+\vec v_0 t+\tfrac12\vec a_0 t^2.
$$
- 변위 $$\Delta \vec r=\int_0^T \vec v\,dt=\vec v_0 T+\tfrac12\vec a_0 T^2.$$

---

## 벡터 적분과 **일(work)** — 선적분 연결

힘장이 경로에 가한 일:
$$
W=\int_C \vec F\cdot d\vec r=\int_{t=a}^{b}\vec F(\vec r(t))\cdot \vec r'(t)\,dt.
$$
- 위치가 직접 주어지면 위 식을 사용.
- 보존장(퍼텐셜)에서는 **경로와 무관**하게 시작/끝점만 좌우.

---

## 수치 안정성 팁

- $$\|\vec r'\|\to 0$$ 구간에서 곡률 분모 $$\|\vec r'\|^3$$ 로 인해 민감. **스무딩·재샘플링** 권장.
- 차분 미분은 잡음에 취약. **Savitzky–Golay**, **스플라인** 사용.
- 프레임 연속성: $$\vec N,\vec B$$ 부호 일관화(이전 프레임과 내적이 음수면 부호 반전).
- 정규화는 $$\max(\|\cdot\|,\varepsilon)$$ 로 안정화.

---

## PyTorch 실습 — 미분·적분·호의 길이·곡률 검증

> 사용자의 선호에 맞춰 PyTorch로 예제를 구성한다. 오토그라드 기반 단일 점 미분과, 격자 샘플에서의 수치 미분/적분(사다리꼴)을 함께 보여준다.

### 오토그라드로 헬릭스의 $$\kappa,\tau$$ 검증

```python
import torch

def r_helix(t, a=2.0, b=1.0):
    return torch.stack([a*torch.cos(t), a*torch.sin(t), b*t], dim=-1)

def vec_grad(y, t):
    # y: (..., 3) w.r.t scalar t
    grads = []
    for i in range(y.shape[-1]):
        (gi,) = torch.autograd.grad(y[..., i], t, grad_outputs=torch.ones_like(t), create_graph=True)
        grads.append(gi)
    return torch.stack(grads, dim=-1)

t = torch.tensor(1.234, requires_grad=True)
r  = r_helix(t)
r1 = vec_grad(r, t)   # r'(t)
r2 = vec_grad(r1, t)  # r''(t)
r3 = vec_grad(r2, t)  # r'''(t)

v = torch.linalg.vector_norm(r1)
kappa = torch.linalg.vector_norm(torch.cross(r1, r2)) / (v**3 + 1e-12)
torsion = torch.dot(torch.cross(r1, r2), r3) / (torch.linalg.vector_norm(torch.cross(r1, r2))**2 + 1e-12)

print("kappa ≈", kappa.item(), " (expected  a/(a^2+b^2)=0.4)")
print("tau   ≈", torsion.item(), " (expected  b/(a^2+b^2)=0.2)")
```

### 격자 샘플에서 호의 길이·곡률·T–N 분해

```python
import torch

def sample_curve(r_func, t0, t1, n=2001):
    t = torch.linspace(t0, t1, n)
    r = r_func(t)
    return t, r

def finite_diff(x, dt):
    x1 = torch.zeros_like(x)
    x1[1:-1] = (x[2:] - x[:-2]) / (2*dt)
    x1[0]    = (x[1] - x[0]) / dt
    x1[-1]   = (x[-1] - x[-2]) / dt
    return x1

def frenet_from_samples(r, t):
    dt = (t[1]-t[0]).item()
    r1 = finite_diff(r, dt)
    r2 = finite_diff(r1, dt)

    v  = torch.linalg.vector_norm(r1, dim=-1, keepdim=True).clamp_min(1e-12)
    T  = r1 / v
    T1 = finite_diff(T, dt)
    T1n = torch.linalg.vector_norm(T1, dim=-1, keepdim=True).clamp_min(1e-12)
    N  = T1 / T1n

    if r.shape[1] == 3:
        B = torch.cross(T, N, dim=-1)
        cross12 = torch.cross(r1, r2, dim=-1)
        kappa = torch.linalg.vector_norm(cross12, dim=-1) / (torch.linalg.vector_norm(r1, dim=-1)**3 + 1e-12)
    else:
        B = None
        x1, y1 = r1[:,0], r1[:,1]
        x2, y2 = r2[:,0], r2[:,1]
        kappa = (x1*y2 - y1*x2).abs() / ((x1**2 + y1**2)**1.5 + 1e-12)

    return v.squeeze(-1), T, N, B, kappa

def arc_length(v, t):
    return torch.trapz(v, t)

# 원 운동 검증

R = 3.0
r_circle = lambda tt: torch.stack([R*torch.cos(tt), R*torch.sin(tt)], dim=-1)

t, r = sample_curve(r_circle, 0.0, 2*torch.pi, n=4001)
v, T, N, B, kappa = frenet_from_samples(r, t)

dt = (t[1]-t[0]).item()
r1 = finite_diff(r, dt)
r2 = finite_diff(r1, dt)
a  = r2
a_T = (a * T).sum(dim=-1)
a_N = (a * N).sum(dim=-1)

L = arc_length(v, t)

print("Arc length ≈", L.item(), " (expected 2πR =", 2*torch.pi*R, ")")
print("mean speed ≈", v.mean().item(), " (expected R =", R, ")")
print("mean kappa ≈", kappa.mean().item(), " (expected 1/R =", 1.0/R, ")")
print("mean a_T ≈", a_T.mean().item(), " (~0 for uniform speed)")
print("mean a_N ≈", a_N.mean().item(), " (expected R =", R, ")")
```

### 벡터판 기본정리(수치 확인)

```python
import torch

# r'(t)를 적분하면 r(b)-r(a) 와 같아야 한다.

r = lambda tt: torch.stack([tt**2, torch.sin(tt), torch.log(tt)], dim=-1)
t = torch.linspace(1.0, 2.0, 1001)
dt = (t[1]-t[0]).item()

# 수치 미분으로 r'(t) 근사

r_samp = r(t)
r1 = torch.zeros_like(r_samp)
r1[1:-1] = (r_samp[2:] - r_samp[:-2]) / (2*dt)
r1[0]    = (r_samp[1] - r_samp[0]) / dt
r1[-1]   = (r_samp[-1] - r_samp[-2]) / dt

# 성분별 사다리꼴 적분

I = torch.trapz(r1, t, dim=0)
print("∫ r'(t) dt ≈", I)
print("r(b)-r(a)  =", r(2.0) - r(1.0))
```

---

## 연습문제(확장)

1) **연쇄법칙 검증**
$$\vec r(u)=\langle u^2,\,\sin u\rangle,\ \ u=\sqrt{t}$$ 에 대해
$$\frac{d}{dt}\vec r(u(t))=\vec r'(u)\,u'(t)$$ 를 성분별로 확인.

2) **곡률 등가식 증명**
3D에서
$$\kappa=\dfrac{\|\vec r'\times \vec r''\|}{\|\vec r'\|^3}=\dfrac{\|\vec T'\|}{\|\vec r'\|}$$
을 보이라.

3) **T–N 분해 유도**
$$\vec v=v\vec T$$ 를 미분해
$$\vec a=\dfrac{dv}{dt}\vec T+v^2\kappa\vec N$$ 을 도출.

4) **호길이 매개화**
주어진 $$\vec r(t)$$ 에서 $$s(t)=\int_{t_0}^t \|\vec r'(\tau)\|d\tau$$ 로 재매개화하면
$$\big\|\dfrac{d\vec r}{ds}\big\|=1$$ 임을 보여라.

5) **선적분 기본 예제**
$$\vec F(x,y)=\langle -y,\,x\rangle,\ C:\ \vec r(t)=\langle \cos t,\,\sin t\rangle,\ t\in[0,2\pi]$$
에 대해 $$\int_C \vec F\cdot d\vec r$$ 를 계산하고, 그린정리와 일치함을 확인.

---

## 요약 정리표

| 주제 | 핵심 수식 | 의미 |
|---|---|---|
| 미분(정의) | $$\vec r'=\langle x',y',z'\rangle$$ | 접선 방향, 속도 |
| 적분(정의) | $$\int \vec r=\langle \int x,\int y,\int z\rangle+\vec C$$ | 성분별 적분 |
| 기본정리 | $$\int_a^b \vec r'=\vec r(b)-\vec r(a)$$ | 속도 적분=변위 |
| 속력 | $$v=\|\vec r'\|$$ | 길이 변화율 |
| 호의 길이 | $$L=\int \|\vec r'\| dt$$ | 이동거리 |
| 단위접선 | $$\vec T=\vec r'/\|\vec r'\|$$ | 방향 |
| 곡률(3D) | $$\kappa=\|\vec r'\times \vec r''\|/\|\vec r'\|^3$$ | 굽음 정도 |
| T–N 분해 | $$\vec a=\tfrac{dv}{dt}\vec T+v^2\kappa\vec N$$ | 속력·방향 분리 |
| 선적분 | $$\int_C \vec F\cdot d\vec r=\int \vec F(\vec r)\cdot \vec r' dt$$ | 일이자 에너지 |

---

## 마무리

벡터함수의 미분과 적분은 **성분별 연산**으로 단순하지만, 해석은 깊다. 미분은 **방향/속도**를, 적분은 **누적/변위**를 제공하며, 호의 길이·곡률·T–N 분해로 곡선의 정밀한 기하를 드러낸다. 물리에서는 일·에너지·중심력·원운동의 정량적 해석을 가능하게 하고, 수치적으로는 **정규화·스무딩·재매개화**가 정확도와 안정성을 좌우한다. 위 PyTorch 예제는 이러한 이론을 **검산 가능한 코드**로 뒷받침한다.
