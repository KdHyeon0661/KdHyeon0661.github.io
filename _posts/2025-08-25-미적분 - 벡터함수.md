---
layout: post
title: 미적분 - 벡터함수
date: 2025-08-25 19:20:23 +0900
category: 미적분
---
# 벡터함수(Vector-Valued Function)

## 1. 정의와 표기

### 1.1 벡터함수의 정의
$$
\vec r: I\subset\mathbb{R}\to \mathbb{R}^n,\quad
\vec r(t)=\langle x_1(t),\dots,x_n(t)\rangle.
$$
- 보통 \(n=2,3\). \(t\)는 매개변수(시간으로 해석 가능).

### 1.2 예시
- **단위원**(2D):  
  $$
  \vec r(t)=\langle \cos t,\ \sin t\rangle,\quad t\in[0,2\pi].
  $$
- **원통형 헬릭스**(3D):  
  $$
  \vec r(t)=\langle a\cos t,\ a\sin t,\ bt\rangle.
  $$

---

## 2. 극한과 연속

### 2.1 성분별 극한
$$
\lim_{t\to t_0}\vec r(t)
=\big\langle \lim_{t\to t_0}x_1(t),\dots,\lim_{t\to t_0}x_n(t)\big\rangle.
$$

### 2.2 연속성 판정
$$
\vec r \text{가 } t_0 \text{에서 연속}\ \iff\ x_i \text{가 모두 } t_0 \text{에서 연속}.
$$

---

## 3. 미분: 성분별·규칙·기하적 의미

### 3.1 성분별 미분
$$
\vec r'(t)=\frac{d}{dt}\vec r(t)=\langle x_1'(t),\dots,x_n'(t)\rangle.
$$
- **속도 벡터**: \( \vec v=\vec r'(t) \).  
- **가속도 벡터**: \( \vec a=\vec r''(t) \).

### 3.2 규칙(연쇄·곱)
스칼라 \(f,g\), 벡터 \(\vec r,\vec u,\vec v\), 상수 벡터 \(\vec c\).
- **선형성**: \( (f\vec r)'=f'\vec r+f\vec r' \), \( (\vec r+\vec u)'=\vec r'+\vec u' \)
- **점곱**: \( \frac{d}{dt}(\vec u\cdot\vec v)=\vec u'\cdot\vec v+\vec u\cdot\vec v' \)
- **벡터곱(3D)**: \( \frac{d}{dt}(\vec u\times\vec v)=\vec u'\times\vec v+\vec u\times\vec v' \)
- **연쇄**: \( \frac{d}{dt}\vec r(\phi(t))=\vec r'(\phi(t))\,\phi'(t) \)

### 3.3 기하적 의미
- \( \vec r'(t) \)는 곡선의 **접선 방향**(속도 방향).
- 속력(스칼라)  
  $$
  v(t)=\|\vec r'(t)\|=\sqrt{\sum_i (x_i'(t))^2}.
  $$

---

## 4. 적분과 평균, 변위/이동거리

### 4.1 성분별 적분
$$
\int_a^b \vec r(t)\,dt
=\Big\langle \int_a^b x_1(t)\,dt,\dots,\int_a^b x_n(t)\,dt\Big\rangle.
$$

### 4.2 변위와 이동거리
- **변위**: \( \Delta \vec r=\vec r(b)-\vec r(a)=\int_a^b \vec r'(t)\,dt \).  
- **이동거리(호의 길이)**: \( S=\int_a^b \|\vec r'(t)\|\,dt \). (아래 §5)

---

## 5. 호의 길이와 재매개화

### 5.1 호의 길이 공식(유도)
미소 길이 \( ds\approx \|\vec r'(t)\|dt \Rightarrow \)
$$
L=\int_a^b \|\vec r'(t)\|\,dt.
$$

### 5.2 등속 매개화와 재매개화
- 일반적으로 \(v(t)=\|\vec r'(t)\|\) 는 상수가 아님.  
- **호의 길이 매개변수** \( s(t)=\int_{t_0}^t \|\vec r'(\tau)\|\,d\tau \).  
- 가능하다면 \( t=t(s) \) 로 역함수 잡아 \( \vec r(s)=\vec r(t(s)) \) 로 재매개화하면 \( \|\vec r'(s)\|=1 \).

---

## 6. 곡률(κ)과 토션(τ), Frenet–Serret

### 6.1 단위 접선·법선·이면벡터
$$
\vec T(t)=\frac{\vec r'(t)}{\|\vec r'(t)\|},\qquad
\vec N(t)=\frac{\vec T'(t)}{\|\vec T'(t)\|},\qquad
\vec B(t)=\vec T(t)\times \vec N(t)\quad(3D).
$$

### 6.2 곡률(3D 등가식)
$$
\kappa(t)=\frac{\|\vec r'(t)\times \vec r''(t)\|}{\|\vec r'(t)\|^3}
=\frac{\|\vec T'(t)\|}{\|\vec r'(t)\|}
= \left\| \frac{d\vec T}{ds} \right\|.
$$

### 6.3 2D 곡률
평면 곡선 \( \vec r(t)=\langle x(t),y(t)\rangle \):
$$
\kappa(t)=\frac{|x'(t)y''(t)-y'(t)x''(t)|}{\big(x'(t)^2+y'(t)^2\big)^{3/2}}.
$$

### 6.4 토션(비틀림, 3D)
$$
\tau(t)=\frac{\big(\vec r'(t)\times \vec r''(t)\big)\cdot \vec r'''(t)}{\|\vec r'(t)\times \vec r''(t)\|^2}.
$$

### 6.5 Frenet–Serret 공식(호의 길이 \(s\) 매개)
$$
\frac{d\vec T}{ds}=\kappa\,\vec N,\qquad
\frac{d\vec N}{ds}=-\kappa\,\vec T+\tau\,\vec B,\qquad
\frac{d\vec B}{ds}=-\tau\,\vec N.
$$

---

## 7. 속도/가속도의 T–N 분해

속력 \( v=\|\vec r'(t)\| \). 그러면
$$
\vec v = \frac{d\vec r}{dt}=v\,\vec T,\qquad
\vec a=\frac{d\vec v}{dt}=\frac{dv}{dt}\,\vec T+v\,\frac{d\vec T}{dt}.
$$
또한 \( \frac{d\vec T}{dt}=\frac{d\vec T}{ds}\frac{ds}{dt}=\kappa v\,\vec N \) 이므로
$$
\boxed{\ \vec a=a_T\,\vec T+a_N\,\vec N,\quad a_T=\frac{dv}{dt},\ \ a_N=v^2\kappa\ }.
$$
- \( a_T \)는 **탄젠셜** 가속도(속력 변화), \( a_N \)은 **법선** 가속도(방향 변화).

---

## 8. 대표 곡선의 분석

### 8.1 원(반지름 \(R\)): \( \vec r(t)=\langle R\cos t, R\sin t\rangle \)
- \( \|\vec r'(t)\|=R \) ⇒ 등속(단, 매개 \(t\)가 시간일 필요는 없음).
- 곡률 \( \kappa=\dfrac{1}{R} \), \( \vec a = -R\,\vec r(t) \).

### 8.2 헬릭스: \( \vec r(t)=\langle a\cos t,\ a\sin t,\ bt\rangle \)
- \( \|\vec r'(t)\|=\sqrt{a^2+b^2} \) (상수).  
- 곡률, 토션(상수):
$$
\kappa=\frac{a}{a^2+b^2},\qquad \tau=\frac{b}{a^2+b^2}.
$$

### 8.3 리사주 곡선(2D): \( \vec r(t)=\langle \cos(\alpha t),\ \sin(\beta t)\rangle \)
- 폐곡선 조건은 \( \alpha/\beta\in\mathbb{Q} \).  
- 곡률은 \(x',y',x'',y''\)로 §6.3에 대입하여 구함.

---

## 9. 수치 안정성·실무 팁

1) **속도 0 부근**에서 곡률은 민감: 분모 \( \|\vec r'\|^3 \) → 작은 값이면 큰 오차.  
2) **스무딩/재매개화**: 일정 호길이 간격으로 샘플링하면 곡률·프레임 안정.  
3) **차분 차수**: 2계·3계 미분이 필요(토션). 노이즈에 매우 민감 ⇒ Savitzky–Golay, 스플라인 권장.  
4) **클램핑**: 단위화 시 \( \max(\|\cdot\|,\varepsilon) \) 사용.  
5) **프레임 연속성**: \(\vec N,\vec B\)의 부호 뒤집힘 방지 위해 프레임 일관성(평활화) 적용.

---

## 10. PyTorch 실습 — 곡률/토션·Frenet 프레임·호의 길이

> PyTorch 사용(사용자 선호). 오토그라드 기반 단일 \(t\) 미분과, 샘플 격자에서의 수치 적분/차분 예시를 함께 제시한다.

### 10.1 오토그라드로 미분(헬릭스의 κ, τ 검증)

```python
import torch

def r_helix(t, a=2.0, b=1.0):
    return torch.stack([a*torch.cos(t), a*torch.sin(t), b*t], dim=-1)

def deriv(f, t, create_graph=True):
    """1차 미분: f(t) -> R^3"""
    (dfdt,) = torch.autograd.grad(f, t, grad_outputs=torch.ones_like(f), create_graph=create_graph)
    return dfdt

def vec_deriv(vec_f, t):
    """vec_f(t) -> R^3, 성분별 미분"""
    grads = []
    for i in range(vec_f.shape[-1]):
        (g,) = torch.autograd.grad(vec_f[..., i], t, grad_outputs=torch.ones_like(t), create_graph=True)
        grads.append(g)
    return torch.stack(grads, dim=-1)

t = torch.tensor(1.234, requires_grad=True)
r = r_helix(t)
r1 = vec_deriv(r, t)    # r'(t)
r2 = vec_deriv(r1, t)   # r''(t)
r3 = vec_deriv(r2, t)   # r'''(t)

v = torch.linalg.vector_norm(r1)
kappa = torch.linalg.vector_norm(torch.cross(r1, r2)) / (v**3 + 1e-12)
tors  = torch.dot(torch.cross(r1, r2), r3) / (torch.linalg.vector_norm(torch.cross(r1, r2))**2 + 1e-12)

print("κ(helix) ≈", kappa.item(), "  expected a/(a^2+b^2)=2/(4+1)=0.4")
print("τ(helix) ≈", tors.item(),  "  expected b/(a^2+b^2)=1/5=0.2")
```

### 10.2 격자 샘플에서 호의 길이·곡률·Frenet 프레임

```python
import torch

def sample_curve(r_func, t0, t1, n=2001):
    t = torch.linspace(t0, t1, n)
    r = r_func(t)
    return t, r

def finite_diff(x, dt):
    # 중앙차분(내부), 전/후방차분(끝점)
    x1 = torch.zeros_like(x)
    x1[1:-1] = (x[2:] - x[:-2]) / (2*dt)
    x1[0]    = (x[1] - x[0]) / dt
    x1[-1]   = (x[-1] - x[-2]) / dt
    return x1

def frenet_from_samples(r, t):
    dt = (t[1]-t[0]).item()
    r1 = finite_diff(r, dt)
    r2 = finite_diff(r1, dt)

    v = torch.linalg.vector_norm(r1, dim=-1, keepdim=True).clamp_min(1e-12)
    T = r1 / v

    # N: T' 정규화
    T1 = finite_diff(T, dt)
    T1n = torch.linalg.vector_norm(T1, dim=-1, keepdim=True).clamp_min(1e-12)
    N = T1 / T1n

    # B: 3D인 경우만
    if r.shape[1] == 3:
        B = torch.cross(T, N, dim=-1)
    else:
        B = None

    # κ (3D/2D 공용식)
    cross_r1r2 = torch.cross(r1, r2, dim=-1) if r.shape[1]==3 else torch.zeros_like(r1)
    if r.shape[1]==3:
        kappa = torch.linalg.vector_norm(cross_r1r2, dim=-1) / (torch.linalg.vector_norm(r1, dim=-1)**3 + 1e-12)
    else:
        x1, y1 = r1[:,0], r1[:,1]
        x2, y2 = r2[:,0], r2[:,1]
        kappa = (x1*y2 - y1*x2).abs() / ((x1**2 + y1**2)**1.5 + 1e-12)

    return v.squeeze(-1), T, N, B, kappa

def arc_length(v, t):
    # 사다리꼴 적분
    return torch.trapz(v, t)

# 헬릭스 샘플
a, b = 2.0, 1.0
r_func = lambda tt: torch.stack([a*torch.cos(tt), a*torch.sin(tt), b*tt], dim=-1)

t, r = sample_curve(r_func, 0.0, 10.0, n=4001)
v, T, N, B, kappa = frenet_from_samples(r, t)
L = arc_length(v, t)

print("Arc length ≈", L.item(), " ; expected sqrt(a^2+b^2)*(t1-t0) =", ( (a*a+b*b)**0.5 * 10.0 ))
print("kappa mean ≈", kappa.mean().item(), " ; expected", a/(a*a+b*b))
```

### 10.3 2D 원에서의 곡률·T–N 분해 검증

```python
import torch

R = 3.0
r2d = lambda tt: torch.stack([R*torch.cos(tt), R*torch.sin(tt)], dim=-1)

t, r = sample_curve(r2d, 0.0, 2*torch.pi, n=2001)
v, T, N, B, kappa = frenet_from_samples(r, t)
# 이론: v=R(상수), κ=1/R, a_N = v^2 * κ = R^2 * (1/R) = R
dt = (t[1]-t[0]).item()
r1 = finite_diff(r, dt)
r2 = finite_diff(r1, dt)
a = r2  # 시간 매개로 보면 a=r''(t)

a_T = (a * T).sum(dim=-1)
a_N = (a * N).sum(dim=-1)

print("mean speed ≈", v.mean().item(), " expected R =", R)
print("mean kappa ≈", kappa.mean().item(), " expected 1/R =", 1.0/R)
print("mean a_T ≈", a_T.mean().item(), " ~ 0 (등속)")
print("mean a_N ≈", a_N.mean().item(), " expected R =", R)
```

---

## 11. 사례 연구

### 11.1 발사체(공기저항 무시) — 2D 운동학
초속도 \(v_0\), 각도 \(\theta_0\), 중력 \(g\).
$$
\vec r(t)=\langle v_0\cos\theta_0\ t,\ v_0\sin\theta_0\ t-\tfrac12 g t^2\rangle.
$$
- \( \vec v=\langle v_0\cos\theta_0,\ v_0\sin\theta_0-gt\rangle \)  
- \( \vec a=\langle 0,\ -g\rangle \) (상수 가속도)  
- 최고점에서 \( v_y=0 \Rightarrow t^\ast=\dfrac{v_0\sin\theta_0}{g} \).

### 11.2 평면 곡선 샘플에서 곡률 피크=코너 감지
측정된 경로 \(\{(x_i,y_i)\}\) 를 일정 간격으로 보간 후 §10.2 의 곡률을 계산하면, 곡률 피크가 굴절(코너)을 잘 지시한다.

---

## 12. 재매개화(균등 호길이 샘플링)

곡률·프레임 안정화를 위해 **균등 호길이**로 재샘플링한다.
1) \(t\)-격자에서 누적 길이 \( s_k=\sum_{i<k}\|\vec r'(t_i)\|\Delta t\).  
2) 원하는 균등 \(s^\ast_j\) 에 대해 \(s\)–\(t\) 사상 보간 → \(t_j=\phi(s^\ast_j)\).  
3) \( \vec r(t_j) \)로 새 샘플 생성.  
수치 구현 시 스플라인/선형 보간으로 충분히 실용적.

---

## 13. 흔한 함정

- **정지점**(\(\|\vec r'\|\approx 0\))에서 곡률 폭증: 데이터 평활·재샘플 필수.  
- **프레임 불연속**: \(\vec N,\vec B\) 부호 임의성 → 연속성 강제(이전 프레임과 내적>0 유도).  
- **시간 vs 매개**: 물리적 시간과 수학적 매개가 다를 수 있음. 등속이 아니면 \(a_N=v^2\kappa\) 해석에 주의.  
- **차분 경계**: 전/후방 차분 오차 ↑ → 여유 구간 패딩/고차 보간 사용.

---

## 14. 연습문제(스케치)

1) **헬릭스의 \(\kappa,\tau\)**  
   \( \vec r(t)=\langle a\cos t,a\sin t,bt\rangle \) 에서 §8.2 결과 유도.  
   *힌트*: \( \|\vec r'\|=\sqrt{a^2+b^2} \), \( \|\vec r'\times \vec r''\|=a\sqrt{a^2+b^2} \).

2) **2D 곡률 등가**  
   \( \kappa=|\vec T'|/\|\vec r'\|\) 과 \( \kappa=\dfrac{|x'y''-y'x''|}{(x'^2+y'^2)^{3/2}} \) 동치 보이기.

3) **T–N 분해**  
   \( \vec a=\dfrac{dv}{dt}\vec T+v^2\kappa\vec N \) 유도.  
   *힌트*: \( \vec v=v\vec T \) 를 미분.

4) **리스사주 폐곡선 조건**  
   \( \alpha/\beta\in\mathbb{Q} \) 증명(최소공배수).

5) **재매개화**  
   주어진 \( \vec r(t) \) 에서 \( s(t) \) 정의로 \( \|\dfrac{d\vec r}{ds}\|=1 \) 확인.

---

## 15. 요약

- 벡터함수는 **성분별**로 연속/미분/적분을 판정할 수 있으며, **기하적** 의미(접선/속력/호길이)가 분명하다.  
- 곡률 \( \kappa \) 와 토션 \( \tau \) 는 **방향 변화**와 **공간 비틀림**을 정량화하고, Frenet–Serret 공식으로 프레임 동역학을 기술한다.  
- 가속도는 \( \vec a=a_T\vec T+a_N\vec N \) 으로 분해되어 **속력 변화**와 **방향 변화**를 분리 설명한다.  
- 수치 계산은 **정규화·클램핑·재매개화·스무딩**으로 안정성을 확보한다.  
- PyTorch 예제는 곡률·토션·프레임·호길이 계산을 **검산 가능한 형태**로 담았다.