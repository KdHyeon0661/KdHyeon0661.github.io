---
layout: post
title: 미적분 - 곡선의 면적분, 선적분, 스토크스 정리
date: 2025-08-25 22:20:23 +0900
category: 미적분
---
# 곡선의 면적분, 선적분, 스토크스 정리

## 0) 표기와 전제

- 곡선 \(C\): 충분히 매끄러운 곡선, 매개변수 \(\mathbf r(t)=(x(t),y(t),z(t)),\ t\in[a,b]\)  
- 곡면 \(S\): 매끄러운 곡면, 매개변수 \(\mathbf r(u,v),\ (u,v)\in D\)  
- 스칼라장 \(f\), 벡터장 \(\mathbf F=(P,Q,R)\)는 필요한 곳에서 \(C^1\) 이상으로 가정  
- 길이/면적 미소
  \[
  ds=\|\mathbf r'(t)\|\,dt,\qquad d\mathbf S=\mathbf n\,dS,\quad dS=\|\mathbf r_u\times \mathbf r_v\|\,du\,dv.
  \]

---

## 1) 선적분(Line Integral)

### 1.1 스칼라장에 대한 선적분(곡선을 따라 “누적 질량/열량” 등)
\[
\int_C f\,ds=\int_a^b f(\mathbf r(t))\;\|\mathbf r'(t)\|\,dt.
\]
- 곡선을 “미세한 길이 \(ds\)”로 쪼개어 \(f\)를 누적한다.

### 1.2 벡터장에 대한 선적분(일/에너지, 순환)
\[
\int_C \mathbf F\cdot d\mathbf r=\int_C P\,dx+Q\,dy+R\,dz
=\int_a^b \mathbf F(\mathbf r(t))\cdot \mathbf r'(t)\,dt.
\]
- 물리적 해석: 힘 \(\mathbf F\)가 곡선 \(C\)를 따라 한 **일(work)**.

### 1.3 보존장(그래디언트 장)과 경로독립성
\[
\mathbf F=\nabla\phi\ \text{이면}\ \int_{C_{A\to B}}\mathbf F\cdot d\mathbf r
=\phi(B)-\phi(A).
\]
- 단일연결 영역에서 \(\nabla\times\mathbf F=\mathbf 0 \iff\) 보존장 \(\iff\) 경로독립.

---

## 2) 면적분(Surface Integral)

### 2.1 스칼라장에 대한 면적분(곡면 위 총량)
\[
\iint_S f\,dS=\iint_D f(\mathbf r(u,v))\;\|\mathbf r_u\times \mathbf r_v\|\,du\,dv.
\]

### 2.2 벡터장에 대한 면적분(플럭스/유량)
\[
\iint_S \mathbf F\cdot d\mathbf S=\iint_S \mathbf F\cdot \mathbf n\,dS
=\iint_D \mathbf F(\mathbf r(u,v))\cdot(\mathbf r_u\times \mathbf r_v)\,du\,dv.
\]
- \(\mathbf n\)은 선택한 **방위(orientation)**에 따른 단위법선. 경계 방향과 일관되게 정한다(오른손 법칙).

---

## 3) 스토크스 정리(Stokes' Theorem)

### 3.1 정리
곡면 \(S\)가 경계곡선 \(\partial S\)를 갖고 \(\mathbf F\)가 \(C^1\)일 때,
\[
\oint_{\partial S}\mathbf F\cdot d\mathbf r
=\iint_S (\nabla\times\mathbf F)\cdot \mathbf n\,dS.
\]
- 좌변: 경계선에서의 **순환(circulation)**  
- 우변: 곡면 전체에서의 **회전(curl)** 누적

### 3.2 직관
- 내부에서 “소용돌이”가 크면 경계선을 한 바퀴 돌 때 “도는 힘”의 총합이 크다.
- **곡면을 어떻게 택해도 결과는 같다.** (동일한 경계, 일관된 방위)

### 3.3 그린 정리와의 연결(2D 특수형)
평면 \(z=0\), \(\mathbf F=(P,Q,0)\), \(\mathbf n=\mathbf k\)이면
\[
\oint_{\partial D} P\,dx+Q\,dy=\iint_D \Big(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\Big)\,dA.
\]

---

## 4) 대표 예제

### 예제 A — 스칼라 선적분(길이 가중 누적)
곡선 \(C: \mathbf r(t)=(t,t^2),\ t\in[0,1]\), \(f(x,y)=x\).
\[
\|\mathbf r'(t)\|=\sqrt{1+4t^2},\quad f(\mathbf r(t))=t.
\]
\[
\int_C f\,ds=\int_0^1 t\sqrt{1+4t^2}\,dt
=\frac{1}{12}\big(1+4t^2\big)^{3/2}\Big|_{0}^{1}
=\frac{1}{12}\big(5^{3/2}-1\big).
\]

### 예제 B — 벡터 선적분(단위원 경계에서의 순환)
\[
\mathbf F=(y,-x),\quad C:\ x^2+y^2=1,\ \text{반시계}.
\]
매개화 \(x=\cos t,\ y=\sin t,\ t\in[0,2\pi]\).
\[
\mathbf r'(t)=(-\sin t,\cos t),\quad
\mathbf F(\mathbf r(t))=(\sin t,-\cos t).
\]
\[
\int_0^{2\pi}\mathbf F\cdot\mathbf r'(t)\,dt
=\int_0^{2\pi}\big(-\sin^2 t-\cos^2 t\big)\,dt
=-\int_0^{2\pi}1\,dt=-2\pi.
\]
- 반시계 기준에서 음수가 나왔다. 왜? \(\mathbf F\)가 “시계방향 소용돌이”이기 때문이다.  
- \(\mathbf G=(-y/2,x/2)\)로 바꾸면 \(\nabla\times\mathbf G=(0,0,1)\) 이고 순환은 \(+\pi\)가 된다(아래 예제 C).

### 예제 C — 스토크스 정리 직접 검증(원판/반구 중 어떤 면을 골라도 동일)
\[
\mathbf F=\Big(-\frac{y}{2},\frac{x}{2},0\Big),\quad \nabla\times\mathbf F=(0,0,1).
\]

- **경계**: \(x^2+y^2=1\) 원, 반시계(위에서 볼 때 CCW).  
- **면 1**: 평면 원판 \(z=0\), \(\mathbf n=\mathbf k\).
  \[
  \iint_S (\nabla\times\mathbf F)\cdot\mathbf n\,dS=\iint_{x^2+y^2\le1}1\,dA=\pi.
  \]
  선적분: \(x=\cos t, y=\sin t\Rightarrow \mathbf F\cdot d\mathbf r
  =(-\tfrac{\sin t}{2})\,(-\sin t)dt+(\tfrac{\cos t}{2})\,(\cos t)dt
  =\tfrac{1}{2}\,dt\Rightarrow \int_0^{2\pi}\tfrac12\,dt=\pi.\)

- **면 2**: 단위 반구 \(x^2+y^2+z^2=1,z\ge0\), \(\mathbf n\)은 바깥쪽(상향).  
  스토크스에 의해 결과는 동일하게 \(\pi\)가 되어야 하며, 실제로
  \[
  \iint_S (\nabla\times\mathbf F)\cdot\mathbf n\,dS
  =\iint_S 1\cdot dS=\text{반구 면적}\times\text{평균 }(\mathbf n\cdot\mathbf k)=\pi.
  \]
  (정확 계산은 구면좌표로도 확인 가능. 핵심은 “면에 무관”)

### 예제 D — 면적분(스칼라): 포물포면 \(z=x^2+y^2\) 위 총량
\(S:\ z=x^2+y^2,\ (x,y)\in D=\{x^2+y^2\le a^2\}\), \(f(x,y,z)=z\).
\[
dS=\sqrt{1+z_x^2+z_y^2}\,dx\,dy=\sqrt{1+4x^2+4y^2}\,dx\,dy.
\]
극좌표로
\[
\iint_S f\,dS=\int_{0}^{2\pi}\int_{0}^{a} (r^2)\sqrt{1+4r^2}\ r\,dr\,d\theta
=2\pi\int_{0}^{a} r^3\sqrt{1+4r^2}\,dr.
\]
(적분 치환 \(u=1+4r^2\)로 해석적 계산 가능)

### 예제 E — 면적분(벡터, 플럭스): \(\mathbf F=(x,y,z)\)의 구면 플럭스
반지름 \(R\)인 구 \(S\)의 바깥법선 \(\mathbf n\).
발산정리(참고)로
\[
\iint_S \mathbf F\cdot d\mathbf S
=\iiint_{\text{ball}} \nabla\cdot\mathbf F\,dV
=\iiint 3\,dV
=3\cdot \frac{4}{3}\pi R^3=4\pi R^3.
\]

---

## 5) 수치·상징 계산 코드(검증/실습)

### 5.1 Sympy로 예제 C(스토크스) 정확 계산

```python
import sympy as sp

t = sp.symbols('t', real=True)
x = sp.cos(t)
y = sp.sin(t)
dx = sp.diff(x, t)
dy = sp.diff(y, t)

Fx = -y/2
Fy =  x/2
work = sp.simplify(Fx*dx + Fy*dy)
res_line = sp.integrate(work, (t, 0, 2*sp.pi))
res_line  # pi

# curl(F) = (0,0,1), disk area integral -> pi
```

### 5.2 Numpy로 선적분/면적분(극좌표) 근사

```python
import numpy as np

def line_integral_G_on_unit_circle(N=100000):
    t = np.linspace(0, 2*np.pi, N, endpoint=False)
    x, y = np.cos(t), np.sin(t)
    dx, dy = -np.sin(t)*(2*np.pi/N), np.cos(t)*(2*np.pi/N)  # dt = 2π/N
    Fx, Fy = -y/2, x/2
    return np.sum(Fx*dx + Fy*dy)

def surface_integral_curl_on_disk(Nr=1000, Nt=2000):
    # curl = 1, z=0 plane, so integral = area = π (극좌표 사다리꼴 근사)
    r = np.linspace(0, 1, Nr+1)
    t = np.linspace(0, 2*np.pi, Nt, endpoint=False)
    dr = r[1]-r[0]
    dt = t[1]-t[0]
    R, T = np.meshgrid(r, t, indexing='ij')
    jac = R  # dA = r dr dθ
    return np.sum(1.0 * jac) * dr * dt

print(line_integral_G_on_unit_circle())     # ≈ 3.14159
print(surface_integral_curl_on_disk())      # ≈ 3.14159
```

---

## 6) 방위(orientation)와 부호 — 자주 틀리는 포인트

1) **오른손 법칙**  
   경계곡선의 진행방향이 정해지면, 곡면의 법선은 오른손으로 감아 올렸을 때 엄지 방향.  
   평면 \(z=0\)에서 반시계(CCW)면 \(\mathbf n=+\mathbf k\).

2) **경계 없이 닫힌 곡면**  
   스토크스는 \(\partial S\)가 있어야 한다. 닫힌 곡면은 \(\partial S=\varnothing\), 선적분은 0이므로  
   \(\iint_S (\nabla\times\mathbf F)\cdot \mathbf n\,dS=0\) (벡터 항등식으로도 확인).

3) **정칙성**  
   \(\mathbf F\)는 \(S\)를 덮는 열린 집합에서 \(C^1\)이어야 한다. 특이점이 경계에 걸리면 주의(구간 분할/제외).

4) **보존장 착각**  
   \(\nabla\times\mathbf F=\mathbf 0\)이더라도 영역이 단일연결이 아니면(구멍이 있으면) 경로독립이 깨질 수 있다(멀티커넥티드).  
   예: \(\mathbf F=\big(-\frac{y}{x^2+y^2},\frac{x}{x^2+y^2},0\big)\)는 원점 제외 영역에서 \(\nabla\times\mathbf F=\mathbf 0\)이나 원을 돌면 \(\oint \mathbf F\cdot d\mathbf r=2\pi\).

5) **면 선택 불변성**  
   동일한 \(\partial S\)와 일관된 방위를 유지하면 어느 \(S\)를 골라도 결과는 동일(예제 C).

---

## 7) 실전 체크리스트(문제 풀 때/코드 짤 때)

- 선적분: 매개화 \(\mathbf r(t)\) 정확? \(ds=\|\mathbf r'(t)\| dt\), \(d\mathbf r=\mathbf r'(t)dt\) 구분.  
- 면적분: \(\mathbf r_u,\mathbf r_v\) 계산 후 \(\mathbf r_u\times\mathbf r_v\)의 방향이 원하는 방위와 일치?  
- 스토크스: 경계 방향과 법선의 일관성(오른손). \(\nabla\times\mathbf F\) 정확 계산.  
- 가능하면 **스토크스/그린/발산정리**로 더 쉬운 측면을 택하라.  
- 수치적분 시 분할 수를 키워 수렴 확인(라인: 등분할 \(t\), 서피스: 극좌표/직사각형 격자).

---

## 8) 연습문제(블로그 독자용)

1) \(\mathbf F=(y^2,\,0,\,0)\), \(C\): \(x^2+y^2=1\) 반시계. \(\oint_C \mathbf F\cdot d\mathbf r\)를 직접 적분과 그린정리로 각각 구해 일치 검증.  
2) \(\mathbf F=(yz,\ zx,\ xy)\), \(S\): \(z=1-x^2-y^2\) (상반 포물면)의 경계 원 \(x^2+y^2=1,\ z=0\) 위 반시계. 스토크스로 \(\oint \mathbf F\cdot d\mathbf r\) 계산.  
3) \(S\): 평면 \(x+y+z=1\)의 첫사분면 삼각형 패치(좌표평면과 만나는 면). \(\mathbf F=(x,y,z)\)의 플럭스를 면적분 정의로 계산 후, 동일 경계에 대해 스토크스로 \(\nabla\times\mathbf F\)가 주는 값과 비교(왜 다른가? — 경계가 같아도 스토크스는 curl, 발산정리는 div로 각기 다른 양을 잰다).

---

## 9) 요약 표

| 구분 | 수식 | 핵심 의미 |
|---|---|---|
| 스칼라 선적분 | \(\displaystyle \int_C f\,ds\) | 곡선을 따라 스칼라장 누적(길이 가중) |
| 벡터 선적분 | \(\displaystyle \int_C \mathbf F\cdot d\mathbf r\) | 일/순환 |
| 스칼라 면적분 | \(\displaystyle \iint_S f\,dS\) | 곡면 위 총량 |
| 벡터 면적분 | \(\displaystyle \iint_S \mathbf F\cdot d\mathbf S\) | 플럭스/유량 |
| 스토크스 정리 | \(\displaystyle \oint_{\partial S}\mathbf F\cdot d\mathbf r=\iint_S (\nabla\times\mathbf F)\cdot \mathbf n\,dS\) | 경계 순환 = 내부 회전 누적 |
| 방위 규칙 | 오른손 법칙 | 경계 방향 ↔ 법선 일관 |

---

## 부록) 파라미터화 빠른 레시피

- 원 \(x^2+y^2=R^2\): \(x=R\cos t,y=R\sin t\)  
- 원판: \((r,\theta)\mapsto (r\cos\theta,r\sin\theta,0)\), \(0\le r\le R\)  
- 평면 \(ax+by+cz=d\): \(\mathbf r(u,v)=\mathbf p+u\mathbf u+v\mathbf v\) (법선 \(\mathbf n\propto \mathbf u\times\mathbf v\))  
- 구면: \((\phi,\theta)\mapsto (R\sin\phi\cos\theta,\ R\sin\phi\sin\theta,\ R\cos\phi)\), \(dS=R^2\sin\phi\,d\phi\,d\theta\)

---

### 끝맺음

선적분과 면적분은 각각 “곡선/곡면 위에서의 누적”을 정식화하고, 스토크스 정리는 “경계에서의 순환”이 “내부의 회전 누적”과 같음을 밝힌다.  
해석과 수치를 함께 운용하면 이론 검증과 실전 계산이 모두 견고해진다.