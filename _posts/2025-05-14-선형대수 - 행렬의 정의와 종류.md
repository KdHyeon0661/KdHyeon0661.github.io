---
layout: post
title: 선형대수 - 행렬의 정의와 종류
date: 2025-05-14 19:20:23 +0900
category: 선형대수
---
# 행렬의 정의와 종류 (정방행렬, 대칭행렬, 영행렬 등)

## 0. 표기와 전제

- 실수 필드 위의 행렬을 기본으로 하되, 필요 시 복소수(허미티안 등)도 언급합니다.  
- 행렬은 굵은 대문자(예: $$\mathbf{A}$$), 벡터는 굵은 소문자(예: $$\mathbf{x}$$)로 표기합니다.  
- 전치 $$\mathbf{A}^\top$$, 켤레전치 $$\mathbf{A}^*$$, 단위행렬 $$\mathbf{I}$$, 영행렬 $$\mathbf{0}$$, 대각행렬 $$\mathbf{D}$$.

---

## 1. 행렬의 정의

행과 열로 이루어진 직사각형 배열:
$$
\mathbf{A}=\begin{bmatrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
a_{21}&a_{22}&\cdots&a_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
a_{m1}&a_{m2}&\cdots&a_{mn}
\end{bmatrix}\in\mathbb{R}^{m\times n}.
$$

- $$a_{ij}$$: $$i$$번째 행, $$j$$번째 열의 성분  
- $$m$$: 행(row) 수, $$n$$: 열(column) 수

---

## 2. 행렬 종류 개관(요약)

| 종류 | 핵심 정의 | 대표 성질(일부) | 대표 용도 |
|---|---|---|---|
| 정방행렬 | $$m=n$$ | 행렬식, 역행렬, 고유분해 정의 | 선형시스템, 스펙트럼 해석 |
| 영행렬 | 모든 성분 0 | $$\mathbf{A}+\mathbf{0}=\mathbf{A}$$, $$\mathbf{A}\mathbf{0}=\mathbf{0}$$ | 영사상, 경계 케이스 |
| 단위행렬 | 대각 1, 나머지 0 | 항등원 $$\mathbf{AI}=\mathbf{IA}=\mathbf{A}$$ | 기준 변환 |
| 대각행렬 | 비대각 0 | 역행렬은 대각의 역수, 계산 효율 | 스케일링, 고유분해 결과 |
| 대칭행렬 | $$\mathbf{A}=\mathbf{A}^\top$$ | 실고유값, 직교대각화 가능 | 공분산, 에너지 |
| 반대칭 | $$\mathbf{A}^\top=-\mathbf{A}$$ | 대각 0, 2-양식은 벡터곱과 연관 | 회전 미분, 외적 |
| 상/하삼각 | 대각 위/아래가 0 | 행렬식은 대각 곱, 전진·후진 대입 | 가우스 소거, 선형해법 |
| 직교행렬 | $$\mathbf{Q}^\top\mathbf{Q}=\mathbf{I}$$ | 길이·각도 보존, $$\mathbf{Q}^{-1}=\mathbf{Q}^\top$$ | 회전·반사, 수치안정 |
| 허미티안 | $$\mathbf{A}=\mathbf{A}^*$$ | 복소 실고유값, 유니터리 대각화 | 신호처리, 양자 |
| 양의(준)정부호 | $$\mathbf{x}^\top\mathbf{A}\mathbf{x}>0(\ge0)$$ | 촐레스키 분해 | 최적화, 회귀 |
| 순열행렬 | 행/열이 표준기저 순열 | $$\mathbf{P}^\top\mathbf{P}=\mathbf{I}$$ | 피벗팅, 재정렬 |
| 투영행렬 | $$\mathbf{P}^2=\mathbf{P}$$ | 고유값 0 또는 1 | 부분공간 사영 |
| nilpotent | $$\mathbf{N}^k=\mathbf{0}$$ | 스펙트럼 0 | 지수행렬 급수 절약 |
| involutory | $$\mathbf{A}^2=\mathbf{I}$$ | 자기 역행렬 | 반사 변환 |
| 로우랭크 | $$\operatorname{rank}(\mathbf{A})\ll \min(m,n)$$ | 저장·연산량 절감 | 압축, 추천 |
| Toeplitz | 대각선 일정 | 빠른 곱(FFT) | 시계열, 컨볼루션 |
| Hankel | 부대각선 일정 | 순간·지연 구조 | 신호 스펙트럼 |
| Vandermonde | 거듭제곱 열 | 보간 민감성 큼 | 보간, 다항학습 |
| 순환행렬 | 행이 순환시프트 | 푸리에 대각화 | 컨볼루션 행렬화 |
| 희소행렬 | 0가 대부분 | 특수 저장·연산 | 대규모 선형계 |

아래에서 핵심 종류들을 상세히 다룹니다.

---

## 3. 핵심 종류와 성질

### 3.1 정방행렬
- 정의: $$m=n$$.  
- 스펙트럼, 행렬식, 역행렬 논의의 기반.  
- 역행렬 존재 조건: $$\det(\mathbf{A})\ne 0 \iff \operatorname{rank}(\mathbf{A})=n$$.

### 3.2 영행렬
- 모든 성분 0.
- 임의의 $$\mathbf{A}$$에 대해 $$\mathbf{A}+\mathbf{0}=\mathbf{A}$$, $$\mathbf{A}\mathbf{0}=\mathbf{0}$$.
- 테스트 및 경계조건에 유용.

### 3.3 단위행렬(항등행렬)
- 대각 1, 비대각 0.
- 항등원: $$\mathbf{AI}=\mathbf{IA}=\mathbf{A}$$.
- 역행렬의 기준점.

### 3.4 대각행렬
- 정의: 비대각 원소 0.
- 역행렬: 대각 원소가 모두 0이 아니면 $$\mathbf{D}^{-1}=\operatorname{diag}(1/d_i)$$.
- 행렬식: $$\det(\mathbf{D})=\prod_i d_i$$.
- 계산량이 원소수에 선형적.

### 3.5 대칭행렬(실수)
- 정의: $$\mathbf{A}=\mathbf{A}^\top$$.
- 성질:
  - 고유값이 모두 실수.
  - 직교대각화: $$\mathbf{A}=\mathbf{Q}\mathbf{\Lambda}\mathbf{Q}^\top$$ (직교 $$\mathbf{Q}$$, 대각 $$\mathbf{\Lambda}$$).
  - 공분산 행렬, 에너지 함수에 널리 사용.

### 3.6 반대칭행렬
- 정의: $$\mathbf{A}^\top=-\mathbf{A}$$.
- 성질: 실수 반대칭의 대각은 0, 3차원에서는 외적과 밀접(회전의 무한소 생성).

### 3.7 삼각행렬
- 상삼각: 대각선 아래가 모두 0. 하삼각: 대각선 위가 모두 0.
- 행렬식은 대각 원소들의 곱.
- 선형계 풀이에 전진·후진 대입이 가능.

### 3.8 직교행렬
- 정의: $$\mathbf{Q}^\top\mathbf{Q}=\mathbf{I}$$.
- 성질:
  - 길이·각도 보존, 조건수 1.
  - 역행렬이 전치: $$\mathbf{Q}^{-1}=\mathbf{Q}^\top$$.
  - 회전·반사 변환을 나타냄.

### 3.9 허미티안(복소)
- 정의: $$\mathbf{A}=\mathbf{A}^*$$ (켤레전치).
- 실수 대칭의 일반화: 고유값 실수, 유니터리 대각화 가능.

### 3.10 양의(준)정부호
- 정의:
  $$
  \mathbf{x}^\top\mathbf{A}\mathbf{x} > 0\ (\ge 0)\quad \forall \mathbf{x}\ne \mathbf{0}.
  $$
- 성질:
  - 촐레스키 분해: $$\mathbf{A}=\mathbf{R}^\top\mathbf{R}$$ (정부호일 때).
  - 고유값이 양수(정부호) 또는 음이 아닌 값(준정부호).
- 용도: 최소제곱, 정규화된 회귀, 최적화의 볼록성.

### 3.11 순열행렬
- 표준기저 벡터를 행 또는 열로 가지는 정방행렬.
- $$\mathbf{P}^\top\mathbf{P}=\mathbf{I}$$, 행/열의 재배열에 사용(피벗팅).

### 3.12 투영행렬
- 정의: $$\mathbf{P}^2=\mathbf{P}$$ (멱등).
- 성질: 고유값은 0 또는 1, 트레이스는 사영 차원.
- 직교사영: $$\mathbf{P}=\mathbf{A}(\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top$$ (풀랭크 열 $$\mathbf{A}$$).

### 3.13 nilpotent
- 정의: $$\mathbf{N}^k=\mathbf{0}$$ 인 $$k\ge 1$$ 존재.
- 성질: 고유값은 0, 상삼각으로 유사변환 가능(요르당 블록).

### 3.14 involutory
- 정의: $$\mathbf{A}^2=\mathbf{I}$$.
- 반사변환의 전형적 예.

### 3.15 로우랭크와 랭크-1
- 정의: $$\operatorname{rank}(\mathbf{A})=r \ll \min(m,n)$$.
- 랭크-1: $$\mathbf{A}=\mathbf{u}\mathbf{v}^\top$$.
- 용도: 압축, 대규모 데이터의 근사.

### 3.16 특수 구조(개념만 요약)
- Toeplitz: 각 대각선이 상수.  
- Hankel: 각 부대각선이 상수.  
- Vandermonde: 열이 $$[1, x_i, x_i^2,\dots]$$.  
- 순환행렬: 행이 순환시프트; 푸리에 기저로 대각화.

### 3.17 희소행렬
- 대부분이 0.  
- 저장·연산에서 특수 구조(압축 포맷, 스파스 커널) 필요.

---

## 4. 판별과 기본 공식(요점)

- 대칭: $$\mathbf{A}=\mathbf{A}^\top$$  
- 반대칭: $$\mathbf{A}^\top=-\mathbf{A}$$  
- 직교: $$\mathbf{A}^\top\mathbf{A}=\mathbf{I}$$  
- 투영: $$\mathbf{P}^2=\mathbf{P}$$  
- 양의정부호: $$\mathbf{x}^\top\mathbf{A}\mathbf{x}>0\ \forall \mathbf{x}\ne \mathbf{0}$$  
- 삼각의 행렬식: 대각 곱  
- 대각/직교/허미티안의 역행렬과 고유분해 성질 상기

---

## 5. 실전 시나리오

- 공분산 행렬: 대칭·준정부호 → PCA(직교대각화)로 주성분 추출.  
- 정규방정식: $$\mathbf{A}^\top\mathbf{A}$$ 는 대칭·정부호(풀컬럼랭크 가정) → 촐레스키로 빠르고 안정적 풀이.  
- 회전/카메라 자세: 직교행렬(또는 유니터리)로 모델링 → 길이·각도 보존.  
- 피벗팅: 순열행렬로 행 교환을 명시.  
- 최소제곱의 사영: 투영행렬로 관측을 부분공간에 사영해 해석.

---

## 6. PyTorch 예제 모음(판별, 생성, 검증)

```python
import torch
torch.set_printoptions(precision=6, sci_mode=False)
dtype = torch.float64

def is_symmetric(A, atol=1e-10):
    return torch.allclose(A, A.T, atol=atol)

def is_skew_symmetric(A, atol=1e-10):
    return torch.allclose(A.T, -A, atol=atol)

def is_orthogonal(Q, atol=1e-10):
    n = Q.shape[0]
    I = torch.eye(n, dtype=Q.dtype, device=Q.device)
    return torch.allclose(Q.T @ Q, I, atol=atol) and torch.allclose(Q @ Q.T, I, atol=atol)

def is_idempotent(P, atol=1e-10):
    return torch.allclose(P @ P, P, atol=atol)

def is_psd(A, atol=1e-12):
    # 고유값이 모두 >= -atol 이면 준정부호로 판단
    evals = torch.linalg.eigvalsh((A + A.T)/2)  # 대칭화
    return torch.min(evals) >= -atol

# 1. 정방/직사각, 영/단위
A = torch.tensor([[1., 2.],[3., 4.]], dtype=dtype)
Z = torch.zeros(2, 2, dtype=dtype)
I = torch.eye(2, dtype=dtype)
print("영행렬?\t", torch.all(Z==0).item())
print("단위행렬 속성 A@I==A?\t", torch.allclose(A @ I, A))

# 2. 대칭/반대칭
S = torch.tensor([[2., 1.],[1., 3.]], dtype=dtype)     # 대칭
K = torch.tensor([[0., -2.],[2., 0.]], dtype=dtype)    # 반대칭
print("대칭?\t", is_symmetric(S))
print("반대칭?\t", is_skew_symmetric(K))

# 3. 삼각행렬
U = torch.triu(torch.tensor([[1.,2.,3.],[4.,5.,6.],[7.,8.,9.]], dtype=dtype))
L = torch.tril(torch.tensor([[1.,2.,3.],[4.,5.,6.],[7.,8.,9.]], dtype=dtype))
detU = torch.prod(torch.diag(U))
detL = torch.prod(torch.diag(L))
print("상삼각 행렬식(대각곱):\t", detU.item())
print("하삼각 행렬식(대각곱):\t", detL.item())

# 4. 직교행렬 생성(QR로 정규직교화)
M = torch.randn(5, 5, dtype=dtype)
Q, R = torch.linalg.qr(M)           # Q: 직교, R: 상삼각
print("직교?\t", is_orthogonal(Q))

# 5. 양의정부호 생성과 판별
B = torch.randn(4, 4, dtype=dtype)
SPD = B.T @ B + 1e-3 * torch.eye(4, dtype=dtype)  # SPD
print("준정부호?\t", is_psd(SPD))
# 촐레스키 분해로 정부호성 확인(정부호면 성공)
try:
    Lc = torch.linalg.cholesky(SPD)
    print("촐레스키 OK(정부호).")
except RuntimeError as e:
    print("촐레스키 실패(정부호 아님).", str(e).splitlines()[0])

# 6. 순열행렬과 행 재배치
perm = torch.tensor([2,0,1])  # 0->2, 1->0, 2->1
P = torch.zeros(3,3, dtype=dtype)
P[torch.arange(3), perm] = 1.
print("순열행렬 직교성?\t", is_orthogonal(P))
X = torch.tensor([[10.],[20.],[30.]], dtype=dtype)
print("행 재배치 결과:\n", P @ X)

# 7. 투영행렬(열공간으로의 직교사영)
A = torch.tensor([[1.,0.],[1.,1.],[0.,1.]], dtype=dtype)  # 3x2, 풀컬럼랭크
AtA = A.T @ A
P = A @ torch.linalg.inv(AtA) @ A.T                       # 3x3 projector
print("투영행렬 멱등?\t", is_idempotent(P))
# 아무 벡터를 A의 열공간에 사영
y = torch.tensor([2., 3., -1.], dtype=dtype)
y_proj = P @ y
# 사영 잔차는 A의 열공간에 직교
residual = y - y_proj
print("잔차 직교성(At@residual≈0)?\t",
      torch.allclose(A.T @ residual, torch.zeros(2, dtype=dtype), atol=1e-10))

# 8. nilpotent(엄격 상삼각은 충분히 큰 제곱에서 0)
N = torch.tensor([[0.,1.,0.],[0.,0.,2.],[0.,0.,0.]], dtype=dtype)  # 엄격 상삼각
print("N^3 == 0 ?\t", torch.allclose(N@N@N, torch.zeros(3,3,dtype=dtype)))

# 9. involutory(반사) 예: 대각이 ±1, 제곱하면 I
R = torch.diag(torch.tensor([1., -1., 1.], dtype=dtype))
print("R^2 == I ?\t", torch.allclose(R@R, torch.eye(3, dtype=dtype)))
```

설명:

- QR로 얻은 $$\mathbf{Q}$$ 는 직교행렬입니다.  
- $$\mathbf{B}^\top\mathbf{B}+\mu\mathbf{I}$$ 형태는 정부호 행렬을 구성합니다(촐레스키 성공으로 검증).  
- 순열행렬 $$\mathbf{P}$$ 는 행 교환을 안전하고 명시적으로 수행합니다.  
- 투영행렬 $$\mathbf{P}=\mathbf{A}(\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top$$ 의 멱등성과 잔차 직교성을 확인합니다.  
- 엄격 상삼각은 유한 승에서 0이 됩니다(nilpotent).  
- 대각이 ±1인 반사 행렬은 $$\mathbf{A}^2=\mathbf{I}$$ 를 만족합니다.

---

## 7. 자주 혼동되는 포인트와 실수 방지

1) 전치 조건  
- 대칭과 반대칭은 전치 기준으로 정의됩니다. 실수/복소(허미티안) 구분에 주의합니다.

2) 직교와 정규직교화  
- 임의 정방행렬이 직교가 되는 것이 아니라, QR 등으로 정규직교 기저를 구성해야 합니다.

3) 양의정부호 오판정  
- 수치오차로 고유값의 아주 작은 음수가 나올 수 있으므로 공차를 두고 판정하거나 촐레스키 시도 후 실패 여부로 판정합니다.

4) 투영행렬 구성  
- 직교사영은 $$\mathbf{A}(\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top$$ (풀컬럼랭크 가정). 랭크 결핍 시 의사역행렬 사용 필요.

5) 구조 활용  
- 삼각, 대각, 직교 구조를 인지하면 연산·안정성이 크게 향상됩니다(예: 촐레스키, 전진·후진 대입).

---

## 8. 연습문제(해설 방향만 제시)

1) $$\mathbf{A}$$ 가 대칭이면 고유벡터가 서로 직교 기저를 이룰 수 있음을 보이고, 직교대각화 공식을 쓰시오.  
2) 엄격 상삼각 $$n\times n$$ 행렬의 $$n$$제곱이 영행렬이 됨을 보이시오.  
3) 순열행렬 $$\mathbf{P}$$ 가 직교행렬임을 증명하고, 행 교환 연산을 $$\mathbf{P}$$ 로 표현하시오.  
4) 풀컬럼랭크 $$\mathbf{A}\in\mathbb{R}^{m\times n}$$ 에 대해 $$\mathbf{P}=\mathbf{A}(\mathbf{A}^\top\mathbf{A})^{-1}\mathbf{A}^\top$$ 가 투영행렬임을 보이시오(멱등, 대칭).  
5) $$\mathbf{B}^\top\mathbf{B}+\mu\mathbf{I}$$ 의 양의정부호성을 보이시오($$\mu>0$$).

---

## 9. 결론

- 행렬의 **구조(대칭, 삼각, 직교, SPD, 투영, 순열 등)** 는 계산 복잡도와 수치 안정성, 이론적 성질을 좌우합니다.  
- 올바른 판별과 구조 활용은 선형계 풀이, 최소제곱, PCA, 회전·사영 등 실전 전반에서 성능과 안정성을 크게 개선합니다.  
- 위의 판별 함수와 생성 레시피(PyTorch)를 기반으로, 자신이 다루는 데이터/연산의 **형상과 구조**를 먼저 확인하는 습관을 들이십시오.