---
layout: post
title: 미적분 - 중적분과 변수변환
date: 2025-08-17 20:20:23 +0900
category: 미적분
---
# 중적분의 응용

본 글은 이전 글(이중·삼중적분, 반복적분, 변수변환·야코비안, 극/원통/구면좌표)의 핵심을 바탕으로
**중적분(이중/삼중적분)의 실제 응용**을 체계적으로 정리한다.
핵심 포인트는 다음과 같다.

1) **기하학**: 면적/부피/평균값/중심(무게중심)
2) **물리**: 질량·질점계/연속체의 **중심**, **관성모멘트**, **정수압력(수문력)**, **열량**
3) **확률**: **연속확률(2D/3D)**, 결합·주변·조건부, **기댓값/공분산**, **변수변환**
4) **데이터/영상/컴퓨터비전**: **영상의 무게중심**, 2차 모멘트(모양의 방향/타원 근사)
5) **수치적분**: 불규칙 영역에서의 **극좌표·변수변환**, **몬테카를로(거절샘플링)**

---

## 준비: 중적분 해석(요약)

- 면적/부피:
  - 면적:
    $$
    \text{Area}(D)=\iint_D 1\,dx\,dy.
    $$
  - **기둥형** 부피(2D 바닥, 위쪽 높이 $h(x,y)$):
    $$
    V=\iint_D h(x,y)\,dx\,dy.
    $$
  - 삼중적분:
    $$
    \text{Vol}(E)=\iiint_E 1\,dV.
    $$
- 평균값(2D):
  $$
  \overline{f}=\frac{1}{\text{Area}(D)}\iint_D f(x,y)\,dx\,dy.
  $$

- 변수변환(2D):
  $$
  \iint_D f(x,y)\,dx\,dy=\iint_{D^*} f(x(u,v),y(u,v))\,\big|\det \tfrac{\partial(x,y)}{\partial(u,v)}\big|\,du\,dv.
  $$

---

## 기하학적 응용

### 원/타원/부채꼴의 면적과 평균값

**예제 A: 단위원에서 $f(x,y)=x^2+y^2$ 의 평균값**
단위원 $D=\{x^2+y^2\le 1\}$.

- 극좌표: $x=r\cos\theta,\ y=r\sin\theta,\ dx\,dy=r\,dr\,d\theta$.
- 분자:
  $$
  \iint_D (x^2+y^2)\,dx\,dy=\int_0^{2\pi}\int_0^1 r^2\cdot r\,dr\,d\theta
  =2\pi\cdot\frac{1}{4}=\frac{\pi}{2}.
  $$
- 분모(면적): $\text{Area}(D)=\pi$.
- 평균:
  $$
  \overline{f}=\frac{\pi/2}{\pi}=\frac{1}{2}.
  $$

**예제 B: 타원 $\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}\le 1$ 의 면적**
변환 $x=au,\ y=bv,\ u^2+v^2\le 1$, 야코비안 $|J|=ab$:
$$
\text{Area}=\iint_{u^2+v^2\le 1} ab\,du\,dv =ab\cdot\pi.
$$

**예제 C: 부채꼴 $0\le r\le R,\ \alpha\le \theta\le \beta$ 의 평균 반경**
$$
\overline{r}=\frac{1}{\text{Area}}\int_{\theta=\alpha}^{\beta}\int_{0}^{R} r\cdot r\,dr\,d\theta
=\frac{1}{\tfrac{(\beta-\alpha)R^2}{2}}\cdot (\beta-\alpha)\cdot\frac{R^3}{3}
=\frac{2R}{3}.
$$

### 높이 함수로 부피 구하기

**예제 D: 포물면 $z=1-x^2-y^2$ 의 윗부분과 $z=0$ 사이 부피**
$D=\{(x,y)\mid x^2+y^2\le 1\}$, $V=\iint_D (1-x^2-y^2)\,dx\,dy$. 극좌표로:
$$
V=\int_0^{2\pi}\int_0^1 (1-r^2)r\,dr\,d\theta = 2\pi\left[\frac{r^2}{2}-\frac{r^4}{4}\right]_0^1 = 2\pi\left(\frac{1}{2}-\frac{1}{4}\right)=\frac{\pi}{2}.
$$

---

## 물리적 응용: 질량, 무게중심, 관성모멘트, 열량

### 면밀도(라미나)의 질량과 무게중심

- **질량**(면밀도 $\rho(x,y)$):
  $$
  M=\iint_D \rho(x,y)\,dx\,dy.
  $$
- **무게중심**(Center of Mass, CoM):
  $$
  \bar{x}=\frac{1}{M}\iint_D x\,\rho(x,y)\,dx\,dy,\qquad
  \bar{y}=\frac{1}{M}\iint_D y\,\rho(x,y)\,dx\,dy.
  $$

**예제 E: 원판 $x^2+y^2\le R^2$ 에서 $\rho=\rho_0(1+\alpha r^2)$**
극좌표로 계산. $M$:
$$
M=\int_0^{2\pi}\int_0^{R} \rho_0(1+\alpha r^2)\,r\,dr\,d\theta
=2\pi\rho_0\left[\frac{r^2}{2}+\alpha\frac{r^4}{4}\right]_0^R
=\pi\rho_0\left(R^2+\frac{\alpha R^4}{2}\right).
$$
대칭성으로 $\bar{x}=\bar{y}=0$.

**예제 F: 반원판 $D=\{x^2+y^2\le R^2,\ y\ge 0\}$, 균일 밀도 $\rho_0$ 의 $\bar{y}$**
대칭으로 $\bar{x}=0$.
$\displaystyle \bar{y}=\frac{1}{M}\iint_D y\rho_0\,dx\,dy$.
극좌표(반원): $0\le r\le R,\ 0\le \theta\le \pi$, $y=r\sin\theta$.
$$
M=\rho_0\int_0^\pi\int_0^R r\,dr\,d\theta = \rho_0 \cdot \pi \cdot \frac{R^2}{2}=\frac{\rho_0 \pi R^2}{2},
$$
$$
\iint_D y\rho_0\,dx\,dy
= \rho_0\int_0^\pi\int_0^R (r\sin\theta)\,r\,dr\,d\theta
= \rho_0\left[\int_0^\pi \sin\theta\,d\theta\right]\cdot\left[\int_0^R r^2\,dr\right]
= \rho_0\cdot 2 \cdot \frac{R^3}{3}.
$$
따라서
$$
\bar{y}=\frac{2\rho_0 R^3/3}{\rho_0 \pi R^2/2}=\frac{4R}{3\pi}.
$$

### 관성모멘트(2D 라미나, 3D 체)

- 점 $(x,y)$ 에 대한 z축(원점 관통 수직축) 관성모멘트(면밀도 $\rho$):
  $$
  I_z=\iint_D r^2\,\rho(x,y)\,dx\,dy,\qquad r^2=x^2+y^2.
  $$
- x축/ y축 관성모멘트:
  $$
  I_x=\iint_D y^2\,\rho\,dx\,dy,\qquad I_y=\iint_D x^2\,\rho\,dx\,dy.
  $$
- 평행축 정리(라미나):
  중심 관성모멘트 $I_{\mathrm{cm}}$ 와 임의 축 관성모멘트 $I$:
  $$
  I=I_{\mathrm{cm}}+Md^2,
  $$
  여기서 $d$는 두 축 사이 거리.

**예제 G: 균일 원판(반지름 $R$, 면밀도 $\rho_0$)의 $I_z$**
$$
I_z=\iint_{r\le R} r^2\,\rho_0\,dx\,dy
=\rho_0\int_0^{2\pi}\int_0^R r^2 \cdot r\,dr\,d\theta
= \rho_0\cdot 2\pi\cdot \frac{R^4}{4}=\frac{1}{2}( \rho_0 \pi R^2)\cdot R^2=\frac{1}{2}MR^2.
$$

### — 고정된 수문판에 작용하는 힘

깊이 $y$ 에서의 압력 $p(y)=\rho g y$ (자유수면 $y=0$, 아래로 양).
수문판에 작용하는 힘:
$$
F=\iint_S p(y)\,dA=\rho g\iint_S y\,dA.
$$
**예제 H: 가로폭 $b$, 수면 아래 $0\le y\le h$ 의 직사각형 판**
$$
F=\rho g\int_{0}^{h}\int_0^b y\,dx\,dy = \rho g\,b\int_0^h y\,dy=\rho g\,b\,\frac{h^2}{2}.
$$
작용점은 $y_c=\dfrac{\int y^2\,dA}{\int y\,dA}=\dfrac{\tfrac{b h^3}{3}}{\tfrac{b h^2}{2}}=\frac{2h}{3}$ (수면에서 내려간 위치).

### 열량/질량 보존 — 면/체 내부의 총량

- 온도분포 $T(x,y)$, 열용량·밀도 등 상수 $c\rho$ 라면, 총 열량:
  $$
  Q=\iint_D c\rho\,T(x,y)\,dx\,dy.
  $$
- 농도/밀도 분포의 총량도 동일 형식.

---

## 확률의 응용: 결합분포·기댓값·공분산·변수변환

### 결합확률밀도함수(pdf)와 주변/조건부

- 결합 pdf $f_{X,Y}(x,y)\ (\ge 0,\ \iint f=1)$.
- 주변 pdf:
  $$
  f_X(x)=\int_{-\infty}^{\infty} f_{X,Y}(x,y)\,dy,\qquad
  f_Y(y)=\int_{-\infty}^{\infty} f_{X,Y}(x,y)\,dx.
  $$
- 조건부 pdf: $f_{Y|X}(y|x)=\dfrac{f_{X,Y}(x,y)}{f_X(x)}$ (해당 $x$에서 $f_X(x)>0$).

**예제 I: 단위원에서 균일한 $(X,Y)$**
$f_{X,Y}(x,y) = \dfrac{1}{\pi}$ for $x^2+y^2\le 1$, 0 otherwise.
$E[X]=E[Y]=0$ (대칭), $E[X^2]=E[Y^2]=\dfrac{1}{4}$ (앞선 평균값 결과 활용).

### 기댓값, 공분산

- 기댓값: $E[g(X,Y)]=\iint g(x,y)\,f_{X,Y}(x,y)\,dx\,dy$.
- 분산/공분산:
  $$
  \mathrm{Var}(X)=E[X^2]-E[X]^2,\quad
  \mathrm{Cov}(X,Y)=E[XY]-E[X]E[Y].
  $$

**예제 J: 독립 표준정규 $X,Y$ 의 반지름 $R=\sqrt{X^2+Y^2}$**
결합 pdf $\tfrac{1}{2\pi}e^{-\frac{x^2+y^2}{2}}$. 극좌표로 $R$의 pdf는 **Rayleigh**:
$f_R(r)=re^{-r^2/2}$ for $r\ge 0$.
$E[R]=\sqrt{\pi/2}$, $E[R^2]=2$.

### — 야코비안

$(U,V)=T(X,Y)$ 가 일대일 변환일 때,
$$
f_{U,V}(u,v)= f_{X,Y}\!\big(x(u,v),y(u,v)\big)\cdot\big|\det\tfrac{\partial(x,y)}{\partial(u,v)}\big|.
$$

**예제 K: $(X,Y)$ 독립 표준정규 → 극좌표 $(R,\Theta)$**
$x=r\cos\theta,\ y=r\sin\theta,\ |J|=r$.
$f_{R,\Theta}(r,\theta)=\frac{1}{2\pi}e^{-\frac{r^2}{2}}\cdot r$ (분리형 $\Rightarrow \Theta$ 균등, $R$는 Rayleigh).

---

## 데이터/영상/컴퓨터비전: 무게중심과 2차 모멘트

### 이진영상의 기하 모멘트

- 이진영상(물체=1, 배경=0)을 연속 근사하면, 면밀도 $\rho=1$ 인 영역 $D$.
- 무게중심(centroid):
  $$
  (x_c,y_c)=\left(\frac{\iint_D x\,dx\,dy}{\iint_D 1\,dx\,dy},\ \frac{\iint_D y\,dx\,dy}{\iint_D 1\,dx\,dy}\right).
  $$
- 2차 모멘트(공분산 행렬 유사):
  $$
  \Sigma=
  \begin{pmatrix}
  \dfrac{\iint_D (x-x_c)^2\,dx\,dy}{\text{Area}(D)} & \dfrac{\iint_D (x-x_c)(y-y_c)\,dx\,dy}{\text{Area}(D)}\\[4pt]
  \dfrac{\iint_D (x-x_c)(y-y_c)\,dx\,dy}{\text{Area}(D)} & \dfrac{\iint_D (y-y_c)^2\,dx\,dy}{\text{Area}(D)}
  \end{pmatrix}.
  $$
- 주성분 방향(고유벡터)와 장/단반경(고유값)은 물체의 **주축**과 **타원 근사**를 준다.

**예제 L: 타원 $x^2/a^2+y^2/b^2\le 1$ 의 2차 모멘트**
대칭으로 $x_c=y_c=0$, $I_x=\iint y^2\,dx\,dy=\pi ab \cdot \frac{b^2}{4}$, $I_y=\pi ab \cdot \frac{a^2}{4}$, $I_{xy}=0$.
면적 $\pi ab$. 평균 2차 모멘트는 각각 $\dfrac{b^2}{4}$, $\dfrac{a^2}{4}$.

---

## 수치·실전 계산: SymPy/NumPy 샘플

아래 코드는 앞선 예제 일부를 **상징적 계산(SymPy)** 혹은 **수치적분/몬테카를로(NumPy)** 로 확인한다.

```python
# SymPy/NumPy를 이용한 중적분 응용 계산 모음

import sympy as sp
import numpy as np

# 단위원에서 f(x,y)=x^2+y^2 평균값 = 1/2

r, th = sp.symbols('r th', positive=True)
x = r*sp.cos(th)
y = r*sp.sin(th)
expr = x**2 + y**2
J = r  # polar Jacobian
num = sp.integrate(sp.integrate(expr*J, (r, 0, 1)), (th, 0, 2*sp.pi))
den = sp.integrate(sp.integrate(J, (r, 0, 1)), (th, 0, 2*sp.pi))
print("Unit disk average:", sp.simplify(num/den))  # 1/2

# 포물면 z=1-x^2-y^2 위/아래 부피 (z≥0)

vol = sp.integrate(sp.integrate((1 - r**2)*J, (r, 0, 1)), (th, 0, 2*sp.pi))
print("Paraboloid volume:", sp.simplify(vol))  # pi/2

# 반원판의 y-좌표 무게중심 (균일 밀도)

rho0, R = sp.symbols('rho0 R', positive=True)
M = rho0*sp.integrate(sp.integrate(J, (r, 0, R)), (th, 0, sp.pi))
Ytot = rho0*sp.integrate(sp.integrate((r*sp.sin(th))*J, (r, 0, R)), (th, 0, sp.pi))
ybar = sp.simplify(Ytot/M)
print("Semicircle y-bar:", ybar)  # 4R/(3π)

# 균일 원판 I_z (관성모멘트, 면밀도 rho0)

Iz = rho0*sp.integrate(sp.integrate((r**2)*J, (r, 0, R)), (th, 0, 2*sp.pi))
print("Uniform disk I_z:", sp.simplify(Iz))  # (1/2) M R^2 with M = rho0 π R^2

# 몬테카를로: 단위원 평균 r^2 = 1/2

def mc_unit_disk_avg(n=200000, seed=0):
    rng = np.random.default_rng(seed)
    # polar sampling: r = sqrt(U), theta ~ U[0, 2π)
    U = rng.random(n)
    r = np.sqrt(U)
    th = 2*np.pi*rng.random(n)
    x = r*np.cos(th)
    y = r*np.sin(th)
    vals = x**2 + y**2
    # 평균값 직접 평균하면 됨(폴라 균등 샘플링은 영역 균등)
    return np.mean(vals)

print("MC avg (x^2+y^2) over unit disk ≈", mc_unit_disk_avg())
```

---

## 응용 시나리오 모음

### 기하/그래픽스: 부피 집계, 높이맵 누적

- 3D **높이맵** $z=h(x,y)$ 의 총량: $V=\iint h(x,y)\,dx\,dy$.
- 샘플링 데이터라면, 적응적 격자/보간 후 수치적분(예: Simpson/Trapezoid/Monte Carlo)로 추정.

### 구조/기계: 면적 2차 모멘트, 단면 성능

- 단면 2차 모멘트 $I_x=\iint y^2\,dA$ 등은 **강성/휘어짐** 판단에 중요.
- 복합 단면은 영역 분할(합/차)로 계산 후 합성.

### 유체: 정수압력·합력·작용점

- 임의 형상의 수문판/댐: **좌표계 적응 + 중적분**으로 합력 및 작용점 산정.
- 휘어진 표면(3D)은 표면적분/곡면정수압으로 확장(다음 글: 표면적분).

### 열/질량전달: 총 열량/질량

- 온도장/농도장 통합량: $Q=\iint c\rho\,T\,dx\,dy$ (2D), $Q=\iiint c\rho\,T\,dV$(3D).
- 경계 레벨셋으로 영역이 주어질 때 **거절 샘플링**과 **수치적분**을 조합.

### 확률/통계: 기댓값, 공분산, 독립성 검사

- 데이터로부터 추정된 결합 pdf $\hat f_{X,Y}$ 를 **커널밀도추정**으로 얻은 뒤
  $E[g(X,Y)] \approx \iint g(x,y)\,\hat f\,dx\,dy$ 수치적분으로 계산.
- **변수변환**으로 미지의 파라미터 추정을 간단화(예: 극좌표 변환으로 등방 대칭성 활용).

### 컴퓨터비전: 물체 중심/회전정규화

- 바이너리 마스크에서 $(x_c,y_c)$, 공분산 $\Sigma$ → 주축 정렬(회전 정규화) 및 스케일 정규화.
- **타원 피팅**(2차 모멘트)으로 물체 외곽 요약.

---

## 고급 예제

### 비균일 밀도의 직사각형 라미나의 CoM

영역 $D=[0,a]\times[0,b]$, 밀도 $\rho(x,y)=\rho_0(1+\alpha x+\beta y)$:

- 질량
  $$
  M=\rho_0\int_0^a\int_0^b (1+\alpha x+\beta y)\,dy\,dx
  =\rho_0\left[ab+\alpha \frac{a^2 b}{2}+\beta \frac{a b^2}{2}\right].
  $$
- $x$-좌표:
  $$
  \iint x\rho\,dx\,dy
  =\rho_0\int_0^a\int_0^b x(1+\alpha x+\beta y)\,dy\,dx
  =\rho_0\left[\frac{a^2 b}{2}+\alpha \frac{a^3 b}{3}+\beta \frac{a^2 b^2}{4}\right].
  $$
- $y$-좌표는 대칭적으로 계산.
  $\bar{x},\ \bar{y}$ 는 위 결과를 $M$ 으로 나눈 값.

### 포물선-포물선 사이 부피(회전 없이 “높이”로 해석)

영역 $D=\{(x,y)\mid 0\le x\le 1,\ x^2\le y\le 2x^2\}$, 높이 $h(x,y)=1+y$:
$$
V=\iint_D (1+y)\,dx\,dy.
$$
비선형 변환 $u=y/x^2,\ v=x$ → $y=uv^2$, $|J|=v^2$ (앞선 변수변환 글 참조),
$1\le u\le 2,\ 0\le v\le 1$:
$$
V=\int_1^2\int_0^1 (1+uv^2)\cdot v^2\,dv\,du
=\int_1^2\left[\frac{v^3}{3}+\frac{u v^5}{5}\right]_0^1 du
=\int_1^2\left(\frac{1}{3}+\frac{u}{5}\right)du
=\left[\frac{u}{3}+\frac{u^2}{10}\right]_1^2
=\frac{1}{3}+\frac{3}{10}=\frac{19}{30}.
$$

### 정수압력: 삼각형 수문판

삼각형 영역 $D=\{(x,y)\mid 0\le x\le b,\ 0\le y\le (h/b)x\}$ (윗변이 수면).
압력 $p(y)=\rho g y$, 힘 $F=\rho g\iint_D y\,dx\,dy$:
$$
F=\rho g \int_0^b\int_0^{(h/b)x} y\,dy\,dx
=\rho g \int_0^b \frac{1}{2}\left(\frac{h}{b}x\right)^2 dx
=\rho g \frac{h^2}{2b^2}\cdot \frac{b^3}{3}
=\rho g \frac{b h^2}{6}.
$$
작용점 $y_c=\dfrac{\iint y^2\,dA}{\iint y\,dA}=\dfrac{\tfrac{1}{3}\cdot\tfrac{b h^3}{3b}}{\tfrac{b h^2}{6}}=\dfrac{2h}{3}$ (직사각형과 동일 결과: 삼각형이 수면에서 내려갈수록 평균이 아래로).

---

## 수치적용: 불규칙 영역에서 몬테카를로 적분(거절 샘플링)

예: **마름모** $D=\{|x|+|y|\le 1\}$ 에서 $f(x,y)=x^2+y^2$ 의 평균값.

1) **거절샘플링**: 바운딩 박스 $[-1,1]^2$ 에서 균등 난수 샘플 $(x,y)$ 생성 → 조건 $|x|+|y|\le 1$ 을 통과한 점만 사용.
2) 평균값은 통과 샘플의 $f$ 평균.
3) 총합은 평균 $\times$ 영역면적(=2).

```python
import numpy as np

def mc_rhombus_avg(n=200_000, seed=0):
    rng = np.random.default_rng(seed)
    xs = rng.uniform(-1, 1, size=n)
    ys = rng.uniform(-1, 1, size=n)
    mask = (np.abs(xs) + np.abs(ys)) <= 1
    xm = xs[mask]
    ym = ys[mask]
    vals = xm**2 + ym**2
    # 평균값
    return vals.mean(), mask.mean()  # 평균, 통과비율(=Area/4)

avg, pass_ratio = mc_rhombus_avg()
area = 4*pass_ratio           # 바운딩 박스 4, 통과비율로 면적 추정
integral_est = avg*area
print("Estimated area ≈", area)               # ≈ 2
print("Estimated ∫(x^2+y^2) over D ≈", integral_est)
```

**참고**: 불규칙 영역이라도 **변수변환**으로 직사각형/원판화가 가능하면 그쪽이 더 효율적(분산 감소).

---

## 체크리스트

- □ 영역 스케치로 경계/대칭 확인 (대칭이면 **무게중심/기댓값**이 0 또는 단순화).
- □ 극좌표/선형스케일/합·차/비율형 등 **패턴에 맞는 변수변환** 적용.
- □ **야코비안 절댓값** 및 **적분구간** 정확 설정.
- □ 물리량: **밀도/압력/온도** 등 단위·치수 확인(차원 일관성).
- □ 확률: **정규화**( $\iint f=1$ )와 **지원 집합**(정의역) 점검.
- □ 수치계산: 바운딩 박스/거절율/샘플 수와 **분산**의 균형.

---

## 연습문제(풀이 스케치)

1) **원판** $x^2+y^2\le R^2$, $\rho=\rho_0(1+\alpha r^2)$ 에서 $I_z$ 구하라.
   - 극좌표, $I_z=\iint r^2\rho\,dx\,dy = 2\pi\rho_0\int_0^R (r^2+\alpha r^4)r\,dr$.

2) **직사각형** $[0,a]\times[0,b]$, $\rho(x,y)=kxy$ 의 $(\bar x,\bar y)$ 구하라.
   - $M=\int_0^a\int_0^b kxy\,dy\,dx$, $\bar x=\dfrac{1}{M}\int x(kxy)\,dy\,dx$ 등.

3) **정수압력**: 폭 $b$, 깊이 $h$ 사다리꼴 판의 합력과 작용점.
   - 압력 $p(y)=\rho gy$, 두께 $dx$ 스트립의 미소힘 합 → 이중적분.

4) **확률**: $X,Y$ 독립 균등 $[-1,1]$. $U=X+Y,\ V=X-Y$ 의 결합 pdf.
   - 선형변환 야코비안 사용, 지원 집합(마름모) 파악.

5) **영상**: 타원 $x^2/9+y^2/4\le 1$ 에서 2차 모멘트로 주축 길이/방향.
   - $x_c=y_c=0$, 평균 2차 모멘트는 $a^2/4,\ b^2/4$.

---

## 마무리

중적분은 **면적/부피/평균/무게중심/관성/정수압/열량** 등 수많은 양을 **한 번의 통합**으로 계산하게 한다.
해결 전략은 언제나 같다:

1) **영역**을 정확히 이해(스케치)
2) **대칭/패턴**을 보고 좌표/변수변환을 선택
3) **야코비안**과 **적분구간**을 딱 맞추고 계산
4) 필요하면 **수치적분(몬테카를로/격자)** 로 검증
