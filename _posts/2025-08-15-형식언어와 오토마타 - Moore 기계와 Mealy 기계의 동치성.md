---
layout: post
title: 형식언어와 오토마타 - Moore 기계와 Mealy 기계의 동치성
date: 2025-08-15 19:20:23 +0900
category: 형식언어와 오토마타
---
# Moore 기계와 Mealy 기계의 **동치성** — 정의, 변환 알고리즘, 상태 수 경계, 지연(shift) 정렬, 검증·최소화 관점

Moore와 Mealy는 **유한 상태 변환기**의 두 대표 모델입니다.  
둘은 “출력을 **언제** 내느냐”만 다를 뿐, **적절한 지연 보정(shift)** 을 허용하면 **동일한 변환 능력**을 가집니다.  
여기서는 (1) 동치의 의미, (2) **Mealy→Moore**, **Moore→Mealy** 변환, (3) 상태 수 경계, (4) 지연 정렬,  
(5) 동치성 판정·최소화의 차이를 체계적으로 정리합니다. 수식은 MathJax, 절차는 코드 블록(```)로 표기합니다.

---

## 1) 모델 복습과 “동치”의 의미

### 1.1 정의 요약
- **Mealy**  
  \[
  M=(Q,\Sigma,\Gamma,\delta,\lambda,q_0),\quad
  \delta:Q\times\Sigma\to Q,\;\; \lambda:Q\times\Sigma\to\Gamma
  \]
  한 스텝에서 **입력 1기호**를 읽으며 **바로 출력**.

- **Moore**  
  \[
  N=(P,\Sigma,\Gamma,\delta',\rho,p_0),\quad
  \delta':P\times\Sigma\to P,\;\; \rho:P\to\Gamma
  \]
  전이로 **다음 상태로 이동**한 뒤, **도착 상태의 출력**을 방출(초기 출력 \(\rho(p_0)\) 포함).

### 1.2 동치의 두 버전
입력 \(x=a_1\cdots a_n\)에 대해
- **엄밀 동치**: 두 기계의 출력 스트림이 **완전히 동일**.  
- **지연 동치(shift-equivalence)**: 한쪽의 출력이 다른 쪽의 출력에 대해 **고정된 offset**(보통 \(\pm 1\))만큼 앞서거나 뒤섬.
  - 관례상 Moore는 **초기 출력** 때문에 Mealy에 비해 **+1 스텝 길다**.  
  - 따라서 “초기 출력을 버리거나(또는 더하거나)” 정렬하면 **동일 변환**으로 본다.

> 실무·이론 모두에서 **지연 동치**가 표준입니다. 이후 결과는 모두 “지연 0 또는 1까지 허용”을 전제로 합니다.

---

## 2) **Moore → Mealy** : 즉시반응형으로 바꾸기 (상태 수 보존)

**아이디어**: Mealy 전이의 출력 \(\lambda(p,a)\)를 “도착 상태 출력 \(\rho(q)\)”로 채운다.

### 변환 공식
Moore \(N=(P,\Sigma,\Gamma,\delta',\rho,p_0)\)에서 Mealy \(M\)를
\[
Q:=P,\quad q_0:=p_0,\quad
\delta(q,a):=\delta'(q,a),\quad
\lambda(q,a):=\rho\!\big(\delta'(q,a)\big)
\]
로 정의.

- 입력 \(a_i\)를 읽을 때 Mealy가 내는 \(\lambda(q_{i-1},a_i)\)는 Moore가 **그 스텝 직후** 내는 \(\rho(q_i)\)와 동일.  
- **상태 수**: 동일(\(|Q|=|P|\)).

### 정확성(스케치)
\[
\forall x=a_1\cdots a_n:\;
\underbrace{\lambda(q_0,a_1)\cdots \lambda(q_{n-1},a_n)}_{\text{Mealy 출력}}
=
\underbrace{\rho(q_1)\cdots \rho(q_n)}_{\text{Moore 출력(초기 제외)}}
\]
따라서 **Moore의 초기 출력 \(\rho(p_0)\)만 제거**하면 완전 일치.

---

## 3) **Mealy → Moore** : 안정 출력형으로 바꾸기 (상태 세분화 필요)

**도전점**: Mealy의 출력은 \(\lambda(p,a)\)처럼 **(현재 상태, 입력)** 둘에 의존.  
Moore는 **상태만**으로 출력이 정해져야 하므로, “다음에 내보낼 출력”을 **상태에 묶어**야 합니다.

### 표준 변환
새 상태 집합을
\[
P := \{\, (q,y)\mid q\in Q,\; y\in \Gamma \,\}
\]
로 두고(필요한 쌍만 생성), 출력은 \(\rho((q,y)):=y\). 전이는
\[
\delta'\big((q,y),a\big) := \big(\,\delta(q,a),\; \lambda(q,a)\,\big).
\]
초기 상태는 “시작 출력”을 선택해야 하는데, 보통 **더미 출력**(예: \(\bot\))을 도입하여 \(p_0=(q_0,\bot)\)로 두거나,  
지연 동치를 채택해 **초기 출력은 무시(삭제)** 하기로 약속합니다.

- **상태 수 경계**: 최악에 \(|P|\le |Q|\cdot |\Gamma|\). (실제로는 도달 쌍만 생성)  
- **정확성**: Mealy의 \(i\)번째 출력 \(\lambda(q_{i-1},a_i)\)는 Moore의 **도착 상태 출력** \(\rho((q_i,\lambda(q_{i-1},a_i)))\)와 일치.

```text
# 의사코드(도달 상태만 생성)
queue := [(q0, ⊥)]
while queue not empty:
  (q,y) := pop()
  for a in Σ:
    q' := δ(q,a); y' := λ(q,a)
    add edge ( (q,y) --a--> (q',y') ), set ρ(q',y')=y'
    if (q',y') new: push((q',y'))
```

---

## 4) 상태 수와 지연에 대한 **정리**

- **정리 A (Moore→Mealy)**: 상태 수 **그대로**, 지연 **−1**(초기 출력 제거)로 **동치**.  
- **정리 B (Mealy→Moore)**: 길이 **+1 지연**을 허용하면 항상 변환 가능. 상태 수는 **최대 \(|Q|\cdot|\Gamma|\)** 배.  
- **결론**: 두 모델은 **출력 시점의 0/1 스텝 차이**만 있을 뿐, 표현 가능한 **길이-보존(동기) 변환** 계열이 **동일**.

> 더 일반화된 “문자열 출력/최종 출력”을 허용하는 **순차 변환기(subsequential transducer)** 관점에서도  
> Mealy·Moore는 **동일한 함수류**(정규/순차 함수)를 구현합니다. 지연은 **상수 길이 꼬리**로 흡수됩니다.

---

## 5) 예제로 보는 변환

### 5.1 Moore → Mealy (패리티 발생기)
Moore에서 도착 상태 출력이 0/1인 패리티 기계:
```text
Moore 상태/출력: qE/0, qO/1
전이: qE--0→qE, qE--1→qO, qO--0→qO, qO--1→qE
```
Mealy로:
```text
Mealy λ(q,a) = ρ(δ(q,a))   # 같은 전이, 출력만 도착 상태의 ρ
# 출력은 Moore의 (초기 제외)와 동일
```

### 5.2 Mealy → Moore (“01” 검출)
Mealy는 `01`의 **둘째 1을 읽는 순간** 1을 내보냄.  
Moore로 바꾸면 1이 **다음 스텝**에 나오므로 **+1 지연**이 생김.  
상태를 `(원상태, 직전 출력)` 쌍으로 만들면 정확히 일치.

---

## 6) 동치성(Equivalence) 판정: 제품 기계와 정렬

두 기계 \(A,B\)의 출력이 **같은지**(또는 **shift 1까지 같은지**)를 확인하는 절차:

1) **정렬 선택**:  
   - 엄밀: 출력 길이 동일해야 함(초기 출력 포함 여부를 맞춤).  
   - 지연: 한쪽 초기 출력을 버리거나 더미를 붙여 **길이 맞춤**.

2) **제품 기계**: 상태를 \((p,q)\)로 하여, 같은 입력을 **동시에** 주입.  
   - 각 스텝에서 **출력 비교**: 다르면 **비동치 증거** 즉시 발견.  
   - 전 상태 공간을 완주하거나 차이를 못 찾으면 **동치**.

> 결정적 기계라면 선형 시간/공간(상태·전이 수에 비례) 내에 검사 가능합니다.

---

## 7) 최소화와의 관계(왜 상태 수가 달라지는가?)

- **Mealy 최소화**: 출력이 **전이 라벨**에 붙어 있으므로, 같은 전이를 취해도 출력이 다르면 **상태를 나눌 필요가 없음**.  
- **Moore 최소화**: 출력이 **상태 라벨**이므로, “같은 목적 상태이지만 서로 다른 출력으로 들어오는 경우”를 위해 **상태 세분화**가 필요.  
  → 바로 이 차이가 **Mealy→Moore** 변환 시 \(|\Gamma|\) 배 **폭증**의 원인.

> 반대로 Moore→Mealy는 보통 **상태가 줄거나 유지**됩니다(출력 다양성을 상태 대신 전이로 밀어 넣음).

---

## 8) 하드웨어·실무 관점 요약

| 항목 | Mealy | Moore |
|---|---|---|
| 출력 시점 | 입력과 **동일 클럭** | **다음 클럭**(1-스텝 지연) |
| 글리치 | 상대적으로 큼 | **작음**(상태 레지스터 기반) |
| 상태 수 | 적게 나오는 경향 | 늘 수 있음(출력 다양성만큼) |
| 동치성 | 지연 0 기준 | 지연 +1 기준 |
| 변환 | Moore→Mealy는 간단 | Mealy→Moore는 상태 세분화 필요 |

---

## 9) 한 페이지 정리

- **표현력**: Moore와 Mealy는 **동기(길이-보존) 변환**에 대해 **동등**.  
- **변환**:  
  - Moore→Mealy: \(\lambda(p,a)=\rho(\delta'(p,a))\) — **상태 수 보존**, 초기 출력만 조정.  
  - Mealy→Moore: 상태를 \((q,\text{“내보낼 출력”})\)로 **세분화** — **최대 \(|Q|\cdot|\Gamma|\)**.  
- **동치 기준**: **지연 0/1** 정렬만 합의하면 두 모델의 출력 스트림은 **항상 일치**하도록 만들 수 있다.  
- **검증**: 제품 기계로 출력 비교. **최소화**는 Mealy가 유리(전이 라벨), Moore는 상태가 늘 수 있다.
