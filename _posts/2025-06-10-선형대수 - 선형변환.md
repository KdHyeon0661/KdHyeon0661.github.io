---
layout: post
title: 선형대수 - 선형변환
date: 2025-06-10 20:20:23 +0900
category: 선형대수
---
# 선형변환의 정의와 예제 — 행렬, 기하, 코드까지 한 번에 정복

> **핵심 요약 (TL;DR)**
> - **정의**: \(T:V\to W\) 가 **덧셈**과 **스칼라곱**을 보존하면 선형.  
>   $$T(\mathbf u+\mathbf v)=T(\mathbf u)+T(\mathbf v),\quad T(c\,\mathbf u)=c\,T(\mathbf u)$$
> - **표현**: 적절한 기저를 잡으면 항상 **행렬** \(A\) 가 존재하여  
>   $$T(\mathbf x)=A\,\mathbf x.$$
> - **기하**: 회전·반사·전단·스케일·정사영 등은 전형적 **선형변환**. (이동은 선형 아님!)
> - **핵심 객체**: **영공간**(kernel)과 **상(image)**, 그리고 **rank-nullity**가 구조를 설명.

---

## 1) 선형변환의 수학적 정의와 즉시 성질

### 정의
두 실벡터공간 \(V,W\) 사이의 함수 \(T:V\to W\) 가 모든 \(\mathbf u,\mathbf v\in V\), \(c\in\mathbb R\) 에 대해
$$
T(\mathbf u+\mathbf v)=T(\mathbf u)+T(\mathbf v),\qquad
T(c\,\mathbf u)=c\,T(\mathbf u)
$$
를 만족하면 **선형변환(linear transformation)**이라 한다.

### 동치 표현
한 번에 쓰면
$$
T(a\,\mathbf u+b\,\mathbf v)=a\,T(\mathbf u)+b\,T(\mathbf v)\quad(\forall a,b\in\mathbb R).
$$

### 즉시 성질
- **원점 보존**: \(T(\mathbf 0)=\mathbf 0\).  
  (증명: \(T(\mathbf 0)=T(0\,\mathbf u)=0\,T(\mathbf u)=\mathbf 0\))
- **선형결합 보존**: \(T\big(\sum_i \alpha_i\mathbf v_i\big)=\sum_i \alpha_i T(\mathbf v_i)\).
- **직선/평면을 원점 지나는 직선/평면으로**: 곡선·평행이동은 만들 수 없다.

---

## 2) 행렬과 선형변환 — “기저만 정하면 곧 행렬”

### 표준기저에서의 행렬
\(V=\mathbb R^n, W=\mathbb R^m\) 이고 표준기저를 쓰면, **유일한** \(m\times n\) 행렬 \(A\) 가 존재:
$$
T(\mathbf x)=A\,\mathbf x,\quad
A=\big[\,T(\mathbf e_1)\ \cdots\ T(\mathbf e_n)\,\big],
$$
즉 **열 \(i\)** 가 \(T(\mathbf e_i)\) 이다.

### 일반 기저에서
- \(V\)의 기저행렬 \(B=[\mathbf b_1\ \cdots\ \mathbf b_n]\), \(W\)의 기저행렬 \(C=[\mathbf c_1\ \cdots\ \mathbf c_m]\) 에 대해
  좌표벡터 \( [\mathbf x]_B \) 를 \( [T(\mathbf x)]_C = A_{C\leftarrow B}[\mathbf x]_B \) 로 매트릭스화 가능.
- 표준행렬 \(A\) 와의 관계:
  $$
  A_{C\leftarrow B} = C^{-1} A B.
  $$

---

## 3) 영공간·상·랭크-널리티 정리

- **영공간(kernel/null space)**:  
  $$\ker T=\{\mathbf x\in V: T(\mathbf x)=\mathbf 0\}=\{\mathbf x: A\mathbf x=\mathbf 0\}.$$
- **상(image/column space)**:  
  $$\mathrm{im}\,T=\{T(\mathbf x):\mathbf x\in V\}=\mathrm{Col}(A).$$
- **랭크-널리티** (유한차원 \(V\)):
  $$
  \boxed{\ \dim V = \underbrace{\mathrm{rank}(A)}_{\dim\mathrm{im}\,T}\ +\ \underbrace{\mathrm{nullity}(A)}_{\dim\ker T}\ }.
  $$
- **가역성**: \(T\)가 동형사상(서로 다대일·전사) ⇔ \(A\) 가역 ⇔ \(\det A\neq 0\) ⇔ \(\ker T=\{\mathbf 0\}\) 및 \(\mathrm{rank}(A)=n\).

---

## 4) 대표적 선형변환 — 기하·행렬·성질

### (a) 스케일(등방/이방)
- 등방: \(T(\mathbf x)=s\,\mathbf x\) ⇒ \(A=sI\).
- 이방: 축별 배수 \(A=\mathrm{diag}(s_1,\dots,s_n)\).
- **det**: \(\det A=\prod_i s_i\) = 면적/부피 배율.

### (b) 회전(2D)
$$
A(\theta)=\begin{bmatrix}\cos\theta&-\sin\theta\\ \sin\theta&\cos\theta\end{bmatrix},\quad
\det A=+1,\ A^\top A=I.
$$
- 길이·각도 보존(직교변환).

### (c) 반사(2D, x축)
$$
A=\begin{bmatrix}1&0\\0&-1\end{bmatrix},\quad \det A=-1.
$$
- 방향 반전, 길이 보존.

### (d) 전단(shear)
$$
A=\begin{bmatrix}1&k\\0&1\end{bmatrix},\quad \det A=1,\ \ker A=\{\mathbf 0\}.
$$
- 면적 보존, 각도·길이 비보존.

### (e) 직교정사영(projection onto a line spanned by \(\mathbf u\))
$$
P=\frac{\mathbf u\mathbf u^\top}{\mathbf u^\top\mathbf u},\quad
P^2=P,\ P^\top=P,\ \det P\in\{0,1\}.
$$
- 멱등·대칭, **가역 아님**(항등 제외).

### (f) 좌표축 교환(스왑)
$$
A=\begin{bmatrix}0&1\\1&0\end{bmatrix},\quad A^{-1}=A,\ \det A=-1.
$$

---

## 5) 기하적 효과 — 면적/부피·방향·불변량

- **면적/부피 배율**: \(|\det A|\).
- **방향성(orientation)**: \(\det A>0\) 보존, \(\det A<0\) 반전(반사 포함).
- **고유벡터**: \(A\mathbf v=\lambda \mathbf v\) 인 \(\mathbf v\) 는 **불변방향**.  
  대각화 가능 시 “좋은 기저”에서 계산이 스칼라화.

---

## 6) 합성·역·기저변화

- **합성**: \(S\circ T\) 의 행렬은 \(A_SA_T\) (우측에 먼저 적용).
- **역**: \(T^{-1}\) 의 행렬은 \(A^{-1}\) (가역 시).
- **기저 변화**: 기저 \(B\) 기준 행렬  
  $$A_B=B^{-1}AB,\quad A_C=(C^{-1}B)^{-1}A_B(C^{-1}B).$$

---

## 7) 선형/비선형 구분 빠른 체크

- **선형**: 회전, 전단, 스케일, 축반사, 정사영, 미분연산(적당한 함수공간).
- **비선형**: **이동** \(T(\mathbf x)=\mathbf x+\mathbf a\) (원점 비보존),  
  성분제곱 \(T(x,y)=(x^2,y)\), 정규화 \(T(\mathbf x)=\mathbf x/\|\mathbf x\|\), ReLU 등.

**테스트 팁**: \(T(\mathbf 0)=\mathbf 0\) 이 아니면 즉시 탈락.

---

## 8) 손으로 풀어보는 예제

### 예제 1: 전단과 회전의 합성
- \(S=\begin{bmatrix}1&k\\0&1\end{bmatrix}\), \(R(\theta)\) 회전.
- 합성 \(R\circ S\) 의 행렬은 \(R(\theta)S\).  
  면적은 \(|\det(RS)|=|\det R|\,|\det S|=1\) (면적 보존).

### 예제 2: 주어진 매핑으로부터 행렬 만들기
“표준기저 \(\mathbf e_1,\mathbf e_2\) 가 다음으로 간다”
- \(T(\mathbf e_1)=(2,1)^\top\), \(T(\mathbf e_2)=(1,3)^\top\)  
  ⇒
  $$
  A=\big[T(\mathbf e_1)\ T(\mathbf e_2)\big]
  =\begin{bmatrix}2&1\\1&3\end{bmatrix}.
  $$
  \(\det A=5\neq 0\) ⇒ 가역, 면적 5배, 방향 보존.

### 예제 3: 직선 \(y=x\) 에 대한 반사
단위법선 \(\mathbf n=\frac{1}{\sqrt2}(1,-1)^\top\). 반사는
$$
R = I - 2\,\mathbf n\mathbf n^\top
= \begin{bmatrix}0&1\\1&0\end{bmatrix}.
$$
즉 좌표 스왑.

### 예제 4: 어떤 변환이 선형인지 판정
\(T(x,y)=(x+y,y)\):  
\(T(\mathbf e_1)=(1,0), T(\mathbf e_2)=(1,1)\) ⇒  
\(A=\begin{bmatrix}1&1\\0&1\end{bmatrix}\) 존재 ⇒ 선형.  
\(S(x,y)=(x+1,y)\): \(S(\mathbf 0)=(1,0)\neq \mathbf 0\) ⇒ 비선형.

---

## 9) 파이썬 코드 — 실전 검증/계산 스니펫

> NumPy는 수치, SymPy는 상징 계산(정확도, 고유분해 등)에 유용.

```python
import numpy as np
from numpy.linalg import det, norm, solve, eig
from sympy import Matrix

# ---------- A. 선형성 빠른 체크 ----------
def is_linear(T, dim=2, trials=5, tol=1e-9):
    rng = np.random.default_rng(0)
    for _ in range(trials):
        u = rng.normal(size=dim)
        v = rng.normal(size=dim)
        a, b = rng.normal(size=2)
        lhs = T(a*u + b*v)
        rhs = a*T(u) + b*T(v)
        if norm(lhs - rhs) > tol: return False
    return True

# 예: 전단 T(x,y)=(x+ky, y)
k = 1.5
T = lambda x: np.array([x[0] + k*x[1], x[1]])
print("전단 선형?", is_linear(T, dim=2))

# 이동 S(x,y)=(x+1,y)
S = lambda x: np.array([x[0] + 1, x[1]])
print("이동 선형?", is_linear(S, dim=2))

# ---------- B. 기저→행렬, 행렬→기하 ----------
# 표준기저 이미지로부터 행렬
A = np.column_stack((np.array([2,1]), np.array([1,3])))
print("A=\n", A, " det(A)=", det(A))

# 부피/면적 배율과 방향성
print("면적배율=", abs(det(A)), " 방향보존?", det(A) > 0)

# ---------- C. 회전·전단 합성 ----------
theta = np.deg2rad(30)
R = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])
S_mat = np.array([[1., k],
                  [0., 1.]])
M = R @ S_mat
print("합성 R∘S det=", det(M))

# ---------- D. 정사영 행렬 성질 확인 ----------
u = np.array([2., 1.])
P = np.outer(u, u) / (u @ u)
x = np.array([1., 3.])
px = P @ x
print("P^2≈P?", np.allclose(P @ P, P))
print("대칭?", np.allclose(P.T, P))
print("정사영 결과=", px)

# ---------- E. 고유값/대각화 관찰 ----------
w, V = eig(A)  # 수치 고유분해
print("eigvals(A)=", w)
# A*V ≈ V*diag(w)
print("고유방정식 검증?", np.allclose(A @ V, V @ np.diag(w)))

# ---------- F. SymPy로 정확한 det/kernel ----------
A_sym = Matrix(A.tolist())
print("SymPy det =", A_sym.det())
print("SymPy nullspace =", A_sym.nullspace())  # 영공간 기저
```

**무엇을 보여주나?**
- `is_linear`: 임의 샘플로 선형성 점검(실전 디버깅에 유용).
- `det(A)`: 면적/부피 배율, 부호는 방향성.
- 합성 `R @ S_mat`: 합성의 행렬은 곱, det 곱셈 법칙 검증.
- 정사영 `P`: 멱등/대칭 성질 확인, 투영 결과 벡터까지.
- 고유값/벡터: 불변방향 확인. SymPy로 정확한 영공간까지.

---

## 10) 자주 만나는 응용 시나리오

- **그래픽스/로보틱스**: 로컬→월드→카메라 좌표 **회전/반사/전단** 합성.  
  행렬곱 순서로 파이프라인을 모형화.
- **신호/데이터**: PCA의 직교변환(선형)으로 **상관 제거**; 투영(선형)으로 저차원 근사.
- **역문제/회귀**: \(A\mathbf x\approx \mathbf b\) 최소제곱은 결국 선형연산의 합성.
- **미분연산**: 특정 함수공간에서 도함수·컨볼루션은 선형작용자.

---

## 11) 실수·오해 방지 체크리스트

1. **이동(Translation)** 은 선형이 아님: \(T(\mathbf 0)\neq \mathbf 0\).  
   (ML의 **Affine layer** \(A\mathbf x+\mathbf b\) 에서 **bias=0** 일 때만 선형)
2. **합성 순서**: \(S\circ T\) 의 행렬은 **우측이 먼저**: \(A_SA_T\).
3. **det=0** 이면 부피 0 ⇒ 차원 축소(정사영·축소·종속) ⇒ **비가역**.
4. **직교변환**은 길이/각도 보존, \(\det=\pm1\).  
   정사영·전단은 보존하지 않는다.

---

## 12) 연습문제(풀이 아이디어 포함)

1. **전단 후 회전**과 **회전 후 전단**이 같은가?  
   ⇒ 일반적으로 **아님**. 둘의 행렬을 각각 계산·비교.
2. \(T(x,y)=(3x+2y,\ x-y)\) 의 고유값/고유벡터를 구하고 면적배율을 해석.  
   ⇒ \(A=\begin{bmatrix}3&2\\1&-1\end{bmatrix}\), \(|\det A|\) 가 면적배율.
3. \(\mathbf u=(1,2,2)^\top\) 에 대한 직교정사영 행렬 \(P\) 를 만들고,  
   임의 \(\mathbf x\) 에 대해 \(P^2=P\), \((I-P)\) 가 \(\mathbf u\) 와 직교인 공간의 정사영임을 수치로 확인.
4. \(\ker T=\{\mathbf 0\}\) 이고 \(\dim V=\dim W\) 라면, \(T\) 는 가역임을 보이라.  
   ⇒ 랭크-널리티 및 차원비교.

---

## 13) 마무리 요약

| 주제 | 핵심 한 줄 |
|---|---|
| 선형의 본질 | 덧셈·스칼라곱 보존 ⇔ 선형결합의 형태 그대로 보존 |
| 행렬 표현 | 기저만 정하면 항상 \(T(\mathbf x)=A\mathbf x\) 로 쓸 수 있음 |
| 구조 해석 | \(\ker\), \(\mathrm{im}\), rank-nullity 가 전부 알려줌 |
| 기하 효과 | \(\det A\): 면적/부피·방향. 직교변환은 길이/각도 보존 |
| 실무 팁 | 합성은 곱, 순서 중요. 이동은 선형 아님. det=0은 비가역 |

필요하면 위 코드 스니펫을 바탕으로 **특정 변환**을 넣어 수치 검증까지 바로 확장해 보세요.  
“행렬로 생각하는 습관”이 들면, 선형변환은 **공식**이 아니라 **도구상자**가 됩니다.