---
layout: post
title: 선형대수 - 고유값과 고유벡터
date: 2025-06-17 19:20:23 +0900
category: 선형대수
---
# 🧠 고유값(Eigenvalue)과 고유벡터(Eigenvector)

> **핵심 요약**  
> 정방행렬 \(A\)에 대해 \(A\vec v=\lambda\vec v\)를 만족하는 **영벡터가 아닌** \(\vec v\)를 **고유벡터**, 그 스칼라 \(\lambda\)를 **고유값**이라 한다.  
> 고유값은 **특성방정식** \(\det(A-\lambda I)=0\)의 해이며, 고유벡터는 \(\ker(A-\lambda I)\)의 원소이다.

---

## 🗺️ 로드맵

1) **정의 → 특성다항식 → 고유공간**  
2) **직관**(기하 해석: 늘림/축소·방향 보존, 회전·반사)  
3) **계산법**: 2×2/3×3 손계산, 삼각/대칭, 실수 vs 복소  
4) **대각화·스펙트럼**: 다중도, 스펙트럴 정리, 요르단  
5) **응용**: \(A^k\), \(e^{At}\), 마르코프/그래프/물리·PCA 스냅샷  
6) **수치실무**: `eig`/`eigh`, 파워메서드, QR, 민감도  
7) **완전 예제 & 파이썬 코드**(NumPy/SymPy)  
8) **체크리스트·연습문제**

---

## 1. 정의와 기본 사실

### 1.1 정의
정방행렬 \(A\in\mathbb{R}^{n\times n}\)(또는 \(\mathbb{C}^{n\times n}\))에 대해
$$
\boxed{A\vec v=\lambda\vec v,\quad \vec v\neq \vec 0}
$$
이면 \(\lambda\)는 **고유값**, \(\vec v\)는 **고유벡터**.

이를 변형하면
$$
(A-\lambda I)\vec v=\vec 0\quad\Rightarrow\quad \vec v\in \ker(A-\lambda I).
$$

### 1.2 특성다항식(Characteristic Polynomial)
고유값은
$$
\boxed{\det(A-\lambda I)=0}
$$
의 해. \(\chi_A(\lambda)=\det(A-\lambda I)\)는 \(\lambda\)에 대한 \(n\)차 다항식.

- **대수적 다중도** \(m_a(\lambda)\): \(\chi_A\)에서 \((\lambda-\lambda_i)\)의 지수
- **기하학적 다중도** \(m_g(\lambda)=\dim\ker(A-\lambda I)\)  
  항상 \(1\le m_g(\lambda)\le m_a(\lambda)\).

### 1.3 고유공간(Eigenspace)
$$
E_\lambda=\ker(A-\lambda I)=\{\vec v\neq 0:(A-\lambda I)\vec v=\vec 0\}\cup\{\vec 0\}.
$$

---

## 2. 직관과 기하 해석

- **대부분의 벡터**는 \(A\) 작용 시 **방향과 길이**가 모두 변한다.  
- **고유벡터 방향**은 **보존**되고 길이만 \(|\lambda|\)배(부호/복소위상 포함) 바뀐다.
- \(\lambda>0\): 방향 유지·스케일, \(\lambda<0\): **반사(뒤집힘)** 포함.  
- 2D **회전행렬**은 \(\theta\notin\{0,\pi\}\)에서 **복소 켤레쌍** 고유값 \(e^{\pm i\theta}\)만 존재(실고유벡터 없음).

---

## 3. 손계산 요령

### 3.1 2×2
\(A=\begin{bmatrix}a&b\\ c&d\end{bmatrix}\) 이면
$$
\chi_A(\lambda)=\lambda^2-(a+d)\lambda+(ad-bc).
$$
- \(\lambda_1+\lambda_2=\operatorname{tr}A\), \(\lambda_1\lambda_2=\det A\).

### 3.2 3×3
- **상/하삼각**: 고유값은 **대각 원소**들.  
- 일반 3×3은 전개(사루스/라플라스)나 구조(대칭/희소)를 활용.

### 3.3 실대칭(또는 허미티안)
- 모든 고유값 **실수**, 서로 다른 고유공간 **직교**, **정규직교 기저** 가능  
  → 수치적으로 가장 안정, \(A=Q\Lambda Q^\top\).

---

## 4. 대각화·요르단·스펙트럼

### 4.1 대각화 가능 조건
- **충분조건**: 서로 다른 \(n\)개의 고유값  
- **필요충분조건**: 모든 \(\lambda\)에 대해 \(m_g(\lambda)=m_a(\lambda)\).  
  (결함 있으면 **요르단 정규형** 필요)

### 4.2 스펙트럴 정리(실대칭)
$$
\boxed{A=A^\top\ \Rightarrow\ \exists Q\ \text{s.t.}\ A=Q\Lambda Q^\top,\ Q^\top Q=I,\ \Lambda=\mathrm{diag}(\lambda_i)\in\mathbb{R}^{n\times n}}
$$
→ 직교대각화, 정규직교 고유기저.

### 4.3 케일리–해밀턴
$$
\chi_A(A)=\vec 0.
$$
→ \(A^k\)를 \(\deg\chi_A\le n\)의 다항식으로 환원 가능. \(e^{At}\) 계산에도 유용.

---

## 5. 대표 예제 모음 (손계산)

### 5.1 대칭 2×2
\[
A=\begin{bmatrix}2&1\\1&2\end{bmatrix}
\]
특성다항식:
\[
\det(A-\lambda I)=(2-\lambda)^2-1=\lambda^2-4\lambda+3=(\lambda-1)(\lambda-3).
\]
- \(\lambda=3\): \((A-3I)\vec v=\vec 0\Rightarrow x=y\Rightarrow \vec v=[1,1]^\top\)  
- \(\lambda=1\): \((A-I)\vec v=\vec 0\Rightarrow x=-y\Rightarrow \vec v=[1,-1]^\top\)

### 5.2 전단(shear) — 결함 사례
\[
S=\begin{bmatrix}1&1\\0&1\end{bmatrix},\quad \chi_S(\lambda)=(1-\lambda)^2.
\]
- 고유값 \(1\) (대수 2), 기하다중도는 1(\(x\)-축 방향만) → **대각화 불가**.

### 5.3 회전(2D)
\[
R_\theta=\begin{bmatrix}\cos\theta&-\sin\theta\\ \sin\theta&\cos\theta\end{bmatrix}
\Rightarrow \lambda=e^{\pm i\theta}.
\]
- \(\theta\not\in\{0,\pi\}\)이면 실고유벡터 없음(순수 회전).

### 5.4 반사(직선에 대한 반사)
직선 방향은 \(\lambda=1\), 그 수직방향은 \(\lambda=-1\).

### 5.5 3×3 상삼각
\[
T=\begin{bmatrix}1&2&0\\0&1&0\\0&0&3\end{bmatrix}\Rightarrow \lambda=\{1,1,3\}.
\]
- \(\lambda=1\)의 기하다중도는 구조를 봐야 함(여기선 1) → 경우에 따라 요르단 블록.

---

## 6. 응용 스냅샷

- **거듭제곱** \(A^k\): 대각화 가능 시 \(A^k=V\Lambda^k V^{-1}\). 지배적 고유값이 크면 그 방향으로 수렴.  
- **선형 ODE** \(\dot x=Ax\): 해 \(x(t)=\sum_i c_i e^{\lambda_i t}\vec v_i\). \(\Re(\lambda_i)<0\) → 안정.  
- **마르코프 연쇄**(확률전이 \(P\)): \(\lambda=1\) 고유값 존재, 정상분포는 왼고유벡터.  
- **그래프**: 라플라시안 \(L=D-A\)의 두 번째 작은 고유값(Fiedler 값) → 연결성/클러스터링.  
- **PCA**: 공분산 \(C\)의 고유쌍 \((\lambda_i,\vec v_i)\) → 분산(\(\lambda_i\))·주성분축(\(\vec v_i\)).

---

## 7. 수치 실무 팁

- **대칭/허미티안**: `numpy.linalg.eigh`(또는 `scipy.linalg.eigh`) 사용 — 정확·안정.  
- **일반 행렬**: `numpy.linalg.eig`(복소 가능).  
- **대형/희소**: `scipy.sparse.linalg.eigs/eigsh`로 상위 몇 개만 추출.  
- **파워 메서드**: 최대 절댓값 고유값/벡터 근사.  
- **QR 알고리즘**: 전범위 스펙트럼(기본 고윳값 알고리즘).  
- **정규화/스케일링**으로 조건수 개선, **거르슈고린 원판**으로 대략적 위치 추정.

---

## 8. 파이썬 실전 (NumPy/SymPy)

### 8.1 기본 고윳값/고유벡터, 비에타 검증
```python
import numpy as np

A = np.array([[2., 1.],
              [1., 2.]])

w, V = np.linalg.eig(A)  # w: eigenvalues, V: eigenvectors (columns)
print("고유값:", w)
print("고유벡터(열):\n", V)

# 비에타 관계 확인
print("tr(A) vs sum eigenvalues:", np.trace(A), np.sum(w))
print("det(A) vs prod eigenvalues:", np.linalg.det(A), np.prod(w))

# 대각화 검증: A = V Λ V^{-1}
Λ = np.diag(w)
A_recon = V @ Λ @ np.linalg.inv(V)
print("복원 오차 ||A - VΛV^{-1}||:", np.linalg.norm(A - A_recon))
```

### 8.2 실대칭은 `eigh`가 정답
```python
import numpy as np

A = np.array([[3., 2., 0.],
              [2., 3., 0.],
              [0., 0., 1.]])  # 대칭

# eigh: 정렬/직교 보장, 더 안정적
w, Q = np.linalg.eigh(A)
print("대칭행렬 고유값:", w)
print("직교성 검사 ||Q^T Q - I||:", np.linalg.norm(Q.T @ Q - np.eye(3)))
```

### 8.3 결함 전단행렬의 고유공간
```python
import numpy as np

S = np.array([[1., 1.],
              [0., 1.]])
w, V = np.linalg.eig(S)
print("고유값:", w)               # [1.+0.j 1.+0.j]
print("고유벡터(열):\n", V)       # 고유벡터 하나의 방향만 유의미
rank = np.linalg.matrix_rank(S - np.eye(2))
null_dim = 2 - rank
print("기하다중도(dim ker(S-I)):", null_dim)  # 1
```

### 8.4 회전행렬의 복소 고유값
```python
import numpy as np

θ = np.pi/6
R = np.array([[np.cos(θ), -np.sin(θ)],
              [np.sin(θ),  np.cos(θ)]])
w, V = np.linalg.eig(R)
print("회전행렬 고유값:", w)  # e^{±iθ}
```

### 8.5 마르코프 연쇄: 정상분포(왼고유벡터 λ=1)
```python
import numpy as np

P = np.array([[0.9, 0.3],
              [0.1, 0.7]])
# 왼고유벡터: π^T P = π^T (λ=1)
w, V = np.linalg.eig(P.T)
idx = np.argmin(np.abs(w - 1.0))
pi = np.real(V[:, idx])
pi = pi / np.sum(pi)
print("정상분포 π:", pi)
# 검증: π^T P = π^T
print("검증 오차 ||π^T P - π^T||:", np.linalg.norm(pi @ P - pi))
```

### 8.6 SymPy로 상징적(기호) 해
```python
import sympy as sp
λ = sp.Symbol('λ')
A = sp.Matrix([[2, 1],
               [1, 2]])
char = A.charpoly(λ).as_expr()
print("특성다항식:", sp.factor(char))
print("고유값:", A.eigenvals())  # {3: 1, 1: 1}
print("고유벡터:", A.eigenvects())
```

---

## 9. 자주 틀리는 포인트

- **고유벡터의 스칼라 배**는 여전히 고유벡터 → **정규화**로 대표 하나 선택.  
- `eig` 결과의 **정렬 순서 보장 없음** → 필요 시 값 기준 재정렬.  
- 거의 중복된 고유값(근접 스펙트럼)은 **수치 불안정** → `eigh`, 정규화, 반복검증.  
- 대칭 아님 + 결함(전단 등) → **대각화 불가**, 요르단 형태 고려.

---

## 10. 요약 표

| 항목 | 핵심식/정의 | 포인트 |
|---|---|---|
| 정의 | \(A\vec v=\lambda\vec v\) | \(\vec v\neq 0\) |
| 특성다항식 | \(\chi_A(\lambda)=\det(A-\lambda I)\) | 근이 고유값 |
| 다중도 | \(m_a\ge m_g\) | 대각화는 \(m_a=m_g\) 모두 |
| 스펙트럴 정리 | \(A=A^\top\Rightarrow A=Q\Lambda Q^\top\) | 실고유값·직교기저 |
| 합/곱 | \(\sum\lambda_i=\operatorname{tr}A,\ \prod\lambda_i=\det A\) | 비에타 |
| 동역학 | \(x(t)=\sum c_i e^{\lambda_i t}\vec v_i\) | 안정성: 실부호/크기 |

---

## 11. 연습 문제

1) \(A=\begin{bmatrix}4&-1\\2&1\end{bmatrix}\)의 고유값/고유벡터를 구하고, \(\operatorname{tr}A,\det A\)와 일치 여부 확인.  
2) \(S=\begin{bmatrix}1&1\\0&1\end{bmatrix}\)에 대해 \(m_a(1),m_g(1)\)을 구하고 대각화 가능성 판단.  
3) 회전행렬 \(R_\theta\)의 고유값이 \(e^{\pm i\theta}\)임을 보이고, \(\theta=\pi\)에서만 실고유벡터가 존재함을 확인.  
4) 대칭 \(A\)를 임의로 만들고 `eigh`로 \(Q,\Lambda\)를 구해 \(Q^\top A Q=\Lambda\)를 수치 검증.

---

## 12. 마무리 한 줄

> 고유값/고유벡터는 **변환의 고정 방향과 그 스케일**을 알려주는 **좌표계의 올바른 선택**이다.  
> 특성다항식으로 시작해, 스펙트럼 구조를 읽고, 계산·응용·수치까지 연결하자.