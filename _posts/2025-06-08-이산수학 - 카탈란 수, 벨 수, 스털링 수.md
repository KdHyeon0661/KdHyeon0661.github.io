---
layout: post
title: 이산수학 - 카탈란 수, 벨 수, 스털링 수
date: 2025-06-08 23:20:23 +0900
category: 이산수학
---
# 🧮 고급 조합 수열: 카탈란 수 / 벨 수 / 스털링 수

## 📌 개요

조합 문제는 단순히 순서와 선택을 넘어서, **구조를 갖는 조합**, **집합 분할**, **쌍짓기**, **계층적 구조 계산**으로 확장됩니다.  
이러한 고급 조합 문제는 아래 세 가지 수열로 대표됩니다:

- ✅ **카탈란 수**: 괄호, 경로, 트리 등 **구조적 조합 수**
- ✅ **벨 수**: 원소들을 **집합으로 나누는 방법**
- ✅ **스털링 수**: **n개의 원소를 k개의 그룹으로 나누는** 세부 수

---

## 🟢 1. 카탈란 수 (Catalan Numbers)

### ✅ 정의

다양한 조합 문제에서 등장하는 수열. 대표적인 해석은:

> **올바른 괄호 쌍의 수**,  
> **이진 트리의 개수**,  
> **정사각형 격자 내 비탈길 경로 수** 등

### 📌 공식

\[
C_n = \frac{1}{n+1} \binom{2n}{n} = \binom{2n}{n} - \binom{2n}{n+1}
\]

### 🎯 초기 값

\[
C_0 = 1,\quad C_1 = 1,\quad C_2 = 2,\quad C_3 = 5,\quad C_4 = 14,\quad C_5 = 42, \dots
\]

---

### 🧪 대표 문제들

| 문제 | 설명 |
|------|------|
| 올바른 괄호 쌍 | n쌍의 괄호를 올바르게 나열하는 방법 |
| 이진 트리 | 노드 n개로 만들 수 있는 이진 트리 수 |
| 정사각형 경로 | (0,0) → (n,n)까지 아래로만 내려가지 않는 경로 수 |
| 폴리노미얼 곱셈 트리 | 곱셈의 괄호 배치 방법 |

---

### 💡 구현 (재귀 / DP)

```python
def catalan(n):
    if n == 0 or n == 1:
        return 1
    result = 0
    for i in range(n):
        result += catalan(i) * catalan(n - 1 - i)
    return result
```

---

## 🟡 2. 벨 수 (Bell Numbers)

### ✅ 정의

**n개의 서로 다른 원소를 집합으로 나누는 방법의 수**  
(부분집합의 수가 아님!)

\[
B_n = \text{n개의 원소를 분할하는 방법 수}
\]

---

### 🎯 초기 값

\[
B_0 = 1,\quad B_1 = 1,\quad B_2 = 2,\quad B_3 = 5,\quad B_4 = 15,\quad B_5 = 52, \dots
\]

---

### 📌 관계

\[
B_{n+1} = \sum_{k=0}^{n} \binom{n}{k} B_k
\]

> 이 점화식을 사용해 동적 계획법으로 계산할 수 있음.

---

### 🧪 예제

- {a, b, c} → 분할 방법:
  - { {a,b,c} }
  - { {a}, {b,c} }
  - { {b}, {a,c} }
  - { {c}, {a,b} }
  - { {a}, {b}, {c} }

→ 총 5가지 → \( B_3 = 5 \)

---

### 💡 구현 (DP)

```python
def bell(n):
    bell = [[0]*(n+1) for _ in range(n+1)]
    bell[0][0] = 1
    for i in range(1, n+1):
        bell[i][0] = bell[i-1][i-1]
        for j in range(1, i+1):
            bell[i][j] = bell[i-1][j-1] + bell[i][j-1]
    return bell[n][0]
```

---

## 🔵 3. 스털링 수 (Stirling Numbers of the Second Kind)

### ✅ 정의

**n개의 서로 다른 원소를 정확히 k개의 집합으로 나누는 방법의 수**

> 즉, n개를 **k개의 비어있지 않은 부분집합**으로 분할하는 경우의 수

### 📌 표기

\[
S(n, k)
\]

---

### 📌 점화식

\[
S(n, k) = k \cdot S(n-1, k) + S(n-1, k-1)
\]

- 첫 항: 기존 집합에 새 원소 추가  
- 두 번째 항: 새 집합을 생성하여 추가

---

### 🧪 예제

- \( S(3,2) = 3 \)
  - { {a}, {b,c} }, { {b}, {a,c} }, { {c}, {a,b} }

---

### 💡 구현 (DP)

```python
def stirling(n, k):
    dp = [[0]*(k+1) for _ in range(n+1)]
    dp[0][0] = 1
    for i in range(1, n+1):
        for j in range(1, k+1):
            dp[i][j] = j * dp[i-1][j] + dp[i-1][j-1]
    return dp[n][k]
```

---

## 🧠 관계 정리

| 수열 | 의미 | 표기 | 주요 수식 |
|------|------|------|-----------|
| 카탈란 수 | 올바른 구조, 괄호, 트리 등 | \( C_n \) | \( C_n = \frac{1}{n+1} \binom{2n}{n} \) |
| 벨 수 | 집합 분할의 총 개수 | \( B_n \) | \( B_{n+1} = \sum \binom{n}{k} B_k \) |
| 스털링 수 (2종) | n개를 k개 집합으로 분할 | \( S(n, k) \) | \( S(n, k) = kS(n-1, k) + S(n-1, k-1) \) |
