---
layout: post
title: 형식언어와 오토마타 - 선형 한정 오토마타
date: 2025-08-05 15:20:23 +0900
category: 형식언어와 오토마타
---
# 선형 한정 오토마타(Linear Bounded Automaton, **LBA**)

> **핵심 요지**
>
> - LBA는 **입력 길이에 선형으로 한정된(= \(O(n)\))** 작업 공간만 쓰는 **튜링 기계**다.
> - **비결정적 LBA(NLBA)** 가 인식하는 언어 = **문맥 인식 언어(CSL)** = \(\mathrm{NSPACE}(n)\).
> - **DLBA = NLBA ?** 는 미해결(일명 **LBA 문제**). 단, \(\mathrm{NSPACE}(n)\subseteq \mathrm{DSPACE}(n^2)\) (Savitch).
> - CSL은 \(\cup,\cap,\cdot,\star,\) 역순, **보수**(Immerman–Szelepcsényi) 등에 닫힘.
> - LBA **멤버십**(소속성) 문제는 **\(\mathbf{NSPACE}(n)\)-완전**.
> - 공백성/보편성/포함/동치 등 **전역 성질**은 대체로 **결정 불가능**.

---

## 표기와 관례

- 입력 알파벳 \(\Sigma\), 테이프 알파벳 \(\Gamma\) (\(\Sigma\subseteq \Gamma\), 공백 \(\sqcup\in\Gamma\)).
- 좌/우 경계 기호 \(\vdash, \dashv\) (읽기 전용).
- 이동 집합은 \(\{L,R,S\}\)로 두되, \(S\)(정지 이동)를 제거해도 **표현력 불변**(상수배 시간 오버헤드로 모사 가능).
- 다중 테이프/다중 트랙/양·일방 무한 테이프 등 **합리적 변형**은 계산 가능성 차원에서 **동등**.

---

## LBA의 **형식적 정의**와 구성 수 상계

### 정의(표준 단일 테이프 버전)

길이 \(n\)의 입력 \(w\)가 주어지면,

- 테이프 구간 \([\vdash, \dashv]\)의 **유효 길이**가 \(n + k\) (경계 등 상수 포함)이며,
- 계산 내내 **헤드가 이 구간 밖으로 나갈 수 없다**.

튜링 기계로 쓰면:
\[
M=(Q,\Sigma,\Gamma,\delta,q_0,F),\quad
\delta: Q\times\Gamma \to 2^{Q\times\Gamma\times\{L,R,S\}}
\]
- **DLBA**: \(\delta\)가 함수(0/1개의 전이).
- **NLBA**: \(\delta\)가 유한 집합(여러 전이).

> **다중 테이프 LBA**: 모든 테이프에서 **총 사용 칸 수**가 \(O(n)\)이면 같은 모델로 본다.

### 구성(configuration) 수

- 가능한 헤드 위치 수: \(\le c n\) (상수 \(c\)는 기계에 고정)
- 가능한 테이프 내용: \(|\Gamma|^{c n}\)
- 가능한 상태 수: \(|Q|\)

따라서 **구성 수**는
\[
N(n)\;=\;|Q|\cdot(cn)\cdot|\Gamma|^{cn}\;=\;\exp(\Theta(n))
\]
로 **유한**. 동일 구성을 다시 만나면 **루프**(펌핑)로 본다.
이 관찰은 **멤버십 결정의 상한**(유한 그래프 탐색)과 **보수 닫힘**(coNSPACE=NSPACE) 논증에 쓰인다.

---

## 표현력: **NLBA = CSL = \(\mathrm{NSPACE}(n)\)**

\[
\boxed{
\textbf{CSL} \;=\; \textbf{NLBA 인식 언어} \;=\; \mathrm{NSPACE}(n)
}
\]

### CSG(문맥 인식 문법)의 요지

- 규칙은 **비축약(noncontracting)**: \(\alpha\to\beta\)에서 \(|\alpha|\le|\beta|\) (단, \(S\to\varepsilon\)은 특별 허용).
- **Kuroda 정규형**으로 변환 가능:
\[
AB\to CD,\quad A\to BC,\quad A\to B,\quad A\to a
\]
(\(A,B,C,D\in V,\ a\in\Sigma\))

### **CSG ⇒ LBA** (유도 모사 스케치)

- 비축약 유도이므로, 모든 **중간 문장형의 길이** \(\le c\cdot |w|\).
- LBA는 테이프에 현재 문장형을 저장하고 **국소 패턴**(길이 1–2)만 검사·치환해 한 단계 유도.
- 테이프 길이는 선형이므로 LBA 제약 내 동작.

### **LBA ⇒ CSG** (전이 재작성)

- LBA의 **구성(configuration)** 을 문자열로 코딩(좌내용·상태·읽는기호·우내용).
- 한 스텝 전이를 **문맥 규칙**으로 기술(좌·우 문맥이 맞을 때만 치환).
- 시작 구성 \(\Rightarrow^*\) 수용 구성의 유도를 “생성”으로 바꾸면 입력 언어를 얻는다.

### 결정성과의 관계(**LBA 문제**)

\[
\text{DLBA 언어} \stackrel{?}{=} \text{NLBA 언어} \quad\Longleftrightarrow\quad \mathrm{DSPACE}(n)\stackrel{?}{=}\mathrm{NSPACE}(n)
\]

- **미해결**. 단, Savitch 정리로
  \[
  \mathrm{NSPACE}(n)\subseteq\mathrm{DSPACE}(n^2)
  \]
  즉, 비결정적 선형 공간은 결정적 **제곱 공간**으로 모사 가능.

---

## **닫힘(폐포)** 성질

CSL(=NLBA 언어)은 다음에 **닫힘**:

- 합 \(\cup\), 교 \(\cap\), 연접 \(\cdot\), Kleene★, **역순** \(L^R\)
- **보수(Complement)** — **Immerman–Szelepcsényi**: \(s(n)\ge\log n\)이면 \(\mathrm{NSPACE}(s)=\mathrm{coNSPACE}(s)\)
  ⇒ \(\mathrm{NSPACE}(n)=\mathrm{coNSPACE}(n)\)
- **역호모모르피즘** \(h^{-1}(L)\)
- **비소거(λ-자유) 호모모르피즘/치환** (소거 허용 호모모르피즘은 일반적으론 닫힘 아님)

> **비교**: CFL은 보수에 닫히지 않지만 CSL은 닫힌다 — 로그 이상 비결정 공간의 구조적 성질 덕분.

---

## **결정/복잡도** 성질

- **멤버십(소속성)**: “주어진 LBA \(M\), 문자열 \(w\)”에 대해 \(w\in L(M)\)인가?
  - **\(\mathbf{NSPACE}(n)\)-완전** (구성 그래프 도달성)
  - Savitch로 \(\in\mathrm{DSPACE}(n^2)\subseteq\mathrm{PSPACE}\)
- **공백성** \(L(M)=\varnothing?\), **보편성** \(L(M)=\Sigma^*?\), **포함성/동치성**:
  - 일반적으로 **결정 불가능** (PCP/정지문제 감소)
- **보수 멤버십** \(w\notin L(M)?\): 보수 닫힘 덕분에 동일 난이도 범주에서 취급 가능

---

## **예시 언어**와 LBA **설계 패턴**

### 대표 CSL(비CFL) 언어

1) \(L_{abc}=\{\,a^n b^n c^n \mid n\ge0\,\}\)
2) \(L_{ww}=\{\,ww \mid w\in\{0,1\}^*\,\}\)
3) \(L_{\#=3}=\{\,w\in\{a,b,c\}^* \mid \#a(w)=\#b(w)=\#c(w)\,\}\)
4) \(L_{4}=\{\,a^n b^n c^n d^n \mid n\ge0\,\}\)

### 마킹 + 교대 스윕(**a^n b^n c^n**)

> **아이디어**: “왼쪽에서 오른쪽으로” **가장 왼쪽 미사용 \(a\)** 하나를 마킹(Ā) → 그 뒤 **미사용 \(b,c\)** 를 각각 1개씩 마킹(\(\bar b,\bar c\)) → 다시 왼쪽으로 돌아가 반복.

```
LBA_abc(w):
  # 형식 검사
  ensure w ∈ a* b* c* ; else REJECT
  go to left end

  loop:
    # 1. a 하나 소비
    if exists unmarked 'a': mark it as Ā; move right
    else: goto VERIFY_NONE

    # 2. b 하나 소비
    move right to first unmarked 'b'; if none: REJECT
    mark it as b̄; move right

    # 3. c 하나 소비
    move right to first unmarked 'c'; if none: REJECT
    mark it as c̄

    # 4. 되돌아가 다음 a를 찾음
    move left to leftmost unmarked 'a'; repeat

  VERIFY_NONE:
    if any unmarked 'b' or 'c' remains: REJECT else ACCEPT
```

- 공간: 입력 위 **마킹만** 사용 ⇒ \(O(n)\).
- 시간: 스윕 반복으로 \(O(n^2)\) 수준 허용.

### 복제 검사(**ww**)

> 길이가 홀수면 즉시 거절. 중앙 경계 \(m\)을 **비결정적으로 “추측”** 후, 좌/우 절반을 1:1로 매칭 확인.

```
LBA_ww(x):
  n := |x| ; if n odd: REJECT
  nondet choose m := n/2 ; # 사실상 유일
  repeat m times:
    pick leftmost unmarked bit σ in [0..m-1]; mark it
    pick leftmost unmarked bit τ in [m..n-1]; mark it
    if σ ≠ τ: REJECT
  ACCEPT
```

- 동일성 검증은 **마킹 + 평행 스윕**으로 선형 공간 내 수행.

### 세 문자 수 동등(**\#a=\#b=\#c**)

> 순차 스윕으로 **a 하나당 b, c 각각 하나**를 소거(마킹). 남거나 모자라면 거절.

---

## **멤버십 판정** 알고리즘(그래프 도달성 관점)

### 개념: 유한 구성 그래프

입력 \(w\)에 대해 **구성 그래프** \(G_w=(V,E)\) 를 생각하자.

- \(V\): 가능한 모든 구성(유한)
- \((u,v)\in E\): 한 스텝 전이로 \(u\to v\)

문제는 **start \(\to\) accept**에 **경로 존재?** 로 환원.

### Savitch 방식(결정적 제곱공간) 의사코드

```
# Path(u,v,ℓ): 길이 ≤ 2^ℓ인 경로 존재 여부

Path(u, v, ℓ):
  if ℓ == 0:
    return (u == v) or (u→v in one step)
  for each configuration m:
    if Path(u, m, ℓ-1) and Path(m, v, ℓ-1): return True
  return False

Decide_LBA(M, w):
  D := ⌈log2(diameter of configuration graph on w)⌉
  return ∃ accept a : Path(start_config, a, D)
```

- 저장: “\((u,v,ℓ)\)”만 유지 ⇒ **\(O(n^2)\) 공간**.
- 시간: 지수 가능(허용).

---

## **CSG ↔ LBA** 변환 스케치(구현 감각)

### CSG ⇒ LBA (규칙 매칭 스캐너)

- 입력 \(w\)를 목표로, 테이프에 **현재 문장형**을 저장(\(|\cdot|\le c|w|\)).
- 매 단계, 위치 \(i\)를 돌며 **적용 가능한 규칙** \(\ell\to r\)을 찾고, 국소 치환.

```
SimulateCSG_ByLBA(G=(V,Σ,R,S), w):
  tape := S ; # 초기 문장형
  nondet:
    while |tape| ≤ c·|w|:
      if tape == w: ACCEPT
      choose (ℓ→r) in R and position i with ℓ at i:
        tape := replace ℓ by r at i
    REJECT # 길이 초과 또는 적용 불가로 막다른 길
```

- 비축약성 덕분에 길이 초과 없이 **선형 공간** 유지.

### LBA ⇒ CSG (전이 재작성 템플릿)

- 구성 문자열을 `…a q b…`처럼 인코딩(상태 \(q\)가 \(b\)를 읽음).
- 전이 \((q,b)\to(q',c,R)\)를 지역 규칙 뭉치로 쪼개 Kuroda형으로 표현:
  - 좌/우 주변 문맥을 확인하는 **보조 비단말** 삽입
  - 길이 보존/증가를 위해 **패딩** 비단말 사용
  - 수용 상태 도달 시 “장식 제거(호모모르피즘)”로 **순수 출력**만 남김

---

## **설계 패턴** 모음(실전 팁)

1) **표식/마킹(mark-and-sweep)**
   - “미사용/사용” 상태를 분명히 표기(Ā, \(\bar b\), \(\bar c\) 등).
   - 마킹은 **되돌아보기**를 단순화한다.

2) **교대 스윕(alternating sweep)**
   - 좌→우로 작업, 우→좌로 원점 복귀.
   - LBA는 공간이 빡빡하므로 “**한 번에 조금**” 처리, 여러 번 스윕한다.

3) **국소 윈도우 검사**
   - 길이 2–3의 패턴만 보면 되는 규칙으로 **분해**하라(Kuroda형).
   - 경계(\(\vdash,\dashv\)) 직전/직후의 예외 케이스를 **분리**.

4) **경계 안전성**
   - \(\vdash,\dashv\)에서의 L/R 이동이 **절대 넘지 않도록** 별도 전이 제공.

5) **결정기로 만들 때**
   - NLBA 설계를 먼저 한 뒤, Savitch 방식 **경로 분할**로 결정적 절차를 도출(공간 \(n^2\)).

---

## **자주 하는 질문(FAQ)**

- **Q. PDA(문맥자유)보다 강한가요?**
  **A.** 예. \(a^n b^n c^n\), \(ww\) 등 **스택 1개**로는 안 되는 **다중 동기화/복제**를 처리.

- **Q. 보수에 닫히는 이유는?**
  **A.** \(\mathrm{NSPACE}(n)=\mathrm{coNSPACE}(n)\) (Immerman–Szelepcsényi). 로그 이상 비결정 공간은 **보수 닫힘**.

- **Q. LBA 문제(DLBA=NLBA?)**
  **A.** 미해결. 현재는 \(\mathrm{DSPACE}(n)\subseteq\mathrm{NSPACE}(n)\subseteq\mathrm{DSPACE}(n^2)\) 만 알려짐.

- **Q. 공백성/보편성 같은 전역 속성은 왜 어렵나?**
  **A.** 입력 길이가 무한히 늘고, 각 길이마다 **지수 크기**의 구성 그래프가 바뀐다.
  전역 “모든 길이에 대해 ~인가?”는 PCP/정지문제류로 **감소**되어 **Undecidable**.

---

## 한 페이지 요약(암기 카드)

- **정의**: 입력 길이 \(n\)에 대해 \(O(n)\) 공간만 허용하는 튜링 기계.
- **표현력**: \(\boxed{\text{NLBA}=\text{CSL}=\mathrm{NSPACE}(n)}\).
- **닫힘**: \(\cup,\cap,\cdot,\star,\) 역순, 역호모, **보수**.
- **결정 성질**: 멤버십 **\(\mathbf{NSPACE}(n)\)-완전**, 전역 성질 다수 **Undecidable**.
- **복잡도 상한**: Savitch로 **\(\mathrm{DSPACE}(n^2)\)** 결정 가능.
- **열린 문제**: **DLBA ?= NLBA**.

---

## 연습 문제(스스로 손으로 해보기)

1) \(L=\{a^n b^{2n} c^n\}\)가 CSL임을 보이는 LBA를 설계하라.
   *힌트: a 1개당 b 2개를 마킹하고 c 1개를 매칭(마킹 기호를 두 종류로 나눔).*

2) **Kuroda 정규형**의 규칙만으로 \(a^n b^n c^n\)을 생성하는 CSG의 **유도 전략**을 개요하라.
   *힌트: 중앙 인덱스 전달용 보조 비단말을 도입하고, 좌/우 확장을 동시 진행.*

3) 임의 NLBA의 멤버십을 **구성 그래프 도달성**으로 바꾸는 과정을 의사코드로 써 보라(§6.2 참조).

---

## 부록: 경계·예외 상황 전이 매크로(스니펫)

> **목적**: \(S\)-이동 없는 표준 이동만으로 “제자리” 효과를 내거나, 경계에서 **안전 복귀**.

```
# Stay(q,a→q',b) 모사: R 후 L로 복귀

(q, a) -> (q_tmp, b, R)
(q_tmp, x) -> (q', x, L)        # x는 임의 기호

# 좌 경계 안전: L에서 ⊢를 만나면 한 칸 R로 복귀

(q, ⊢) -> (q, ⊢, R)

# 우 경계 안전: R에서 ⊣를 만나면 한 칸 L로 복귀

(q, ⊣) -> (q, ⊣, L)
```

- 위 같은 **미세 전이**는 모든 LBA 설계에 반복적으로 쓰인다.

---

### 마무리

LBA는 “**선형 공간**”이라는 물리적·이론적 제약 속에서 **문맥 의존 계산**을 구현하는 표준 모델이다.
CSG와의 **정밀한 동치**(Kuroda형), **보수 닫힘**(Immerman–Szelepcsényi), **결정적 제곱공간 모사**(Savitch)까지,
핵심 정리들이 서로 맞물려 **CSL = NLBA = \(\mathrm{NSPACE}(n)\)** 라는 강력한 풍경을 이룬다.
열린 문제(**DLBA=NLBA?**)는 여전히 남아 있지만, LBA는 형식언어 이론에서 “문맥 인식”의 **정확한 계산적 위상**을 제공한다.
