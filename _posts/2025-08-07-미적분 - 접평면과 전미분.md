---
layout: post
title: 미적분 - 접평면과 전미분
date: 2025-08-07 21:20:23 +0900
category: 미적분
---
# 접평면과 전미분

## 1. “전미분”과 “접평면”의 핵심 요약

### 1.1 전미분 = 최선의 선형 근사(Best Linear Approximation)

함수 \(f:\mathbb{R}^n\to\mathbb{R}^m\)가 \(\mathbf{a}\in\mathbb{R}^n\)에서 미분가능(프레셰 미분가능)이라면, 유일한 선형사상 \(D f(\mathbf{a}):\mathbb{R}^n\to\mathbb{R}^m\)가 존재하여
$$
f(\mathbf{a}+\mathbf{h}) \;=\; f(\mathbf{a}) \;+\; D f(\mathbf{a})[\mathbf{h}] \;+\; o(\|\mathbf{h}\|)\quad(\mathbf{h}\to\mathbf{0}).
$$
여기서 \(D f(\mathbf{a})\)를 **전미분(총미분)**이라 하고, \(L(\mathbf{h})=D f(\mathbf{a})[\mathbf{h}]\)가 국소적으로 \(f\)를 가장 잘 근사하는 선형사상이다.

- **스칼라장** \(f:\mathbb{R}^n\to\mathbb{R}\)의 경우, \(D f(\mathbf{a})\)는 **행벡터** \(\nabla f(\mathbf{a})^\top\)에 해당하고
  $$D f(\mathbf{a})[\mathbf{h}] = \nabla f(\mathbf{a})\cdot \mathbf{h}.$$

- **전미분의 행렬표현**(야코비안): \(J_f(\mathbf{a}) \in \mathbb{R}^{m\times n}\),
  $$D f(\mathbf{a})[\mathbf{h}] = J_f(\mathbf{a})\,\mathbf{h}.$$

### 1.2 접평면 = 그래프의 1차 테일러 평면

그래프형 \(z=f(x,y)\)가 \((x_0,y_0)\)에서 미분가능하면, 그래프 \(z=f(x,y)\)의 **접평면**은
$$
z \;=\; f(x_0,y_0) \;+\; f_x(x_0,y_0)\,(x-x_0) \;+\; f_y(x_0,y_0)\,(y-y_0).
$$
이는 \(f\)의 1차 테일러 다항식과 동일하며, 법선벡터는
$$
\mathbf{n} \;=\; \big(-f_x(x_0,y_0),\ -f_y(x_0,y_0),\ 1\big).
$$

---

## 2. 그래프형 \(z=f(x,y)\): 접평면과 전미분

### 2.1 전미분과 미분형식

스칼라장 \(f:\mathbb{R}^2\to\mathbb{R}\). 점 \((x_0,y_0)\)에서
$$
f(x_0+\Delta x,\, y_0+\Delta y)
= f(x_0,y_0) + f_x(x_0,y_0)\,\Delta x + f_y(x_0,y_0)\,\Delta y + o\!\left(\sqrt{(\Delta x)^2+(\Delta y)^2}\right).
$$
전미분(미분형식) 표기:
$$
dz \;=\; df \;=\; f_x\,dx + f_y\,dy.
$$
여기서 \(dx,dy\)는 독립변수의 미소변화이며, \(dz\)는 그에 따른 1차 근사 변화량이다.

### 2.2 접평면의 방정식

위 \(df\)를 그대로 쓰면
$$
z \approx f(x_0,y_0) + f_x(x_0,y_0)\,(x-x_0) + f_y(x_0,y_0)\,(y-y_0).
$$
이는 그래프 \(z=f(x,y)\)의 접평면 방정식이 된다.

### 2.3 기하학적 해석

- 접평면은 그래프에 **1차 접촉**하는 평면이며, 그래프의 **레벨셋** \(f(x,y)=\text{const}\)의 법선벡터와 일관된다.
- 접평면의 법선벡터 \(\mathbf{n}=(-f_x,-f_y,1)\)는 “그래프를 \(F(x,y,z)=f(x,y)-z=0\)”로 보았을 때 \(\nabla F=(-f_x,-f_y,1)\)와 일치한다.

### 2.4 예제 A — 다항·삼각 혼합

함수: \(f(x,y)=x^2\sin y + y^3\).
점 \((x_0,y_0)=(1,\pi/6)\).

편도함수:
$$
f_x=2x\sin y,\qquad f_y=x^2\cos y+3y^2.
$$
대입:
- \(f(1,\pi/6)=1\cdot \tfrac12 + (\tfrac{\pi}{6})^3 = \tfrac12 + \tfrac{\pi^3}{216}\).
- \(f_x(1,\pi/6)=2\cdot 1\cdot \tfrac12 = 1\).
- \(f_y(1,\pi/6)=1^2\cdot \cos(\pi/6) + 3(\pi/6)^2 = \tfrac{\sqrt{3}}{2} + \tfrac{\pi^2}{12}\).

접평면:
$$
z = \left(\tfrac12 + \tfrac{\pi^3}{216}\right) + 1\cdot(x-1) + \left(\tfrac{\sqrt{3}}{2} + \tfrac{\pi^2}{12}\right)(y-\tfrac{\pi}{6}).
$$

---

## 3. 암시형 \(F(x,y,z)=0\): 접평면과 정리

### 3.1 암시함수로서의 접평면

표면 \(\Sigma:\ F(x,y,z)=0\)에서, \(\nabla F\neq \mathbf{0}\)인 점 \((x_0,y_0,z_0)\)에 대해 법선벡터는
$$
\mathbf{n} = \nabla F(x_0,y_0,z_0) = \big(F_x, F_y, F_z\big)\big|_{(x_0,y_0,z_0)}.
$$
접평면 방정식:
$$
F_x(x_0,y_0,z_0)\,(x-x_0)
+ F_y(x_0,y_0,z_0)\,(y-y_0)
+ F_z(x_0,y_0,z_0)\,(z-z_0) = 0.
$$

### 3.2 그래프형과의 연결

그래프형 \(z=f(x,y)\)를 \(F(x,y,z)=f(x,y)-z\)로 두면
$$
\nabla F=(-f_x,\,-f_y,\,1),
$$
동일한 접평면을 재현한다.

### 3.3 예제 B — 타원체

타원체
$$
F(x,y,z)=\frac{x^2}{a^2}+\frac{y^2}{b^2}+\frac{z^2}{c^2}-1=0.
$$
법선:
$$
\nabla F=\left(\frac{2x}{a^2},\ \frac{2y}{b^2},\ \frac{2z}{c^2}\right).
$$
점 \((x_0,y_0,z_0)\)에서 접평면:
$$
\frac{2x_0}{a^2}(x-x_0)+\frac{2y_0}{b^2}(y-y_0)+\frac{2z_0}{c^2}(z-z_0)=0,
$$
또는 정리하여
$$
\frac{x_0 x}{a^2}+\frac{y_0 y}{b^2}+\frac{z_0 z}{c^2}=1.
$$

---

## 4. 매개표현형 \(\mathbf{r}(u,v)\): 접평면과 전미분

### 4.1 접평면

매개표면 \(\mathbf{r}(u,v)=(x(u,v),y(u,v),z(u,v))\).
점 \((u_0,v_0)\)에서 접공간은 두 접벡터
$$
\mathbf{r}_u(u_0,v_0),\qquad \mathbf{r}_v(u_0,v_0),
$$
가 생성하는 평면이며 법선은
$$
\mathbf{n}(u_0,v_0)=\mathbf{r}_u(u_0,v_0)\times \mathbf{r}_v(u_0,v_0).
$$
접평면 방정식:
$$
\mathbf{n}\cdot\left(\mathbf{X}-\mathbf{r}(u_0,v_0)\right)=0.
$$

### 4.2 전미분(야코비안)으로 보는 관점

지도 \(\Phi:(u,v)\mapsto \mathbf{r}(u,v)\)의 전미분 \(D\Phi(u_0,v_0)\)은 \(2\times 3\) 야코비안이고,
$$
D\Phi(u_0,v_0)[\Delta u,\Delta v]
= \Delta u\,\mathbf{r}_u(u_0,v_0) + \Delta v\,\mathbf{r}_v(u_0,v_0).
$$
즉 매개좌표의 미소변화가 3D 공간에서의 접평면 위 미소변위로 선형 사상된다.

### 4.3 예제 C — 원형 패치

\(\mathbf{r}(u,v)=(u\cos v,\ u\sin v,\ g(u))\) (회전체의 생성곡선 \(z=g(u)\)).
\(\mathbf{r}_u=(\cos v,\ \sin v,\ g'(u))\), \(\mathbf{r}_v=(-u\sin v,\ u\cos v,\ 0)\).
법선:
$$
\mathbf{n}=\mathbf{r}_u\times\mathbf{r}_v
=\big(-u g'(u)\cos v,\ -u g'(u)\sin v,\ u\big).
$$
점 \((u_0,v_0)\)에서 접평면은 위 공식을 대입하여 즉시 얻는다.

---

## 5. 전미분과 연쇄법칙(총합성)

### 5.1 벡터–행렬 표기

합성 \(f(\mathbf{x})=g(\mathbf{u}(\mathbf{x}))\)에서
$$
D f(\mathbf{a}) = D g(\mathbf{u}(\mathbf{a})) \circ D \mathbf{u}(\mathbf{a}),\qquad
J_{f}(\mathbf{a}) = J_{g}(\mathbf{u}(\mathbf{a}))\,J_{\mathbf{u}}(\mathbf{a}).
$$
스칼라장 \(g:\mathbb{R}^m\to\mathbb{R}\)이면
$$
\nabla_{\mathbf{x}} f(\mathbf{a}) = J_{\mathbf{u}}(\mathbf{a})^\top\, \nabla_{\mathbf{u}} g(\mathbf{u}(\mathbf{a})).
$$

### 5.2 방향도함수와 일관성

모든 \(\mathbf{v}\)에 대해
$$
D_{\mathbf{v}} f(\mathbf{a}) \;=\; \nabla f(\mathbf{a})\cdot \mathbf{v} \;=\; \nabla_{\mathbf{u}} g\big|_{\mathbf{u}(\mathbf{a})}\cdot\big(J_{\mathbf{u}}(\mathbf{a})\,\mathbf{v}\big),
$$
즉 “입력 방향 \(\mathbf{v}\)”를 **야코비안으로 중간공간 방향**으로 보낸 뒤, 그 공간에서의 그래디언트와 내적.

---

## 6. 전미분의 존재와 연속성, 반례

- 전미분 가능이면(=프레셰 미분가능) 모든 방향도함수 \(D_{\mathbf{v}} f\)가 존재하며 **선형형식** \(\nabla f\cdot\mathbf{v}\)로 주어진다.
- 반대로 모든 방향도함수가 존재해도 전미분 가능함이 **보장되지 않는다** (고전적 반례):
  $$
  f(x,y)=\begin{cases}
  \dfrac{x^2 y}{x^2+y^2}, & (x,y)\neq(0,0)\\[6pt]
  0, & (0,0)
  \end{cases}
  $$
  원점에서 \(D_{\mathbf{v}} f\)는 존재하지만 \(\mathbf{v}\mapsto D_{\mathbf{v}} f\)가 선형이 아니므로 전미분 불가.

- **충분조건**(실용적): \(\partial f/\partial x_i\)가 근방에서 연속이면 전미분 가능.

---

## 7. 오차 전파와 선형화(응용)

### 7.1 오차 전파(불확실성 전파)

측정값 \((x,y)\)에 불확실성 \((\sigma_x,\sigma_y)\)가 있고 \(z=f(x,y)\)라면, 1차 근사에서
$$
\mathrm{Var}(z)\approx f_x^2 \,\sigma_x^2 + f_y^2 \,\sigma_y^2 + 2 f_x f_y \,\mathrm{Cov}(x,y).
$$
독립이면 \(2\)항은 0. 이는 전미분 \(dz=f_x dx+f_y dy\)의 분산을 취한 것.

### 7.2 선형화 기반 뉴턴 방법(암시식 해석)

비선형 방정식 \(F(\mathbf{x})=\mathbf{0}\)에 대해
$$
\mathbf{x}_{k+1}=\mathbf{x}_k - J_F(\mathbf{x}_k)^{-1} F(\mathbf{x}_k),
$$
는 “전미분으로 선형화 → 선형방정식 해” 절차의 반복.

---

## 8. 종합 예제 세트

### 예제 1 — 그래프형 접평면 + 전미분

\(f(x,y)=e^{x y}\cos x\). \((x_0,y_0)=(0,1)\).

- \(f(0,1)=e^0 \cos 0 = 1\).
- \(f_x = e^{xy}(y\cos x-\sin x)\), \(f_x(0,1)=1\cdot(1\cdot 1-0)=1\).
- \(f_y = e^{xy}(x\cos x)\), \(f_y(0,1)=1\cdot(0\cdot 1)=0\).

접평면:
$$
z = 1 + 1\cdot(x-0) + 0\cdot(y-1) = 1 + x.
$$
전미분:
$$
dz = f_x\,dx + f_y\,dy = (y\cos x-\sin x)e^{xy}\,dx + (x\cos x)e^{xy}\,dy.
$$
점에서 \(dz=dx\).

### 예제 2 — 암시형 접평면

구 \(x^2+y^2+z^2=R^2\), \(F=x^2+y^2+z^2-R^2\).
점 \((x_0,y_0,z_0)\)에서 \(\nabla F=(2x_0,2y_0,2z_0)\).
접평면:
$$
2x_0(x-x_0)+2y_0(y-y_0)+2z_0(z-z_0)=0 \iff x_0 x+y_0 y+z_0 z = R^2.
$$

### 예제 3 — 매개표면 접평면

원통 \(\mathbf{r}(u,v)=(\cos u,\ \sin u,\ v)\).
\(\mathbf{r}_u=(-\sin u,\ \cos u,\ 0),\ \mathbf{r}_v=(0,0,1)\).
법선 \(\mathbf{n}=\mathbf{r}_u\times \mathbf{r}_v=(\cos u,\ \sin u,\ 0)\).
점 \((u_0,v_0)\)에서 접평면:
$$
\cos u_0 (x-\cos u_0)+\sin u_0 (y-\sin u_0)+0\cdot (z-v_0)=0.
$$
즉 \(x\cos u_0 + y\sin u_0 = 1\).

### 예제 4 — 오차전파

\(z=f(x,y)=\ln(1+x^2+y^2)\), \((x_0,y_0)=(1,2)\).
편도:
$$
f_x = \frac{2x}{1+x^2+y^2},\quad f_y=\frac{2y}{1+x^2+y^2}.
$$
값: \(1+x^2+y^2=1+1+4=6\).
\(f_x=2/6=1/3,\ f_y=4/6=2/3\).
독립 오차 \(\sigma_x=0.02,\ \sigma_y=0.05\)이면
$$
\sigma_z^2 \approx (1/3)^2(0.02)^2 + (2/3)^2(0.05)^2.
$$

---

## 9. SymPy로 상징적(접평면·전미분) 확인

```python
import sympy as sp

x, y = sp.symbols('x y', real=True)
f = sp.exp(x*y)*sp.cos(x)

fx = sp.diff(f, x)
fy = sp.diff(f, y)

x0, y0 = 0, 1
f0  = sp.simplify(f.subs({x:x0, y:y0}))
fx0 = sp.simplify(fx.subs({x:x0, y:y0}))
fy0 = sp.simplify(fy.subs({x:x0, y:y0}))

T = f0 + fx0*(x - x0) + fy0*(y - y0)  # tangent plane z = T(x,y) at (x0,y0)

print("f0 =", f0)
print("fx0, fy0 =", fx0, fy0)
print("Tangent plane z =", sp.simplify(T))

# 암시형 예: 타원체 접평면
a, b, c = sp.symbols('a b c', positive=True)
x0, y0, z0 = sp.symbols('x0 y0 z0', real=True)
F = x**2/a**2 + y**2/b**2 + (sp.Symbol('z')**2)/c**2 - 1  # 형식상 z는 심볼 새로 둠
z = sp.Symbol('z', real=True)

Fx = sp.diff(F, x)
Fy = sp.diff(F, y)
Fz = sp.diff(F, z)

plane = Fx.subs({x:x0, y:y0, z:z0})*(x-x0) + Fy.subs({x:x0, y:y0, z:z0})*(y-y0) + Fz.subs({x:x0, y:y0, z:z0})*(z-z0)
print("Implicit tangent plane =", sp.simplify(plane))
```

---

## 10. NumPy로 접평면 선형화 정확도(국소 오차) 실험

```python
import numpy as np

def f(x, y):
    return np.exp(x*y)*np.cos(x)

def grad_f(x, y):
    # fx = e^{xy}(y cos x - sin x)
    # fy = e^{xy}(x cos x)
    fx = np.exp(x*y)*(y*np.cos(x) - np.sin(x))
    fy = np.exp(x*y)*(x*np.cos(x))
    return np.array([fx, fy])

def tangent_plane(x0, y0, x, y):
    f0 = f(x0, y0)
    g  = grad_f(x0, y0)
    dx, dy = x - x0, y - y0
    return f0 + g[0]*dx + g[1]*dy

# 테스트: 무작위 작은 스텝에서의 상대오차
rng = np.random.default_rng(0)
x0, y0 = 0.0, 1.0
for h in [1e-1, 5e-2, 1e-2, 5e-3, 1e-3]:
    err = []
    for _ in range(1000):
        v = rng.normal(size=2)
        v = v/np.linalg.norm(v)
        x, y = x0 + h*v[0], y0 + h*v[1]
        approx = tangent_plane(x0, y0, x, y)
        true   = f(x, y)
        err.append(abs(true - approx))
    print(h, np.mean(err), np.max(err))
# 평균 오차/최대 오차가 h → 0 에 대해 1차로 줄어드는지 확인
```

---

## 11. 접평면과 전미분: 좌표변환·레벨셋·법선벡터의 통일성

- 그래프형 \(z=f(x,y)\): 접평면은 테일러 1차 선형화로 바로 나온다.
- 암시형 \(F=0\): 법선이 \(\nabla F\), 접평면은 \(\nabla F\cdot [(x-x_0),(y-y_0),(z-z_0)]=0\).
- 매개표면 \(\mathbf{r}(u,v)\): 접평면은 \(\mathbf{r}_u,\mathbf{r}_v\)로 생성되며 법선은 \(\mathbf{r}_u\times \mathbf{r}_v\).
- 이 셋은 서로 변환 가능하며 모두 “전미분(야코비안)” 관점으로 통일된다.

---

## 12. (심화) 암시함수정리와 전미분

### 12.1 암시함수정리(요지)

\(F(x,y,z)=0\), \((x_0,y_0,z_0)\)에서 \(F(x_0,y_0,z_0)=0\)이고 \(F_z(x_0,y_0,z_0)\neq 0\)이면, 근방에서 \(z=f(x,y)\)인 **유일한 매끄러운 함수**가 존재하고
$$
f_x = -\frac{F_x}{F_z},\qquad f_y = -\frac{F_y}{F_z}.
$$
접평면은 위 결과로 즉시 재현된다.

### 12.2 예 — 타원체에서의 \(z(x,y)\) 국소 표현

\(x^2/a^2 + y^2/b^2 + z^2/c^2 = 1\), \(z>0\) 근방에서
$$
z(x,y) = c\sqrt{1 - \frac{x^2}{a^2}-\frac{y^2}{b^2}},
$$
접평면은 \(f_x, f_y\)로부터 바로 얻을 수 있다.

---

## 13. (심화) 미분기하 관점: 접공간과 전미분

- \(\mathbb{R}^n\) 내 매끄러운 다양체 \(\mathcal{M}\)에서의 접공간 \(T_p\mathcal{M}\)은 매개곡선 \(\gamma\)의 속도벡터 \(\gamma'(0)\)들이 이루는 선형공간.
- 스칼라장 \(f:\mathcal{M}\to\mathbb{R}\)의 전미분 \(d f_p: T_p\mathcal{M}\to \mathbb{R}\)은
  $$
  d f_p(\mathbf{v})=\left.\frac{d}{dt}\right|_{t=0} f(\gamma(t))
  $$
  (여기서 \(\gamma(0)=p,\ \gamma'(0)=\mathbf{v}\)).
- \(\mathcal{M}=F^{-1}(0)\)에서는 \(T_p\mathcal{M}=\ker \nabla F(p)^\top\), 즉 \(\nabla F\)가 법선벡터.

---

## 14. 실전 체크리스트

- □ 그래프형인가 \(z=f(x,y)\) / 암시형인가 \(F(x,y,z)=0\) / 매개형인가 \(\mathbf{r}(u,v)\).
- □ 그래프형: \(f_x,f_y\) → 접평면 \(z=f_0+f_x\Delta x+f_y\Delta y\).
- □ 암시형: \(\nabla F\)가 법선 → \(\nabla F\cdot(\mathbf{X}-\mathbf{X}_0)=0\).
- □ 매개형: \(\mathbf{r}_u,\mathbf{r}_v\) → 법선 \(\mathbf{r}_u\times\mathbf{r}_v\).
- □ 전미분은 야코비안: \(D f(\mathbf{a})[\mathbf{h}]=J_f(\mathbf{a})\,\mathbf{h}\).
- □ 연속 편도함수(근방)가 있으면 전미분 가능.
- □ 오차전파/선형화/뉴턴법에 즉시 응용.
- □ 수치검증: 중심차분 vs 접평면 근사 오차의 \(O(h)\) 수렴 확인.

---

## 15. 연습문제(정답 스케치)

1) \(f(x,y)=\sin(xy)+x^3y\). \((x_0,y_0)=(1,0)\)에서 접평면.
   스케치: \(f(1,0)=0\), \(f_x=y\cos(xy)+3x^2 y\), \(f_y=x\cos(xy)+x^3\).
   값 대입 후 \(z=T(x,y)\) 구성.

2) \(F(x,y,z)=x^2+2y^2-3z=0\). \((1,1,1)\)에서 접평면.
   스케치: \(\nabla F=(2x,4y,-3)\Rightarrow (2,4,-3)\).
   접평면 \(2(x-1)+4(y-1)-3(z-1)=0\).

3) \(\mathbf{r}(u,v)=(u, v, u^2+v^2)\). \((u_0,v_0)=(1,2)\)에서 접평면.
   스케치: \(\mathbf{r}_u=(1,0,2u),(1,0,2)\), \(\mathbf{r}_v=(0,1,2v),(0,1,4)\).
   법선 \((1,0,2)\times(0,1,4)=(-2,-4,1)\).
   평면 \((-2,-4,1)\cdot(\mathbf{X}-\mathbf{r}(1,2))=0\).

4) 오차전파: \(z=\arctan(y/x)\), \((x,y)=(1,1)\), 독립오차 \(\sigma_x=\sigma_y=\sigma\).
   스케치: \(f_x=-y/(x^2+y^2)=-1/2\), \(f_y=x/(x^2+y^2)=1/2\).
   \(\sigma_z^2\approx (1/4+1/4)\sigma^2=\tfrac12\sigma^2\).

5) 연쇄법칙: \(g(u,v)=e^{u}\cos v\), \(\mathbf{u}(x,y)=(xy, x-y)\), \(f=g\circ \mathbf{u}\).
   \(\nabla_{\mathbf{u}} g=(e^{u}\cos v,\ -e^{u}\sin v)\), \(J_{\mathbf{u}}=\begin{bmatrix} y & x \\ 1 & -1\end{bmatrix}\).
   \(\nabla f=J_{\mathbf{u}}^\top \nabla_{\mathbf{u}} g\).

---

## 16. 한 페이지 요약

1) **전미분**: \(f(\mathbf{a}+\mathbf{h})=f(\mathbf{a})+J_f(\mathbf{a})\,\mathbf{h}+o(\|\mathbf{h}\|)\).
2) **접평면(그래프형)**: \(z=f_0+f_x\Delta x+f_y\Delta y\). 법선 \((-f_x,-f_y,1)\).
3) **접평면(암시형)**: \(\nabla F\cdot(\mathbf{X}-\mathbf{X}_0)=0\).
4) **접평면(매개형)**: \(\mathbf{n}=\mathbf{r}_u\times\mathbf{r}_v\).
5) **연쇄법칙**: \(J_{g\circ u}=J_g(u)\,J_u\), \(\nabla (g\circ u)=J_u^\top \nabla g\).
6) **응용**: 오차전파, 뉴턴법, 지역 선형화.

---

## 17. 부록: 간단한 “접평면 근사” 시각 검증(샘플코드)

```python
# 필요 시 matplotlib 설치
import numpy as np

def f(x, y):
    return np.exp(x*y)*np.cos(x)

def grad_f(x, y):
    fx = np.exp(x*y)*(y*np.cos(x) - np.sin(x))
    fy = np.exp(x*y)*(x*np.cos(x))
    return np.array([fx, fy])

def tangent_plane_value(x0, y0, X, Y):
    f0 = f(x0, y0)
    fx0, fy0 = grad_f(x0, y0)
    return f0 + fx0*(X - x0) + fy0*(Y - y0)

# 샘플 그리드 평가(수치 확인)
x0, y0 = 0.0, 1.0
xs = np.linspace(-0.2, 0.2, 51) + x0
ys = np.linspace(-0.2, 0.2, 51) + y0
X, Y = np.meshgrid(xs, ys)
Z_true = f(X, Y)
Z_tan  = tangent_plane_value(x0, y0, X, Y)
err = np.abs(Z_true - Z_tan)
print("mean abs err:", err.mean(), "max abs err:", err.max())
# 수치만 확인. 실제 3D 시각화는 mpl_toolkits.mplot3d로 가능.
```

---

이상으로 **접평면**과 **전미분**을 그래프형·암시형·매개형 전 범위에서 통일적으로 다루었다.
핵심은 “**전미분 = 최선의 선형 근사**”, “**접평면 = 1차 테일러 평면**”, “**법선 = 그래디언트**”, 그리고 “**연쇄법칙 = 야코비안의 곱**”이다.
이를 정확히 이해하면, 접평면 계산·오차 전파·뉴턴법·좌표변환·표면 기하 등 거의 모든 다변수 미적분/최적화 과제가 한 줄로 정리된다.
