---
layout: post
title: 미적분 - 정적분 계산법
date: 2025-08-07 16:20:23 +0900
category: 미적분
---
# 정적분 계산법 (Techniques of Definite Integration)

> 한 줄 요약: **정적분**은 “누적 변화/면적”을 구하는 도구이며, 기본은 **부정적분 → 구간 대입**, 그 외 **치환**, **부분적분**, **절댓값/대칭성**, **삼각치환/유리함수 분해**, **부정형(=부정합) 정적분의 수렴 판정**, **수치적분** 등을 상황에 맞게 사용한다.

---

## 0. 준비: 정적분의 의미와 기본 성질

- **정의(FTC2)**  
  \[
  \int_a^b f(x)\,dx = F(b)-F(a)\quad\text{(단, }F'(x)=f(x)\text{)}
  \]
- **부호와 방향**
  \[
  \int_a^b f = -\int_b^a f,\qquad \int_a^a f = 0
  \]
- **선형성**  
  \(\displaystyle \int_a^b(\alpha f+\beta g)=\alpha\int_a^b f+\beta\int_a^b g\)
- **구간 가산성**  
  \(\displaystyle \int_a^b f=\int_a^c f+\int_c^b f\)
- **비교/부등식**  
  \(m\le f(x)\le M\Rightarrow m(b-a)\le\int_a^b f\le M(b-a)\)

---

## 1. 기본: 부정적분 → 구간 대입

### 예제 1
\[
\int_1^3 x^2\,dx=\left[\frac{x^3}{3}\right]_1^3=\frac{27}{3}-\frac{1}{3}=\boxed{\frac{26}{3}}
\]

### 체크포인트
- 원시함수 찾기 쉬운가?
- 경계값 대입 시 **로그/삼각함수의 정의역** 주의.
- 로그는 \(\ln|\,\cdot\,|\)로 **절댓값** 잊지 않기.

---

## 2. 치환적분 (Change of Variables)

> 복합함수 \(f(g(x))g'(x)\) 꼴을 **변수 치환**으로 단순화.

### 정리
\[
\int_a^b f(g(x))\,g'(x)\,dx=\int_{g(a)}^{g(b)} f(u)\,du\quad(u=g(x))
\]
- \(g\)가 구간에서 **단사/연속(단조)**이면 안전.
- \(g\)가 감소라면 하한·상한이 바뀌므로 **부호** 유의.

### 예제 2
\[
\int_0^2 x\sqrt{x^2+1}\,dx
\]
치환 \(u=x^2+1\Rightarrow du=2x\,dx\Rightarrow x\,dx=\frac{1}{2}du\),  
경계: \(x=0\to u=1,\ x=2\to u=5\)
\[
=\frac12\int_1^5 \sqrt{u}\,du=\frac12\left[\frac{2}{3}u^{3/2}\right]_1^5
=\boxed{\frac{1}{3}\big(5^{3/2}-1\big)}
\]

### 팁
- **삼각치환**: \(\sqrt{a^2-x^2},\,\sqrt{x^2\pm a^2}\)에서 유용(§5).
- **역치환** 시 **원래 변수로 돌아가지 말고** 경계를 바꾸는 습관!

---

## 3. 부분적분 (Integration by Parts)

> 곱의 미분 공식의 역:
\[
\int u\,dv=\big[uv\big]_a^b-\int v\,du
\]

### LIATE 규칙(권장 선택 순서)
**L**og → **I**nverse trig → **A**lgebraic → **T**rig → **E**xponential

### 예제 3
\[
\int_0^1 x e^x\,dx
= \big[ x e^x\big]_0^1 - \int_0^1 e^x\,dx
= (e-0) - (e-1)=\boxed{1}
\]

### 예제 4 (로그)
\[
\int_1^e \ln x\,dx
= \big[x\ln x\big]_1^e-\int_1^e 1\,dx
= (e\cdot1-0)-(e-1)=\boxed{1}
\]

---

## 4. 절댓값/부호 변하는 함수

> \(|f(x)|\)는 **부호 변곡점**에서 구간 분할.

### 예제 5
\[
\int_{-2}^2 |x|\,dx=\int_{-2}^0(-x)\,dx+\int_0^2 x\,dx
=2+2=\boxed{4}
\]

### 절차
1) 근/부호 전환점 찾기 → 구간 분할  
2) 각 구간에서 절댓값 제거 후 적분  
3) 합산

---

## 5. 삼각치환(대표 루트형)

| 형태 | 치환 | 결과 적분 |
|---|---|---|
| \(\sqrt{a^2-x^2}\) | \(x=a\sin\theta\) | \(\int \cdots d\theta\) |
| \(\sqrt{a^2+x^2}\) | \(x=a\tan\theta\) | \(\int \cdots d\theta\) |
| \(\sqrt{x^2-a^2}\) | \(x=a\sec\theta\) | \(\int \cdots d\theta\) |

### 예제 6 (호의 길이/원 넓이 관련)
\[
\int_0^1 \frac{dx}{\sqrt{1-x^2}}=\left[\arcsin x\right]_0^1=\boxed{\frac{\pi}{2}}
\]

### 예제 7 (사분원 면적)
\[
\int_0^1 \sqrt{1-x^2}\,dx=\frac{\pi}{4}
\]
(삼각치환 또는 도형적 의미로 즉시 도출)

---

## 6. 유리함수(분수) 정적분: 부분분수 분해

> \(\displaystyle \int \frac{P(x)}{Q(x)}dx\), \(\deg P<\deg Q\) 이고 \(Q\) 인수분해 가능할 때 **부분분수**.

### 예제 8
\[
\int_0^1 \frac{dx}{x^2+3x+2}
=\int_0^1\left(\frac{1}{x+1}-\frac{1}{x+2}\right)dx
\]
\[
=\big[\ln(x+1)-\ln(x+2)\big]_0^1
=\ln\frac{4}{3}\quad\Rightarrow\ \boxed{\ln\!\frac{4}{3}}
\]

---

## 7. 대칭성/주기성/트릭

### 7.1 짝·홀 함수
- \(f\) 짝수 \(\Rightarrow \int_{-a}^{a} f=2\int_0^a f\)
- \(f\) 홀수 \(\Rightarrow \int_{-a}^{a} f=0\)

### 7.2 \(x\mapsto a-x\) 트릭
\[
\int_0^{a} f(x)\,dx=\int_0^{a} f(a-x)\,dx
\]
- 합쳐서 단순화, 특히 로그/삼각 혼합형에서 유용.

### 7.3 주기성
주기 \(T\) 함수 \(f(x+T)=f(x)\)이면
\(\displaystyle \int_{c}^{c+kT} f = k\int_0^T f\).

### 예제 9
\[
\int_{-\pi}^{\pi} x^3\,dx=0\quad(\text{홀수})
\]
\[
\int_{-\pi}^{\pi} \cos^2 x\,dx
=2\int_0^{\pi} \frac{1+\cos 2x}{2}\,dx=\pi
\]

---

## 8. 평균값/평균정리/평균값으로 보기

- **함수의 평균값**  
  \(\displaystyle f_{\text{avg}}=\frac{1}{b-a}\int_a^b f(x)\,dx\)
- **적분에 대한 평균값정리**  
  연속 \(f\Rightarrow \exists c\in[a,b]:\int_a^b f(x)\,dx=f(c)(b-a)\)

### 예제 10
속도 \(v(t)=3t^2\) (m/s), \(t\in[0,2]\) 이동거리:
\[
S=\int_0^2 3t^2\,dt=\left[t^3\right]_0^2=\boxed{8\text{ m}}
\]
평균속도 \(=S/(2-0)=4\)m/s.

---

## 9. 부정합(=부정형, Improper) 정적분

> 경계가 무한대이거나, 적분구간 내부 특이점이 있을 때 **극한 정의**로 평가.

### 9.1 무한 구간
\[
\int_1^\infty \frac{dx}{x^p}
=\lim_{b\to\infty}\left[\frac{x^{1-p}}{1-p}\right]_1^b
=\begin{cases}
\frac{1}{p-1},& p>1\ (\text{수렴})\\
\infty,& p\le 1\ (\text{발산})
\end{cases}
\]

### 9.2 내부 특이점
\[
\int_0^1 \frac{dx}{\sqrt{x}}=\lim_{\varepsilon\to 0^+}\int_{\varepsilon}^1 x^{-1/2}\,dx=2
\quad(\text{수렴})
\]

### 9.3 비교판정
- \(0\le f\le g\), \(\int g\) 수렴 ⇒ \(\int f\) 수렴.
- \(f\ge g\ge 0\), \(\int g\) 발산 ⇒ \(\int f\) 발산.

---

## 10. 매개변수 포함 적분(Leibniz/Feynman 트릭)

> **경계 고정**: \(\displaystyle I(\alpha)=\int_a^b f(x,\alpha)\,dx\)  
미분-적분 교환 가능 시
\[
I'(\alpha)=\int_a^b \frac{\partial f}{\partial \alpha}(x,\alpha)\,dx
\]

### 예제 11
\[
I(a)=\int_0^1 x^a\,dx=\frac{1}{a+1}\quad(a>-1)
\]
미분하면
\[
I'(a)=\int_0^1 x^a\ln x\,dx=-\frac{1}{(a+1)^2}
\]
→ \(\displaystyle \int_0^1 x^a\ln x\,dx\) 값을 **한 줄로** 얻음.

### 가변 경계(Leibniz 규칙)
\[
\frac{d}{dx}\int_{\alpha(x)}^{\beta(x)} f(t)\,dt
=f(\beta(x))\beta'(x)-f(\alpha(x))\alpha'(x)
\]

---

## 11. 수치적분(빠른 점검/검증)

- **사다리꼴법**: 간단, \(O(h^2)\) 정확도.  
- **심슨법**: 짝수 분할, \(O(h^4)\) 정확도.

```python
# Python: 간단한 수치적분 템플릿
import numpy as np

def trap(f, a, b, n=1000):
    x = np.linspace(a, b, n+1)
    y = f(x)
    h = (b-a)/n
    return h*(0.5*y[0] + y[1:-1].sum() + 0.5*y[-1])

def simpson(f, a, b, n=1000):
    if n % 2: n += 1  # n은 짝수
    x = np.linspace(a, b, n+1)
    y = f(x)
    h = (b-a)/n
    return (h/3)*(y[0] + 4*y[1:-1:2].sum() + 2*y[2:-2:2].sum() + y[-1])

# 예: ∫_0^1 sqrt(1 - x^2) dx = π/4
f = lambda x: np.sqrt(1 - x**2)
print(trap(f, 0, 1, 100000))
print(simpson(f, 0, 1, 1000))
```

> **Tip**: 특이점 근처(예: \(x^{-1/2}\))는 균등분할보다 치환(예: \(x=t^2\)) 후 적분이 훨씬 안정적.

---

## 12. 실전 “도구 선택” 가이드 (체크리스트)

1) **원시함수 쉬움?** → 바로 FTC2.  
2) **합성/곱 구조?** → 치환(§2) / 부분적분(§3).  
3) **절댓값/부호 변화?** → 구간 분할(§4).  
4) **루트형 \(\sqrt{a^2\pm x^2}\)** → 삼각치환(§5).  
5) **유리함수** → 부분분수(§6).  
6) **대칭/주기** → 절반·0·배수로 단축(§7).  
7) **무한/특이점** → 부정합 정의·비교판정(§9).  
8) **매개변수** → 적분 기호 하 미분(§10).  
9) **복잡** → 수치적분으로 검증(§11).

---

## 13. 종합 예제 모음 (풀이 요점 포함)

### 예제 A (대칭성)
\[
\int_{-2}^{2} x^2\,dx = 2\int_0^{2} x^2\,dx
=2\cdot\left[\frac{x^3}{3}\right]_0^2=\boxed{\frac{16}{3}}
\]

### 예제 B (치환)
\[
\int_{0}^{\pi/3} \tan x \sec^2 x\,dx
\quad(u=\tan x,\ du=\sec^2 x\,dx)
\Rightarrow \left[\frac{u^2}{2}\right]_0^{\sqrt{3}}
=\boxed{\frac{3}{2}}
\]

### 예제 C (부분적분 + 경계)
\[
\int_0^1 x\ln(1+x)\,dx
\]
- \(u=\ln(1+x),\ dv=x\,dx\Rightarrow du=\frac{dx}{1+x}, v=\frac{x^2}{2}\)
\[
=\left[\frac{x^2}{2}\ln(1+x)\right]_0^1-\int_0^1 \frac{x^2}{2(1+x)}\,dx
\]
\(\frac{x^2}{1+x}=x-1+\frac{1}{1+x}\) 분해 → 적분하여
\[
\boxed{\frac{1}{2}\ln 2 - \frac{1}{4}}
\]

### 예제 D (삼각치환)
\[
\int_0^1 \frac{dx}{\sqrt{1-x^2}}=\arcsin x\Big|_0^1=\boxed{\frac{\pi}{2}}
\]

### 예제 E (부분분수)
\[
\int_0^1 \frac{dx}{(x+1)(x+2)}=\ln\frac{4}{3}\ (\text{§6})
\]

### 예제 F (부정합)
\[
\int_1^\infty \frac{dx}{x^{3/2}}=\left[\frac{-2}{\sqrt{x}}\right]_1^\infty=\boxed{2}
\]

### 예제 G (가변 파라미터—Feynman)
\[
I(a)=\int_0^1 x^a\,dx=\frac{1}{a+1},\quad
I'(a)=\int_0^1 x^a\ln x\,dx=-\frac{1}{(a+1)^2}
\]

---

## 14. 흔한 실수/주의점

- 치환 후 **구간(경계)**까지 반드시 바꾸기.  
- 로그 적분에서 \(\ln|\,\cdot\,|\) 절댓값 누락.  
- 부정합 적분을 **극한 정의** 없이 “형식적”으로 계산.  
- 부분적분에서 **경계항** \(uv\big|_a^b\) 잊기.  
- 대칭성 적용 시 함수의 **짝/홀** 검증 누락.  
- 수치적분에서 특이점/급격변화 구간의 **세분할** 부족.

---

## 15. 파이썬 실습 예시 (상징/수치 검증)

```python
# SymPy로 기호적 정적분 + 수치대조
import sympy as sp
x = sp.symbols('x', positive=True)

I1 = sp.integrate(x**2, (x, 1, 3))        # 26/3
I2 = sp.integrate(x*sp.sqrt(x**2+1), (x, 0, 2))
I3 = sp.integrate(x*sp.exp(x), (x, 0, 1)) # 1
I4 = sp.integrate(sp.Abs(x), (x, -2, 2))  # 4
I5 = sp.integrate(1/(x**2+3*x+2), (x, 0, 1))  # log(4/3)

print(I1, I2, I3, I4, I5.simplify())
```

---

## 16. 요약 표

| 도구 | 핵심 공식/조건 | 대표 예 |
|---|---|---|
| FTC2 | \(\int_a^b f=F(b)-F(a)\) | \(\int_1^3 x^2\) |
| 치환 | \(u=g(x)\), 경계 \(g(a),g(b)\) | \(\int x\sqrt{x^2+1}\) |
| 부분적분 | \(\int u\,dv=[uv]-\int v\,du\) | \(\int x e^x\) |
| 절댓값 | 부호 변화점 분할 | \(\int|x|\) |
| 대칭성 | 짝/홀/주기/트릭 | \(\int_{-a}^{a}\) |
| 삼각치환 | \(\sqrt{a^2\pm x^2}\) | \(\int \frac{dx}{\sqrt{1-x^2}}\) |
| 부분분수 | 유리함수 분해 | \(\int \frac{1}{(x+1)(x+2)}\) |
| 부정합 | 극한/비교판정 | \(\int_1^\infty \frac{1}{x^p}\) |
| 매개변수 | 적분기호 하 미분 | \(\int_0^1 x^a\) |
| 수치법 | Trap/Simpson | 검증/근사 |

---

## 17. 연습 문제 (정답 스케치)

1) \(\displaystyle \int_0^1 \frac{2x}{x^2+1}\,dx\) → \(\ln(x^2+1)\big|_0^1=\boxed{\ln 2}\)  
2) \(\displaystyle \int_0^{\pi/2} \sin^2 x\,dx=\boxed{\pi/4}\) (반각/대칭)  
3) \(\displaystyle \int_0^1 x\,\ln(1+x)\,dx=\boxed{\frac{1}{2}\ln 2-\frac{1}{4}}\) (§3 예제 C)  
4) \(\displaystyle \int_0^\infty e^{-x}\,dx=\boxed{1}\) (부정합)  
5) \(\displaystyle \int_{-1}^1 \frac{dx}{1+x^2}=\boxed{\pi/2}\) (짝성은 아님, FTC로 직접)

---

### 마무리
- **문제 구조를 먼저 진단**하고, 위의 도구들 중 하나로 **형태를 바꾸는 것**이 핵심.  
- 계산이 장황할수록 **치환·대칭 트릭**을 한 번 더 의심!  
- 결과는 **수치적분**으로 빠르게 검증하면 실수 방지에 큰 도움.