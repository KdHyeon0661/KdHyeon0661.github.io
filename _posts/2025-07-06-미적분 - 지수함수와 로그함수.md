---
layout: post
title: 미적분 - 지수함수와 로그함수
date: 2025-07-06 22:20:23 +0900
category: 미적분
---
# 지수함수와 로그함수

## 표기와 전제

- 밑이 \(a>0,\ a\ne 1\)인 지수/로그를 기본으로 하며, 자연로그는 \(\ln x = \log_e x\)로 표기한다.
- 미분/적분은 실변수 해석 범위에서 다룬다(복소 확장은 10장에서 간단히 언급).
- 수치 코드는 Python 표준 라이브러리만 사용하며, 실무 안정성을 위해 `log1p`, `expm1`, LogSumExp 등을 소개한다.

---

## 지수함수 \(a^x\)

### 정의와 기본 성질

밑 \(a>0,\ a\ne 1\)에 대해
$$
f(x)=a^x.
$$
- **정의역**: \((-\infty,\infty)\), **치역**: \((0,\infty)\).
- **단조성**: \(a>1\Rightarrow\) 증가, \(0<a<1\Rightarrow\) 감소.
- **지수 법칙**
$$
a^{x+y}=a^x a^y,\qquad a^{xy}=(a^x)^y,\qquad a^{-x}=\frac{1}{a^x}.
$$
- **자연지수 표현**: \(a^x=e^{x\ln a}\). 모든 지수함수는 궁극적으로 \(e^x\)와 \(\ln a\)로 환원된다.

### 그래프와 변환(로그-직선화)

- \(f(0)=1\). \(x\to -\infty\)에서 \(y=0\)으로 접근(수평 점근선).
- 파라미터 변환
$$
y=c\,a^{b(x-d)}\quad\Longrightarrow\quad \ln y=\ln c + b(x-d)\ln a.
$$
즉 로그를 취하면 **직선**이 되어, 회귀/모형 추정에서 선호된다(지수 성장/감쇠의 선형화).

### 미분·적분·합성

$$
\frac{d}{dx}a^x=a^x\ln a,\qquad
\int a^x\,dx=\frac{a^x}{\ln a}+C\quad(a>0,\ a\ne 1).
$$
합성 \(a^{g(x)}\)에 대해
$$
\frac{d}{dx}\,a^{g(x)}=a^{g(x)}\ln a\cdot g'(x),\qquad
\int a^{g(x)}g'(x)\,dx=\frac{a^{g(x)}}{\ln a}+C.
$$

### 볼록성(Convexity)과 접선 불등식

- \(e^x\)는 전구간 볼록: \(f''(x)=e^x>0\).
- 접선 불등식(접선이 그래프 아래를 깐다)
$$
e^x \ge 1 + x\quad(\forall x\in\mathbb R).
$$
- 일반화: \(a^x=e^{x\ln a}\)도 볼록이다.

---

## 로그함수 \(\log_a x\)

### 정의와 성질(역함수)

역함수 관계
$$
y=\log_a x \quad\Longleftrightarrow\quad a^y=x\qquad(a>0,\ a\ne 1).
$$
- **정의역**: \((0,\infty)\), **치역**: \((-\infty,\infty)\).
- **단조성**: \(a>1\Rightarrow\) 증가, \(0<a<1\Rightarrow\) 감소.
- **로그 법칙**
$$
\log_a(xy)=\log_a x+\log_a y,\quad
\log_a\!\left(\frac{x}{y}\right)=\log_a x-\log_a y,\quad
\log_a(x^r)=r\log_a x.
$$
- **밑변환**
$$
\log_a x=\frac{\log_b x}{\log_b a}=\frac{\ln x}{\ln a}.
$$

### 미분·적분·오목성

$$
\frac{d}{dx}\log_a x=\frac{1}{x\ln a},\qquad
\int \log_a x\,dx=\frac{x\ln x-x}{\ln a}+C.
$$
자연로그 \(\ln x\)는 전구간 **오목**: \(f''(x)=-1/x^2<0\)
접선 불등식
$$
\ln x\le x-1\quad(x>0),\ \text{등호는 }x=1.
$$

---

## 역함수 대칭과 미분(다시보기)

- \(y=a^x\)와 \(x=\log_a y\)는 직선 \(y=x\)에 대해 대칭이다.
- 역함수 미분 공식으로 재확인
$$
\frac{d}{dx}\log_a x=\frac{1}{a^{\log_a x}\ln a}=\frac{1}{x\ln a}.
$$

---

## 극한·급수 전개·근사

### 테일러 전개

- 지수
$$
e^x=\sum_{n=0}^{\infty}\frac{x^n}{n!}\quad(\text{전 구간 수렴}).
$$
- 로그(맥로린)
$$
\ln(1+x)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{x^n}{n},\qquad -1<x\le 1.
$$
표준 극한
$$
\lim_{x\to 0}\frac{e^x-1}{x}=1,\qquad
\lim_{x\to 0}\frac{\ln(1+x)}{x}=1.
$$
임의의 \(a>0\)에서
$$
a^x=e^{x\ln a}=1+x\ln a+\frac{(x\ln a)^2}{2!}+\cdots.
$$

### 대표 불등식(볼록/오목에서 체계적으로)

- \(e^x\ge 1+x\) (볼록 → 접선 위로 올라감).
- \(\ln(1+x)\le x\) (\(x>-1\), 오목).
- \(\ln x\le x-1\) (\(x>0\), 오목, 등호 \(x=1\)).
- \(|x|<1\)에서 \(e^x\le \frac{1}{1-x}\)는 \(\sum x^n\) 상계로 해석 가능(조심: 유도 맥락 필수).

### 급수 근사 코드(정밀도 제어)

```python
# 급수 근사

def exp_series(x, eps=1e-12, nmax=2000):
    term = 1.0
    s = 1.0
    for n in range(1, nmax+1):
        term *= x/n
        s_new = s + term
        if abs(s_new - s) < eps:
            return s_new
        s = s_new
    return s

def log1p_series(x, eps=1e-12, nmax=200000):  # -1 < x <= 1 권장
    # 교대급수. x가 0에 가까울수록 빠르게 수렴한다.
    if not (-1.0 < x <= 1.0):
        raise ValueError("series valid roughly for -1 < x <= 1.")
    s, term, n, sign = 0.0, x, 1, 1.0
    while n <= nmax:
        s_new = s + sign * abs(x)**n / n
        if abs(s_new - s) < eps:
            return s_new
        s = s_new
        sign *= -1.0
        n += 1
    return s
```

---

## 미분·적분 확장 예제

### 미분

1) \(f(x)=5^x\Rightarrow f'(x)=5^x\ln 5\).
2) \(g(x)=\log_2 x\Rightarrow g'(x)=\dfrac{1}{x\ln 2}\).
3) \(h(x)=e^{2x^3}\Rightarrow h'(x)=e^{2x^3}\cdot 6x^2\).
4) \(p(x)=a^{\sin x}\Rightarrow p'(x)=a^{\sin x}\ln a\cdot \cos x\).

### 적분

1) \(\displaystyle \int 10^x\,dx=\frac{10^x}{\ln 10}+C\).
2) \(\displaystyle \int \ln(3x^2+1)\,dx\)
부분적분 \(u=\ln(3x^2+1),\ dv=dx\)로
$$
x\ln(3x^2+1)-\int \frac{6x^2}{3x^2+1}\,dx
= x\ln(3x^2+1)-2x+\frac{2}{\sqrt{3}}\arctan(\sqrt{3}\,x)+C.
$$
3) \(\displaystyle \int x e^{2x}\,dx=\frac{x}{2}e^{2x}-\frac{1}{4}e^{2x}+C\) (부분적분).

---

## 방정식 풀이(지수/로그/혼합)

### 기본형

- \(2^x=7\Rightarrow x=\dfrac{\ln 7}{\ln 2}\).
- \(\log_3(2x-1)=4\Rightarrow 2x-1=3^4\Rightarrow x=41\) (정의역 \(2x-1>0\)).

### 혼합형과 Lambert \(W\)

- \(e^x=x\)의 해는 \(x=-W(-1)\approx 0.567143\).
- 일반형 \(x e^x=c\Rightarrow x=W(c)\) (수치해 필요).

### 뉴턴법 코드(일반 근 찾기)

```python
# e^x = x 의 근을 뉴턴법으로 근사

import math

def newton(f, df, x0, iters=30, tol=1e-14):
    x = x0
    for _ in range(iters):
        fx = f(x)
        dfx = df(x)
        if dfx == 0:
            break
        x_new = x - fx/dfx
        if abs(x_new - x) < tol:
            return x_new
        x = x_new
    return x

f  = lambda x: math.exp(x) - x
df = lambda x: math.exp(x) - 1
root = newton(f, df, 0.5)
print(root)  # ≈ 0.567143
```

---

## 불등식/정보이론/최적화와의 연결

### Jensen(로그 오목성)

\(\ln\)은 오목이므로(확률 가중 \(\theta\in(0,1)\))
$$
\ln(\theta x+(1-\theta)y)\ \ge\ \theta\ln x+(1-\theta)\ln y,\quad x,y>0.
$$
양변 지수화로 **가중 AM–GM**
$$
\theta x + (1-\theta)y \ \ge\ x^{\theta}y^{1-\theta}.
$$

### 엔트로피/크로스 엔트로피

확률벡터 \(p\)에 대해
$$
H(p)=-\sum_i p_i\ln p_i,\qquad
H(p,q)=-\sum_i p_i\ln q_i.
$$
KL 발산 \(D_{\mathrm{KL}}(p\|q)=\sum_i p_i\ln\frac{p_i}{q_i}\ge 0\)는 Jensen으로 증명 가능(로그 오목/에피그래프).

### 로짓/로지스틱

$$
\operatorname{logit}(p)=\ln\frac{p}{1-p},\qquad
\sigma(z)=\frac{1}{1+e^{-z}},\qquad
p=\sigma(\text{logit}(p)).
$$
로지스틱 회귀의 음의 로그우도는 볼록(이항 경우), 최적화에서 지수/로그의 미분이 핵심 역할.

---

## 수치안정과 실무 팁(핵심)

### Log-Sum-Exp 안정화

큰 \(z_i\)가 섞인 합 \(S=\sum_i e^{z_i}\)는 overflow 위험.
최댓값 \(m=\max_i z_i\)로 이동:
$$
\log \sum_i e^{z_i} = m + \log \sum_i e^{z_i - m}.
$$

```python
import math

def logsumexp(zs):
    m = max(zs)
    s = sum(math.exp(z - m) for z in zs)
    return m + math.log(s)

def softmax(zs):
    lse = logsumexp(zs)
    return [math.exp(z - lse) for z in zs]

z = [1200.0, 1190.0, 1210.0]
lse = logsumexp(z)
p = softmax(z)
print(lse, p, sum(p))  # 확률합 ≈ 1 (안정적)
```

### `log1p` / `expm1`

- \(\ln(1+x)\)는 \(x\)가 매우 작을 때 `math.log1p(x)`가 안전.
- \(e^x-1\)는 `math.expm1(x)`가 안전.

```python
import math
x = 1e-12
print(math.log1p(x), math.log(1+x))   # 전자가 훨씬 정확
print(math.expm1(x), math.e**x - 1)   # 전자가 훨씬 정확
```

### 확률의 로그-도메인 계산

로그 확률의 합/차를 직접 다루면 underflow가 줄어든다. HMM/CRF/Naive Bayes 등에서 표준 기법.

---

## 응용 스냅샷

### 연속 복리

$$
A(t)=P e^{rt},\quad r=\ln(1+R)\ \ (\text{연 }R\% \text{ 이산복리와 등가}).
$$

### 반감기·배가시간

감쇠 \(y(t)=y_0 e^{-kt}\Rightarrow T_{1/2}=\dfrac{\ln 2}{k}\).
성장 \(y(t)=y_0 e^{kt}\Rightarrow T_2=\dfrac{\ln 2}{k}\).

### 신호/음향/화학

- pH: \( \mathrm{pH}=-\log_{10}[H^+] \).
- 데시벨: \( \mathrm{dB}=10\log_{10}\frac{P}{P_0} \) (전력비), \(20\log_{10}(\cdot)\) (진폭비).
- 엔트로피: \(H(p)=-\sum_i p_i\ln p_i\).

### 선형 ODE와 지수

1차 선형 미분방정식 \(y'+ky=0\)의 해는 \(y=y_0 e^{-kt}\) (분리/적분인자 기법).
지수함수의 미분-자기동형성이 해 구조를 만든다.

---

## 한 걸음 더: 복소수에서의 지수/로그(개요)

오일러 공식
$$
e^{ix}=\cos x + i\sin x.
$$
복소 로그는 다가함수: \(\Log z = \ln|z| + i\Arg z\) (주값 \(\Arg z\in(-\pi,\pi]\)).
실무 계산은 실수 영역에 국한하지만, 신호처리/푸리에 분석에서 \(e^{i\omega t}\)가 핵심 언어가 된다.

---

## 실전 도구(보강): 지수/로그 방정식, 안정 Softmax

```python
import math

def solve_ax_equals_b(a, b):
    # a^x = b  (a>0, a!=1, b>0)
    if a <= 0 or a == 1 or b <= 0:
        raise ValueError("조건: a>0, a!=1, b>0")
    return math.log(b) / math.log(a)

def solve_log_a_x_equals_c(a, c):
    # log_a x = c  -> x = a^c (a>0, a!=1)
    if a <= 0 or a == 1:
        raise ValueError("조건: a>0, a!=1")
    return a**c

def log_softmax(zs):
    m = max(zs)
    lse = m + math.log(sum(math.exp(z - m) for z in zs))
    return [z - lse for z in zs]

# 예시

print(solve_ax_equals_b(2, 7))     # ≈ ln 7 / ln 2
print(solve_log_a_x_equals_c(3, 4))# = 81
ls = log_softmax([10, 11, 9])
print([math.exp(v) for v in ls], sum(math.exp(v) for v in ls))  # 안정적 확률
```

---

## 체크리스트(실수 방지)

- 로그 정의역: \(\log_a x\)는 반드시 \(x>0\).
- 밑 명시: \(\ln\)은 밑 \(e\); 공학에서는 \(\log_{10}\)도 흔함.
- 연 \(R\%\)와 연속률 \(r\): 일반적으로 \(r\ne R/100\), \(r=\ln(1+R)\).
- 체인룰 누락 금지: \(a^{g(x)}\), \(\ln(g(x))\) 미분 시 \(g'(x)\) 곱.
- 극한 근처 수치 불안정: `log1p`, `expm1`, LogSumExp 사용.
- 불등식 방향 상기: \(e^x\) 볼록 ⇒ \(e^x\ge 1+x\); \(\ln x\) 오목 ⇒ \(\ln x\le x-1\).

---

## 추가 연습문제(해설 스케치 포함)

1) \(f(x)=7^{3x-1}\)의 도함수와 \(x=0\)에서 접선 방정식.
   해설: \(f'(x)=7^{3x-1}\ln 7\cdot 3\), \(f(0)=1/7\), \(f'(0)=3\ln 7/7\).
   접선 \(y=\dfrac{1}{7}+\dfrac{3\ln 7}{7}x\).

2) \(\displaystyle \int \log_{10}(2x)\,dx\).
   해설: \(\log_{10}(2x)=\dfrac{\ln(2x)}{\ln 10}\). 결과 \(\dfrac{x\ln(2x)-x}{\ln 10}+C\).

3) \(\displaystyle \lim_{x\to 0}\frac{a^x-1}{x}\).
   해설: \(a^x=e^{x\ln a}\Rightarrow \ln a\).

4) \(\log_3(x-1)+\log_3(x+4)=2\)의 해.
   해설: \((x-1)(x+4)=9\Rightarrow x^2+3x-13=0\). 정의역 \(x>1\)로 \(\displaystyle x=\frac{-3+\sqrt{61}}{2}\).

5) \(\displaystyle \int \frac{1}{x\ln x}\,dx\) (\(x>1\)).
   해설: \(u=\ln x\Rightarrow \ln(\ln x)+C\).

6) \(e^{ax}=bx\) (\(a,b>0\))의 해 존재성과 근사.
   해설: \(ax - \ln b = \ln x\) 형태로 변형하거나 \(x e^{-ax}=1/b\Rightarrow -ax\,e^{-ax}=-a/b\Rightarrow x=-\frac{1}{a}W\!\left(-\frac{a}{b}\right)\).

7) 로그-합-지수 안정성: \(\log\sum_{i=1}^n e^{z_i}\)를 overflow 없이 계산하는 함수를 직접 작성하라(테스트 포함).
   해설: 8.1의 `logsumexp` 구조를 구현·검증.

8) \(\ln x\le x-1\)를 접선 불등식이나 Jensen로 증명하라.
   해설: \(f(x)=\ln x\) 오목, \(x=1\)에서 접선 \(y=x-1\)이 그래프 위쪽.

9) \(a>1\)에서 \(a^x\)의 그래프와 모든 접선이 만드는 아래 영역의 성질을 설명하라(볼록 분석 관점).
   해설: 접선들의 상울(conjugate)로 지지 초평면 해석, Young 불등식과 연결.

10) \(\displaystyle \sum_{k=1}^n \ln\left(1+\frac{x}{k}\right)\)의 \(n\to\infty\) 극한을 감각적으로 해석하라(적분근사, 감마함수와의 연결 단서).
    해설: \(\ln\Gamma\) 근사와 연결(스털링), 로그 합 → 적분.

---

## 요약

- 지수 \(a^x\)와 로그 \(\log_a x\)는 역함수 관계로, 미분/적분/극한/급수/불등식의 표준 레퍼런스를 제공한다.
- 볼록/오목( \(e^x\) 볼록, \(\ln x\) 오목 )은 접선 불등식, AM–GM, Jensen, 엔트로피/최적화 등 광범위한 결과를 조직적으로 설명한다.
- 수치 실무는 **LogSumExp**, **`log1p`**, **`expm1`**로 안정성을 확보하는 것이 핵심이다.
- 응용은 금융(복리), 물리(감쇠), 통신/음향(데시벨), 정보이론(엔트로피), 통계학/ML(로지스틱/우도)까지 직결된다.

---

## 부록 A. 자주 쓰는 정체성(한줄 레퍼런스)

- 밑변환: \(\log_a x=\dfrac{\ln x}{\ln a}\).
- 미분: \((a^x)'=a^x\ln a\), \((\log_a x)'=\dfrac{1}{x\ln a}\).
- 접선 불등식: \(e^x\ge 1+x\), \(\ln x\le x-1\).
- 급수: \(e^x=\sum_{n\ge0}\dfrac{x^n}{n!}\), \(\ln(1+x)=\sum_{n\ge1}(-1)^{n+1}\dfrac{x^n}{n}\).
- 표준 극한: \(\lim_{x\to 0}\dfrac{e^x-1}{x}=1\), \(\lim_{x\to 0}\dfrac{\ln(1+x)}{x}=1\).
- Lambert \(W\): \(x e^x=c \Leftrightarrow x=W(c)\).

---

## 부록 B. 실전 미니 유틸 모음

```python
import math

def exp_safe(x):
    # 매우 작은 x에서 expm1로 개선
    if abs(x) < 1e-6:
        return math.expm1(x) + 1.0
    return math.exp(x)

def ln1p_safe(x):
    if x <= -1:
        raise ValueError("ln(1+x)는 x>-1에서 정의")
    return math.log1p(x)

def logistic(z):
    # 오버/언더플로 방지형 시그모이드
    if z >= 0:
        ez = math.exp(-z)
        return 1.0 / (1.0 + ez)
    else:
        ez = math.exp(z)
        return ez / (1.0 + ez)

def odds_to_logit(p):
    if not (0.0 < p < 1.0):
        raise ValueError("p in (0,1)")
    return math.log(p/(1.0-p))
```
