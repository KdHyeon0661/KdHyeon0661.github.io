---
layout: post
title: HTML - 엔티티
date: 2025-02-23 19:20:23 +0900
category: HTML
---
# HTML 엔티티(Entity)

## 1. 엔티티란?

- **HTML 예약 문자**( `<`, `>`, `&`, `"`, `'` 등 )나 **특수 기호/유니코드 문자**를 **문자 그대로 출력**하기 위한 표기.
- 브라우저가 태그나 구문으로 해석하지 않도록 **이스케이프(escape)** 하는 방법.

### 잘못된 예
```html
<p>5 < 10</p> <!-- "<"가 태그로 오해될 수 있음 -->
```

### 올바른 예
```html
<p>5 &lt; 10</p>
```

---

## 2. 엔티티 표기법 — 이름 vs 숫자

- **이름(named) 엔티티**: 사람이 읽기 쉬움  
  예: `&lt;`, `&gt;`, `&amp;`, `&quot;`, `&apos;`, `&copy;`
- **숫자(numeric) 엔티티**: 유니코드 코드포인트로 표현  
  - 10진수: `&#60;`
  - 16진수: `&#x3C;`

> **규칙**: 항상 `&`로 시작하고 `;`로 끝냅니다. 누락 시 잘못 파싱될 수 있습니다.

---

## 3. 자주 쓰는 엔티티 표 (확장)

| 문자 | 이름 | 10진수 | 16진수 | 설명 |
|---|---|---:|---:|---|
| `<` | `&lt;` | `&#60;` | `&#x3C;` | less-than |
| `>` | `&gt;` | `&#62;` | `&#x3E;` | greater-than |
| `&` | `&amp;` | `&#38;` | `&#x26;` | ampersand |
| `"` | `&quot;` | `&#34;` | `&#x22;` | 큰따옴표 |
| `'` | `&apos;` | `&#39;` | `&#x27;` | 작은따옴표 (HTML5에서 유효) |
| `©` | `&copy;` | `&#169;` | `&#xA9;` | 저작권 |
| `®` | `&reg;` | `&#174;` | `&#xAE;` | 등록상표 |
| `€` | `&euro;` | `&#8364;` | `&#x20AC;` | 유로 |
| `→` | `&rarr;` | `&#8594;` | `&#x2192;` | 오른쪽 화살표 |
| `—` | `&mdash;` | `&#8212;` | `&#x2014;` | 긴 대시(emdash) |
| `–` | `&ndash;` | `&#8211;` | `&#x2013;` | 짧은 대시(endash) |
| ` ` | `&nbsp;` | `&#160;` | `&#xA0;` | 줄바꿈 없는 공백 (non-breaking space) |
| ` ` | *(숫자 권장)* | `&#8239;` | `&#x202F;` | **좁은 NBSP**(narrow no-break space) |
| ` ` | `&thinsp;` | `&#8201;` | `&#x2009;` | 얇은 공백(thin space) |
| `​` | `&ZeroWidthSpace;` | `&#8203;` | `&#x200B;` | 제로폭 공백 |
| `­` | `&shy;` | `&#173;` | `&#xAD;` | 소프트 하이픈(줄바꿈 힌트) |

> 일부 덜 알려진 공백/하이픈 류는 **브라우저/폰트/언어 설정에 따라 표시/줄바꿈 동작이 달라질 수 있으므로** 테스트가 필요합니다.  
> Named 엔티티가 없는 문자는 **숫자 엔티티(10진/16진)** 를 사용하세요.

---

## 4. 유니코드 문자 엔티티

모든 유니코드 문자는 숫자 엔티티로 표현할 수 있습니다.

```html
&#x1F600;  <!-- 😀 (16진수) -->
&#128512;  <!-- 😀 (10진수) -->
```

- `&#x...;` : 16진수
- `&#...;` : 10진수  
두 표기는 **동일 문자**를 산출합니다.

---

## 5. 언제 엔티티가 필요한가? (문맥별 가이드)

| 상황 | 이유 | 예시 |
|---|---|---|
| 텍스트 노드에 `<`, `>`, `&` 포함 | 태그/엔티티로 오해 방지 | `&lt;`, `&gt;`, `&amp;` |
| HTML **속성 값**에 `"`, `'`, `&` 포함 | 속성 경계 파괴 방지 | `title="Tom &amp; Jerry"` |
| 여러 칸 공백/줄바꿈 제어 | HTML 공백 규칙 무시 | `&nbsp;`, `&thinsp;`, `&shy;` |
| 특수 기호/통화/화살표/수학기호 | 환경 간 일관 표현 | `&euro;`, `&rarr;`, `&#215;` |
| 코드/마크업을 **문자**로 보여주기 | 구문 혼동 방지 | `<pre>&lt;div&gt;...&lt;/div&gt;</pre>` |

---

## 6. 문맥별 **안전 이스케이프** 레시피

### 6.1 텍스트 노드
```html
<p>1 &lt; 2 &amp;&amp; 3 &gt; 1</p>
```

### 6.2 속성 값(따옴표 구분)
```html
<!-- 큰따옴표 속성값 내부에서 "는 &quot; 권장 -->
<a title="He said &quot;Hello&quot;">링크</a>

<!-- 작은따옴표 속성값 내부에서 '는 &apos; 또는 &#39; -->
<a title='It&apos;s OK'>링크</a>

<!-- &는 항상 &amp; -->
<img alt="A&B" src="/logo.svg?brand=A&amp;sub=B">
```

### 6.3 URL과 **HTML 엔티티의 차이**
- **URL 인코딩**: `%20`, `%2F` 처럼 **퍼센트 인코딩**(서버로 전송될 바이트를 안전화)
- **HTML 엔티티**: HTML 소스의 **문자 표기** 문제 해결

```html
<!-- HTML 내 링크의 쿼리 &는 &amp;로 -->
<a href="/search?q=red&amp;sort=asc">검색</a>
```

> 링크 클릭 시 실제 요청 URL에는 `&`가 전달됩니다. **HTML에서만** `&amp;`로 표기하는 것.

### 6.4 `<script>`/`<style>` 내부
- **JS 문자열**에 HTML 엔티티가 자동 변환되지는 않습니다(런타임에 해석 X).
- JS에서 DOM에 삽입할 땐 **`textContent`** 를 기본으로:

```html
<div id="out"></div>
<script>
  const userInput = '<img src=x onerror=alert(1)>';
  // 안전: 태그로 해석되지 않음
  document.getElementById('out').textContent = userInput;
  // 위험(필요할 때만, 신뢰된 소스에만):
  // document.getElementById('out').innerHTML = userInput;
</script>
```

- **`</script>`** 문자열이 스크립트 블록을 조기 종료할 수 있으므로 JSON 임베드 시 주의:

```html
<script type="application/json" id="cfg">
{ "html": "</scr" + "ipt>" } <!-- 혹은 \<\/script> 같이 분리 -->
</script>
```

### 6.5 템플릿 엔진(자동 이스케이프)
- 대부분의 서버/프런트 템플릿은 기본적으로 **텍스트 컨텍스트에서 자동 이스케이프** 합니다.
- 단, **`| safe`**, `raw`, `v-html`, `dangerouslySetInnerHTML` 등 **안전 우회 옵션** 사용 시 XSS 위험.  
  → **가능하면 사용 금지**, 꼭 필요하면 **신뢰된 데이터만** 처리.

---

## 7. 공백·하이픈·줄바꿈 제어 (실전)

### 7.1 고정 공백(줄바꿈 방지)
```html
가격: 12&nbsp;345&nbsp;원
```

### 7.2 얇은 공백/좁은 NBSP(타이포그래피 미세 조정)
```html
<!-- 얇은 공백 -->
x&thinsp;10  <!-- x 10 -->

<!-- 좁은 NBSP: 통화/단위 묶음에 유용 -->
10&#8239;kg   <!-- 10 kg (줄바꿈 금지) -->
```

### 7.3 소프트 하이픈(권장 줄바꿈 위치 힌트)
```html
su&shy;per&shy;califragilis&shy;ticex&shy;pialidocious
```

### 7.4 코드/프리텍스트는 `<pre><code>`
```html
<pre><code>&lt;section class="hero"&gt;Hello&lt;/section&gt;</code></pre>
```

---

## 8. 엔티티 **케이스/세미콜론** 규칙과 함정

- **Named 엔티티는 대소문자 구분**합니다. `&LT;`와 `&lt;`는 다릅니다(대개 `&lt;`만 유효).
- **세미콜론(;) 필수**: 특정 구문에서 생략하면 **다른 이름으로 파싱**되어 오동작/경고가 날 수 있습니다.
- **이중 이스케이프** 주의: `&amp;lt;` → 실제 화면에 `&lt;`로 출력되어 `<`가 보이지 않음.

```html
<p>&amp;lt;div&amp;gt;</p> <!-- 화면: &lt;div&gt; -->
```

---

## 9. 이름 vs 숫자 — 무엇을 쓸까?

- **가독성/교육용**: `&lt;`, `&amp;`, `&copy;` 등 **이름 엔티티** 선호
- **희귀 문자/확실한 코드포인트 제어**: **숫자 엔티티(10진/16진)** 선호
- **일관성**을 위해 팀 규칙을 문서화하세요. (예: “기본은 이름, 미존재 문자는 16진”)

---

## 10. 보안 관점: XSS와 엔티티

- 엔티티는 **HTML 구문 오해 방지**에 도움을 주지만, **모든 XSS를 자동 차단**하지는 않습니다.
- **출력 컨텍스트별 이스케이프** 전략을 사용:
  - HTML 텍스트: `<, >, &, " , '`
  - HTML 속성(따옴표 내부): 위 + 따옴표
  - URL: **퍼센트 인코딩**(서버/JS의 `encodeURIComponent`)
  - CSS 컨텍스트: 유니코드 이스케이프/안전한 값만 삽입
  - JS 문자열: `JSON.stringify` 또는 전용 이스케이프

---

## 11. 실전 예제 모음

### 11.1 한 줄에 모아 보기
```html
<p>1 &lt; 2 &amp;&amp; 3 &gt; 1</p>
<p>저작권 &copy; 2025 Do Hyun Kim</p>
<p>줄바꿈 없는&nbsp;&nbsp;&nbsp;공백</p>
<p>통화: &euro; 1&#8239;234</p>
<p>화살표: &larr; &rarr; &uarr; &darr;</p>
<p>강조: &mdash; 긴 대시와 &ndash; 짧은 대시</p>
```

### 11.2 속성 값 안전화
```html
<a href="/search?q=rock&amp;type=album" title="Tom &amp; Jerry">검색</a>
<img alt="A &amp; B" src="/img.png?brand=A&amp;sub=B">
```

### 11.3 코드 블록 출력
```html
<pre><code>&lt;div class="note"&gt;엔티티 예제&lt;/div&gt;</code></pre>
```

### 11.4 이모지/특수문자 숫자 엔티티
```html
<p>&#x1F680; 로켓, &#128187; 랩탑</p>
```

---

## 12. 수식 표기(참고: MathJax를 쓸 때)

HTML 엔티티 대신 **렌더러(MathJax)** 가 수식을 처리합니다. 본문에 수식이 필요하면 다음처럼 사용하세요.

$$
E = mc^2,\quad a^2 + b^2 = c^2
$$

> 수식 영역 안에서는 일반 HTML 파싱이 아니라 수식 렌더러가 처리합니다.  
> **수식 주변 텍스트**에 예약 문자가 있다면 **엔티티**로 이스케이프하세요.

---

## 13. XML/XHTML 과거 호환 팁

- HTML5에서는 `&apos;`가 유효하지만, 과거 **HTML4**에서는 미정의였습니다(숫자 엔티티 사용 권장).
- **XHTML/XML** 문맥에서는 **모든 속성 값을 따옴표로 감싸고** 필요한 문자를 반드시 엔티티로 이스케이프하세요.

---

## 14. 트러블슈팅 체크리스트

- [ ] 화면에 `&lt;` 그대로 보임 → **이중 이스케이프**(`&amp;lt;`) 여부 확인
- [ ] 링크 쿼리 파라미터가 잘림 → HTML에서 `&amp;`로 표기했는가?
- [ ] 속성 값이 깨짐 → `'`, `"`, `&` 이스케이프 누락 확인
- [ ] 장문 영어/긴 토큰 줄바꿈 문제 → `&shy;`, `word-break`, `overflow-wrap` 병행
- [ ] 희귀 문자 표시 불가 → **숫자 엔티티** 또는 폰트 지원 여부 확인

---

## 15. 요약

- 엔티티는 **HTML 문맥에서 예약/특수 문자를 안전하게 출력**하기 위한 표기.
- 기본 5종은 항상 이스케이프: `<` `>` `&` `"` `'`
- **이름 엔티티**는 읽기 쉬움, **숫자 엔티티**는 보편·정밀.
- URL 인코딩(퍼센트 인코딩)과 **HTML 엔티티는 다릅니다** — 혼동 금지.
- 컨텍스트(텍스트/속성/URL/스크립트/스타일)별 **정확한 이스케이프**가 XSS/버그를 줄입니다.

---

## 부록 A. 미니 실습 페이지

```html
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>HTML 엔티티 실습</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>body{font:16px/1.7 system-ui,sans-serif;max-width:720px;margin:2rem auto;padding:0 1rem}</style>
</head>
<body>
  <h1>HTML 엔티티 실습</h1>
  <p>텍스트 노드: 1 &lt; 2 &amp;&amp; 3 &gt; 1</p>
  <p>속성 값: <a href="/search?q=red&amp;sort=asc" title="A &amp; B">링크</a></p>
  <p>공백: A&nbsp;&nbsp;&nbsp;B / 얇은 공백: A&thinsp;B / 좁은 NBSP: 10&#8239;kg</p>
  <pre><code>&lt;div class="code"&gt;엔티티&lt;/div&gt;</code></pre>

  <div id="out"></div>
  <script>
    const user = '<img src=x onerror=alert(1)>';
    // 안전 출력
    document.getElementById('out').textContent = '사용자 입력: ' + user;
  </script>
</body>
</html>
```