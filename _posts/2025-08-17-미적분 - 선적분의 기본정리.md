---
layout: post
title: 미적분 - 벡터장과 선적분
date: 2025-08-17 22:20:23 +0900
category: 미적분
---
# 선적분의 기본정리 (Fundamental Theorem for Line Integrals, FTLI)

## 정리의 정확한 서술

### 정의(보존장/퍼텐셜)

\[
\mathbf F:\Omega\subset\mathbb R^n\to\mathbb R^n
\]
가 **보존장(conservative)** 이라 함은, 어떤 \(C^1\) 스칼라장 \(\phi:\Omega\to\mathbb R\) 가 존재하여
\[
\boxed{\ \mathbf F = \nabla \phi\ }
\]
가 되는 경우를 말한다. \(\phi\) 를 **퍼텐셜 함수(potential)** 라고 한다.

### 선적분의 기본정리(FTLI)

\(\mathbf F=\nabla\phi\) 이고, \(C\) 가 조각-매끄러운 곡선으로 \(A\) 에서 \(B\) 로 간다면
\[
\boxed{
\int_C \mathbf F\cdot d\mathbf r \;=\; \phi(B)-\phi(A).
}
\]
특히 **폐곡선** \(C\) 에서는
\[
\boxed{
\oint_C \mathbf F\cdot d\mathbf r = 0.
}
\]
즉, **경로독립성**: 선적분 값은 \(A,B\) 에만 의존하고 경로에는 의존하지 않는다.

### 평면형(미분형)

2차원 \(\mathbf F=\langle P,Q\rangle\) 에서
\[
\int_C \mathbf F\cdot d\mathbf r
=
\int_C P\,dx+Q\,dy
=
\phi(B)-\phi(A).
\]

---

## 직관과 증명 스케치

### 직관

\(\mathbf F=\nabla \phi\) 면, 곡선 위에서의 미소 변위 \(d\mathbf r\) 에 대해
\[
\mathbf F\cdot d\mathbf r = \nabla\phi\cdot d\mathbf r
\stackrel{\text{체인룰}}{=} d\phi.
\]
따라서 곡선을 따라 적분하면 단순히 \(\phi\) 값의 변화량이 된다:
\[
\int_C \mathbf F\cdot d\mathbf r = \int_C d\phi = \phi(B)-\phi(A).
\]

### 증명 스케치(매개화 사용)

곡선 매개화 \(\mathbf r:[a,b]\to\Omega\), \(\mathbf r(a)=A\), \(\mathbf r(b)=B\):
\[
\int_C \mathbf F\cdot d\mathbf r
= \int_{a}^{b} \mathbf F(\mathbf r(t))\cdot\mathbf r'(t)\,dt
= \int_{a}^{b} \nabla\phi(\mathbf r(t))\cdot\mathbf r'(t)\,dt.
\]
체인룰로 \(\frac{d}{dt}\phi(\mathbf r(t))=\nabla\phi(\mathbf r(t))\cdot\mathbf r'(t)\).
따라서
\[
\int_{a}^{b} \nabla\phi(\mathbf r(t))\cdot\mathbf r'(t)\,dt
= \int_{a}^{b} \frac{d}{dt}\phi(\mathbf r(t))\,dt
= \phi(\mathbf r(b))-\phi(\mathbf r(a)).
\]

---

## FTLI와 등가 조건(경로독립성, 폐곡선 적분 0)

정칙성이 좋은 영역 \(\Omega\) (보통 **단일연결**, \(\mathbf F\) 가 \(C^1\))에서 다음이 서로 동치다.

1) \(\mathbf F\) 는 보존장, 즉 \(\exists\,\phi: \mathbf F=\nabla\phi\).
2) 임의의 곡선 \(C: A\to B\) 에서 \(\displaystyle \int_C \mathbf F\cdot d\mathbf r\) 는 \(A,B\) 에만 의존(경로독립).
3) 임의의 **폐곡선** \(C\) 에 대해 \(\displaystyle \oint_C \mathbf F\cdot d\mathbf r=0\).

> **2D 추가(단일연결 가정)**: \(\mathbf F=\langle P,Q\rangle\) 이고 \(P,Q\in C^1\) 이면
> \[
> \frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}\quad\Longleftrightarrow\quad \mathbf F\ \text{보존장}.
> \]

---

## 퍼텐셜 찾기(실전 절차)

평면 \(\mathbf F=\langle P(x,y),Q(x,y)\rangle\) 에서 \(\phi\) 를 구하는 표준 절차:

1) \(\phi_x=P\) 를 적분: \(\phi(x,y)=\int P(x,y)\,dx + g(y)\).
2) \(\phi_y\) 를 계산해 \(Q\) 와 비교: \(\phi_y = Q \Rightarrow g'(y)=Q-\partial/\partial y \int P\,dx\).
3) \(g(y)\) 를 얻어 \(\phi\) 완성(상수는 임의).

3D \(\mathbf F=\langle P,Q,R\rangle\) 도 유사:
\(\phi_x=P\), \(\phi_y=Q\), \(\phi_z=R\), 교차일관성(혼합편미분 일치)을 확인하며 적분 상수(다른 변수의 함수)를 정한다.

---

## 예제

### 예제 1 — 다항형 보존장

\[
\mathbf F(x,y)=\langle 2xy+y^3,\; x^2+3xy^2\rangle.
\]
교차미분:
\[
P_y=2x+3y^2,\quad Q_x=2x+3y^2 \Rightarrow P_y=Q_x.
\]
단일연결 영역이면 보존장. 퍼텐셜:
\[
\phi_x=2xy+y^3 \Rightarrow \phi = x^2y + xy^3 + g(y).
\]
\[
\phi_y=x^2+3xy^2+g'(y)\stackrel{!}{=}Q=x^2+3xy^2 \Rightarrow g'(y)=0\Rightarrow g=\text{const}.
\]
따라서 \(\phi=x^2y+xy^3\).
임의 경로 \(C:A\to B\) 에 대해
\[
\int_C \mathbf F\cdot d\mathbf r = \phi(B)-\phi(A).
\]

#### 수치/심볼릭 검증 (두 경로 비교)

```python
import sympy as sp

t = sp.symbols('t', real=True)
x, y = sp.symbols('x y', real=True)
P = 2*x*y + y**3
Q = x**2 + 3*x*y**2

# 경로1: 직선 (0,0)->(1,1): r1(t)=(t,t)

x1 = t;  y1 = t
dx1 = sp.diff(x1, t); dy1 = sp.diff(y1, t)
I1 = sp.integrate(P.subs({x:x1,y:y1})*dx1 + Q.subs({x:x1,y:y1})*dy1, (t, 0, 1))

# 경로2: 곡선 (0,0)->(1,1): r2(t)=(t, t**2), t in [0,1], 끝점은 (1,1) 아니므로 조정
# (끝점 맞추기 위해 r2로는 (0,0)->(1,1) 안 됨. 아래는 (0,0)->(1,1) 경로로 r2(t)=(t, t)

x2 = t;  y2 = t # 비교를 위해 같은 끝점을 가지는 다른 경로를 쓰려면 별도 구성 필요
dx2 = sp.diff(x2, t); dy2 = sp.diff(y2, t)
I2 = sp.integrate(P.subs({x:x2,y:y2})*dx2 + Q.subs({x:x2,y:y2})*dy2, (t, 0, 1))

phi = x**2*y + x*y**3
dphi = phi.subs({x:1,y:1}) - phi.subs({x:0,y:0})

print("경로1:", sp.simplify(I1))
print("경로2:", sp.simplify(I2))
print("퍼텐셜 차이:", sp.simplify(dphi))
```
> 어떤 두 **서로 다른** 경로를 취해도 결과는 \(\phi(1,1)-\phi(0,0)=2\) 로 같다(경로독립).

---

### 예제 2 — 회전장(비보존장)과 폐곡선 적분

\[
\mathbf F(x,y)=\langle -y,\; x\rangle.
\]
단위원을 반시계로 한 바퀴:
\[
\oint_C \mathbf F\cdot d\mathbf r = 2\pi \neq 0.
\]
보존장이 아니며, 경로의존적이다(순환이 존재).

```python
import sympy as sp

t = sp.symbols('t', real=True)
x = sp.cos(t); y = sp.sin(t)
dx = sp.diff(x, t); dy = sp.diff(y, t)

P = -y; Q = x
I = sp.integrate(P*dx + Q*dy, (t, 0, 2*sp.pi))
print("∮(-y)dx + x dy =", sp.simplify(I))  # 2π
```

---

### 예제 3 — 구멍 난 영역(단일연결 아님): curl=0인데 비보존

\[
\mathbf F(x,y)=\Big\langle -\frac{y}{x^2+y^2},\ \frac{x}{x^2+y^2}\Big\rangle
\]
은 \(\mathbb R^2\setminus\{(0,0)\}\) 에서 정의.
형식적으로 \(Q_x-P_y=0\) 처럼 보이나, 원점을 도는 폐곡선에서
\[
\oint_C \mathbf F\cdot d\mathbf r = 2\pi n\ (\neq 0).
\]
단일연결이 아니므로 전역 퍼텐셜이 존재하지 않는다(위상의 영향).

---

### 예제 4 — 3D 보존장

\[
\mathbf F(x,y,z)=\langle 2xy,\ x^2+2yz,\ y^2\rangle.
\]
퍼텐셜 \(\phi\) 를 찾자.
\(\phi_x=2xy\Rightarrow \phi=x^2y+h(y,z)\).
\(\phi_y=x^2+h_y=y\)-계산:
\(\phi_y = x^2 + h_y \stackrel{!}{=} Q = x^2+2yz \Rightarrow h_y=2yz\Rightarrow h=y^2 z + k(z)\).
\(\phi_z = y^2 + k'(z) \stackrel{!}{=} R=y^2 \Rightarrow k'(z)=0\Rightarrow k=\text{const}\).
따라서 \(\phi=x^2y + y^2 z\).
임의의 곡선 \(C:A\to B\) 에서 \(\displaystyle \int_C \mathbf F\cdot d\mathbf r=\phi(B)-\phi(A)\).

---

## 계산 전략과 팁

1) **먼저 판별**: \(\mathbf F\) 가 보존장인지 확인(2D면 \(P_y\) vs \(Q_x\)). 단일연결 여부를 점검.
2) **보존장**이면 **퍼텐셜** \(\phi\) 를 찾아 **값 차**로 계산 → 가장 빠르고 안정적.
3) **비보존장**이거나, 영역이 애매하면 매개화하여 직접 적분(또는 Green/Stokes 정리 고려).
4) **특이점/불연속** 주의: 경로가 특이점을 감싸는지, 정의역이 끊겨 있지 않은지 확인.
5) **코드 검증**: 심볼릭(정확), 수치(검증/근사) 병행.

---

## 경로독립성의 또 다른 관점: 미분형(Exact Differential)

평면에서 \(P\,dx+Q\,dy\) 가 어떤 스칼라 \(\phi\) 의 전미분 \(d\phi\) 이면, 즉
\[
d\phi = \phi_x\,dx + \phi_y\,dy = P\,dx + Q\,dy,
\]
이는 **정확미분형(exact differential form)** 이다. 이 경우
\[
\int_C P\,dx+Q\,dy = \phi(B)-\phi(A),
\]
즉 경로독립. **정확조건**은 \(P_y=Q_x\) (단일연결, \(C^1\) 가정).

---

## 수치/심볼릭 실습

### 임의 경로에서의 경로독립성 테스트(보존장)

```python
import numpy as np

# 보존장: F = grad phi, phi = x^2 y + x y^3

def F(x, y):
    return np.array([2*x*y + y**3, x**2 + 3*x*y**2])

def line_int(F, r, rp, a, b, n=20000):
    ts = np.linspace(a, b, n+1)
    vals = []
    for t in ts:
        pos = np.array(r(t))
        vel = np.array(rp(t))
        vals.append(np.dot(F(*pos), vel))
    vals = np.array(vals)
    h = (b-a)/n
    return h*(0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

# 두 경로: (0,0)->(1,1)

r1  = lambda t: (t, t)
rp1 = lambda t: (1, 1)

# 곡선 경로: (0,0)->(1,1)로 가는 다른 경로 예: (t, t**2) 은 (1,1) 도달 못함.
# (0,0)->(1,1) 경로로 (t, t)와 (t, t**(1))은 같으므로, 합성 경로 등으로 바꾸는 게 좋다.
# 예: (0,0)->(1,0)->(1,1) 조각경로

r2a  = lambda t: (t, 0)
rp2a = lambda t: (1, 0)
r2b  = lambda t: (1, t)
rp2b = lambda t: (0, 1)

I1 = line_int(F, r1, rp1, 0.0, 1.0, n=20000)
I2 = line_int(F, r2a, rp2a, 0.0, 1.0, n=20000) + line_int(F, r2b, rp2b, 0.0, 1.0, n=20000)

phi = lambda x,y: x**2*y + x*y**3
delta_phi = phi(1,1) - phi(0,0)

print("I1 ≈", I1)
print("I2 ≈", I2)
print("phi(B)-phi(A) =", delta_phi)
print("Errors:", abs(I1 - delta_phi), abs(I2 - delta_phi))
```

### 비보존장에서 경로의존성 확인

```python
import numpy as np

def F_rot(x, y):
    return np.array([-y, x])

def circle_r(R):
    return lambda t: (R*np.cos(t), R*np.sin(t))
def circle_rp(R):
    return lambda t: (-R*np.sin(t), R*np.cos(t))

def line_int_num(F, r, rp, a, b, n=200000):
    ts = np.linspace(a, b, n+1)
    vals = []
    for t in ts:
        pos = np.array(r(t))
        vel = np.array(rp(t))
        vals.append(np.dot(F(*pos), vel))
    vals = np.array(vals)
    h = (b-a)/n
    return h*(0.5*vals[0] + vals[1:-1].sum() + 0.5*vals[-1])

for R in [0.5, 1.0, 2.0]:
    r  = circle_r(R);  rp = circle_rp(R)
    val = line_int_num(F_rot, r, rp, 0.0, 2*np.pi, n=100000)
    print(f"R={R}: ∮F·dr ≈ {val}  (이론값=2πR^2)")
```

> \(\langle -y,x\rangle\) 에서 원 \(x^2+y^2=R^2\) 의 \(\oint \mathbf F\cdot d\mathbf r = 2\pi R^2\).

---

## 자주 하는 실수/주의

- **단일연결성 누락**: \(P_y=Q_x\) 라고 **항상** 보존장이 되는 것이 아니다. 도메인에 구멍이 있으면 전역 퍼텐셜이 불가할 수 있다.
- **특이점 포함**: \((0,0)\) 같은 특이점 주위에서 **폐곡선** 적분이 0이 아닐 수 있다.
- **경계/불연속**: \(\mathbf F\) 가 연속/미분가능하지 않은 집합을 조심.
- **경로 방향**: \(\int_{-C} = -\int_C\). 방향 표기에 유의.
- **부분적분 착각**: 선적분은 \(\int \mathbf F\cdot d\mathbf r\). 스칼라 선적분 \(\int f\,ds\) 와 다르다.
- **퍼텐셜 상수**: \(\phi\) 는 상수만큼 자유. 차이는 상수에 무관하므로 문제 없음.

---

## 연습문제(정답 스케치 포함)

1) \(\mathbf F(x,y)=\langle 3x^2y+2y,\ x^3+2x\rangle\).
   (a) 보존장 판별. (b) 퍼텐셜 \(\phi\). (c) \((0,0)\to(1,2)\) 선적분.
   - 스케치: \(P_y=3x^2+2=Q_x\Rightarrow\) 보존장.
     \(\phi_x=P\Rightarrow \phi=x^3y+2xy + g(y)\).
     \(\phi_y=x^3+2x+g'(y)\stackrel{!}{=}Q=x^3+2x\Rightarrow g'=0\).
     \(\phi=x^3y+2xy\). 결과: \(\phi(1,2)-\phi(0,0)=1^3\cdot 2 + 2\cdot 1\cdot 2=2+4=6\).

2) \(\mathbf F(x,y)=\langle -y/(x^2+y^2),\ x/(x^2+y^2)\rangle\), \(C\): 단위원.
   \(\oint_C \mathbf F\cdot d\mathbf r\) 를 구하라.
   - 정답: \(2\pi\). 보존장 아님(도메인에 구멍).

3) 3D \(\mathbf F(x,y,z)=\langle yz,\ xz,\ xy\rangle\).
   (a) 보존장 판별. (b) \(\phi\) 가 있다면 찾고, \((1,1,1)\to(2,1,3)\) 적분.
   - 스케치: 혼합편미분 일치(\(P_y=Q_x=z,\ P_z=R_x=y,\ Q_z=R_y=x\)) → 보존장.
     \(\phi_x=yz\Rightarrow \phi=xyz+h(y,z)\).
     \(\phi_y=xz+h_y\stackrel{!}{=}xz\Rightarrow h_y=0\Rightarrow h=k(z)\).
     \(\phi_z=xy+k'(z)\stackrel{!}{=}xy\Rightarrow k'=0.\)
     \(\phi=xyz\). 적분은 \(\phi(B)-\phi(A)= (2\cdot1\cdot3)-(1\cdot1\cdot1)=6-1=5\).

4) \(\mathbf F(x,y)=\langle 2x/(x^2+y^2),\ 2y/(x^2+y^2)\rangle\), \(\Omega=\mathbb R^2\setminus\{0\}\).
   (a) 보존장인가? (b) 가능하면 \(\phi\) 를 구하라.
   - 스케치: \(\phi=\ln(x^2+y^2)\) 의 그래디언트. 국소적으로는 보존장.
     그러나 \(\Omega\) 는 단일연결이 아니지만, 이 장은 특이점 제외 영역 전체에서 **전역 퍼텐셜** \(\ln r^2\) 가 존재한다(멀티벨류 아닌 로그 선택).
     폐곡선 적분은 0.

5) 경로독립성 ⇔ 폐곡선 적분 0 을 직접 이용하여, \(\int_C \mathbf F\cdot d\mathbf r\) 가 임의 경로에 독립임을 보이고 \(\phi\) 를 구성하라(정의 \(\phi(p)=\int_{p_0}^p \mathbf F\cdot d\mathbf r\)).
   - 스케치: 기준점 \(p_0\) 고정, 경로독립성을 이용하면 \(\phi\) 가 잘 정의. \(\nabla\phi=\mathbf F\) 임을 보이면 됨.

---

## 한 장 요약

- **정리**: \(\mathbf F=\nabla\phi\) 이면 \(\displaystyle \int_C \mathbf F\cdot d\mathbf r=\phi(B)-\phi(A)\).
- **동치**: (보존장) ⇔ (경로독립) ⇔ (폐곡선 적분 0).
- **2D 판정**: 단일연결에서 \(P_y=Q_x\).
- **실전**: 퍼텐셜 찾기 → 값 차로 빠르게 계산.
- **주의**: 단일연결, 특이점, 영역의 위상.

---

## 부록: 심볼릭 퍼텐셜 자동화 예시

```python
import sympy as sp

x, y = sp.symbols('x y', real=True)
P = 3*x**2*y + 2*y
Q = x**3 + 2*x

# 보존장 판정

print("Q_x - P_y =", sp.simplify(sp.diff(Q, x) - sp.diff(P, y)))  # 0이면 보존장(단일연결 가정)

# 퍼텐셜 구하기

phi = sp.integrate(P, (x))  # ∫P dx
# phi = x^3 y + 2 x y + g(y)

gprime = sp.simplify(sp.diff(phi, y) - Q)  # g'(y)
g = sp.integrate(-gprime, (y))  # g'(y)=0이면 g=const
phi = sp.simplify(phi + g)
print("phi(x,y) =", phi)

# FTLI 적용: (0,0)->(1,2)

A = {x:0, y:0}
B = {x:1, y:2}
print("phi(B)-phi(A) =", sp.simplify(phi.subs(B) - phi.subs(A)))
```

---

이상으로, **선적분의 기본정리**를 이론–직관–실전–코드까지 통합하여 정리하였다.
벤치마크처럼 항상 먼저 **보존장 여부**와 **영역의 단일연결성**을 점검하고, 가능한 경우 **퍼텐셜 차**로 계산하라.
복잡한 경로/곡선에서도 결과가 **경로독립**이 되는 순간, 선적분은 사실상 “끝점 평가” 문제로 단순화된다.
