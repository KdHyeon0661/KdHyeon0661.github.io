---
layout: post
title: 이산수학 - 행렬
date: 2025-05-26 19:20:23 +0900
category: 이산수학
---
# 행렬(Matrix) — 선형대수의 기본 구조

## 1) 행렬이란?

**행렬(matrix)**은 수(혹은 스칼라, 복소수, 심지어 상징식)를 **직사각형 격자**로 배치한 객체다. $$m\times n$$ 크기의 행렬 $$A$$ 는
$$
A=\big[a_{ij}\big]\in\mathbb{F}^{m\times n},\quad 1\le i\le m,\ 1\le j\le n,
$$
여기서 $$\mathbb{F}$$ 는 보통 $$\mathbb{R}$$(실수) 또는 $$\mathbb{C}$$(복소수)이다.

- **크기(shape)**: $$m\times n$$  
- **정방행렬(square)**: $$m=n$$  
- **단위행렬(identity)**: $$I_n$$, $$\ (I_n)_{ij}=\delta_{ij}$$  
- **영행렬(zero)**: $$0_{m\times n}$$, 모든 원소가 0

예시(라텍스 표기):
$$
A=\begin{bmatrix}1&2&3\\4&5&6\end{bmatrix}\in\mathbb{R}^{2\times 3},\qquad
B=\begin{bmatrix}7&8\\9&10\\11&12\end{bmatrix}\in\mathbb{R}^{3\times 2}.
$$

---

## 2) 기본 연산과 차원 규칙

### 2.1 덧셈/뺄셈(동형만)
$$
A,B\in\mathbb{F}^{m\times n}\ \Rightarrow\ A\pm B=\big[a_{ij}\pm b_{ij}\big].
$$
- 교환/결합 성질 성립.

### 2.2 스칼라 곱
$$
\alpha\in\mathbb{F},\ A\in\mathbb{F}^{m\times n}\ \Rightarrow\ \alpha A=\big[\alpha a_{ij}\big].
$$

### 2.3 행렬 곱(합성)
$$
A\in\mathbb{F}^{m\times n},\ B\in\mathbb{F}^{n\times p}\ \Rightarrow\ AB\in\mathbb{F}^{m\times p},\quad
(AB)_{ij}=\sum_{k=1}^n a_{ik}b_{kj}.
$$
- 결합법칙: $$(AB)C=A(BC)$$  
- 분배법칙: $$A(B+C)=AB+AC,\ (A+B)C=AC+BC$$  
- **비가환**: 일반적으로 $$AB\ne BA$$  
- 항등원: $$AI_m=A,\ I_nA=A$$(차원 일치 전제)

### 2.4 전치/케혼
전치: $$A^T\in\mathbb{F}^{n\times m},\ (A^T)_{ij}=a_{ji}$$  
복소 케혼(켤레전치): $$A^*=\overline{A}^T$$ (복소일 때)

성질:
$$
(A^T)^T=A,\quad (AB)^T=B^TA^T,\quad (A+B)^T=A^T+B^T.
$$
복소:
$$
(A^*)^*=A,\quad (AB)^*=B^*A^*,\quad (A+B)^*=A^*+B^*.
$$

---

## 3) 특수 행렬과 자주 쓰는 클래스

- **대각행렬**: $$D=\mathrm{diag}(d_1,\dots,d_n)$$, 대각 외 원소 0  
- **삼각행렬**: 상/하삼각, 곱/역(가능 시) 보존  
- **대칭/에르미트**: $$A^T=A$$(실수), $$A^*=A$$(복소)  
- **직교/유니터리**: $$Q^TQ=QQ^T=I$$, $$U^*U=UU^*=I$$  
- **투영(projection)**: $$P^2=P$$, 직교투영은 추가로 $$P^T=P$$  
- **순열행렬**: 행/열을 섞는 $$P$$, $$P^{-1}=P^T$$  
- **양의(준)정부호(PSD/PD)**: $$x^TAx\ge 0(\,>0)$$ 모든 $$x\ne 0$$

---

## 4) 역행렬과 행렬식

### 4.1 역행렬
정방 $$A\in\mathbb{F}^{n\times n}$$ 가 **가역**이면 역행렬 $$A^{-1}$$ 존재:
$$
AA^{-1}=A^{-1}A=I.
$$
- 필요충분: $$\det A\ne 0 \iff \mathrm{rank}(A)=n \iff \text{영공간}\{0\}$$.
- 2x2 공식:
$$
A=\begin{bmatrix}a&b\\c&d\end{bmatrix}\Rightarrow
A^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d&-b\\-c&a\end{bmatrix}.
$$

### 4.2 행렬식(det)
성질 요약:
$$
\det(AB)=\det A\cdot\det B,\quad \det A^T=\det A,\quad \det I=1.
$$
행 연산 효과:
- 한 행의 스칼라 배: 그 스칼라만큼 배
- 두 행 교환: 부호 반전
- 한 행에 다른 행의 배 더하기: 변화 없음

삼각행렬은 $$\det A=$$ 대각원소 곱.

**기하학적 의미**: 선형변환 $$x\mapsto Ax$$ 의 **부피 스케일**.

---

## 5) 랭크, 공간, 기본 정리

- **열공간**: $$\mathcal{C}(A)=\mathrm{span}\{A\text{의 열}\}$$  
- **행공간**: $$\mathcal{R}(A)=\mathcal{C}(A^T)$$  
- **영공간(nullspace)**: $$\mathcal{N}(A)=\{x:Ax=0\}$$  
- **랭크(rank)**: $$\mathrm{rank}(A)=\dim \mathcal{C}(A)=\dim \mathcal{R}(A)$$

**랭크-널리티 정리**(정방이든 아니든):
$$
\dim\mathcal{N}(A)+\mathrm{rank}(A)=n \quad(A\in\mathbb{F}^{m\times n}).
$$

---

## 6) 선형 방정식과 해의 구조

연립방정식 $$Ax=b$$.

- **유일해**: $$\mathrm{rank}(A)=n$$(열이 독립), 정방 가역이면 $$x=A^{-1}b$$  
- **해 없음**: 불일치(증강랭크 증가)  
- **무한해**: 자유변수 존재

**최소제곱(과결정)**: 해가 없을 때 **잔차 최소** $$\min_x\|Ax-b\|_2$$  
정규방정식:
$$
A^TAx=A^Tb.
$$
보다 안정적 방법: **QR 분해** 또는 **SVD** 사용.

---

## 7) 고유값/고유벡터, 대각화, 스펙트럼

- **정의**: $$Ax=\lambda x,\ x\ne 0$$ ⇒ $$\lambda$$ 는 고유값, $$x$$ 는 고유벡터  
- **특성다항식**: $$p_A(\lambda)=\det(\lambda I-A)$$  
- **대각화 가능**: 독립한 고유벡터가 $$n$$ 개면 $$A=V\Lambda V^{-1}$$  
- **스펙트럴 정리(대칭/에르미트)**: $$A=Q\Lambda Q^T$$(혹은 $$Q^*$$), $$\Lambda$$ 실대각, 직교기저

양의정부호 $$A$$ 의 모든 고유값은 **양수**.

---

## 8) 직교성, 직교투영, 분해들

### 8.1 내적/직교
표준 내적 $$\langle x,y\rangle=x^Ty$$, 직교 $$\langle x,y\rangle=0$$.  
정규직교 기저: **그람-슈미트**로 구성.

### 8.2 QR 분해
$$
A\in\mathbb{R}^{m\times n}\ (m\ge n)\Rightarrow A=QR,\quad Q^TQ=I,\ R\ \text{상삼각}.
$$
최소제곱에서 $$Rx=Q^Tb$$ 로 빠르고 안정적.

### 8.3 SVD
$$
A=U\Sigma V^T,\quad U\in\mathbb{R}^{m\times m},\ V\in\mathbb{R}^{n\times n},\ \Sigma=\mathrm{diag}(\sigma_1\ge\cdots\ge\sigma_r>0).
$$
- **랭크** $$r$$, **조건수** $$\kappa_2(A)=\sigma_1/\sigma_r$$  
- 최소제곱, 차원축소, 잡음 완화에 핵심.

### 8.4 직교투영 행렬
열이 선형독립인 $$A\in\mathbb{R}^{m\times n}$$ 에서 열공간으로의 직교투영:
$$
P=A(A^TA)^{-1}A^T,\quad P^2=P,\ P^T=P.
$$

---

## 9) 행렬 노름과 조건수

**벡터 2-노름**: $$\|x\|_2=\sqrt{x^Tx}$$.  
**유도 2-노름(스펙트럴)**: $$\|A\|_2=\sigma_{\max}(A)$$.  
**프뢰베니우스 노름**: $$\|A\|_F=\sqrt{\sum_{ij} a_{ij}^2}=\sqrt{\mathrm{tr}(A^TA)}$$.

**조건수**(2-노름):
$$
\kappa_2(A)=\|A\|_2\|A^{-1}\|_2=\frac{\sigma_{\max}}{\sigma_{\min}}.
$$
크면(예: $$\gg 1$$) 수치적으로 **불안정**, 입력 오차가 해에 크게 증폭.

---

## 10) 블록 행렬, 트레이스, 크로네커/아다마르

### 10.1 블록 연산
호환되는 크기에서
$$
\begin{bmatrix}A&B\\C&D\end{bmatrix}
$$
곱/역/소거를 블록 단위로 수행.  
**슈어 보수**: $$S=D-CA^{-1}B$$ 등.

### 10.2 트레이스
$$
\mathrm{tr}(A)=\sum_i a_{ii},\quad \mathrm{tr}(AB)=\mathrm{tr}(BA).
$$
순환성: $$\mathrm{tr}(ABC)=\mathrm{tr}(BCA)=\mathrm{tr}(CAB)$$.

### 10.3 크로네커 곱/아다마르 곱
- **크로네커**: $$A\otimes B$$, 차원 확장 및 텐서 연산에 용이  
- **아다마르(원소별)**: $$A\circ B=(a_{ij}b_{ij})$$

---

## 11) 계산 관점(복잡도/안정성/희소성)

- **복잡도**: 표준 행렬곱 $$O(n^3)$$, 빠른 곱(스트라센 등) $$O(n^{2.8})$$ 근처.  
- **가우스 소거**: 부분 피벗팅 권장(수치 안정성).  
- **희소 행렬**: CSR/COO 저장, 곱/해법에서 **0 저장 회피**로 메모리/연산 절약.  
- **역행렬 직접 계산은 지양**: 해법은 보통 **LU/QR/SVD** 로.

---

## 12) 파이썬 실습(NumPy 기반)

> 주의: 실수 계산 오차가 있으므로 `np.allclose` 로 판정한다.

```python
import numpy as np

# 기본 행렬
A = np.array([[1., 2., 3.],
              [4., 5., 6.]])         # 2x3
B = np.array([[7., 8.],
              [9.,10.],
              [11.,12.]])            # 3x2

# 1) 덧셈/스칼라/곱
print("A shape:", A.shape, "B shape:", B.shape)
AB = A @ B
print("A @ B =\n", AB)

# 2) 전치/대칭성 확인
AT = A.T
print("A^T shape:", AT.shape)

# 3) 정방행렬 예시와 역행렬/행렬식
M = np.array([[2., 1.],
              [5., 3.]])
Minv = np.linalg.inv(M)
detM = np.linalg.det(M)
print("det(M) =", detM)
print("M^{-1} =\n", Minv)
print("M @ M^{-1} ≈ I?\n", np.allclose(M @ Minv, np.eye(2)))

# 4) 랭크/영공간 근사(SVD 이용)
rankA = np.linalg.matrix_rank(A)
print("rank(A) =", rankA)

def nullspace(A, atol=1e-12, rtol=0.):
    U, S, Vt = np.linalg.svd(A)
    tol = max(atol, rtol * S[0]) if S.size else atol
    nnz = (S >= tol).sum()
    NS = Vt[nnz:].T
    return NS

NS = nullspace(A)  # Ax = 0 해공간 기저
print("Nullspace basis shape:", NS.shape)

# 5) 선형방정식/최소제곱
# 정방/가역이면 solve, 과결정이면 lstsq
C = np.array([[1., 2.],
              [3., 4.]])
d = np.array([1., 0.])
x_exact = np.linalg.solve(C, d)
print("Solve Cx=d:", x_exact)

# 과결정 예시(최소제곱)
A_ls = np.array([[1., 1.],
                 [1., 2.],
                 [1., 3.]])   # 3x2
b_ls = np.array([1., 2., 2.])
x_ls, resid, rnk, s = np.linalg.lstsq(A_ls, b_ls, rcond=None)
print("Least-squares x:", x_ls)
print("Residual norm:", np.linalg.norm(A_ls @ x_ls - b_ls))

# 6) QR/SVD
Q, R = np.linalg.qr(A_ls, mode='reduced')
print("QR check (Q^T Q≈I):", np.allclose(Q.T @ Q, np.eye(Q.shape[1])))
U, S, Vt = np.linalg.svd(A_ls, full_matrices=False)
print("SVD shapes:", U.shape, S.shape, Vt.shape)

# 7) 고유값/벡터
H = np.array([[2., 0.],
              [0., 3.]])
w, V = np.linalg.eig(H)
print("eigvals:", w)
print("eigvecs (columns):\n", V)

# 8) 직교투영 P = A(A^T A)^{-1} A^T
A_proj = A_ls              # 가정: 열 독립
ATA_inv = np.linalg.inv(A_proj.T @ A_proj)
P = A_proj @ ATA_inv @ A_proj.T
print("Projection idempotent? P^2≈P:", np.allclose(P @ P, P))
print("Projection symmetric? P^T≈P:", np.allclose(P.T, P))

# 9) 노름/조건수
norm2 = np.linalg.norm(C, 2)
cond2 = np.linalg.cond(C, 2)
print("||C||_2 =", norm2, ", cond_2(C) =", cond2)
```

---

## 13) 예제 풀이(손계산+개념)

### 13.1 2x2 역행렬
$$
A=\begin{bmatrix}1&2\\3&5\end{bmatrix},\quad
\det A=1\cdot 5-2\cdot 3=-1.
$$
따라서
$$
A^{-1}=\frac{1}{-1}\begin{bmatrix}5&-2\\-3&1\end{bmatrix}
=\begin{bmatrix}-5&2\\3&-1\end{bmatrix}.
$$

### 13.2 행렬식의 부피 의미(2D)
$$
A=\begin{bmatrix}a&b\\c&d\end{bmatrix}
$$
가 단위정사각형을 평행사변형으로 보낼 때 면적은 $$|\det A|=|ad-bc|$$.

### 13.3 최소제곱 직교투영
$$
\min_x\|Ax-b\|_2\quad\Rightarrow\quad x=(A^TA)^{-1}A^Tb,\quad \hat b=Ax=P b.
$$
여기서 $$P=A(A^TA)^{-1}A^T,\ P^2=P,\ P^T=P$$.

---

## 14) 실무 팁(수치 선형대수)

- **역행렬을 구해 곱하지 말고** `solve` 나 `lstsq` 를 사용: 정확/안정/빠름.  
- **피벗팅** 없는 가우스소거는 불안정할 수 있음.  
- **조건수**가 큰 문제는 정규화/재스케일/정규화항(릿지) 고려.  
- **희소** 구조를 살리는 자료구조/알고리즘을 선택.

---

## 15) 연습문제(해설 스케치 포함)

1. 증명: $$\det(AB)=\det A\cdot\det B$$.  
   스케치: 기본행연산/연속성 또는 고유값 곱 성질 사용.

2. $$A\in\mathbb{R}^{m\times n}$$ 에 대해 $$\mathrm{rank}(A)=\mathrm{rank}(A^T)$$ 를 보이라.  
   스케치: 행공간/열공간 차원 동치.

3. $$A$$ 가 대칭이고 양의정부호이면, 모든 고유값이 양수임을 보이라.  
   스케치: $$Ax=\lambda x,\ x\ne 0\Rightarrow x^TAx=\lambda\|x\|^2>0$$.

4. 최소제곱에서 QR 해법 유도: $$A=QR$$ 이면 $$Rx=Q^Tb$$.  
   스케치: $$\|Ax-b\|=\|QRx-b\|=\|Rx-Q^Tb\|$$.

5. 투영행렬의 필요충분조건: $$P^2=P \iff$$ 어떤 부분공간으로의 선형투영.  
   스케치: 분해 $$\mathbb{R}^m=\mathrm{im}(P)\oplus\ker(P)$$.

6. SVD 로 랭크-축소 근사: $$A_k=U_k\Sigma_kV_k^T$$ 가 Frobenius 노름 최적임.  
   스케치: 에커트-영 정리.

---

## 16) 요약(치트시트)

- 차원 규칙: $$A_{m\times n}B_{n\times p}$$ 만 가능.  
- 비가환: $$AB\ne BA$$(대체로).  
- 역행렬 조건: $$\det A\ne 0$$.  
- 랭크-널리티: $$\dim\mathcal{N}(A)+\mathrm{rank}(A)=n$$.  
- 최소제곱: $$x=(A^TA)^{-1}A^Tb$$ 보다 **QR/SVD 권장**.  
- 스펙트럴 정리(대칭): $$A=Q\Lambda Q^T$$.  
- 조건수: $$\kappa_2=\sigma_{\max}/\sigma_{\min}$$, 클수록 민감.  
- 투영: $$P=A(A^TA)^{-1}A^T,\ P^2=P,\ P^T=P$$.

이로써 행렬의 **구조/연산/해석/계산** 전반의 토대를 정리했다. 이후에는 **가우스 소거/행렬식 계산법, 고유분해/대각화, QR/SVD, 정규/유니터리/정규행렬의 스펙트럼 이론, 수치적 안정성** 등을 단계적으로 확장하면 된다.