---
layout: post
title: 선형대수 - 정규 행렬과 유니터리 행렬
date: 2025-06-27 21:20:23 +0900
category: 선형대수
---
# 정규 행렬과 유니터리 행렬

> **핵심 요약**  
> - **정규 행렬(normal)**: $$AA^* = A^*A$$ 를 만족. **항상 유니터리 대각화 가능**: $$A = U \Lambda U^*$$  
> - **유니터리 행렬(unitary)**: $$U^*U = UU^* = I$$. **길이와 내적 보존**, 모든 고유값이 **단위원(절댓값 1)**.  
> - 정규 ⊃ 유니터리, 에르미트(자가수반), 반(anti-)에르미트, 대각행렬 등은 모두 정규.

---

## 1) 정의와 첫 느낌

### 1.1 정규 행렬 (Normal Matrix)
정사각 복소 행렬 $$A \in \mathbb{C}^{n\times n}$$ 가
$$
\boxed{AA^* = A^*A}
$$
를 만족하면 **정규 행렬**이라 합니다. 여기서 $$A^*$$는 **켤레 전치(conjugate transpose)** 입니다.

- 예시  
  - **에르미트(Hermitian)**: $$A=A^*$$ → 정규  
  - **반에르미트(Skew-Hermitian)**: $$A=-A^*$$ → 정규  
  - **대각행렬**: 모든 대각행렬은 정규  
  - **유니터리(Unitary)**: $$A^*=A^{-1}$$ → 정규

### 1.2 유니터리 행렬 (Unitary Matrix)
$$
\boxed{U^*U = UU^* = I}
$$
를 만족하는 $$U$$를 **유니터리**라 합니다. 실수 행렬에서의 **직교(orthogonal)** 개념의 복소 확장입니다.

- **기하학**: 길이·내적·각도를 보존하는 **회전/반사**(복소 공간에서).
- **고유값**은 모두 **단위원 위**(즉, $$|\lambda|=1$$).
- **조건수**(2-노름 기준)가 1: 수치적으로 매우 안정.

---

## 2) 스펙트럼 정리(정규 버전)와 직교/유니터리 대각화

실수 대칭/복소 에르미트의 스펙트럼 정리를 일반화하면:

> **정규 행렬 스펙트럼 정리**  
> $$A$$가 정규이면, **유니터리** $$U$$ 와 대각 $$\Lambda$$ 가 존재하여
> $$
> \boxed{A = U \Lambda U^*}
> $$
> 이다. 여기서 $$U$$의 열벡터는 **서로 직교(정규직교)**하는 **고유벡터**, $$\Lambda=\operatorname{diag}(\lambda_1,\dots,\lambda_n)$$ 는 **고유값**이다.

**즉, 정규 ⇔ 유니터리 대각화 가능.**  
(정규가 아니면 일반적으로 조르당(상삼각)까지만 가능)

---

## 3) 정규 행렬의 동치 조건(알아두면 실전에서 편함)

다음은 서로 동치입니다(복소에서):

1. $$AA^*=A^*A$$ (**정규**)  
2. (슈어 분해 관점) $$A=Q T Q^*$$ (유니터리 슈어)에서 **상삼각** $$T$$ 가 실제로 **대각**  
3. 임의의 벡터 $$x$$에 대해 $$\|Ax\|_2 = \|A^*x\|_2$$  
4. 서로 다른 고유값에 대응하는 고유벡터가 **항상 직교**  
5. 어떤 다항식 $$p$$에 대해 $$p(A)$$의 노름 특성들이 고유값에 의해 깔끔히 제어됨(함수해석 관점)

> 실무 체크: 2-노름에서 $$\|A\|_2 = \sqrt{\lambda_{\max}(A^*A)}$$. 정규면 **특이값**이 **고유값의 절댓값**과 일치.

---

## 4) 유니터리 행렬의 핵심 성질

- **길이·내적 보존**  
  $$\|Ux\|_2=\|x\|_2,\quad \langle Ux,Uy\rangle = \langle x,y\rangle.$$
- **고유값**은 $$|\lambda|=1$$. **행렬식**도 $$|\det U|=1$$.  
- **SVD와 일치**: 유니터리는 SVD에서 특이값이 전부 1.  
- **수치 안정성**: 선형대수 알고리즘(사전/후처리, 정규화)에서 선호.

---

## 5) 함수 계산(Functional Calculus) & 스펙트럼 분해

정규 $$A=U\Lambda U^*$$, 충분히 좋은(해석적) 함수 $$f$$에 대해:
$$
\boxed{f(A)=U\,f(\Lambda)\,U^* = \sum_{i=1}^n f(\lambda_i)\,u_i u_i^*}
$$
- 지수, 코사인, 다항식, 역행렬(가역 시) 등 **고유값에 스칼라 함수 적용** 후 재조립.

---

## 6) 폴라 분해(Polar Decomposition)와 정규성

임의의 $$A$$에 대해 **폴라 분해**:
$$
A = U H,\quad U:\ \text{유니터리},\ H=(A^*A)^{1/2}\ \text{(PSD)}.
$$
- $$A$$가 **정규**이면 **$$U$$와 $$H$$가 가환**하며, 동시에 대각화 가능 → 구조 분석이 쉬워짐.
- PSD $$H$$의 고유값 = $$A$$의 **특이값**.

---

## 7) 동시 유니터리 대각화(Commuting Normal)

서로 **가환하는 정규 행렬** $$A,B$$ (즉, $$AB=BA$$)은 **동시에 유니터리 대각화 가능**.  
→ 스펙트럼 기반의 **공동 분석**(예: 여러 관측량이 동시에 “대각”인 좌표계).

---

## 8) 예와 반예

- **정규 & 유니터리**: 모든 유니터리는 정규 (⊂). 예) 회전/푸리에 변환 행렬.
- **정규이지만 유니터리 아님**: $$\operatorname{diag}(2,\,i,\,\tfrac12)$$ (대각행렬이니 정규, 특이값 ≠ 1).
- **정규이지만 에르미트 아님**: $$\operatorname{diag}(1,\,i)$$ (자기수반 아님, 그러나 정규).
- **비정규(대각화 불가 사례)**: 조르당 블록  
  $$J=\begin{bmatrix}1&1\\0&1\end{bmatrix}\ \Rightarrow\ JJ^*\ne J^*J.$$

---

## 9) 수치 실습 (NumPy): 정규·유니터리 판정, 대각화, SVD 비교

> 아래 코드는 **완전 실행형** 예제입니다. (NumPy만 사용)

```python
import numpy as np

def is_normal(A, tol=1e-10):
    return np.linalg.norm(A @ A.conj().T - A.conj().T @ A) <= tol

def is_unitary(U, tol=1e-10):
    n = U.shape[0]
    I = np.eye(n, dtype=U.dtype)
    return (np.linalg.norm(U.conj().T @ U - I) <= tol and
            np.linalg.norm(U @ U.conj().T - I) <= tol)

def unitary_eig(A):
    # 유니터리 대각화 (정규일 때 eig로 충분)
    # eigh는 에르미트 전용, 여기서는 일반 복소 정규 가능성을 위해 eig 사용
    w, V = np.linalg.eig(A)
    # V는 일반적으로 유니터리 아님 → 칼럼 정규화(수치 안정 위해 QR 권장 가능)
    # 정규면 이 V는 유니터리까지 조정 가능(수치 오차 내)
    # 검증: V^{-1} A V = diag(w)
    return w, V

# 1) 정규 & 비유니터리 예: 대각행렬
A = np.diag([2, 1j, 0.5])
print("A normal?", is_normal(A))
print("A unitary?", is_unitary(A))

w, V = unitary_eig(A)
Lambda = np.diag(w)
recon = V @ Lambda @ np.linalg.inv(V)
print("||A - VΛV^{-1}||_F =", np.linalg.norm(A - recon, 'fro'))

# 2) 유니터리 예: 2D 회전(실수 직교는 복소에서 유니터리)
theta = np.deg2rad(30)
U = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]], dtype=complex)
print("\nU unitary?", is_unitary(U))
Uw, UV = np.linalg.eig(U)
print("eig(U) (unit circle?):", Uw)

# 3) 비정규 예: 조르당 블록
J = np.array([[1,1],
              [0,1]], dtype=complex)
print("\nJ normal?", is_normal(J))
Jw, JV = np.linalg.eig(J)
print("eig(J):", Jw)

# 4) 정규면 특이값 = |고유값|
Aw, _ = np.linalg.eig(A)
s = np.linalg.svd(A, compute_uv=False)
print("\n정규 A에서 |eig(A)| vs svd(A):")
print(" |eig(A)| =", np.sort(np.abs(Aw))[::-1])
print(" svd(A)   =", np.sort(s)[::-1])
```

**포인트**
- `is_normal`, `is_unitary` 로 빠른 판정
- 정규 $$A$$ 에서는 `np.linalg.eig(A)`의 고유값 절댓값이 `svd(A)` 특이값과 동일
- 유니터리 $$U$$의 고유값은 모두 **단위원** 위(출력 확인)

---

## 10) 유니터리 행렬 생성(무작위)과 QR

복소 난수 행렬 $$Z$$에 QR 분해를 적용하면 **유니터리** $$Q$$를 얻을 수 있습니다.

```python
np.random.seed(7)
Z = np.random.randn(4,4) + 1j*np.random.randn(4,4)
Q, R = np.linalg.qr(Z)  # 복소 QR
# 대각부의 위상 보정(관례적으로)
D = np.diag(np.exp(1j*np.angle(np.diag(R))))
U_rand = Q @ D.conj()   # 역시 유니터리
print("U_rand unitary?", is_unitary(U_rand))
```

---

## 11) 실전 응용 메모

| 분야 | 왜 중요한가 | 핵심 포인트 |
|---|---|---|
| **양자역학** | 시간 진화/게이트는 **유니터리** | 확률 보존, 고유값 단위원 |
| **신호처리/통신** | DFT/IDFT, MIMO 예비코딩 | 푸리에 행렬은 유니터리(스케일 포함) |
| **수치선형대수** | 안정성/조건수 | 유니터리는 2-조건수 1, 오차에 강함 |
| **머신러닝** | RNN/순환 모델 안정화 | 유니터리/직교 가중치 → 그래디언트 폭주/소실 완화 |
| **스펙트럴 기법** | 함수계산/필터링/그래프 | 정규 ⇒ 유니터리 대각화 ⇒ 축별 필터 |

---

## 12) 자주 하는 실수 체크리스트

- [ ] **정규**라고 해서 고유값이 실수인 것은 아님(그건 에르미트).  
- [ ] **유니터리 ⊂ 정규**: 유니터리는 항상 정규지만, 정규가 유니터리는 아님.  
- [ ] 대각화 가능과 **유니터리 대각화**를 혼동(정규일 때만 유니터리 대각화 보장).  
- [ ] 정규 여부를 확인하지 않고 **임의의 상사변환**으로 대각화 시도(수치 불안정).  
- [ ] 실수 직교 = 유니터리(복소 확장)임을 잊음.

---

## 13) 요약 표

| 개념 | 정의 | 대각화 | 고유값 | 대표 성질 |
|---|---|---|---|---|
| **정규** | $$AA^*=A^*A$$ | **유니터리 대각화 가능** | 일반적으로 복소 | 특이값 = $$|\lambda_i|$$, 서로 다른 고유값의 고유벡터 직교 |
| **유니터리** | $$U^*U=I$$ | 자체가 “길이 보존” 변환 | $$|\lambda|=1$$ | 내적/길이 보존, 조건수 1 |
| **에르미트** | $$A=A^*$$ | 유니터리 대각화 | **실수** | PSD/NSD 구분, 함수계산 용이 |

---

## 14) 심화: 왜 정규 ⇔ 유니터리 대각화?

- (⇒) 정규이면 슈어 분해 $$A=Q T Q^*$$ 에서 $$T$$ 상삼각. 정규성은 $$TT^*=T^*T$$ 를 강제하고, 상삼각이 정규이면 **대각**이어야 함 → $$T=\Lambda$$.  
- (⇐) 반대로 $$A=U\Lambda U^*$$이면 자명하게 $$AA^*=A^*A$$가 성립.

---

## 15) 작은 실습 과제

1) 서로 **가환하는** 정규 행렬 두 개를 만들어 `np.linalg.eig` 로 동시에 대각화가 가능한지(공통 고유벡터 기저) 확인.  
2) 정규가 아닌 행렬에 파워메서드/QR 알고리즘을 적용해 조르당 성분의 수치적 영향(수렴 패턴)을 관찰.  
3) PSD 행렬의 **행렬 제곱근**을 스펙트럼 분해로 구현하고 `sqrtm`(있다면)과 비교.

---

## 16) 마무리 한 줄

**정규**는 “**유니터리 대각화** 가능성”을, **유니터리**는 “**길이·내적 보존**”을 상징합니다.  
두 개념을 잡아두면 스펙트럼 기반의 해석, 안정적인 수치 계산, 그리고 응용(신호·통신·양자·ML)까지 **하나의 통일된 언어**로 풀 수 있습니다.