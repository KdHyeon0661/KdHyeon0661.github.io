---
layout: post
title: C# - ë©€í‹°ìŠ¤ë ˆë”©ê³¼ ë¹„ë™ê¸° ë³‘ë ¬ ì²˜ë¦¬
date: 2024-10-22 19:20:23 +0900
category: Csharp
---
# C# ë©€í‹°ìŠ¤ë ˆë”©ê³¼ ë¹„ë™ê¸° ë³‘ë ¬ ì²˜ë¦¬ (Thread, Task, async/await, lock ì™„ì „ ì •ë¦¬)

C#ì—ì„œëŠ” ë©€í‹°ìŠ¤ë ˆë”©ê³¼ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ í†µí•´ **UI ì‘ë‹µì„± ìœ ì§€**, **ë³‘ë ¬ ì‘ì—… ì²˜ë¦¬**, **IO ëŒ€ê¸° ì‹œê°„ ë‹¨ì¶•**ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
ì´ë²ˆ ê¸€ì—ì„œëŠ” Thread, Task, async/await, ë³‘ë ¬ ë£¨í”„, lock ë“±ì„ ì°¨ê·¼íˆ ì •ë¦¬í•©ë‹ˆë‹¤.

---

## ğŸ”· 1. Thread â€“ ì „í†µì ì¸ ë©€í‹°ìŠ¤ë ˆë“œ

```csharp
using System.Threading;

Thread t = new Thread(() =>
{
    Console.WriteLine("ìŠ¤ë ˆë“œ ì‹¤í–‰ ì¤‘...");
});
t.Start();
```

> `Thread`ëŠ” ì§ì ‘ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ì œì–´ëŠ” ë§ì§€ë§Œ ë¬´ê²ê³  ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## ğŸ”· 2. Task â€“ ê¸°ë³¸ ë¹„ë™ê¸° ë‹¨ìœ„

```csharp
using System.Threading.Tasks;

Task t = Task.Run(() =>
{
    Console.WriteLine("Task ì‘ì—… ì‹¤í–‰ ì¤‘...");
});
await t;
```

### âœ… ë°˜í™˜ê°’ì´ ìˆëŠ” Task

```csharp
Task<int> task = Task.Run(() => 1 + 2);
int result = await task; // 3
```

---

## ğŸ”· 3. async / await â€“ ë¹„ë™ê¸° í•¨ìˆ˜ ì •ì˜

### âœ… ê¸°ë³¸ êµ¬ì¡°

```csharp
async Task SayHelloAsync()
{
    await Task.Delay(1000); // 1ì´ˆ ëŒ€ê¸°
    Console.WriteLine("Hello async!");
}

await SayHelloAsync();
```

- `Task`: ë°˜í™˜ê°’ ì—†ìŒ
- `Task<T>`: ë°˜í™˜ê°’ ìˆìŒ
- `await`: í•´ë‹¹ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼

> UI ì“°ë ˆë“œë¥¼ ë§‰ì§€ ì•Šê¸° ë•Œë¬¸ì— **ìœˆë„ìš° ì•±, ì›¹ ì•±ì— í•„ìˆ˜**ì…ë‹ˆë‹¤.

---

## ğŸ”· 4. ë³‘ë ¬ ì²˜ë¦¬ (Parallel.For / Parallel.ForEach)

### âœ… ë³‘ë ¬ ë°˜ë³µë¬¸

```csharp
Parallel.For(0, 5, i =>
{
    Console.WriteLine($"Index: {i}");
});
```

```csharp
var list = new List<string> { "A", "B", "C" };

Parallel.ForEach(list, item =>
{
    Console.WriteLine(item);
});
```

> ë³‘ë ¬ ë°˜ë³µì€ CPU ì½”ì–´ë¥¼ í™œìš©í•´ **ë¹ ë¥´ê²Œ ëŒ€ëŸ‰ ì‘ì—…ì„ ì²˜ë¦¬**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ”· 5. lock â€“ ìŠ¤ë ˆë“œ ê°„ ê³µìœ  ìì› ë³´í˜¸

ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ìì›ì„ ë³´í˜¸í•˜ë ¤ë©´ `lock`ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```csharp
object locker = new object();
int counter = 0;

Parallel.For(0, 1000, i =>
{
    lock (locker)
    {
        counter++;
    }
});

Console.WriteLine(counter); // 1000
```

---

## ğŸ”· 6. CancellationToken â€“ ë¹„ë™ê¸° ì‘ì—… ì·¨ì†Œ

```csharp
CancellationTokenSource cts = new CancellationTokenSource();

Task t = Task.Run(() =>
{
    while (!cts.Token.IsCancellationRequested)
    {
        // ì‘ì—… ìˆ˜í–‰
    }
}, cts.Token);

// ë‚˜ì¤‘ì— ì·¨ì†Œ
cts.Cancel();
```

---

## âœ… ìš”ì•½ ì •ë¦¬

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| `Thread` | ì§ì ‘ ìŠ¤ë ˆë“œ ìƒì„±. ì œì–´ ê°€ëŠ¥, ë¬´ê±°ì›€ |
| `Task` | ê²½ëŸ‰ ìŠ¤ë ˆë“œ ì‘ì—… ë‹¨ìœ„. `Run()`, `Delay()` |
| `async/await` | ë¹„ë™ê¸° í•¨ìˆ˜ ì‘ì„±. UI ì‘ë‹µì„± ìœ ì§€ |
| `Parallel.For` | ë³‘ë ¬ ë°˜ë³µ ì²˜ë¦¬ |
| `lock` | ê³µìœ  ìì› ë™ê¸°í™” |
| `CancellationToken` | ë¹„ë™ê¸° ì‘ì—… ì·¨ì†Œ ì œì–´ |