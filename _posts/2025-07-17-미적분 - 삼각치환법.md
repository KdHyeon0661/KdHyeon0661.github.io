---
layout: post
title: 미적분 - 삼각치환법
date: 2025-07-17 17:20:23 +0900
category: 미적분
---
# 삼각치환법 (Trigonometric Substitution)


## 1) 왜 삼각치환인가? (직관과 한 줄 요약)

루트 안의 **2차식**이 등장하는 적분(예: $$\sqrt{a^2-x^2},\ \sqrt{a^2+x^2},\ \sqrt{x^2-a^2}$$)을
삼각함수의 피타고라스 항등식
$$
\sin^2\theta+\cos^2\theta=1,\quad \sec^2\theta-\tan^2\theta=1
$$
로 **완벽한 제곱** 형태로 바꿔 **루트를 제거**하는 기법입니다.

핵심 공식(외워두기):
- $$x=a\sin\theta\ \Rightarrow\ \sqrt{a^2-x^2}=a\cos\theta$$
- $$x=a\tan\theta\ \Rightarrow\ \sqrt{a^2+x^2}=a\sec\theta$$
- $$x=a\sec\theta\ \Rightarrow\ \sqrt{x^2-a^2}=a\tan\theta$$

> 단, 항상 **역치환**(최종답을 $$x$$로 환원)과 **부호/절댓값**을 주의합니다.

---

## 2) 세 가지 표준 패턴(+ 권장 θ-구간)

아래에서 $$a>0$$ 가정.

### (A) $$\sqrt{a^2-x^2}$$ — 원/호, 반원 면적 등
- **치환**: $$x=a\sin\theta,\quad \theta\in\big[-\frac{\pi}{2},\frac{\pi}{2}\big]$$  
  (이 구간에서 $$\cos\theta\ge 0$$ → 루트가 자연스럽게 양수)
- **관계**: $$dx=a\cos\theta\,d\theta,\quad \sqrt{a^2-x^2}=a\cos\theta$$

### (B) $$\sqrt{a^2+x^2}$$ — 원뿔/사선 길이형
- **치환**: $$x=a\tan\theta,\quad \theta\in\big(-\frac{\pi}{2},\frac{\pi}{2}\big)$$
- **관계**: $$dx=a\sec^2\theta\,d\theta,\quad \sqrt{a^2+x^2}=a\sec\theta$$

### (C) $$\sqrt{x^2-a^2}$$ — 쌍곡형, 원 밖
- **치환**: $$x=a\sec\theta,\quad \theta\in[0,\pi]\setminus\{\frac{\pi}{2}\}$$
- **관계**: $$dx=a\sec\theta\tan\theta\,d\theta,\quad \sqrt{x^2-a^2}=a\tan\theta$$

> 기억법: **루트 안의 부호**를 보고 $$\sin,\tan,\sec$$ 중 무엇이 자연스러운지 연결합니다.  
> (또는 **쌍곡선 치환**을 선택하면 절댓값 처리 없이도 매끈하게 갈 수 있습니다. §7 참조)

---

## 3) 빠른 결정표 (Decision Table)

| 루트(또는 제곱) 패턴 | 1차 치환 선택 | 도우미 항등식 | 전형 응용 |
|---|---|---|---|
| $$\sqrt{a^2-x^2}$$ | $$x=a\sin\theta$$ | $$1-\sin^2=\cos^2$$ | 호/원, 반원 면적, $$\arcsin$$ |
| $$\sqrt{a^2+x^2}$$ | $$x=a\tan\theta$$ | $$1+\tan^2=\sec^2$$ | 경사 길이, 로그 포함 원시 |
| $$\sqrt{x^2-a^2}$$ | $$x=a\sec\theta$$ | $$\sec^2-\tan^2=1$$ | 외부 영역, 로그 포함 원시 |
| $$\sqrt{\alpha x^2+\beta x+\gamma}$$ | 완전제곱 완성 후 위 표 적용 | 완전제곱 $$=(x-h)^2+k$$ | 일반 2차식 |
| $$\dfrac{1}{x\sqrt{x^2-a^2}}$$ | $$x=a\sec\theta$$ (또는 쌍곡) | $$dx=a\sec\tan\,d\theta$$ | $$\operatorname{arcsec}$$/로그 |

---

## 4) 기본 예제 (부정적분): 전개·역치환까지

### 예제 1. $$\displaystyle \int \frac{1}{\sqrt{a^2-x^2}}\,dx$$
- 치환: $$x=a\sin\theta\Rightarrow dx=a\cos\theta\,d\theta$$
- 적분:
$$
\int \frac{1}{\sqrt{a^2-x^2}}\,dx
=\int \frac{1}{a\cos\theta}\cdot a\cos\theta\,d\theta
=\int d\theta=\theta+C.
$$
- 역치환: $$\theta=\arcsin(x/a)$$  
**결과**: $$\boxed{\int \frac{dx}{\sqrt{a^2-x^2}}=\arcsin\!\frac{x}{a}+C}$$

---

### 예제 2. $$\displaystyle \int \sqrt{a^2-x^2}\,dx$$
- 같은 치환. 계산:
$$
\int a\cos\theta\cdot a\cos\theta\,d\theta
=a^2\int \cos^2\theta\,d\theta
=\frac{a^2}{2}\int(1+\cos2\theta)\,d\theta.
$$
- 원시:
$$
=\frac{a^2}{2}\Big(\theta+\frac{\sin2\theta}{2}\Big)+C
=\frac{a^2}{2}\theta+\frac{a^2}{4}\sin2\theta+C.
$$
- 역삼각(삼각형 도움):  
  $$\sin\theta=\frac{x}{a}\ \Rightarrow\ \cos\theta=\frac{\sqrt{a^2-x^2}}{a},\quad \sin2\theta=2\sin\theta\cos\theta=\frac{2x\sqrt{a^2-x^2}}{a^2}.$$
- 정리:
$$
\boxed{\int \sqrt{a^2-x^2}\,dx=\frac{x}{2}\sqrt{a^2-x^2}+\frac{a^2}{2}\arcsin\!\frac{x}{a}+C}
$$

---

### 예제 3. $$\displaystyle \int \frac{dx}{(a^2+x^2)^{3/2}}$$
- 치환: $$x=a\tan\theta,\ dx=a\sec^2\theta\,d\theta,\ (a^2+x^2)^{1/2}=a\sec\theta$$
- 계산:
$$
\int \frac{a\sec^2\theta}{(a^2\sec^2\theta)^{3/2}}\,d\theta
=\int \frac{a\sec^2\theta}{a^3\sec^3\theta}\,d\theta
=\frac{1}{a^2}\int \cos\theta\,d\theta
=\frac{1}{a^2}\sin\theta+C.
$$
- 역치환: $$\tan\theta=\frac{x}{a}\ \Rightarrow\ \sin\theta=\frac{x}{\sqrt{a^2+x^2}}.$$
- 결과:
$$
\boxed{\int \frac{dx}{(a^2+x^2)^{3/2}}=\frac{x}{a^2\sqrt{a^2+x^2}}+C}
$$

---

### 예제 4. $$\displaystyle \int \sqrt{x^2+a^2}\,dx$$
- 같은 치환:
$$
\int a\sec\theta\cdot a\sec^2\theta\,d\theta
=a^2\int \sec^3\theta\,d\theta.
$$
- 표준 원시: $$\int \sec^3\theta\,d\theta=\frac12\sec\theta\tan\theta+\frac12\ln|\sec\theta+\tan\theta|+C.$$
- 대입 및 정리:
$$
\boxed{\int \sqrt{x^2+a^2}\,dx=\frac{x}{2}\sqrt{x^2+a^2}+\frac{a^2}{2}\ln\!\big|x+\sqrt{x^2+a^2}\big|+C}
$$

---

### 예제 5. $$\displaystyle \int \sqrt{x^2-a^2}\,dx$$
- 치환: $$x=a\sec\theta.$$
- 유도 결과(유사 전개, 생략):
$$
\boxed{\int \sqrt{x^2-a^2}\,dx=\frac{x}{2}\sqrt{x^2-a^2}-\frac{a^2}{2}\ln\!\big|x+\sqrt{x^2-a^2}\big|+C}
$$

---

### 예제 6. $$\displaystyle \int \frac{dx}{x\sqrt{x^2-a^2}}$$
- 치환: $$x=a\sec\theta,\ dx=a\sec\theta\tan\theta\,d\theta$$
- 계산:
$$
\int \frac{a\sec\theta\tan\theta}{a\sec\theta\cdot a\tan\theta}\,d\theta=\frac{1}{a}\int d\theta=\frac{\theta}{a}+C.
$$
- 역치환: $$\sec\theta=\frac{x}{a}\Rightarrow \theta=\operatorname{arcsec}\!\Big(\frac{x}{a}\Big)=\arccos\!\Big(\frac{a}{x}\Big)$$ (정의역 주의)
- 결과:
$$
\boxed{\int \frac{dx}{x\sqrt{x^2-a^2}}=\frac{1}{a}\,\operatorname{arcsec}\!\Big(\frac{|x|}{a}\Big)+C=\frac{1}{a}\arccos\!\Big(\frac{a}{x}\Big)+C}
$$

---

## 5) 정적분 예제 (한계치 변환/역치환 2법)

### 예제 7. 반원 면적 재도출
$$
\int_{0}^{a}\sqrt{a^2-x^2}\,dx=\frac{\pi a^2}{4}.
$$
- 치환: $$x=a\sin\theta,\ x=0\to\theta=0,\ x=a\to\theta=\frac{\pi}{2}$$
- 계산:
$$
\int_0^{\pi/2} a^2\cos^2\theta\,d\theta
=a^2\cdot\frac12\int_0^{\pi/2}(1+\cos2\theta)\,d\theta
=\frac{a^2}{2}\cdot\frac{\pi}{2}=\frac{\pi a^2}{4}.
$$

### 예제 8. 모멘트류 적분
$$
\int_{0}^{a} x^2\sqrt{a^2-x^2}\,dx
=a^4\int_0^{\pi/2}\sin^2\theta\cos^2\theta\,d\theta
=\frac{\pi a^4}{16}.
$$
(중간: $$\sin^2\theta\cos^2\theta=\frac14\sin^2(2\theta),\ \int_0^{\pi/2}\sin^2(2\theta)\,d\theta=\frac{\pi}{4}$$)

### 예제 9. 외부 영역 관련
$$
\int_{a}^{2a}\frac{dx}{x\sqrt{x^2-a^2}}
=\frac{1}{a}\Big[\operatorname{arcsec}\!\frac{x}{a}\Big]_{a}^{2a}
=\frac{1}{a}\Big(\operatorname{arcsec}2-\operatorname{arcsec}1\Big)
=\frac{1}{a}\Big(\frac{\pi}{3}-0\Big)=\frac{\pi}{3a}.
$$
(여기서 $$\operatorname{arcsec}1=0,\ \operatorname{arcsec}2=\frac{\pi}{3}$$ 적절한 가지 선택)

---

## 6) 일반 2차식 다루기: 완전제곱 → 표준형

루트 안이 $$\alpha x^2+\beta x+\gamma$$ 라면 먼저 **완전제곱**:
$$
\alpha x^2+\beta x+\gamma=\alpha\Big[(x+\tfrac{\beta}{2\alpha})^2+\Big(\tfrac{\gamma}{\alpha}-\tfrac{\beta^2}{4\alpha^2}\Big)\Big].
$$
- 괄호 안의 상수부 부호를 보고 §2의 (A)–(C)에 매칭.
- 예: $$\int\frac{dx}{\sqrt{x^2+bx+c}}\Rightarrow x+h=u,\ u^2+k$$ 꼴로 정리 후 $$u=\sqrt{k}\tan\theta$$.

**예제 10.**  
$$
\int\frac{dx}{\sqrt{x^2+4x+13}}
=\int\frac{dx}{\sqrt{(x+2)^2+9}}.
$$
치환 $$u=x+2,\ u=3\tan\theta$$ → §2(B)로 처리,  
원시: $$\ln\big|u+\sqrt{u^2+9}\big|=\ln\big|x+2+\sqrt{x^2+4x+13}\big|+C.$$

---

## 7) 쌍곡선 치환(대체 전략): 절댓값/각도 고민 ↓

삼각치환의 대안으로 **쌍곡선 함수**를 쓰면 절댓값 처리와 각도 범위 고민이 단순해지는 경우가 많습니다.

- **대안1**: $$\sqrt{a^2+x^2}$$ → $$x=a\sinh u$$  
  $$dx=a\cosh u\,du,\ \sqrt{a^2+x^2}=a\cosh u.$$
  - 예제 4의 결과가 곧바로
    $$
    \int a\cosh u\cdot a\cosh u\,du=a^2\int\cosh^2u\,du
    $$
    로 변해 전개가 깔끔. 역치환: $$u=\operatorname{arsinh}(x/a)=\ln\!\big(\frac{x}{a}+\sqrt{1+(x/a)^2}\big).$$

- **대안2**: $$\sqrt{x^2-a^2}$$ → $$x=a\cosh u$$  
  $$dx=a\sinh u\,du,\ \sqrt{x^2-a^2}=a\sinh u.$$
  - 예제 5 유도에서 로그 항이 자연스레 등장.

> 팁: 공학/수치에서 쌍곡선 치환은 수식 안정성과 구현상의 단순성 때문에 선호되기도 합니다.

---

## 8) 자주 출현하는 원시(암기 추천)

- $$\displaystyle \int \sqrt{a^2-x^2}\,dx=\frac{x}{2}\sqrt{a^2-x^2}+\frac{a^2}{2}\arcsin\!\frac{x}{a}+C$$
- $$\displaystyle \int \sqrt{x^2+a^2}\,dx=\frac{x}{2}\sqrt{x^2+a^2}+\frac{a^2}{2}\ln\!\big|x+\sqrt{x^2+a^2}\big|+C$$
- $$\displaystyle \int \sqrt{x^2-a^2}\,dx=\frac{x}{2}\sqrt{x^2-a^2}-\frac{a^2}{2}\ln\!\big|x+\sqrt{x^2-a^2}\big|+C$$
- $$\displaystyle \int \frac{dx}{(a^2+x^2)^{3/2}}=\frac{x}{a^2\sqrt{a^2+x^2}}+C$$
- $$\displaystyle \int \frac{dx}{x\sqrt{x^2-a^2}}=\frac{1}{a}\operatorname{arcsec}\!\frac{|x|}{a}+C=\frac{1}{a}\arccos\!\frac{a}{x}+C$$

---

## 9) 역치환을 빠르게: 삼각형(또는 쌍곡선) 도식

- (A) $$x=a\sin\theta$$: 직각삼각형에서 **빗변** $$a$$, **높이** $$x$$ → 밑변 $$\sqrt{a^2-x^2}$$  
  $$\cos\theta=\dfrac{\sqrt{a^2-x^2}}{a},\ \tan\theta=\dfrac{x}{\sqrt{a^2-x^2}}.$$

- (B) $$x=a\tan\theta$$: 밑변 $$a$$, 높이 $$x$$, 빗변 $$\sqrt{a^2+x^2}$$  
  $$\sec\theta=\dfrac{\sqrt{a^2+x^2}}{a},\ \sin\theta=\dfrac{x}{\sqrt{a^2+x^2}}.$$

- (C) $$x=a\sec\theta$$: 밑변 $$a$$, 빗변 $$x$$, 높이 $$\sqrt{x^2-a^2}$$  
  $$\tan\theta=\dfrac{\sqrt{x^2-a^2}}{a},\ \sec\theta=\dfrac{x}{a}.$$

쌍곡선은
- $$x=a\sinh u\Rightarrow \cosh u=\dfrac{\sqrt{a^2+x^2}}{a}$$
- $$x=a\cosh u\Rightarrow \sinh u=\dfrac{\sqrt{x^2-a^2}}{a}$$
를 바로 써서 역치환.

---

## 10) 함정·실수 체크리스트

- **절댓값/부호**: $$\ln|x+\sqrt{\cdots}|$$ 에서 **절댓값**을 빼먹지 않기.
- **θ 범위**: $$x=a\sin\theta$$ 선택 시 $$\theta\in[-\frac{\pi}{2},\frac{\pi}{2}]$$로 잡아 $$\cos\theta\ge0$$ 보장.
- **역치환 누락**: 최종 답을 반드시 $$\theta,u$$가 아닌 $$x$$로!
- **완전제곱 미실시**: 일반 2차식에서 바로 치환 시 모양이 덜 정리돼 오류 발생.
- **정적분 상한/하한**: 변수 바꾼 뒤 **구간도 함께** 변환하거나, 끝에서 역치환 후 원래 구간 사용.
- **$a$의 부호**: 보통 $$a>0$$ 가정. 음수면 $$|a|$$로 재정의해 적용.

---

## 11) 실전 연습문제 (풀이 포함/스케치)

1) $$\displaystyle \int \frac{dx}{\sqrt{9-x^2}}$$  
**해**: $$x=3\sin\theta\Rightarrow \arcsin(x/3)+C.$$

2) $$\displaystyle \int \sqrt{4+x^2}\,dx$$  
**해**: 표준 원시 → $$\frac{x}{2}\sqrt{4+x^2}+2\ln\big|x+\sqrt{4+x^2}\big|+C.$$

3) $$\displaystyle \int_{0}^{2} \frac{x^2}{\sqrt{9+x^2}}\,dx$$  
**스케치**: $$x=3\tan\theta,\ dx=3\sec^2\theta d\theta,\ \sqrt{9+x^2}=3\sec\theta.$$  
적분: $$\int \frac{9\tan^2\theta\cdot 3\sec^2\theta}{3\sec\theta}\,d\theta=\int 9\tan^2\theta\sec\theta\,d\theta$$  
를 $$\tan^2=\sec^2-1$$로 분해해 처리 후 역치환.

4) $$\displaystyle \int \frac{dx}{x\sqrt{x^2-16}}$$  
**해**: $$\frac{1}{4}\operatorname{arcsec}\!\frac{|x|}{4}+C=\frac{1}{4}\arccos\!\frac{4}{x}+C.$$

5) $$\displaystyle \int \frac{dx}{\sqrt{x^2+6x+13}}$$  
**해**: 완전제곱 $$=(x+3)^2+4$$ → $$\ln\big|x+3+\sqrt{(x+3)^2+4}\big|+C.$$

---

## 12) 파이썬으로 결과 검산(선택: SymPy/수치)

> 아래 코드는 로컬/노트북 환경에서 검산용으로 실행하세요.

```python
# 심볼릭: 원시 미분해 확인
import sympy as sp
x,a = sp.symbols('x a', positive=True)
expr = sp.sqrt(a**2 - x**2)
F = x*sp.sqrt(a**2 - x**2)/2 + a**2*sp.asin(x/a)/2
print(sp.simplify(sp.diff(F, x) - expr))  # 0 이면 일치
```

```python
# 수치적분 vs 원시함수 비교: \int_0^a sqrt(a^2-x^2) dx = \pi a^2 / 4
import mpmath as mp
def area(a):
    f=lambda t: mp.sqrt(a*a - t*t)
    return mp.quad(f, [0, a])
for A in [1,2,3]:
    print(A, area(A), "target", mp.pi*A*A/4)
```

```python
# \int dx / (a^2 + x^2)^(3/2) 결과 검산
x,a = sp.symbols('x a', positive=True)
expr = 1/sp.sqrt(a**2+x**2)**3
F = x/(a**2*sp.sqrt(a**2+x**2))
print(sp.simplify(sp.diff(F, x) - expr))  # 0
```

---

## 13) 마무리 요약

- **패턴 매칭**이 반이다: $$\sqrt{a^2-x^2}\leftrightarrow \sin,\ \sqrt{a^2+x^2}\leftrightarrow \tan,\ \sqrt{x^2-a^2}\leftrightarrow \sec.$$
- 일반 2차식은 **완전제곱** 후 매칭.
- 절댓값/역치환/구간변환을 항상 점검.
- 구현/공학에서는 **쌍곡선 치환**(sinh, cosh)이 간결한 경우가 많다.
- 필요 원시 공식 5개는 **암기**해 두면 현장에서 매우 빠르게 풀린다.