---
layout: post
title: 미적분 - Σ를 통한 합의 표현
date: 2025-08-02 22:20:23 +0900
category: 미적분
---
# 시그마 기호(Σ)를 통한 합의 표현

시그마 \( \displaystyle\sum \) 표기법은 **많은 항의 합**을 간결하게 표현하고 다루기 위한 핵심 도구입니다.  

---

## 0. 표기·관례(빈 합, 인덱스, 재색인)

- **기본형식**  
  \[
  \sum_{i=m}^{n} a_i \;=\; a_m+a_{m+1}+\cdots+a_n \quad (m\le n).
  \]
- **빈 합(Empty sum)**: \(m>n\)이면 관례적으로 \(\sum_{i=m}^{n}a_i=0\) 로 둡니다.
- **인덱스(더미 변수)**는 이름이 중요치 않습니다.  
  \(\sum_{i=1}^{n}a_i = \sum_{k=1}^{n}a_k\).
- **재색인(변수 치환)**은 합을 단순화하는 강력한 도구입니다.  
  예: \(\displaystyle \sum_{k=0}^{n-1} f(2k+1)\) (홀수 항만 더하기).

---

## 1. 기초 성질(선형성·분배·범위 분할·역순)

- **선형성/분배**
  \[
  \sum_{i=m}^{n}( \alpha a_i+\beta b_i )=\alpha \sum_{i=m}^{n}a_i+\beta \sum_{i=m}^{n}b_i.
  \]
- **범위 분할**
  \[
  \sum_{i=m}^{n}a_i=\sum_{i=m}^{k}a_i+\sum_{i=k+1}^{n}a_i \quad (m\le k<n).
  \]
- **역순(인덱스 뒤집기)**  
  \(\displaystyle \sum_{i=0}^{n} a_{n-i}=\sum_{i=0}^{n} a_i\).
- **상수 인수 분리**
  \(\displaystyle \sum c\,a_i=c\sum a_i\).

**예제 1**  
\[
\sum_{k=1}^{10}(3k+2)=3\sum_{k=1}^{10}k+2\sum_{k=1}^{10}1
=3\cdot\frac{10\cdot 11}{2}+2\cdot 10=165+20=185.
\]

---

## 2. 기초 합 공식(암기·유도·활용)

| 합 | 닫힌형(Closed Form) |
|---|---|
| \(\displaystyle \sum_{k=1}^{n} 1\) | \(n\) |
| \(\displaystyle \sum_{k=1}^{n} k\) | \(\displaystyle \frac{n(n+1)}{2}\) (삼각수) |
| \(\displaystyle \sum_{k=1}^{n} k^2\) | \(\displaystyle \frac{n(n+1)(2n+1)}{6}\) |
| \(\displaystyle \sum_{k=1}^{n} k^3\) | \(\displaystyle \left(\frac{n(n+1)}{2}\right)^2\) |
| \(\displaystyle \sum_{k=0}^{n} r^k\) | \(\displaystyle \frac{1-r^{n+1}}{1-r}\) (\(r\neq 1\)) |
| \(\displaystyle \sum_{k=0}^{n} k r^k\) | \(\displaystyle \frac{r - (n+1)r^{n+1} + n r^{n+2}}{(1-r)^2}\) (\(r\neq 1\)) |

- **짝수/홀수 합**
  \[
  \sum_{k=1}^{n} (2k)=n(n+1),\qquad
  \sum_{k=1}^{n} (2k-1)=n^2.
  \]

**예제 2**  
\(\displaystyle \sum_{k=1}^{100} k^2=\frac{100\cdot 101\cdot 201}{6}=338{,}350.\)

---

## 3. 망원(텔레스코핑) 합 — 부분분수·차분으로 사라지게!

- **핵심 아이디어**: \(a_k\)를 \(b_k-b_{k+1}\)로 표현하면 중간항이 소거(telescope)됩니다.

### 3.1 고전 예제
\[
\sum_{k=1}^{n}\frac{1}{k(k+1)}=\sum_{k=1}^{n}\left(\frac{1}{k}-\frac{1}{k+1}\right)
=1-\frac{1}{n+1}=\frac{n}{n+1}.
\]

### 3.2 조금 응용
\[
\sum_{k=1}^{n}\frac{1}{k(k+2)}
=\frac12\sum_{k=1}^{n}\left(\frac{1}{k}-\frac{1}{k+2}\right)
=\frac12\!\left(1+\frac12-\frac{1}{n+1}-\frac{1}{n+2}\right).
\]

**예제 3(검산)**  
\(n=3\): 좌변 \(\tfrac{1}{1\cdot3}+\tfrac{1}{2\cdot4}+\tfrac{1}{3\cdot5}=\tfrac13+\tfrac18+\tfrac{1}{15}=\tfrac{40}{120}=\tfrac13\).  
우변 \(\frac12(1+\tfrac12-\tfrac14-\tfrac15)=\frac12(\tfrac{30}{20}-\tfrac{9}{20})=\tfrac{21}{40}\)?? → 계산 주의!  
다시: \(\frac12(1+\tfrac12-\tfrac{1}{4}-\tfrac{1}{5})=\frac12(\tfrac{10}{10}+\tfrac{5}{10}-\tfrac{2.5}{10}-\tfrac{2}{10})\)은 혼동이 큼.  
정확히 공통분모 \(20\)로:
\[
\frac12\!\left(\frac{20}{20}+\frac{10}{20}-\frac{5}{20}-\frac{4}{20}\right)
=\frac12\cdot \frac{21}{20}=\frac{21}{40}=0.525.
\]
왼쪽 \(\tfrac13(≈0.333…)\)과 불일치 → 어디가 틀렸나?  
**수정**: \(\tfrac{1}{k(k+2)}=\tfrac12\!\left(\frac{1}{k}-\frac{1}{k+2}\right)\)은 맞습니다.  
그럼 \(n=3\)일 때
\[
\sum_{k=1}^{3}\frac{1}{k(k+2)}
=\frac12\!\left(\left(\frac11-\frac13\right)+\left(\frac12-\frac14\right)+\left(\frac13-\frac15\right)\right)
=\frac12\!\left(1+\frac12-\frac14-\frac15\right).
\]
이제 정확히:
\[
1+\frac12-\frac14-\frac15
=\frac{60}{60}+\frac{30}{60}-\frac{15}{60}-\frac{12}{60}
=\frac{63}{60}=\frac{21}{20},\ \frac12\cdot \frac{21}{20}=\frac{21}{40}.
\]
좌변도 다시 정확히:
\[
\frac{1}{1\cdot 3}+\frac{1}{2\cdot 4}+\frac{1}{3\cdot 5}
=\frac13+\frac18+\frac{1}{15}
=\frac{40}{120}+\frac{15}{120}+\frac{8}{120}
=\frac{63}{120}=\frac{21}{40}.
\]
→ **일치(=0.525)**. (앞선 \(\tfrac13\) 합산이 오류였음. 계산 시 공통분모를 끝까지 확인!)

> **교훈**: 망원합은 공식 자체는 간단하지만, **산술 검산**을 꼭 하자.

---

## 4. 지수·로그·이항계수 합

### 4.1 기하급수/미분 트릭
\[
\sum_{k=0}^{n} r^k=\frac{1-r^{n+1}}{1-r},\quad
\sum_{k=0}^{n} k r^k=\frac{r-(n+1)r^{n+1}+n r^{n+2}}{(1-r)^2}.
\]
- \(|r|<1\)이면 \(\sum_{k=0}^{\infty} r^k=\frac{1}{1-r}\), \(\sum_{k=0}^{\infty} k r^k=\frac{r}{(1-r)^2}\).

### 4.2 이항계수(조합) — “호키스틱”과 순간 암기
\[
\sum_{k=0}^{n} \binom{n}{k}=2^n,\qquad
\sum_{k=0}^{n} k\binom{n}{k}=n\,2^{n-1}.
\]
\[
\sum_{k=r}^{n}\binom{k}{r}=\binom{n+1}{r+1}\quad(\text{Hockey-stick}).
\]
\[
\sum_{k=0}^{n}(-1)^k\binom{n}{k}=(1-1)^n=0.
\]

**예제 4**  
\(\displaystyle \sum_{k=0}^{10} k\binom{10}{k}=10\cdot 2^{9}=5120.\)

---

## 5. 조화·로그형 합과 근사(적분 비교)

- **조화수** \(H_n=\sum_{k=1}^{n}\frac1k\)는 닫힌형이 없고
  \[
  H_n=\ln n + \gamma + \varepsilon_n,\qquad \varepsilon_n\approx \frac{1}{2n}-\frac{1}{12n^2}+\cdots
  \]
  (\(\gamma\)는 오일러–마스케로니 상수)
- **적분 비교**: \(\displaystyle \int_1^{n+1}\frac{dx}{x}\le H_n\le \int_1^{n}\frac{dx}{x}+1\).

**예제 5**  
\(H_{1000}\approx \ln(1000)+\gamma\approx 6.9078+0.5772=7.485\) (실제 \(H_{1000}\approx 7.48547\)).

---

## 6. 조건부 합: 지표함수·아이버슨 괄호·바닥함수

- **아이버슨 괄호** \([P]\): 명제 \(P\)가 참이면 1, 거짓이면 0.
  \[
  \sum_{k=1}^{n} k\,[k\text{ 짝수}] = \sum_{j=1}^{\lfloor n/2\rfloor} 2j
  = \lfloor n/2\rfloor(\lfloor n/2\rfloor+1).
  \]
- **배수 합**
  \[
  \sum_{\substack{1\le k\le n\\ k\equiv 0\pmod m}} f(k)
  =\sum_{j=1}^{\lfloor n/m\rfloor} f(mj).
  \]

**예제 6**  
\(1\)부터 \(100\)까지 3의 배수 합: \(3+6+\cdots+99=3\sum_{j=1}^{33} j=3\cdot \frac{33\cdot 34}{2}=1683.\)

---

## 7. 이중합(중첩 합), 순서 바꾸기, 컨볼루션

### 7.1 유한합에서는 순서 교환 자유
\[
\sum_{i=1}^{n}\sum_{j=1}^{m} a_{ij}
=\sum_{j=1}^{m}\sum_{i=1}^{n} a_{ij}.
\]

**삼각형 영역 재색인 예제**
\[
\sum_{i=1}^{n}\sum_{j=1}^{i} 1
=\sum_{i=1}^{n} i = \frac{n(n+1)}{2}.
\]

### 7.2 대각선(컨볼루션) 합
\[
\sum_{i=0}^{m} a_i b_{m-i} \quad \text{(Cauchy convolution)}.
\]
**예제 7(조합)**  
\(\displaystyle \sum_{k=0}^{m}\binom{r}{k}\binom{s}{m-k}=\binom{r+s}{m}\).

> **무한합은 주의**: 절대수렴이 아니면 순서 바꾸기가 값에 영향을 줄 수 있습니다(Fubini/Tonelli 조건 필요).

---

## 8. 합의 변형 기술(재색인·그룹화·부분합/아벨 변환)

### 8.1 재색인(Change of index)
\[
\sum_{k=1}^{n} f(2k-1)\quad(\text{홀수만}),\qquad
\sum_{k=0}^{n} f(n-k)\quad(\text{역순}).
\]

### 8.2 부분합(Partial sums)과 아벨 변환(Discrete IBP)
- 부분합 \(A_n=\sum_{k=1}^{n} a_k\).  
- **아벨 변환(합을 적분 부분적분에 대응)**
  \[
  \sum_{k=1}^{n} a_k b_k
  = A_n b_n - \sum_{k=1}^{n-1} A_k (b_{k+1}-b_k).
  \]
**예제 8**: \(a_k=1/k,\ b_k=1\)로 \(H_n\)의 추정에 사용 가능.

---

## 9. 리만 합과 적분의 연결(Σ→∫)

- **좌/우 리만합**
  \[
  \int_{a}^{b} f(x)\,dx
  \approx \sum_{k=1}^{n} f\!\big(a+k\Delta x\big)\,\Delta x,\quad \Delta x=\frac{b-a}{n}.
  \]
- **예제 9**  
  \(\displaystyle \int_{0}^{1} x^2 dx=\lim_{n\to\infty}\sum_{k=1}^{n}\left(\frac{k}{n}\right)^2\frac1n=\frac13.\)

---

## 10. 통계·선형대수에서의 Σ

### 10.1 평균·분산
\[
\bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_i,\quad
\operatorname{Var}(X)=\frac{1}{n}\sum_{i=1}^{n}(x_i-\bar{x})^2
=\frac{1}{n}\sum x_i^2-\bar{x}^2.
\]

### 10.2 내적·노름·코시-슈바르츠
\[
\langle \mathbf{x},\mathbf{y}\rangle=\sum_{i=1}^{n} x_i y_i,\quad
\|\mathbf{x}\|^2=\sum x_i^2,\quad
\big(\sum x_i y_i\big)^2\le \big(\sum x_i^2\big)\big(\sum y_i^2\big).
\]

### 10.3 행렬
- 행렬곱: \((AB)_{ij}=\sum_{k} A_{ik}B_{kj}\).
- 트레이스: \(\mathrm{tr}(A)=\sum_{i} A_{ii}\).
- 프로베니우스 노름: \(\|A\|_F^2=\sum_{i,j}A_{ij}^2\).

---

## 11. 알고리즘에서의 Σ — 프리픽스·차분·펜윅트리

### 11.1 프리픽스 합
\[
S[i]=\sum_{k=1}^{i} a[k]\quad\Rightarrow\quad
\sum_{k=L}^{R} a[k]=S[R]-S[L-1].
\]

### 11.2 차분 배열
\[
a[k]=\sum_{i=1}^{k} d[i],\quad d[i]=a[i]-a[i-1],\ a[0]=0.
\]
범위 업데이트에 강력.

### 11.3 2D 프리픽스
\[
S(x,y)=\sum_{i\le x}\sum_{j\le y} a(i,j),\;
\sum_{x_1\le i\le x_2}\sum_{y_1\le j\le y_2} a(i,j)
= \text{사각형 포함-배제}.
\]

---

## 12. 실전 예제 풀이

### 예제 A — 조건부 이중합 단순화
\[
\sum_{i=1}^{n}\sum_{j=1}^{n} [i+j\ \text{짝수}] 
= \sum_{i=1}^{n}\sum_{j=1}^{n} \frac{1+(-1)^{i+j}}{2}
= \frac{n^2}{2}+\frac12\Big(\sum_{i=1}^{n}(-1)^i\Big)\Big(\sum_{j=1}^{n}(-1)^j\Big).
\]
\(\sum_{k=1}^{n}(-1)^k\) 값(0 또는 -1)에 따라 닫힌형을 얻습니다.  
- \(n\) 짝수면 각 합은 0 → 결과 \(n^2/2\).  
- \(n\) 홀수면 각 합은 \(-1\) → 결과 \((n^2+1)/2\).

### 예제 B — 컨볼루션 합(이항의 곱)
\[
\sum_{k=0}^{m}\binom{r}{k}\binom{s}{m-k}=\binom{r+s}{m}.
\]
**조합적 증명**: \(r\)개와 \(s\)개에서 총 \(m\)개 고르는 방법수를 두 가지로 셈.

### 예제 C — 망원·조화 혼합
\[
\sum_{k=1}^{n}\frac{1}{k(k+1)} H_k
= \sum_{k=1}^{n}\left(\frac{1}{k}-\frac{1}{k+1}\right)H_k
= \sum_{k=1}^{n}\frac{H_k}{k}-\sum_{k=1}^{n}\frac{H_k}{k+1}.
\]
두 번째 합을 인덱스 쉬프트하면 깔끔히 소거되어  
\(\displaystyle = \frac{H_n}{n+1}+\sum_{k=1}^{n}\frac{1}{k(k+1)}\) 등으로 정리됩니다(연습).

---

## 13. Python 검산 스니펫(수작업 산술 오류 방지용)

> 간단한 스크립트로 닫힌형을 **랜덤 \(n\)**에서 빠르게 검증하세요.

```python
# 1) 기본 공식 검증
def sum_k(n): return n*(n+1)//2
def sum_k2(n): return n*(n+1)*(2*n+1)//6
def sum_k3(n): return (n*(n+1)//2)**2

for n in [1,2,5,10,100]:
    brute = sum(range(1, n+1))
    assert brute == sum_k(n)
    brute2 = sum(i*i for i in range(1, n+1))
    assert brute2 == sum_k2(n)
    brute3 = sum(i*i*i for i in range(1, n+1))
    assert brute3 == sum_k3(n)

# 2) 망원합 검증: sum_{k=1}^n 1/(k(k+1)) = n/(n+1)
def telescoping(n):
    from fractions import Fraction
    s = sum(Fraction(1, k*(k+1)) for k in range(1, n+1))
    return s

for n in [3,10,50]:
    from fractions import Fraction
    assert telescoping(n) == Fraction(n, n+1)

# 3) 이항계수 항등식 검증: sum k*C(n,k) = n*2^{n-1}
import math
def C(n, k): return math.comb(n, k)

for n in range(1, 12):
    lhs = sum(k*C(n, k) for k in range(n+1))
    rhs = n*(2**(n-1))
    assert lhs == rhs
```

---

## 14. 자주 쓰는 “테크닉 청사진”

1) **먼저 전개/정리**: 상수 끄집어내기, 범위 분할, 역순.  
2) **재색인**: \(k\to n-k\), \(k\to 2k\), \(k\to k-1\) 등.  
3) **망원화 시도**: 부분분수/차분 \(b_k-b_{k+1}\).  
4) **기하급수-미분 트릭**: \(\sum r^k\)에서 양변 미분/곱셈.  
5) **조합 해석**: 이항계수 합은 “선형성 + 세기(Counting)”로 증명.  
6) **컨볼루션 구조**: 인덱스가 합쳐서 상수 될 때.  
7) **리만합/적분 근사**: 닫힌형이 없을 때 크기 추정.  
8) **코드 검산**: 랜덤 \(n\)을 넣어 빠르게 sanity check.

---

## 15. 연습문제(간단 해설 포함)

**Q1.** \(\displaystyle \sum_{k=1}^{n}(3k-1)\).  
**A.** \(3\sum k - \sum 1 = 3\cdot \frac{n(n+1)}{2} - n = \frac{n(3n+1)}{2}\).

**Q2.** \(\displaystyle \sum_{k=1}^{n}\frac{1}{k(k+1)}\).  
**A.** 망원 → \(\displaystyle \frac{n}{n+1}\).

**Q3.** \(\displaystyle \sum_{k=0}^{n} k\,2^{k}\).  
**A.** 공식을 쓰면 \(\displaystyle \frac{2-(n+1)2^{n+1}+n2^{n+2}}{(1-2)^2}= (n-1)2^{n+1}+2\).

**Q4.** \(\displaystyle \sum_{k=0}^{n} \binom{n}{k}^2\).  
**A.** \(\displaystyle \binom{2n}{n}\) (반원호 항등식, 컨볼루션/생성함수로 증명).

**Q5.** \(\displaystyle \sum_{k=1}^{n} H_k\).  
**A.** \(\displaystyle (n+1)H_n-n\) (부분합/아벨 변환으로 유도).

---

## 16. 요약(치트시트)

- **선형성**: \(\sum (\alpha a_i+\beta b_i)=\alpha\sum a_i+\beta\sum b_i\).  
- **기본합**: \(\sum k=\frac{n(n+1)}{2}\), \(\sum k^2=\frac{n(n+1)(2n+1)}{6}\), \(\sum k^3=\left(\frac{n(n+1)}{2}\right)^2\).  
- **기하급수**: \(\sum_{0}^{n} r^k=\frac{1-r^{n+1}}{1-r}\), \(\sum k r^k=\frac{r-(n+1)r^{n+1}+n r^{n+2}}{(1-r)^2}\).  
- **망원합**: 부분분수로 \(b_k-b_{k+1}\) 만들기.  
- **조합합**: \(\sum \binom{n}{k}=2^n\), \(\sum k\binom{n}{k}=n2^{n-1}\), \(\sum \binom{k}{r}=\binom{n+1}{r+1}\).  
- **컨볼루션**: \(\sum \binom{r}{k}\binom{s}{m-k}=\binom{r+s}{m}\).  
- **조화수 근사**: \(H_n\approx \ln n+\gamma\).  
- **통계**: \(\mathrm{Var}=\frac{1}{n}\sum x_i^2-\bar{x}^2\).  
- **행렬**: \((AB)_{ij}=\sum_k A_{ik}B_{kj}\), \(\mathrm{tr}=\sum_i A_{ii}\).

---

## 17. 추가 실습 아이디어(직접 해보면 바로 체화)

- \(\displaystyle \sum_{k=1}^{n}\frac{k}{k+1}\)을 **망원**으로 정리.  
- \(\displaystyle \sum_{k=0}^{n} (-1)^k \binom{n}{k} k^2\)를 **생성함수/미분**으로.  
- \(\displaystyle \sum_{i=1}^{n}\sum_{j=1}^{i} (i-j)\)를 **이중합 교환**으로 빠르게.