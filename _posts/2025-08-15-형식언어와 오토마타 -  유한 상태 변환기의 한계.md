---
layout: post
title: 형식언어와 오토마타 - 유한 상태 변환기의 한계
date: 2025-08-15 22:20:23 +0900
category: 형식언어와 오토마타
---
# 유한-상태 변환기(FST)의 **한계** — 표현력·결정화·동기화·폐포·실무적 제약까지

유한-상태 변환기(Finite-State Transducer, FST)는 입력 문자열을 출력 문자열로 바꾸는 **유한 기억** 장치입니다.  
표현력이 강력하고(정규 관계), 구성·합성·최소화 등 공학적 도구도 훌륭하지만, **유한 상태**라는 본질 때문에 피할 수 없는 한계가 있습니다.  
아래에서는 이 한계를 **이론적 경계**와 **실무적 제약**의 관점에서 체계적으로 정리합니다. (수식은 MathJax, 절차는 ``` 코드 블록)

---

## 1) 모델 스펙트럼과 “표현력 경계”

- **1-way FST (Mealy/Moore/일반화)**: 입력을 **좌→우 1회 통과**하며, 전이에서(또는 상태에서) **고정 패턴**의 출력을 붙인다.  
  함수형 결정적 모델(순차 변환기, DFT)은 **정규(=순차) 함수**를, 비결정 모델(NFT)은 **정규(=rational) 관계**를 구현.
- **표현력의 상한**: 1-way FST가 다루는 관계는 **정규 관계(rational relation)** 로 한정됩니다.  
  즉, **스택/무한 레지스터 없이**는 다음을 할 수 없습니다.

### (A) **무한 기억**이 필요한 전역 제약
- 균형/중첩 의존: \( \{\,a^n b^n \mid n\ge 0\,\} \) 같은 **카운트 일치**를 정확히 반영하거나,  
  임의 길이의 **중첩 괄호**(Dyck) 구조를 요구하는 변환은 **불가**.  
- 멀리 떨어진 두 구간의 **동일성 검사**(예: 앞/뒤 절반이 정확히 같은지)는 **불가**.

### (B) **비국소 재배열**(unbounded reordering)
1-way FST는 한 스텝 출력이 **현재(또는 과거의 유한 요약)** 에만 의존합니다.  
따라서 다음 변환들은 1-way에선 불가능합니다.

- **역순**: \(w \mapsto w^R\)  
  → 미래 전체를 본 뒤 되돌려 출력해야 하므로 **1-way**에선 불가. (2-way FST나 MSO/SST로는 가능)
- **끝-문자 맨앞으로**: \(ua \mapsto au\)  
  → 마지막 문자를 알기 전엔 앞 출력을 결정할 수 없습니다(지연이 **무한히** 필요).
- **두 번 이어붙이기**: \(w \mapsto ww\)  
  → 두 번째 사본을 위해 **전체 입력을 저장**해야 하는데, 유한 상태로는 불가.  
  (각 문자를 두 번 연속 출력하는 \(a_1a_2\cdots a_n \mapsto a_1a_1a_2a_2\cdots a_n a_n\)은 가능하지만 **\(ww\)** 와는 다릅니다.)

> 요약: 1-way FST의 출력은 입력과 **거칠게 동기화**되며, “큰 폭의 재배열/뒤집기/전역 복사”는 막힙니다.

---

## 2) **결정화(Determinization)**의 한계 — twinning property

비결정 FST(NFT)가 **함수**를 정의하더라도 항상 결정화(DFT)되는 건 아닙니다.

- **Twinning property(지연 유계)**: 두 경로의 **출력 지연(delay)** 차이가 무한히 벌어지지 않아야 결정화 가능.  
- **한계**: 이 속성이 깨지면, **어떤 결정적 1-way**로도 동일 함수를 실현할 수 없습니다(필연적으로 **비결정 또는 2-way**가 필요).

> 실무 신호: “미래를 조금이라도 봐야 하는” 패턴(예: 마지막 심볼을 앞에 두기)은 대개 twinning을 깨뜨려 **순차화 불가**.

---

## 3) **출력 길이·지연**의 구조적 한계

- (ε-출력 루프가 없다는 정상화 가정하) **출력 길이**는 입력 길이에 대해
  \[
  |\,\text{out}(x)\,| \le c_0 + c_1 \cdot |x|
  \]
  로 **선형 상계**를 가집니다.  
  → **초선형 폭증**(예: 지수 복제)은 **불가**.
- **고정 지연만 허용**: 결정 FST는 각 입력 스텝에서 출력이 **즉시** 또는 **유계 지연**으로만 결정됩니다.  
  → 입력 끝까지 **콘텐츠-의존 꼬리**를 길게 쌓는 형태는 불가(최종 출력 \(\tau(q)\)는 **상태별 고정**이라 입력 내용 반영 한계).

---

## 4) **폐포·연산** 관련 한계

- **역함수**: 순차 함수의 **역**은 일반적으로 **순차 함수가 아님**(비결정이나 2-way가 필요).  
- **역변환/입력 역순**: 입력을 뒤집어 처리한 결과가 다시 순차 함수일 **보장이 없음**.  
- **합성**: 순차 함수끼리의 합성은 순차로 유지되지만, **일반 정규 관계**(NFT) 수준으로 올리면  
  포함/동치 같은 전역 문제는 **결정 불가능**한 경우가 많습니다(PCP류 감수).

---

## 5) **동등성/포함/기능성 검사**의 장벽

- **기능성(functionality)**: NFT가 진짜 **함수**인지 여부는 이론상 결정 가능하지만(복잡),  
  일반 정규 관계(NFT) 사이의 **동치·포함**은 전반적으로 **결정 불가능**합니다.  
- **동치성**: 결정적(순차) 변환기라면 **선형 시간**에 검사 가능하지만, 비결정/관계 일반화에선 급격히 어려워집니다.

> 실무 조언: **항상 결정적**으로 유지하거나, 합성 전 **결정화 가능성(지연 유계)** 을 검사해 파이프라인을 설계하세요.

---

## 6) **동기화(synchronization)**의 한계 — “입출력 정렬”

1-way FST는 본질적으로 **입력 헤드가 뒤로 가지 못함**(look-behind 없음).  
따라서 가능한 재배열은 “현 시점 **근처**에서의 국소 치환/삽입/삭제”로 제한됩니다.

- **가능**: 접두/접미의 **고정** 삽입, 패턴 기반 치환, 국소 swap(유한 길이)  
- **불가**: “끝에 가서 결정해야 하는 앞부분 출력”, “멀리 있는 두 구간의 조건부 교환/복사”

---

## 7) **무게(가중치)·확률**를 얹어도 본질은 동일

가중 FST(WFST)로 **비용/확률**을 더해도, **표현력의 코어**는 여전히 **유한 상태**입니다.

- **가능**: 최단경로, N-best, 합성으로 대규모 파이프라인(발음·언어모델)  
- **한계 유지**: 역순/전역 복사/중첩 구조 등 **메모리 요구** 문제는 여전히 불가.

---

## 8) **대체 모델**로 우회하는 방법

| 요구 기능 | 권장 모델 | 메모 |
|---|---|---|
| 역순, 앞/뒤 전역 재배열 | **2-way FST** / **MSO 변환** / **SST** | 2-way는 입력을 좌↔우 왕복 스캔하며 출력 가능 |
| 전역 복사·상수회 복제(예: \(ww\)) | **2-way FST** / **SST** | MSO/SST는 “복수 사본”을 **상수번** 만들 수 있음 |
| 중첩·균형 구조(스택) | **푸시다운 변환기**(PDT) | 문맥자유급 의존성 처리 |
| 강한 전역 제약/검증 | **정적분석/SMT**와 결합 | FST 전처리 + 검증기로 후처리 |

> 실무 팁: 가능한 한 **1-way 순차**로 모듈화(빠름·검증 용이)하고, 꼭 필요한 곳만 **2-way/SST** 로 승격하세요.

---

## 9) **자주 하는 오해** 바로잡기

- “출력을 끝에 몰아서 내면 역순도 되지 않나?” → **아님**.  
  순차 변환기의 **최종 출력 \(\tau(q)\)** 는 **상태별 상수 문자열**이라, 입력 내용(임의 길이)에 따라 달라지는 **가변 꼬리**를 만들 수 없습니다.
- “문자열을 두 번 출력하면 \(ww\)지?” → **아님**.  
  1-way에서 가능한 건 **문자별 복제**( \(a\mapsto aa\) )로, 순서가 \(a_1a_1a_2a_2\cdots\) 가 됩니다. \(ww\)와는 다릅니다.
- “비결정으로 때우면 되지 않나?” → **한시적**입니다.  
  비결정은 **선택**만 줄 뿐, **유한 상태**의 기억 한계를 깨지 못합니다. 게다가 결정화가 **불가능**해질 수 있습니다.

---

## 10) 체크리스트 — “FST로 충분한가?”

1) **재배열 폭**: 근거리(상수 길이)인가? → FST OK / 전역(끝-정보 필요)인가? → 2-way/SST 검토.  
2) **복제/누적**: 출력이 입력 길이에 **상수배** 이내인가? 초선형이면 불가.  
3) **의존성**: 카운트 일치·중첩이 필요한가? → PDT/CFG 계열.  
4) **결정성**: 지연 유계(twinning)인가? 아니라면 1-way 결정화 불가.  
5) **검증**: 동치·포함을 자동화해야 하나? → 가능하면 **결정적**으로 유지.

---

## 11) 한 페이지 요약

- 1-way FST는 **정규 관계**까지만, **역순/전역 복사/균형 의존** 등은 **불가**.  
- 비결정 FST의 함수도 **항상** 결정화되지 않으며(지연 유계 필요), 출력 길이는 **선형 상계**를 가짐.  
- 역/역순/포함·동치 같은 전역 연산은 종종 **닫힘 실패** 또는 **결정 불가능**.  
- 필요 시 **2-way FST / SST / PDT** 등으로 단계적 확장: “가능한 곳엔 FST, 필요한 곳만 상위 모델”.
