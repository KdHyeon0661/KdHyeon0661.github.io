---
layout: post
title: 미적분 - 로피탈의 법칙
date: 2025-06-24 22:20:23 +0900
category: 미적분
---
# 로피탈의 법칙 (L'Hôpital's Rule) — 정의, 증명, 변형, 반례, 실전 예제와 코드

극한이 **불정형(indeterminate)** 꼴일 때, 분자/분모를 각각 미분해 극한을 구할 수 있게 해 주는 도구다.

---

## 정식 진술(단변수, 양방향/편측 포함)

함수 $$f,g$$ 가 열린구간 $$I$$ 에서 미분 가능하고, $$a\in I$$ 이거나 $$a$$ 가 $$I$$ 의 끝점(편측 극한)라고 하자. 다음 중 하나가 성립한다고 가정한다.

- $$\lim_{x\to a} f(x)=\lim_{x\to a} g(x)=0$$  (0/0 꼴)
- 또는 $$\lim_{x\to a} |f(x)|=\lim_{x\to a} |g(x)|=\infty$$  (infty/infty 꼴)

또한 근방에서 $$g'(x)\ne 0$$ 이고,
$$\lim_{x\to a}\frac{f'(x)}{g'(x)}=L$$  (또는 좌우 편측 극한이 각각 존재) 이면,
$$
\boxed{\lim_{x\to a}\frac{f(x)}{g(x)}=\lim_{x\to a}\frac{f'(x)}{g'(x)}=L.}
$$

- 편측판: $$x\to a^-$$ 나 $$x\to a^+$$ 에 대해 위 가정이 해당 방향에서 성립하면 동일 결론이 편측으로 성립한다.
- 무한대로 가는 극한: $$a=\infty$$ 혹은 $$a=-\infty$$ 에 대해서도 같은 형태로 성립한다.

---

## 증명 스케치와 정밀 버전

### 코시 평균값정리(CMVT) 기반 스케치

0/0 꼴에서, $$x\neq a$$ 에 대해 구간의 어느 점 $$\xi$$ 에서
$$
\frac{f(x)-f(a)}{g(x)-g(a)}=\frac{f'(\xi)}{g'(\xi)}.
$$
여기서 $$f(a)=g(a)=0$$ 또는 적절한 치환으로 같은 꼴을 만들 수 있다. $$x\to a$$ 이면 $$\xi\to a$$ 이고, $$f'(\xi)/g'(\xi)\to L$$ 이므로 결론이 따른다. infty/infty 꼴도 적절히 CMVT로 처리 가능하다.

### 잔차항(o-표기) 기반 정밀 증명 스냅샷

미분 가능이면
$$
f(x)=f(a)+f'(a)(x-a)+o(x-a),\quad
g(x)=g(a)+g'(a)(x-a)+o(x-a).
$$
0/0 꼴이면 $$f(a)=g(a)=0$$ 이고
$$
\frac{f(x)}{g(x)}=\frac{f'(a)+o(1)}{g'(a)+o(1)}\to \frac{f'(a)}{g'(a)}.
$$
도함수 비의 극한이 $$L$$ 로 일반화될 때도 같은 요지로 수렴한다.

---

## 적용 가능한 불정형과 변형이 필요한 꼴

- 직접 적용 가능: 0/0, infty/infty
- 직접 적용 불가(변형 필요):
  0*infty, infty-infty, 1^infty, 0^0, infty^0

변형 전략 요약:
- 곱 0*infty -> 몫으로 바꾸기 (예: $$x\ln x = \frac{\ln x}{1/x}$$)
- 차 infty-infty -> 유리화, 통분, 공통인자 인출로 몫 형태 만들기
- 지수형 1^infty, 0^0, infty^0 -> 로그를 취해 곱으로 바꾼 뒤 0/0 또는 infty/infty 꼴로 전환

---

## 기본 예제 모음 (직접 적용)

### 0/0

1)
$$
\lim_{x\to 0}\frac{\sin x}{x}
\quad\Rightarrow\quad
\frac{\cos x}{1}\to 1.
$$
2)
$$
\lim_{x\to 0}\frac{1-\cos x}{x^2}
\quad\Rightarrow\quad
\frac{\sin x}{2x}\quad\Rightarrow\quad
\frac{\cos x}{2}\to \frac12.
$$

### infty/infty

3)
$$
\lim_{x\to\infty}\frac{x}{e^x}
\quad\Rightarrow\quad
\frac{1}{e^x}\to 0.
$$
4)
$$
\lim_{x\to\infty}\frac{\ln x}{x}
\quad\Rightarrow\quad
\frac{1/x}{1}=\frac{1}{x}\to 0.
$$

---

## 변형이 필요한 꼴 -> 전환 후 적용

### infty - infty

$$
\lim_{x\to\infty}\big(\sqrt{x^2+x}-x\big)
=
\lim_{x\to\infty}\frac{x}{\sqrt{x^2+x}+x}
=
\lim_{x\to\infty}\frac{1}{\sqrt{1+\frac{1}{x}}+1}
=\frac12.
$$

### 0 * infty

$$
\lim_{x\to 0^+} x\ln x
=
\lim_{x\to 0^+}\frac{\ln x}{1/x}
\quad\Rightarrow\quad
\frac{1/x}{-1/x^2}=-x\to 0.
$$

### 1^infty (로그 치환)

$$
\lim_{x\to 0}\big(1+x\big)^{1/x}
=
\exp\!\left(\lim_{x\to 0}\frac{\ln(1+x)}{x}\right)
\Rightarrow
\exp\!\left(\frac{1}{1+x}\right)\to e.
$$

### 0^0

$$
\lim_{x\to 0^+} x^x
=
\exp\!\big(\lim_{x\to 0^+} x\ln x\big)
=\exp(0)=1.
$$

---

## 반복 적용, 편측, 매개변수 치환

- 반복 적용: 한 번 적용 후에도 여전히 0/0 또는 infty/infty 이면 가정이 유지되는 한 계속 적용 가능하다.
- 편측 극한: 좌우 각각의 가정이 성립하면 각 방향으로 적용 가능하다.
- 매개변수 치환: 복잡한 표현을 $$t\to 0$$ 꼴로 치환하면 규칙 적용이 간단해지는 경우가 많다.

---

## 로피탈 이외의 해법과의 비교(언제 대체하나)

- 테일러 전개: 근방 다항 근사로 더 빠르게 구할 수 있다.
  - 예) $$\tan x - x \sim \frac{x^3}{3}$$ 이므로
    $$\lim_{x\to 0}\frac{\tan x - x}{x^3}=\frac13.$$
- 표준 극한 활용: $$\lim_{x\to 0}\frac{\sin x}{x}=1$$ 등
- 비교/지배수렴/정리: 로그와 루트의 성장 비교 등

실전 요령: 먼저 테일러로 구조를 파악한 뒤 필요시 로피탈 적용 여부를 결정한다.

---

## 오용 방지 체크리스트와 반례 감각

| 항목 | 점검 내용 |
|---|---|
| 불정형 확인 | 반드시 0/0 또는 infty/infty 인지 먼저 확인 |
| 미분 가능 | 근방에서 f, g 미분 가능, g'가 0이 아님 |
| 도함수 비의 극한 | $$\lim f'/g'$$ 가 존재(또는 편측으로 존재) |
| 발산/진동 | $$f'/g'$$ 가 발산 또는 진동이면 결론 불가 |
| 무제한 반복 금지 | 반복 적용이 해결 못 하면 다른 기법 전환 |

중요 반례 감각:
- 원래 극한은 존재하지만 $$f'/g'$$ 의 극한이 존재하지 않는 경우:
  $$\displaystyle \lim_{x\to\infty} \frac{x+\sin x}{x} = 1,$$
  그러나 $$\frac{f'}{g'}=1+\cos x$$ 는 극한이 없다. 규칙 **적용 가정이 불충족**이므로 사용하면 안 된다.
- 0으로 나누는 형식 오해:
  $$\lim_{x\to 0}\frac{\sin(1/x)}{x}$$ 은 0/0가 아니다(분자는 진동, 분모는 0). 로피탈 대상이 아님.

---

## 실전 예제 심화(풀이 포함)

### 혼합 삼각/로그

$$
\lim_{x\to 0}\frac{\ln(1+x)-\sin x}{x^2}
\Rightarrow
\frac{\frac{1}{1+x}-\cos x}{2x}
\Rightarrow
\frac{-\frac{1}{(1+x)^2}+\sin x}{2}
\to 0.
$$

### 지수의 잔여항

$$
\lim_{x\to 0}\frac{e^x-1-x}{x^2}
\Rightarrow
\frac{e^x-1}{2x}
\Rightarrow
\frac{e^x}{2}\to \frac12.
$$

### 로그 vs 루트 성장 비교

$$
\lim_{x\to\infty}\frac{\ln(1+x^2)}{\sqrt{x}}
\Rightarrow
\frac{\frac{2x}{1+x^2}}{\frac{1}{2}x^{-1/2}}
=
\frac{4x^{3/2}}{1+x^2}\to 0.
$$

### 지수형 1^infty 변형

$$
\lim_{x\to 0^+}(1+\sin x)^{1/x}
=
\exp\!\left(\lim_{x\to 0^+}\frac{\ln(1+\sin x)}{x}\right)
\Rightarrow
\exp\!\left(\frac{\cos x}{1+\sin x}\right)\to e.
$$

### 고난도: 반복 적용과 구조 파악

$$
\lim_{x\to 0}\frac{\tan x - \sin x}{x^3}.
$$
테일러로도 빠르다:
$$\tan x = x + \frac{x^3}{3} + o(x^3),\quad \sin x = x - \frac{x^3}{6} + o(x^3).$$
따라서 분자는 $$\frac{x^3}{3} + \frac{x^3}{6} + o(x^3)=\frac{x^3}{2}+o(x^3)$$ 이고, 극한은 $$\frac12$$.

---

## 상황별 전략 표

| 상황 | 전처리 | 적용 |
|---|---|---|
| 0/0, infty/infty | 바로 확인 | 로피탈 1회, 필요시 반복 |
| 0*infty | 곱을 몫으로 변환 | 로피탈 |
| infty-infty | 유리화, 통분, 합성함수 치환 | 로피탈 또는 비교 |
| 1^infty, 0^0, infty^0 | 로그 취해 곱으로 변환 | 로피탈(로그 극한에 적용) |
| 도함수 비의 극한 불존재 | 적용 중단 | 테일러, 비교, 스퀴즈 등으로 전환 |

---

## 파이썬으로 수치 확인(안정적 검산)

다음 코드는 몇 가지 대표 극한을 수치적으로 확인한다.
주의: 수치 근사는 이론 증명을 대체하지 않는다. 샘플링 범위와 스텝을 충분히 작게/크게 조정하라.

```python
import numpy as np

def approx_limit_f_over_g(f, g, xs):
    vals = []
    for x in xs:
        try:
            vals.append(f(x)/g(x))
        except ZeroDivisionError:
            vals.append(np.nan)
    return np.array(vals)

# sin x / x as x -> 0

f1 = np.sin
g1 = lambda x: x
xs1 = np.logspace(-8, -1, 10)  # 1e-8 ... 1e-1
vals1 = approx_limit_f_over_g(f1, g1, xs1)
print("sin x / x near 0:", list(zip(xs1, vals1)))

# (1 - cos x) / x^2 as x -> 0

f2 = lambda x: 1 - np.cos(x)
g2 = lambda x: x**2
xs2 = np.logspace(-6, -1, 8)
vals2 = approx_limit_f_over_g(f2, g2, xs2)
print("(1 - cos x) / x^2 near 0:", list(zip(xs2, vals2)))

# ln x / x as x -> infinity

f3 = lambda x: np.log(x)
g3 = lambda x: x
xs3 = np.logspace(1, 6, 6)  # 10, 100, ..., 1e6
vals3 = approx_limit_f_over_g(f3, g3, xs3)
print("ln x / x as x->inf:", list(zip(xs3, vals3)))

# x * ln x as x -> 0+

f4 = lambda x: x*np.log(x)
g4 = lambda x: 1.0  # denominator 1 for convenience
xs4 = np.logspace(-8, -2, 7)
vals4 = [f4(x) for x in xs4]
print("x ln x near 0+:", list(zip(xs4, vals4)))

# (1 + x)^(1/x) as x -> 0  (check via exp( ln(1+x)/x ))

f5 = lambda x: np.exp(np.log1p(x)/x)
xs5 = np.logspace(-6, -2, 5)
vals5 = [f5(x) for x in xs5]
print("(1+x)^(1/x) near 0+: ", list(zip(xs5, vals5)))
```

원한다면 matplotlib로 각 근사값이 수렴하는 모습을 점 그래프로 확인해도 좋다(여기서는 텍스트 출력만 제시).

---

## 연습문제(풀이 방향 힌트 포함)

1)
$$
\lim_{x\to 0}\frac{\tan x - x}{x^3}
$$
힌트: 로피탈 3회 또는 테일러. 정답: $$1/3$$.

2)
$$
\lim_{x\to 0}\frac{\arcsin x - x}{x^3}
$$
힌트: 로피탈 3회 또는 테일러(아크사인 전개). 정답: $$1/6$$.

3)
$$
\lim_{x\to\infty}\frac{\sqrt{x^2+3x}-x}{\ln x}
$$
힌트: 유리화로 분자를 몫으로 바꾼 뒤 비교. 정답: 0.

4)
$$
\lim_{x\to 0^+} x^{\sin x}
$$
힌트: 로그 취해 $$\sin x \ln x$$ 분석. 정답: 1.

5)
$$
\lim_{x\to 0}\frac{e^x - \cos x - x}{x^2}
$$
힌트: 분리해서 각 항의 테일러 계수 확인 또는 로피탈. 정답: 1.

6)
$$
\lim_{x\to 0}\frac{\ln(1+\sin x)-\sin x}{x^3}
$$
힌트: 로그-사인 혼합 테일러, 또는 로피탈 반복. 정답: 0.

7)
$$
\lim_{x\to 0}\frac{\ln(1+x)-\tan^{-1} x}{x^2}
$$
힌트: 테일러로 주도항 비교. 정답: 0.

---

## 마무리 요약

- 적용 전 확인: 0/0 또는 infty/infty 꼴인지, f,g 미분 가능인지, 근방에서 g'(x) != 0인지, f'/g'의 극한이 존재하는지.
- 변형 후 적용: 0*infty, infty-infty, 1^infty, 0^0, infty^0 는 몫/로그 등으로 바꿔 0/0 또는 infty/infty 로 만든다.
- 대안: 테일러 전개와 비교판정이 더 빠를 때가 많다.
- 반례 감각: 가정이 깨지면 규칙을 쓰지 않는다. 원래 극한이 존재하더라도 f'/g'의 극한이 없으면 적용 금지.

실전 루틴:
꼴 확인 -> 가정 점검 -> 필요시 변형 -> 로피탈(반복 허용) -> 안 풀리면 테일러/비교/유리화로 전환.
