---
layout: post
title: 이산수학 - 점화관계 풀기
date: 2025-06-21 20:20:23 +0900
category: 이산수학
---
# 🧩 점화관계 풀기 (Solving Recurrence Relations)

## 📌 개요

**점화관계(Recurrence Relation)**는 수열의 각 항을 **이전 항들과의 관계로 정의**한 식입니다.  
점화식을 풀면 수열의 **일반항(closed-form)**을 구할 수 있으며, 이는 알고리즘 분석, 수학적 증명, 수열 계산 등에 핵심적인 역할을 합니다.

---

## ✅ 점화식의 종류

점화식은 여러 유형으로 분류할 수 있습니다. 각각의 유형에 따라 해법이 다릅니다.

| 유형 | 예시 | 해법 |
|------|------|------|
| 선형, 상수 계수, 동차 | \( a_n = 3a_{n-1} - 2a_{n-2} \) | 특성방정식 |
| 선형, 상수 계수, 비동차 | \( a_n = 2a_{n-1} + 5 \) | 특성방정식 + 특수해 |
| 조합형 | \( a_n = a_{n-1} + a_{n-2} \) | 피보나치 구조 |
| 이항 계수형 | \( \binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1} \) | 조합적 성질 |
| 분할/점화 DP형 | \( a_n = a_{n-1} + a_{n-2} + a_{n-3} \) | 반복 + 조건 설정 |

---

## 📐 1. 선형 동차 점화식 풀기

형태:  
\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k}
\]

### 🎯 예제

\[
a_n = 3a_{n-1} - 2a_{n-2}, \quad a_0 = 2,\ a_1 = 3
\]

### 🔹 Step 1: 특성방정식 작성

\[
r^2 - 3r + 2 = 0 \Rightarrow r = 1, 2
\]

### 🔹 Step 2: 일반해 작성

\[
a_n = A \cdot 2^n + B \cdot 1^n
\]

### 🔹 Step 3: 초기조건 대입

- \( a_0 = A + B = 2 \)  
- \( a_1 = 2A + B = 3 \)

→ \( A = 1,\ B = 1 \)

### ✅ 최종해

\[
a_n = 1 \cdot 2^n + 1 \cdot 1^n = 2^n + 1
\]

---

## 📘 2. 중복근의 처리

> 특성방정식에서 중복근이 나올 경우, 일반항에 \( n \)을 곱해줌

### 🎯 예제

\[
a_n = 2a_{n-1} - a_{n-2},\quad a_0 = 1,\ a_1 = 2
\]

- 특성방정식: \( r^2 - 2r + 1 = 0 \Rightarrow r = 1 \) (중복근)

- 일반해:  
\[
a_n = (A + Bn) \cdot 1^n = A + Bn
\]

- 초기조건 대입:  
\( a_0 = A = 1,\ a_1 = A + B = 2 \Rightarrow B = 1 \)

→ \( a_n = 1 + n \)

---

## 📘 3. 비동차 점화식 풀기

형태:  
\[
a_n = c_1 a_{n-1} + f(n)
\]

### 🔹 해법

1. **동차 해(h)**: \( a_n = \text{solution of } a_n = c_1 a_{n-1} \)  
2. **특수해(p)**: \( a_n = \text{some particular solution of the full equation} \)  
3. **전체 해**: \( a_n = h + p \)

---

### 🎯 예제

\[
a_n = 2a_{n-1} + 5,\quad a_0 = 1
\]

- 동차해: \( h = A \cdot 2^n \)

- 특수해 시도: 상수형 \( p = C \)  
\[
C = 2C + 5 \Rightarrow C = -5
\]

- 전체 해:  
\[
a_n = A \cdot 2^n - 5
\]

- 초기조건 대입:  
\( a_0 = A - 5 = 1 \Rightarrow A = 6 \)

### ✅ 최종해

\[
a_n = 6 \cdot 2^n - 5
\]

---

## 📘 4. 생성함수를 통한 해법 (고급)

- 생성 함수 \( A(x) = \sum a_n x^n \)을 구성하여 점화식을 대수적으로 해결

> 예: \( a_n = a_{n-1} + a_{n-2} \) → 생성함수로 해석 후 대수적 전개로 일반항 유도 가능

(※ 이 주제는 생성 함수 편에서 별도로 정리)

---

## 🧠 5. 점화식 유형별 해법 요약

| 점화식 유형 | 해법 방식 | 키워드 |
|-------------|-----------|--------|
| 선형 동차, 상수 계수 | 특성 방정식 | \( r^k \) 해 |
| 선형 비동차 | 동차해 + 특수해 | 전체 해 구성 |
| 중복근 | \( (A + Bn + Cn^2)\cdot r^n \) | 다항 곱 |
| 계수 변화형 | 패턴 추정 또는 반복 | 누적합, 패턴 도출 |
| 조합 기반 | 수학적 귀납법 | 이항계수, DP 형태 |

---

## 🛠️ 6. Python 구현 예시

```python
# 예: a_n = 3a_{n-1} - 2a_{n-2}, a_0 = 2, a_1 = 3
def recurrence(n):
    a = [2, 3]
    for i in range(2, n+1):
        a.append(3 * a[i-1] - 2 * a[i-2])
    return a[n]

print(recurrence(5))  # → 일반해는 2^n + 1 → 2^5 + 1 = 33