---
layout: post
title: 이산수학 - 점화관계 풀기
date: 2025-06-21 20:20:23 +0900
category: 이산수학
---
# 점화관계 풀기 (Solving Recurrence Relations)

## 0. 개요: 점화식이란?

- **점화식(Recurrence Relation)**: 수열의 항 $$a_n$$ 이 이전 항들로 정의된 식.  
  예) $$a_n=3a_{n-1}-2a_{n-2}$$, $$T(n)=2T(n/2)+n$$
- **목표**: 가능한 한 **일반항(closed form)** 또는 **정확/점근 해석**을 구하기.

---

## 1. 유형 지도 (문제 → 해법 빠른 선택표)

| 유형 | 전형 형태 | 대표 해법 | 핵심 키워드 |
|---|---|---|---|
| 선형·상수계수·동차 | $$a_n=\sum_{i=1}^k c_i a_{n-i}$$ | **특성방정식** | 근 뽑기, 중복근, 복소근 |
| 선형·상수계수·비동차 | $$a_n=\sum c_i a_{n-i}+g(n)$$ | **미정계수/소거자** | **공진(겹침) 보정** |
| 1차 가변계수 | $$a_n=p(n)a_{n-1}+q(n)$$ | **전개·망원경 합** | 곱 인자, 누적합 |
| 분할정복(알고리즘) | $$T(n)=aT(n/b)+f(n)$$ | **마스터 정리/재귀트리**, **Akra–Bazzi** | 복잡도 해석 |
| 조합형(컨볼루션) | $$a_{n+1}=\sum a_i a_{n-i}$$ | **생성함수** | 카탈란, 합성 |
| 행렬 가능형 | 선형 동차 $$k$$차 | **행렬(고유값)** | Binet, 동시해 |
| 비선형/바닥/천장 | 예: $$a_n=\lfloor n/2\rfloor+\dots$$ | 근사/샌드위치/아크라–바지/불변량 | 점근·경계 |

---

## 2. 선형·상수계수·**동차**: 특성방정식

### 2.1 표준형
$$
a_n=c_1 a_{n-1}+c_2 a_{n-2}+\cdots+c_k a_{n-k}
$$

**절차**
1) 해를 $$a_n=r^n$$ 꼴로 가정  
2) **특성방정식**: $$r^k-c_1 r^{k-1}-\cdots-c_k=0$$  
3) 근들의 중복·복소에 따른 일반해 구성

### 2.2 예제 A (서로 다른 실근)
$$
a_n=3a_{n-1}-2a_{n-2},\quad a_0=2,\ a_1=3
$$
- 특성: $$r^2-3r+2=0\Rightarrow r=1,2$$  
- 일반해: $$a_n=A\cdot 1^n+B\cdot 2^n=A+B\cdot 2^n$$  
- 초기조건:  
  $$A+B=2,\quad A+2B=3\Rightarrow B=1,\ A=1$$  
- **정답**: $$\boxed{a_n=2^n+1}$$

### 2.3 예제 B (중복근)
$$
a_n=2a_{n-1}-a_{n-2},\ a_0=1,\ a_1=2
$$
- 특성: $$(r-1)^2=0\Rightarrow r=1\ \text{(중복근)}$$  
- 일반해: $$a_n=(A+Bn)\cdot 1^n=A+Bn$$  
- 대입: $$A=1,\ A+B=2\Rightarrow B=1$$  
- **정답**: $$\boxed{a_n=1+n}$$

### 2.4 예제 C (복소근)
$$
a_n=2a_{n-1}-2a_{n-2},\ a_0=0,\ a_1=1
$$
- 특성: $$r^2-2r+2=0\Rightarrow r=1\pm i$$  
- 일반해: $$a_n=\alpha(1+i)^n+\beta(1-i)^n$$  
  또는 실수형: $$a_n=\rho^n\big(C\cos(n\theta)+D\sin(n\theta)\big)$$,  
  여기서 $$\rho=\sqrt{1^2+1^2}=\sqrt{2},\ \theta=\arctan(1)=\pi/4$$.  
- 초기조건으로 $$C,D$$ 결정.

---

## 3. 선형·상수계수·**비동차**: 미정계수/소거자

표준형
$$
a_n=\sum_{i=1}^k c_i a_{n-i}+g(n)
$$

**아이디어**:  
- **동차해**: $$a_n^{(h)}$$ (특성방정식)  
- **특수해**: $$a_n^{(p)}$$ 를 **형태 추측(미정계수)** 또는 **소거자(Annihilator)**로 구함  
- **전체해**: $$a_n=a_n^{(h)}+a_n^{(p)}$$

### 3.1 RHS 유형별 추측 규칙(핵심 암기)
- $$g(n)=P_m(n)$$ (차수 $$m$$ 다항식) ⇒ **다항식 추측** $$Q_m(n)$$  
- $$g(n)=\alpha^n$$ ⇒ **지수 추측** $$C\alpha^n$$  
- $$g(n)=P_m(n)\alpha^n$$ ⇒ **다항×지수 추측** $$Q_m(n)\alpha^n$$  
- $$g(n)=\cos(\omega n),\sin(\omega n)$$ ⇒ **삼각 추측** $$C\cos+\ D\sin$$  
- **공진**: 추측한 형태가 **동차해와 겹치면** **$$n^s$$ 곱**(중복도 $$s$$)

### 3.2 예제 D (상수 RHS)
$$
a_n=2a_{n-1}+5,\ a_0=1
$$
- 동차: $$a_n^{(h)}=A\cdot 2^n$$  
- 특수: 상수형 $$C$$ 시도 ⇒ $$C=2C+5\Rightarrow C=-5$$  
- 전체: $$a_n=A\cdot 2^n-5$$  
- 초기: $$1=A-5\Rightarrow A=6$$  
- **정답**: $$\boxed{a_n=6\cdot 2^n-5}$$

### 3.3 예제 E (지수 RHS + 공진)
$$
a_n=2a_{n-1}+3\cdot 2^n,\quad a_0=0
$$
- 동차: $$A\cdot 2^n$$  
- 특수: 지수형 **$$C\cdot 2^n$$** 을 시도하면 **공진**(동차와 동일).  
  ⇒ **$$n$$ 곱**: $$a_n^{(p)}=C\cdot n\cdot 2^n$$  
- 대입:  
  $$C n 2^n=2\cdot C (n-1)2^{n-1}+3\cdot 2^n\Rightarrow C n= C(n-1)+3$$  
  ⇒ $$C=3$$  
- 전체: $$a_n=A\cdot 2^n+3n2^n$$, 초기 $$0=A+0\Rightarrow A=0$$  
- **정답**: $$\boxed{a_n=3n\cdot 2^n}$$

### 3.4 예제 F (다항 RHS)
$$
a_n= a_{n-1}+n^2,\quad a_0=0
$$
- 동차: $$A$$(상수)  
- 특수: $$Q_2(n)=an^2+bn+c$$ 가정  
  $$an^2+bn+c=(a(n-1)^2+b(n-1)+c)+n^2$$ 전개→계수 비교  
  해를 구해 전체해 조합(생략 없이 풀면 길어짐; 아래 코드 검증 제공).

### 3.5 예제 G (다항×지수)
$$
a_n=2a_{n-1}+n\cdot 3^n,\quad a_0=0
$$
- 동차: $$A\cdot 2^n$$  
- 특수: $$Q_1(n)\cdot 3^n=(an+b)3^n$$ 가정  
  대입 후 계수 비교로 $$a,b$$ 결정 → 전체해.

---

## 4. 1차 가변계수: 전개(Iteration)·망원경

### 4.1 표준형
$$
a_n = p(n)\,a_{n-1}+q(n),\quad a_0 \text{ 주어짐}
$$

**곱 인자(product)**로 전개:
$$
a_n = \Big(\prod_{j=1}^n p(j)\Big)a_0 + \sum_{k=1}^n \Big(q(k)\prod_{j=k+1}^n p(j)\Big)
$$

### 4.2 예제 H (계승 성장)
$$
a_n=(n+1)a_{n-1},\ a_0=1
$$
- 전개: $$a_n=\prod_{j=1}^n (j+1)\cdot a_0=(n+1)!$$  
- **정답**: $$\boxed{a_n=(n+1)!}$$

### 4.3 예제 I (덧셈 누적)
$$
a_n=a_{n-1}+n,\ a_0=0
$$
- 전개: $$a_n=\sum_{k=1}^n k=\dfrac{n(n+1)}{2}$$

### 4.4 예제 J (비율이 1+1/n)
$$
a_n=\Big(1+\frac1n\Big)a_{n-1},\ a_1=c
$$
- 전개: $$a_n=c\prod_{j=2}^n \Big(1+\frac1j\Big)=c\prod_{j=2}^n \frac{j+1}{j}=c\cdot \frac{n+1}{2}$$  
- **정답**: $$\boxed{a_n=\dfrac{c(n+1)}{2}}$$

---

## 5. **생성함수**(Generating Functions): 컨볼루션/조합형에 강력

### 5.1 핵심 로직
수열 $$\{a_n\}$$ 의 생성함수:  
$$A(x)=\sum_{n\ge 0} a_n x^n$$  
점화식을 **대수식**으로 변환하여 풀고, 계수를 다시 읽어 일반항 획득.

### 5.2 예제 K (피보나치)
$$
F_0=0,\ F_1=1,\ F_n=F_{n-1}+F_{n-2}\ (n\ge2)
$$
- $$F(x)=\sum_{n\ge0}F_n x^n$$  
- 점화 대입:
  $$
  F(x)-x = x(F(x))+x^2 F(x)
  $$
  ⇒ $$
  F(x)=\frac{x}{1-x-x^2}
  $$
- 부분분수/고유값(황금비)로 전개 → **Binet 공식**
  $$
  F_n=\frac{\varphi^n-\hat\varphi^n}{\sqrt{5}},\ \varphi=\frac{1+\sqrt5}{2}
  $$

### 5.3 예제 L (카탈란)
$$
C_{n+1}=\sum_{i=0}^n C_i C_{n-i},\ C_0=1
$$
- $$C(x)=\sum_{n\ge 0} C_n x^n$$  
- 대수식: $$C(x)=1+xC(x)^2$$  
- 해: $$
C(x)=\frac{1-\sqrt{1-4x}}{2x}
$$
- 계수 추출: $$
\boxed{C_n=\frac{1}{n+1}\binom{2n}{n}}
$$

---

## 6. **행렬 방법**: k차 선형 동차를 한 번에

$$
\begin{bmatrix}
a_n\\ a_{n-1}\\ \vdots\\ a_{n-k+1}
\end{bmatrix}
=
\underbrace{
\begin{bmatrix}
c_1 & c_2 & \cdots & c_k\\
1 & 0 & \cdots & 0\\
\vdots & \ddots & \ddots & \vdots\\
0 & \cdots & 1 & 0
\end{bmatrix}
}_{\text{동반행렬 } M}
\begin{bmatrix}
a_{n-1}\\ a_{n-2}\\ \vdots\\ a_{n-k}
\end{bmatrix}
\Rightarrow
\begin{bmatrix}\mathbf{a}_n\end{bmatrix}
= M^{n-k+1}\begin{bmatrix}\mathbf{a}_{k-1}\end{bmatrix}
$$

- 고유분해로 닫힌형 얻기(피보나치의 Binet이 대표).

---

## 7. 알고리즘 점화식(분할정복): **마스터 정리/재귀트리/Akra–Bazzi**

### 7.1 마스터 정리(요약)
$$
T(n)=a\,T(n/b)+\Theta(n^d)
$$

| 비교 | 결과 |
|---|---|
| $$a<b^d$$ | $$T(n)=\Theta(n^d)$$ |
| $$a=b^d$$ | $$T(n)=\Theta(n^d\log n)$$ |
| $$a>b^d$$ | $$T(n)=\Theta(n^{\log_b a})$$ |

- 예) 머지소트: $$T(n)=2T(n/2)+n\Rightarrow \Theta(n\log n)$$

### 7.2 미묘한 결합항 (재귀트리 추천)
- $$T(n)=2T(n/2)+\frac{n}{\log n}\ \Rightarrow\ \Theta(n\log\log n)$$  
  (마스터 확장 공식 무비판 적용 금지)

### 7.3 Akra–Bazzi (비균등 분할 일반화)
$$
T(x)=\sum_{i=1}^a a_i T(b_i x)+g(x)
$$
- $$p$$ s.t. $$\sum a_i b_i^p=1$$  
- $$
T(x)=\Theta\!\Big(x^p\Big(1+\int_1^x \frac{g(u)}{u^{p+1}}\,du\Big)\Big)
$$

**예)** $$T(n)=T(n/3)+T(2n/3)+n\Rightarrow \Theta(n\log n)$$

---

## 8. 검증과 증명: 대입법(상한/하한), 귀납, 망원경

- **대입법**: 가설식 세우고 귀납으로 상수 조정  
- **망원경 합**: 1차 가변계수 전개에서 자주 등장  
- **생성함수·행렬**: 정확한 닫힌형 제공 → 코드로 수치 검증

---

## 9. 예제 모음 (완전 풀이 + 코드 검증)

### 9.1 예제 1 — 동차(서로 다른 근)
$$
a_n=4a_{n-1}-4a_{n-2},\quad a_0=1,\ a_1=2
$$
- 특성: $$(r-2)^2=0\Rightarrow \text{중복근 2}$$  
- 일반해: $$(A+Bn)2^n$$  
- 초기: $$n=0: A=1,\ n=1: (A+B)2=2\Rightarrow 2(1+B)=2\Rightarrow B=0$$  
- **정답**: $$\boxed{a_n=2^n}$$

**검증 코드**
```python
def ex1(n):
    a0,a1=1,2
    if n==0: return a0
    if n==1: return a1
    a,b=a0,a1
    for _ in range(2,n+1):
        a,b=b,4*b-4*a
    return b

for n in range(8):
    print(n, ex1(n), 2**n)
```

---

### 9.2 예제 2 — 비동차(다항 RHS)
$$
a_n=3a_{n-1}+2n+1,\quad a_0=0
$$

- 동차: $$A\cdot 3^n$$  
- 특수: $$Q_1(n)=an+b$$ 가정 후 대입
  $$
  an+b=3[a(n-1)+b]+2n+1
  =3an-3a+3b+2n+1
  $$
  비교:
  - $$n$$계수: $$a=3a+2\Rightarrow -2a=2\Rightarrow a=-1$$
  - 상수: $$b= -3(-1)+3b+1=3+3b+1\Rightarrow b=4+3b\Rightarrow -2b=4\Rightarrow b=-2$$  
- 특수해: $$a_n^{(p)}=-n-2$$  
- 전체: $$a_n=A\cdot 3^n - n - 2$$  
- 초기: $$0=A-0-2\Rightarrow A=2$$  
- **정답**: $$\boxed{a_n=2\cdot 3^n - n - 2}$$

**검증 코드**
```python
def ex2(n):
    a=0
    for k in range(1,n+1):
        a=3*a+2*k+1
    return a

def ex2_closed(n):
    return 2*(3**n) - n - 2

for n in range(10):
    print(n, ex2(n), ex2_closed(n))
```

---

### 9.3 예제 3 — 비동차(지수 공진)
$$
a_n=2a_{n-1}+5\cdot 2^n,\quad a_0=1
$$
- 동차: $$A\cdot 2^n$$  
- 특수: 공진 → $$a_n^{(p)}=C n 2^n$$  
  대입:
  $$
  Cn2^n = 2C(n-1)2^{n-1}+5\cdot 2^n
  \Rightarrow Cn=C(n-1)+5\Rightarrow C=5
  $$
- 전체: $$a_n=A\cdot 2^n+5n2^n$$  
- 초기: $$1=A+0\Rightarrow A=1$$  
- **정답**: $$\boxed{a_n=2^n(1+5n)}$$

**검증 코드**
```python
def ex3(n):
    a=1
    for k in range(1,n+1):
        a=2*a+5*(2**k)
    return a

def ex3_closed(n):
    return (2**n)*(1+5*n)

for n in range(8):
    print(n, ex3(n), ex3_closed(n))
```

---

### 9.4 예제 4 — 1차 가변계수(곱 인자)
$$
a_n = \Big(1+\frac{1}{n}\Big)a_{n-1}+1,\quad a_1=1
$$
- 곱 인자: $$P_n=\prod_{j=2}^n (1+\tfrac1j)=\frac{n+1}{2}$$  
- 전개:
  $$
  a_n=P_n a_1+\sum_{k=2}^n \big(1\cdot \tfrac{P_n}{P_k}\big)
  =\frac{n+1}{2}\cdot 1+\sum_{k=2}^n \frac{(n+1)/2}{(k+1)/2}
  =\frac{n+1}{2}+\sum_{k=2}^n \frac{n+1}{k+1}
  $$
  $$
  =\frac{n+1}{2} + (n+1)\sum_{t=3}^{n+1}\frac{1}{t}
  $$
- **정답(조화수로 표현)**:
  $$
  \boxed{a_n=\frac{n+1}{2} + (n+1)(H_{n+1}-1-\tfrac{1}{2})=(n+1)(H_{n+1}-1)}
  $$
  여기서 $$H_m=\sum_{t=1}^m \frac1t$$.

**검증 코드**
```python
import math
def ex4(n):
    if n==1: return 1
    a=1.0
    for k in range(2,n+1):
        a=(1+1/k)*a+1
    return a

def H(m): return sum(1.0/t for t in range(1,m+1))
def ex4_closed(n): return (n+1)*(H(n+1)-1)

for n in range(1,10):
    print(n, round(ex4(n),6), round(ex4_closed(n),6))
```

---

### 9.5 예제 5 — 생성함수(카탈란)
이미 §5.3에서 유도.  
코드로 초기값 생성:
```python
def catalan(n):
    C=[0]*(n+1)
    C[0]=1
    for m in range(1,n+1):
        C[m]=sum(C[i]*C[m-1-i] for i in range(m))
    return C[n]

for n in range(10):
    print(n, catalan(n))
```

---

### 9.6 예제 6 — 분할정복 복잡도(Akra–Bazzi)
$$
T(n)=T(\lceil n/5\rceil)+T(\lceil 7n/10\rceil)+cn
$$
- $$p$$ 만족: $$(1/5)^p+(7/10)^p=1$$ ⇒ **\(p=1\)** 부근  
- 적분항: $$\int_1^n \frac{u}{u^{1+1}}du=\int_1^n \frac{1}{u}du=\log n$$  
- **해**: $$\boxed{T(n)=\Theta(n)}$$ (정확히는 상수×\(n\))

---

## 10. 특수 주제: 공진 규칙 총정리

RHS가 $$P_m(n)\alpha^n \cos(\omega n)$$ 형태이고 특성근에  
- **실근 \(\alpha\)** 가 **중복도 \(s\)** 로 존재하면 → **$$n^s$$** 곱  
- 삼각은 **복소지수**로 바꿔 같은 규칙 적용

**예)** $$a_n-2a_{n-1}+a_{n-2}=3^n$$  
- 특성근 1이 중복 2, RHS는 \(3^n\) (공진 아님) → \(C\cdot 3^n\) 가정 OK.

---

## 11. 실수 많은 함정 체크리스트

- **초기조건 개수** = 동차차수와 일치? (해 결정 가능?)  
- **공진 무시** 금지(특수해에 **\(n^s\)** 곱!)  
- **마스터 정리 남용** 주의(예: \(n/\log n\)) → 재귀트리/아크라–바지  
- **복소근 해**는 실수로 재표현(코사인/사인)  
- **바닥/천장**은 보통 상수 계수 영향만 — \(\Theta\)는 동일하나, 정밀식은 주의

---

## 12. 연습문제 (풀이 스케치 포함)

1) $$a_n=5a_{n-1}-6a_{n-2},\ a_0=2,\ a_1=5$$  
   - 특성: \((r-2)(r-3)=0\) → \(a_n=A2^n+B3^n\) → 해 결정.

2) $$a_n=2a_{n-1}+n^2,\ a_0=0$$  
   - 동차: \(A2^n\), 특수: \(an^2+bn+c\) → 계수비교.

3) $$a_n-2a_{n-1}+a_{n-2}=2^n,\ a_0=0,\ a_1=1$$  
   - 동차: \((r-1)^2\) → \((A+Bn)\)  
   - 특수: \(C\cdot 2^n\) (공진 X) → 전체해.

4) $$T(n)=3T(n/2)+n,\ n=2^k$$  
   - \(a=3,b=2,d=1\) → \(a>b^d\) → \(\Theta(n^{\log_2 3})\).

5) $$T(n)=2T(n/2)+\dfrac{n}{\log n}$$  
   - 재귀트리로 \(\Theta(n\log\log n)\).

**검증 스니펫(2번)**
```python
def a2(n):
    a=0
    for k in range(1,n+1):
        a=2*a + k*k
    return a

# 해를 구한 뒤 a2(n)과 비교해보세요.
```

---

## 13. 요약 표

| 테마 | 핵심 요점 |
|---|---|
| 동차·상수계수 | 특성방정식, 중복근은 \(n^s\) 곱 |
| 비동차 | 동차해 + 특수해(미정계수/소거자), **공진 보정** |
| 1차 가변계수 | 전개·곱 인자·망원경 합 |
| 생성함수 | 컨볼루션·조합형(피보나치/카탈란) 강력 |
| 행렬 | 고유값으로 닫힌형(피보나치 Binet 등) |
| 분할정복 | 마스터/재귀트리/아크라–바지로 점근해 |
| 검증 | 대입법·귀납·코드 비교로 신뢰성 확보 |

---

## 14. 부록: 미니 레퍼런스

- **미정계수 추측 템플릿**  
  - \(g(n)=P_m(n)\alpha^n\Rightarrow Q_m(n)\alpha^n\)  
  - 공진 시 \(n^s\) 곱(동차근 \(\alpha\)의 중복도 \(s\))
- **복소근 실수화**  
  - \(r=\rho e^{i\theta}\Rightarrow \rho^n(C\cos n\theta+D\sin n\theta)\)
- **곱 인자**  
  - \(a_n=p(n)a_{n-1}+q(n)\Rightarrow\) 전개식으로 일반해

---

### 끝맺음

이 문서는 **유형 분류 → 해법 선택 → 예제 전개 → 코드 검증**의 흐름으로 점화식 해결력을 체계화했습니다.  
실전에서는 **공진 탐지**, **초기조건 일치**, **복잡도 해석 도구 선택**(마스터 vs 아크라–바지)만 정확히 지키면 대부분의 점화식을 안정적으로 해결할 수 있습니다.