---
layout: post
title: 디지털신호처리 - 차분 방정식의 해
date: 2025-11-11 14:25:23 +0900
category: 디지털신호처리
---
# 차분 방정식의 해

## 0. 맥락과 목표

앞선 글들(양측 Z-변환·역 Z-변환·시스템 표현·DTFT·LTI 응답)을 바탕으로, 본 글은 **선형 상수계수 차분방정식(LCCDE)**의 해법을 전 범위로 정리한다. 대상 표준형은 다음과 같다.

$$
\sum_{m=0}^{M} a_m\,y[n-m] \;=\; \sum_{k=0}^{K} b_k\,x[n-k], \qquad a_0=1.
$$

핵심 구성:
- **동차해 \(y_h[n]\)**: \(x[n]\equiv 0\)일 때의 해(특성방정식/중복근/복소근).
- **특해 \(y_p[n]\)**: 주어진 입력 \(x[n]\)으로부터의 한 해(특정계수법·주파수응답).
- **완전해 \(y[n]=y_h[n]+y_p[n]\)** 와 **초기조건**으로 상수 결정.
- **컨볼루션/그린함수** 관점과 **Z-변환**(양측/일측) 관점의 등가성.
- **상태공간**으로의 변환과 해, 안정성·인과성, 수치 검증(Octave).

---

## 1. 표준형·용어·기본 원리

### 1.1 표준형과 AR/MA 해석
아래 꼴이 흔하다(디지털 필터):
$$
y[n] + a_1 y[n-1] + \cdots + a_M y[n-M] \;=\; b_0 x[n] + b_1 x[n-1] + \cdots + b_K x[n-K].
$$
좌변은 **AR(M)**(자기회귀), 우변은 **MA(K)**(이동평균). Z-영역에선
$$
H(z)=\frac{Y(z)}{X(z)}=\frac{B(z)}{A(z)}=\frac{\sum_{k=0}^K b_k z^{-k}}{1+\sum_{m=1}^M a_m z^{-m}}.
$$

### 1.2 동차·특해·완전해
- 동차식 \(x[n]\equiv 0\):  
  $$y[n] + a_1 y[n-1] + \cdots + a_M y[n-M] = 0.$$
  가정 \(y[n]=r^n\) ⇒ **특성방정식**  
  $$r^M + a_1 r^{M-1} + \cdots + a_M=0.$$
- 동차해 조합:
  - 서로 다른 실근 \(r_i\): \(y_h[n]=\sum_i C_i r_i^n\).
  - **중복근** \(r\) (중복도 \(d\)): \(y_h[n]=\sum_{\ell=0}^{d-1} C_\ell n^\ell r^n\).
  - **복소근** \(r=\rho e^{\pm j\omega_0}\): \(y_h[n]=\rho^n (A\cos\omega_0 n + B\sin\omega_0 n)\).
- 특해 \(y_p[n]\): 입력 패턴에 맞춘 **형태 가정**(특정계수법) 또는 **Z-변환/주파수응답**으로 도출.
- 완전해 \(y[n]=y_h[n]+y_p[n]\): **초기조건**으로 \(C_i\) 결정.

---

## 2. 특정계수법(Undetermined Coefficients) — 패턴 총정리

### 2.1 지수 입력
입력 \(x[n]=\alpha^n\)에 대해 \(y_p[n]=K\alpha^n\)를 가정(단, **충돌** 시 예외). 식에 대입하면
$$
A(\alpha)\,K\,\alpha^n = B(\alpha)\,\alpha^n \;\Rightarrow\; K=\frac{B(\alpha)}{A(\alpha)},\quad A(r)=r^M + a_1 r^{M-1}+\cdots+a_M.
$$
- **충돌**: \(\alpha\)가 \(A(r)\)의 근(중복도 \(d\))이면 \(y_p[n]=K n^d \alpha^n\).

### 2.2 사인/코사인 입력
\(x[n]=U\cos(\omega_0 n)+V\sin(\omega_0 n)\) ⇒
$$
y_p[n]=A\cos(\omega_0 n)+B\sin(\omega_0 n).
$$
복소지수 \(\alpha=e^{j\omega_0}\)로 보면 \(K=\dfrac{B(\alpha)}{A(\alpha)}\)의 크기·위상과 일치.  
**공진(충돌)**: \(\alpha=e^{j\omega_0}\)가 근이면 \(y_p\)에 **\(n\)** 승수 추가.

### 2.3 다항 입력
\(x[n]=\sum_{r=0}^R c_r n^r\) ⇒ \(y_p[n]=\sum_{r=0}^R d_r n^r\).  
**충돌**(특성근 \(r=1\)과 상수항 등) 시 **\(n\)** 승수 증가.

### 2.4 곱 구조
\(x[n]= n^q\,\alpha^n\,\cos(\omega_0 n)\)와 같은 곱은 위 규칙을 합성.  
충돌 차수만큼 \(n\)의 승수를 **추가**.

---

## 3. 제로입력/제로상태, 컨볼루션/그린함수

- **제로입력(ZI)**: 초기조건만으로 발생하는 해 ⇒ 동차해 \(y_h[n]\)에서 상수로 결정.
- **제로상태(ZS)**: 초기조건 0, 입력만으로 생성 ⇒
  $$y_{ZS}[n]=(x*h)[n]=\sum_{k=-\infty}^{\infty} x[k]\,h[n-k],\quad h[n]=\mathcal{Z}^{-1}\{H(z)\}.$$
- **완전해**: \(y[n]=y_{ZI}[n]+y_{ZS}[n]\).

---

## 4. Z-변환으로 푸는 방법(양측·일측)

### 4.1 양측 Z-변환
초기조건 0 가정에서
$$
Y(z)A(z)=X(z)B(z)\ \Rightarrow\ Y(z)=H(z)X(z)=\frac{B(z)}{A(z)}X(z).
$$
표준항의 **역 Z-변환**으로 \(y[n]\) 복원.

### 4.2 일측 Z-변환(초기조건 포함)
일측 정의 \(\mathcal{Z}_+\{x[n]\}=\sum_{n=0}^\infty x[n] z^{-n}\).  
시프트 성질(대표):
$$
\mathcal{Z}_+\{y[n-1]\}=z^{-1}Y_+(z) + y[-1],\qquad
\mathcal{Z}_+\{y[n-2]\}=z^{-2}Y_+(z)+z^{-1}y[-1]+y[-2].
$$
따라서 LCCDE에 적용하면 **초기조건 항**이 우변에 추가되어 \(Y_+(z)\)를 대수적으로 구하고 역변환한다.

---

## 5. 상태공간 해(Companion Form 포함)

### 5.1 Companion(제어가능 표준형)
식
$$
y[n] + a_1 y[n-1]+\cdots+a_M y[n-M] = \sum_{k=0}^K b_k x[n-k]
$$
의 상태를 \(\mathbf{x}[n]=[\,y[n-1],\,y[n-2],\dots,y[n-M]\,]^T\)로 두면
$$
\mathbf{x}[n+1]=
\begin{bmatrix}
 -a_1 & -a_2 & \cdots & -a_M\\
 1 & 0 & \cdots & 0\\
 \vdots & & \ddots & \vdots\\
 0 & \cdots & 1 & 0
\end{bmatrix}\mathbf{x}[n]
+
\begin{bmatrix} b_0\\0\\ \vdots \\ 0\end{bmatrix} x[n]
,\quad
y[n]=\begin{bmatrix} 1&0&\cdots&0\end{bmatrix}\mathbf{x}[n]+\sum_{k=1}^K b_k x[n-k].
$$

### 5.2 해
$$
\mathbf{x}[n]=A^n\mathbf{x}[0]+\sum_{k=0}^{n-1} A^{n-1-k}B\,u[k],\quad
y[n]=C\mathbf{x}[n]+D u[n].
$$

---

## 6. 안정성·인과성·최종값

- **BIBO 안정**: 모든 극 \(|p_i|<1\) ⇔ \(\sum_n |h[n]|<\infty\).  
- **인과성**: \(h[n]=0\ (n<0)\) ⇔ ROC가 **무한대 포함**(우측 신호).  
- **최종값(일측 맥락)**:  
  $$\lim_{n\to\infty} y[n]=\lim_{z\to 1}(1-z^{-1})Y_+(z),\quad \text{(적절한 극 조건)}.$$

---

## 7. 예제 1 — 서로 다른 실근, 지수 입력(특정계수법·Z-검증)

### 7.1 문제
$$
y[n]-1.1\,y[n-1]+0.24\,y[n-2]=x[n],\qquad x[n]=(0.5)^n u[n],\quad y[-1]=y[-2]=0.
$$

### 7.2 해설
특성방정식 \(r^2-1.1r+0.24=0\Rightarrow r_1=0.8,\ r_2=0.3\).
동차해 \(y_h[n]=C_1(0.8)^n+C_2(0.3)^n\).  
특해 \(y_p[n]=K(0.5)^n\),  
$$
A(\alpha)=\alpha^2-1.1\alpha+0.24,\quad B(\alpha)=1 \ \Rightarrow\ K=\frac{1}{A(0.5)}=\frac{1}{0.25-0.55+0.24}=-\frac{1}{0.06}\approx -16.\bar{6}.
$$
초기조건 0이면 제로상태 응답이 지배 ⇒ \(y\simeq y_p\)에 과도 \(y_h\)이 더해지고 소멸.

### 7.3 GNU Octave
```octave
## 예제 1
clear; close all; clc; pkg load signal
a = [1 -1.1 0.24];      % y -1.1 z^-1 +0.24 z^-2
b = [1 0 0];            % x[n]
N=80; n=0:N-1; x=(0.5).^n;
y = filter(b,a,x);      % 제로상태
K = 1/(0.25 - 0.55 + 0.24);  % = -16.666...
yp = K*(0.5).^n;

plot(n, y, 'k.-'); hold on; plot(n, yp, 'r--'); grid on
legend('filter(ZS)','particular guess'); title('예제1: 특정계수법 vs ZS'); xlabel('n');
printf("tail RMS error (n>=30) = %.3e\n", rms(y(31:end) - yp(31:end)));
```

---

## 8. 예제 2 — 중복근 + 코사인 입력(정상상태는 주파수응답)

### 8.1 문제
$$
y[n]-1.2y[n-1]+0.36y[n-2]=\cos(0.3\pi n)\,u[n],\quad y[-1]=y[-2]=0.
$$

### 8.2 해설
중복근 \(r=0.6\) ⇒ \(y_h[n]=(C_1+C_2 n)0.6^n\).  
특해(정상상태)는 \(H(e^{j\omega_0})\)로:
$$
y_{ss}[n]=|H(e^{j\omega_0})|\cos\big(\omega_0 n+\angle H(e^{j\omega_0})\big),\quad \omega_0=0.3\pi.
$$

### 8.3 GNU Octave
```octave
## 예제 2
clear; close all; clc; pkg load signal
a=[1 -1.2 0.36]; b=[1 0 0];
N=160; n=0:N-1; x=cos(0.3*pi*n);
y = filter(b,a,x);
H0 = freqz(b,a,0.3*pi);  % 점 평가
yss = abs(H0)*cos(0.3*pi*n + angle(H0));

plot(n, y, 'k'); hold on; plot(n, yss, 'r--'); grid on
xlim([0 160]); legend('output','steady-state via H'); title('예제2: 중복근 + 코사인');
printf("tail RMS (n>=80) = %.3e\n", rms(y(81:end) - yss(81:end)));
```

---

## 9. 예제 3 — 공진(충돌) 사례: \(y[n]-0.5y[n-1]=(0.5)^n\)

### 9.1 해설
특성근 \(0.5\)와 입력 지수 \(\alpha=0.5\) **충돌** ⇒
$$
y_p[n]=K\,n\,(0.5)^n,\quad \text{대입으로 }K \text{ 결정}.
$$
또는 \(K=\dfrac{B(\alpha)}{A'(\alpha)}\) 규칙(1차 충돌)도 유도 가능.

### 9.2 GNU Octave
```octave
## 예제 3
clear; close all; clc; pkg load signal
a=[1 -0.5]; b=[1]; N=80; n=0:N-1; x=(0.5).^n;
y = filter(b,a,x);

## 충돌 해석: y_p = K n (0.5)^n
## 대입: y - 0.5 y[n-1] = (0.5)^n
## K 계산(수치): 최소자승으로 K 적합
phi = n .* (0.5).^n;  % basis
K = (phi*phi') \ (phi*y');  % 간단 적합
yp = K*phi;

plot(n, y, 'k.-'); hold on; plot(n, yp, 'r--'); grid on
legend('output','K n (0.5)^n fit'); title(sprintf('예제3: 충돌 K≈%.4f', K));
```

---

## 10. 예제 4 — 다항 입력: \(y[n]-y[n-1]=n\)

### 10.1 해설
동차 \(y_h[n]=C\).  
특해는 다항 2차까지 가정: \(y_p[n]=a n^2 + b n + c\). 대입하면
$$
(an^2+bn+c)-(a(n-1)^2+b(n-1)+c)=n \Rightarrow 2a n - a + b = n.
$$
계수 비교 ⇒ \(2a=1\Rightarrow a=\tfrac{1}{2}\), \(-a+b=0\Rightarrow b=\tfrac{1}{2}\).  
\(c\)는 초기조건으로 결정.

### 10.2 GNU Octave
```octave
## 예제 4
clear; close all; clc
a=[1 -1]; b=[1]; N=50; n=0:N-1; x = n;
y=filter(b,a,x);
yform = 0.5*n.^2 + 0.5*n;  % c=0 가정(ZS)
plot(n,y,'k.-'); hold on; plot(n,yform,'r--'); grid on
legend('output','0.5 n^2 + 0.5 n'); title('예제4: 다항 입력');
printf("RMS = %.3e\n", rms(y - yform));
```

---

## 11. 예제 5 — 일측 Z-변환으로 초기조건 처리

### 11.1 문제
초기조건 \(y[-1]=1,\ y[-2]=0\)에서
$$
y[n]-1.1y[n-1]+0.24y[n-2]=\delta[n].
$$

### 11.2 해설
완전해 \(=\) 제로상태(임펄스응답) \(+\) 제로입력(동차). 일측 Z-변환으로도 동일한 결과.

### 11.3 GNU Octave
```octave
## 예제 5
clear; close all; clc; pkg load signal
a=[1 -1.1 0.24]; b=[1 0 0];
N=80; n=0:N-1; x=[1, zeros(1,N-1)];    % delta

% ZS
y_zs = filter(b,a,x);

% ZI: y_h[n] = C1*0.8^n + C2*0.3^n, y[-1]=1, y[-2]=0
A=[0.8^-1, 0.3^-1; 0.8^-2, 0.3^-2]; rhs=[1;0];
C = A\rhs; C1=C(1); C2=C(2);
y_zi = C1*(0.8).^n + C2*(0.3).^n;

y = y_zs + y_zi;
plot(n,y,'k.-'); hold on; plot(n,y_zs,'r--'); plot(n,y_zi,'b-.'); grid on
legend('total','ZS','ZI'); title('예제5: 일측 Z와 등가 (total=ZS+ZI)');
```

---

## 12. 예제 6 — 컨볼루션(그린함수)로 직접 해
```octave
## 예제 6
clear; close all; clc; pkg load signal
[b,a]=butter(3,0.35);
N=256; n=0:N-1;
x = (rand(1,N)-0.5)*0.2;
h = impz(b,a,N);
y1 = filter(b,a,x);
y2 = conv(x,h); y2 = y2(1:N);
plot(n,y1,'k'); hold on; plot(n,y2,'r--'); grid on
legend('filter','conv'); title('예제6: filter = conv with h');
printf("RMS = %.3e\n", rms(y1 - y2));
```

---

## 13. 상태공간 구현·검증(Companion Form)

### 13.1 A,B,C,D 구성과 필터 등가성
```octave
## 예제 7: 상태공간 vs filter
clear; close all; clc

a1=1.1; a2=-0.24; b0=1;              % y -1.1 y[n-1] +0.24 y[n-2] = x
A=[a1 a2; 1 0]; B=[b0; 0]; C=[1 0]; D=0;

N=80; n=0:N-1; x=(0.5).^n;
xstate=zeros(2,1); yss=zeros(1,N);
for k=1:N
  yss(k)=C*xstate + D*x(k);
  xstate = A*xstate + B*x(k);
end

a=[1 -a1 -a2]; b=[b0 0 0];
yflt = filter(b,a,x);
printf("RMS(state,filter)=%.3e\n", rms(yss - yflt));
```

---

## 14. 구현·분석 체크리스트(실무 포인트)

1) **충돌 감지**: 입력의 지수/주파수/다항 차수가 특성근과 겹치면 \(n^d\) 승수 추가.  
2) **비정상형**(분자 차수 ≥ 분모 차수) \(H(z)\): 다항 나눗셈으로 \(\delta\)-항 분리.  
3) **중복근**: 동차해 \(n r^n\) 성분으로 과도 응답이 크게 나타날 수 있음(수치 오버슈트 주의).  
4) **SOS(2차 섹션)**: 고차 IIR은 2차 블록으로 분해해 수치 안정 개선.  
5) **최종값·정적 이득**: 계단입력에서 \(\lim y[n]=H(z)\)의 \(z\to 1\) 평가(조건 충족 시).  
6) **주파수응답법**: 사인 입력의 정상상태는 \(H(e^{j\omega_0})\)로 즉시 예측.  
7) **일측 Z**: 초기조건 항 자동 포함. 시프트 공식 숙지(\(z^{-1}Y_+(z)+y[-1]\) 등).  
8) **컨볼루션**: 전구간 응답은 \(x*h\). 빠른 검증 루틴으로 활용.  
9) **상태공간**: 동등성 확인·고급 제어 분석(제어가능/관측가능/극배치)에 유용.

---

## 15. 빠른 레퍼런스(Guess 테이블)

| 입력 \(x[n]\) | 후보 \(y_p[n]\) | 충돌 시(근/차수) |
|---|---|---|
| \(\alpha^n\) | \(K\alpha^n\) | \(K n^d \alpha^n\) |
| \(\cos\omega_0 n,\,\sin\omega_0 n\) | \(A\cos\omega_0 n + B\sin\omega_0 n\) | \(\times n^d\) |
| \(n^R\) | \(\sum_{r=0}^R d_r n^r\) | \(\times n^d\) |
| \(n^q \alpha^n\) | \(\sum_{r=0}^q d_r n^r \alpha^n\) | \(\times n^d\) |
| \(n^q \alpha^n \cos\omega_0 n\) | \(\sum_{r=0}^q n^r\big(A\cos+B\sin\big)\alpha^n\) | \(\times n^d\) |

여기서 \(d\)는 특성다항식의 **충돌 중복도**.

---

## 16. 연습문제(풀이·Octave 스케치 포함)

### 문제 A — 지수 입력
$$
y[n]-0.8y[n-1]=2\cdot(0.5)^n,\quad y[-1]=0.
$$
- \(y_h[n]=C(0.8)^n\). \(y_p[n]=K(0.5)^n\), \(K=\frac{2}{0.25-0.4}=-\frac{2}{0.15}\).
```octave
clear; close all; clc
a=[1 -0.8]; b=[2]; N=80; n=0:N-1; x=(0.5).^n;
y=filter(b,a,x); plot(n,y,'k.-'); grid on; title('문제A');
```

### 문제 B — 충돌
$$
y[n]-0.5y[n-1]=(0.5)^n,\quad y[-1]=0.
$$
- \(y_p[n]=K n (0.5)^n\). K를 대입/적합으로 산정(예제 3 참조).

### 문제 C — 사인 입력 공진
$$
y[n]-1.4\cos\omega_0\,y[n-1]+0.49y[n-2]=\cos(\omega_0 n).
$$
- 동차근 \(0.7e^{\pm j\omega_0}\)와 입력 주파수 일치 ⇒ \(y_p\)에 \(\times n\).

### 문제 D — 다항 입력
$$
y[n]-y[n-1]=3n+2.
$$
- \(y_p[n]=a n^2+bn+c\)로 가정 후 계수비교.

---

## 17. 결론
LCCDE의 해는 **동차 + 특해**의 원리로 일관되며, 특성방정식과 **충돌 차수**가 해의 형태(다항×지수×삼각함수)를 결정한다. 입력 패턴에 맞춘 **특정계수법**, 주파수영역의 **\(H(e^{j\omega})\)**, 시간영역의 **컨볼루션/그린함수**, 대수적 **Z-변환**(초기조건 포함 시 일측)과 **상태공간**은 서로 등가인 도구 세트다. 본문 Octave 루틴으로 각 단계의 결과를 상호 검증하면서, 설계(해 가정) → 해석(검증) → 구현(필터/상태공간)의 닫힌 고리를 완성하라.