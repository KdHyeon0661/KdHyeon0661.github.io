---
layout: post
title: AspNet - ë¯¸ë“¤ì›¨ì–´ íë¦„
date: 2025-04-02 21:20:23 +0900
category: AspNet
---
# ğŸ”„ ASP.NET Core ê¸°ë³¸ ë¯¸ë“¤ì›¨ì–´ íë¦„ ì •ë¦¬

---

## âœ… ASP.NET Coreì—ì„œ ë¯¸ë“¤ì›¨ì–´ë€?

- ë¯¸ë“¤ì›¨ì–´ëŠ” ìš”ì²­(Request)ê³¼ ì‘ë‹µ(Response) ì‚¬ì´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì»´í¬ë„ŒíŠ¸
- ìˆœì„œëŒ€ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³ , ê·¸ì— ë”°ë¼ ì‘ë‹µì„ ìƒì„±í•˜ê±°ë‚˜ ë‹¤ìŒìœ¼ë¡œ ë„˜ê¹€
- `Program.cs`ì—ì„œ êµ¬ì„±

---

## ğŸ§± í•µì‹¬ ë¯¸ë“¤ì›¨ì–´ êµ¬ì„± ìš”ì†Œ

| ë¯¸ë“¤ì›¨ì–´            | ì—­í•  |
|---------------------|------|
| `UseStaticFiles()`   | ì •ì  íŒŒì¼ ì„œë¹™ (wwwroot) |
| `UseRouting()`       | ìš”ì²­ ê²½ë¡œ(URL)ë¥¼ ë¶„ì„í•´ ë¼ìš°íŒ… ì„¤ì • |
| `UseAuthentication()`| ì‚¬ìš©ì ì¸ì¦ ì²˜ë¦¬ |
| `UseAuthorization()` | ì¸ì¦ëœ ì‚¬ìš©ìì˜ ê¶Œí•œ ê²€ì‚¬ |
| `UseEndpoints()`     | ì‹¤ì œ ë¼ìš°íŠ¸ ì‹¤í–‰ (Controller, RazorPage ë“±) |

---

## ğŸ” ë¯¸ë“¤ì›¨ì–´ ì‹¤í–‰ íë¦„ (ì „ì²´ êµ¬ì¡°)

```csharp
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

app.UseStaticFiles();          // 1. ì •ì  íŒŒì¼ ìš”ì²­ ì²˜ë¦¬
app.UseRouting();              // 2. ìš”ì²­ URL ê¸°ë°˜ ë¼ìš°íŒ… ì„¤ì •
app.UseAuthentication();       // 3. ì‚¬ìš©ì ì¸ì¦ ì²˜ë¦¬
app.UseAuthorization();        // 4. ê¶Œí•œ ê²€ì‚¬
app.UseEndpoints(endpoints =>  // 5. ë¼ìš°íŒ…ëœ ìš”ì²­ ì‹¤í–‰
{
    endpoints.MapRazorPages();
    endpoints.MapControllers();
});

app.Run();
```

---

## ğŸ§­ 1. `UseStaticFiles()`

- `wwwroot` í´ë” ë‚´ì˜ CSS, JS, ì´ë¯¸ì§€ ë“± **ì •ì  íŒŒì¼ì„ ì§ì ‘ ì„œë¹™**í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´
- í•´ë‹¹ ê²½ë¡œì— íŒŒì¼ì´ ìˆìœ¼ë©´ **íŒŒì´í”„ë¼ì¸ì´ ì¢…ë£Œë˜ê³  ì‘ë‹µë¨**

```csharp
app.UseStaticFiles();
```

> ì˜ˆ: `/images/logo.png` ìš”ì²­ ì‹œ `wwwroot/images/logo.png` íŒŒì¼ì´ ìë™ ì‘ë‹µë¨

---

## ğŸ§­ 2. `UseRouting()`

- ìš”ì²­ ê²½ë¡œ(URL)ë¥¼ ë¶„ì„í•˜ê³ , **ì–´ë–¤ í•¸ë“¤ëŸ¬(Razor Page, Controller ë“±)ì— ë§¤í•‘í• ì§€ ê²°ì •**
- ë‹¨ë…ìœ¼ë¡œëŠ” ì•„ë¬´ ì¼ë„ í•˜ì§€ ì•Šì§€ë§Œ, `UseEndpoints`ì™€ í•¨ê»˜ ì‚¬ìš©ë¨

```csharp
app.UseRouting();
```

> ì´ ì‹œì ì—ì„œ `HttpContext.GetRouteData()`ê°€ ì„¤ì •ë¨

---

## ğŸ§­ 3. `UseAuthentication()`

- ì¸ì¦ ì •ë³´ë¥¼ ê²€ì‚¬í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´
- ì¿ í‚¤, JWT, OAuth ë“±ìœ¼ë¡œ ë¡œê·¸ì¸ëœ ì‚¬ìš©ìì¸ì§€ íŒë‹¨
- `HttpContext.User` ê°ì²´ë¥¼ ì„¤ì •í•¨

```csharp
app.UseAuthentication();
```

> `User.Identity.IsAuthenticated`ê°€ true/falseë¡œ ê²°ì •ë¨

---

## ğŸ§­ 4. `UseAuthorization()`

- ì¸ì¦ëœ ì‚¬ìš©ìì˜ **ê¶Œí•œ(Role, ì •ì±… ë“±)**ì„ í™•ì¸í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´
- `[Authorize]` ë˜ëŠ” `[Authorize(Roles="Admin")]` ë“±ì˜ ì†ì„±ì„ ê²€ì‚¬

```csharp
app.UseAuthorization();
```

> ê¶Œí•œì´ ì—†ìœ¼ë©´ 403 Forbidden ì‘ë‹µ

---

## ğŸ§­ 5. `UseEndpoints(...)`

- ë¼ìš°íŒ… ì •ë³´ë¥¼ ì´ìš©í•´ ì‹¤ì œ **í•¸ë“¤ëŸ¬ ì‹¤í–‰** (ì»¨íŠ¸ë¡¤ëŸ¬, í˜ì´ì§€ ë“±)
- `MapControllers()`, `MapRazorPages()` ë“±ì„ ì„¤ì •

```csharp
app.UseEndpoints(endpoints =>
{
    endpoints.MapRazorPages();
    endpoints.MapControllers();
});
```

> ìš”ì²­ì´ ì–´ë–¤ ì»¨íŠ¸ë¡¤ëŸ¬/í˜ì´ì§€ë¡œ ì—°ê²°ë˜ëŠ”ì§€ëŠ” ì—¬ê¸°ì„œ ìµœì¢… ê²°ì •ë¨

---

## ğŸ”„ ë¯¸ë“¤ì›¨ì–´ ë™ì‘ ìˆœì„œ ì˜ˆì‹œ (Razor Pages ê¸°ì¤€)

```text
[ìš”ì²­] /products/list
  â†“
UseStaticFiles            â†’ íŒŒì¼ ì—†ìœ¼ë¯€ë¡œ í†µê³¼
  â†“
UseRouting                â†’ ìš”ì²­ URL ë¶„ì„ (/products/list)
  â†“
UseAuthentication         â†’ ì‚¬ìš©ì ì¸ì¦ ê²€ì‚¬ â†’ ClaimsPrincipal ì„¤ì •
  â†“
UseAuthorization          â†’ ê¶Œí•œ í™•ì¸ (Authorize attribute)
  â†“
UseEndpoints              â†’ Razor Page ì‹¤í–‰ (Pages/Products/List.cshtml)
```

---

## â— ë¯¸ë“¤ì›¨ì–´ ìˆœì„œ ì£¼ì˜!

| ìœ„ì¹˜ | ì˜ëª»ëœ ì˜ˆ | ì˜¬ë°”ë¥¸ ì˜ˆ |
|------|------------|------------|
| `UseRouting()` ì´í›„ `UseAuthorization()` í•„ìš” | âŒ `UseAuthorization()` ì „ì— `UseRouting()`ì´ ì—†ìœ¼ë©´ ë¼ìš°íŒ… ì •ë³´ ì—†ìŒ |
| `UseAuthentication()` ëˆ„ë½ | âŒ `User.Identity.IsAuthenticated == false` |
| `UseEndpoints()`ëŠ” ë§ˆì§€ë§‰ì— | âœ… ìµœì¢… ì‹¤í–‰ ë¼ìš°í„° ì—°ê²° |

---

## âœ… ìš”ì•½ ì •ë¦¬

| ë¯¸ë“¤ì›¨ì–´           | ì—­í•  |
|--------------------|------|
| `UseStaticFiles()`  | wwwrootì˜ íŒŒì¼ ì§ì ‘ ë°˜í™˜ |
| `UseRouting()`      | URL ë§¤í•‘ ì •ë³´ ë¶„ì„ |
| `UseAuthentication()`| ì‚¬ìš©ì ë¡œê·¸ì¸ ì •ë³´ í™•ì¸ |
| `UseAuthorization()`| ë¡œê·¸ì¸ í›„ ê¶Œí•œ(Role, Policy) í™•ì¸ |
| `UseEndpoints()`    | ì‹¤ì œ ë¼ìš°í„° ì‹¤í–‰ (Controller, RazorPage ë“±) |