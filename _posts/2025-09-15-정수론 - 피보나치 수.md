---
layout: post
title: 정수론 - 피보나치 수
date: 2025-09-15 18:25:23 +0900
category: 정수론
---
# 피보나치 수 — 인물, 수열, 그리고 핵심 등식들(증명 포함)

> **구성/원칙**
> - 예제는 **적게** 두되 **아주 자세히** 전개한다.
> - 가능한 곳에 **증명**(또는 엄밀한 증명 스케치)을 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.
> - 표기: $$\mathbb{N}=\{0,1,2,\dots\}$$, $$F_n$$은 **피보나치 수**, $$L_n$$은 **루카스 수**.

---

## — 역사적 배경 한 줄

**레오나르도 피사(Leonardo of Pisa, Fibonacci, c.1170–c.1240)** 는 『Liber Abaci(1202)』에서 토끼 번식 문제로 유명한 수열을 소개했다. 오늘날 “피보나치 수열”은 **선형 점화식, 생성함수, 행렬, 조합해석, 수론**을 잇는 대표적 다리다.

---

## 피보나치 수열의 정의와 기초 성질

### 정의

$$
F_0=0,\quad F_1=1,\quad F_{n+2}=F_{n+1}+F_n\quad (n\ge 0).
$$

처음 몇 항:
$$
0,1,1,2,3,5,8,13,21,34,55,\dots
$$

### 기본 불변식(항등식)

- **추가 공식(덧셈정리)**
  임의의 정수 \(m,n\ge 0\) 에 대해
  $$
  \boxed{\,F_{m+n}=F_{m-1}F_n+F_m F_{n+1}\,}\quad(m\ge 1).
  $$
- **짝수/홀수 성질**
  \(F_{2k}\) 는 짝수, \(F_{2k+1}\) 은 홀수와 번갈아 나타나며
  $$
  F_{2k}=F_k L_k,\qquad F_{2k+1}=F_k^2+F_{k+1}^2
  $$
  (여기서 \(L_n\) 은 루카스 수, §5.3 참조).
- **단조성과 성장**
  \(n\ge 1\) 에서 \(F_{n+1} > F_n\). 또한 \(F_n\) 은 지수적으로 성장(§3).

**증명 스케치(덧셈정리)**: §4(행렬법) 또는 §3(생성함수), 혹은 **강한 귀납법**으로도 가능. 예를 들어 \(n\) 고정, \(m\)에 대한 귀납으로
\(
F_{(m+1)+n}=F_{m+n}+F_{m-1+n}
\)
에 귀납가정을 대입해 정리한다. □

---

## 해 닫힌식(Binet), 근사, 경계

### 특성방정식과 Binet 공식

점화식 \(x_{n+2}=x_{n+1}+x_n\) 의 특성방정식은
$$
r^2=r+1\quad\Rightarrow\quad r=\varphi:=\frac{1+\sqrt5}{2},\quad \hat\varphi:=\frac{1-\sqrt5}{2}.
$$
초기값을 맞추면
$$
\boxed{\,F_n=\frac{\varphi^n-\hat\varphi^n}{\sqrt5}\,}\quad(n\ge 0).
$$

### 근사와 **반올림 공식**

\(\lvert \hat\varphi\rvert<1\) 이므로 \(|\hat\varphi^n|<\tfrac12\) (충분히 큰 \(n\)은 물론 모든 \(n\)에 대해 \(<\tfrac12\)가 성립). 따라서
$$
\left|F_n-\frac{\varphi^n}{\sqrt5}\right|=\frac{|\hat\varphi|^n}{\sqrt5}<\tfrac12,
$$
즉
$$
\boxed{\,F_n=\left\lfloor \frac{\varphi^n}{\sqrt5}+\tfrac12\right\rfloor\,}.
$$

### 간단 경계

\(n\ge 0\)에 대해
$$
\frac{\varphi^{n-1}}{\sqrt5}\le F_n\le \frac{\varphi^n}{\sqrt5}.
$$
(좌우는 Binet에 \(|\hat\varphi^n|\le 1\) 등을 이용.) 성장률은 \(F_{n+1}/F_n\to \varphi\).

---

## 생성함수(Generating function)

생성함수 \(G(x):=\sum_{n\ge 0} F_n x^n\) 을 잡으면
$$
G(x)=\frac{x}{1-x-x^2}.
$$
**증명**: \(G-xG-x^2G=\sum_{n\ge 0}(F_n-F_{n-1}-F_{n-2})x^n\) 에서 점화식을 대입(초기항 조정)하면 분수식이 된다.
분모의 인수분해와 부분분수 전개로 **Binet**을 재도출할 수 있다.

> 보너스: 루카스 수의 생성함수는 \(\displaystyle \sum_{n\ge 0} L_n x^n=\frac{2-x}{1-x-x^2}\).

---

## 행렬 표현과 빠른 제곱(빠른 곱셈)

### 기본 행렬

$$
A:=\begin{pmatrix}1&1\\[2pt]1&0\end{pmatrix},\qquad
A^n=\begin{pmatrix}F_{n+1}&F_n\\[2pt]F_n&F_{n-1}\end{pmatrix}\quad(n\ge 1).
$$
**증명**: \(n=1\)에서 성립. \(A^{n+1}=A^n A\) 를 곱하면 행렬 우상단/좌상단이 각각 \(F_{n+1}+F_n=F_{n+2}\), \(F_{n+1}\) 이 되어 귀납이 닫힌다. □

이로부터 즉시
- **카시니(Cassini) 등식**
  $$
  \boxed{\,F_{n+1}F_{n-1}-F_n^2=(-1)^n\,}\quad(\det A=-1\ \text{을 }\det A^n=(-1)^n\ \text{과 비교}).
  $$

### 공식

임의 \(n\ge 0\)에 대해
$$
\begin{aligned}
F_{2n}&=F_n\,(2F_{n+1}-F_n),\\
F_{2n+1}&=F_{n+1}^2+F_n^2.
\end{aligned}
$$

이를 이용하면 \(O(\log n)\) 시간에 \(F_n\) 계산:

```python
# 빠른 두배: (F_n, F_{n+1})를 반환

def fib(n):
    if n == 0:
        return (0, 1)
    (a, b) = fib(n // 2)        # a=F_k, b=F_{k+1}, k=n//2
    c = a * (2*b - a)           # c=F_{2k}
    d = a*a + b*b               # d=F_{2k+1}
    if n % 2 == 0:
        return (c, d)
    else:
        return (d, c + d)
```

---

## 대표 등식들(증명 포함)

### 덧셈 공식(재진술)

$$
\boxed{\,F_{m+n}=F_{m-1}F_n+F_mF_{n+1}\,}\quad(m\ge 1,n\ge 0).
$$
**증명 A(행렬)**: \(A^{m+n}=A^mA^n\) 의 \((1,2)\) 성분 비교.
**증명 B(귀납)**: §1.2 참조.

### 도블링/합성 공식

덧셈공식을 \(m=n\)에 적용하면
$$
F_{2n}=F_{n-1}F_n+F_nF_{n+1}=F_n(2F_{n+1}-F_n),
$$
$$
F_{2n+1}=F_{n+1}^2+F_n^2.
$$

### 루카스 수와의 관계

루카스 수 \(L_n\)을
$$
L_0=2,\ L_1=1,\ L_{n+2}=L_{n+1}+L_n
$$
으로 두면
$$
\boxed{\,L_n=F_{n-1}+F_{n+1}\,},\qquad
\boxed{\,F_{2n}=F_n L_n\,}.
$$
**증명**: 생성함수로 바로 확인 가능. 혹은 Binet에서 \(\varphi^n+\hat\varphi^n=L_n\) 임을 쓰면 된다.

### 카시니(Cassini), 카탈랑(Catalan), 도카뉴(d’Ocagne)

- **Cassini**
  $$
  \boxed{\,F_{n+1}F_{n-1}-F_n^2=(-1)^n\,}.
  $$
  **증명**: §4.1.

- **Catalan의 항등식**(임의의 정수 \(a,b\))
  $$
  \boxed{\,F_a^2-F_{a-b}\,F_{a+b}=(-1)^{a-b}F_b^2\,}.
  $$
  **증명 스케치**: Binet으로 전개해 \(\varphi\hat\varphi=-1\) 을 이용해 정리.

- **d’Ocagne의 항등식**(정수 \(m,n\))
  $$
  \boxed{\,F_{m+1}F_n-F_mF_{n+1}=(-1)^m F_{n-m}\,}.
  $$
  **증명**: 덧셈공식을 두 번 쓰거나 행렬 \(A^m\)과 \(A^n\)의 외적 성분으로 확인.

### 부분합과 제곱합

- **부분합**
  $$
  \boxed{\,\sum_{k=1}^n F_k=F_{n+2}-1\,}.
  $$
  **증명(귀납)**: \(S_n:=F_1+\cdots+F_n\)라 두고
  \(S_{n+1}=S_n+F_{n+1}=(F_{n+2}-1)+F_{n+1}=F_{n+3}-1\).

- **제곱합**
  $$
  \boxed{\,\sum_{k=1}^n F_k^2=F_nF_{n+1}\,}.
  $$
  **증명(귀납)**: \(T_n:=\sum_{k\le n}F_k^2\).
  \(T_{n+1}-T_n=F_{n+1}^2\) 과
  \(F_{n+1}F_{n+2}-F_nF_{n+1}=F_{n+1}(F_{n+2}-F_n)=F_{n+1}^2\) 를 비교.

### 이항계수와의 합

- 고전 항등식
  $$
  \boxed{\,F_{n}=\sum_{k=0}^{\lfloor (n-1)/2\rfloor}\binom{n-k-1}{k}\,}\quad(n\ge 1),
  $$
  $$
  \boxed{\,F_{n+1}=\sum_{k=0}^{\lfloor n/2\rfloor}\binom{n-k}{k}\,}.
  $$
  **증명**: 생성함수 \(x/(1-x-x^2)\) 를 이항급수로 전개하거나, §6.1의 **보드 타일링** 해석으로 조합적으로 증명.

---

## 조합해석: “왜 피보나치가 튀어나오나”

### 1×n 보드 타일링(단도미노)

- **문제**: 1×\(n\) 보드를 **1×1** 타일과 **1×2** 도미노로 채우는 경우의 수 \(T_n\)은?
- **점화**: 마지막 칸이 1×1이면 \(T_{n-1}\)으로 귀결, 1×2면 \(T_{n-2}\).
  초기 \(T_0=1, T_1=1\) → \(T_n=F_{n+1}\).
- **응용**: 이 해석으로 §5.6의 이항계수 합 공식이 자연스럽게 나온다(도미노 \(k\)개 배치 위치를 고르는 조합).

### 연속된 1이 없는 이진 문자열

길이 \(n\)의 이진 문자열 중 “11”이 없는 개수는 \(F_{n+2}\). (앞 자리 0/1 분기 점화로 바로 도출.)

---

## 나눗셈 성질: 최대공약수·주기

### 최대공약수 항등식

$$
\boxed{\,\gcd(F_m,F_n)=F_{\gcd(m,n)}\,}.
$$
**증명 스케치**: 유클리드 알고리즘을 지수에 적용. 덧셈공식에서
\(F_{m}=F_{m-n}F_{n+1}+F_{m-n-1}F_n\) 꼴로 나타나므로 \(\gcd(F_m,F_n)=\gcd(F_{m-n},F_n)\). 지수의 \(\gcd\)로 수렴한다.

**귀결**: \(F_m\mid F_n \iff m\mid n\).

### 피사노 주기(Pisano period)

모듈러 \(m\)에서 피보나치는 주기를 갖는다. 가장 작은 주기를 \(\pi(m)\)이라 하면
$$
(F_n\bmod m)_{n\ge 0}\ \text{의 주기는 }\pi(m).
$$
예: \(\pi(10)=60\). (증명은 선형 점화의 유한 상태공간과 행렬군의 유한성을 이용.)

---

## 예제(적게, 그러나 끝까지)

### 예제 A — 덧셈정리의 수치 검증

\(m=7,n=5\)에서
$$
F_{12}=144,\quad F_{6}=8,\ F_7=13,\ F_5=5.
$$
우변 \(F_{6}F_5+F_7F_6=8\cdot 5+13\cdot 8=40+104=144\). 성립.

### 예제 B — 제곱합 항등식

\(n=7\)에서
$$
\sum_{k=1}^7 F_k^2=1^2+1^2+2^2+3^2+5^2+8^2+13^2=1+1+4+9+25+64+169=273.
$$
우변 \(F_7F_8=13\cdot 21=273\). 일치.

### 개략 계산(손계산 스케치)

코드 없이 등식만 사용:
- \(F_{50}\), \(F_{51}\)을 재귀적으로 만들고,
- \(F_{100}=F_{50}(2F_{51}-F_{50})\)로 마무리.
정확 수치 \(F_{100}=354224848179261915075\) (알고리즘이 이를 \(O(\log n)\) 단계로 낸다).

### 예제 D — 조합해석으로 \(F_{n+1}=\sum_{k}\binom{n-k}{k}\)

길이 \(n\) 보드에 도미노 \(k\)개(길이 2)와 단타일 \(n-2k\)개를 배치하려면, 총 블록 수는 \(n-k\)이며 그중 도미노 \(k\)개의 위치를 선택:
$$
\#=\binom{n-k}{k}.
$$
가능한 \(k\)를 모두 합하면 모든 타일링 수 \(=F_{n+1}\).

---

## 더 알아두면 좋은 등식·사실 모음

- **합차 공식**
  $$
  F_{m+n}+F_{m-n}=F_m L_n,\qquad F_{m+n}-F_{m-n}=F_n L_m.
  $$
- **부분합의 변형**
  \(\sum_{k=0}^{n} F_{2k+1}=F_{2n+2}\), \(\sum_{k=0}^{n} F_{2k}=F_{2n+1}-1\).
- **곱의 합**
  \(\sum_{k=0}^{n} F_k F_{n-k}=\frac{n}{5}L_n\) (정확한 지수 대응 조정 필요; 생성함수로 유도 가능).
- **가우스 합동(맛보기)**
  소수 \(p\)에 대해 \(F_{p-\left(\frac{5}{p}\right)}\equiv 0\pmod p\) (여기 \((\tfrac{5}{p})\)는 르장드르 기호). 고급 수론과 연결되는 대표 예.

---

## 마무리 요약

1) **정의**: \(F_{n+2}=F_{n+1}+F_n\), \(F_0=0\), \(F_1=1\).
2) **해 닫힌식**: \(F_n=\dfrac{\varphi^n-\hat\varphi^n}{\sqrt5}\), 근사 \(F_n\approx \varphi^n/\sqrt5\).
3) **생성함수**: \(x/(1-x-x^2)\). **행렬법**: \(A^n=\begin{psmallmatrix}F_{n+1}&F_n\\F_n&F_{n-1}\end{psmallmatrix}\).
4) **핵심 등식**: 덧셈정리, 도블링, Cassini, Catalan, d’Ocagne, 부분합/제곱합, 이항계수 표현.
5) **조합해석**: 타일링/무연속 1 이진열이 \(F_n\)을 자연스럽게 산출.
6) **수론**: \(\gcd(F_m,F_n)=F_{\gcd(m,n)}\), 피사노 주기, 나눗셈 성질.

> 피보나치는 “간단한 점화식 → 풍부한 구조”의 교과서적 사례다. **해석·대수·조합·수론**을 가로지르는 등식들이 서로를 증명하고, 빠른 알고리즘(빠른 두배)까지 깔끔하게 이어진다.
