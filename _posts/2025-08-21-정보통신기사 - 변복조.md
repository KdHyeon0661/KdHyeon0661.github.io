---
layout: post
title: 정보통신기사 - 변복조
date: 2025-08-21 16:25:23 +0900
category: 정보통신기사
---
# 변복조 ASK/FSK/PSK/QAM 한 방 정리

## 큰 그림: 선형 변조 vs 주파수/위상 변조

- **선형 변조(ASK/PAM, QAM)**: 복소 기저대역 심볼 $s[k]=I_k + jQ_k$을 **선형 필터/성형** 후 반송파에 얹음.
  → **스펙트럼 효율↑**(많은 비트/심볼), **PAPR↑/증폭기 선형성 요구**, **동기화 민감**.
- **위상/주파수 변조(PSK/FSK)**: 반송파 **위상/주파수**를 바꿈.
  → **정진폭(PSK)**, **상대적으로 비선형 증폭기 친화(특히 CPFSK/MSK)**, **스펙트럼 효율은 변조/지수에 의존**.

---

## 공통 신호 모델과 성능 지표

### 기저대역·통과대역 모델

- **기저대역(복소)**:
  $$
  x(t)=\sum_{k} s[k]\,p(t-kT_s),\qquad s[k]\in\mathcal{S}
  $$
  $p(t)$: 성형펄스(예: Nyquist RC/RRC), $T_s$: 심볼기간, $R_s=1/T_s$.
- **통과대역(실수)**:
  $$
  x_\mathrm{RF}(t)=\Re\{x(t)\,e^{j2\pi f_c t}\}=I(t)\cos(2\pi f_c t)-Q(t)\sin(2\pi f_c t)
  $$

### 에너지와 SNR

- 심볼 에너지 $E_s=\mathbb{E}\{|s[k]|^2\}$, 비트 에너지 $E_b=E_s/\log_2 M$.
- 잡음: 기저대역 AWGN $n(t)\sim\mathcal{CN}(0, N_0)$, 실수 통과대역이면 **양측 PSD** $N_0/2$.
- **Q함수**: $Q(x)=\frac{1}{\sqrt{2\pi}}\int_x^\infty e^{-t^2/2}\,dt$.

---

## ASK / PAM (진폭변조 계열)

> 디지털에서 “ASK”라 하면 보통 **OOK(On–Off Keying)** 또는 **M-ASK(=M-PAM의 패스밴드 구현)**를 뜻합니다.

### 신호집합

- **2-PAM(antipodal)**: 레벨 $\{\!-\!A,+A\}$ (기저대역). 통과대역에서 동상 성분 한 채널만 사용.
- **OOK(2-ASK)**: $\{0, A\}$ — **1일 때 송신, 0일 때 무송신**.
- **M-PAM(ASK)**: $\{-(M-1),\dots,-1,+1,\dots,(M-1)\}\cdot d/2$ (등간격, 평균전력 제어).

### 검파

- **코히어런트(동기)**: 캐리어 위상 정합 후 **정합필터/상관기**로 결정.
- **비코히어런트(에너지 검파)**: OOK 등에서 캐리어 동기 없이 **에너지 비교**.

### BER/SER (AWGN, 대표식)

- **2-PAM(=BPSK와 동등, antipodal)**
  $$
  P_b = Q\!\left(\sqrt{\frac{2E_b}{N_0}}\right)
  $$
- **M-PAM(Gray 코딩)**
  $$
  P_b \approx \frac{2(M-1)}{M\log_2M} \; Q\!\left(\sqrt{\frac{6\log_2M}{M^2-1}\frac{E_b}{N_0}}\right)
  $$
- **OOK(코히어런트/비코히어런트)**: 구현에 따라 식이 다릅니다(시험에선 **BPSK(2-PAM) 대비 열세**, **비코히어런트는 추가 손실** 정도만 기억해도 충분).

### 대역폭과 스펙트럼

- **선형 성형(Nyquist RC/RRC)** 가정 시 점유 대역폭
  $$
  B \approx (1+\alpha)\,R_s \quad (\text{통과대역})
  $$
  $\alpha$: 롤오프(0~1). M-PAM도 **심볼율 $R_s=R_b/\log_2M$**.

### 예제 ① — 4-PAM(=4-ASK) BER

- $M=4,\ \log_2M=2$.
  $$
  P_b \approx \frac{2(3)}{4\cdot 2} Q\!\left(\sqrt{\frac{6\cdot 2}{15}\frac{E_b}{N_0}}\right)
  = \frac{3}{4} Q\!\left(\sqrt{\frac{12}{15}\frac{E_b}{N_0}}\right)
  = \frac{3}{4} Q\!\left(\sqrt{0.8\frac{E_b}{N_0}}\right)
  $$
  동일 BER에서 **BPSK보다 더 높은 $E_b/N_0$** 필요.

---

## FSK (주파수편이변조)

### 신호집합과 변조지수

- **BFSK**:
  $$
  s_0(t)=\sqrt{\frac{2E_b}{T_b}}\cos\big[2\pi(f_c-\Delta f)t\big],\quad
  s_1(t)=\sqrt{\frac{2E_b}{T_b}}\cos\big[2\pi(f_c+\Delta f)t\big]
  $$
- **변조지수** $h=2\Delta f\,T_b$ (binary CPFSK 정의).
  - **MSK**: $h=0.5$ (최소 주파수 편이, **연속위상**, **정진폭**).
  - **GMSK**: MSK 앞단에 **Gaussian 필터** 적용(스펙트럼 콤팩트, GSM에서 채택).

### 직교성

- $\Delta f = \frac{1}{2T_b} \Rightarrow h=1$ 이면 **직교(BFSK orthogonal)**.

### 검파와 BER

- **코히어런트 BFSK(직교)**
  $$
  P_b = Q\!\left(\sqrt{\frac{E_b}{N_0}}\right)
  $$
  (BPSK 대비 **3 dB 불리**: BPSK는 $Q(\sqrt{2E_b/N_0})$)
- **비코히어런트 BFSK(직교)**
  $$
  P_b = \frac{1}{2}\exp\!\left(-\frac{E_b}{2N_0}\right)
  $$
- **CPFSK/MSK**: 코히어런트/비코히어런트, 필터링에 따라 성능-대역 절충.

### 대역폭 (Carson 근사)

- **FM 계열 근사**:
  $$
  B \approx 2(\Delta f + R_b) \quad\text{(NRZ 기준)}\quad\text{또는}\quad B \approx 2\Delta f + R_b
  $$
- **MSK**: 직관적으로 **NRZ보다 약간 넓은 정도**, **GMSK**는 필터 BT(대역·시간)로 조절.

### 예제 ② — BFSK 코히어런트 vs 비코히어런트

- 목표 $P_b=10^{-5}$.
  - **BPSK**: $Q(\sqrt{2\gamma_b})=10^{-5}\Rightarrow \gamma_b=\frac{(Q^{-1}(10^{-5}))^2}{2}\approx 9.1$ (≈ **9.6 dB**)
  - **BFSK(코히어런트)**: $Q(\sqrt{\gamma_b})=10^{-5}\Rightarrow \gamma_b\approx 18.2$ (**12.6 dB**)
  - **BFSK(비코히어런트)**: $\tfrac{1}{2}e^{-\gamma_b/2}=10^{-5}\Rightarrow \gamma_b\approx 2\ln(5\times10^4)\approx 21.4$ (**13.3 dB**)
→ 동일 BER에서 **BPSK가 가장 유리**, 그다음 **BFSK(코히어런트)**, **비코히어런트**가 가장 불리(동기 불필요 장점과 맞교환).

---

## PSK (위상편이변조)

### 대표군

- **BPSK**: 위상 $\{0,\pi\}$, 정진폭.
  $$
  s(t)=\sqrt{\frac{2E_b}{T_b}}\cos(2\pi f_c t + \theta_b),\quad \theta_b\in\{0,\pi\}
  $$
- **QPSK**: $\{45^\circ,135^\circ,225^\circ,315^\circ\}$ (Gray 매핑). **I/Q** 두 축으로 구현 → **BPSK와 동일 BER**.
- **OQPSK**: I/Q 절반심볼 지연(중심점 통과 피함) → **엔벨로프 변동↓**, 비선형 증폭기 친화.
- **$\pi/4$-QPSK**: 두 성상 간 $\pi/4$ 회전 교번 → 위상연속성·동기 안정성 개선(이동통신 파형에서 빈출).
- **M-PSK**: 원둘레 등간격 위상 $2\pi m/M$.

### BER/SER (AWGN, Gray)

- **BPSK/QPSK(Gray)**
  $$
  P_b = Q\!\left(\sqrt{\frac{2E_b}{N_0}}\right)
  $$
- **M-PSK(SER 근사)**
  $$
  P_s \approx 2\,Q\!\Bigg(\sqrt{2\frac{E_s}{N_0}}\sin\frac{\pi}{M}\Bigg),\quad
  P_b \approx \frac{P_s}{\log_2 M}\ \text{(Gray 근사)}
  $$
  $E_s=E_b\log_2M$.

### 대역폭

- 선형 성형 사용 시
  $$
  B \approx (1+\alpha)R_s,\quad R_s=\frac{R_b}{\log_2 M}
  $$
- **QPSK**는 **BPSK와 같은 심볼율에서 2배 비트율** → **같은 대역에서 2배 스루풋**.

### 예제 ③ — QPSK 대역과 BER

- $R_b=10$ Mb/s, $\alpha=0.35$ → $R_s=5$ Msym/s → $B\approx 1.35\times5=6.75$ MHz.
- $P_b=10^{-5}$ 목표: **BPSK/QPSK**에서 $E_b/N_0\approx 9.6$ dB.

---

## QAM (직교진폭변조)

### 개념

- I축·Q축 **직교 두 채널**에 PAM 레벨을 실어 **2D 격자** 성상도 형성.
  - **16-QAM**: 4×4 격자(4비트/심볼), **64-QAM**: 8×8 격자(6비트/심볼) 등.
  - **Gray 매핑**으로 인접 심볼 간 **비트 오차 1비트**가 되도록 배치.

### SER/BER (AWGN, 정방형 M-QAM, Gray 근사)

- **SER**
  $$
  P_s \approx 4\left(1-\frac{1}{\sqrt{M}}\right)Q\!\left(\sqrt{\frac{3}{M-1}\frac{E_s}{N_0}}\right)
  $$
- **BER(근사)**
  $$
  P_b \approx \frac{P_s}{\log_2M}
  \quad\text{또는}\quad
  P_b \approx 2\left(1-\frac{1}{\sqrt{M}}\right)\frac{1}{\log_2M}\,
  Q\!\left(\sqrt{\frac{3\log_2M}{M-1}\frac{E_b}{N_0}}\right)
  $$
- **포인트**: **M↑ → 성상점 간격↓ → 더 높은 $E_b/N_0$** 필요(대신 **스루풋↑**).

### 대역폭

$$
B \approx (1+\alpha)R_s,\quad R_s=\frac{R_b}{\log_2 M}
$$
→ **같은 $R_b$**에서 **M↑ ⇒ $R_s↓ ⇒ B↓$** 가능(대신 SNR 요건↑).

### 예제 ④ — 16-QAM BER 요구치(근사)

- 목표 $P_b=10^{-5}$. 근사적으로 **$E_b/N_0 \approx 16$ dB** 수준(교재/표준 그래프 기준값).
- 64-QAM은 보통 **$\approx 22$ dB 내외**(동일 BER 기준).
  > 시험에서는 **“QAM 차수↑ → 더 좋은 채널(SNR) 필요”**, **“대역은 줄일 수 있음”**을 확실히 잡아가세요.

---

## 성상도/거리/검출

### 최소거리 검파

- **ML 검파**는 잡음이 가우시안이면 **유클리드 거리 최소**와 동치.
  $$
  \hat{s} = \arg\min_{s\in\mathcal{S}} \|y-s\|^2
  $$
- **에러 성능**은 **최소 거리 $d_\min$**에 의해 좌우.

### Gray 매핑

- **인접 심볼간 해밍거리=1**이 되도록 비트 배치 → **SER→BER로의 손실 최소화**.
- **QPSK/16-QAM**에서 표준적.

---

## 동기화와 실무 이슈

### 심볼 타이밍/캐리어 동기

- **타이밍 동기**: ML/가드너/무선에서는 프레임 동기(프리앰블·파일럿).
- **캐리어 동기**: **Costas loop(PSK)**, **데이터에이디드(DA)/비데이터에이디드(NDA)**.

### 주파수 오프셋/위상잡음

- **PSK/QAM**에서 **위상·주파수 오프셋**은 성상도 회전/퍼짐 → BER 급증.
- **FSK/CPFSK/MSK**는 상대적으로 **강인**.

### PAPR & 증폭기 비선형

- **QAM/OFDM**: **PAPR 높음** → PA 백오프 필요 → 전력효율 저하.
- **PSK(특히 OQPSK, $\pi/4$-QPSK), MSK/GMSK**: **정진폭/저PAPR** → **비선형 PA 친화**.

### 채널 등화

- 멀티패스 ISI에 **선형 등화(LMS/RLS/DFE)**, **터보이퀄라이저**, **OFDM**(주파수선택성에 강함).

---

## 대역폭/효율 요약

| 변조 | 비트/심볼 | 대역폭(성형 $\alpha$) | 스펙트럼 효율 $\eta=R_b/B$ (이상) | 동기 |
|---|---:|---:|---:|---|
| BPSK | 1 | $(1+\alpha)R_s$ | $\approx \frac{\log_2M}{1+\alpha}$ (M=2) | 필요 |
| QPSK | 2 | $(1+\alpha)R_s=(1+\alpha)\frac{R_b}{2}$ | BPSK의 2배 | 필요 |
| 16-QAM | 4 | $(1+\alpha)\frac{R_b}{4}$ | 높음(조건부) | 필요 |
| BFSK(직교) | 1 | $\approx 2\Delta f + R_b$ | 중간 | 코히어/비코히어 |
| MSK/GMSK | 1 | MSK: B≈$R_b$급, GMSK: BT로 조절 | 중간/콤팩트 | 코히어/비코히어 |

> **핵심**: **QAM/PSK**는 **대역 효율↑ but SNR↑ 요구**, **FSK**는 **동기/PA/선형성에 강인하지만 대역↑(설계에 따라)**.

---

## 종합 예제

### 예제 ⑤ — 동일 대역에서 스루풋 비교

- 조건: **유효 RF 대역 $B=7$ MHz**, 롤오프 $\alpha=0.35$.
- **QPSK**: $B=(1+\alpha)R_s\Rightarrow R_s=B/(1+\alpha)=7/1.35\approx 5.185$ Msym/s →
  $R_b=2R_s\approx \mathbf{10.37}$ Mb/s
- **16-QAM**: $R_b=4R_s\approx 4\times 5.185= \mathbf{20.74}$ Mb/s (동일 대역에서 **2배 스루풋**)
  단, **BER 10^{-5}** 목표 시 **$E_b/N_0$** 요구가 **QPSK(≈9.6 dB)** → **16-QAM(≈16 dB)**로 **상당히↑**.

### 예제 ⑥ — $E_b/N_0$에서 BER 비교(10^{-5})

- **BPSK/QPSK**: $\approx 9.6$ dB
- **8-PSK**: $\approx 14\sim15$ dB (근사)
- **16-QAM**: $\approx 16$ dB (근사)
- **64-QAM**: $\approx 22$ dB (근사)
- **BFSK(코히어런트)**: $\approx 12.6$ dB
→ **채널 SNR 여유**와 **목표 스루풋/대역**을 같이 보고 변조를 고릅니다.

---

## 출제 포인트(암기 키)

1) **BPSK $P_b=Q(\sqrt{2E_b/N_0})$, BFSK(코히어) $Q(\sqrt{E_b/N_0})$** — **BPSK가 3 dB 유리**.
2) **QPSK = BPSK와 동일 BER**(비트/심볼 2배).
3) **M-QAM/PSK**: **차수↑ ⇒ 요구 SNR↑**(대역 효율과 교환).
4) **대역폭**: 선형 성형 시 $\,B\approx(1+\alpha)R_s$, $R_s=R_b/\log_2M$.
5) **MSK**: $h=0.5$, **정진폭**, **연속위상**, **비선형 PA 친화**.
6) **GMSK**: MSK 앞 Gaussian 필터 → **스펙트럼 콤팩트(GSM)**.
7) **Gray 매핑**: 인접 1비트 차이로 **BER↓**.
8) **동기**: PSK/QAM은 **위상/주파수 동기 필수**, FSK는 **비코히어 검파 가능**(성능 손실 있음).
9) **PAPR/PA**: QAM/OFDM은 **백오프** 필요, OQPSK/π/4-QPSK/MSK 계열은 **유리**.

---

## 실무 체크리스트

- [ ] 목표 **R_b / BER / 대역(B)** / 전력/PA/배터리 제약 명세화
- [ ] **채널 모델(AWGN? 주파수선택적? Doppler?)** 확인
- [ ] **변조** 선택(QPSK, 16/64-QAM, (G)MSK, π/4-QPSK…)
- [ ] **성형펄스(α)**, **파일럿/프리앰블** 설계
- [ ] **타이밍/캐리어 동기 루프** 파라미터(Loop BW, Damping)
- [ ] **등화/채널 추정**(레이크/주파수영역 등화)
- [ ] **PA 선형성/백오프, ACLR/스펙트럼 마스크** 확인
- [ ] **링크버짓+Eb/N0 여유** → **적응변복조(AMC)** 고려

---

## 연습문제 (풀이 요약)

**Q1.** BPSK에서 $P_b=10^{-5}$ 일 때 $E_b/N_0$는?
**A.** $Q(\sqrt{2\gamma_b})=10^{-5}\Rightarrow \gamma_b\approx 9.1$ ⇒ **≈ 9.6 dB**.

**Q2.** QPSK, $\alpha=0.35$, $B=9$ MHz에서 가능한 $R_b$?
**A.** $R_s=B/(1+\alpha)=9/1.35=6.667$ Msym/s, $R_b=2R_s= \mathbf{13.33}$ Mb/s.

**Q3.** BFSK(직교, 코히어런트)와 BPSK의 성능 차이는?
**A.** 동일 BER에 대해 BFSK가 **3 dB 더 높은 $E_b/N_0$** 필요.

**Q4.** 16-QAM의 BER 근사식(Gray)에서 $M=16$을 대입해라.
**A.** $P_b \approx \frac{3}{4}Q\!\big(\sqrt{\frac{4}{5}\frac{E_b}{N_0}}\big)$ (근사형에서 상수는 문헌/정의에 따라 약간 달 수 있음).

**Q5.** MSK의 변조지수 $h$와 특징 2개?
**A.** $h=0.5$. **정진폭**, **연속위상**, **저 PAPR**, **비선형 PA 친화**.

---

## 빠른 요약(Cheat Sheet)

- **BPSK/QPSK**: $P_b=Q(\sqrt{2E_b/N_0})$, $B\approx(1+\alpha)R_s$.
- **M-PSK**: $P_s\approx 2Q\!\big(\sqrt{2E_s/N_0}\sin(\pi/M)\big)$.
- **M-QAM**: $P_s\approx 4(1-1/\sqrt{M})Q\!\big(\sqrt{3E_s/((M-1)N_0)}\big)$.
- **BFSK(직교)**: 코히어 $P_b=Q(\sqrt{E_b/N_0})$, 비코히어 $P_b=\tfrac{1}{2}e^{-E_b/(2N_0)}$.
- **대역폭**: 선형 성형 시 $B\approx(1+\alpha)R_s$, $R_s=R_b/\log_2M$.
- **실무 우선순위**: 채널/SNR 여유 → 변조 차수 결정 → 동기/등화/PA 검증.
