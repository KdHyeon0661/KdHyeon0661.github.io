---
layout: post
title: 정수론 - 오일러 정리
date: 2025-09-09 21:25:23 +0900
category: 정수론
---
# 오일러 정리(페르마의 일반화) — 레온하르트 오일러, 오일러 φ-함수, 오일러 정리, φ-함수의 성질

> **구성/원칙**
> - 예제는 **적게** 두되 **아주 자세히** 해설한다.
> - 핵심 정리에는 **증명**(또는 엄밀한 증명 스케치)을 포함한다.
> - 모든 수식은 $$\ldots$$ 로 감싼 **MathJax** 표기.

---

## 0. 레온하르트 오일러(Leonhard Euler) — 맥락

18세기 거장 오일러는 정수론·해석학·조합론 전반을 비약적으로 발전시켰다.
정수론에서 특히 중요한 공헌 중 하나가 **오일러의 φ-함수**와 그에 기반한 **오일러 정리**다. 이는 페르마의 작은 정리
$$
a^{p-1}\equiv 1\pmod p\qquad(p\text{ 소수},\ p\nmid a)
$$
를 **합성수 법**으로 일반화하며, 이후의 모듈러 산술, 암호(예: RSA), 곱셈적 함수론의 토대가 되었다.

---

## 1. 오일러 φ-함수(Euler’s totient function)

### 1.1 정의와 기본 의미
**정의.** 양의 정수 $$n$$ 에 대해
$$
\varphi(n)\ :=\ \#\{\,1\le k\le n:\ \gcd(k,n)=1\,\}.
$$
즉, $$\bmod n$$ 에서의 **단위(unit)** 개수(곱셈에 대해 역원이 있는 잔여 수)다. 군론적으로는
$$
\left|(\mathbb{Z}/n\mathbb{Z})^\times\right|=\varphi(n).
$$

> **직관**: $$\varphi(n)$$ 는 $$n$$ 과 서로소인 “토티언트(totatives)”의 개수.

---

### 1.2 소수멱에서의 값과 일반 공식

#### (A) 소수멱 공식
소수 $$p$$ 와 정수 $$k\ge1$$ 에 대해
$$
\boxed{\ \varphi(p^k)=p^k-p^{k-1}\ =\ p^k\!\left(1-\frac1p\right)\ }.
$$

**증명.** $$1,2,\dots,p^k$$ 가운데 $$p$$ 의 배수는 정확히 $$p^{k-1}$$ 개. 나머지 $$p^k-p^{k-1}$$ 개는 $$p^k$$ 와 서로소. □

#### (B) 곱셈성(서로소 곱에서의 곱셈적 성질)
$$
\gcd(m,n)=1\ \Rightarrow\ \boxed{\ \varphi(mn)=\varphi(m)\,\varphi(n)\ }.
$$

**증명(중국인의 나머지 정리 관점).** $$\bmod mn$$ 의 단위군은 CRT로
$$
(\mathbb{Z}/mn\mathbb{Z})^\times\ \cong\ (\mathbb{Z}/m\mathbb{Z})^\times\times(\mathbb{Z}/n\mathbb{Z})^\times
$$
이므로 크기는 곱으로 분해된다. □

#### (C) 일반 곱셈 공식(소인수분해형)
$$
n=\prod_{i=1}^{r} p_i^{\alpha_i}\quad\Rightarrow\quad
\boxed{\ \varphi(n)=n\prod_{i=1}^{r}\left(1-\frac{1}{p_i}\right)\ }.
$$

**증명.** (A)와 (B)를 결합하면 즉시. □

---

### 1.3 예제(하나를 깊게) — $$n=3600$$
$$
3600=2^4\cdot 3^2\cdot 5^2 \quad\Rightarrow\quad
\varphi(3600)=3600\!\left(1-\frac12\right)\!\left(1-\frac13\right)\!\left(1-\frac15\right).
$$
계산하면
$$
\varphi(3600)=3600\cdot \frac12\cdot\frac23\cdot\frac45
=3600\cdot\frac{8}{30}
=3600\cdot \frac{4}{15}
=960.
$$
(분해형과 곱셈성의 직접 적용 예.)

---

## 2. 오일러 정리(Euler’s theorem) — 페르마의 일반화

### 2.1 정리와 해석
**정리(오일러).** $$\gcd(a,n)=1$$ 이면
$$
\boxed{\ a^{\varphi(n)}\equiv 1\pmod n\ }.
$$

- **페르마 작은 정리**는 $$n=p$$(소수)일 때의 특수형: $$\varphi(p)=p-1$$.
- **의미**: 지수 $$\varphi(n)$$ 가 $$\bmod n$$ 의 단위군 크기이므로, 임의의 단위의 거듭제곱이 항등원(1)으로 돌아간다.

### 2.2 증명 A(군론: 라그랑주 정리)
$$(\mathbb{Z}/n\mathbb{Z})^\times$$ 는 크기 $$\varphi(n)$$ 의 유한 아벨군.
단위 $$\overline{a}$$ 의 위수는 그룹 크수를 나누므로 $$\overline{a}^{\varphi(n)}=1$$. 즉 $$a^{\varphi(n)}\equiv 1\pmod n$$. □

### 2.3 증명 B(초등·가우스 재배열)
서로소 잔여계 $$R=\{r_1,\dots,r_{\varphi(n)}\}$$ 를 잡는다(즉 $$\gcd(r_i,n)=1$$).
$$
aR=\{ar_1,\dots,ar_{\varphi(n)}\} \pmod n
$$
은 **동일한 집합의 재배열**(왜냐하면 $$\gcd(a,n)=1$$ 이므로 곱하기 $$a$$ 가 전단사). 곱을 비교하면
$$
(ar_1)\cdots(ar_{\varphi(n)})\ \equiv\ r_1\cdots r_{\varphi(n)}\pmod n,
$$
즉
$$
a^{\varphi(n)}(r_1\cdots r_{\varphi(n)})\equiv r_1\cdots r_{\varphi(n)}\pmod n.
$$
양변에서 공통 곱을 소거(단위)하면 $$a^{\varphi(n)}\equiv 1\pmod n$$. □

---

### 2.4 예제(하나를 깊게) — $$3^{100}\ (\bmod 35)$$
먼저 $$\gcd(3,35)=1$$, 그리고 $$\varphi(35)=35\!\left(1-\frac15\right)\!\left(1-\frac17\right)=35\cdot\frac45\cdot\frac67=24.$$
오일러 정리로 $$3^{24}\equiv 1\pmod{35}$$ 이므로
$$
3^{100}\equiv 3^{\,100\bmod 24}=3^{4}\equiv 81\equiv 81-70=11\pmod{35}.
$$
즉 **정답은 11**. (CRT 없이도 한 번에 끝난다.)

---

## 3. φ-함수의 성질(기초에서 심화까지)

### 3.1 디리클레 합성곱과 역공식
**항등함수** $$\mathrm{id}(n)=n$$, **상수함수** $$\mathbf{1}(n)\equiv 1$$, **뫼비우스 함수** $$\mu(n)$$ 을 두면
$$
\sum_{d\mid n}\varphi(d)=n \quad\Longleftrightarrow\quad
\boxed{\ \varphi=\mu * \mathrm{id}\ }.
$$

**증명.** 좌변은 $$\varphi * \mathbf{1}=\mathrm{id}$$ 와 같다(정의 그대로).
양변에 $$\mu$$ 를 합성곱하면 $$\varphi=(\mathrm{id})*(\mu*\varepsilon)=(\mathrm{id})*\mu$$ (여기서 $$\mu*\mathbf{1}=\varepsilon$$). □

> **직관**: “누적합을 알면 뫼비우스 역공식으로 원함수를 복원한다.”

---

### 3.2 디리클레 급수와 오일러 곱
수열 $$a(n)$$ 의 디리클레 급수를 $$\mathcal{D}\{a\}(s)=\sum_{n\ge1} a(n)n^{-s}$$ 라 적자. 그러면
$$
\boxed{\ \sum_{n\ge1}\frac{\varphi(n)}{n^s}\ =\ \frac{\zeta(s-1)}{\zeta(s)}\ }\qquad(\Re s>2).
$$

**증명.** $$\varphi=\mu*\mathrm{id}$$ 에 디리클레 급수의 합성곱 대응(곱셈) 적용:
$$
\sum\frac{\varphi(n)}{n^s}=\Big(\sum\frac{\mu(n)}{n^s}\Big)\Big(\sum\frac{\mathrm{id}(n)}{n^s}\Big)
=\frac{1}{\zeta(s)}\cdot \zeta(s-1).
$$
(여기서 $$\sum \mu(n)n^{-s}=1/\zeta(s)$$, $$\sum \mathrm{id}(n)n^{-s}=\zeta(s-1)$$.) □

> 오일러 곱 전개로 보면 $$\prod_p \frac{1-p^{1-s}}{1-p^{-s}}=\prod_p (1-1/p)^{{-1}}\cdot(1-1/p^{s-1})$$ 형태의 소수 곱으로도 읽힌다.

---

### 3.3 간단하지만 중요한 정성적 성질

1) **거의 항상 짝수**: $$n>2$$ 이면 $$\varphi(n)$$ 은 **짝수**.
   **이유**: $$n>2$$ 이면 $$-1\not\equiv 1\ (\bmod n)$$ 이므로 $$\bmod n$$ 의 단위들은 $$x\leftrightarrow x^{-1}$$ 로 **짝짓기**가 가능하고, 자기 역원은 $$x\equiv \pm1$$뿐(특정 소수멱 예외 확인 가능). 결국 단위 개수는 짝수.

2) **상한/하한의 대략**:
   - 자명하게 $$\varphi(n)\le n-1\ (n>1)$$,
   - $$n$$ 의 서로 다른 소인수들이 많아질수록 $$\varphi(n)=n\prod_{p\mid n}(1-1/p)$$ 는 **작아진다**.
   - 고전적 사실: $$n\ge 3$$ 에 대해 어떤 절대상수 $$C>0$$ 가 있어
     $$
     \varphi(n)\ \ge\ C\,\frac{n}{\log\log n}
     $$
     (정밀 상수는 생략; “아주 느리게 줄어든다”는 메시지).

3) **단조성은 아님**: $$a\mid b$$ 여도 $$\varphi(a)\le\varphi(b)$$ 가 항상 성립하지 않는다(예: $$\varphi(6)=2<\varphi(8)=4$$ 은 성립하지만 반례들도 쉽게 찾을 수 있다). 단, **소수멱 사슬**에서는 증가: $$\varphi(p^{k+1})=p\varphi(p^k)$$.

4) **곱셈적 함수**: $$\varphi(n)$$ 는 곱셈적이지만 **완전곱셈적은 아님**(예: $$\varphi(p^2)=p^2-p\neq \varphi(p)^2=(p-1)^2$$).

---

### 3.4 합 공식과 평균적 성질(요지)

1) **약수합 공식**
   $$
   \boxed{\ \sum_{d\mid n}\varphi(d)=n\ }.
   $$
   **증명(조합적)**: $$\{1,\dots,n\}$$ 을 **주기**(동치류)로 나누어 각 주기의 크기를 세면 된다. 자세히는, 순환군 $$\mathbb{Z}/n\mathbb{Z}$$ 의 생성원의 개수를 세는 고전 등식.

2) **토티언트 부분합의 크기**
   $$
   \sum_{n\le x} \varphi(n) \ \sim\ \frac{3}{\pi^2}\,x^2\qquad(x\to\infty).
   $$
   **증명 스케치**:
   좌변은 격자점 카운팅
   $$
   \#\{(a,b):1\le a,b\le x,\ \gcd(a,b)=1\}
   $$
   과 동치. 상수 $$3/\pi^2$$ 는 “두 정수가 서로소일 확률 = $$6/\pi^2$$”의 절반 누적 효과에서 온다(정밀 전개 생략).

---

### 3.5 역원과 지수의 축소(응용)

- **역원**: $$\gcd(a,n)=1$$ 이면
  $$
  a^{-1}\ \equiv\ a^{\varphi(n)-1}\pmod n,
  $$
  (오일러 정리의 양변에 $$a^{-1}$$ 를 곱해 얻음). 실전에서는 확장 유클리드가 더 효율적이지만, 이 항등식은 이론적으로 유용.

- **지수 축소**: $$\gcd(a,n)=1$$ 에서
  $$
  a^k\equiv a^{\,k\bmod \varphi(n)}\pmod n
  $$
  은 일반적으로 **성립하지 않는다**(법이 합성수일 때는 주기 길이가 $$\varphi(n)$$ 의 **약수**일 뿐 정확히 $$\varphi(n)$$ 이 아님). 다만
  $$
  a^{k}\equiv a^{\,k\bmod \lambda(n)}\pmod n
  $$
  의 형태가 더 정확하다(여기서 $$\lambda(n)$$ 는 **카마이클 함수**: 단위군의 지수). 본 문서의 범위를 넘어 세부는 생략.

---

## 4. 예제 두 개(아주 제한적으로, 자세히)

### 예제 A — $$\varphi(10^6)$$ 과 역원
$$
10^6=2^6\cdot 5^6
\ \Rightarrow\
\varphi(10^6)=10^6\left(1-\frac12\right)\left(1-\frac15\right)
=10^6\cdot \frac12\cdot \frac45=400{,}000.
$$
따라서 $$\gcd(a,10^6)=1$$ 인 모든 $$a$$ 에 대해
$$
a^{400{,}000}\equiv 1\pmod{10^6},\qquad
a^{-1}\equiv a^{399{,}999}\pmod{10^6}.
$$
(실전 계산은 확장 유클리드가 효율적. 여기서는 오일러 정리의 직접적 귀결을 보여주기 위함.)

---

### 예제 B — 지수 축소: $$7^{\,222}\ (\bmod 1000)$$
$$\gcd(7,1000)=1,\ \varphi(1000)=1000\left(1-\frac12\right)\left(1-\frac15\right)=400.$$
오일러 정리로 $$7^{400}\equiv 1\ (\bmod 1000)$$.
그러나 $$222<400$$ 이므로 바로 줄어들진 않는다. 실전에는 **CRT** 가 더 유리:

- $$\bmod 8$$: $$7\equiv -1\Rightarrow 7^{222}\equiv (-1)^{222}=1.$$
- $$\bmod 125$$: $$\varphi(125)=100$$ 이므로 $$7^{100}\equiv 1$$, 따라서
  $$
  7^{222}=7^{2}\cdot (7^{100})^{2}\cdot 7^{20}\equiv 49\cdot 1\cdot 7^{20}\ (\bmod 125).
  $$
  $$7^5=16807\equiv 16807-125\cdot134=16807-16750=57,$$
  $$7^{10}\equiv 57^2=3249\equiv 3249-125\cdot 25=3249-3125=124\equiv -1,$$
  $$7^{20}\equiv (-1)^2=1.$$
  따라서 $$7^{222}\equiv 49\ (\bmod 125).$$

CRT로
$$
x\equiv 1\ (\bmod 8),\qquad x\equiv 49\ (\bmod 125).
$$
둘을 합치면(예: $$x=49+125t\equiv 1\ (\bmod 8)$$, $$125\equiv 5\ (\bmod 8)$$ 이므로
$$
49+5t\equiv 1\ (\bmod 8)\ \Rightarrow\ 1+5t\equiv 1\ \Rightarrow\ 5t\equiv 0\ \Rightarrow\ t\equiv 0\ (\bmod 8),
$$
즉 $$t=8u$$)
$$
x\equiv 49+1000u.
$$
**최소 비음 해** $$x=49$$.
따라서 **정답은 49**.

> 메시지: φ-함수만으로도 큰 지수를 크게 줄일 수 있지만, 실제 계산은 CRT/소수멱 모듈러에서 더 강력하다.

---

## 5. (요약) φ-함수와 오일러 정리의 **지도**

1) **정의**: $$\varphi(n)=\#\{1\le k\le n:\ \gcd(k,n)=1\}=\left|(\mathbb{Z}/n\mathbb{Z})^\times\right|.$$
2) **핵심 공식**: $$\varphi(p^k)=p^k-p^{k-1}$$, $$\varphi(mn)=\varphi(m)\varphi(n)\ (\gcd=1)$$,
   $$\displaystyle \varphi(n)=n\prod_{p\mid n}\left(1-\frac1p\right).$$
3) **오일러 정리**: $$\gcd(a,n)=1\Rightarrow a^{\varphi(n)}\equiv 1\pmod n$$ (페르마의 일반화).
4) **합성곱·역공식**: $$\varphi=\mu*\mathrm{id},\quad \sum_{d\mid n}\varphi(d)=n.$$
5) **디리클레 급수**: $$\displaystyle \sum_{n\ge1}\frac{\varphi(n)}{n^s}=\frac{\zeta(s-1)}{\zeta(s)}\ (\Re s>2).$$
6) **정성**: $$n>2\Rightarrow \varphi(n)\text{ 짝수}$$, 많은 소인수일수록 $$\varphi(n)$$ 작아짐, 평균적으로
   $$\sum_{n\le x}\varphi(n)\sim \frac{3}{\pi^2}x^2.$$
7) **응용**: 역원 계산(이론), 지수 축소, CRT와 결합한 모듈러 거듭제곱, 암호 이론(RSA)의 기초.

---

## 6. 연습 문제(풀이 아이디어 힌트)

1) $$n=2^a3^b5^c$$ 에 대해 $$\varphi(n)$$ 을 소수멱 공식으로 구하라.
   *힌트*: $$\varphi(n)=n(1-\tfrac12)(1-\tfrac13)(1-\tfrac15).$$

2) $$\sum_{d\mid n}\varphi(d)=n$$ 을 **순환군의 생성원 개수** 관점에서 증명하라.
   *힌트*: $$\mathbb{Z}/n\mathbb{Z}$$ 의 각 원소가 생성하는 부분군의 크기.

3) $$a^{\varphi(n)}\equiv 1\ (\bmod n)$$ 을 가우스 재배열로 증명하라.
   *힌트*: 서로소 잔여계를 곱셈 $$a$$ 로 재배열.

4) $$3^{2025}\ (\bmod 1001)$$ 를 계산하라.
   *힌트*: $$1001=7\cdot 11\cdot 13,\ \varphi(1001)=\varphi(7)\varphi(11)\varphi(13)=6\cdot 10\cdot 12=720$$, CRT.

---

### 참고
- 위 내용은 고전 정수론 교재(예: Hardy–Wright, Niven–Zuckerman–Montgomery, Iwaniec–Kowalski)의 표준 정리들로 구성됨.
- 본 문서는 **개념·증명·계산 예**를 균형 있게 배치하여, 오일러 정리와 φ-함수의 생태를 **자급자족적으로** 이해할 수 있도록 구성하였다.
