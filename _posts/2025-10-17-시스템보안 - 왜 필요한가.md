---
layout: post
title: 시스템보안 - 왜 필요한가
date: 2025-10-17 22:30:23 +0900
category: 시스템보안
---
# 0. 왜 이 글이 필요한가 — “선 의도”만으로는 충분하지 않다

보안 연구는 “선의”만으로 보호되지 않는다. **의도**(good faith)와 **행위**(authorized, proportionate, documented)가 함께 갖춰져야 하며, 이를 문서화(증빙)하고, 프로세스에 맞춰 진행해야 한다. 이 글은 다음을 목표로 한다.

- 화이트/그레이/블랙 해커의 구분을 “법적/윤리적/운영적” 관점에서 명확히 한다.
- Responsible Disclosure(이하 RD, 책임 있는 공개)의 **실전 운영 절차/템플릿/타임라인**을 제시한다.
- **법적 리스크 체크리스트**를 제공해 “내 행위가 어디까지 안전한가”를 스스로 점검할 수 있게 한다.
- **버그바운티/CTF/랩 환경의 경계**를 구체적 “상황 시나리오”와 **안전한 예제 코드**로 설명한다.

---

# 1. 화이트 / 그레이 / 블랙 해커 — 개념을 법·윤리·운영 관점으로 분해

## 1.1 한 줄 정의
- **화이트 해커(White Hat)**: **허가받은 범위 내**에서, **합의된 규칙**(정책/약관/범위/시험 데이터)에 따라 보안 테스트를 수행하고, 발견사항을 **책임 있게 공개**한다.
- **그레이 해커(Gray Hat)**: 명시적 허가 없이(혹은 모호한 허가로) 테스트하지만, 악의적 금전·파괴 목적은 없다고 주장. 그러나 **무단 접근/데이터 취득 자체가 불법**이 될 수 있어 **법적 리스크가 높다**.
- **블랙 해커(Black Hat)**: 명시적 무단 접근과 **악의적 목적**(금전 갈취/파괴/스파이/판매)을 갖고 활동. 형사/민사 책임 대상.

## 1.2 윤리 vs 법 vs 운영의 3축
- **윤리(Ethics)**: 선의, 사회적 이익, 피해 최소화, 투명한 소통.
- **법(Law)**: **허가(Authorization)** 유무, **침투(Access)** 방식, **데이터 취득** 범위가 핵심. 많은 국가에서 무단 취약점 탐색/접근도 정보통신망 침해로 판단될 수 있다.
- **운영(Ops)**: 범위(Scope), 기간, 속도/부하 제한, 데이터 취급(민감정보·개인정보), 증거 보존, 보고 채널, 취약점 악용 최소화.

> **핵심**: 화이트/그레이의 경계는 “의도”가 아니라 **허가와 범위 준수**로 갈린다.

---

# 2. Responsible Disclosure(RD) — 실전 운영 가이드

## 2.1 RD 기본 원칙(5)
1. **허가·범위 우선**: 정책/약관/버그바운티 범위 문서 확인 → **서면 동의** 확보.
2. **최소 침해**: 재현에 필요한 최소한의 증거만 수집(PII/비밀정보 수집 금지).
3. **무중단·무부하**: 서비스 가용성/데이터 무결성 저해 금지(DoS/대량 스캔 금지).
4. **비공개 통지 → 협의 공개**: 벤더에 먼저 알리고, 패치 합의 후 공개.
5. **증빙과 로그**: 모든 단계(시도, 트래픽, PoC) 타임스탬프/해시로 기록.

## 2.2 RD 표준 흐름(타임라인 예시)
- **D0(시작 전)**: 범위/허가 문서 수신(서명/이메일 증빙). 테스트 환경/계정/속도 제한 합의.
- **D1~D3(테스트)**: 자동화는 저속·주기적, 필요한 페이로드만 사용. 데이터 추출 금지.
- **D3(취약점 발견)**: 내부 재현 → 위험도 산정(CVSS 등) → 영향 범위 추정.
- **D4(비공개 통지)**: 보안 리포트 제출(템플릿 하단). **민감정보/자격증명 포함 금지**.
- **D4~D34(벤더 대응)**: triage ↔ 재현, 완화안 제시. 임시 완화 시 즉시 리테스트.
- **D35~D90(패치 준비·배포)**: 합의한 공개일에 게시(Advisory/블로그/PoC 일부 마스킹).
- **D90+(사후)**: 교훈 정리, 재발 방지 체크리스트 업데이트.

> 실제 일정은 조직 규모/영향도에 따라 14~120일 등 다양. **항상 문서로 합의**.

## 2.3 RD 리포트 템플릿(요약)
- **제목**: `[High] IDOR on /api/v1/orders — read arbitrary order`
- **범위 일치 증빙**: 허가 문서/정책 링크/이메일 메시지-ID(캡처).
- **환경**: 테스트 계정/테스트 테넌트/버전/지역.
- **요약**: 한 줄 요지 + 실제 영향(무단 열람/수정 가능 등).
- **재현 단계**: 1) 로그인 2) `/orders?user_id=...` 요청 3) 응답에 타 사용자 데이터 노출.
- **PoC(최소침해)**: `curl` 1~2개 요청과 **마스킹된 응답 스니펫**.
- **영향 분석**: PII/재무/규정(GDPR/KPIPA 등) 관점.
- **권장 조치**: 권한 체크, 리소스 소유자 검증, 에러·로깅 개선.
- **부하/안전성**: 테스트 QPS/X, 시간대, 실패율, 롤백 없음.
- **연락·키**: 보안 이메일, PGP 키지문, 타임존, 가용 시간.

## 2.4 통지 이메일 샘플
```
Subject: [Responsible Disclosure] Access control issue in <product> (IDOR)

Hello <Security Team>,

I am contacting you under responsible disclosure. I have explicit permission per <policy link / signed email> to test within scope <scope text>.

Summary:
- Issue: Insecure direct object reference on /api/v1/orders
- Impact: Read access to other users’ orders under certain conditions
- Severity: High (unauthorized data access); minimal data accessed for proof

Reproduction (sanitized):
1) Login with test account (tenant: sandbox)
2) GET https://<host>/api/v1/orders/12345  (owned by A)
3) Changing the ID to 12346 returns order owned by B

I can share detailed steps and request/response samples encrypted with PGP if desired.

No stress tests, no mass enumeration, and no PII was stored. Please advise on a secure channel for details.
My public key: <fingerprint>
Preferred timeline: coordinate disclosure; I’m available UTC+9.

Best regards,
<Your Name / handle>
```

---

# 3. 법적 리스크 체크리스트 — “접근·권한·데이터·부하” 4축

> **주의**: 아래는 **법률 자문이 아님**. 국가·사안별 상이. 반드시 사내 법무/전문 변호사와 상의.

## 3.1 접근(Access)
- [ ] **명시적 허가**(서면/정책) 있는가?
- [ ] **정확한 대상**(도메인/앱/버전/테넌트/시간대)이 문서로 특정되었는가?
- [ ] 약관·정책에 **금지 행위(DoS/데이터 크롤링/자동화)**가 명시되어 있지 않은가?

## 3.2 권한(Authorization)
- [ ] 테스트 계정/토큰이 **테스트용**(샌드박스)임이 확인되었는가?
- [ ] **권한 상승/우회** 실험은 **벤더 합의 후 최소 범위**로만 시도하는가?
- [ ] 제3자 데이터/시스템에는 **절대 접근 금지** 원칙을 준수하는가?

## 3.3 데이터(Data)
- [ ] PII/결제/건강정보 등 **민감정보 최소 접근** 원칙을 지키는가?
- [ ] **다운로드/저장 금지**, 불가피 시 **마스킹 + 즉시 파기** 로그로 증빙하는가?
- [ ] 증빙 자료는 **해시/타임스탬프**로 봉인하고 보관기간/열람권한을 정했는가?

## 3.4 부하(Load)
- [ ] QPS/동시접속/크롤링 속도/테스트 윈도우를 사전 합의했는가?
- [ ] **리소스 소모형 공격(DoS, 대량 업로드/다운로드, 폭넓은 fuzzing)** 금지?
- [ ] SLO/알림 연동으로 장애 징후 감지 시 **즉시 중지** 룰이 있는가?

## 3.5 한국에서 자주 거론되는 법령(예시·요지)
- **정보통신망법/전자금융거래법/형법**: 무단 침입·업무방해·정보탈취 금지.  
- **개인정보보호법**: PII의 무단 수집·이용·처리 금지.  
- **부정경쟁방지법/저작권법**: 비밀정보·프로그램·데이터의 무단 취득/사용 금지.  
→ **요지**: **허가 없는 접근/수집 자체가 문제**가 될 수 있다. 정책 허용(버그바운티)이라도 **허용 범위 이탈**은 제재될 수 있음.

---

# 4. 버그바운티 / CTF / 랩 환경 — 경계선 명확히 긋기

## 4.1 버그바운티: “정책이 곧 계약”
- **반드시 읽을 것**: Scope(In/Out), 금지행위, Rate Limit, Test account, Safe Harbor 조항.
- **금지 예시**:  
  - 데이터 파괴/변조, 대량 트래픽, 고객 정보 열람·다운로드  
  - 제3자 통합(SaaS/결제 게이트웨이) 무단 테스트  
  - 소셜 엔지니어링/피싱/내부자 사칭
- **허용 예시(일반적)**:  
  - 논리적 취약점(권한 체크/IDOR) **테스트 데이터 한정**  
  - 리소스 탐색(robots/디렉터리 브라우징) — **저속·제한적**  
  - Rate-limit 내 인증·세션 처리 확인

### (안전) 버그바운티용 `curl` PoC 예시 — **IDOR 최소침해**
```bash
# 전제: 정책이 허용한 테스트 테넌트·테스트 계정.
# 1. 내 주문 조회
curl -i -H "Authorization: Bearer TEST_TOKEN" \
  "https://bugbounty.example.com/api/v1/orders/TEST-ORDER-1001"

# 2. 임의 ID 대입(다른 사용자 가정) — 응답이 "권한 없음"이어야 정상
curl -i -H "Authorization: Bearer TEST_TOKEN" \
  "https://bugbounty.example.com/api/v1/orders/TEST-ORDER-1002"
# 증빙: 403 또는 404가 나와야 함. 200이면 IDOR 가능성.
# 민감 응답 바디는 캡처하지 말고, 헤더/코드 수준만 기록(또는 값 마스킹).
```

## 4.2 CTF: “문제 = 허가 = 범위”
- CTF는 **문제 자체가 허가와 범위를 포함**. 운영진이 만든 환경 외부 스캔 금지.
- **공격은 CTF 인프라/타 팀에 해 끼치지 않는 선**. DoS, 스코어서버 공격 금지.
- **플래그** 취득 후 **공유 금지**, 리그 룰 준수.

### (안전) CTF용 로컬 랩(도커) 예시
```bash
# OWASP Juice Shop(의도적 취약 웹앱) 로컬 실행
docker run --rm -p 3000:3000 bkimminich/juice-shop

# 브라우저에서 http://localhost:3000 접속 → CTF 모드 제공
# Burp/ZAP 등 프록시를 붙여 안전하게 연습 (외부 트래픽 없음)
```

## 4.3 랩 환경: “내 장비/내 네트워크/내 데이터”
- 인터넷 격리(Host-only/NAT), **피험 대상은 내가 만든/허가 받은 시스템만**.
- 데이터는 **더미/합성** 사용. 실제 PII/회사 데이터 금지.
- **스냅샷-롤백 루틴**으로 리스크 제로화.

### (안전) 랩용 Nmap 스캔 스크립트(사설망만)
```bash
# 사설망(예: 192.168.56.0/24)에 한정, 속도/포트 제한
nmap -sS -T2 --max-retries 2 -p 22,80,443 192.168.56.0/24 \
  --exclude 192.168.56.1 \
  -oA lab_scan_$(date +%Y%m%d)

# 포인트: 느리게(T2), 재시도 제한, 좁은 포트 범위, 결과 로깅.
```

---

# 5. “무단”을 피하는 운영 테크닉 — 선제 안전장치 7가지

1. **도메인 화이트리스트**: 스캐너/스크립트는 **허용 도메인만** 치도록 강제.
2. **속도 리미터**: 전역 QPS, 동시요청 수를 낮게 설정(예: QPS 1, 동시 1~2).
3. **IP 방화벽**: 실수로 외부 때려도 나가지 않게 egress 차단.
4. **데이터 킬스위치**: 응답 크기/패턴이 PII 같으면 즉시 중지.
5. **모의 데이터 주입**: “실제 계정 = 접근 금지” 룰을 코드에 넣음.
6. **모든 로그에 타임스탬프/해시**: 증빙과 사후 설명을 위해.
7. **PGP 기본화**: 민감 제보는 암호화 이메일로만.

### (안전) Python 테스트 하네스(화이트리스트·속도 제한·PII 킬스위치)
```python
import re, time, hashlib, requests
from urllib.parse import urlparse

ALLOWED_HOSTS = {"bugbounty.example.com"}   # 정책 허용 도메인만
QPS = 0.5                                   # 초당 0.5회 = 2초 간격
PII_REGEX = re.compile(r'\b(\d{6}-\d{7}|\d{3}-\d{2}-\d{4})\b')  # 주민번호/SSN 예시

def safe_get(url, headers=None):
    host = urlparse(url).hostname
    assert host in ALLOWED_HOSTS, f"Host not allowed: {host}"
    time.sleep(2)  # QPS 제한
    r = requests.get(url, headers=headers or {}, timeout=10)
    # 헤더/코드만 로깅하고, 본문은 PII 탐지 시 버린다.
    body_preview = r.text[:400]
    if PII_REGEX.search(body_preview):
        raise RuntimeError("PII-like pattern detected. Aborting and purging response.")
    log_line = f"{int(time.time())} {r.status_code} {hashlib.sha256(body_preview.encode()).hexdigest()}"
    print(log_line)
    return r

# 사용 예시
# safe_get("https://bugbounty.example.com/api/v1/orders/TEST-ORDER-1001",
#          headers={"Authorization": "Bearer TEST_TOKEN"})
```

---

# 6. “예제 상황”으로 배우는 경계선

## 6.1 상황 A — 공개 웹서비스에서 로그인 없이 **대량 디렉토리 브루트포스**?
- **문제**: 약관·정책이 금지하는 자동 탐색/트래픽 폭주 가능. 무단 접근으로 판단될 소지.
- **화이트 방법**:
  - 정책을 확인하고, 허용 범위·속도·시간대 합의 후 **좁은·저속** 테스트.
  - 개별 중요한 엔드포인트만 **수동·선별** 확인.
- **그레이·블랙 리스크**:
  - 무단 대량화/부하 유발 시 업무방해/침해로 판단될 수 있음.

### (안전) “수동·저속” 체크 예시
```bash
# 허용 범위 내부, 10초 간격 수동 확인
for p in /admin /debug /swagger /actuator/health; do
  sleep 10
  curl -I "https://bugbounty.example.com$p" | sed -n '1,5p'
done
```

## 6.2 상황 B — 결제 API에 **리밋 우회 시도**?
- **문제**: 금전적 피해/중대한 장애 위험 → 대부분 정책에서 **금지**.
- **화이트 방법**:
  - 샌드박스 결제 엔드포인트/테스트 카드 범위에서 **정해진 시나리오**만 수행.
  - 우회 의혹은 **논리 검토/코드 리뷰 제안** 수준으로 보고.
- **PoC 대체**: 실제 결제 흐름이 아닌 **서명·토큰 유효성**의 논리 문제를 **테스트 토큰**으로 검증.

## 6.3 상황 C — 내부 네트워크가 섞인 개발자 랩에서 스캔?
- **문제**: 사설망이라도 **다른 팀·고객 환경**이 섞여 있을 수 있음.
- **화이트 방법**:
  - **세그먼트 분리 + 허가서** 확보. Nmap은 작은 포트 범위, 느린 타이밍.
  - 스캔 결과는 즉시 암호화 저장, 공유 최소화.

---

# 7. 보고서에 넣는 “방어 관점” — 항상 함께 쓰자

보안 연구자는 **탐지/대응 팀의 페인**을 이해하고 리포트에 **운영 가능**한 대책을 제안해야 한다.

- **권한 체크**: ID 기반이 아니라 **소유자 검사**(OWNER or SCOPE)로.
- **리소스 인덱스 숨김**: 단순 시퀀스 ID → UUID/ULID/난수화.
- **속도 제한**: 사용자·IP·토큰·엔드포인트·행동 조합 기반 Rate-limit.
- **감사 로그**: 실패/성공/경계 행동 로그에 **주체/리소스/결과/원격IP** 포함.
- **알림 튜닝**: 임계치/베이스라인 기반 알림, 허위 양성 관리.
- **비밀 관리**: 하드코딩 제거, KMS/Secrets Manager, 주기적 회전.
- **취약성 수명주기**: triage → owner 지정 → SLA(중요도별) → 회귀 테스트.

---

# 8. 공개(Disclosure) 수위 결정 가이드

- **즉시 비공개(Private only)**: 패치 전/제로데이/대규모 악용 가능.
- **조건부 공개(마스킹)**: 패치 배포 후 일정 기간 경과, 고객 영향 없는 PoC 일부.
- **완전 공개**: 공급망 의존 크고, 이미 다수에 통지된 경우(벤더와 합의).

> 공개 시 **악용 재현 경로**는 생략하거나 **환경·토큰·식별자**를 완전 변경.

---

# 9. 체크리스트 — 하루 전/테스트 전/보고 전

## 9.1 하루 전 (D-1)
- [ ] 허가 문서/정책 재확인(범위, 금지행위, 속도).
- [ ] 테스트 계정/테넌트, 더미 데이터 준비.
- [ ] 방화벽/화이트리스트/속도 제한 **ON**.
- [ ] 증빙 로깅(시간/해시) 스크립트 리허설.

## 9.2 테스트 직전
- [ ] 타임윈도우 합의(업무시간 피하기).
- [ ] 모니터링 설정(SLO/알람수신).
- [ ] 중지 기준(오탐/부하) 합의.

## 9.3 보고 전
- [ ] PII/자격증명/키 **포함 여부 0회** 확인.
- [ ] PoC는 최소·마스킹, 재현 단계는 구체.
- [ ] 권고안은 **우선순위/노력도/리스크**까지 제시.

---

# 10. 예제 코드 모음 (안전 중심)

## 10.1 “권한 체크 실패” 재현용 최소 PoC(테스트 범위 한정)
```bash
TOKEN="Bearer <TEST_TOKEN>"
HOST="https://bugbounty.example.com"

# 내 리소스 조회 (기준)
curl -s -H "Authorization: $TOKEN" "$HOST/api/v1/orders/OWN-1001" | head -c 200

# 타 리소스 추정 조회 — 정상이라면 403/404
curl -i -H "Authorization: $TOKEN" "$HOST/api/v1/orders/OWN-1001" \
| awk 'NR<=5{print}'

curl -i -H "Authorization: $TOKEN" "$HOST/api/v1/orders/OTH-1002" \
| awk 'NR<=5{print}'
```

## 10.2 Burp/ZAP 자동화 시 QPS 제한(파이프라이닝 금지)
- **Burp**: “Project options → Throttle requests” 활성화, 1req/2s 수준.
- **ZAP**: 스크립트에서 `Thread.sleep()` 삽입, 스파이더 깊이/속도 제한.

## 10.3 Node.js로 **화이트리스트 + 타임박스** HTTP 검사
```js
import http from "node:http";
import https from "node:https";

const ALLOW = new Set(["bugbounty.example.com"]);
const TIMEBOX_MS = 8000;

function safeFetch(url) {
  const host = new URL(url).hostname;
  if (!ALLOW.has(host)) throw new Error("Host not allowed: " + host);

  return new Promise((resolve, reject) => {
    const m = url.startsWith("https") ? https : http;
    const req = m.get(url, res => {
      let chunks = "";
      res.on("data", d => {
        chunks += d.toString();
        if (chunks.length > 800) { // 본문 제한
          req.destroy(new Error("Body limit exceeded"));
        }
      });
      res.on("end", () => resolve({status: res.statusCode, body: chunks}));
    });
    const timer = setTimeout(() => {
      req.destroy(new Error("Timebox exceeded"));
    }, TIMEBOX_MS);
    req.on("error", e => reject(e));
    req.on("close", () => clearTimeout(timer));
  });
}

// 사용시: await safeFetch("https://bugbounty.example.com/health");
```

---

# 11. 팀/회사 관점: 정책에 넣을 “세 줄 요약”

1) **Safe Harbor**: 허용 범위·조건 준수 시, 선의의 연구자에게 법적 조치를 취하지 않음.  
2) **In/Out of Scope**: 도메인/앱/버전 명시, 결제/PII/3rd-party 금지 명시.  
3) **신고 채널/PGP**: 전용 이메일·폼·PGP 제공, 2 영업일 이내 수신 확인 SLA.

---

# 12. FAQ — 자주 부딪히는 회색 지대

- **정책이 없는데 제보하고 싶다?** → **테스트하지 말고** CS/보안 메일로 “현상 가능성”만 전달. **PoC는 만들지 않는다.**
- **로그인 필요 없는 페이지 크롤링은 괜찮나?** → 약관·robots·rate-limit 확인 전에는 **아니오**.
- **제3자 위젯/결제/SSO는?** → 보통 **Out of Scope**. 벤더 승인 없이는 테스트 금지.
- **CTF 플랫폼 취약점을 찾았다?** → 운영진에게 즉시 신고, 문제 풀이 외 공격 금지.

---

# 13. 마무리 — “문서화된 선의”가 나를 지킨다

화이트/그레이의 차이는 마음속이 아니라 **문서**에 있다.  
- 허가/범위/속도/데이터/공개: **모두 문서화**하라.  
- 보고서에는 **방어 관점**까지 담아라.  
- 실습은 **CTF/랩**에서, 리얼은 **버그바운티 범위 내**에서만.

---

# 부록 A. Responsible Disclosure 리포트(상세 템플릿)

- 제목: `[Severity] <취약점 요약>`
- 제품/버전/환경: `<앱명/버전/테넌트/지역/브라우저/OS>`
- 허가·범위 증빙: `<정책 링크/허가 이메일 메시지-ID 캡처>`
- 요약: `<한 줄 설명>`
- 영향도: `<CVSS 대략/사업적 영향>`
- 재현 단계:
  1) `<로그인 or 사전조건>`
  2) `<요청 1 — 엔드포인트, 메서드, 파라미터(마스킹)>`
  3) `<기대 vs 실제>`
- PoC(최소·마스킹):
  ```
  curl -H "Authorization: Bearer TEST" "https://<host>/api/v1/orders/OWN-1001"
  (응답 일부 마스킹)
  ```
- 완화/수정 제안: `<권한 체크/입력 검증/로그/알림/속도 제한>`
- 안전성: `<부하 없음, PII 저장 안함, 테스트 데이터만 사용>`
- 타임라인 제안: `<수신확인→triage→패치→공개>`
- 연락/PGP: `<메일/키 지문>`

---

# 부록 B. “나의 테스트가 화이트인지” 자가 진단 10문

1) 서면/정책 허가가 있는가?  
2) 정확한 범위가 문서로 특정되는가?  
3) 제3자/실제 고객 데이터에 닿지 않는가?  
4) 테스트 계정/더미 데이터만 사용했는가?  
5) QPS/동시성은 합의된가?  
6) DoS/폭주 가능 시도를 배제했는가?  
7) PoC는 최소한이며 PII를 담지 않는가?  
8) 모든 요청/응답은 해시/타임스탬프 로깅 중인가?  
9) 보안팀 연락 채널과 PGP가 준비되어 있는가?  
10) 공개 일정은 합의했는가?

이 10문 중 1개라도 “아니오”라면, **멈추고 정비**하세요.