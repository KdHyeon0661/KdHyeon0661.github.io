---
layout: post
title: CSS - 브라우저 호환성 이슈 및 해결법
date: 2025-05-06 21:20:23 +0900
category: CSS
---
# 브라우저 호환성 이슈 및 해결법

## 0) 핵심 요약(치트시트)

- **전략**: _프로그레시브 인핸스먼트_ + `@supports` / 기능 감지(Modernizr/JS) + Autoprefixer + Polyfill + 테스트 매트릭스  
- **사파리(iOS)**: `100vh` 대신 `100dvh`/`-webkit-fill-available`, `position: sticky` + 조상 `overflow` 주의, `backdrop-filter` 성능/지원  
- **파이어폭스**: 일부 `-webkit-` 전용 효과(스크롤바, 텍스트 클램핑) 대체 필요  
- **CSS 최신**: `:has()`(현행 주요 브라우저 지원), `subgrid`(FF 우수, WebKit/Chromium 점진 지원), 컨테이너 쿼리(현행 크로스 지원 양호)  
- **JS 최신**: 모듈/노모듈 분기, import maps(안정화), 폴리필은 **polyfill.io** 또는 **Babel + core-js**로 타게팅  
- **이미지**: AVIF/WebP + JPG 폴백, `<picture>`로 안전 구성

---

## 1) 주요 렌더링 엔진과 관점 정리

| 브라우저                   | 엔진       | 비고/특이점 요약 |
|---------------------------|------------|------------------|
| Chrome, Edge, Samsung     | Blink      | 최신 표준 빠름, 실험 플래그·하드웨어 다양성 |
| Firefox                   | Gecko      | `subgrid` 선도, 일부 `-webkit-` 전용 기능 비호환 |
| Safari (macOS/iOS 포함)   | WebKit     | iOS 장치에서 **반드시 실기 테스트**, 뷰포트·입력 포커스·모달 스크롤 특이 |

> **관점**: “특정 브라우저를 맞춘다”가 아니라 **표준 기능 지원 여부**와 **대체 전략**을 시스템화합니다.

---

## 2) 빈도가 높은 이슈 패턴 — 원인과 바로 쓰는 해결책

### 2.1 `100vh` 오작동(모바일 주소창) → `100dvh` / `-webkit-fill-available`

```css
.hero{
  min-height: 100vh;            /* 폴백 */
  min-height: 100dvh;           /* 주소창 변동 반영 (권장) */
}
@supports (-webkit-touch-callout: none){
  /* iOS Safari 특화 보정 */
  .hero{ min-height: -webkit-fill-available; }
}
```

### 2.2 Flexbox 정렬/높이 상이(특히 Safari)

- 부모/자식 모두에 `min-height: 0` 또는 `overflow: hidden`을 지정해 **컨텐츠 축소 허용**  
- `align-items: baseline`/`stretch`에서 폰트 메트릭 차이 주의

```css
.flex-col{
  display: flex; flex-direction: column;
  min-height: 0; /* Safari에서 자식 overflow 스크롤 허용 */
}
.flex-col > .scroll{
  overflow: auto; min-height: 0;
}
```

### 2.3 `position: sticky`가 작동 안 함

- **조상에 `overflow`가 있으면 끊김**: 가능한 상위 overflow 제거 또는 스크롤 컨테이너 재설계

```css
.header{ position: sticky; top: 0; z-index: 10; }
.wrapper{ overflow: visible; } /* sticky 조상은 overflow 피하기 */
```

### 2.4 `backdrop-filter` 지원/성능

- Safari/Chromium 지원, **성능·투명도 계층 주의**, 불가 시 폴백 배경 사용

```css
.blur{
  background: rgba(255,255,255,.6);
  -webkit-backdrop-filter: saturate(1.2) blur(10px);
          backdrop-filter: saturate(1.2) blur(10px);
}
/* 폴백 (지원 안 될 때 대비) */
@supports not (backdrop-filter: blur(1px)){
  .blur{ background: rgba(255,255,255,.9); }
}
```

### 2.5 `aspect-ratio` 폴백

```css
@supports (aspect-ratio: 16/9) {
  .video{ aspect-ratio: 16 / 9; }
}
@supports not (aspect-ratio: 16/9){
  .video{ height: 0; padding-bottom: 56.25%; position: relative; }
  .video > iframe{ position: absolute; inset: 0; width: 100%; height: 100%; }
}
```

### 2.6 폼 UI 상이(라디오/체크박스/셀렉트)

- **리셋 + 접근성 보존**: `appearance`/`accent-color` 사용, 불가 시 커스텀 UI + 접근성 속성

```css
/* 간단 커스텀 + 시스템 색상 기반 */
input[type="checkbox"], input[type="radio"]{
  accent-color: #2563eb; /* 지원 브라우저에서 깔끔 */
}
/* 완전 커스텀 시 */
input[type="checkbox"].visually-hidden{
  position: absolute; clip: rect(0 0 0 0); clip-path: inset(50%); width: 1px; height: 1px; overflow: hidden;
}
.checkbox-ui{
  inline-size: 1.25rem; block-size: 1.25rem;
  border: 2px solid currentColor; border-radius: .25rem;
}
.visually-hidden:checked + .checkbox-ui{ background: currentColor; }
```

### 2.7 이미지 포맷 호환(WebP/AVIF) → 폴백

```html
<picture>
  <source type="image/avif" srcset="/img/hero.avif">
  <source type="image/webp" srcset="/img/hero.webp">
  <img src="/img/hero.jpg" alt="설명" width="1200" height="800" loading="lazy" decoding="async">
</picture>
```

### 2.8 스크롤 스냅/관성 차이

```css
.carousel{
  display: grid; grid-auto-flow: column; gap: 1rem;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}
.carousel > *{ scroll-snap-align: start; }
```

---

## 3) CSS 전개 전략 — 프리픽스, 폴백, 기능 감지

### 3.1 Autoprefixer + Browserslist

```bash
npm i -D postcss autoprefixer
```

`postcss.config.js`
```js
module.exports = { plugins: [require('autoprefixer')] };
```

`package.json` (예시 타깃)
```json
{
  "browserslist": [
    ">= 0.5%",
    "last 2 versions",
    "not dead"
  ]
}
```

> 팀 정책에 맞게 구체화: 예) 기업용 인트라넷이면 **ESR Firefox + 특정 Edge 버전** 등 확정.

### 3.2 `@supports`로 **프로그레시브 인핸스먼트**

```css
.card{ /* 기본 레이아웃 */ }
@supports (display: grid){
  .card{ display: grid; grid-template-columns: 1fr auto; }
}
```

### 3.3 컨테이너 쿼리(지원 양호) — 미지원 폴백

```css
/* 폴백: 단순 1열 */
.cards{ display: grid; grid-template-columns: 1fr; gap: 1rem; }

/* 지원 시: 컨테이너 기준 반응형 */
@container (min-width: 600px){
  .cards{ grid-template-columns: repeat(2, 1fr); }
}
```

> 컨테이너 쿼리 사용 시 **컨테이너에 `container-type: inline-size;`** 지정 필요.

```css
.section{ container-type: inline-size; }
```

---

## 4) 자바스크립트 호환 — 모듈, 폴리필, 기능 감지

### 4.1 모듈/노모듈 번들 분기

```html
<script type="module" src="/assets/app.mjs"></script>
<script nomodule src="/assets/legacy.bundle.js"></script>
```

### 4.2 기능 감지(Feature Detection)

```js
// fetch/AbortController 예시
if ('fetch' in window && 'AbortController' in window) {
  // 최신 경로
} else {
  // 폴리필 불러오기 또는 XHR 대체
}
```

### 4.3 폴리필 세팅

- **polyfill.io** (자동 UA 타게팅)
```html
<script src="https://polyfill.io/v3/polyfill.min.js?features=default,fetch"></script>
```

- **Babel + core-js** (정밀 컨트롤)
```bash
npm i -D @babel/core @babel/preset-env core-js
```

`.babelrc`
```json
{
  "presets": [
    ["@babel/preset-env", {
      "useBuiltIns":"usage",
      "corejs":3,
      "targets":">=0.5%, not dead"
    }]
  ]
}
```

---

## 5) Normalize/Reset + 기본 리듬(접근성/가독성)

```html
<link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
```

```css
/* 실전형 최소 커스텀 */
*{ box-sizing: border-box }
html{ -webkit-text-size-adjust: 100%; }
body{ margin: 0; line-height: 1.6; font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', sans-serif; }
img,svg,video{ max-width:100%; height:auto; display:block; }
a{ color: inherit; text-decoration: underline; text-underline-offset: .18em; }
:focus-visible{ outline: 3px solid #2563eb; outline-offset: 2px; }
```

---

## 6) 문제를 재현·진단하는 절차(디버깅 루틴)

1) **재현 최소 샌드박스** 생성(HTML+CSS 30줄 내로 축소)  
2) **엔진별 테스트**: Safari(mac/iOS), Firefox, Chromium  
3) **변수 격리**: 레이아웃/포지셔닝/오버플로우/트랜스폼/필터/`will-change` 제거  
4) **측정**: DevTools Rendering/Performance/Layer Borders, **LCP/CLS** 체크  
5) **표준 확인**: `@supports`, Can I use, 스펙 노트 확인  
6) **대안 적용**: 폴백/프리픽스/구조조정 후 회귀 테스트

---

## 7) 실전 레시피 모음

### 7.1 `vh`·주소창·노치 안전영역 통합

```css
:root{
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}
.hero{
  min-height: 100vh; min-height: 100dvh;
  padding: calc(1rem + var(--safe-top)) calc(1rem + var(--safe-right))
           calc(1rem + var(--safe-bottom)) calc(1rem + var(--safe-left));
}
```

### 7.2 크로스브라우저 그림자·블러(폴백 포함)

```css
.glass{
  background: rgba(255,255,255,.6);
  border: 1px solid rgba(255,255,255,.4);
  box-shadow: 0 6px 24px rgba(0,0,0,.12);
  -webkit-backdrop-filter: blur(12px);
          backdrop-filter: blur(12px);
}
@supports not (backdrop-filter: blur(1px)){
  .glass{ background: rgba(255,255,255,.9); }
}
```

### 7.3 텍스트 줄임(멀티라인) 크로스 전략

```css
/* WebKit 멀티라인 */
.clamp{
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 3;      /* 3줄 */
  overflow: hidden;
}
/* Firefox 대안: 컨테이너 높이 고정 + gradient fade */
.fade{
  position: relative; max-height: 4.8em; overflow: hidden; /* 1.6em * 3줄 */
}
.fade::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(transparent 60%, white);
}
```

### 7.4 스크롤바 스타일(벤더 이질성)

```css
/* Chromium/WebKit */
.container::-webkit-scrollbar{ height: 10px; }
.container::-webkit-scrollbar-thumb{ background: #bbb; border-radius: 8px; }
/* Firefox */
.container{
  scrollbar-color: #bbb transparent; /* thumb track */
  scrollbar-width: thin;
}
```

### 7.5 `:has()` 사용 + 폴백

```css
/* 지원 시: 부모 상태를 자식으로 감지 */
.card:has(img:hover){ outline: 2px solid #2563eb; }

/* 폴백: JS로 보조(선택) */
document.querySelectorAll('.card img').forEach(img=>{
  img.addEventListener('mouseenter', e=> e.currentTarget.closest('.card')?.classList.add('hover'));
  img.addEventListener('mouseleave', e=> e.currentTarget.closest('.card')?.classList.remove('hover'));
});
```

### 7.6 `dialog` 요소(브라우저별 세부 차이) 안전 사용

```html
<dialog id="dlg">
  <form method="dialog">
    내용
    <button value="close">닫기</button>
  </form>
</dialog>
<button id="open">Open</button>
<script>
  const d = document.getElementById('dlg');
  document.getElementById('open').onclick = ()=> d.showModal?.() ?? (d.setAttribute('open',''), /* 폴백 스타일 */0);
</script>
```

> Safari 구버전/임베디드 WebView에선 폴리필 고려(예: `dialog-polyfill`).

---

## 8) 테스트 전략 — 도구·자동화

### 8.1 수동/실기
- **BrowserStack / LambdaTest**: 실제 기기/브라우저  
- **iOS Safari 실기**: 주소창/키보드/홈 인디케이터/노치 확인

### 8.2 정적 검증
- **Stylelint/ESLint**: 잠재 호환 이슈 룰 추가  
- **Lighthouse/WebPageTest**: LCP/CLS/TBT 측정 → 일부 CSS 기능이 성능에 미치는 영향 간접 파악

### 8.3 E2E/시각 회귀
- **Playwright**: 다양한 브라우저 채널 테스트
```bash
npx playwright test --project=chromium
npx playwright test --project=firefox
npx playwright test --project=webkit
```

- **Percy/Chromatic/Applitools**: 시각 회귀로 렌더링 차이 감지

---

## 9) 빌드 파이프라인에 넣는 최소 설정(샘플)

**Vite/webpack** 기준(개요):

1) PostCSS + Autoprefixer  
2) Babel preset-env(레거시 번들)  
3) 브라우저 타깃: `browserslist`  
4) CI에서 Playwright 3엔진 테스트

```json
// package.json
{
  "browserslist": [
    ">=0.5%",
    "last 2 versions",
    "not dead"
  ],
  "scripts": {
    "test:ui":"playwright test",
    "build":"vite build"
  }
}
```

---

## 10) 실전 체크리스트(운영 전)

- [ ] `@supports`/JS 기능 감지로 폴백 경로 존재  
- [ ] Autoprefixer가 **실제로 동작**(빌드 결과 CSS 확인)  
- [ ] 이미지 `<picture>` + AVIF/WebP + JPG 폴백  
- [ ] `100dvh`/`-webkit-fill-available`로 뷰포트 대응  
- [ ] `sticky` 조상 `overflow` 미사용 확인  
- [ ] 입력/포커스/모달 시 스크롤 전파 차단(`overscroll-behavior`)  
- [ ] Playwright(WebKit/Gecko/Blink) 스냅샷 통과  
- [ ] BrowserStack에서 iOS Safari/안드 크롬 **실기 확인**  

---

## 11) 확장: 문제→원인→대응 매핑 표

| 문제                                 | 원인/엔진                    | 1차 대응                         | 2차 대응 |
|--------------------------------------|------------------------------|----------------------------------|----------|
| 모바일에서 `100vh` 찌그러짐          | WebKit 주소창                 | `100dvh`/`-webkit-fill-available`| JS resize 보정 |
| `sticky` 안 붙음                      | 조상 `overflow`/transform    | 조상 overflow 제거               | 레이아웃 재설계 |
| `backdrop-filter` 안 먹힘/느림        | 미지원/성능                  | `@supports` 폴백 배경            | 블러 영역 축소 |
| 텍스트 멀티라인 생략 불가(Firefox)    | `-webkit-line-clamp` 전용     | gradient 페이드 폴백             | JS 측정/재배치 |
| 스크롤바 스타일 통일 어려움           | 엔진별 API 상이              | WebKit/FF 이중 스타일            | 기본값 유지 |
| 폼 스타일 제각각                     | 네이티브 컴포넌트 차이        | `accent-color`/리셋              | 완전 커스텀 + a11y |
| Grid `subgrid` 의존 레이아웃          | 엔진별 지원 단계             | CSS Vars/중첩 Grid 폴백          | 빌드 타겟 축소 |

---

## 12) 예제: “깨지지 않는” 반응형 카드 섹션(폴백 포함)

```html
<section class="section">
  <h2>Products</h2>
  <div class="cards">
    <article class="card">A</article>
    <article class="card">B</article>
    <article class="card">C</article>
  </div>
</section>
```

```css
/* 컨테이너 쿼리 대비 */
.section{ container-type: inline-size; padding: 1rem; }

/* 기본(폴백) 1열 */
.cards{ display: grid; grid-template-columns: 1fr; gap: 1rem; }

/* 그리드 지원 시 간격/열 확장 */
@supports (display: grid){
  @media (min-width: 600px){ .cards{ grid-template-columns: repeat(2, 1fr); } }
  @media (min-width: 900px){ .cards{ grid-template-columns: repeat(3, 1fr); } }
}

/* 컨테이너 쿼리 지원 시 레이아웃 개선 */
@container (min-width: 700px){
  .cards{ grid-template-columns: repeat(2, 1fr); }
}
@container (min-width: 1000px){
  .cards{ grid-template-columns: repeat(3, 1fr); }
}

.card{
  background: #fff; border-radius: 16px; padding: 1rem;
  box-shadow: 0 6px 20px rgba(0,0,0,.08);
  transition: transform .2s ease, box-shadow .2s ease;
}
@media (hover: hover){
  .card:hover{ transform: translateY(-2px); box-shadow: 0 12px 30px rgba(0,0,0,.12); }
}
```

---

## 13) 수학적 관점(선택적) — 뷰포트 비율 기반 타이포 `clamp()`

뷰포트 너비 \( w \)와 기본 폰트 \( f_{\min}, f_{\max} \) 사이의 선형 보간을 `clamp`로 근사할 수 있습니다.

$$
f(w) = \mathrm{clamp}\big(f_{\min},\; a \cdot w + b,\; f_{\max}\big)
$$

예: `h1 { font-size: clamp(1.5rem, 5vw, 2.5rem); }` 는  
\( a=0.05\mathrm{rem}/\% \) 근사로, 모바일~데스크탑 구간에서 **미디어쿼리 없이** 스무스하게 스케일합니다.

---

## 14) 마무리

브라우저 호환성은 “특정 브라우저를 위한 예외처리”가 아니라 **표준 기능의 유무를 감지하고, 늘 안전한 폴백 경로를 준비**하는 일입니다.  
위의 **체크리스트/레시피/자동화 파이프라인**을 프로젝트 템플릿으로 고정해두면, 새 이슈가 생겨도 **원인→대응** 절차를 일관되게 적용할 수 있습니다.

---

## 참고(빠르게 확인할 링크)

- Can I use: 기능별 지원 현황 검색  
- Autoprefixer / PostCSS: 프리픽스 자동화  
- Modernizr: 기능 감지 툴킷  
- BrowserStack/LambdaTest: 실기/원격 테스트  
- Playwright: Chromium/Firefox/WebKit 자동화 테스트