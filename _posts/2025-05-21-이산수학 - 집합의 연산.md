---
layout: post
title: 이산수학 - 집합의 연산
date: 2025-05-21 18:20:23 +0900
category: 이산수학
---
# 집합의 연산(Set Operations)

## 학습 목표

- 합집합, 교집합, 차집합, 여집합의 **정의·성질·증명**을 원소 기반으로 제시한다.
- 분배법칙, 드모르간, 흡수, 멱등 등 **집합 대수 법칙**을 숙지한다.
- 대칭차, 색인된 집합족, 지시함수, 논리·확률·데이터베이스 대응까지 확장한다.
- 파이썬 `set/frozenset` 으로 **실습·검증**하고, 흔한 함정과 성능 이슈를 짚는다.

---

## 기본 개념과 표기

집합은 원소들의 모임이다. 전체집합(우주) $$U$$ 를 고정하면 여집합을 $$A^c=U\setminus A$$ 로 정의한다.

핵심 기호(모두 수식으로 표기):
- 소속: $$x\in A,\ \ x\notin A$$
- 부분집합: $$A\subseteq B \iff (\forall x)(x\in A\Rightarrow x\in B)$$
- 동일: $$A=B \iff (A\subseteq B\ \land\ B\subseteq A)$$

---

## 네 가지 기본 연산

### 합집합(Union)

정의:
$$
A\cup B=\{\,x\mid x\in A\ \text{또는}\ x\in B\,\}.
$$
성질: 교환, 결합, 항등(공집합)
$$
A\cup B=B\cup A,\quad (A\cup B)\cup C=A\cup(B\cup C),\quad A\cup\varnothing=A.
$$

### 교집합(Intersection)

정의:
$$
A\cap B=\{\,x\mid x\in A\ \text{그리고}\ x\in B\,\}.
$$
성질: 교환, 결합, 항등(전체집합)
$$
A\cap B=B\cap A,\quad (A\cap B)\cap C=A\cap(B\cap C),\quad A\cap U=A.
$$

### 차집합(Difference)

정의(상대 여집합):
$$
A\setminus B=\{\,x\mid x\in A\ \text{그리고}\ x\notin B\,\}.
$$
주의: 일반적으로 $$A\setminus B\neq B\setminus A$$, 또한 **비결합적**이다
(반례: $$A=\{1,2\},B=\{2\},C=\{1\}$$ 에서 $$(A\setminus B)\setminus C=\varnothing\neq \{2\}=A\setminus(B\setminus C)$$).

기본식:
$$
A\setminus \varnothing=A,\quad A\setminus A=\varnothing,\quad \varnothing\setminus A=\varnothing.
$$

### 여집합(Complement)

정의(우주 $$U$$ 에 대하여):
$$
A^c=\{\,x\in U\mid x\notin A\,\}=U\setminus A.
$$
성질:
$$
(A^c)^c=A,\quad A\cup A^c=U,\quad A\cap A^c=\varnothing.
$$

---

## 복합 법칙(원소-기반 증명 포함)

### 분배법칙

$$
A\cap(B\cup C)=(A\cap B)\cup(A\cap C),\quad
A\cup(B\cap C)=(A\cup B)\cap(A\cup C).
$$
스케치(좌식 첫째): $$x\in A\cap(B\cup C)\iff (x\in A \land (x\in B\lor x\in C))\iff (x\in A\land x\in B)\lor(x\in A\land x\in C).$$

### 드모르간

$$
(A\cup B)^c=A^c\cap B^c,\quad (A\cap B)^c=A^c\cup B^c.
$$
증명(첫째): $$x\in(A\cup B)^c\iff \lnot(x\in A\lor x\in B)\iff (\lnot x\in A)\land(\lnot x\in B)\iff x\in A^c\cap B^c.$$

### 흡수·멱등·보수

$$
A\cup(A\cap B)=A,\quad A\cap(A\cup B)=A,\quad A\cup A=A,\ A\cap A=A,\quad A\cup A^c=U,\ A\cap A^c=\varnothing.
$$

### 차집합 분배

$$
A\setminus(B\cup C)=(A\setminus B)\cap(A\setminus C),\quad
A\setminus(B\cap C)=(A\setminus B)\cup(A\setminus C).
$$
(각각 드모르간+정의로 즉시 도출)

---

## 대칭차(Symmetric Difference)

정의(서로 다른 부분의 합):
$$
A\triangle B=(A\setminus B)\cup(B\setminus A)= (A\cup B)\setminus(A\cap B).
$$

성질:
$$
A\triangle B=B\triangle A,\quad (A\triangle B)\triangle C= A\triangle(B\triangle C).
$$
분배(교집합 위):
$$
A\cap(B\triangle C)=(A\cap B)\triangle(A\cap C).
$$
알고리즘 관점: 비트셋에서 $$\triangle$$ 는 XOR 과 일치한다.

구조적 사실: $$\langle\mathcal P(U),\triangle,\cap\rangle$$ 는 **부울 링**의 한 구현이며, $$\triangle$$ 에 대해 아벨 군을 이룬다.

---

## 색인된 집합족과 드모르간(확장형)

집합족 $$\{A_i\}_{i\in I}$$ 에 대해
$$
\bigcup_{i\in I}A_i=\{x\mid \exists i\in I,\, x\in A_i\},\quad
\bigcap_{i\in I}A_i=\{x\mid \forall i\in I,\, x\in A_i\}.
$$
확장 드모르간:
$$
\left(\bigcup_{i\in I}A_i\right)^c= \bigcap_{i\in I} A_i^c,\quad
\left(\bigcap_{i\in I}A_i\right)^c= \bigcup_{i\in I} A_i^c.
$$

---

## 관점

$$
\mathbf{1}_A(x)=\begin{cases}
1 & x\in A\\
0 & x\notin A
\end{cases}
$$
이면
$$
\mathbf{1}_{A\cup B}=\max(\mathbf{1}_A,\mathbf{1}_B),\quad
\mathbf{1}_{A\cap B}=\min(\mathbf{1}_A,\mathbf{1}_B),\quad
\mathbf{1}_{A^c}=1-\mathbf{1}_A,\quad
\mathbf{1}_{A\triangle B}=\mathbf{1}_A+\mathbf{1}_B\ \bmod 2.
$$
확률에서 사건 연산과 기대값(선형성) 처리에 유용하다.

---

## 논리·확률·데이터베이스와의 대응

### 논리

우주 $$U$$ 의 부분집합을 명제의 진리집합으로 보면
$$
\lor\leftrightarrow \cup,\ \ \land\leftrightarrow \cap,\ \ \lnot\leftrightarrow (\cdot)^c,\ \ (P\Rightarrow Q)\leftrightarrow P^c\cup Q=U.
$$

### 확률

사건 $$A,B$$ 에 대해
$$
\Pr(A\cup B)=\Pr(A)+\Pr(B)-\Pr(A\cap B).
$$
독립이라면 $$\Pr(A\cap B)=\Pr(A)\Pr(B).$$
대칭차는 “서로 다른 발생”의 사건으로, $$\Pr(A\triangle B)=\Pr(A)+\Pr(B)-2\Pr(A\cap B).$$

### 데이터베이스(SQL)

집합 연산에 대응:
- `UNION`(집합 합), `INTERSECT`(교집합), `EXCEPT`(차집합).
주의: SQL 기본은 중복 제거(집합 의미), `UNION ALL` 등은 **다중집합** 의미.
`NULL` 은 3값 논리라 집합적 직관과 다를 수 있다.

---

## 흔한 함정과 반례

- 차집합 비결합/비교환: 앞의 예처럼 쉽게 깨진다.
- 여집합은 **우주 $$U$$ 가 고정**되어야 의미가 명확하다.
- 다중집합(bag)과 집합 혼동: 프로그래밍/SQL에서는 중복 처리 정책을 확인할 것.
- 분배법칙 오용: $$A\setminus(B\setminus C) \neq (A\setminus B)\setminus (A\setminus C)$$ 일반적으로 성립하지 않는다(반례 구성 가능).

---

## 파이썬 실습

### 기본 연산

```python
A = {1, 2, 3}
B = {3, 4, 5}
U = {1, 2, 3, 4, 5, 6}

print("합집합:", A | B)           # {1, 2, 3, 4, 5}
print("교집합:", A & B)           # {3}
print("차집합:", A - B)           # {1, 2}
print("여집합(A):", U - A)        # {4, 5, 6}
print("대칭차:", A ^ B)           # {1, 2, 4, 5}
```

### 법칙 퍼저(무작위 검증)

```python
import random

def rand_subset(U, p=0.5):
    return {x for x in U if random.random() < p}

U = set(range(20))

def de_morgan_ok(trials=200):
    for _ in range(trials):
        A, B = rand_subset(U), rand_subset(U)
        left  = U - (A | B)
        right = (U - A) & (U - B)
        if left != right:
            return False
    return True

def distribute_ok(trials=200):
    for _ in range(trials):
        A, B, C = rand_subset(U), rand_subset(U), rand_subset(U)
        if A & (B | C) != (A & B) | (A & C):
            return False
        if A | (B & C) != (A | B) & (A | C):
            return False
    return True

print("De Morgan:", de_morgan_ok())
print("Distributive:", distribute_ok())
```

### 대칭차 군 성질 점검

```python
def symdiff_assoc_ok(trials=200):
    for _ in range(trials):
        A, B, C = rand_subset(U), rand_subset(U), rand_subset(U)
        if (A ^ B) ^ C != A ^ (B ^ C):
            return False
    return True

print("Symmetric difference associative:", symdiff_assoc_ok())
```

### 불변 집합과 키 사용

```python
A = frozenset({1,2})
B = frozenset({2,3})
S = {A, B}  # frozenset 은 해시 가능
```

### 비트셋(정수)로 연산하기

```python
# U = {0..31} 비트 집합으로 표현

def to_bits(S):
    x = 0
    for v in S:
        x |= (1 << v)
    return x

def from_bits(x):
    out, i = set(), 0
    while x:
        if x & 1: out.add(i)
        x >>= 1; i += 1
    return out

A = {1,3,4}; B = {3,5}
bits_union = to_bits(A) | to_bits(B)        # 합집합
bits_inter = to_bits(A) & to_bits(B)        # 교집합
bits_diff  = to_bits(A) & ~to_bits(B)       # 차집합
bits_xor   = to_bits(A) ^ to_bits(B)        # 대칭차

print(from_bits(bits_union))
print(from_bits(bits_inter))
print(from_bits(bits_diff))
print(from_bits(bits_xor))
```

성능 메모: 파이썬 `set` 에서 `in` 테스트는 평균 O(1), 합/교/차는 대략 O(|A|+|B|). 정수 비트셋은 작은 우주에서 매우 빠르다.

---

## 원소-기반 증명 연습

1) 증명: $$A\setminus(B\cup C)=(A\setminus B)\cap(A\setminus C).$$
힌트: 좌변 정의 후 드모르간.

2) 증명: $$(A\cap B)\subseteq A,\ (A\subseteq B)\iff (A\cup B=B)\iff (A\cap B=A).$$

3) 등식 증명: $$A\triangle B=(A\cup B)\setminus(A\cap B).$$
양 포함으로 보일 것.

4) 색인형 드모르간: $$\left(\bigcap_{i\in I}A_i\right)^c=\bigcup_{i\in I}A_i^c.$$

---

## 실전 시나리오

- 태그 검색: “Python AND Data”는 $$P\cap D$$, “Python OR Data”는 $$P\cup D$$, “Python NOT Data”는 $$P\setminus D$$.
- 접근제어: 허용 집합 $$A$$, 금지 집합 $$D$$ 가 있을 때 가능한 집합은 $$A\setminus D$$.
- 데이터 클린업: 중복 제거는 집합화, 공통 사용자 추출은 교집합, 한쪽 전용은 차집합.

---

## 체크리스트

- 여집합은 항상 **우주 $$U$$ 명시**.
- 차집합/대칭차의 **교환·결합 성질**을 혼동하지 말 것.
- SQL/프로그래밍에서 **bag vs set** 차이를 인지.
- 증명은 원소-기반 또는 지시함수/논리 동치로 간결히.

---

## 요약

집합 연산은 논리·확률·알고리즘·데이터 처리의 **공통 언어**다.
기본 연산(합, 교, 차, 여)과 핵심 법칙(분배, 드모르간, 흡수, 멱등)을 **증명 수준**으로 이해하고, 대칭차·색인족·지시함수·비트셋 구현까지 연결하면 대부분의 응용을 안정적으로 다룰 수 있다.
