---
layout: post
title: 미적분 - 음함수의 미분법
date: 2025-08-02 15:20:23 +0900
category: 미적분
---
# 음함수의 미분법 (Implicit Differentiation)

> **TL;DR**  
> 음함수 \(F(x,y)=0\)에서의 기울기, 접선/법선, 고계 도함수는 **연쇄법칙**과 **전미분**으로 한 번에 정리된다.  
> 핵심 공식:
> $$
> y' \;=\; -\frac{F_x}{F_y},\qquad
> y'' \;=\; -\,\frac{F_{xx}+2F_{xy}\,y' + F_{yy}\,(y')^2}{F_y}\quad(F_y\neq 0).
> $$
> (수준집합 \(\nabla F\perp\) 접선, 법선벡터는 \(\nabla F=(F_x,F_y)\).)

---

## 1) 음함수란? (Implicit vs Explicit)

- **명시적(Explicit)**: \(y=f(x)\). 예) \(y=x^2+1\)  
- **음함수(Implicit)**: \(x,y\)가 한 식에 **같이** 들어가며 \(y=f(x)\)로 **곧바로 풀기 어려운** 형태.  
  예) \(x^2+y^2=1\), \(xy+\sin y=x^2\), \(x^y=y^x\) 등.

그래프 관점에서 음함수는 **수준집합(level set)** \(F(x,y)=0\) 로 해석된다.

---

## 2) 원리: 전미분과 연쇄법칙

함수 \(F(x,y(x))=0\) 를 \(x\)로 미분하면
$$
\frac{d}{dx}F(x,y(x)) \;=\; F_x + F_y\,y' \;=\; 0
\;\;\Rightarrow\;\;
\boxed{\,y'=-\dfrac{F_x}{F_y}\,}\quad(F_y\neq 0).
$$

- **수평(수평 접선)**: \(y'=0 \iff F_x=0\) 이고 \(F_y\neq 0\).  
- **수직(수직 접선)**: \(y'\) 발산 \(\iff F_y=0\) 이고 \(F_x\neq 0\).  
- **법선 벡터**: \(\nabla F=(F_x,F_y)\) (수준집합에 수직).  
- **접선 방향 벡터**: \((F_y, -F_x)\) (법선에 직교).

---

## 3) 기초 예제

### 3-1) 원: \(x^2+y^2=1\)
- \(F=x^2+y^2-1\). \(F_x=2x,\;F_y=2y\).
- 기울기:
  $$
  y'=-\frac{2x}{2y}=-\frac{x}{y}.
  $$
- 점 \((\tfrac{\sqrt2}{2},\tfrac{\sqrt2}{2})\)에서 \(y'=-1\) → 접선 \(y-y_0=-1(x-x_0)\).

### 3-2) \(xy+\sin y=x^2\)
- \(F=xy+\sin y-x^2\).  
  \(F_x=y-2x\), \(F_y=x+\cos y\).
- 기울기:
  $$
  \boxed{\,y'=-\frac{y-2x}{x+\cos y}=\frac{2x-y}{x+\cos y}\,}.
  $$

### 3-3) 타원: \(\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1\)
- \(F=\frac{x^2}{a^2}+\frac{y^2}{b^2}-1\).
- \(F_x=\tfrac{2x}{a^2},\;F_y=\tfrac{2y}{b^2}\).
- \(y'=-\dfrac{(2x/a^2)}{(2y/b^2)}=-\dfrac{b^2}{a^2}\dfrac{x}{y}\).

---

## 4) 2차 미분과 곡률

### 4-1) 일반 공식
1차에서 \(F_x+F_y y'=0\). 한 번 더 미분:
$$
\frac{d}{dx}\big(F_x+F_y y'\big)
=F_{xx}+2F_{xy}\,y'+F_{yy}(y')^2+F_y\,y''=0.
$$
따라서
$$
\boxed{\,y''= -\,\frac{F_{xx}+2F_{xy}\,y' + F_{yy}\,(y')^2}{F_y}\,}\quad(F_y\neq 0).
$$

### 4-2) 원 \(x^2+y^2=1\)의 \(y''\)
- \(F_{xx}=2,\;F_{xy}=0,\;F_{yy}=2\), \(y'=-x/y\).
- 대입:
  $$
  y'' = -\frac{2 + 0 + 2(x^2/y^2)}{2y}
      = -\frac{y^2+x^2}{y^3}
      = -\frac{1}{y^3}\quad(\text{원 위에선 }x^2+y^2=1).
  $$

### 4-3) 곡률(Explicit \(y(x)\))
$$
\kappa=\frac{|y''|}{\big(1+(y')^2\big)^{3/2}}.
$$

### 4-4) **암시적 곡률**(수준집합 \(F=0\)) — 보너스
단위 법선 \(n=\dfrac{\nabla F}{\|\nabla F\|}\). 2D에서 곡률 부호 포함 공식:
$$
\kappa = \operatorname{div}\!\left(\frac{\nabla F}{\|\nabla F\|}\right)
= \frac{F_{xx}F_y^2 - 2 F_{xy}F_xF_y + F_{yy}F_x^2}{\big(F_x^2+F_y^2\big)^{3/2}}.
$$
(부호/정규화 관례에 주의. 기하 계산/영상처리에서 자주 쓰임.)

---

## 5) 접선·법선, 수평/수직 판정

- **접선식** at \((x_0,y_0)\):  
  기울기 \(m=y'(x_0)=-F_x/F_y\).  
  $$y-y_0=m(x-x_0).$$

- **법선식**: 접선 기울기 \(m\)이면 법선 기울기 \(-1/m\) (수직). 또는 벡터 \(\nabla F\) 이용:
  $$F_x(x_0,y_0)(x-x_0)+F_y(x_0,y_0)(y-y_0)=0.$$

- **수평 접선**: \(F_x=0,\;F_y\ne 0\).  
- **수직 접선**: \(F_y=0,\;F_x\ne 0\).  
- **특이점(코너/첨점)**: \(\nabla F=(0,0)\) → 기울기 불정(접선 미정), 매개화나 고차 항 점검.

---

## 6) 대표 문제 모음 (풀이 포함)

### 6-1) \(x^y = y^x\) 에서 \(y'\)
로그 취해 \(y\ln x = x\ln y\). 미분:
$$
y'\ln x + y\frac{1}{x} = \ln y + x\frac{1}{y}y'.
$$
정리:
$$
y'(\ln x - \tfrac{x}{y}) = \ln y - \tfrac{y}{x}
\;\Rightarrow\;
\boxed{\,y'=\dfrac{\ln y - \frac{y}{x}}{\ln x - \frac{x}{y}}\,}.
$$
점 \((4,2)\) (왜? \(4^2=2^4=16\))에서:
\(\ln y=\ln 2\), \(\ln x=\ln 4=2\ln 2\), \(\frac{y}{x}=\frac12\), \(\frac{x}{y}=2\).  
$$
y'(4,2)=\frac{\ln 2 - \frac12}{2\ln 2 - 2}.
$$

### 6-2) \(x\sin y+y\cos x = 0\)
- \(F=x\sin y+y\cos x\).  
  \(F_x=\sin y - y\sin x\), \(F_y=x\cos y+\cos x\).
- 기울기:
  $$
  y'=-\frac{\sin y - y\sin x}{x\cos y+\cos x}.
  $$

### 6-3) 데카르트의 폴리움 \(x^3+y^3=3axy\)
- \(F=x^3+y^3-3axy\).  
  \(F_x=3x^2-3ay\), \(F_y=3y^2-3ax\).
- 기울기:
  $$
  y'=-\frac{3x^2-3ay}{3y^2-3ax}=-\,\frac{x^2-ay}{y^2-ax}.
  $$
- 원점은 \(\nabla F=0\) (특이점). 접선은 한 방향이 아니라 **두 갈래**(루프) 발생 — 매개화로 분석하는 편이 안전.

### 6-4) 로그/지수 혼합 \(e^{xy}=x+y\)
- \(F=e^{xy}-x-y\).  
  \(F_x=y e^{xy}-1\), \(F_y= x e^{xy}-1\).
- 기울기:
  $$
  y'=-\frac{y e^{xy}-1}{x e^{xy}-1}.
  $$

---

## 7) 2차 미분 예제 (암시적)

### 7-1) \(x^2+y^2=1\) 재검증
- \(y'=-x/y\).  
- \(y''=-\dfrac{1}{y^3}\) (위 §4-2 참조).  
- 수평/수직 판정: \(F_x=2x\), \(F_y=2y\).  
  - 수평: \(x=0\Rightarrow\) 상하 극점.  
  - 수직: \(y=0\Rightarrow\) 좌우 극점.

### 7-2) \(xy+\sin y=x^2\)의 \(y''\)
- 위에서 \(y'=\dfrac{2x-y}{x+\cos y}\).  
- 일반 공식 \(y''=-(F_{xx}+2F_{xy}y' + F_{yy}(y')^2)/F_y\):
  - \(F=xy+\sin y-x^2\)  
  - \(F_{xx}=-2\), \(F_{xy}=1\), \(F_{yy}=-\sin y\), \(F_y=x+\cos y\).
  $$
  y''=-\frac{-2+2\cdot 1\cdot y' + (-\sin y)(y')^2}{x+\cos y}
  =\frac{2-2y' + \sin y\,(y')^2}{x+\cos y}.
  $$

---

## 8) 응용 A — 접선/법선 문제 풀이 루틴

1. \(F(x,y)=0\) 에서 \(F_x,F_y\) 계산.  
2. 점이 곡선 위인지 확인 \(F(x_0,y_0)=0\).  
3. \(F_y\neq 0\) 이면 \(y'=-F_x/F_y\).  
4. 접선 \(y-y_0=y'(x_0)(x-x_0)\).  
5. 법선은 \(F_x(x_0,y_0)(x-x_0)+F_y(x_0,y_0)(y-y_0)=0\).

**예)** 타원 \(\frac{x^2}{9}+\frac{y^2}{4}=1\), 점 \((\tfrac{3}{2},\sqrt{\,1-\tfrac{(3/2)^2}{9}}\,\cdot 2)=\bigl(\tfrac{3}{2},\tfrac{\sqrt{15}}{2}\bigr)\).  
\(F_x=\frac{2x}{9},F_y=\frac{2y}{4}=\frac{y}{2}\).  
기울기 \(y'=-\dfrac{(2x/9)}{(y/2)}=-\dfrac{4x}{9y}\).  
접선식: \(y-\tfrac{\sqrt{15}}{2} = -\dfrac{4(\tfrac{3}{2})}{9(\tfrac{\sqrt{15}}{2})}\,(x-\tfrac{3}{2}).\)

---

## 9) 응용 B — Related Rates(연관변화율)

**사다리 문제**: 길이 \(L\). 바닥과 벽 사이 거리 \(x\), 높이 \(y\). \(x^2+y^2=L^2\).  
시간 \(t\) 로 미분:
$$
2x\dot x+2y\dot y=0\;\Rightarrow\;\boxed{\,\dot y=-\frac{x}{y}\dot x\,}.
$$
바닥이 멀어질수록(\(\dot x>0\)) 꼭대기는 내려간다(\(\dot y<0\)).

---

## 10) 응용 C — 정리: **음함수정리(Implicit Function Theorem, IFT)**

- \(F:\mathbb{R}^2\to\mathbb{R}\) 이 \(C^1\) 이고 \((x_0,y_0)\) 에서 \(F(x_0,y_0)=0\), \(F_y(x_0,y_0)\neq 0\) 이면,  
  **근방**에서 \(y\) 를 \(x\) 의 **함수** \(y=f(x)\) 로 풀 수 있고  
  $$
  f'(x_0)= -\frac{F_x(x_0,y_0)}{F_y(x_0,y_0)}.
  $$
- 3D 확장: \(F(x,y,z)=0\), \(F_z\neq 0\) 이면 \(z=g(x,y)\) 존재,  
  $$
  g_x=-\frac{F_x}{F_z},\qquad g_y=-\frac{F_y}{F_z}.
  $$
- **접평면(수준표면)**: \(\nabla F(x_0,y_0,z_0)\cdot (X-x_0,Y-y_0,Z-z_0)=0\).

---

## 11) 흔한 실수/주의점

- \(\boxed{\tfrac{d}{dx}(\,y\,)=y'}\) 를 빠뜨리지 않기!  
  예) \(\tfrac{d}{dx}(y^2)=2y\,y'\).
- 수직/수평 판정에서 **분자/분모** 기준 혼동 주의.
- \(\nabla F=(0,0)\) 특이점은 일반 공식으로 기울기를 못 준다 → **매개화/고차항 분석**.
- 로그를 취할 땐 **정의역**(양수 여부) 확인. 예) \(x^y>0\), \(x>0,y>0\) 등.
- 수치 계산 시 분모 \(\approx 0\) → 민감성 큼.

---

## 12) 파이썬으로 검증/시각화 (SymPy/Matplotlib)

> 실행 환경에서는 `sympy`, `numpy`, `matplotlib` 가 필요합니다. 아래 코드는 **설명용**입니다.

### 12-1) 미분 공식 검증: \(xy+\sin y=x^2\)
```python
import sympy as sp
x, y = sp.symbols('x y', real=True)
F = x*y + sp.sin(y) - x**2

Fx = sp.diff(F, x)   # F_x = y - 2x
Fy = sp.diff(F, y)   # F_y = x + cos(y)
yprime = -Fx/Fy
sp.simplify(yprime)
```

### 12-2) 2차 미분 공식 자동화
```python
Fxx = sp.diff(Fx, x)
Fxy = sp.diff(Fx, y)
Fyy = sp.diff(Fy, y)

ypp = -(Fxx + 2*Fxy*yprime + Fyy*yprime**2)/Fy
sp.simplify(ypp)
```

### 12-3) 암시적 곡선과 접선 그리기: 원 \(x^2+y^2=1\)
```python
import numpy as np
import matplotlib.pyplot as plt

theta = np.linspace(0, 2*np.pi, 600)
X = np.cos(theta); Y = np.sin(theta)

# 점과 접선
x0, y0 = np.sqrt(2)/2, np.sqrt(2)/2
m = -x0/y0
xx = np.linspace(x0-1.2, x0+1.2, 200)
yy = m*(xx - x0) + y0

plt.figure(figsize=(6,6))
plt.plot(X, Y, label='x^2 + y^2 = 1')
plt.plot(xx, yy, 'r--', label='Tangent at (√2/2, √2/2)')
plt.scatter([x0],[y0], color='k')
plt.axis('equal'); plt.grid(True); plt.legend(); plt.show()
```

### 12-4) \(x^y=y^x\)의 접선 수치 평가 (예: \((4,2)\))
```python
import math
x0, y0 = 4.0, 2.0
num = math.log(y0) - y0/x0
den = math.log(x0) - x0/y0
m = num/den  # slope
print("slope at (4,2) =", m)
```

---

## 13) 추가 예제 세트 (연습/풀이 스케치)

1. **코싸인-로그 혼합**: \(x\cos y = \ln(x+y)\).  
   - \(F=x\cos y - \ln(x+y)\).  
   - \(F_x=\cos y - \frac{1}{x+y}\), \(F_y=-x\sin y - \frac{1}{x+y}\).  
   - \(y'=-F_x/F_y\).

2. **지수-다항식**: \(e^{x+y}=x^2-3y\).  
   - \(F=e^{x+y}-x^2+3y\).  
   - \(F_x=e^{x+y}-2x,\;F_y=e^{x+y}+3\).  
   - \(y'=\dfrac{2x-e^{x+y}}{e^{x+y}+3}\).

3. **정확 접선식**: \(\frac{x^2}{9}+\frac{y^2}{4}=1\), 점 \((3/2,\sqrt{15}/2)\) 에서의 접선/법선.  
   - 위 §8 루틴으로 완성.

4. **Related rates**: \(x^2+y^2=25\), \(\dot x=2\) at \((3,4)\) → \(\dot y=-\frac{x}{y}\dot x=-\frac{3}{4}\cdot 2=-\tfrac{3}{2}\).

---

## 14) 체크리스트 & 요약

- **기울기**: \(y'=-F_x/F_y\) (단 \(F_y\neq 0\)).  
- **2차**: \(y''=-(F_{xx}+2F_{xy}y' + F_{yy}(y')^2)/F_y\).  
- **수평/수직 접선**: 분자/분모 0 여부로 판정.  
- **법선**: \(\nabla F\) 가 바로 법선.  
- **특이점**: \(\nabla F=(0,0)\) 이면 일반 공식 X → 매개화/고차항.  
- **IFT**: \(F_y\neq 0\) 이면 지역적으로 \(y=f(x)\) 존재, \(f'=-F_x/F_y\).  
- **코드**로 검증(심벌/수치/시각화)하면 실수 줄어든다.

---

## 15) 미니 실전 시나리오 두 개

### (A) 광선-거울 스냅(스니펫)  
반사면 곡선 \(F(x,y)=0\) 에 부딪힌 광선의 반사각 계산 시, 법선 \(\nabla F\)가 필요 → **음함수 미분**으로 법선을 구해 스넬 법칙/반사 법칙 구현.

### (B) 컨투어 후처리(컴퓨터비전)  
이미지의 등강도선 \(F(x,y)=I(x,y)-\tau=0\) 에서 각 픽셀의 접선/곡률 계산 → **곡률 기반 필터링/스켈레톤 추출**에 사용.  
실무에선 §4-4의 **암시적 곡률** 공식을 바로 쓴다.