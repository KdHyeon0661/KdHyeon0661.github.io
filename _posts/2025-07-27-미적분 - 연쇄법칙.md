---
layout: post
title: 미적분 - 연쇄법칙
date: 2025-07-27 23:20:23 +0900
category: 미적분
---
# 연쇄법칙(Chain Rule) — 정리 및 예제

연쇄법칙은 **합성함수의 미분**을 구하는 핵심 공식입니다.  
아래는 일변수 → 다변수 → 야코비안(행렬) 형태까지 정리한 내용과 예제입니다.

---

## 1. 일변수(단일 합성) 연쇄법칙

함수 \(y=f(u)\) 와 \(u=g(x)\) 가 주어져 있을 때 합성함수 \(y=f(g(x))\)의 도함수는

\[
\frac{dy}{dx} = \frac{df}{du}\cdot\frac{du}{dx}.
\]

직관적으로는 **바깥 함수의 도함수(안쪽은 그대로)** × **안쪽 함수의 도함수**입니다.

**예제**
\[
y=\sin(x^2)\quad\Rightarrow\quad \frac{dy}{dx}=\cos(x^2)\cdot 2x.
\]

---

## 2. 다변수(단계적 의존) 연쇄법칙

### (A) \(z=f(x,y)\)이고 \(x=x(t),\ y=y(t)\) 일 때

합성함수 \(z(t)=f(x(t),y(t))\)의 도함수는

\[
\frac{dz}{dt}
= \frac{\partial f}{\partial x}\frac{dx}{dt}
+ \frac{\partial f}{\partial y}\frac{dy}{dt}.
\]

즉, \(x\)와 \(y\)를 통해 \(z\)에 들어오는 **모든 경로**의 기여를 더합니다.

**예제**  
\(z=x^2+y^2,\ x=t^2,\ y=\sin t\)이면
\[
\frac{dz}{dt}=2x\cdot 2t + 2y\cdot\cos t = 4t^3 + 2\sin t\cos t.
\]

---

### (B) 일반형: 여러 입력과 여러 매개변수

함수 \(z=f(x_1,\dots,x_n)\)이고 각 \(x_i=x_i(t_1,\dots,t_m)\) 로 주어지면, 임의의 매개변수 \(t_j\)에 대한 편도는

\[
\frac{\partial z}{\partial t_j}
= \sum_{i=1}^{n} \frac{\partial f}{\partial x_i}\cdot \frac{\partial x_i}{\partial t_j}.
\]

---

## 3. 행렬(야코비안) 형태 — 벡터값 함수의 연쇄법칙

벡터함수 \(\mathbf{y}=\mathbf{f}(\mathbf{u})\) 와 \(\mathbf{u}=\mathbf{g}(\mathbf{x})\)일 때 합성 \(\mathbf{y}(\mathbf{x})=\mathbf{f}(\mathbf{g}(\mathbf{x}))\) 의 미분(야코비안)은 행렬 곱으로 표현됩니다:

\[
D\mathbf{y}(\mathbf{x}) = D\mathbf{f}(\mathbf{u})\big|_{\mathbf{u}=\mathbf{g}(\mathbf{x})}\; \cdot\; D\mathbf{g}(\mathbf{x}).
\]

여기서 각 \(D\)는 야코비안 행렬(편미분들로 이루어진 행렬)입니다.

---

## 4. 연쇄법칙의 직관적 이해

입력 → 중간변수 → 출력으로 정보가 흐를 때, 출력의 작은 변화는 **각 경로에서의 변화율들이 곱해져서** 합해진 결과입니다.  
그래디언트·야코비안 관점에서는 **선형 근사(미분의 선형성)**를 연쇄적으로 적용하는 것입니다.

---

## 5. 주의사항 & 성질

- 합성의 순서가 중요하므로, 야코비안 곱의 순서도 반드시 지켜야 합니다: \(D f \cdot D g\) (먼저 \(g\), 그 다음 \(f\)).
- 스칼라-스칼라, 스칼라-벡터, 벡터-스칼라 등 다양한 경우에 동일한 원칙 적용.
- 역전파(backpropagation)는 연쇄법칙을 반복 적용하는 알고리즘적 구현입니다.

---

## 6. 간단한 코드 예제 (참고)

```python
# sympy를 쓰면 합성함수의 미분을 쉽게 계산할 수 있습니다 (예시 코드)
import sympy as sp

x = sp.symbols('x')
f = sp.sin(x**2)   # f(x) = sin(x^2)
sp.diff(f, x)      # 출력: 2*x*cos(x**2)
```

(위 코드는 설명용 예시로, 실제 실행환경에서 sympy가 설치되어 있어야 동작합니다.)

---

## 7. 요약 표

| 상황 | 연쇄법칙 형태 |
|------|---------------|
| 일변수 합성 | \( \frac{d}{dx} f(g(x)) = f'(g(x))\cdot g'(x) \) |
| 다변수(2개) | \( \dfrac{d}{dt}f(x(t),y(t)) = f_x x'(t)+ f_y y'(t) \) |
| 벡터-야코비안 | \( D(\,f\circ g\,) = Df|_{g(x)} \cdot Dg \) |
