---
layout: post
title: 미적분 - 교대급수와 절대수렴
date: 2025-07-22 17:20:23 +0900
category: 미적분
---
# 교대급수와 절대수렴

> **핵 요약**
> - **교대급수(Alternating series)**: 부호가 번갈아 바뀌는 급수.
> - **라이프니츠(Leibniz) 판정법**: \(a_n>0\), 단조감소, \(a_n\to 0\) ⇒ **수렴**.
> - **오차 평가**: 부분합 \(S_n\)의 오차 \(|S-S_n|\le a_{n+1}\).
> - **절대수렴**: \(\sum|a_n|\)이 수렴 ⇒ \(\sum a_n\)도 **항상 수렴**(재배열 불변).
> - **조건수렴**: \(\sum a_n\)은 수렴, \(\sum|a_n|\)은 발산 ⇒ **재배열에 따라 합이 바뀜**(리만 재배열 정리).

---

## 1. 용어 정리

- **교대급수**: \(\displaystyle \sum_{n=1}^{\infty}(-1)^{n+1}a_n\) 또는 \(\sum(-1)^n a_n\), 여기서 \(a_n>0\).
- **절대수렴**: \(\displaystyle \sum|a_n|\)이 수렴.
- **조건수렴**: \(\displaystyle \sum a_n\)은 수렴하지만, \(\sum|a_n|\)은 발산.
- **무조건수렴(절대수렴과 동의어로 쓰이기도 함)**: 재배열해도 합이 변하지 않음(절대수렴의 결과).

---

## 2. 라이프니츠(Leibniz) 교대급수 판정법

### 정리 (수렴 조건)
다음이 성립하면 \(\sum(-1)^{n+1}a_n\)은 수렴한다.
1. \(a_n>0\)
2. \(a_{n+1}\le a_n\) (어느 \(N\) 이후 **단조감소**면 충분)
3. \(\lim_{n\to\infty}a_n=0\)

> **증명 스케치**
> 부분합 \(S_{2k}\)는 증가, \(S_{2k+1}\)은 감소하며, \(S_{2k}\le S_{2k+1}\).
> 두 수열이 서로 끼어들며(\(S_{2k}\le S\le S_{2k+1}\)) 경계가 좁혀져 수렴.
> 더불어 \(|S-S_n|\le a_{n+1}\)가 따라온다(오차 평가).

### 예시
\[
\sum_{n=1}^{\infty}\frac{(-1)^{n+1}}{n}
=1-\frac12+\frac13-\frac14+\cdots
\]
- \(a_n=\frac1n>0\), 단조감소, \(a_n\to0\) ⇒ **수렴**(교대 조화급수).

---

## 3. 오차 평가 & 멈춤 기준

**교대급수 오차 경계(Alternating Series Estimation Theorem)**
부분합 \(S_n\)과 합 \(S\)에 대해
\[
|S-S_n|\le a_{n+1}.
\]
또한 \(S\)는 **두 연속 부분합 사이에 존재**:
\[
\min(S_n,S_{n+1})\le S\le \max(S_n,S_{n+1}).
\]

### 실전 멈춤 규칙
목표 오차 \(\varepsilon>0\)를 원하면, **첫 \(a_{n+1}<\varepsilon\)** 인 \(n\)까지만 더하면 된다.

**예: \(\ln 2=\displaystyle\sum_{n=1}^{\infty}\frac{(-1)^{n+1}}{n}\) 을 소수 셋째 자리 정확도로**
오차 \(\le 5\times10^{-4}\)면 충분(일반적으로 표시 자릿수의 절반 수준).
여기서 \(a_{n+1}=1/(n+1)<5\cdot10^{-4}\Rightarrow n+1>2000\Rightarrow n\ge 2000\).
⇒ 약 2000항이면 \(\pm0.0005\) 이내.

---

## 4. 절대수렴 vs 조건수렴

- **절대수렴**: \(\sum|a_n|\) 수렴 ⇒ **무조건 수렴**(재배열해도 합 불변), 비교/비율/근판정법으로 판정.
- **조건수렴**: \(\sum a_n\) 수렴 & \(\sum|a_n|\) 발산.
  예) 교대 조화급수 \(\sum (-1)^{n+1}\frac{1}{n}\): 원래 급수는 수렴, \(\sum\frac1n\)은 발산 ⇒ **조건수렴**.

> **리만 재배열 정리**: 조건수렴 급수는 **항 순서를 재배열하면 임의의 실수**로 합을 만들 수 있고, \(\pm\infty\)로도 보낼 수 있다.
> ⇒ 수치 계산·알고리즘 구현에서 **항 순서**에 민감.

---

## 5. 절대수렴 판정 예시

### (1) 비율판정법
\[
\lim_{n\to\infty}\left|\frac{a_{n+1}}{a_n}\right|=L
\quad\Rightarrow\quad
\begin{cases}
L<1 & \text{절대수렴}\\
L>1 & \text{발산}\\
L=1 & \text{판정 불가}
\end{cases}
\]

- \(\displaystyle \sum (-1)^n\frac{n}{2^n}\): \(|a_n|=\frac{n}{2^n}\),
  \(\frac{|a_{n+1}|}{|a_n|}=\frac{n+1}{2n}\to\frac12<1\) ⇒ **절대수렴**.

- \(\displaystyle \sum (-1)^n\frac{1}{n}\): \(|a_n|=1/n\Rightarrow L=1\) ⇒ 판정 불가. (실제는 절대수렴 **아님**, 조건수렴)

### (2) 근판정법
\[
\lim_{n\to\infty}\sqrt[n]{|a_n|}=L
\quad\Rightarrow\quad
L<1\Rightarrow \text{절대수렴}.
\]
- \(|a_n|=1/n!\Rightarrow \sqrt[n]{|a_n|}\sim \frac{1}{n/e}\to0\) ⇒ **절대수렴**.

### (3) 비교판정법
- \(|a_n|\le c\cdot b_n,\ \sum b_n\) 수렴 ⇒ \(\sum |a_n|\) 수렴(⇒ 절대수렴).

---

## 6. 대표 패밀리: \(\sum (-1)^{n+1} n^{-p}\)

- \(p>1\): \(\sum \frac{1}{n^p}\) 절대수렴 ⇒ **절대수렴**.
- \(0<p\le 1\): \(\sum \frac{1}{n^p}\) 발산, 교대는 수렴 ⇒ **조건수렴**.
- \(p=0\): 항이 1이어서 \(a_n\not\to0\) ⇒ **발산**.

---

## 7. “단조감소가 아니면?” — 결국 중요: **어느 시점 이후** 단조감소

라이프니츠 판정은 \(n\ge N\)에 대해 \(a_{n+1}\le a_n\)이면 충분.
초기 몇 항의 비단조는 합의 **유한한 보정**일 뿐, 수렴성/오차 경계엔 영향이 미미.

**예**: \(a_n=\frac{1+\mathbf{1}_{\{n\text{이 10의 배수}\}}}{n}\).
10의 배수에서만 살짝 커지지만, 결국 \(a_n\searrow0\) 이고 단조감소는 \(n\)이 충분히 클 때 성립 ⇒ 교대급수 **수렴**.

---

## 8. 실전 예제 모음

### A. \(\ln(1+x)\) (교대 테일러 급수, \(|x|\le1, x\ne -1\))
\[
\ln(1+x)=\sum_{n=1}^{\infty}(-1)^{n+1}\frac{x^n}{n},\quad |x|\le1,\ x\ne -1.
\]
- \(x=1\Rightarrow \ln 2=\sum (-1)^{n+1}\frac{1}{n}\) (조건수렴).
- 오차 \(\le \frac{|x|^{n+1}}{n+1}\).
  \(|x|<1\)이면 절대수렴, \(x=1\)이면 조건수렴.

### B. \(\arctan x\) (교대 테일러 급수, \(|x|\le1\))
\[
\arctan x=\sum_{n=0}^{\infty}(-1)^n\frac{x^{2n+1}}{2n+1}.
\]
- \(x=1\Rightarrow \frac{\pi}{4}=1-\frac13+\frac15-\frac17+\cdots\) (매우 **느리게** 수렴, 조건수렴).
- 오차 \(\le \frac{|x|^{2n+3}}{2n+3}\).

### C. \(\displaystyle \sum_{n=1}^{\infty}(-1)^{n+1}\frac{\ln n}{n}\)
- \(a_n=\frac{\ln n}{n}\searrow 0\) (충분히 큰 \(n\)에서 감소) ⇒ **교대는 수렴**.
- \(\sum\frac{\ln n}{n}\)은 **발산**(적분판정 \(\int \frac{\ln x}{x}dx\sim \tfrac12(\ln x)^2\)) ⇒ **조건수렴**.

### D. 절대수렴 예
\[
\sum_{n=1}^{\infty}(-1)^n\frac{n}{2^n}
\]
비율판정 \(<1\) ⇒ **절대수렴**.

---

## 9. 수치 실습 코드 (Python)

> 아래 코드는 부분합, 오차 경계 확인, 재배열 효과(조건수렴) 등을 체험하기 위한 예제다.

### 9.1 교대 조화급수로 \(\ln 2\) 근사 & 오차 경계 확인
```python
import math

def alternating_harmonic(N):
    s = 0.0
    for n in range(1, N+1):
        term = ((-1.0)**(n+1)) / n
        s += term
    return s

target = math.log(2.0)
for N in [10, 50, 100, 500, 2000, 10000]:
    approx = alternating_harmonic(N)
    next_term = 1.0/(N+1)  # a_{N+1}
    err_bound = next_term
    real_err = abs(target - approx)
    print(f"N={N:6d}  S_N≈{approx:.10f}  |err|≤{err_bound:.6f}  actual|err|={real_err:.6f}")
```

**해석 포인트**
- 실제 오차가 항상 **다음 항의 크기**보다 작음을 확인.
- 원하는 오차 \(\varepsilon\)에 대해 \(1/(N+1)<\varepsilon\)를 만족하는 \(N\)까지 합하면 됨.

---

### 9.2 재배열 효과(조건수렴)의 위험성 시연
교대 조화급수(조건수렴)를 **긍정항 여러 개 + 부정항 하나** 식으로 재배열해 목표값 근처로 **의도적** 이동 가능.

```python
# 경고: 데모 목적. 재배열은 수렴을 매우 느리게 하거나 임의의 값에 가깝게 보이게 할 수 있다.
def rearranged_conditional(limit_pos=0.8, take_pos=3):
    # 목표 비율(limit_pos)만큼 양의 부분합이 커지도록 양의 항을 take_pos개씩 더한 뒤 음의 항 1개 삽입
    s = 0.0
    n_pos, n_neg = 1, 1
    steps = 0
    while steps < 20000:
        for _ in range(take_pos):
            s += 1.0/n_pos  # positive term (+1/n)
            n_pos += 2
        s -= 1.0/n_neg     # negative term (-1/n)
        n_neg += 2
        steps += 1
        if s > limit_pos:
            break
    return s

print("Rearranged partial sum near 0.8? ->", rearranged_conditional(0.8, 5))
```

**해석 포인트**
- 조건수렴 급수는 **재배열에 따라 합이 변할 수 있음**(리만 재배열 정리).
- 수치 계산에서는 **항의 순서/그룹화 정책**(예: 절대값 큰 항부터 더하기, Kahan 보정)이 중요.

---

### 9.3 교대급수 가속 (Euler 변환 간단 버전)
교대급수 \(\sum (-1)^n a_n\)의 수렴을 **가속**하는 아이디어(간이형).

```python
def euler_acceleration(a, k=1):
    """
    a: 원래 급수의 양의 항 리스트 a_n (n=0부터)
    반환: Euler 변환을 k번 적용한 새 부분합 추정치
    """
    from math import comb
    a_curr = a[:]
    for _ in range(k):
        # a^{(1)}_n = a_n - a_{n+1}
        a_curr = [a_curr[i] - a_curr[i+1] for i in range(len(a_curr)-1)]
    # S ≈ sum_{n=0}^\infty (-1)^n C(n+k-1, n) a^{(k)}_n
    # 실제 구현에서는 유한 항만 사용
    s = 0.0
    for n, an in enumerate(a_curr):
        s += ((-1)**n) * comb(n+k-1, n) * an
    return s

# 예: ln(2)=sum_{n>=1}(-1)^{n+1}/n  => a_n=1/(n+1) (n=0부터)
import math
a = [1.0/(n+1) for n in range(5000)]
approx_plain = sum(((-1)**n)*a[n] for n in range(len(a)))
approx_euler1 = euler_acceleration(a, k=1)
print("Plain partial ~", approx_plain, "   error:", abs(approx_plain - math.log(2)))
print("Euler-1 accel ~", approx_euler1,  "   error:", abs(approx_euler1  - math.log(2)))
```

> **참고**: 실무에서는 Shanks 변환, Aitken Δ², Levin 변환 등 다양한 가속 기법을 사용.
> 특히 교대 테일러 급수(예: \(\arctan\), \(\ln(1+x)\))에서 효과적일 수 있음.

---

## 10. 실전 시나리오

### 시나리오 1 — \(\ln 2\)를 소수 4자리 정확도로
- 목표 오차 \(\varepsilon=5\times10^{-5}\).
- 교대 조화급수 오차 \(\le 1/(N+1)\).
- \(1/(N+1)<5\cdot10^{-5}\Rightarrow N\ge 19999\).
  ⇒ **약 2만 항** 필요(수렴이 매우 느림).
  → **가속 기법**(Euler/Levin) 또는 **다른 표현식** 사용 권장.

### 시나리오 2 — \(\arctan(1)=\pi/4\) 계산
- 급수: \(1-\frac{1}{3}+\frac{1}{5}-\cdots\) (조건수렴, 초느림).
- 실무: **Machin형 공식** \(\displaystyle \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}\) 등을 사용해 절대수렴에 가까운 빠른 수렴 유도.

### 시나리오 3 — 수렴성 빠른 판정
- \(\sum (-1)^n \frac{n!}{3^n}\): \(|a_n|=\frac{n!}{3^n}\), 비율 \(\to\infty\) → **발산**(절대값부터 발산).
- \(\sum (-1)^n \frac{n}{2^n}\): 비율 \(\to\frac12<1\) → **절대수렴**.

---

## 11. 자주 하는 실수 & 팁

- \(a_n\to0\)은 **필요조건**이지 **충분조건**이 아니다. (예: \(\sum \frac{(-1)^n}{\sqrt{n}}\)은 수렴하지만, \(\sum \frac{1}{\sqrt{n}}\)은 발산)
- 단조감소가 **처음부터**가 아니라 **결국(eventually)**이면 충분.
- 조건수렴 급수는 **재배열**에 민감 ⇒ 수치 합산 시 **큰 항부터**, **Kahan 보정** 등 사용.
- **절대수렴**이면 재배열 안전, 병렬 합산/청크 합산도 안정적.

---

## 12. 연습문제 (풀이 아이디어)

1. \(\displaystyle \sum_{n=2}^{\infty}\frac{(-1)^n}{\ln n}\) 의 수렴성
   - \(a_n=\frac{1}{\ln n}\searrow0\) (충분히 큰 \(n\)에서) ⇒ 교대는 **수렴**.
   - \(\sum\frac{1}{\ln n}\)은 발산(정교한 비교 필요) ⇒ **조건수렴**.

2. \(\displaystyle \sum_{n=1}^{\infty}(-1)^{n+1}\frac{n}{n+1}\)
   - \(a_n=\frac{n}{n+1}\to1\ne0\) ⇒ **발산**(필요조건 불충족).

3. \(\displaystyle \sum_{n=1}^{\infty}(-1)^{n}\frac{1}{n^p}\) 의 수렴성
   - \(p>0\): 교대는 수렴(Leibniz).
   - 절대수렴은 \(p>1\), 조건수렴은 \(0<p\le1\).

4. \(\displaystyle \sum_{n=1}^{\infty}(-1)^n\frac{\ln n}{n}\)
   - \(a_n=\frac{\ln n}{n}\)는 \(n>e\)에서 감소, \(a_n\to0\) ⇒ 교대는 수렴.
   - \(\sum\frac{\ln n}{n}\)은 발산 ⇒ 조건수렴.

---

## 13. 마무리 요약표

| 구분 | 핵심 내용 | 실전 포인트 |
|---|---|---|
| 교대급수 수렴(Leibniz) | \(a_n>0\), 단조감소, \(a_n\to0\) ⇒ 수렴 | “결국 단조감소”면 충분 |
| 오차 경계 | \(|S-S_n|\le a_{n+1}\) | 멈춤 기준: \(a_{n+1}<\varepsilon\) |
| 절대수렴 | \(\sum|a_n|\) 수렴 ⇒ \(\sum a_n\) 수렴 | 재배열해도 합 불변 |
| 조건수렴 | \(\sum a_n\) 수렴 & \(\sum|a_n|\) 발산 | 재배열에 민감(리만 정리) |
| 빠른 판정 | 비율/근/비교 | \(|a_n|\) 기준으로 먼저 본다 |
| 가속 | Euler/Levin/Aitken | 교대 테일러 급수에 효과적 |

---

## 14. 보너스: 코드 스니펫 — 안전한 합산(카한 보정)

큰 \(N\)까지 더할 때 부동소수점 오차를 줄이는 **Kahan Summation**:

```python
def kahan_sum(seq):
    s = 0.0
    c = 0.0
    for x in seq:
        y = x - c
        t = s + y
        c = (t - s) - y
        s = t
    return s

# 예: ln(2) 교대 조화급수 1..N
def ln2_kahan(N):
    terms = [(((-1.0)**(n+1))/n) for n in range(1, N+1)]
    return kahan_sum(terms)

import math
for N in [1000, 10000, 100000]:
    approx = ln2_kahan(N)
    print(N, approx, "err=", abs(approx - math.log(2)))
```

---

### 마치며
교대급수는 **수렴 판정이 간단**하고 **오차 통제가 쉬운** 반면, **수렴 속도는 느린** 경우가 많습니다.
정확도 요구가 높다면 **절대수렴 형태로의 변형**, **수렴 가속**, **다른 등가 공식**을 찾는 습관이 큰 시간을 절약해 줍니다.
