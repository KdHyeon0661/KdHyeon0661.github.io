---
layout: post
title: 미적분 - 그린의 정리
date: 2025-08-25 21:20:23 +0900
category: 미적분
---
# 그린의 정리 (Green’s Theorem)

핵심 메시지는 다음과 같다.

- **순환형(curl form)**: 경계 곡선을 따라 \(\int_C P\,dx+Q\,dy\) 는 내부에서 \(\iint_R (\partial Q/\partial x - \partial P/\partial y)\,dA\) 로 계산된다.
- **플럭스형(divergence form)**: \(\int_C \mathbf F\cdot \mathbf n\,ds\) 는 내부에서 \(\iint_R \operatorname{div}\mathbf F\,dA\) 로 계산된다.
- **응용**: **면적**, **무게중심/모멘트**, **유체 순환/플럭스**, **경로적분 간소화** 등.

---

## 정리의 정확한 서술

\(\mathbf F=\langle P(x,y), Q(x,y)\rangle\) 가 \(R\subset\mathbb R^2\) 에서 \(C^1\),
\(R\) 은 경계가 조각-매끄럽고 단순닫힌곡선 \(C=\partial R\) 로 둘러싸이며 **반시계 방향(양의 방향)** 으로 취향한다고 하자.

### 순환형(“curl form”)

\[
\boxed{
\oint_{C} P\,dx + Q\,dy
=
\iint_{R}\left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA.
}
\]
우변 integrand \(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\) 는 2D에서의 **스칼라 회전(curl\(_z\))** 이다.

### 플럭스형(“divergence form”)

\[
\boxed{
\oint_{C} \mathbf F\cdot \mathbf n\,ds
=
\iint_{R} \operatorname{div}\mathbf F\,dA
=
\iint_{R}\left(\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}\right)\,dA,
}
\]
여기서 \(\mathbf n\) 은 \(C\) 의 **바깥쪽 단위 법선**.
(증명은 순환형을 특정 \(P,Q\) 선택으로 변형하여 얻거나, 2D 가우스 발산정리로 이해할 수 있다.)

> 방향성 주의: \(C\) 를 **반시계**로 취하면, \(\mathbf n\) 은 외향(normal outward)이며 위 등식이 성립한다.

---

## 직관과 미시적 해석

- 선적분 \(\oint_C P\,dx+Q\,dy\) 는 “경계”를 따라 **순환(circulation)** 하는 양.
- 우변 \(\iint_R (\partial Q/\partial x-\partial P/\partial y)\,dA\) 는 “내부”의 **회전의 총합**.
- 즉, **경계에서의 순환 = 내부 회전의 누적**.

플럭스형도 동일한 직관:
- 좌변 \(\oint_C \mathbf F\cdot \mathbf n\,ds\) 는 경계를 가로지르는 **순외향 유량(플럭스)**.
- 우변 \(\iint_R \operatorname{div}\mathbf F\,dA\) 는 내부에서의 **발산(생성−소멸)의 총합**.

---

## 증명 스케치(직사각형 → 조각 붙이기 → 일반 영역)

- 직사각형 \(R=[a,b]\times[c,d]\) 에서
  \[
  \int_{\partial R} P\,dx+Q\,dy
  =
  \int_{a}^{b}\big(Q(x,d)-Q(x,c)\big)\,dx
  + \int_{c}^{d}\big(-P(b,y)+P(a,y)\big)\,dy.
  \]
  이는 직접 매개화해서 사변의 선적분을 더한 것이다. 한편
  \[
  \iint_{R}\left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA
  = \int_{a}^{b}\int_{c}^{d}\frac{\partial Q}{\partial x}\,dy\,dx
    - \int_{c}^{d}\int_{a}^{b}\frac{\partial P}{\partial y}\,dx\,dy,
  \]
  Fubini와 적분의 기본정리로 위의 경계항과 일치한다.
- 일반 영역은 직사각형들의 유한 합/차로 분해(또는 “일반 영역” → 곡선 변형).
  내부 경계들이 상쇄됨을 관찰하면 전체 정리가 성립.

---

## 전형적 가정과 주의사항

- \(P,Q\) 는 \(R\) 에서 \(C^1\), \(R\) 은 단순닫힌곡선으로 둘러싸인 **양의 방향**의 영역.
- 조각-매끄러운 경계(유한 개의 매끄러운 조각으로 구성).
- **구멍 난 영역(다중연결)** 의 경우에도 버전이 존재: 내부 홀 경계는 **시계방향(음의 방향)** 으로 취향하면 동일 식 성립(외곽 반시계, 홀 시계).

---

## 즉시 나오는 유용한 corollaries

### 면적 공식(신속한 면적 구하기)

\[
\text{Area}(R)
= \iint_{R} 1\,dA
= \oint_C x\,dy
= -\oint_C y\,dx
= \frac12\oint_C (x\,dy - y\,dx).
\]
예: \(P=0,Q=x\) 를 택하면 \(\partial Q/\partial x - \partial P/\partial y = 1\).

### 보존장 판정과 선적분

\( \mathbf F=\langle P,Q\rangle \) 에서 \(R\) 이 단일연결, \(P,Q\in C^1\) 이면
\[
\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \equiv 0
\quad\Longleftrightarrow\quad
\mathbf F \text{ 는 보존장(=경로독립)}.
\]
이는 FTLI와 호응한다: \(\oint_{C}\mathbf F\cdot d\mathbf r=0\) for all closed \(C\).

### 평면 가우스 정리(플럭스형)

플럭스형에서 \(\operatorname{div}\mathbf F=0\Rightarrow \oint_C \mathbf F\cdot \mathbf n\,ds=0\).

---

## 예제

### 예제 1 — 순환형으로 직접 계산 가속

\[
\mathbf F(x,y)=\langle -y^3,\; x^3\rangle,\quad C:\; x^2+y^2=R^2\ \text{(반시계)}.
\]
그린 정리:
\[
\oint_C -y^3\,dx + x^3\,dy
=
\iint_{x^2+y^2\le R^2}\left(\frac{\partial}{\partial x}x^3 - \frac{\partial}{\partial y}(-y^3)\right)\,dA
=
\iint_{D}\big(3x^2 + 3y^2\big)\,dA.
\]
극좌표 \(x=r\cos\theta,y=r\sin\theta\) 로
\[
\iint_{D} 3(x^2+y^2)\,dA
= 3\int_{0}^{2\pi}\int_{0}^{R} r^2\cdot r\,dr\,d\theta
= 3\cdot 2\pi\cdot \frac{R^4}{4}
= \frac{3\pi R^4}{2}.
\]
즉,
\[
\boxed{
\oint_C -y^3\,dx + x^3\,dy
= \frac{3\pi R^4}{2}.
}
\]

#### 심볼릭 코드(검증)

```python
import sympy as sp
r, th, R = sp.symbols('r th R', positive=True)
expr = 3*(r**2) # 3x^2+3y^2 = 3 r^2
res = sp.integrate(sp.integrate(expr * r, (r, 0, R)), (th, 0, 2*sp.pi))
sp.simplify(res)  # 3*pi*R**4/2
```

---

### 예제 2 — 면적 공식으로 도형 면적

타원 \( \frac{x^2}{a^2}+\frac{y^2}{b^2}=1 \) 의 면적을 \(\oint x\,dy\) 로 구한다.
매개화 \(x=a\cos t, y=b\sin t\;(0\le t\le 2\pi)\), \(dy=b\cos t\,dt\).
\[
\text{Area}
= \oint_C x\,dy
= \int_{0}^{2\pi} (a\cos t)\cdot(b\cos t)\,dt
= ab\int_{0}^{2\pi}\cos^2 t\,dt
= ab\cdot \pi.
\]
즉,
\[
\boxed{\text{Area}=\pi ab}.
\]

#### 수치 코드(매개화 적분)

```python
import numpy as np
def area_ellipse(a, b, n=100000):
    ts = np.linspace(0, 2*np.pi, n+1)
    x  = a*np.cos(ts)
    dy = b*(-np.sin(ts))*(ts[1]-ts[0])  # dy ≈ y'(t) dt = b*cos t dt, (여기선 오타 방지: 아래로 교정)
    # 교정: y=b sin t => dy = b cos t dt
    dy = b*np.cos(ts)*(ts[1]-ts[0])
    return np.sum(x * dy)  # ∮ x dy
print(area_ellipse(2.0, 3.0))
# 기대값 = π a b = 6π

```

---

### 예제 3 — 플럭스형(발산)으로 외향 유량

\[
\mathbf F(x,y)=\langle x^2,\; xy\rangle,\quad
R:\ x^2+y^2\le 1.
\]
발산:
\[
\operatorname{div}\mathbf F
= \frac{\partial}{\partial x}(x^2) + \frac{\partial}{\partial y}(xy)
= 2x + x = 3x.
\]
그린 정리(플럭스형):
\[
\oint_C \mathbf F\cdot \mathbf n\,ds
= \iint_{R} 3x\,dA.
\]
원판은 \(x\mapsto -x\) 대칭(홀수 integrand) → 값은 0.
즉,
\[
\boxed{
\oint_C \mathbf F\cdot \mathbf n\,ds=0.
}
\]

---

### 예제 4 — 구멍 난 영역(다중연결) 버전

영역 \(R\) 가 외곽 경계 \(C_0\) (반시계)와 내부 홀 \(C_1,\dots,C_k\) (시계) 로 둘러싸이면
\[
\oint_{C_0} P\,dx+Q\,dy - \sum_{j=1}^{k}\oint_{C_j} P\,dx+Q\,dy
=
\iint_{R}\left(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}\right)\,dA.
\]
즉, **외곽은 반시계(+), 내부 홀은 시계(−)** 로 놓으면 총합이 내부 회전 적분과 일치한다.

---

### 예제 5 — 보존장 확인용: 폐곡선 적분 0

\[
\mathbf F=\langle y\cos x,\; \sin x\rangle,\quad
R:\ \text{단일연결}.
\]
\(\partial Q/\partial x - \partial P/\partial y = \cos x - \cos x = 0\).
따라서 임의 폐곡선 \(C\) 에 대해
\[
\oint_C \mathbf F\cdot d\mathbf r=0.
\]
경로독립 ⇒ 퍼텐셜 \(\phi\) 존재.

퍼텐셜:
\[
\phi_x=y\cos x \Rightarrow \phi=y\sin x + g(y).
\quad
\phi_y = \sin x + g'(y) \stackrel{!}{=} Q=\sin x
\Rightarrow g'(y)=0.
\Rightarrow \phi=y\sin x.
\]
임의 경로 \(A\to B\) :
\(\displaystyle \int_C \mathbf F\cdot d\mathbf r = \phi(B)-\phi(A) = y_B\sin x_B - y_A\sin x_A\).

---

## 계산 전략(체크리스트)

1) **형태 선택**:
   - \(\oint_C P\,dx+Q\,dy\) 를 **영역 적분**으로 바꾸고 싶으면 **순환형**.
   - \(\oint_C \mathbf F\cdot \mathbf n\,ds\) 는 **플럭스형**.
2) **영역 특성**: 단일연결? 구멍? 경계 방향(외곽 반시계, 홀 시계)?
3) **대칭/제곱/홀수성**: integrand 가 대칭이면 값 빠르게 결정 가능(0 판단 등).
4) **좌표계 선택**: 원판/환형은 **극좌표**로 내부적분이 유리.
5) **인계 조건**: 조각-매끄러움, \(C^1\) 정칙성(미분 가능) 확인.
6) **보존장 테스트**: \(\partial Q/\partial x=\partial P/\partial y\) 인지, 도메인 위상(단일연결) 확인.

---

## 실전 응용

### 면적·무게중심·관성모멘트

밀도 \(\rho(x,y)\) 가 주어지면 총질량 \(M=\iint_R \rho\,dA\).
**면적**은 \(\rho\equiv 1\) 일 때 \(M=\text{Area}(R)\).
무게중심 \((\bar x,\bar y)\):
\[
\bar x = \frac{1}{M}\iint_R x\rho\,dA,\qquad
\bar y = \frac{1}{M}\iint_R y\rho\,dA.
\]
그린의 정리를 이용해 \(\iint_R x\,dA\), \(\iint_R y\,dA\) 를 \(\oint\) 로 바꾸어 경계만 적분해도 된다.

예: \(\iint_R x\,dA = \oint_C \tfrac12 x^2\,dy\) (적절한 \(P,Q\) 선택으로 얻음).
유도 예시(한 가지 방법): \(P=0, Q=\tfrac12 x^2\Rightarrow \partial Q/\partial x = x\).

### 유체의 순환/플럭스

유체 속도 \(\mathbf v\) 와 스칼라장(압력/퍼텐셜 등) 결합 시, 경계 순환/플럭스와 내부의 회전/발산을 그린 정리로 상호 변환.

### 수치 경계 적분(도형 재구성)

픽셀 경계/폴리곤 경계에서 \(\oint\) 를 누적하여 면적, 1차·2차 모멘트를 한번에 얻는 **폴리곤 면적 공식(쇼에이스 공식)** 역시 \(\oint (x\,dy)\) 의 이산화로 이해 가능.

---

## 그린 정리와 스토크스 정리의 연관

3차원에서 스토크스 정리:
\[
\oint_{\partial S} \mathbf F\cdot d\mathbf r
=
\iint_{S} (\nabla\times \mathbf F)\cdot \mathbf n\,dS.
\]
평면 \(z=\text{const}\) 위에 놓인 \(S\) 에 대해 \(\mathbf F=\langle P,Q,0\rangle\), \(\mathbf n=\pm\mathbf k\) 를 취하면,
2D로 **축소**하여 그린 정리 순환형이 나온다.

플럭스형은 2D 가우스 정리(발산정리)이며, 3D 발산정리의 평면판.

---

## 자주 하는 실수/주의

- **방향성**: 외곽은 **반시계**, 내부 홀은 **시계**. 방향 반대로 두면 부호가 바뀐다.
- **정칙성**: \(P,Q\) 가 \(C^1\) 이고, 경계가 조각-매끄러워야 한다(실무에서는 약한 조건으로도 확장 가능).
- **구멍 난 영역**: \(\partial Q/\partial x-\partial P/\partial y=0\) 이더라도 전체 도메인이 단일연결이 아니라면 **폐곡선 적분이 0이 아닐 수** 있다(특이점/위상).
- **스칼라 선적분과 혼동**: \(\int_C f\,ds\) (스칼라 선적분) 과 \(\int_C P\,dx+Q\,dy\) (벡터장에 대한 work형 선적분) 를 혼동하지 말 것.
- **수치근사**: 경계가 날카롭거나 매개화 불량일 때 수치오차에 민감.

---

## 코드 실습 모음

### 면적을 경계 적분으로

```python
import numpy as np

def area_by_line_integral(x, y):
    """
    단순닫힌 다각형의 꼭짓점 (x[i], y[i])를 반시계 순서로 제공.
    ∮ x dy 에 대한 단순 사다리꼴 근사 (다각형이면 정확히 shoelace와 동일 결과)
    """
    n = len(x)
    s = 0.0
    for i in range(n):
        j = (i+1) % n
        s += x[i] * (y[j] - y[i])
    return s  # ∮ x dy (연속 경계라면 적분; 다각형에선 shoelace와 부호만 다름)

# 테스트: 정사각형 (0,0)->(1,0)->(1,1)->(0,1)

x = [0,1,1,0]; y=[0,0,1,1]
print("∮ x dy =", area_by_line_integral(x,y))  # 기대: Area=1, ∮ x dy = 1
```

> 다각형의 경우, \(\oint x\,dy = \sum x_i(y_{i+1}-y_i)\) 는 **면적**과 동치(부호 규약 일치 시).

### 순환형 수치검증(원형 경계)

```python
import numpy as np

def circulation_on_circle(P, Q, R=1.0, N=200000):
    ts = np.linspace(0, 2*np.pi, N+1)
    x  = R*np.cos(ts);  y  = R*np.sin(ts)
    dx = -R*np.sin(ts)*(ts[1]-ts[0])
    dy =  R*np.cos(ts)*(ts[1]-ts[0])
    integrand = P(x, y)*dx + Q(x, y)*dy
    return integrand.sum()

# 예: P=-y**3, Q=x**3

P = lambda x,y: -y**3
Q = lambda x,y: x**3

for R in [0.3, 1.0, 2.0]:
    print(R, circulation_on_circle(P,Q,R))
# 이론값: (3π/2)R^4

```

### 플럭스형 수치검증

```python
import numpy as np

def flux_on_circle(Fx, Fy, R=1.0, N=200000):
    ts = np.linspace(0, 2*np.pi, N+1)
    x  = R*np.cos(ts);  y  = R*np.sin(ts)
    # 바깥법선 n = (cos t, sin t). ds = R dt
    nx = np.cos(ts); ny = np.sin(ts)
    ds = R*(ts[1]-ts[0])
    integrand = (Fx(x,y)*nx + Fy(x,y)*ny)*ds
    return integrand.sum()

Fx = lambda x,y: x**2
Fy = lambda x,y: x*y
for R in [0.5, 1.0, 2.0]:
    print(R, flux_on_circle(Fx, Fy, R))
# 이론값: 0 (div=3x, 원판에서 대칭으로 0)

```

---

## 연습문제 (정답 스케치 포함)

1) \(C\): \(x^2+y^2=R^2\) (반시계), \(\mathbf F=\langle -y, x\rangle\).
   \(\oint_C \mathbf F\cdot d\mathbf r\) 를 구하라.
   - 스케치: \(\partial Q/\partial x - \partial P/\partial y = 1 - (-1) = 2\).
     \(\iint_{D} 2\,dA = 2\pi R^2\). 답: \(2\pi R^2\).

2) \(C\): \(x=a\cos t,y=b\sin t\) (타원, 반시계), \(\oint_C x\,dy\).
   - 스케치: 면적 \(\pi ab\).

3) \(\mathbf F=\langle P,Q\rangle=\langle x^2y, xy^2\rangle\), \(C\): \(x^2+y^2=1\).
   \(\oint_C P\,dx+Q\,dy\) 를 그린 정리로 계산.
   - 스케치: \(\partial Q/\partial x - \partial P/\partial y = y^2 - x^2\).
     원판에선 \(\iint (y^2-x^2)\,dA = 0\) (대칭). 결과: 0.

4) \(\mathbf F=\langle x, -y\rangle\), \(R\): 사각형 \([0,a]\times[0,b]\).
   \(\oint_{\partial R} \mathbf F\cdot \mathbf n\,ds\) 를 플럭스형으로.
   - 스케치: \(\operatorname{div}\mathbf F=1+(-1)=0\Rightarrow\) 플럭스 0.

5) 구멍 난 영역 \(R\): 환형 \(r_1\le r\le r_2\).
   \(\mathbf F=\langle -y/(x^2+y^2), x/(x^2+y^2)\rangle\).
   외곽 \(C_0\) 반시계, 내곽 \(C_1\) 시계라 할 때 \(\oint_{C_0}+\oint_{-C_1} = ?\)
   - 스케치: 각 원 둘레에서 값은 \(2\pi\). 방향을 맞추면 합은 \(2\pi-2\pi=0\). 내부 회전=0 과 일치(정칙영역 제외 각도함수 주의).

---

## 한 장 요약

- **순환형**: \(\displaystyle \oint_C P\,dx+Q\,dy = \iint_R(Q_x-P_y)\,dA\).
- **플럭스형**: \(\displaystyle \oint_C \mathbf F\cdot \mathbf n\,ds = \iint_R \operatorname{div}\mathbf F\,dA\).
- **면적**: \(\mathrm{Area}=\displaystyle\oint_C x\,dy = -\oint_C y\,dx = \tfrac12\oint_C (x\,dy-y\,dx)\).
- **응용**: 순환/플럭스 계산, 면적/모멘트, 보존장 판정, 수치 경계적분.
- **주의**: 경계 방향(외곽 반시계, 내부 시계), 정칙성(\(C^1\)), 위상(다중연결).

---

## 부록: 공식을 만드는 \(P,Q\) 선택 요령

- \(\iint_R 1\,dA\) 를 \(\oint\) 로 바꾸고 싶다 → \(P=0, Q=x\) (또는 \(P=-y,Q=0\)).
- \(\iint_R x\,dA\) → \(P=0, Q=\frac12 x^2\).
- \(\iint_R y\,dA\) → \(P=-\frac12 y^2, Q=0\).
- \(\iint_R (ax+by)\,dA\) → 선형 결합으로 구성.

이 요령을 기억하면 다양한 **면적·모멘트**를 경계 적분으로 빠르게 산출할 수 있다.
