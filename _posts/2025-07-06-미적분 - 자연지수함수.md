---
layout: post
title: 미적분 - 자연지수함수
date: 2025-07-06 21:20:23 +0900
category: 미적분
---
# 자연지수함수 (Natural Exponential Function)

## 1. 정의와 여러 가지 구성

### 1.1 미분방정식으로의 정의
초기값 문제
$$
y'(x)=y(x),\qquad y(0)=1
$$
의 유일해를 $$e^x$$로 정의한다. 이 정의는 “**순간 변화율 = 함수값**”인 함수를 규정하며, 해석적으로
$$
\frac{d}{dx}e^x=e^x,\qquad e^0=1
$$
을 곧바로 얻는다.

### 1.2 극한으로의 정의
$$
e=\lim_{n\to\infty}\left(1+\frac1n\right)^{\!n},\qquad
e^x=\lim_{n\to\infty}\left(1+\frac{x}{n}\right)^{\!n}.
$$
연속복리·포아송 근사 등 많은 실전 모델에서 자연스럽게 등장한다.

### 1.3 급수(테일러)로의 정의
$$
\boxed{\ e^x=\displaystyle\sum_{k=0}^{\infty}\frac{x^k}{k!}\ }
$$
모든 실수(복소수)에서 절대수렴하며, 미분·적분이 항별로 가능하다. 이 정의로부터 미분해도 여전히 자기 자신임이 즉시 따라온다.

---

## 2. 기본 성질(함수방정식, 단조, 볼록성)

- 지수 덧셈 법칙
  $$
  e^{x+y}=e^x\,e^y,\qquad e^0=1,\qquad (e^x)^{-1}=e^{-x}.
  $$
- 단조 증가 및 양의 값
  $$
  x_1<x_2\ \Rightarrow\ e^{x_1}<e^{x_2},\qquad e^x>0.
  $$
- 미분·적분
  $$
  \frac{d}{dx}e^x=e^x,\qquad \int e^x\,dx=e^x+C.
  $$
  더 일반적으로, 연쇄법칙
  $$
  \frac{d}{dx}e^{f(x)}=f'(x)\,e^{f(x)},\qquad \int f'(x)\,e^{f(x)}\,dx=e^{f(x)}+C.
  $$
- 볼록성(Convex): $$e^x$$는 전구간에서 볼록, 즉 $$e''(x)=e^x>0$$.  
  접선 부등식에서 유명한
  $$
  \boxed{\ e^x\ge 1+x\quad(\text{모든 }x)\ }
  $$
  와 같은 결과가 나온다(평등은 $$x=0$$).

---

## 3. 역함수와 로그와의 연결

자연로그 $$\ln x$$는 $$e^x$$의 역함수:
$$
\ln(e^x)=x,\qquad e^{\ln x}=x\quad(x>0).
$$
로그 미분을 이용하면 곱·거듭제곱 꼴의 미분이 단순해진다. 예를 들어
$$
y=x^x\ (x>0)\ \Rightarrow\ \ln y=x\ln x\ \Rightarrow\ \frac{y'}{y}=\ln x+1\ \Rightarrow\ 
\boxed{\,y'=x^x(\ln x+1)\,}.
$$

---

## 4. 극한과 근사

- 기본 극한
  $$
  \lim_{x\to 0}\frac{e^x-1}{x}=1,\qquad e^x=1+x+\frac{x^2}{2}+O(x^3).
  $$
- 성장 비교
  $$
  \lim_{x\to\infty}\frac{e^x}{x^p}=+\infty\ (p>0),\qquad 
  \lim_{x\to\infty}\frac{\ln x}{x}=0.
  $$
  지수는 모든 다항을 “이긴다”. 또한 $$n!\sim \sqrt{2\pi n}\,(n/e)^n$$ (스털링)로부터 $$e^x$$의 본질적 빠른 성장이 드러난다.

---

## 5. 대표 미적분 예제

### 5.1 미분 예제
$$
f(x)=3e^{2x}\ \Rightarrow\ f'(x)=6e^{2x}.
$$
$$
g(x)=e^{-\frac{x^2}{2}}\ \Rightarrow\ g'(x)=-x\,e^{-\frac{x^2}{2}}.
$$

### 5.2 적분 예제
선형 치환과 결합하면 즉시 닫힌형을 얻는다.
$$
\int 5e^{-3x}\,dx=-\frac{5}{3}e^{-3x}+C,\qquad
\int e^{ax+b}\,dx=\frac1a e^{ax+b}+C\ (a\ne 0).
$$

### 5.3 삼각함수와의 결합
복소 지수를 이용하거나 부분적분 반복을 이용하면
$$
\boxed{\ \int e^{ax}\cos(bx)\,dx=\frac{e^{ax}}{a^2+b^2}\big(a\cos bx+b\sin bx\big)+C\ }
$$
$$
\boxed{\ \int e^{ax}\sin(bx)\,dx=\frac{e^{ax}}{a^2+b^2}\big(a\sin bx-b\cos bx\big)+C\ }.
$$

---

## 6. 미분방정식에서의 위상 역할

### 6.1 1계 선형 ODE
$$
y'+p(x)\,y=q(x)\quad\Rightarrow\quad 
\mu(x)=e^{\int p(x)\,dx},\ \ (\mu y)'=\mu q.
$$
예) $$y'-y=e^x$$  
적분인자 $$\mu=e^{-x}$$, \((e^{-x}y)'=1\Rightarrow e^{-x}y=x+C\Rightarrow \boxed{y=e^x(x+C)}\).

### 6.2 상미분방정식의 기본 모형
지수 성장/감쇠
$$
y'=k y\ \Rightarrow\ \boxed{y(t)=y_0 e^{kt}}.
$$
로지스틱(안정평형 포함)
$$
y'=r y\Bigl(1-\frac{y}{K}\Bigr)\ \Rightarrow\ 
y(t)=\frac{K}{1+A e^{-rt}}.
$$

### 6.3 행렬 지수와 선형 시스템
$$
\mathbf{x}'=A\mathbf{x}\ \Rightarrow\ \mathbf{x}(t)=e^{At}\mathbf{x}(0),\qquad
e^{At}=\sum_{k\ge 0}\frac{(At)^k}{k!}.
$$
대각화 가능 시 \(A=V\Lambda V^{-1}\)이면 \(e^{At}=V e^{\Lambda t}V^{-1}\) (대각 원소별 지수).

---

## 7. 복소수로의 확장과 오일러 공식

복소수 \(z=x+iy\)에 대해
$$
e^{z}=e^{x}(\cos y+i\sin y),
$$
특히 \(e^{iy}=\cos y+i\sin y\). 여기서
$$
e^{i\pi}+1=0
$$
은 \(e,\ i,\ \pi,\ 1,\ 0\)을 잇는 상징적 식이다.

---

## 8. 급수, 나머지항, 수치 근사

### 8.1 테일러 급수와 오차
$$
e^x=\sum_{k=0}^{n}\frac{x^k}{k!}+R_{n+1}(x),\qquad
|R_{n+1}(x)|=\frac{e^{\xi}|x|^{n+1}}{(n+1)!}\ (\,\xi\text{ 는 }0\text{ 과 }x\text{ 사이}).
$$
큰 \(|x|\)에선 **범위 축소(range reduction)**, 즉 \(x=m\ln 2 + r\)로 쪼개 \(e^x=2^m e^r\) (\(|r|\) 작게) 같은 전략을 쓴다.

### 8.2 `expm1`의 필요성
\(|x|\ll 1\)에서 \(e^x-1\)은 유효숫자 소실이 심각하므로 `expm1(x)`를 사용한다 (수치적으로 안정화).

```python
# exp, expm1, 안정 softmax/LogSumExp 예제
import numpy as np

# 1) expm1 vs (exp(x)-1) 비교
for x in [1e-8, 1e-10, -1e-10]:
    naive = np.exp(x) - 1.0
    stable = np.expm1(x)
    print(f"x={x:.0e}, exp-1={naive:.20e}, expm1={stable:.20e}, diff={naive-stable:.2e}")

# 2) LogSumExp(오버플로/언더플로 방지)
def logsumexp(z):
    m = np.max(z)
    return m + np.log(np.sum(np.exp(z - m)))

# 3) 안정 softmax
def softmax(z):
    z = np.asarray(z)
    m = np.max(z)
    e = np.exp(z - m)
    return e / np.sum(e)

print("LSE:", logsumexp(np.array([1000., 999., 998.])))
print("softmax:", softmax([1000., 999., 998.]))
```

---

## 9. 불평등과 볼록해석

- 접선 부등식(볼록성):  
  \(e^x \ge 1+x\) (전구간), 또한 \(e^x \le 1+x+\frac{x^2}{2}e^{|x|}\) 같은 잔차 경계도 유용하다.
- 옌센 부등식(볼록):  
  \(e^{\theta x+(1-\theta)y}\le \theta e^{x}+(1-\theta)e^{y}\) (\(0\le\theta\le1\)).
- AM–GM의 지수형:  
  \(\displaystyle \frac1n\sum_{k=1}^n e^{x_k}\ge \exp\!\Big(\frac1n\sum_{k=1}^n x_k\Big)\).

---

## 10. 확률·통계·정보이론 응용

- 모멘트생성함수(MGF): \(M_X(t)=\mathbb{E}[e^{tX}]\).
  - 정규 \(N(\mu,\sigma^2)\): \(M_X(t)=\exp(\mu t+\tfrac12\sigma^2 t^2)\).
- 포아송(\(\lambda\)): \(\mathbb{P}(X=k)=e^{-\lambda}\lambda^k/k!\).
- 로지스틱/소프트맥스: 지수로 확률을 파라미터화, 로그-우도 최대화가 자연스러움.
- 안정적 LogSumExp는 음수 로그-우도 계산의 표준 도구.

---

## 11. 금융·공학 모델

- 연속복리: \(A=Pe^{rt}\), 수익률 \(r=\frac1t\ln(A/P)\).
- 감쇠/증폭: \(x(t)=x_0 e^{-t/\tau}\) (시정수 \(\tau\)).
- RC 회로: \(v'(t)+\frac{1}{RC}v(t)=\frac{1}{RC}V_{\text{in}}(t)\) → 지수적 과도응답.

---

## 12. 실전 플롯과 비교(코드 스니펫)

```python
# 지수 vs 다항/로그 성장 비교
import numpy as np, matplotlib.pyplot as plt

xs = np.linspace(0, 10, 1000)
plt.plot(xs, np.exp(xs), label='e^x')
plt.plot(xs, xs**3, label='x^3')
plt.plot(xs, 50*xs, label='50x')
plt.plot(xs, 100*np.log(xs+1), label='100 ln(1+x)')
plt.ylim(0, 1e4); plt.legend(); plt.grid(True)
plt.title('지수 성장 vs 다항/선형/로그 (스케일 비교)')
plt.show()
```

---

## 13. 연습문제(풀이 스케치 포함)

1) 극한  
   \(\displaystyle \lim_{x\to 0}\frac{e^{3x}-1}{x}=3\) (테일러나 연쇄법칙)

2) 적분  
   \(\displaystyle \int x\,e^{x}\,dx=(x-1)e^x+C\) (부분적분)

3) ODE  
   \(y'-2y=e^{x},\ y(0)=0\)  
   적분인자 \(e^{-2x}\): \((e^{-2x}y)'=e^{-x}\Rightarrow e^{-2x}y=-e^{-x}+C\). 초기조건 → \(C=1\).  
   \(\boxed{y=1-e^{-x}}\).

4) 삼각 결합 적분  
   \(\displaystyle \int e^{-x}\cos x\,dx=\frac{e^{-x}}{2}(\cos x-\sin x)+C\)

5) 수치 안정성  
   매우 큰 벡터 \(z\)로 softmax를 구현하라. (정답: \(z\)에서 \(\max z\)를 빼서 exponentiate)

---

## 14. 한눈 요약

- 정의: 미분방정식 \(y'=y,\ y(0)=1\)의 해, 극한 \(\big(1+\frac{x}{n}\big)^n\), 급수 \(\sum x^k/k!\).
- 핵심 성질: \(e^{x+y}=e^x e^y\), 미분·적분은 자기 자신, 전구간 볼록·단조 증가.
- 로그와 역함수: \(\ln(e^x)=x\), 로그 미분으로 곱·멱 미분 단순화.
- 수치: `expm1`, LogSumExp, range reduction으로 안정화.
- 응용: ODE 해, 연속복리, 확률모형(MGF/softmax), 행렬지수 \(e^{At}\) 등 광범위.