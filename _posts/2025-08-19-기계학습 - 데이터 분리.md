---
layout: post
title: ê¸°ê³„í•™ìŠµ - ë°ì´í„° ë¶„ë¦¬
date: 2025-08-19 22:25:23 +0900
category: ê¸°ê³„í•™ìŠµ
---
# ğŸ“Š ë°ì´í„° ë¶„ë¦¬ (Train/Test Split, Cross Validation)

ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµí•  ë•Œ, **ë°ì´í„° ë¶„ë¦¬**ëŠ” í•„ìˆ˜ì ì¸ ê³¼ì •ì…ë‹ˆë‹¤.  
ëª¨ë¸ì´ ë‹¨ìˆœíˆ í›ˆë ¨ ë°ì´í„°ë§Œ ì˜ ì™¸ìš°ëŠ”(ê³¼ì í•©, Overfitting) ê²ƒì´ ì•„ë‹ˆë¼ **ìƒˆë¡œìš´ ë°ì´í„°ì—ì„œë„ ì˜ ì¼ë°˜í™”(Generalization)** í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤.  

---

## 1. Train / Test Split

### (1) ê¸°ë³¸ ê°œë…
- ë°ì´í„°ë¥¼ **í›ˆë ¨ìš©(Train Set)** ê³¼ **í…ŒìŠ¤íŠ¸ìš©(Test Set)** ìœ¼ë¡œ ë¶„ë¦¬  
- Train Set: ëª¨ë¸ í•™ìŠµì— ì‚¬ìš©  
- Test Set: í•™ìŠµëœ ëª¨ë¸ ì„±ëŠ¥ í‰ê°€ì— ì‚¬ìš© (ì¼ì¢…ì˜ "ì‹œí—˜")  

### (2) ì™œ í•„ìš”í•œê°€?
- ëª¨ë“  ë°ì´í„°ë¥¼ í•™ìŠµì— ì‚¬ìš©í•˜ë©´, ëª¨ë¸ì´ ì„±ëŠ¥ì„ í‰ê°€í•  ìˆ˜ ì—†ìŒ  
- í›ˆë ¨ê³¼ í‰ê°€ë¥¼ ë¶„ë¦¬í•´ì•¼ "ëª¨ë¥´ëŠ” ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ ì„±ëŠ¥"ì„ ì¶”ì • ê°€ëŠ¥  

### (3) ì¼ë°˜ì ì¸ ë¶„ë¦¬ ë¹„ìœ¨
- **í›ˆë ¨:í…ŒìŠ¤íŠ¸ = 8:2** ë˜ëŠ” **7:3**
- ë°ì´í„°ê°€ ë§ìœ¼ë©´ 9:1ë„ ê°€ëŠ¥
- ë°ì´í„°ê°€ ì ìœ¼ë©´ êµì°¨ ê²€ì¦(Cross Validation)ì„ ì‚¬ìš©

### (4) íŒŒì´ì¬ ì˜ˆì‹œ
```python
from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris

X, y = load_iris(return_X_y=True)

# 70% í•™ìŠµ, 30% í…ŒìŠ¤íŠ¸ ë¶„ë¦¬
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

print("Train size:", len(X_train))
print("Test size:", len(X_test))
```

ğŸ‘‰ `stratify=y` ì˜µì…˜ì€ **ë¶„ë¥˜ ë¬¸ì œì—ì„œ í´ë˜ìŠ¤ ë¹„ìœ¨ì„ ìœ ì§€**í•˜ë„ë¡ ë°ì´í„°ë¥¼ ë‚˜ëˆ”

---

## 2. Cross Validation (êµì°¨ ê²€ì¦)

### (1) ê¸°ë³¸ ê°œë…
- ë°ì´í„°ë¥¼ ë‹¨ìˆœíˆ Train/Testë¡œë§Œ ë‚˜ëˆ„ë©´, ë¶„ë¦¬ ë°©ì‹ì— ë”°ë¼ ì„±ëŠ¥ í‰ê°€ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ  
- ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ **ì—¬ëŸ¬ ë²ˆ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ì–´ í•™ìŠµê³¼ í‰ê°€ë¥¼ ë°˜ë³µ**í•˜ëŠ” ë°©ë²•  

### (2) K-Fold Cross Validation
- ë°ì´í„°ë¥¼ **Kê°œì˜ í´ë“œ(Fold)** ë¡œ ë‚˜ëˆ”
- ë§¤ë²ˆ 1ê°œì˜ í´ë“œë¥¼ ê²€ì¦ìš©(Validation)ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , ë‚˜ë¨¸ì§€ K-1ê°œë¥¼ í•™ìŠµì— ì‚¬ìš©
- ì´ Kë²ˆ ë°˜ë³µí•˜ì—¬ ë‚˜ì˜¨ ê²°ê³¼ë¥¼ í‰ê· ë‚´ì–´ ìµœì¢… ì„±ëŠ¥ ì¶”ì •

#### ì˜ˆì‹œ (K=5)
1. Fold1: Test / Fold2~5: Train  
2. Fold2: Test / Fold1,3~5: Train  
3. Fold3: Test / Fold1,2,4,5: Train  
4. Fold4: Test / Fold1,2,3,5: Train  
5. Fold5: Test / Fold1~4: Train  

ğŸ‘‰ ê²°ê³¼ë¥¼ í‰ê· í•˜ë©´ "ë°ì´í„° ë¶„í• ì˜ í¸í–¥"ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ

### (3) Stratified K-Fold
- ë¶„ë¥˜ ë¬¸ì œì—ì„œëŠ” í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œê°€ ìˆìœ¼ë¯€ë¡œ, **ê° Foldê°€ í´ë˜ìŠ¤ ë¹„ìœ¨ì„ ìœ ì§€**í•˜ë„ë¡ ë¶„ë¦¬í•˜ëŠ” ë°©ì‹
- ë¶ˆê· í˜• ë°ì´í„°ì…‹ì—ì„œ ê¶Œì¥ë¨

### (4) Leave-One-Out Cross Validation (LOOCV)
- ë°ì´í„°ê°€ nê°œì¼ ë•Œ, n-1ê°œë¥¼ í•™ìŠµì— ì‚¬ìš©í•˜ê³  1ê°œë¥¼ ê²€ì¦ì— ì‚¬ìš©
- në²ˆ ë°˜ë³µí•˜ì—¬ í‰ê·  ì„±ëŠ¥ì„ ê³„ì‚°
- ë°ì´í„°ê°€ ì ì„ ë•Œ ì‚¬ìš©í•˜ì§€ë§Œ, ê³„ì‚°ëŸ‰ì´ ë§ìŒ

### (5) íŒŒì´ì¬ ì˜ˆì‹œ
```python
from sklearn.model_selection import KFold, cross_val_score
from sklearn.linear_model import LogisticRegression
from sklearn.datasets import load_iris

X, y = load_iris(return_X_y=True)

# 5-Fold êµì°¨ê²€ì¦
kf = KFold(n_splits=5, shuffle=True, random_state=42)
model = LogisticRegression(max_iter=1000)

scores = cross_val_score(model, X, y, cv=kf)
print("ê° Fold ì •í™•ë„:", scores)
print("í‰ê·  ì •í™•ë„:", scores.mean())
```

---

## 3. Train/Validation/Test ë¶„ë¦¬

ì‹¤ë¬´ì—ì„œëŠ” ë‹¨ìˆœ Train/Testë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆìŒ.  
ëª¨ë¸ì„ íŠœë‹í•  ë•Œ Test Setê¹Œì§€ ì‚¬ìš©í•˜ë©´ "ë°ì´í„° ëˆ„ìˆ˜(Data Leakage)"ê°€ ë°œìƒ â†’ ì¼ë°˜í™” ì„±ëŠ¥ ê³¼ëŒ€í‰ê°€ ìœ„í—˜.  

ğŸ‘‰ ë”°ë¼ì„œ **3-way split** ì‚¬ìš©:
1. **Train Set**: í•™ìŠµ
2. **Validation Set**: ëª¨ë¸ ì„ íƒ, í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
3. **Test Set**: ìµœì¢… ì„±ëŠ¥ í‰ê°€ (ë§ˆì§€ë§‰ì—ë§Œ ì‚¬ìš©)

ì˜ˆì‹œ ë¹„ìœ¨:
- Train:Validation:Test = 6:2:2
- ë°ì´í„°ê°€ ì ë‹¤ë©´ K-Fold êµì°¨ê²€ì¦ìœ¼ë¡œ Validationì„ ëŒ€ì²´

---

## 4. Cross Validation vs. Train/Test Split

| êµ¬ë¶„ | Train/Test Split | Cross Validation |
|------|------------------|------------------|
| ì¥ì  | ë¹ ë¥´ê³  ê°„ë‹¨ | ë°ì´í„° í™œìš© ê·¹ëŒ€í™”, ì„±ëŠ¥ ì•ˆì •ì  |
| ë‹¨ì  | ë¶„í• ì— ë”°ë¼ ì„±ëŠ¥ í¸ì°¨ ë°œìƒ | ê³„ì‚° ë¹„ìš© í¼ (ë°˜ë³µ í•™ìŠµ í•„ìš”) |
| ê¶Œì¥ ìƒí™© | ë°ì´í„° ë§ì„ ë•Œ | ë°ì´í„° ì ê±°ë‚˜ ëª¨ë¸ íŠœë‹ í•„ìš”í•  ë•Œ |

---

## ğŸ“Œ ìš”ì•½
- Train/Test Split: ê°„ë‹¨íˆ ë°ì´í„° ë‚˜ëˆ„ì–´ í›ˆë ¨/í‰ê°€  
- Cross Validation: ì—¬ëŸ¬ ë²ˆ ë‚˜ëˆ„ì–´ í‰ê·  ì„±ëŠ¥ í‰ê°€ (í¸í–¥ ì¤„ì„)  
- Train/Validation/Test: ì‹¤ë¬´ì—ì„œ ìµœì¢… ì„±ëŠ¥ ê²€ì¦ ì‹œ í•„ìˆ˜  

---

ğŸ‘‰ ê²°ë¡ :  
- **ë°ì´í„° ë§ìŒ â†’ Train/Testë§Œ ë‚˜ëˆ ë„ ì¶©ë¶„**  
- **ë°ì´í„° ì ìŒ â†’ Cross Validation í•„ìˆ˜**  
- **ì‹¤ë¬´ í”„ë¡œì íŠ¸ â†’ Train/Validation/Test êµ¬ì¡° + í•„ìš”ì‹œ êµì°¨ê²€ì¦ í™œìš©**  