---
layout: post
title: 정보통신기사 - 라인코딩
date: 2025-08-21 15:25:23 +0900
category: 정보통신기사
---
# 라인코딩(RZ/NRZ/AMI/Manchester) 비교

## 준비: 비트율·주기·기본 기호

- 비트율 $R_b$ [bit/s], 비트 주기 $T_b = 1/R_b$ [s].
- 라인 부호화는 **디지털 비트열 → 전송선로의 전압/전류 파형**으로 바꾸는 과정.
- 비교 기준
  - **스펙트럼/대역폭**: 필요한 채널 대역폭, 주파수 성분(DC·저주파 포함 여부)
  - **클럭 복구(Self-clocking)**: **중간 전이**(mid-bit transition)가 있으면 PLL 동기화 유리
  - **DC 성분/저주파**: 변압기 결합(AC coupling) 가능성, **베이스라인 워더**(baseline wander) 민감도
  - **런-길이(run length)**: 연속 같은 심볼 길이 → 동기 손실/ISI 위험
  - **에러 검출성**: **AMI 위반**(bipolar violation) 등으로 간단한 결함 검출 가능성
  - **복잡도/전력 효율**: 구현 난도, 평균 전력, EMI 특성

---

## NRZ (Non-Return-to-Zero)

### NRZ-L (Level)

- **정의**: 비트 기간 $T_b$ 동안 **레벨 고정**. 예:
  1 → $+A$, 0 → $-A$ (polar) 또는 1 → $+A$, 0 → $0$ (unipolar).
- **파형(예: polar NRZ-L)**
  ```
  bit:   1   1   0   0   1   0
  lvl:  +A  +A  -A  -A  +A  -A   (비트 경계에서만 바뀜)
  ```

### NRZ-I (Invert on 1)

- **정의**: “1”에서 **레벨 토글**, “0”은 **유지**. 초기 레벨을 $+A$라면, 1이 들어올 때마다 +A↔−A 전환.
- **파형**
  ```
  bit:   1   0   1   1   0   0   1
  lvl:  -A  -A  +A  -A  -A  -A  +A   (1에서만 전이)
  ```

### NRZ의 장단점

- **장점**
  - **대역 효율** 우수(이상 Nyquist 펄스 사용 시 B_min ≈ $R_b/2$).
  - 구현 단순, 전력 효율 괜찮음(Polar의 경우 평균 0에 가까워 DC 부담 적음).
- **단점**
  - **긴 동일 비트(run)**에선 전이가 적어 **클럭 복구 어려움**, **베이스라인 워더** 가능.
  - Unipolar(0↦0, 1↦+A)는 **DC 성분 큼**(변압기 결합 곤란, EMI↑).
- **스펙트럼 개요**
  - 직사각 NRZ 펄스의 스펙트럼은 $ \mathrm{sinc}^2 $ 꼴. **첫 영점(null)**은 $f = \pm 1/T_b = \pm R_b$.
  - 실무 필터는 보통 **(1+α)·$R_b/2$**(raised-cosine $α$) 근처에서 잡음/ISI 절충.

### 예제 ① — 10 Mb/s NRZ-L의 실용 대역

- 이론 최소(α=0): $B_{\min} = R_b/2 = 5$ MHz.
- 현실(α=0.5): $B \approx (1+α)\,R_b/2 = 7.5$ MHz.
- 직사각 펄스 그대로면 **첫 null**이 $R_b=10$ MHz → LPF 컷오프를 8~10 MHz 권역으로 잡아 **오버슈트/ISI**를 절충.

---

## RZ (Return-to-Zero)

### 정의·파형

- 비트 기간 중 **중간 혹은 끝에서 0 레벨로 복귀**. 보통 **50% 듀티**:
  1 → $+A$를 **$T_b/2$**만 인가 후 0으로, 0 → 0.
- **파형**
  ```
  bit:   1       0       1       1       0
  lvl:  +A 0 0  0 0 0  +A 0 0  +A 0 0   0 0 0
        |<-Tb->|
  ```

### 특성

- **장점**: **중간에 레벨 복귀** → 전이 수 증가 → **클럭 복구 용이**.
- **단점**: 펄스 폭이 절반 → **고조파 성분↑, 대역폭↑(NRZ 대비 넓음)**, 전력 효율↓.
- **스펙트럼**: 직사각 듀티 50% → 기본 주파수가 **NRZ보다 높게** 배치, **DC 성분 감소** 경향.

### 예제 ② — 5 Mb/s RZ의 대역 추정

- 듀티 50%이면 주파수 성분이 퍼짐 → 실무적으로 **LPF ≳ $R_b$** 권역 필요.
- 이상 Nyquist 펄스를 쓰면 $B=(1+α)R_b/2$ 도 가능하나, **RZ는 파형상 전이↑**라 여유 대역 설계가 일반적.

---

## AMI (Alternate Mark Inversion) — **3레벨(ternary)**

### 정의·파형

- **1(=mark)**는 부호를 **+A, −A로 번갈아** 인가, **0**은 **0 V**.
- **파형(마크 교대)**
  ```
  bit:   1   0   1   1   0   0   1
  lvl:  +A   0  -A  +A   0   0  -A   (1은 부호가 번갈아 나옴)
  ```

### 장단점

- **장점**
  - 1의 극성이 교대 → **장기 평균이 0 V 부근(DC 억제)** → 변압기 결합/차단 커패시터 용이.
  - **전이가 자주 생김**(특히 1이 섞이면) → **클럭 복구**에 유리(단, **0의 장런**은 전이 없음).
  - **바이폴라 위반(Bipolar Violation)**을 **간단 에러 지시자**로 활용 가능.
- **단점**
  - **0이 길게 연속**되면 전이가 없으므로 동기 위험 → **B8ZS/HDB3** 같은 **제로 대체 규칙**이 필요.
  - 3레벨 신호 → 레벨 정밀도 요구(잡음 마진 설계 필요).

### 제로 대체: B8ZS / HDB3 (개념 정리)

- **B8ZS (T1, 북미)**: **8개의 0**이 연속되면 **특수 패턴**으로 바꿔 **의도적 위반(V)**을 두 번 삽입.
  표기: `000VB0VB` (V=위반, B=정상 마크). 실제 **부호(+/−)**는 **직전 마크의 극성**에 따라 정해져 **DC 균형**을 맞춤.
  → 수신기는 **위반 패턴**을 감지해 8개의 0 복원.
- **HDB3 (E1, 유럽/국제)**: **4개의 0**이 연속될 때 `000V` 또는 `B00V`로 대체.
  **B(보정 마크)** 삽입 여부는 “마지막 대체 이후 비마크(±A) 개수의 **짝/홀**”에 따라 결정 → **총 극성 합 0** 유지.
  → 수신기는 V 위치를 보고 원래 0000 복원.

> **시험 포인트**:
> AMI는 0→0 V, 1→±A(교대). **긴 0 대비책**: **B8ZS(8연속), HDB3(4연속)**.
> **위반(V)**는 **바이폴라 규칙(1의 극성 교대)**을 일부러 깨서 **동기**를 주고, **에러/대체 패턴**을 식별하게 함.

### 스펙트럼/대역

- AMI는 평균 0 → **DC 성분 억제**. 스펙트럼은 NRZ보다 **저주파 억제**가 잘 됨(0 지속 시는 제외).
- 대역폭 요구량은 NRZ급이지만, **제로 대체 규칙**을 적용하면 **전이 밀도 증가**로 **실효 클럭 복구** 향상.

---

## Manchester (Bi-phase-L)

### 정의·파형

- 각 비트 **중간**( $t=T_b/2$ )에 **반드시 전이**.
  - IEEE 802.3 규약(이더넷 기준): **1 → 저→고**, **0 → 고→저** (반대 정의도 문헌에 존재).
- **파형 예**
  ```
  bit:   1       0       1       1       0
  lvl:  _/‾   ‾\_   _/‾   _/‾   ‾\_    (항상 mid-bit 전이 존재)
  ```

### 특성

- **장점**
  - **완전한 self-clocking**: **중간 전이** 덕에 PLL 동기 용이.
  - **DC 성분 없음**(평균 0) → 변압기 결합 유리.
  - 극성 반전·상수 오프셋에 강함(전이 기반 검파).
- **단점**
  - **전이 1회/비트 보장** → **대역폭 요구 ↑(NRZ의 약 2배)**.
- **스펙트럼**
  - DC notch(0 Hz에서 0), 주요 성분이 **$R_b/2$** 및 그 배수에 분포(정확한 PSD 유도는 생략).
  - 실무적 대역: **$B \approx (1+α)\,R_b$**(α=0.3~0.5 가정 시)로 잡으면 여유.

### Differential Manchester (참고)

- **중간 전이**는 항상 존재(클럭), **비트 경계 전이 유무**로 0/1 의미를 구분(극성 반전에 무감).
- 대역폭 요구는 Manchester와 유사.

---

## “클럭 복구, DC, 대역폭”을 한 눈에

| 부호 | 전이 밀도 | self-clocking | DC 성분 | 대역폭(이상 Nyquist 기준) | 실무 대역 감(직사각) | 특징 |
|---|---|---|---|---|---|---|
| **NRZ-L** | 중간 | 보통(런 길이 민감) | polar: 낮음 / unipolar: 큼 | $R_b/2$ (α=0) | null at $R_b$. 컷오프 ~ $0.7\sim1.0\,R_b$ | 간단, 효율↑ |
| **NRZ-I** | 1 밀도에 좌우 | 보통(1 적으면 전이 적음) | polar: 낮음 | $R_b/2$ (α=0) | NRZ-L 유사 | 4B/5B-NRZI 등과 궁합 |
| **RZ** | 높음 | 좋음 | 낮음 | $R_b/2$ (α=0) | 전이↑ → 넓은 대역 요구 | 듀티로 스펙트럼 조절 |
| **AMI** | 1에서 전이 | 보통(0 런 취약) | **없음(평균 0)** | $R_b/2$ (α=0) | NRZ급. 저주파 억제 우수 | **B8ZS/HDB3**로 0 런 해결 |
| **Manchester** | **항상** | **매우 좋음** | **없음** | $\approx R_b$ (α=0) | NRZ의 약 2배 | 10BASE-T에서 사용 |

> **주의**: “이상 Nyquist 대역”은 **이상적인 Nyquist 펄스(raised-cosine α=0)**를 가정.
> 직사각 펄스(현실) 그대로면 에너지 누설이 커서 **더 넓은 대역**이 필요.

---

## 실무 이슈: 베이스라인 워더 & 런-길이

- **베이스라인 워더**: 긴 동일 심볼로 **평균 레벨 기준선**이 천천히 드리프트 → 검파 임계치가 흔들려 오류↑.
- **해법**
  - **자기시계(self-clocking)** 강한 부호(Machester, Differential) 사용.
  - **제로 대체(AMI+B8ZS/HDB3)**, **블록코딩(4B/5B→NRZI)**, **스크램블러**로 **전이 밀도** 보장.
  - **고역통과(AC coupling)** 설계 시 **DC·저주파 억제**되는 부호(AMI/Manchester 등) 선택.

---

## 블록 코딩과 라인코딩의 궁합(참고)

- **4B/5B + NRZI (100BASE-TX)**: 4 bit → 5 bit 매핑으로 **런-길이 제한(최대 3~4 0)**, NRZI로 **전이 보장**.
- **MLT-3 (Fast Ethernet 물리)**: 3레벨(−1,0,+1)을 **주기적 순환**으로 전이하여 **스펙트럼 저주파화**.
- **8B/10B (GbE/SATA/PCIe 1.x)**: DC 밸런스와 전이 밀도 보장.
- **64b/66b (10 GbE+)**: 오버헤드↓, 스크램블 기반으로 DC·전이 특성 확보.

---

## 계산 예제 — 대역폭 산정

### 조건

- 목표 비트율 $R_b = 10\,\mathrm{Mb/s}$, **raised-cosine** 필터 $α=0.5$.
- 이론적 최소 대역 $B = (1+α)R_s/2$ (여기서 $R_s$는 **심볼율**).

### 부호별 심볼율 $R_s$

- **NRZ (이진 PAM)**: $R_s = R_b$.
  $B \approx (1+0.5)\,\frac{10}{2} = 7.5\,\mathrm{MHz}$.
- **RZ(50% 듀티, 이진)**: $R_s = R_b$이나 전이↑ → 실무 여유로 **$B \gtrsim 10\,\mathrm{MHz}$** 설계 권장.
- **AMI(이진)**: $R_s = R_b$.
  $B \approx 7.5\,\mathrm{MHz}$ (제로 대체 적용 시 전이↑ → PLL 여유↑, 대역은 유사).
- **Manchester**: **비트마다 2심볼**로 생각 → $R_s \approx 2R_b$.
  $B \approx (1+0.5)\,\frac{20}{2} = 15\,\mathrm{MHz}$.

---

## 에러 검출/복구 관점

- **AMI**: 정상은 “1의 극성 교대”. 수신부가 **같은 극성 1이 연속**되는 **위반**을 보면 **에러/대체 패턴**으로 인지.
- **Manchester/Differential**: 검파는 **전이 시점** 기반 → **레벨 오프셋/극성 반전**에 강함.
- **NRZ**: 전이 드문 구간에서 **클럭 흔들림** → **비트 경계 오인식** 위험.

---

## 스펙트럼(직관 메모)

- **NRZ**: $ \mathrm{sinc}^2 $ 로브, null at $f=R_b$. 저주파 성분 존재(특히 unipolar).
- **RZ**: 듀티로 고조파↑, 평균 0에 더 근접(DC↓).
- **AMI**: 평균 0 → DC notch 경향, **0 런**이 길면 저주파 성분 감소가 깨질 수 있음 → B8ZS/HDB3로 전이 보강.
- **Manchester**: **DC=0**, **mid-bit 전이**가 강한 주기성을 만들어 **자기시계** 특성↑, 대역↑.

---

## 눈다이어그램(eye diagram) 관찰 포인트

- **개방(eye opening)** 클수록 ISI/지터 여유↑.
- **NRZ**: 채널 저역통과에서 ISI 적응 시 개방 양호하나 **클럭 트래킹** 주의.
- **RZ/Manchester**: 전이 풍부 → 타이밍 눈 높게 열리는 경향.
- **AMI**: 3레벨 분리(결정 임계 2개) → SNR 요구 고려.

---

## 파이썬 실습 스니펫(시뮬레이션용)

> 아래 코드는 **파형 생성·간단 FFT·눈다이어그램용 샘플**입니다(학습용).
> (실행 환경에서 Numpy/Matplotlib 필요)

```python
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(0)

# 공통 파라미터

Rb = 2e6           # bit rate 2 Mb/s (예시)
Tb = 1/Rb
A  = 1.0           # 진폭
Nbits = 256

bits = np.random.randint(0,2,Nbits)

# 샘플링

ovs = 64           # samples per bit
Fs  = Rb * ovs
Ts  = 1/Fs

def nrz_l(bits, A=1.0):
    # polar NRZ-L: 1->+A, 0->-A
    levels = np.where(bits==1, A, -A)
    return np.repeat(levels, ovs)

def nrz_i(bits, A=1.0):
    out = []
    level = A
    for b in bits:
        if b==1:
            level = -level
        out.append(level)
    return np.repeat(out, ovs)

def rz(bits, A=1.0, duty=0.5):
    # 1 -> +A for duty*Tb, then 0
    pulse = int(ovs*duty)
    x = np.zeros(Nbits*ovs)
    for i,b in enumerate(bits):
        if b==1:
            x[i*ovs:(i*ovs+pulse)] = A
    return x

def ami(bits, A=1.0):
    x = []
    last = -A
    for b in bits:
        if b==1:
            last = -last
            x.append(last)
        else:
            x.append(0.0)
    return np.repeat(x, ovs)

def manchester(bits, A=1.0):
    x = np.zeros(Nbits*ovs)
    half = ovs//2
    # IEEE: 1 -> L->H, 0 -> H->L
    for i,b in enumerate(bits):
        if b==1:
            x[i*ovs:(i*ovs+half)] = -A
            x[i*ovs+half:(i*ovs+ovs)] = +A
        else:
            x[i*ovs:(i*ovs+half)] = +A
            x[i*ovs+half:(i*ovs+ovs)] = -A
    return x

signals = {
    "NRZ-L": nrz_l(bits, A),
    "NRZ-I": nrz_i(bits, A),
    "RZ":    rz(bits, A, 0.5),
    "AMI":   ami(bits, A),
    "MCH":   manchester(bits, A),
}

# 파형 비교

plt.figure()
for name, x in signals.items():
    t = np.arange(len(x))*Ts
    plt.plot(t[:8*ovs], x[:8*ovs], label=name)
plt.xlabel('time (s)')
plt.ylabel('amp')
plt.legend()
plt.title('Line Codes (first 8 bits)')
plt.show()

# 간단 스펙트럼

def psd_db(x):
    X = np.fft.rfft(x*np.hanning(len(x)))
    P = (np.abs(X)**2) / len(X)
    return 10*np.log10(P / np.max(P) + 1e-12)

plt.figure()
f_axis = np.fft.rfftfreq(len(next(iter(signals.values()))), Ts)
for name, x in signals.items():
    plt.plot(f_axis/1e6, psd_db(x), label=name)
plt.xlim(0, 10) # MHz
plt.xlabel('freq (MHz)')
plt.ylabel('PSD (dB, norm)')
plt.legend()
plt.title('Normalized PSD (qualitative)')
plt.show()

# 눈다이어그램

x = signals["NRZ-L"]
span_bits = 2
span = span_bits*ovs
eyes = np.reshape(x[:(len(x)//span)*span], (-1, span))
plt.figure()
for row in eyes:
    plt.plot(np.arange(span)/ovs, row, alpha=0.2)
plt.xlabel('bit periods')
plt.title('Eye Diagram (NRZ-L)')
plt.show()
```

---

## 연습문제(풀이 포함)

### Q1. 100BASE-TX(100 Mb/s)에서 **4B/5B+NRZI**를 쓰는 핵심 이유 2가지?

**풀이**:
(1) **4B/5B**로 **전이 밀도 확보**(최장 0 런 제한, 클럭 복구 안정),
(2) **NRZI**로 ‘1’에서 **전이 생성** → 스펙트럼에 **저주파 억제/자기시계 강화**. (참고: 물리 전송은 **MLT-3**로 스펙트럼 저주파화)

### Q2. **AMI**에서 0이 길게 이어질 때 문제와 대책?

**풀이**:
문제: **전이가 없어** 동기 손실/PLL 드리프트, DC 억제 이점 약화.
대책: **B8ZS(8연속 0 대체)**, **HDB3(4연속 0 대체)**를 적용해 **의도적 전이/위반** 삽입.

### Q3. **Manchester**의 장·단점 한 줄씩?

**풀이**:
장점: **항상 mid-bit 전이** → **완전 self-clocking**, **DC=0**.
단점: **대역폭 요구가 NRZ의 약 2배**.

### Q4. 10 Mb/s에서 **NRZ-L**과 **Manchester**의 이상 Nyquist 대역(α=0.5)은?

**풀이**:
NRZ-L: $B=(1+α)R_b/2=(1.5)\cdot10/2=7.5$ MHz.
Manchester: $R_s≈2R_b$ → $B=(1.5)\cdot20/2=15$ MHz.

### Q5. **NRZ-I**의 클럭 복구가 어려운 입력 패턴은?

**풀이**: **0이 길게 연속**될 때(전이가 없음).
(반대로 1이 자주 오면 토글이 많아 동기 유리)

### Q6. **HDB3**에서 `0000`을 언제 `B00V`로, 언제 `000V`로 대체?

**풀이**: 마지막 대체 이후 **마크(±A) 개수의 짝/홀**에 따라 **총 극성 합을 0**으로 유지하도록 선택.
- **짝수**면 `B00V`(보정 마크 B 넣고 위반 V)
- **홀수**면 `000V` (위반만으로 균형 유지)

---

## 요약(시험 체크리스트)

- **NRZ-L/-I**: 효율↑, 그러나 **런-길이↑ → 클럭 복구↓**. unipolar는 **DC↑**.
- **RZ**: 전이↑ → 클럭 복구↑, **대역폭 요구↑**.
- **AMI**: **DC≈0**, **바이폴라 위반**으로 **대체/에러 검출**, **0 런** 취약 → **B8ZS/HDB3**.
- **Manchester**: **mid-bit 전이 보장**, **DC=0**, **대역폭 2배수**.
- **이상 Nyquist 대역**: $B=(1+α)R_s/2$. **Manchester는 $R_s≈2R_b$**.
- 베이스라인 워더 방지: **전이 밀도 확보(블록코딩/스크램블)**, **자기시계 부호** 선택.

---

## 부록: 자주 헷갈리는 개념 정리

- **DC 성분**: 신호의 평균값. 변압기 결합/광 모듈 DC 차단 시 **0에 근접**해야 유리.
  - **Manchester/AMI(평균 0)**는 유리, **unipolar NRZ**는 불리.
- **전이 기반 검파**: 레벨이 아닌 **전이 시점** 탐지 → 오프셋/이득 변화에 강함.
- **심볼율 vs 비트율**: 이진 PAM에서 보통 $R_s=R_b$. **Manchester는 사실상 2레벨을 반비트로 나눠 전이** → **유효 $R_s≈2R_b$**.
- **스펙트럼 규범**: 직사각 펄스는 **에너지 꼬리**가 김 → 실무 필터는 **raised-cosine** 등으로 성형(롤오프 $α$ 선택).
