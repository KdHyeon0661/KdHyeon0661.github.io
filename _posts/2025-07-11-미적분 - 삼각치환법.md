---
layout: post
title: 미적분 - 삼각치환법
date: 2025-07-11 23:20:23 +0900
category: 미적분
---
# 삼각치환법(Trigonometric Substitution)

## 0. 언제 쓰나? — 감별법과 직관

- 적분 integrand에 **2차식(square quadratic)**의 **제곱근**이 보일 때:
  $$
  \sqrt{a^2 - x^2},\qquad \sqrt{a^2 + x^2},\qquad \sqrt{x^2 - a^2}.
  $$
- 삼각함수 항등식
  $$
  \sin^2\theta + \cos^2\theta = 1,\qquad
  1 + \tan^2\theta = \sec^2\theta
  $$
  를 이용하면 루트가 **정확한 제곱**으로 떨어져 사라진다.
- 일반 이차식 \(\sqrt{\alpha x^2 + \beta x + \gamma}\)은 **완전제곱**을 통해 표준형으로 바꾼 뒤 3형 중 하나로 귀결된다.

핵심 목표: **루트 제거 → 단순 삼각적분 → 역치환(직각삼각형으로)**.

---

## 1. 세 가지 표준 치환(원형·빗변·쐐기)

각 치환에서 \(\theta\)의 범위를 **부호 고정**을 위해 적절히 선택한다. 이는 역치환의 절댓값·부호 논쟁을 줄이는 핵심이다.

### (A) \(\sqrt{a^2 - x^2}\) — 원형(원반) 구조
- **치환**
  $$
  x = a\sin\theta,\qquad \theta\in\Big[-\frac{\pi}{2},\,\frac{\pi}{2}\Big].
  $$
- **미분**
  $$
  dx = a\cos\theta\,d\theta.
  $$
- **루트 정리**
  $$
  \sqrt{a^2 - x^2} = \sqrt{a^2 - a^2\sin^2\theta} = a\cos\theta,\quad \text{(선택 범위에서 } \cos\theta\ge 0).
  $$

### (B) \(\sqrt{a^2 + x^2}\) — 직각삼각형의 빗변
- **치환**
  $$
  x = a\tan\theta,\qquad \theta\in\Big(-\frac{\pi}{2},\,\frac{\pi}{2}\Big).
  $$
- **미분**
  $$
  dx = a\sec^2\theta\,d\theta.
  $$
- **루트 정리**
  $$
  \sqrt{a^2 + x^2} = \sqrt{a^2 + a^2\tan^2\theta} = a\sec\theta,\quad \sec\theta>0\ \text{(해당 범위)}.
  $$

### (C) \(\sqrt{x^2 - a^2}\) — 쐐기(외접) 구조
- **치환**
  $$
  x = a\sec\theta,\qquad \theta\in[0,\pi]\setminus\{\tfrac{\pi}{2}\},
  $$
  (실전에서는 보통 \( [0,\tfrac{\pi}{2})\cup(\tfrac{\pi}{2},\pi] \) 중 하나로 절반만 쓴다.)
- **미분**
  $$
  dx = a\sec\theta\tan\theta\,d\theta.
  $$
- **루트 정리**
  $$
  \sqrt{x^2 - a^2} = \sqrt{a^2\sec^2\theta - a^2} = a\tan\theta,\quad \tan\theta\ge 0\ \text{구간 선택}.
  $$

---

## 2. 역치환 — 직각삼각형으로 \(\theta\to x\) 복원

**직각삼각형 도식**은 역치환에서 \(\sin\theta, \cos\theta, \tan\theta, \sec\theta\)를 \(x,a\)로 바꾸는 표준 절차다.

- **A형** \(x=a\sin\theta\Rightarrow \sin\theta=\dfrac{x}{a}\):
  빗변 \(a\), 대변 \(x\), 인접변 \(\sqrt{a^2-x^2}\)
  \(\cos\theta=\dfrac{\sqrt{a^2 - x^2}}{a}\).
- **B형** \(x=a\tan\theta\Rightarrow \tan\theta=\dfrac{x}{a}\):
  인접 \(a\), 대변 \(x\), 빗변 \(\sqrt{a^2+x^2}\)
  \(\sec\theta=\dfrac{\sqrt{a^2 + x^2}}{a}\), \(\sin\theta=\dfrac{x}{\sqrt{a^2+x^2}}\), \(\cos\theta=\dfrac{a}{\sqrt{a^2+x^2}}\).
- **C형** \(x=a\sec\theta\Rightarrow \sec\theta=\dfrac{x}{a}\):
  인접 \(a\), 빗변 \(x\), 대변 \(\sqrt{x^2-a^2}\)
  \(\tan\theta=\dfrac{\sqrt{x^2 - a^2}}{a}\).

---

## 3. 대표 예제 — 기본형부터 고급까지

### 예제 1) \(\displaystyle \int \frac{dx}{\sqrt{a^2 - x^2}}\)
A형 치환:
$$
x=a\sin\theta,\quad dx=a\cos\theta\,d\theta,\quad \sqrt{a^2-x^2}=a\cos\theta.
$$
적분:
$$
\int \frac{dx}{\sqrt{a^2-x^2}}
= \int \frac{a\cos\theta\,d\theta}{a\cos\theta}
= \int d\theta
= \theta + C
= \arcsin\frac{x}{a} + C.
$$

---

### 예제 2) \(\displaystyle \int \sqrt{a^2 - x^2}\,dx\)  (원 1/4 면적과 연결)
A형 치환 후
$$
\int a\cos\theta\cdot a\cos\theta\,d\theta
= a^2\int \cos^2\theta\,d\theta
= \frac{a^2}{2}\int(1+\cos 2\theta)\,d\theta
= \frac{a^2}{2}\Big(\theta+\tfrac{1}{2}\sin 2\theta\Big)+C.
$$
역치환:
$$
\sin 2\theta = 2\sin\theta\cos\theta=\frac{2x\sqrt{a^2-x^2}}{a^2},\quad \theta=\arcsin\frac{x}{a}.
$$
따라서
$$
\boxed{
\int \sqrt{a^2-x^2}\,dx
= \frac{x}{2}\sqrt{a^2-x^2} + \frac{a^2}{2}\arcsin\frac{x}{a} + C
}.
$$
검증(정적분): \(\displaystyle \int_0^a \sqrt{a^2-x^2}\,dx = \frac{\pi a^2}{4}\).

---

### 예제 3) \(\displaystyle \int \frac{dx}{(x^2+a^2)^{3/2}}\)
B형 치환:
$$
x=a\tan\theta,\quad dx=a\sec^2\theta d\theta,\quad (x^2+a^2)^{3/2}=a^3\sec^3\theta.
$$
적분:
$$
\int \frac{dx}{(x^2+a^2)^{3/2}}
= \int \frac{a\sec^2\theta\,d\theta}{a^3\sec^3\theta}
= \frac{1}{a^2}\int \cos\theta\,d\theta
= \frac{1}{a^2}\sin\theta + C.
$$
역치환: \(\tan\theta=\frac{x}{a}\Rightarrow \sin\theta=\frac{x}{\sqrt{x^2+a^2}}\).
$$
\boxed{
\int \frac{dx}{(x^2+a^2)^{3/2}}
= \frac{x}{a^2\sqrt{x^2+a^2}} + C
}.
$$

---

### 예제 4) \(\displaystyle \int \sqrt{x^2-a^2}\,dx\)
C형 치환:
$$
x=a\sec\theta,\quad dx=a\sec\theta\tan\theta\,d\theta,\quad \sqrt{x^2-a^2}=a\tan\theta.
$$
적분 정리:
$$
\int a\tan\theta \cdot a\sec\theta\tan\theta\,d\theta
= a^2\int \sec\theta\tan^2\theta\,d\theta
= a^2\int \sec\theta(\sec^2\theta-1)\,d\theta
= a^2\Big(\int \sec^3\theta\,d\theta - \int \sec\theta\,d\theta\Big).
$$
표준결과:
$$
\int \sec\theta\,d\theta = \ln|\sec\theta+\tan\theta|,\quad
\int \sec^3\theta\,d\theta = \tfrac12\sec\theta\tan\theta+\tfrac12\ln|\sec\theta+\tan\theta|.
$$
따라서
$$
\int \sqrt{x^2-a^2}\,dx
= a^2\Big[\tfrac12\sec\theta\tan\theta - \tfrac12\ln|\sec\theta+\tan\theta|\Big]+C.
$$
역치환: \(\sec\theta=\frac{x}{a},\ \tan\theta=\frac{\sqrt{x^2-a^2}}{a}\).
$$
\boxed{
\int \sqrt{x^2-a^2}\,dx
= \frac{x}{2}\sqrt{x^2-a^2} - \frac{a^2}{2}\ln\!\Big|x+\sqrt{x^2-a^2}\Big| + C
}.
$$

---

### 예제 5) \(\displaystyle \int \frac{dx}{x\sqrt{x^2-a^2}}\)
C형 치환:
$$
x=a\sec\theta,\quad dx=a\sec\theta\tan\theta\,d\theta.
$$
적분:
$$
\int \frac{dx}{x\sqrt{x^2-a^2}}
= \int \frac{a\sec\theta\tan\theta\,d\theta}{(a\sec\theta)(a\tan\theta)}
= \int \frac{d\theta}{a}
= \frac{\theta}{a}+C.
$$
역치환:
$$
\theta=\arcsec\frac{x}{a}=\arccos\frac{a}{x}.
$$
따라서
$$
\boxed{
\int \frac{dx}{x\sqrt{x^2-a^2}}
= \frac{1}{a}\,\arcsec\!\frac{x}{a}+C
= \frac{1}{a}\arccos\!\frac{a}{x}+C
}.
$$

---

### 예제 6) 정적분 \(\displaystyle \int_{0}^{a} \frac{x^2}{\sqrt{a^2-x^2}}\,dx\)
A형 치환, 경계도 \(\theta\)-경계로 변환:
$$
x=a\sin\theta,\quad dx=a\cos\theta\,d\theta,\quad \sqrt{a^2-x^2}=a\cos\theta,
$$
$$
x=0\Rightarrow \theta=0,\qquad x=a\Rightarrow \theta=\frac{\pi}{2}.
$$
적분:
$$
\int_0^a \frac{x^2}{\sqrt{a^2-x^2}}\,dx
= \int_0^{\pi/2} \frac{a^2\sin^2\theta}{a\cos\theta}\cdot a\cos\theta\,d\theta
= a^2\int_0^{\pi/2} \sin^2\theta\,d\theta
= a^2\cdot \frac{\pi}{4}.
$$
즉 \(\boxed{\frac{\pi a^2}{4}}\).

---

## 4. 일반 이차식 \(\sqrt{\alpha x^2+\beta x+\gamma}\) — 완전제곱 정규화

완전제곱:
$$
\alpha x^2+\beta x+\gamma
= \alpha\Big(x+\frac{\beta}{2\alpha}\Big)^2 + \Big(\gamma-\frac{\beta^2}{4\alpha}\Big)
= \alpha\big(u^2 + k\big),
$$
여기서 \(u=x+\frac{\beta}{2\alpha}\), \(k=\dfrac{\gamma}{\alpha}-\dfrac{\beta^2}{4\alpha^2}\).

- \(\alpha>0\)이면 \(\sqrt{\alpha}\sqrt{u^2+k}\)로 인수분해 후,
  - \(k>0\Rightarrow \sqrt{u^2 + k}\) → **B형** (\(u=\sqrt{k}\tan\theta\)).
  - \(k=0\Rightarrow \sqrt{u^2}\) → 절댓값·부호 주의로 바로 적분 가능.
  - \(k<0\Rightarrow \sqrt{u^2 - |k|}\) → **C형** (\(u=\sqrt{|k|}\sec\theta\)).
- \(\alpha<0\)이면 부호를 빼내어 \(-\alpha>0\)인 형태로 다시 정리한 뒤 동일 로직 적용.

**팁**: 상수는 루트 밖으로 빼 최소형으로 만든다:
$$
\sqrt{c\cdot(\cdots)}=\sqrt{|c|}\cdot \sqrt{\cdots}.
$$

---

## 5. 정형 결과(치트시트)

- \(\displaystyle \int \frac{dx}{\sqrt{a^2-x^2}} = \arcsin\frac{x}{a} + C\).
- \(\displaystyle \int \sqrt{a^2-x^2}\,dx = \frac{x}{2}\sqrt{a^2-x^2} + \frac{a^2}{2}\arcsin\frac{x}{a}+C\).
- \(\displaystyle \int \frac{dx}{(x^2+a^2)^{3/2}} = \frac{x}{a^2\sqrt{x^2+a^2}} + C\).
- \(\displaystyle \int \sqrt{x^2-a^2}\,dx = \frac{x}{2}\sqrt{x^2-a^2} - \frac{a^2}{2}\ln\!\Big|x+\sqrt{x^2-a^2}\Big| + C\).
- \(\displaystyle \int \frac{dx}{x\sqrt{x^2-a^2}} = \frac{1}{a}\,\arcsec\!\frac{x}{a}+C = \frac{1}{a}\arccos\!\frac{a}{x}+C\).

---

## 6. 부호·구간·절댓값 — 실전 주의사항 모음

1) **로그의 절댓값**
   \(\displaystyle \int \sec\theta\,d\theta=\ln|\sec\theta+\tan\theta|+C\) → 역치환 후
   \(\ln\big|\,x+\sqrt{x^2-a^2}\,\big|\) 형태. 절댓값 누락 금지.

2) **\(\theta\) 범위 선택**
   치환 시 \(\cos\theta, \sec\theta, \tan\theta\)의 부호가 **고정**되도록 범위를 택한다. 그래야
   \(\sqrt{\cdot} = \text{양수}\)로 깔끔히 떨어진다.

3) **정적분**
   \([x\)-구간] → \([\theta\)-구간] 변환 후 적분하면 역치환이 필요 없다(오차/부호 문제 감소).

4) **\(a>0\) 가정**
   표준형은 보통 \(a>0\)을 전제. 실제 문제에서 \(a<0\)이면 \(|a|\)로 치환해 재정리한다.

5) **도메인/역삼각함수**
   \(\arcsin, \arccos, \arcsec\)의 주값 범위를 이해하고, 필요한 경우 등가 표현(예: \(\operatorname{arcosh}\))으로 바꿔 사용한다.

---

## 7. 대안 치환 — 쌍곡/Weierstrass(참고)

### 7.1 쌍곡치환
- \(\sqrt{x^2+a^2}\)
  \(x=a\sinh t,\ dx=a\cosh t\,dt,\ \sqrt{x^2+a^2}=a\cosh t\).
  로그형 결과가 자연스럽게 나오며, 일부 적분에서 더 간단하다.
- \(\sqrt{x^2-a^2}\)
  \(x=a\cosh t,\ dx=a\sinh t\,dt,\ \sqrt{x^2-a^2}=a\sinh t\).

예: \(\displaystyle \int \sqrt{x^2-a^2}\,dx\)는 \(t\)-치환으로도
\(\frac{x}{2}\sqrt{x^2-a^2} - \frac{a^2}{2}\operatorname{arcosh}(x/a)\) (로그와 동치) 형태를 얻는다.
\(\operatorname{arcosh} u = \ln(u+\sqrt{u^2-1})\).

### 7.2 Weierstrass 치환(전탄젠트, \(t=\tan(\theta/2)\))
삼각적분을 전유리함수로 바꾼다:
$$
\sin\theta=\frac{2t}{1+t^2},\qquad \cos\theta=\frac{1-t^2}{1+t^2},\qquad d\theta=\frac{2\,dt}{1+t^2}.
$$
삼각치환 이후 남은 삼각적분이 복잡할 때 유용하다.

---

## 8. SymPy로 검증/수치 확인(코드)

> 아래 코드는 심볼릭 검증과 수치 확인을 위한 데모다.

```python
import sympy as sp

x, a = sp.symbols('x a', positive=True, real=True)

# 예제 1: ∫ dx / sqrt(a^2 - x^2) = asin(x/a) + C
expr1 = sp.integrate(1/sp.sqrt(a**2 - x**2), x)
print("Ex1:", sp.simplify(expr1))  # asin(x/a)

# 예제 2: ∫ sqrt(a^2 - x^2) dx
expr2 = sp.integrate(sp.sqrt(a**2 - x**2), x)
print("Ex2:", sp.simplify(expr2))

# 예제 3: ∫ dx / (x^2 + a^2)^(3/2)
expr3 = sp.integrate(1/(x**2 + a**2)**sp.Rational(3,2), x)
print("Ex3:", sp.simplify(expr3))

# 예제 4: ∫ sqrt(x^2 - a^2) dx
expr4 = sp.integrate(sp.sqrt(x**2 - a**2), x)
print("Ex4:", sp.simplify(expr4))

# 정적분 검증: ∫_0^a x^2 / sqrt(a^2 - x^2) dx = pi*a^2/4
val = sp.integrate(x**2/sp.sqrt(a**2 - x**2), (x, 0, a))
print("Definite:", sp.simplify(val))  # pi*a**2/4
```

---

## 9. 응용 시나리오

### 9.1 기하(원·타원)
- 원 1/4 면적: \(\displaystyle \int_0^a \sqrt{a^2-x^2}\,dx = \frac{\pi a^2}{4}\).
- 타원 \(x^2/a^2 + y^2/b^2=1\) 1/4 면적: \(\displaystyle \int_0^a b\sqrt{1-x^2/a^2}\,dx = \frac{\pi ab}{4}\)
  \(x=a\sin\theta\)로 간단히 확인.

### 9.2 물리(선밀도/포텐셜)
- 반원 프로파일의 선밀도 \(\lambda(x)\propto \sqrt{a^2-x^2}\)의 총질량은 A형 정적분으로 직결.
- 전자기 포텐셜의 원형 루프 근사식 유도에서 분모 루트에 \(x=a\tan\theta\)가 깔끔히 적용.

### 9.3 표면적/체적(회전체)
- \(y=\sqrt{a^2-x^2}\) (반원)의 회전체 체적/표면적에서 삼각치환이 표준 도구로 사용된다.

---

## 10. 연습문제 — 풀이전략 힌트 포함

1) \(\displaystyle \int \frac{dx}{\sqrt{9-x^2}}\)
   A형, \(a=3\). 답: \(\arcsin(x/3)+C\).

2) \(\displaystyle \int \sqrt{16-x^2}\,dx\)
   A형, \(a=4\). 표준결과 대입.

3) \(\displaystyle \int \frac{dx}{(x^2+4)^{3/2}}\)
   B형, \(a=2\). 답: \(\dfrac{x}{4\sqrt{x^2+4}}+C\).

4) \(\displaystyle \int \frac{dx}{x\sqrt{x^2-25}}\)
   C형, \(a=5\). 답: \(\dfrac{1}{5}\arcsec\!\frac{x}{5}+C\).

5) \(\displaystyle \int_{0}^{2} \frac{x^2}{\sqrt{4-x^2}}\,dx\)
   A형 정적분. \(\theta\)-경계 변환으로 즉시 평가.

6) \(\displaystyle \int \sqrt{9x^2+6x+2}\,dx\)
   완전제곱: \(9(x+\tfrac13)^2+1\). \(u=x+\tfrac13\) 후 B형.

7) \(\displaystyle \int \frac{dx}{(x^2+a^2)^{5/2}}\)
   B형을 쓰면 \(\cos^3\theta\) 적분으로 귀결. 표준 결과: \(\dfrac{2x^2+a^2}{3a^4\sqrt{x^2+a^2}}+C\).

8) \(\displaystyle \int \frac{dx}{x^2\sqrt{x^2-a^2}}\)
   C형 후 \(\csc\theta\cot\theta\)류 적분. 부분분수/삼각표준결과 활용.

9) \(\displaystyle \int \frac{\sqrt{a^2-x^2}}{x^2}\,dx\)
   A형 후 \(\cos^2\theta/\sin^2\theta\) 정리. \(\cot\), \(\csc\) 변환 활용.

10) \(\displaystyle \int \frac{dx}{(x^2-a^2)^{3/2}}\)
    C형 기본형. 답: \(\dfrac{x}{a^2\sqrt{x^2-a^2}}+C\) (부호/정의역 점검).

---

## 11. 한 페이지 요약

| 루트 형태 | 치환 | \(dx\) | 루트 표현 |
|---|---|---|---|
| \(\sqrt{a^2-x^2}\) | \(x=a\sin\theta\) | \(dx=a\cos\theta\,d\theta\) | \(a\cos\theta\) |
| \(\sqrt{a^2+x^2}\) | \(x=a\tan\theta\) | \(dx=a\sec^2\theta\,d\theta\) | \(a\sec\theta\) |
| \(\sqrt{x^2-a^2}\) | \(x=a\sec\theta\) | \(dx=a\sec\theta\tan\theta\,d\theta\) | \(a\tan\theta\) |

**Tip**: A/B/C 순서로 **sin / tan / sec**를 대응시켜 암기.

---

## 부록 A) 표준 삼각적분 결과(필수)

- \(\displaystyle \int \sin^n\theta \cos^m\theta\,d\theta\) 류: 홀수 지수일 때 치환, 짝수 지수일 때 반각공식.
- \(\displaystyle \int \sec\theta\,d\theta=\ln|\sec\theta+\tan\theta|+C\).
- \(\displaystyle \int \sec^3\theta\,d\theta=\frac12\sec\theta\tan\theta+\frac12\ln|\sec\theta+\tan\theta|+C\).
- 반각공식: \(\cos^2\theta=\frac{1+\cos2\theta}{2}\), \(\sin^2\theta=\frac{1-\cos2\theta}{2}\).
- 합성각: \(\sin 2\theta = 2\sin\theta\cos\theta\).

---

## 부록 B) 자주 틀리는 포인트 체크리스트

- [ ] 로그 결과의 **절댓값** 표기(\(|\cdot|\))를 빠뜨리지 않았는가?
- [ ] \(\theta\) 범위를 올바르게 선택해 \(\sqrt{\cdot}\)의 부호를 고정했는가?
- [ ] 정적분에서 경계를 \(\theta\)-경계로 옮겨 **역치환을 생략**했는가(가능 시)?
- [ ] 완전제곱 시 상수 인수를 **제대로 밖으로 분리**했는가?
- [ ] 대안 치환(쌍곡)을 고려하면 더 단순해지지 않는가?
- [ ] 결과의 정의역(특히 \(\arcsec,\arccos\))과 주값 범위를 점검했는가?

---

### 끝맺음

삼각치환은 **패턴 인식(세 루트형)** → **치환·삼각적분 표준기법** → **삼각형을 통한 역치환**이라는 기계적 절차다.
완전제곱으로 일반 이차식을 표준형으로 맞추는 습관, 정적분에서 경계변환을 먼저 하는 습관, 로그 절댓값과 부호 관리가 숙련의 핵심이다.
