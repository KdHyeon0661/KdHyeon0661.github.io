---
layout: post
title: 암호학 - 포스트양자
date: 2025-10-13 17:30:23 +0900
category: 암호학
---
# 포스트양자

> 이 장은 **위협 모델(Shor/Grover)** → **PQC 패밀리(KEM/서명: 격자·해시기반·코드기반·다변수)** → **표준화 최신 동향** → **실무 전환 체크리스트(하이브리드 키 교환 등)** 순으로 정리합니다.
> 모든 코드는 **개념 시뮬레이션/의사코드** 수준입니다. 실제 배포는 **표준 구현**과 **검증된 라이브러리**만 사용하세요.

---

## 9.1 위협 모델: 양자 컴퓨팅이 흔드는 것

### Shor와 Grover, 한 줄 요약

- **Shor**: **정수소인수분해·이산로그**를 다항시간으로 풀 수 있어 **RSA, DH, ECDH/ECDSA** 등 **기존 공개키 암호를 근본적으로 붕괴**시킵니다.
- **Grover**: **탐색(무차별/프리이미지)** 를 **제곱근 속도**로 가속 → 대칭키/해시의 **유효 보안비트가 절반**으로 줄어듭니다. 따라서 대칭은 **키/출력 길이 상향**(예: AES-256, 해시는 ≥256비트)로 **완화 가능**.

### Harvest-Now-Decrypt-Later(HNDL)

- 공격자는 **지금** 트래픽을 **수집**해 두었다가, **미래의 양자기**로 **나중에 복호**할 수 있습니다.
- 장기 비밀·개인정보·지적재산은 **보존 기간** 전체를 고려해 **지금** PQC로 보호해야 합니다.

---

## 9.2 KEM/서명 계열별 큰 지도

### — LWE/MLWE

- **근거 문제**: (Module) Learning With Errors(노이즈가 섞인 선형 방정식 풀기의 어려움).
- **특징**: **빠름**, 구현이 성숙, 키/서명 크기가 **중간~큼**.
- **표준**:
  - **ML-KEM**(CRYSTALS-Kyber, KEM) — **FIPS 203** 최종 표준(ML-KEM-512/768/1024)
  - **ML-DSA**(CRYSTALS-Dilithium, 서명) — **FIPS 204** 최종 표준

### 해시기반(Hash-based)

- **근거 문제**: **해시의 일방향성**; 특히 **SPHINCS+**는 **stateless** 설계.
- **특징**: 보안 가정이 단순·보수적, 단 **서명/검증 비용**과 **서명 크기**가 비교적 큼.
- **표준**: **SLH-DSA**(SPHINCS+), **FIPS 205** 최종 표준

### 코드기반(Code-based)

- **근거 문제**: 오류정정코드의 **디코딩 어려움**(예: McEliece·HQC).
- **특징**: 긴 공개키(특히 Classic McEliece), 그러나 **매우 보수적인 보안 전통**.
- **동향**: **HQC**가 **백업 KEM**으로 2025-03-11 **선정**(표준화 진행) .

### 다변수(Multivariate)

- **근거 문제**: 유한체 위 **다변수 다항식 시스템** 풀기의 어려움.
- 장·단점이 뚜렷하나, 대형 생태계용 1차 표준에는 아직 제한적 채택(연구·특수 용도).

---

## 9.3 표준화 최신 동향 요약(2025-10 기준)

- **NIST FIPS (최종본, 2024-08-13)**
  - **FIPS 203**: **ML-KEM**(Kyber 기반 KEM) — 파라미터 **512/768/1024** 수록
  - **FIPS 204**: **ML-DSA**(Dilithium 기반 서명)
  - **FIPS 205**: **SLH-DSA**(SPHINCS+ 기반 서명)
  - NIST 보도자료: “첫 3개 PQ 표준 최종화”
- **4라운드/추가 표준화**
  - **HQC**: 2025-03-11 **선정 발표**(Kyber의 **백업 KEM**)
- **TLS 하이브리드**
  - IETF **TLS 1.3 하이브리드 KEX 디자인** 초안(예: X25519+ML-KEM-768 그룹)들이 진행 중
  - 업계 가이드·사례(배포 고려사항) 다수 갱신 중

---

## 9.4 직관: KEM과 서명은 어떻게 쓰이는가

### KEM(키 캡슐화)

- 두 당사자가 공개키/암호문(캡슐) 교환만으로 **세션 대칭키**를 합의.
- **KEM-Decap**으로 수신자는 **공유 비밀**을 얻고, 이를 **HKDF**로 키 분화.
- ML-KEM 파라미터 선택: 768(균형), 1024(보안↑, 크기/시간↑), 512(성능↑, 보안↓; 정책에 따름)

### 서명(DSA)

- SW·TLS·코드서명·전자서명에 사용.
- **ML-DSA**(Dilithium) — 빠른 검증, 비교적 큰 서명/키.
- **SLH-DSA**(SPHINCS+) — 보수적 보안, 서명 길이 큼.

---

## 9.5 하이브리드 키 교환(실무 핵심)

### 왜 하이브리드인가?

- **이행기**엔 “전통(ECDH) + PQC(Kyber)”를 **동시에** 써서, **둘 중 하나**가 깨져도 **합성 비밀**은 안전하도록 합니다.
- TLS 1.3에선 **하이브리드 그룹**(예: **X25519MLKEM768**)을 정의하는 방식이 논의/전개 중입니다.

### 키 합성(개념)

```
# ECDH와 PQC-KEM에서 나온 두 개의 공유비밀을 합성

Z_classic = ECDH(skA, pkB)          # 예: X25519
Z_pqc     = MLKEM.Decaps(skA_pqc, ct_from_B)

# HKDF로 안전하게 결합(Extract-then-Expand)

PRK = HKDF-Extract(salt, Z_classic || Z_pqc)
MS  = HKDF-Expand(PRK, info="tls13 handshake", L=…)
```
- **둘 중 하나가 안전**하면 전체가 안전(강한 합성 가정).
- **Nonce/라벨(info)** 로 **도메인 분리**.

---

## 9.6 성능/크기 감각(현실 체크)

- PQC는 전통 대비 **키·서명·캡슐 크기가 큼**(특히 코드기반·해시기반).
- 네트워크(패킷 MTU, 핸드셰이크 왕복), 저장(인증서 체인), HSM/스마트카드(메모리/속도) 영향을 **사전 측정**하세요.
- ML-KEM/ML-DSA는 실전에서 **우수한 성능-보안 균형**으로 채택이 확산 중이며, GCM/AEAD 등 대칭은 기존과 동일하게 사용합니다(키 합의만 교체). **정확한 파라미터·크기 표는 해당 FIPS를 확인**하세요.

---

## 9.7 실무 전환 체크리스트(Phase-by-Phase)

### 인벤토리 & 리스크(0단계)

- [ ] **암호 자산 인벤토리**: 프로토콜(TLS/SSH/IPsec/QUIC), 라이브러리(OpenSSL/boring/…/JCE), 인증서/CA, 코드서명, PKI, HW 토큰/HSM, 펌웨어, 데이터 암호화(At-Rest/At-Transit), 장기 보존 데이터.
- [ ] **HNDL 위험 평가**: 장기기밀(≥5~10년) 트래픽은 **우선 순위** 상향.
- [ ] **규정/컴플라이언스**: FIPS 채택 여부/시기 검토(203/204/205).

### 암호 민첩성(Crypto-Agility)

- [ ] 라이브러리/프레임워크를 **알고리즘-플러그형**으로(정적 상수 제거).
- [ ] 키/서명/파라미터를 **메타데이터로 기록**(마이그레이션 용이).
- [ ] **HKDF·AEAD** 등 주변 구성요소는 그대로 재사용 가능(대칭은 AES-256/ChaCha20-Poly1305 등).

### 하이브리드 배포(1단계)

- [ ] **TLS 1.3**: 가능한 경우 **하이브리드 그룹**(예: X25519+ML-KEM-768) 우선. 구현은 IETF 최신 초안/벤더 가이드에 따르기.
- [ ] **상호운용 전략**: 협상 실패 시 **전통만**으로 후퇴(로그/알람).
- [ ] **측정**: 핸드셰이크 시간, 실패율, MTU/재전송, CPU/메모리.

### 순수 PQ 전환(2단계)

- [ ] 서버/클라이언트 모두 **ML-KEM** 기반 KEX 지원, **ML-DSA/SLH-DSA** 인증서 수용.
- [ ] **인증서 체인** 크기/검증시간 최적화(중간 CA의 알고리즘·파라미터 선택).
- [ ] **로깅/가시성**: 핸드셰이크 알고리즘, 실패 사유, 피어 능력.

### 백업 알고리즘(옵션)

- [ ] 정책상 백업 KEM 필요 시 **HQC** 고려(표준화 진행). 채택/지원 로드맵 주시.

### 운영 보안

- [ ] **RNG/DRBG**: FIPS-승인 RBG 사용 요구 확인(ML-KEM은 SP 800-90A 준수 RBG 요구)
- [ ] **키 수명/회전**: PQC에서도 세션키 수명/롤오버 정책 유지.
- [ ] **인증서 갱신 계획**: 루트/중간/엔드엔티티 순서로 **점진적 이행**.
- [ ] **레거시 차단 일정**: 알고리즘/스위트별 **EOL 타임라인** 공표.

---

## 9.8 프로토콜 적용 — TLS 1.3 예시(개념)

> 여러 구현이 존재(오픈소스/상용/클라우드). 여기선 **개념 흐름**만 보여줍니다.

### 핸드셰이크 개요(하이브리드)

1) **ClientHello**: 하이브리드 그룹(예: **X25519MLKEM768**) 제시
2) **ServerHello**: 동일 그룹 선택 + 서버 PQC KEM 공개키(또는 캡슐) 교환
3) **합성 비밀**: `Z = HKDF-Extract(…, Z_ECDH || Z_PQC)`
4) **Finished**: AEAD로 보호(기밀/무결성)

### 인증서/서명

- **서버 인증서 서명 알고리즘**: **ML-DSA**(Dilithium) 또는 **SLH-DSA**(SPHINCS+) 체인 고려. 체인은 혼합 가능(정책·상호운용).

---

## 9.9 개발자용 미니 예제(로컬 시뮬레이터)

> **주의**: 아래는 **교육용 의사코드**로, 실제 ML-KEM 구현이 아닙니다. “두 비밀을 합성해 세션키를 만드는 하이브리드 감각”만 보여줍니다.

```python
# 교육용: 하이브리드 합성 감각(실제 PQC 아님!)

import os, hmac, hashlib

def HKDF_extract(salt, ikm):  # SHA-256
    return hmac.new(salt, ikm, hashlib.sha256).digest()

def HKDF_expand(prk, info, L=32):
    t = b""; okm = b""; i = 1
    while len(okm) < L:
        t = hmac.new(prk, t + info + bytes([i]), hashlib.sha256).digest()
        okm += t; i += 1
    return okm[:L]

def fake_ecdh():    # 전통
    return os.urandom(32)

def fake_pqc_kem(): # PQC
    return os.urandom(32)

salt = os.urandom(16)
Z_classic = fake_ecdh()
Z_pqc     = fake_pqc_kem()

PRK = HKDF_extract(salt, Z_classic + Z_pqc)
MS  = HKDF_expand(PRK, b"tls13 hybrid demo", 32)
print("hybrid master secret:", MS.hex()[:32], "…")
```

---

## 9.10 보안·운영 FAQ

**Q1. 대칭키/해시는 바꿔야 하나요?**
- **대칭**은 Grover 때문에 **키 길이 상향**(AES-256 권장)이 일반적.
- **해시**는 SHA-256/384/512/ SHA-3 계열 사용. **프리이미지** 안전도를 늘리려면 **출력 256비트 이상**을 권장.

**Q2. 인증서/PKI는 어떻게?**
- 루트/중간 CA의 **서명 알고리즘**을 **ML-DSA/SLH-DSA**로 점진 이행. 체인 크기·검증시간·정책 영향 평가.

**Q3. 어떤 KEM을 기본으로?**
- **ML-KEM-768**이 오늘 기준 **밸런스**(정책에 따라 512/1024 선택). HQC는 **백업** 옵션(추가 표준화 중).

**Q4. RNG 요건은?**
- **FIPS 203**는 **SP 800-90A 승인 RBG** 사용을 요구합니다(적용 환경에서 준수).

---

## 9.11 조직 도입 로드맵(현실 버전)

1) **거버넌스**: CISO 스폰서십, 위험 모델(HNDL) 승인
2) **파일럿**: 내부 서비스 1~2개에 **TLS 하이브리드** 투입(가시성/롤백 준비)
3) **플랫폼 업데이트**: OpenSSL/운영체계/클라우드 LB의 **PQC 지원 버전** 로드맵 맞추기(벤더 공지 확인)
4) **PKI 갱신**: 테스트 CA 생성(ML-DSA/SLH-DSA), 단말/에이전트 배포 테스트
5) **측정/튜닝**: MTU, 핸드셰이크 시간, 실패율, CPU/메모리
6) **확대/정책화**: 새 서비스 **PQC 의무화**, 레거시 점진 폐기 일정 공표
7) **감사·컴플라이언스**: FIPS 적합성, 규제 보고

---

## 9.12 주의해야 할 함정(Misuse)

- **하이브리드가 아닌 “오직 전통” 유지**: HNDL 위험을 방치
- **무작정 순수 PQ 전환**: 상호운용 실패·가용성 저하 (→ **하이브리드 단계** 권장)
- **인증서 체인 폭증**: 클라이언트/단말의 파서·저장 한계 초과
- **RNG 부적합**: 임의성 품질 문제(표준 요구 미준수)
- **사이즈/성능 측정 부재**: MTU/재전송 폭증, 타임아웃
- **서명 알고리즘 혼동**: ML-DSA(격자) vs SLH-DSA(해시기반) 혼혼입(검증·정책 상이)

---

## 9.13 요약 카드

- **양자 위협**: Shor→RSA/ECDH 붕괴, Grover→대칭 길이 상향
- **표준(최종본)**: **ML-KEM(FIPS 203)**, **ML-DSA(FIPS 204)**, **SLH-DSA(FIPS 205)** — 2024-08-13 공개
- **추가 동향**: **HQC** 선정(2025-03-11) — 백업 KEM
- **실무 기본**: **하이브리드 TLS 1.3**(예: X25519+ML-KEM-768)로 단계적 이행
- **체크리스트**: 인벤토리→민첩성→하이브리드→순수 PQ→백업→운영
- **RNG/컴플라이언스**: SP 800-90A RBG 요구 등 FIPS 준수 확인

---

## 9.14 연습문제

1) **HNDL** 위협이 특히 큰 데이터를 세 가지 도메인(의료·금융·산업제어)에서 예시하고, **보존 기간 vs 전환 우선순위**를 매칭하라.
2) **ML-KEM-768**과 **하이브리드(TLS 1.3)** 의 보안 직관을 “합성 비밀” 관점에서 설명하라(둘 중 하나 붕괴 시의 효과 포함).
3) **ML-DSA vs SLH-DSA**의 보안 가정, 성능·서명 크기·채택 용도 차이를 표로 정리하라.
4) **HQC**를 “백업 KEM”으로 병행 채택할 때, 운영/상호운용/테스트 계획의 핵심 지표 세 가지를 제시하라.
5) **RNG 요구**(SP 800-90A)와 인증서 체인 설계가 **전이행 품질**에 미치는 영향을 서술하라.

---

### 부록 A — 참고 링크(공식)

- **FIPS 203 (ML-KEM)**: NIST CSRC 최종본(2024-08-13)
- **FIPS 204 (ML-DSA)**: NIST CSRC 최종본(2024-08-13)
- **FIPS 205 (SLH-DSA)**: NIST CSRC 최종본(2024-08-13)
- **NIST 보도자료(첫 3개 PQ 표준 최종화)**
- **NIST PQC 프로젝트 현황/HQC 선정(2025-03-11)**
- **IETF TLS 하이브리드 설계** / **UTA 가이드 초안**
