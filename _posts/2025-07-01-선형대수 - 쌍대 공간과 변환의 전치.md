---
layout: post
title: 선형대수 - 쌍대 공간과 변환의 전치
date: 2025-07-01 21:20:23 +0900
category: 선형대수
---
# 쌍대 공간과 변환의 전치

> **핵심 요약**
> 벡터 공간의 선형 “측정자”들을 모은 공간이 **쌍대 공간** $$V^*$$ 이고, 선형사상 $$T:V\to W$$ 의 **전치(dual map)** $$T^*:W^*\to V^*$$ 는
> $$\boxed{(T^*\phi)(v)=\phi(Tv)}$$ 를 만족합니다.
> 기저를 정해 행렬로 쓰면 **전치**가 **행렬 전치**(실수)로, 내적을 함께 두면 **수반(Adjoint)** 이 **켤레 전치**(복소)로 나타납니다.
> 또한 $$\ker T^\*=(\operatorname{Im}T)^\circ,\ \ \operatorname{Im}T^\*=(\ker T)^\circ,\ \ \operatorname{rank}(T)=\operatorname{rank}(T^\*)$$ 이 성립합니다.

---

## 로드맵

1. **쌍대 공간**: 정의, 평가(evaluation), 직관
2. **쌍대 기저**: 비직교 기저에서의 구체 계산(Gram·역행렬)
3. **전치 변환**: 범함수적 정의 → 행렬 표현(실수/복소)
4. **근본 네 공간의 쌍대 관계**: 멸자(annihilator), 랭크 동등
5. **좌표 변환 규칙**: 공변/반변(covariant/contravariant)
6. **내적이 있을 때**: Riesz, 수반(Adjoint)과 전치의 연결
7. **완전 예제**: 손계산 + Python으로 전 과정 검증
8. **체크리스트·흔한 오해**

모든 수식은 **항상 $$\cdots$$** 로 표기합니다.

---

## 쌍대 공간(Dual Space)

### 정의와 직관

- **정의**: 벡터 공간 $$V$$ 위의 모든 **선형 함수(선형 형식)** 들의 집합
  $$
  \boxed{V^*=\{\ f:V\to\mathbb{F}\ \mid\ f\ \text{선형}\ \}}
  $$
  여기서 $$\mathbb{F}=\mathbb{R}$$ 또는 $$\mathbb{C}$$.

- **직관**: $$V$$ 가 “벡터 그 자체”라면, $$V^*$$ 는 벡터에 수를 할당하는 **측정자(가중합·평가자)** 의 공간입니다.
  예: $$f(x)=a_1x_1+\cdots+a_nx_n$$ (열벡터 $$x$$ 에 작용하는 **행벡터** $$a^\top$$).

- **평가 사상(짝)**: 표준쌍(pairing) $$\langle f,v\rangle:=f(v)$$ 로 $$V^*\times V\to\mathbb{F}$$.

---

## 쌍대 기저(Dual Basis)와 Gram

### 쌍대 기저의 정의

- $$V$$ 가 유한차원, 기저 $$\mathcal{B}=\{e_1,\dots,e_n\}$$.
  **쌍대 기저** $$\mathcal{B}^*=\{e^1,\dots,e^n\}\subset V^*$$ 는
  $$
  \boxed{e^i(e_j)=\delta^i_j}
  $$
  를 만족(“이 벡터만 1, 나머지는 0로 측정”).

- 어떤 $$v\in V$$ 도 $$v=\sum_j v^j e_j$$, 임의의 $$f\in V^*$$ 도 $$f=\sum_i f_i e^i$$ 로 좌표화.

### 비직교 기저에서의 계산법(행렬/Gram)

- 기저벡터를 **열로** 모은 행렬 $$P=[e_1\ e_2\ \cdots\ e_n]$$ (표준좌표에서).
  그러면 **쌍대 기저의 좌표(행벡터)** 는 **역행렬의 행**:
  $$
  \boxed{(e^1)^\top,\dots,(e^n)^\top \ \text{는}\ P^{-1}\ \text{의 행들}}
  $$
  즉, $$E^*=(P^{-1})^\top$$ 의 열들이 쌍대 기저.

- 내적이 주어져 있고 기저가 비직교라면 **Gram 행렬** $$G_{ij}=\langle e_i,e_j\rangle$$ 로도 표현:
  $$
  \boxed{e^i=\sum_j (G^{-1})_{ij}\,\langle \,\cdot\,,e_j\rangle}
  $$

---

## 선형 변환의 전치(Transpose of a Linear Map)

### 범함수적 정의

- $$T:V\to W$$, 그 **전치(=쌍대 변환)** $$T^*:W^*\to V^*$$ 를
  $$
  \boxed{(T^*\phi)(v)=\phi\big(T(v)\big)}\quad(\forall\ \phi\in W^*,\ v\in V)
  $$
  로 정의.
  합성 반전 $$ (S\circ T)^*=T^*\circ S^* $$, 이중전치 $$ (T^*)^*=T $$ (자연 동형으로 확인).

### 행렬 표현(실수)

- 기저를 정하고 $$T$$ 의 행렬을 $$A\in\mathbb{R}^{m\times n}$$ 라 하자(도메인 $$\mathbb{R}^n$$, 공역 $$\mathbb{R}^m$$).
  **표준쌍** $$\langle a,x\rangle=a^\top x$$ 를 쓰면
  $$
  \boxed{[T^*]=A^\top}
  $$
  (쌍대 기저에 대한 표현으로 정확).

### 복소·내적이 있을 때: 전치 vs 수반(Adjoint)

- 복소 힐베르트 공간에서 **수반** $$T^\dagger:W\to V$$ 는
  $$
  \boxed{\langle T x,y\rangle_W=\langle x,T^\dagger y\rangle_V}
  $$
  를 만족. 표준 내적이면 $$[T^\dagger]=\overline{A}^\top$$(켤레 전치).
- **전치 $$T^*$$** 는 **항상** $$W^*\to V^*$$ 로 가는 반면, **수반 $$T^\dagger$$** 는 **같은 공간들 사이** $$W\to V$$ 로 갑니다.
  Riesz 동형(내적으로 $$V\cong V^*$$)을 거치면 $$T^*$$ 과 $$T^\dagger$$ 가 연결됩니다.

---

## 멸자(Annihilator)와 네 공간의 쌍대 관계

- 부분공간 $$U\subset V$$ 의 **멸자**
  $$
  \boxed{U^\circ=\{\ f\in V^*\mid f(u)=0\ \forall u\in U\ \}}
  $$
- 선형사상 $$T:V\to W$$ 에 대해 다음이 성립:
  $$
  \boxed{(\operatorname{Im}T)^\circ=\ker T^*},\qquad
  \boxed{(\ker T)^\circ=\operatorname{Im}T^*}.
  $$
- 차원 등식으로 **랭크 동등**:
  $$
  \operatorname{rank}(T)=\operatorname{rank}(T^*).
  $$

> 내적(표준)까지 두면 **직교 보완** 버전
> $$ (\operatorname{Im}T)^\perp=\ker T^\dagger,\ \ (\ker T)^\perp=\operatorname{Im}T^\dagger $$ 도 함께 기억.

---

## 좌표 변환: 반변·공변(Contravariant vs Covariant)

- **벡터 좌표**: 기저 변화 $$e'=S e$$ (열기저), 좌표는 **반변**: $$[v]'=S^{-1}[v]$$.
- **공변량(=쌍대벡터) 좌표**: 반대로 **공변**: $$[\phi]'= [\phi]\,S$$ 또는 열벡터 표기라면 $$[\phi]^{\prime} = S^{-\top}[\phi]$$ (표기 일관성 주의).
- 행렬식 관점: 쌍대는 항상 “**전치/역전치**”로 변환.

---

## 내적과 Riesz: 전치 $$\leftrightarrow$$ 수반

- 유한차원 내적공간에서는 **Riesz 표현 정리**로 $$V\cong V^*$$(반선형/선형 관례 주의).
  표준 내적에서 $$f(\cdot)=\langle w,\cdot\rangle$$ 꼴로 모든 $$f\in V^*$$ 가 표현됩니다.
- 이 동형으로 $$T^*$$(쌍대)와 $$T^\dagger$$(수반)가 연결되고, 표준 좌표에선
  $$
  [T^\dagger]=\overline{[T]}^\top.
  $$

---

## 손계산 예제

### 쌍대 기저(비직교 기저) — $$\mathbb{R}^2$$

- 기저 $$e_1=(1,1)^\top,\ e_2=(2,1)^\top$$.
  $$
  P=\begin{bmatrix}1&2\\[2pt]1&1\end{bmatrix},\quad
  P^{-1}=\begin{bmatrix}-1&2\\[2pt]1&-1\end{bmatrix}.
  $$
- **쌍대 기저**는 $$E^*=(P^{-1})^\top$$ 의 **열**:
  $$
  e^1=\begin{bmatrix}-1\\[2pt]2\end{bmatrix},\qquad
  e^2=\begin{bmatrix}1\\[2pt]-1\end{bmatrix}.
  $$
- 검증:
  $$
  e^1(e_1)=(-1,2)\!\cdot\!(1,1)=1,\quad e^1(e_2)=(-1,2)\!\cdot\!(2,1)=0,
  $$
  $$
  e^2(e_1)=(1,-1)\!\cdot\!(1,1)=0,\quad e^2(e_2)=(1,-1)\!\cdot\!(2,1)=1.
  $$

### 전치 사상 — $$T:\mathbb{R}^2\to\mathbb{R}^3$$

- $$A=\begin{bmatrix}1&2\\[2pt]0&1\\[2pt]-1&0\end{bmatrix}$$ 라 하자.
  임의의 $$\phi\in(\mathbb{R}^3)^*$$ 를 **행벡터** $$\phi=(a,b,c)$$ 로 쓰면
  $$
  \boxed{T^*(\phi)=\phi\circ T=\phi A=(a,b,c)\!\begin{bmatrix}1&2\\[2pt]0&1\\[2pt]-1&0\end{bmatrix}
  =(a-c,\ 2a+b)}.
  $$
- 행렬로는 $$[T^*]=A^\top=\begin{bmatrix}1&0&-1\\[2pt]2&1&0\end{bmatrix}$$ (쌍대 기저 기준).

### 내적이 다른 경우의 “수반” 행렬

- $$T:(V,\langle\cdot,\cdot\rangle_G)\to(W,\langle\cdot,\cdot\rangle_H)$$, 행렬 $$A$$.
  Gram $$G,H$$ 에 대해
  $$
  \boxed{[T^\dagger]_{H,G}=G^{-1}A^\top H}
  $$
  는
  $$
  \langle Tx,y\rangle_H=\langle x,T^\dagger y\rangle_G
  $$
  를 만족. 표준 내적이면 $$G=I,H=I$$ 로 $$A^\dagger=A^\top$$(실수) 또는 $$\overline{A}^\top$$(복소).

---

## Python 실습 — SymPy/NumPy로 전 과정 검증

```python
# 예제 1) 쌍대 기저(비직교 기저)

from sympy import Matrix

e1 = Matrix([1,1])
e2 = Matrix([2,1])
P  = Matrix.hstack(e1, e2)        # [e1 e2]
Pinv = P.inv()                    # 역행렬

e1_dual = Pinv.T[:,0]             # (P^{-1})^T 의 1열
e2_dual = Pinv.T[:,1]             # (P^{-1})^T 의 2열
print("e^1 =", e1_dual)           # [-1, 2]
print("e^2 =", e2_dual)           # [ 1,-1]

print("e^1(e1) =", (e1_dual.T*e1)[0])
print("e^1(e2) =", (e1_dual.T*e2)[0])
print("e^2(e1) =", (e2_dual.T*e1)[0])
print("e^2(e2) =", (e2_dual.T*e2)[0])

# 예제 2) 전치 사상

import numpy as np

A = np.array([[ 1, 2],
              [ 0, 1],
              [-1, 0]], dtype=float)

phi = np.array([[3., -2., 5.]])   # 행벡터(=covector)
Tstar_phi = phi @ A                # φ A
print("T*phi =", Tstar_phi)        # [ 3-5, 2*3 + (-2)] = [-2, 4]

# 예제 3) 내적이 다를 때 수반

G = np.array([[2., 0.],
              [0., 1.]])          # 도메인 Gram
H = np.array([[1., 0., 0.],
              [0., 3., 0.],
              [0., 0., 1.]])      # 공역 Gram

A_dag = np.linalg.inv(G) @ A.T @ H
# 임의 x∈R^2, y∈R^3 에 대해 <Ax, y>_H == <x, A^† y>_G 검증

x = np.array([[1.],[2.]])
y = np.array([[1.],[0.],[1.]])

left  = (A @ x).T @ H @ y
right = x.T @ G @ (A_dag @ y)
print("〈Ax,y〉_H =", left, "   〈x,A†y〉_G =", right)
```

**무엇을 확인했나?**
- 비직교 기저에서도 **쌍대 기저**가 $$P^{-1}$$ 로 깨끗하게 주어짐.
- **전치 사상**은 실제로 **행렬 전치**(실수)로 동작.
- **내적이 다르면** 수반은 $$G^{-1}A^\top H$$ 로 바뀌며, 정의식을 수치로 검증.

---

## 응용 스케치

- **미분기하/물리**: 벡터(방향) vs 1-형식(하이퍼평면/기울기). **일(work)** 은 힘 1-형식이 속도 벡터에 작용한 값.
- **최적화**: 라그랑주 승수의 **쌍대 문제**—제약의 선형 형식이 핵심.
- **데이터/머신러닝**: **Row space(형식)** vs **Column space(벡터)** 의 쌍대성.
- **양자역학**: $$|\psi\rangle\ \leftrightarrow\ \langle \psi|$$, 연산자의 **수반**과 기대값.

---

## 체크리스트 & 흔한 오해

- [ ] **전치 $$T^*$$**(항상 $$W^*\to V^*$$) 와 **수반 $$T^\dagger$$**(내적 필요, $$W\to V$$) 구분.
- [ ] 복소수에서는 행렬의 수반이 **켤레 전치**.
- [ ] 기저가 바뀌면 쌍대 기저는 **역전치**로 변환.
- [ ] 비직교 기저에서 “쌍대 = 같은 벡터”가 **절대 아님**(Gram/역행렬 필요).
- [ ] $$\ker T^\*=(\operatorname{Im}T)^\circ$$, $$\operatorname{rank}(T)=\operatorname{rank}(T^\*)$$ 잊지 말기.

---

## 요약 표

| 주제 | 한 줄 정리 |
|---|---|
| 쌍대 공간 | $$V^*=\{f:V\to\mathbb{F}\ \text{선형}\}$$, 벡터의 선형 측정자 공간 |
| 쌍대 기저 | $$e^i(e_j)=\delta^i_j$$, 행렬로는 $$(P^{-1})^\top$$ |
| 전치 변환 | $$T:V\to W\ \Rightarrow\ T^*:W^*\to V^*$$, $$(T^*\phi)(v)=\phi(Tv)$$ |
| 행렬 표현 | 실수 표준쌍: $$[T^*]=A^\top$$, 복소 내적: $$[T^\dagger]=\overline{A}^\top$$ |
| 네 공간 | $$(\operatorname{Im}T)^\circ=\ker T^\*,\ (\ker T)^\circ=\operatorname{Im}T^\*$$ |
| 좌표 변환 | 벡터 좌표는 **반변**, 공변량(쌍대)은 **공변**(역전치) |

---

### 마무리

**쌍대는 “측정자”, 전치는 “측정자를 끌어오는 연산”**입니다.
기저·내적·행렬 표현을 엮어 보면, 전치/수반/역전치가 한 그림 안에서 자연스럽게 정리됩니다.
수치 실습을 통해 비직교·비등방 내적에서도 정의가 **일관**됨을 확인하세요.
